import"./p-54e8960f.js";import"./p-7b6f6c18.js";import{o as t}from"./p-1dd7027e.js";import{r as s}from"./p-e53f77c2.js";import"./p-227a5838.js";import"./p-47e1bd73.js";import"./p-804725e3.js";import"./p-5bfd1d7e.js";import"./p-b392deaf.js";import"./p-4414d64f.js";import"./p-a617738c.js";import"./p-a16c2b1d.js";import"./p-167d094f.js";import"./p-a4a5967b.js";import"./p-033339b0.js";import"./p-97ec6ae5.js";class i{constructor(){this._size=[0,0],this._programDesc={vsPath:"post-processing/pp",fsPath:"post-processing/filterEffect",attributes:new Map([["a_position",0]])}}dispose(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)}draw(t,s,i){const{width:p,height:o}=s;this._createOrResizeResources(t,p,o);const{context:e,painter:r}=t,{materialManager:a}=r,h=this._programDesc,c=this._quad,m=i.colorMatrix;c.bind();const n=this._layerFBOTexture;e.bindFramebuffer(s),s.copyToTexture(0,0,p,o,0,0,n),e.setBlendingEnabled(!1),e.setStencilTestEnabled(!1);const d=a.getProgram(t,h);e.useProgram(d),e.bindTexture(n,2),d.setUniformMatrix4fv("u_coefficients",m),d.setUniform1i("u_colorTexture",2),c.draw(),e.setBlendingEnabled(!0),e.setBlendFunction(1,771),e.setStencilTestEnabled(!0),c.unbind()}_createOrResizeResources(i,p,o){const{context:e}=i;this._layerFBOTexture&&this._size[0]===p&&this._size[1]===o||(this._size[0]=p,this._size[1]=o,this._layerFBOTexture?this._layerFBOTexture.resize(p,o):this._layerFBOTexture=new t(e,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:p,height:o}),this._quad||(this._quad=new s(e,[-1,-1,1,-1,-1,1,1,1])))}}export{i as Colorize}