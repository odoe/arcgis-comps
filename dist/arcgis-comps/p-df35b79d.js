import"./p-b79fcce3.js";import{a0 as t,s as e}from"./p-e58503d5.js";import{D as n}from"./p-01e5a461.js";import{i as a,t as r,d as i}from"./p-fea9512d.js";function o(t){if(!t)return null;if(t.isGeographic&&t.wkid){const e=i[t.wkid];if(e)return e}if(t.wkt){const e=h(t.wkt);if(e)return e}return null}function h(t){const e=r.exec(t);if(!e||2!==e.length)return null;const n=e[1].split(",");if(!n||n.length<3)return null;const a=parseFloat(n[1]),i=parseFloat(n[2]);return isNaN(a)||isNaN(i)?null:{a,f:0===i?0:1/i}}function s(e){const n=o(e||t.WGS84);if(function(t){return"b"in t&&"eSq"in t&&"radius"in t}(n))return n;const a=n.a*(1-n.f);return Object.assign(n,{b:a,eSq:1-(a/n.a)**2,radius:(2*n.a+a)/3,densificationRatio:1e4/((2*n.a+a)/3)})}function M(t){return null!==o(t)}function u(t,a="meters"){if(!t)throw new e("geodesic-lengths:invalid-geometries","the input geometries type is not supported");if(t.some((t=>!M(t.spatialReference))))throw new e("geodesic-lengths:invalid-spatial-reference","the input geometries spatial reference is not supported");const r=[];for(let e=0;e<t.length;e++){const i=t[e],{spatialReference:o}=i,h="polyline"===i.type?i.paths:i.rings;let s=0;for(let t=0;t<h.length;t++){const e=h[t];let n=0;for(let t=1;t<e.length;t++){const a=e[t-1][0],r=e[t][0],i=e[t-1][1],h=e[t][1];if(i!==h||a!==r){const t={distance:null};c(t,[a,i],[r,h],o),n+=t.distance}}s+=n}s=n(s,"meters",a),r.push(s)}return r}function f(t,e,n,r,i){const o=e[0]*a,h=e[1]*a,M=n*a,{a:u,b:f,f:c}=s(i),l=Math.sin(M),p=Math.cos(M),d=(1-c)*Math.tan(h),m=1/Math.sqrt(1+d*d),g=d*m,b=Math.atan2(d,p),N=m*l,j=N*N,v=1-j,w=v*(u*u-f*f)/(f*f),q=1+w/16384*(4096+w*(w*(320-175*w)-768)),y=w/1024*(256+w*(w*(74-47*w)-128));let F,R,S,x,O=r/(f*q),k=2*Math.PI;for(;Math.abs(O-k)>1e-12;)S=Math.cos(2*b+O),F=Math.sin(O),R=Math.cos(O),x=y*F*(S+y/4*(R*(2*S*S-1)-y/6*S*(4*F*F-3)*(4*S*S-3))),k=O,O=r/(f*q)+x;const z=g*F-m*R*p,A=Math.atan2(g*R+m*F*p,(1-c)*Math.sqrt(j+z*z)),B=Math.atan2(F*l,m*R-g*F*p),C=c/16*v*(4+c*(4-3*v)),D=A/a;return t[0]=(o+(B-(1-C)*c*N*(O+C*F*(S+C*R*(2*S*S-1)))))/a,t[1]=D,t}function c(t,e,n,r){const i=e[0]*a,o=e[1]*a,h=n[0]*a,M=n[1]*a,{a:u,b:f,f:c,radius:l}=s(r),p=h-i,d=Math.atan((1-c)*Math.tan(o)),m=Math.atan((1-c)*Math.tan(M)),g=Math.sin(d),b=Math.cos(d),N=Math.sin(m),j=Math.cos(m);let v,w,q,y,F,R,S,x,O,k,z=1e3,A=p;do{if(S=Math.sin(A),x=Math.cos(A),q=Math.sqrt(j*S*(j*S)+(b*N-g*j*x)*(b*N-g*j*x)),0===q)return t.distance=0,t.azimuth=void 0,t.reverseAzimuth=void 0,t;F=g*N+b*j*x,R=Math.atan2(q,F),O=b*j*S/q,w=1-O*O,y=F-2*g*N/w,isNaN(y)&&(y=0),k=c/16*w*(4+c*(4-3*w)),v=A,A=p+(1-k)*c*O*(R+k*q*(y+k*F*(2*y*y-1)))}while(Math.abs(A-v)>1e-12&&--z>0);if(0===z){const e=l,n=Math.acos(Math.sin(o)*Math.sin(M)+Math.cos(o)*Math.cos(M)*Math.cos(h-i))*e,r=h-i,s=Math.sin(r)*Math.cos(M),u=Math.cos(o)*Math.sin(M)-Math.sin(o)*Math.cos(M)*Math.cos(r),f=Math.atan2(s,u);return t.azimuth=f/a,t.distance=n,t.reverseAzimuth=void 0,t}const B=w*(u*u-f*f)/(f*f),C=B/1024*(256+B*(B*(74-47*B)-128)),D=f*(1+B/16384*(4096+B*(B*(320-175*B)-768)))*(R-C*q*(y+C/4*(F*(2*y*y-1)-C/6*y*(4*q*q-3)*(4*y*y-3)))),E=Math.atan2(j*Math.sin(A),b*N-g*j*Math.cos(A)),G=Math.atan2(b*Math.sin(A),b*N*Math.cos(A)-g*j);return t.azimuth=E/a,t.distance=D,t.reverseAzimuth=G/a,t}export{u as M,c as R,M as m,f as y}