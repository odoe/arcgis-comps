import{r as n}from"./p-9ae46e68.js";import{Q as t,r as s}from"./p-bae36c84.js";import{t as i}from"./p-50ff864e.js";import{bF as e,bG as r,a6 as o,a2 as a,a0 as u,b6 as c}from"./p-566b0715.js";const l=[0,0];function f(n,t){if(!t)return null;if("x"in t){const s={x:0,y:0};return[s.x,s.y]=n(t.x,t.y,l),null!=t.z&&(s.z=t.z),null!=t.m&&(s.m=t.m),s}if("xmin"in t){const s={xmin:0,ymin:0,xmax:0,ymax:0};return[s.xmin,s.ymin]=n(t.xmin,t.ymin,l),[s.xmax,s.ymax]=n(t.xmax,t.ymax,l),t.hasZ&&(s.zmin=t.zmin,s.zmax=t.zmax,s.hasZ=!0),t.hasM&&(s.mmin=t.mmin,s.mmax=t.mmax,s.hasM=!0),s}return"rings"in t?{rings:h(t.rings,n),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:h(t.paths,n),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:p(t.points,n),hasM:t.hasM,hasZ:t.hasZ}:void 0}function h(n,t){const s=[];for(const i of n)s.push(p(i,t));return s}function p(n,t){const s=[];for(const i of n){const n=t(i[0],i[1],[0,0]);s.push(n),i.length>2&&n.push(i[2]),i.length>3&&n.push(i[3])}return s}async function m(t,i){if(!i)return;const e=Array.isArray(t)?t.map((t=>n(t.geometry)&&t.geometry.spatialReference)):[t];await s(e.map((n=>({source:n,dest:i}))))}const x=f.bind(null,e),y=f.bind(null,r);function b(n,s,e){return n?(e||(e=s,s=n.spatialReference),o(s)&&o(e)&&!a(s,e)?u(s,e)?c(e)?x(n):y(n):t(i,[n],s,e,null)[0]:n):n}const g=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(n,t,s){if(!n||!n.length||!t||!s||a(t,s))return n;const i={geometries:n,inSpatialReference:t,outSpatialReference:s,resolve:null};return this._jobs.push(i),new Promise((n=>{i.resolve=n,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const n=this._jobs.shift();if(!n)return;const{geometries:s,inSpatialReference:e,outSpatialReference:r,resolve:o}=n;u(e,r)?c(r)?o(s.map(x)):o(s.map(y)):o(t(i,s,e,r,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function j(n,t,s){return g.push(n,t,s)}export{j as M,m as f,b as g}