import{z as r,A as n,a as t,Z as e,J as u,al as i,V as f}from"./p-b7e07897.js";import{hN as o,hP as c,hM as s}from"./p-7b6f6c18.js";import{WhereClause as a}from"./p-8ec48dc4.js";import"./p-ecfd5d6e.js";import"./p-3e28396b.js";import"./p-f78de11d.js";import"./p-227a5838.js";function m(r,e,c,s,m,d){if(1===s.length){if(t(s[0]))return o(i(r,s[0],f(s[1],-1)));if(u(s[0]))return o(i(r,s[0].toArray(),f(s[1],-1)))}else if(2===s.length){if(t(s[0]))return o(i(r,s[0],f(s[1],-1)));if(u(s[0]))return o(i(r,s[0].toArray(),f(s[1],-1)));if(n(s[0]))return s[0].load().then((n=>p(a.create(s[1],n.getFieldsIndex()),d,m).then((n=>s[0].calculateStatistic(r,n,f(s[2],1e3),e.abortSignal)))))}else if(3===s.length&&n(s[0]))return s[0].load().then((n=>p(a.create(s[1],n.getFieldsIndex()),d,m).then((n=>s[0].calculateStatistic(r,n,f(s[2],1e3),e.abortSignal)))));return o(i(r,s,-1))}function p(r,n,t){try{const e=r.getVariables();if(e.length>0){const u=[];for(let r=0;r<e.length;r++)u.push(n.evaluateIdentifier(t,{name:e[r]}));return c(u).then((n=>{const t={};for(let r=0;r<e.length;r++)t[e[r]]=n[r];return r.parameters=t,r}))}return o(r)}catch(r){return s(r)}}function d(i){"async"===i.mode&&(i.functions.stdev=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("stdev",n,0,e,r,i)}))},i.functions.variance=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("variance",n,0,e,r,i)}))},i.functions.average=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("mean",n,0,e,r,i)}))},i.functions.mean=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("mean",n,0,e,r,i)}))},i.functions.sum=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("sum",n,0,e,r,i)}))},i.functions.min=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("min",n,0,e,r,i)}))},i.functions.max=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("max",n,0,e,r,i)}))},i.functions.count=function(f,o){return i.standardFunctionAsync(f,o,(function(i,f,o){if(r(o,1,1),n(o[0]))return o[0].count(i.abortSignal);if(t(o[0])||e(o[0]))return o[0].length;if(u(o[0]))return o[0].length();throw new Error("Invalid Parameters for Count")}))})}export{d as registerFunctions}