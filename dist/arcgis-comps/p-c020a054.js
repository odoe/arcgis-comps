import{bH as e,a7 as t,N as s}from"./p-c8bc3433.js";import"./p-84bf99cb.js";let r;function n(n,a){let o=a.responseType;o?"array-buffer"!==o&&"blob"!==o&&"json"!==o&&"native"!==o&&"native-request-init"!==o&&"text"!==o&&(o="text"):o="json",a.responseType=o;const i=s(a.signal);return delete a.signal,e.invokeStaticMessage("request",{url:n,options:a},{signal:i}).then((async e=>{let s,c,l,u,b;if(e.data)if(e.data instanceof ArrayBuffer){if(!("json"!==o&&"text"!==o&&"blob"!==o||(s=new Blob([e.data]),"json"!==o&&"text"!==o||(r||(r=new FileReaderSync),u=r.readAsText(s),"json"!==o)))){try{c=JSON.parse(u||null)}catch(e){const s={...e,url:n,requestOptions:a};throw new t("request:server",e.message,s)}if(c.error){const e={...c.error,url:n,requestOptions:a};throw new t("request:server",c.error.message,e)}}}else"native"===o&&(e.data.signal=i,l=await fetch(e.data.url,e.data));switch(o){case"blob":b=s;break;case"json":b=c;break;case"native":b=l;break;case"text":b=u;break;default:b=e.data}return{data:b,requestOptions:a,ssl:e.ssl,url:n}}))}export{n as execute}