import{r as t,c as e,g as i}from"./p-53bb6ab4.js";import{V as s,S as r,_ as n,e as o,d as a,i as l,a0 as h,a2 as c,a3 as d,a1 as u,D as p,t as m,v,H as _,c as g,u as w,$ as b,a as f,g as y,ay as M,s as T,af as S,b as j,aU as D,r as k,p as R,m as C,o as L,j as x,z as U,aP as z,k as B,l as A,aD as P,B as $}from"./p-e58503d5.js";import{t as I,x as O,f as N,S as F,w as V,y as H}from"./p-14f07dd1.js";import{h as E}from"./p-e273719b.js";import{h as K}from"./p-54330161.js";import{y as W,n as G,m as q}from"./p-8bc9b36a.js";import{h as Z}from"./p-5f05b534.js";import{m as Y,s as J,r as Q,i as X,t as tt,n as et,c as it}from"./p-b2597a08.js";import st from"./p-dc852195.js";import"./p-b79fcce3.js";import{r as rt}from"./p-a9a30646.js";import nt from"./p-37db6fea.js";import{e as ot}from"./p-b312c1fd.js";import{s as at}from"./p-da9e7ba9.js";import{t as lt}from"./p-b8beb0d3.js";import{S as ht}from"./p-a57a7f49.js";import"./p-5d962998.js";import"./p-78a21eae.js";import"./p-93765525.js";import"./p-765e6c28.js";import"./p-8747982c.js";import"./p-efbca0ca.js";import"./p-ca657fcf.js";import"./p-01e5a461.js";import"./p-fd584619.js";import"./p-7ca40eac.js";import"./p-a87cccba.js";import"./p-181bf7a5.js";import"./p-5400b397.js";import"./p-c048b814.js";import"./p-2e37d910.js";import"./p-2a99994a.js";import"./p-74de0937.js";import"./p-2f398ed1.js";import"./p-d3105731.js";import"./p-7a658388.js";import"./p-fb38a9d0.js";import"./p-f94762ac.js";import"./p-ea916a39.js";import"./p-8a919d07.js";import"./p-7d081d01.js";import"./p-7731c620.js";import"./p-3e39c093.js";import"./p-a24f7752.js";import"./p-ccdb8e80.js";import"./p-c6970847.js";import"./p-a6c8fb32.js";import"./p-6b2eb7a7.js";import"./p-e258f3af.js";import"./p-a131049b.js";import"./p-a2324023.js";import"./p-c1cd5521.js";let ct=class extends st{constructor(t){super(t),this.doNotLocateOnRestrictedElements=null}};o([a({type:Boolean,json:{write:!0}})],ct.prototype,"doNotLocateOnRestrictedElements",void 0),ct=o([l("esri.rest.support.NetworkFeatureSet")],ct);const dt=ct;var ut;let pt=ut=class extends u{constructor(t){super(t),this.accumulateAttributes=null,this.apiKey=null,this.attributeParameterValues=null,this.directionsLanguage=null,this.directionsLengthUnits=null,this.directionsOutputType=null,this.directionsStyleName=null,this.directionsTimeAttribute=null,this.findBestSequence=null,this.ignoreInvalidLocations=null,this.impedanceAttribute=null,this.outputGeometryPrecision=null,this.outputGeometryPrecisionUnits=null,this.outputLines="true-shape",this.outSpatialReference=null,this.pointBarriers=null,this.polygonBarriers=null,this.polylineBarriers=null,this.preserveFirstStop=null,this.preserveLastStop=null,this.restrictionAttributes=null,this.restrictUTurns=null,this.returnBarriers=!1,this.returnDirections=!1,this.returnPolygonBarriers=!1,this.returnPolylineBarriers=!1,this.returnRoutes=!0,this.returnStops=!1,this.returnZ=!0,this.startTime=null,this.startTimeIsUTC=!0,this.stops=null,this.travelMode=null,this.useHierarchy=null,this.useTimeWindows=null}readStartTime(t,e){return null!=e.startTime?new Date(e.startTime):null}writeStartTime(t,e){e.startTime=t?t.getTime():null}clone(){return new ut(p({accumulateAttributes:this.accumulateAttributes,apiKey:this.apiKey,attributeParameterValues:this.attributeParameterValues,directionsLanguage:this.directionsLanguage,directionsLengthUnits:this.directionsLengthUnits,directionsOutputType:this.directionsOutputType,directionsStyleName:this.directionsStyleName,directionsTimeAttribute:this.directionsTimeAttribute,findBestSequence:this.findBestSequence,ignoreInvalidLocations:this.ignoreInvalidLocations,impedanceAttribute:this.impedanceAttribute,outputGeometryPrecision:this.outputGeometryPrecision,outputGeometryPrecisionUnits:this.outputGeometryPrecisionUnits,outputLines:this.outputLines,outSpatialReference:this.outSpatialReference,pointBarriers:this.pointBarriers,polygonBarriers:this.polygonBarriers,polylineBarriers:this.polylineBarriers,preserveFirstStop:this.preserveFirstStop,preserveLastStop:this.preserveLastStop,restrictionAttributes:this.restrictionAttributes,restrictUTurns:this.restrictUTurns,returnBarriers:this.returnBarriers,returnDirections:this.returnDirections,returnPolygonBarriers:this.returnPolygonBarriers,returnPolylineBarriers:this.returnPolylineBarriers,returnRoutes:this.returnRoutes,returnStops:this.returnStops,returnZ:this.returnZ,startTime:this.startTime,startTimeIsUTC:this.startTimeIsUTC,stops:this.stops,travelMode:this.travelMode,useHierarchy:this.useHierarchy,useTimeWindows:this.useTimeWindows}))}};o([a({type:[String],json:{write:!0}})],pt.prototype,"accumulateAttributes",void 0),o([a(I)],pt.prototype,"apiKey",void 0),o([a({json:{write:!0}})],pt.prototype,"attributeParameterValues",void 0),o([a({type:String,json:{write:!0}})],pt.prototype,"directionsLanguage",void 0),o([rt(J)],pt.prototype,"directionsLengthUnits",void 0),o([rt(Q)],pt.prototype,"directionsOutputType",void 0),o([a({type:String,json:{write:!0}})],pt.prototype,"directionsStyleName",void 0),o([a({type:String,json:{write:!0}})],pt.prototype,"directionsTimeAttribute",void 0),o([a({json:{write:!0}})],pt.prototype,"findBestSequence",void 0),o([a({json:{write:!0}})],pt.prototype,"ignoreInvalidLocations",void 0),o([a({type:String,json:{read:{source:"impedanceAttributeName"},write:{target:"impedanceAttributeName"}}})],pt.prototype,"impedanceAttribute",void 0),o([a({type:Number,json:{write:!0}})],pt.prototype,"outputGeometryPrecision",void 0),o([rt(X)],pt.prototype,"outputGeometryPrecisionUnits",void 0),o([rt(tt)],pt.prototype,"outputLines",void 0),o([a({type:h,json:{write:!0}})],pt.prototype,"outSpatialReference",void 0),o([a({json:{write:!0}})],pt.prototype,"pointBarriers",void 0),o([a({json:{write:!0}})],pt.prototype,"polygonBarriers",void 0),o([a({json:{write:!0}})],pt.prototype,"polylineBarriers",void 0),o([a({json:{write:!0}})],pt.prototype,"preserveFirstStop",void 0),o([a({json:{write:!0}})],pt.prototype,"preserveLastStop",void 0),o([a({type:[String],json:{write:!0}})],pt.prototype,"restrictionAttributes",void 0),o([rt(et)],pt.prototype,"restrictUTurns",void 0),o([a({type:Boolean,json:{write:!0}})],pt.prototype,"returnBarriers",void 0),o([a({type:Boolean,json:{write:!0}})],pt.prototype,"returnDirections",void 0),o([a({type:Boolean,json:{write:!0}})],pt.prototype,"returnPolygonBarriers",void 0),o([a({type:Boolean,json:{write:!0}})],pt.prototype,"returnPolylineBarriers",void 0),o([a({type:Boolean,json:{write:!0}})],pt.prototype,"returnRoutes",void 0),o([a({type:Boolean,json:{write:!0}})],pt.prototype,"returnStops",void 0),o([a({type:Boolean,json:{write:!0}})],pt.prototype,"returnZ",void 0),o([a({type:Date,json:{type:Number,write:!0}})],pt.prototype,"startTime",void 0),o([c("startTime")],pt.prototype,"readStartTime",null),o([d("startTime")],pt.prototype,"writeStartTime",null),o([a({type:Boolean,json:{write:!0}})],pt.prototype,"startTimeIsUTC",void 0),o([a({json:{write:!0}})],pt.prototype,"stops",void 0),o([a({type:Y,json:{write:!0}})],pt.prototype,"travelMode",void 0),o([a({type:Boolean,json:{write:!0}})],pt.prototype,"useHierarchy",void 0),o([a({type:Boolean,json:{write:!0}})],pt.prototype,"useTimeWindows",void 0),pt=ut=o([l("esri.rest.support.RouteParameters")],pt);const mt=pt;function vt(t){return"esriNAUSeconds"===t||"esriNAUMinutes"===t||"esriNAUHours"===t||"esriNAUDays"===t}function _t(t,e,i){const s=vt(e),r=vt(i),n=s?gt(t,e):wt(t,e);return s===r?r?function(t,e){return gt(t,e,!0)}(n,i):function(t,e){return wt(t,e,!0)}(n,i):t}function gt(t,e,i){switch(t=t||0,e){case"esriNAUSeconds":t/=60**(i?-1:1);break;case"esriNAUHours":t*=60**(i?-1:1);break;case"esriNAUDays":t*=1440**(i?-1:1)}return t}function wt(t,e,i){switch(t=t||0,(e||"").replace("esriNAU","esri")){case"esriInches":t*=.0254**(i?-1:1);break;case"esriFeet":t*=.3048**(i?-1:1);break;case"esriYards":t*=.9144**(i?-1:1);break;case"esriMiles":t*=1609.344**(i?-1:1);break;case"esriNauticalMiles":t*=1851.995396854**(i?-1:1);break;case"esriMillimeters":t/=1e3**(i?-1:1);break;case"esriCentimeters":t/=100**(i?-1:1);break;case"esriKilometers":t*=1e3**(i?-1:1);break;case"esriDecimeters":t/=10**(i?-1:1)}return t}function bt(t){return t&&t.get("attributes.isWaypoint")}function ft(t){return t._associatedStop}function yt(t,e={}){const{unit:i="minutes"}=e;return function(t,e){const i="days"===(e=e.toLowerCase())?24*t:"hours"===e?t:"minutes"===e?t/60:t/60/60;if(i<1)return`${Math.floor(60*i)}m`;const s=i%1*60;return`${Math.floor(i)}:${String(Math.floor(s)).padStart(2,"0")}h`}(t,i)}function Mt(t,e,i,s={}){const{fromUnits:r,toUnits:n}=s,o=_t(i,r,n);if(!o)return"";const a=e.units[n],l=a?a.abbr:n.replace("esri","").toLowerCase();return _(t.distanceTemplate,{distance:o,units:l},{format:{distance:{type:"number",intlOptions:{minimumFractionDigits:2,maximumFractionDigits:2}}}})}const Tt=g.getLogger("esri.widgets.Directions.DirectionsViewModel"),St={first:new W({color:[105,220,255,1],size:19,outline:{color:[51,51,51,1],width:3}}),middle:new W({color:[51,51,51,1],size:12,outline:{color:[105,220,255,1],width:3}}),last:new G({width:23,height:23,url:`data:image/svg+xml;base64,${btoa('<svg width="30" height="30" viewBox="0 0 30 30" xmlns="http://www.w3.org/2000/svg"><g fill-rule="nonzero" fill="none"><path d="M15.15.3C6.9.3.3 6.9.3 15.15S6.9 29.7 15.15 29.7 29.7 23.1 29.7 15.15C29.7 6.9 23.25.3 15.15.3z" fill="#333"/><path d="M15 4.8C9.3 4.8 4.8 9.45 4.8 15c0 5.55 4.65 10.2 10.2 10.2 5.55 0 10.2-4.5 10.2-10.2 0-5.55-4.5-10.2-10.2-10.2z" fill="#69DCFF"/><path fill="#333" d="M10.5 10.5h9v9h-9z"/></g></svg>')}`}),unlocated:new G({height:18,width:18,url:`data:image/svg+xml;base64,${btoa('<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><g fill="none" fill-rule="evenodd"><path d="M10.1.2C4.6.2.2 4.6.2 10.1s4.4 9.7 9.9 9.7 9.7-4.4 9.7-9.7c0-5.5-4.3-9.9-9.7-9.9z" fill="#333" fill-rule="nonzero"/><path d="M10 2.7c-4.08 0-7.3 3.328-7.3 7.3s3.328 7.3 7.3 7.3 7.3-3.22 7.3-7.3c0-3.972-3.22-7.3-7.3-7.3z" fill="#69DCFF" fill-rule="nonzero"/><path d="M11.414 10l5.304-5.303-1.415-1.415L10 8.586 4.697 3.282 3.282 4.697 8.586 10l-5.304 5.303 1.415 1.415L10 11.414l5.303 5.304 1.415-1.415L11.414 10z" fill="#333"/></g></svg>')}`}),waypoint:new W({color:[255,255,255,1],size:10,outline:{color:[20,89,127,1],width:2.5}})};let jt=class extends(ot(k.EventedAccessor)){constructor(t){super(t),this._handles=new w,this._routeLayer=new Z({listMode:"hide"}),this._highlightLayer=new Z({listMode:"hide"}),this._stopId=9999,this._stopLayer=new Z({listMode:"hide"}),this._serviceDescriptionLoadStatus=0,this.apiKey=void 0,this.departureTime="now",this.lastRoute=null,this.routeSymbol=new q({color:[105,220,255,1],width:7,cap:"round",join:"round"}),this.routeParameters=new mt({ignoreInvalidLocations:!0,directionsOutputType:"complete",findBestSequence:!1,preserveFirstStop:!0,preserveLastStop:!0,restrictUTurns:"at-dead-ends-and-intersections",directionsLengthUnits:"kilometers",returnBarriers:!1,returnDirections:!0,returnPolygonBarriers:!1,returnPolylineBarriers:!1,returnRoutes:!1,returnStops:!0,returnZ:!0,startTime:null,startTimeIsUTC:!0,stops:null,useHierarchy:!0,useTimeWindows:!1}),this.routeServiceUrl="https://route-api.arcgis.com/arcgis/rest/services/World/Route/NAServer/Route_World",this.serviceDescription=null,this.error=null,this.stops=new r,this.view=null}initialize(){this._handles.add([b(this,"stops","change",(()=>{this.clearResults(),this._addStopsToLayer()})),f(this,"view.map",((t,e)=>{const i=[this._routeLayer,this._stopLayer,this._highlightLayer];e&&e.removeMany(i),t&&t.addMany(i)})),y(this,"lastRoute",(()=>this._addRouteToLayer()))])}destroy(){this.stops.destroy();const t=this.get("view.map");t&&t.removeMany([this._routeLayer,this._stopLayer,this._highlightLayer])}get _directionsLanguage(){const{routeParameters:t,serviceDescription:e}=this,{directionsSupportedLanguages:i}=e;if(!i)return;const s=(t.directionsLanguage||M()).slice(0,2);return i.find((t=>t.toLowerCase().slice(0,2)===s))}get _routeTask(){return new nt(this.routeServiceUrl)}get impedanceAttribute(){var t,e,i,s,r,n;const o=null!=(t=null!=(e=null==(i=this.routeParameters)||null==(s=i.travelMode)?void 0:s.impedanceAttributeName)?e:null==(r=this.routeParameters)?void 0:r.impedanceAttribute)?t:null==(n=this.serviceDescription)?void 0:n.impedance;return this.getCostAttribute(o)}set maxStops(t){this._set("maxStops",t=t<=2?2:t>50?50:t)}get selectedTravelMode(){const{serviceDescription:t}=this;if(!t)return null;const{defaultTravelMode:e,supportedTravelModes:i=[]}=t;let s=null;for(let t=0;t<i.length;t++)i[t].id===e&&(s=i[t]);return s||i[0]||null}set selectedTravelMode(t){void 0!==t?this._override("selectedTravelMode",t):this._clearOverride("selectedTravelMode")}get state(){const t=this._serviceDescriptionLoadStatus;return 4===t?"unauthenticated":0===t?"disabled":1===t?"initializing":this._activeRouteController?"routing":3===t||this.error?"error":"ready"}set stopSymbols(t){const e={...St,...t};this._set("stopSymbols",e)}get timeAttribute(){var t,e,i,s,r,n;const o=null!=(t=null!=(e=null==(i=this.routeParameters)||null==(s=i.travelMode)?void 0:s.timeAttributeName)?e:null==(r=this.routeParameters)?void 0:r.directionsTimeAttribute)?t:null==(n=this.serviceDescription)?void 0:n.directionsTimeAttribute;return this.getCostAttribute(o)}get travelModes(){var t,e;return null!=(t=null==(e=this.serviceDescription)?void 0:e.supportedTravelModes)?t:[]}async load(){if(!this.serviceDescription)try{this._serviceDescriptionLoadStatus=1,this.notifyChange("state"),await this._loadServiceDescription(),this._serviceDescriptionLoadStatus=2,this.notifyChange("state")}catch(t){const e="identity-manager:user-aborted"===t.name;if(this._serviceDescriptionLoadStatus=e?4:3,this.notifyChange("state"),!e){const e=new T("directions-view-model:service-metadata-unavailable","Cannot load route service metadata",{error:t});throw this._set("error",e),e}}}highlightSegment(t){const{view:e,_highlightLayer:i}=this;if(!e||S(t.symbol))return;this.clearHighlights();const s=t.symbol.clone();s.color=new E([0,0,0,.8]),s.width=Math.ceil(s.width/2);const r=new K({geometry:t.geometry,symbol:s});i.graphics.add(r)}clearHighlights(){this._highlightLayer.graphics.removeAll()}centerAt(t){const{view:e}=this;e&&this.callGoTo({target:t})}clearResults(){this._set("lastRoute",null)}getDirections(){const{state:t}=this;if("unauthenticated"===t||"initializing"===t||"disabled"===t||3===this._serviceDescriptionLoadStatus)return Promise.reject(new T("directions-view-model:not-loaded","Cannot get directions until view model loads."));this._set("error",null),this._activeRouteController&&(this._activeRouteController.abort(),this._activeRouteController=null);const{apiKey:e,departureTime:i}=this,s="now"===i,r="now"===i?new Date:i;if(r&&!s){const t=60*r.getTimezoneOffset()*1e3;r.setTime(r.getTime()-t)}const n=this.routeParameters.clone();if(n.set({startTime:r,startTimeIsUTC:s,directionsLanguage:this._directionsLanguage,apiKey:e}),this.selectedTravelMode&&(n.travelMode=this.selectedTravelMode),this.stops.length<=1){const t=new T("directions-view-model:not-enough-stops","Not enough stops for routing");return this._set("error",t),Promise.reject(t)}const o=new AbortController,{signal:a}=o;this._activeRouteController=o;const l=this._enqueue((()=>{const t=this.stops.clone().toArray(),e={},i=i=>{const s=i&&i.routeResults&&i.routeResults[0]&&i.routeResults[0].stops||[];(i&&i.routeResults&&i.routeResults[0]&&i.routeResults[0].directions&&i.routeResults[0].directions.features||[]).map((i=>{for(let s=0;s<t.length;s++)if(i.attributes.text.indexOf(t[s].attributes.Name)>-1){const r=t[s].attributes.Name;i.attributes.text=i.attributes.text.replace(r,e[r]),i._associatedStop=t[s];break}})),t.map((t=>t.attributes.Name=e[t.attributes.Name])),s.map((t=>{t.attributes.Name=e[t.attributes.Name]}))},s=t=>{if(t&&t.routeResults&&t.routeResults[0]){const e=t.routeResults[0],i=e.stops||[],s=this.stops.clone().toArray();let r=e.directions&&e.directions.routeName||e.routeName||"";i.map(((t,e)=>{const i=t.attributes,n=s[e].attributes;r=r.replace(i.Name,n.Name),Object.keys(i).forEach((t=>{0===t.indexOf("Cumul_")&&(n[t]=i[t])})),n.ArriveCurbApproach=i.ArriveCurbApproach,n.ArriveTime=i.ArriveTime,n.ArriveTimeUTC=i.ArriveTimeUTC,n.DepartCurbApproach=i.DepartCurbApproach,n.DepartTime=i.DepartTime,n.DepartTimeUTC=i.DepartTimeUTC,n.Sequence=i.Sequence,n.Status=i.Status})),e.directions&&(e.directions.routeName=r),null!==e.route&&(e.route.attributes.Name=r),e.routeName=r}},r=t=>{const i=t&&t.routeResults&&t.routeResults[0]&&t.routeResults[0].stops||[],s=this.stops.toArray();let r=i.length===s.length,n=0;for(;r&&n<i.length;)r=r&&e[i[n].attributes.Name]===s[n++].attributes.Name;return r};return(()=>{t.map((t=>{const i=t.attributes,s=`${(i.Name||"[not yet geocoded]").substr(0,100)}_#${++this._stopId}`;e[s]=i.Name,i.Name=s}))})(),n.stops=new dt({doNotLocateOnRestrictedElements:!0,features:t}),this._routeTask.solve(n,{signal:a}).then((t=>r(t)?(s(t),i(t),this._set("lastRoute",t),t):(Tt.warn("Response stops don't match current stops of the ViewModel, invalidating the results."),this._set("lastRoute",null),null))).catch((t=>{throw i(null),t}))})).then((t=>(this._activeRouteController=null,this.notifyChange("state"),this.zoomToRoute(),t))).catch((t=>{if(this._activeRouteController=null,this.notifyChange("state"),!j(t))throw t=new T("directions-view-model:unable-to-route","Unable to route to these addresses",{error:t}),this._set("error",t),t}));return this.notifyChange("state"),l}getCostAttribute(t){const e=this.serviceDescription&&this.serviceDescription.networkDataset.networkAttributes||[];let i="";for(let s=0;s<e.length;s++)if(e[s].name===t&&"esriNAUTCost"===e[s].usageType){i=e[s];break}return i}reset(){this.stops.removeAll(),this.clearHighlights(),this._set("lastRoute",null)}zoomToRoute(){const{directionLines:t,view:e}=this;if(!t||!e)return;const i=function(t){if(!t||!t.length)return null;let e=s(r.isCollection(t)?t.getItemAt(0).geometry:t[0].geometry),i=e.extent&&e.extent.clone(),o=e;null===i&&(i=new n(o.x,o.y,o.x,o.y,e.spatialReference));for(let a=1;a<t.length;a++){e=s(r.isCollection(t)?t.getItemAt(a).geometry:t[a].geometry),o=e;let l=e.extent;null===l&&(l=new n(o.x,o.y,o.x,o.y,e.spatialReference)),i=i.union(l)}return i.width<0&&i.height<0?null:i}(t);this.callGoTo({target:i.expand(i.width>i.height?2:1)})}async _loadServiceDescription(){const t=await it(this.routeServiceUrl,this.apiKey);this._set("serviceDescription",t)}_enqueue(t){this._requestQueueTail||(this._requestQueueTail=Promise.resolve());const e=new Promise(((e,i)=>{this._requestQueueTail.catch((()=>{})).then((()=>{try{const s=t.call(this);D(s)?s.then(e,i):e(s)}catch(t){i(t)}}))}));return this._requestQueueTail=e,e}_addStopsToLayer(){this._stopLayer.graphics.removeAll();const t=this.stops.clone().map(((t,e)=>{const{first:i,middle:s,last:r,unlocated:n,waypoint:o}=this.stopSymbols;return t.symbol=bt(t)?o:void 0===t.attributes.Status?0===e?i:e===this.stops.length-1?r:s:bt(t)?o:function(t){const e=t&&t.get("attributes.Status");return!e||6===e}(t)?function(t){const e=t&&t.attributes||{};return null===(e.ArriveCurbApproach||null)&&null!==(e.DepartCurbApproach||null)}(t)?i:function(t){const e=t&&t.attributes||{};return null!==(e.ArriveCurbApproach||null)&&null===(e.DepartCurbApproach||null)}(t)?r:s:n,t}));this._stopLayer.graphics.addMany(t)}_addRouteToLayer(){this._routeLayer.graphics.removeAll();const{directionLines:t}=this;t&&(t.forEach((t=>{t.symbol=this.routeSymbol})),this._routeLayer.graphics.addMany(t))}};o([a()],jt.prototype,"_directionsLanguage",null),o([a({type:nt})],jt.prototype,"_routeTask",null),o([a()],jt.prototype,"apiKey",void 0),o([a()],jt.prototype,"departureTime",void 0),o([a({aliasOf:"lastRoute.routeResults.0.directions.features"})],jt.prototype,"directionLines",void 0),o([a({readOnly:!0})],jt.prototype,"impedanceAttribute",null),o([a({readOnly:!0})],jt.prototype,"lastRoute",void 0),o([a({value:50})],jt.prototype,"maxStops",null),o([a()],jt.prototype,"routeSymbol",void 0),o([a({type:mt})],jt.prototype,"routeParameters",void 0),o([a()],jt.prototype,"routeServiceUrl",void 0),o([a()],jt.prototype,"selectedTravelMode",null),o([a({readOnly:!0})],jt.prototype,"serviceDescription",void 0),o([a({readOnly:!0})],jt.prototype,"state",null),o([a()],jt.prototype,"error",void 0),o([a({type:r})],jt.prototype,"stops",void 0),o([a({value:St})],jt.prototype,"stopSymbols",null),o([a({readOnly:!0})],jt.prototype,"timeAttribute",null),o([a()],jt.prototype,"travelModes",null),o([a()],jt.prototype,"view",void 0),o([a()],jt.prototype,"getDirections",null),o([a()],jt.prototype,"zoomToRoute",null),jt=o([l("esri.widgets.Directions.DirectionsViewModel")],jt);const Dt=jt;let kt=class extends R{constructor(){super(...arguments),this.messages=null,this.messagesUnits=null}get primary(){const t=this.get("directionsViewModel.lastRoute.routeResults.0.directions"),e=this.directionsViewModel.impedanceAttribute,i=this.get("directionsViewModel.routeParameters.directionsLengthUnits");return vt(e.units)?yt(t.totalTime,{unit:e.units.replace("esriNAU","")}):Mt(this.messages,this.messagesUnits,t.totalLength,{toUnits:i})}get secondary(){const t=this.get("directionsViewModel.lastRoute.routeResults.0.directions"),e=this.get("directionsViewModel.routeParameters.directionsLengthUnits"),{impedanceAttribute:i}=this.directionsViewModel;return vt(i.units)?Mt(this.messages,this.messagesUnits,t.totalLength,{toUnits:e}):yt(t.totalTime)}};o([a()],kt.prototype,"directionsViewModel",void 0),o([a()],kt.prototype,"messages",void 0),o([a()],kt.prototype,"messagesUnits",void 0),o([a({readOnly:!0})],kt.prototype,"primary",null),o([a({readOnly:!0})],kt.prototype,"secondary",null),kt=o([l("esri.widgets.Directions.support.CostSummary")],kt);const Rt=kt,Ct={esriDMTBearLeft:"bear-left",esriDMTBearRight:"bear-right",esriDMTDoorPassage:"walk-through-door",esriDMTElevator:"elevator",esriDMTEndOfFerry:"disembark",esriDMTEscalator:"escalator",esriDMTFerry:"embark",esriDMTForkCenter:"fork-middle",esriDMTForkLeft:"fork-left",esriDMTForkRight:"fork-right",esriDMTHighwayChange:"highway-change",esriDMTHighwayExit:"exit-highway-right",esriDMTHighwayMerge:"merge-on-highway",esriDMTPedestrianRamp:"take-pedestrian-ramp",esriDMTRampLeft:"ramp-left",esriDMTRampRight:"ramp-right",esriDMTRoundabout:"roundabout-left",esriDMTSharpLeft:"sharp-left",esriDMTSharpRight:"sharp-right",esriDMTStairs:"stairs",esriDMTStraight:"straight",esriDMTTurnLeft:"left",esriDMTTurnLeftLeft:"left-left",esriDMTTurnLeftRight:"left-right",esriDMTTurnRight:"right",esriDMTTurnRightLeft:"right-left",esriDMTTurnRightRight:"right-right",esriDMTUnknown:"unknown",esriDMTUTurn:"u-turn-left"},Lt="esri-directions__stop-icon",xt="esri-directions__stop-icon--interactive";let Ut=class extends R{constructor(t){super(t),this.maneuvers=[],this.name=null,this.open=!1}};o([a()],Ut.prototype,"maneuvers",void 0),o([a()],Ut.prototype,"name",void 0),o([a()],Ut.prototype,"open",void 0),Ut=o([l("esri.widgets.Directions.support.RouteSection")],Ut);const zt=Ut;let Bt=class extends R{constructor(t){super(t),this.routePath=null}get sections(){const t=this.routePath;return t?this._createSections(t):[]}_createSections(t){const e=(t=this._filterDuplicateStops(t)).map(((t,e)=>ft(t)?e:-1)).filter((t=>t>-1));return e.map(((i,s)=>{const r=ft(t[i]).attributes.Name,n=s===e.length-1?[]:t.slice(e[s]+1,e[s+1]);return new zt({name:r,maneuvers:n,open:0===s})}))}_filterDuplicateStops(t){let e;return t.filter((t=>{const i=ft(t),s=i===e;return e=i,!i||!s}))}};o([a()],Bt.prototype,"routePath",void 0),o([a({readOnly:!0})],Bt.prototype,"sections",null),Bt=o([l("esri.widgets.Directions.support.RouteSections")],Bt);const At=Bt,Pt={hour:"numeric",minute:"numeric"},$t={minimumIntegerDigits:2};function It(t){const e=t.getTimezoneOffset(),i=e>0?"-":"+",s=Math.abs(Math.floor(e/60)),r=Math.abs(Math.floor(e)%60);return`GMT${i}${v(s,$t)}${v(r,$t)}`}function Ot(t){return!(null==t.composedPath||!t.composedPath().find((t=>{var e;return null==(e=t.classList)?void 0:e.contains("esri-search__suggestions-list")})))}let Nt=class extends U{constructor(t,e){super(t,e),this._autoStopRemovalDelay=100,this._costSummary=new Rt,this._departureTime="now",this._datePicker=new O,this._handles=new w,this._newPlaceholderStop=null,this._pointerPressedSearchSuggestionStop=null,this._routeSections=new At,this._stops=new r([{},{}]),this._stopsToSearches=new Map,this._timePicker=new N,this.apiKey=null,this.goToOverride=null,this.headingLevel=2,this.iconClass="esri-icon-directions",this.label=void 0,this.lastRoute=null,this.maxStops=null,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.routeServiceUrl=void 0,this.routeSymbol=null,this.searchProperties=null,this.stopSymbols=null,this.view=null,this.viewModel=new Dt,this._setUpDragAndDropStops=t=>{this._sortable=ht.create(t,{draggable:".esri-directions__stop-row--valid",ghostClass:"esri-directions__stop-row-ghost",handle:".esri-directions__stop-handle",onEnd:this._handleStopInputDragEnd})},this._handleDragHandlePointerDown=()=>this._stops.forEach((t=>this._acquireSearch(t).activeMenu="none")),this._handleStopInputDragEnd=({oldIndex:t,newIndex:e,target:i})=>{if(t===e)return;const{children:s}=i,r=s[t];i.insertBefore(s[e],e-t<0?r.nextElementSibling:r);const n=this._stops;n.reorder(n.getItemAt(t),e),this._processStops()}}initialize(){this.own([f(this,"viewModel.lastRoute",(()=>{this._routeSections.routePath=this.get("viewModel.directionLines"),this._activeManeuver=null,this._focusedManeuver=null,this.scheduleRender()})),f(this,"viewModel.selectedTravelMode, viewModel.departureTime",(()=>{this.get("viewModel.stops.length")>1&&this.getDirections()})),z(this,"view",((t,e)=>{if(e&&(this._viewClickHandle=null,this._handles.remove(e)),t){const e=this._prepPointerDownUpClick(),i=this._prepViewClick();e.pause(),i.pause(),this._handles.add([$(t.surface,"mousedown",(()=>this._autoStopRemovalDelay=500)),$(t.surface,"mouseup",(()=>this._autoStopRemovalDelay=100)),e,i],this.view.surface),this._pointerDownUpHandle=e,this._viewClickHandle=i}})),B(this,"routeServiceUrl",(()=>this.viewModel.load())),y(this,"viewModel.stops.length",(t=>{0===t&&(this._stops.toArray().forEach((t=>this._removeStop(t,!0))),this._stops.addMany([{},{}]),this.scheduleRender())}))])}destroy(){this._datePicker.destroy(),this._timePicker.destroy(),this._stopsToSearches.forEach((t=>t.destroy())),this._sortable&&this._sortable.destroy()}getDirections(){return null}zoomToRoute(){}render(){return A("div",{class:this.classes("esri-directions esri-widget esri-widget--panel","esri-directions__scroller")},this._renderPanelContent())}_renderPanelContent(){const{viewModel:{state:t}}=this,e="initializing"===t,i="error"===t&&!this.viewModel.serviceDescription,s="unauthenticated"===t,r={"esri-directions__panel-content--loading":e,"esri-directions__panel-content--error":i,"esri-directions__panel-content--sign-in":s},n=e?"presentation":"group",o=s?this._renderSignIn():i?this._renderMessage(this._getErrorMessage()):e?this._renderLoader():this._renderReadyContent();return A("div",{class:this.classes("esri-directions__panel-content",r),role:n},o)}_renderReadyContent(){return[this._renderStopsContainer(),this._renderTravelModeOptions(),this._renderDepartureTimeControls(),this._renderSectionSplitter(),this._renderDirectionsContainer(),this._renderDisclaimer()]}_renderSignIn(){return A("div",{key:"sign-in",class:"esri-directions__sign-in-content"},A(at,{class:"esri-directions__content-title",level:this.headingLevel},this.messages.widgetLabel),this._renderPlaceholder(),A(at,{level:this.headingLevel+1},this.messages.signInRequired),A("button",{class:this.classes("esri-button","esri-button--secondary","esri-directions__sign-in-button"),tabIndex:0,onclick:this._handleSignInClick,bind:this,type:"button"},this.messagesCommon.auth.signIn))}_handleSignInClick(){this.viewModel.load().catch((()=>{}))}_renderTravelModeOptions(){const{travelModes:t}=this.viewModel;if(0===t.length)return null;const{selectedTravelMode:e}=this.viewModel,i=e.name||this.messages.travelMode;return A("select",{"aria-label":i,bind:this,class:this.classes("esri-directions__travel-modes-select","esri-select"),key:"esri-directions__travel-mode-options",onchange:this._handleTravelModeChange,title:i},t.map((t=>A("option",{key:t,"data-mode":t,selected:t.id===e.id,value:t.id},t.name))))}_handleTravelModeChange(t){const e=t.currentTarget,i=e.item(e.selectedIndex);this.viewModel.selectedTravelMode=i["data-mode"]}_renderStopsContainer(){return A("div",{class:"esri-directions__section",key:"esri-directions__stops-container",role:"group"},this._renderStops())}_renderDepartureTimeControls(){const t=this._departureTime,{messages:e}=this,i=e.departureTime;return A("div",{class:"esri-directions__departure-time",key:"esri-directions__departure-time-controls",role:"group"},A("select",{"aria-label":i,bind:this,class:this.classes("esri-directions__departure-time-select","esri-select"),onchange:this._handleDepartureOptionChange,title:i},A("option",{value:"now",selected:"now"===t},e.leaveNow),A("option",{value:"depart-by",selected:"depart-by"===t},e.departBy),A("option",{value:"unspecified",selected:"unspecified"===t},e.timeUnspecified)),"depart-by"===t?this._renderTimeControls():null)}_renderStops(){const t=this._stops;let e=0;t.forEach((t=>{"none"!==this._acquireSearch(t).activeMenu&&(e+=1)}));const i=t.toArray().map(((i,s)=>{const r=t.length,n=s>1&&!i.result,o={"esri-icon-radio-unchecked":s>=0&&s<r-1,"esri-icon-radio-checked":s===r-1},a={"esri-directions__stop-icon-container--last":s===r-1},l={"esri-directions__stop-row--valid":!n},h=t.getItemAt(r-1),c=h&&h.result,d=t.getItemAt(s+1),u=s===r-1,p=s===r-2,m=2===r&&0===s||r>2&&!u&&!p||r>2&&p&&d&&d.result||r>2&&u&&!i.result,v=2===r||3===r&&!c||n,g=this._acquireSearch(i),{messages:w}=this,{removeStop:b,reverseStops:f,unlocated:y}=w,M=_(w.stopLabelTemplate,{number:s+1,label:i.result?i.result.name:y}),T=`${this.id}__stop--${s}`,S=!!g.searchTerm&&!!g.selectedResult&&!!i.result&&g.selectedResult===i.result,j={zIndex:"none"!==g.activeMenu?""+e--:""};return A("li",{"aria-label":M,afterCreate:this._handleStopFieldCreation,bind:this,class:this.classes("esri-directions__stop-row",l),id:T,key:s,"data-stop-index":s,styles:j},A("div",{class:"esri-directions__stop-handle"},A("span",{"aria-hidden":"true",class:this.classes(Lt,"esri-icon-handle-vertical","esri-directions__stop-handle-icon",xt),onpointerdown:this._handleDragHandlePointerDown}),A("div",{bind:this,"aria-labelledby":T,class:this.classes("esri-directions__stop-icon-container",a),"data-stop-index":s,onclick:this._handleStopIconClick,onkeydown:this._handleStopIconClick,role:"button"},A("span",{class:this.classes(Lt,o),tabindex:S?"0":null}))),A("div",{class:"esri-directions__stop-input"},g.render()),A("div",{class:"esri-directions__stop-options",role:"group"},A("div",{"aria-label":b,class:"esri-directions__remove-stop",bind:this,"data-stop-index":s,hidden:v,onkeydown:this._handleRemoveStop,onclick:this._handleRemoveStop,role:"button",tabIndex:0,title:b},A("span",{"aria-hidden":"true",class:this.classes(Lt,"esri-directions__remove-stop-icon","esri-icon-trash",xt)}),A("span",{class:"esri-icon-font-fallback-text"},"removeStopTitle")),A("div",{"aria-label":f,class:"esri-directions__reverse-stops",bind:this,hidden:m,onkeydown:this._handleReverseStops,onclick:this._handleReverseStops,role:"button",tabIndex:0,title:f},A("span",{"aria-hidden":"true",class:this.classes(Lt,"esri-icon-up-down-arrows",xt)}),A("span",{class:"esri-icon-font-fallback-text"},"removeStopTitle"))))})),s=t.every((t=>{const e=this._stopsToSearches.get(t);return t.result&&e.selectedResult===t.result})),r=this.messages.addStop,n=t.length>=2&&s&&!(this._stops.length>=this.maxStops)?A("div",{"aria-label":r,bind:this,class:"esri-directions__add-stop",key:"esri-directions__add-stop",onfocus:this._handleAddStopFocus,tabIndex:0},A("span",{"aria-hidden":"true",class:this.classes("esri-icon-plus",Lt,xt)}),A("div",{"aria-hidden":"true",class:"esri-directions__add-stop-text"},r)):null;return A("div",null,A("ol",{class:"esri-directions__stops",role:"group",afterCreate:this._setUpDragAndDropStops},i),n)}_handleStopIconClick(t){const e=this._stops.getItemAt(t.currentTarget["data-stop-index"]);e&&e.result&&this._centerAtStop(e)}_handleClearRouteClick(){this.viewModel.reset()}_centerAtStop(t){this.viewModel.centerAt(t.result.feature)}_handleStopFieldCreation(t){const e=this._newPlaceholderStop;if(!e)return;const i=this._stops.getItemAt(t["data-stop-index"]);if(e===i){const t=this._acquireSearch(i);t.when((()=>{this.renderNow(),t.focus()}))}this._newPlaceholderStop=null}_handleStopInputBlur(t,e){if(this._handles.remove("awaiting-view-click-stop"),this.view.cursor=this._previousCursor,!t.selectedResult||!e.result||t.selectedResult!==e.result)return"none"!==t.activeMenu||!t.searchTerm||t.selectedResult===e.result&&(t.selectedResult||e.result)?void(t.searchTerm||(this._viewClickHandle.resume(),clearTimeout(this._autoStopRemovalTimeoutId),this._autoStopRemovalTimeoutId=setTimeout((()=>{this.destroyed||(this._viewClickHandle.pause(),"searching"!==t.viewModel.state?this._pointerPressedSearchSuggestionStop||(this._removeStop(e),!!e.result&&(e.result=null,this._processStops()),this.scheduleRender()):this._pointerDownUpHandle.pause())}),this._autoStopRemovalDelay))):(t.search(),void this._pointerDownUpHandle.pause());this._pointerDownUpHandle.pause()}_handleStopInputFocus(t,e){if(this._pointerDownUpHandle.resume(),this._handles.has("awaiting-view-click-stop"))return;const{view:i,view:{cursor:s}}=this;this._previousCursor=s,this._handles.add(f(t,"searchTerm",(t=>{i.cursor=0===t.length?"copy":s})),"awaiting-view-click-stop"),this._activeStop=e}_prepViewClick(){const t=this.get("viewModel.view"),e=P(t,"click",this._handleViewClick.bind(this)),i=P(t.surface,"click",(()=>{clearTimeout(this._autoStopRemovalTimeoutId),i.pause()}));return{remove(){i.remove(),e.remove()},pause(){i.pause(),e.pause()},resume(){i.resume(),e.resume()}}}_prepPointerDownUpClick(){const t=P(document,"pointerdown",(t=>{this._pointerPressedSearchSuggestionStop=Ot(t)?this._activeStop:null})),e=P(document,"pointerup",(t=>{this._pointerDownUpHandle.pause();const e=Ot(t),i=this._activeStop;e||i!==this._pointerPressedSearchSuggestionStop||this._removeStop(i),this.scheduleRender(),this._pointerPressedSearchSuggestionStop=e?this._activeStop:null}));return{remove(){e.remove(),t.remove()},pause(){e.pause(),t.pause()},resume(){t.resume()}}}_handleViewClick(t){const e=this._stopsToSearches.get(this._activeStop);e&&!e.searchTerm&&(e.search(t.mapPoint).then((t=>{const i=function(t){return t.results[0].results[0]}(t),s=this._activeStop;s.result=i,s.result.feature.attributes.Name=i.name,e.searchTerm=i.name})),this.scheduleRender()),this._viewClickHandle.pause(),clearTimeout(this._autoStopRemovalTimeoutId)}_handleAddStopFocus(){this._addNewPlaceholder()}_addNewPlaceholder(){if(this._pointerDownUpHandle.pause(),this._newPlaceholderStop)return;const t={};this._stops.add(t),this._newPlaceholderStop=t}_handleReverseStops(){this._reverseStops()}_reverseStops(){this._stops.reverse(),this._processStops()}_handleRemoveStop(t){this._removeStop(this._stops.getItemAt(t.currentTarget["data-stop-index"])),this._processStops()}_removeStop(t,e=!1){this._stops.length<=2&&!e||(this._disposeSearch(t),this._stops.remove(t))}_handleDepartureOptionChange(t){const e=t.currentTarget,i=e.item(e.selectedIndex);"now"===i.value?(this._departureTime="now",this.viewModel.departureTime="now",this._handles.remove("departure-time-controls")):"depart-by"===i.value?(this._departureTime="depart-by",this._handles.add([f(this._datePicker,"value",(()=>this._updateDepartureTime())),f(this._timePicker,"value",(()=>this._updateDepartureTime()))],"departure-time-controls")):(this._departureTime="unspecified",this.viewModel.departureTime=null)}_updateDepartureTime(){const t=this._datePicker.value,e=this._timePicker.value;this.viewModel.departureTime=new Date(t.getFullYear(),t.getMonth(),t.getDate(),e.getHours(),e.getMinutes())}_renderTimeControls(){return A("div",{class:"esri-directions__departure-time-controls",key:"esri-directions__time-controls",role:"group"},this._datePicker.render(),this._timePicker.render())}_renderSectionSplitter(){return A("div",{class:"esri-directions__section-splitter"})}_renderDisclaimer(){const{messages:t}=this,e=_(t.disclaimer,{esriTerms:`<a class="esri-widget__anchor" href="http://www.esri.com/legal/software-license" rel="noreferrer" target="_blank">${t.esriTerms}</a>`});return A("div",{class:"esri-directions__disclaimer",innerHTML:e,key:"esri-directions__disclaimer"})}_renderDirectionsContainer(){return A("div",{class:this.classes("esri-directions__directions-section","esri-directions__section"),key:"esri-directions__container"},this._renderDirectionsContainerContent())}_renderLoader(){return A("div",{class:"esri-directions__loader",key:"loader"})}_renderWarningCard(){return A("div",{class:"esri-directions__warning-card",role:"alert"},A("div",{class:"esri-directions__warning-header"},A("span",{class:"esri-icon-notice-triangle","aria-hidden":"true"}),A(at,{class:"esri-directions__warning-heading",level:this.headingLevel},this.messagesCommon.warning)),A("div",{class:"esri-directions__warning-message"},this._getErrorMessage()))}_renderDirectionsContainerContent(){const{lastRoute:t,state:e}=this.viewModel,i="routing"===e;return"error"===e?this._renderWarningCard():i?this._renderLoader():t?A("div",{class:"esri-directions__summary",key:"esri-directions__summary",role:"group"},this._renderCosts(),this._renderRouteActions(),this._renderManeuverSections()):A("div",{key:"esri-directions__placeholder",class:"esri-widget__content--empty"},this._renderPlaceholder(),A(at,{class:"esri-directions__message",level:this.headingLevel},this.messages.directionsPlaceholder))}_renderPlaceholder(){return A("svg",{class:"esri-widget__content-illustration--empty",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 256"},A("path",{fill:"currentcolor",d:"M192 36c-15.477 0-24 6.034-24 16.99v45.822l24 24 24-24v-45.82C216 42.033 207.477 36 192 36zm20 61.155l-20 20-20-20V52.99c0-8.62 6.73-12.99 20-12.99s20 4.37 20 12.99zM192 52a12 12 0 1 0 12 12 12.013 12.013 0 0 0-12-12zm0 20a8 8 0 1 1 8-8 8.008 8.008 0 0 1-8 8zM92 140.99C92 130.035 83.477 124 68 124s-24 6.034-24 16.99v45.822l24 24 24-24zm-4 44.165l-20 20-20-20V140.99c0-8.62 6.73-12.99 20-12.99s20 4.37 20 12.99zM68 140a12 12 0 1 0 12 12 12.013 12.013 0 0 0-12-12zm0 20a8 8 0 1 1 8-8 8.008 8.008 0 0 1-8 8zm84-44h16v4h-16zm-24 80h4v12h-12v-4h8zm0-28h4v16h-4zm0-52h12v4h-8v8h-4zm0 24h4v16h-4zm-36 64h16v4H92z"}))}_renderMessage(t){return A(at,{level:this.headingLevel},t)}_renderRouteActions(){return A("div",{class:"esri-directions__route-actions"},A("button",{"aria-label":this.messages.clearRoute,class:this.classes("esri-directions__clear-route-button","esri-button","esri-button--tertiary"),tabIndex:0,onclick:this._handleClearRouteClick,bind:this,type:"button"},this.messages.clearRoute))}_renderManeuverSections(){const{sections:t}=this._routeSections;return A("div",{class:"esri-directions__maneuvers",role:"group"},t.map(((e,i)=>{const{open:s}=e;let r;e.maneuvers.length>0&&s&&(r=A("ol",{class:"esri-directions__maneuver-list"},e.maneuvers.map((t=>this._renderManeuver(t)))));const n=t.length>2,o={"esri-directions__maneuver-section--collapsible":n},a={"esri-icon-down":!s,"esri-icon-up":s};let l;if(n&&i!==t.length-1){const t=s?this.messagesCommon.open:this.messagesCommon.close;l=A("header",{class:this.classes("esri-directions__maneuver-section-header","esri-directions__maneuver-section-toggle"),key:"esri-directions__maneuver-section-header"},A("div",{"aria-expanded":s.toString(),"aria-label":t,bind:this,class:"esri-directions__maneuver-section-header-toggle-button","data-maneuver-section":e,onkeydown:this._handleSectionToggle,onclick:this._handleSectionToggle,role:"button",tabIndex:0,title:t},A(at,{class:"esri-directions__maneuver-section-title",level:this.headingLevel},e.name),A("span",{"aria-hidden":"true",class:this.classes(a)})))}else l=A("header",{class:"esri-directions__maneuver-section-header",key:"esri-directions__maneuver-section-header"},A(at,{class:"esri-directions__maneuver-section-title",level:this.headingLevel},e.name));return A("section",{class:this.classes("esri-directions__maneuver-section",o)},l,r)})))}_handleSectionToggle(t){const e=t.currentTarget["data-maneuver-section"];e.open=!e.open}_renderCosts(){const t=this.get("viewModel.directionLines"),e=new Date(t[t.length-1].attributes.arriveTimeUTC),i=this._costSummary.set({directionsViewModel:this.viewModel,messages:this.messages,messagesUnits:this.messagesUnits}),{messages:s}=this,r=s.zoomToRoute,n=m(e,Pt),o=_(s.etaTemplate,{time:`<strong>${n}</strong>`,gmt:`${It(e)}`}),a=s.primaryCosts,l=s.secondaryCosts,h=s.eta;return A("div",{"aria-label":r,bind:this,class:"esri-directions__costs",onkeydown:this._handleSummaryInteraction,onclick:this._handleSummaryInteraction,role:"button",tabIndex:0,title:r},A("div",{class:"esri-directions__costs-details",role:"group"},A("div",{"aria-label":a,class:"esri-directions__costs-value",title:a},i.primary),A("div",{class:"esri-directions__vertical-splitter"}),A("div",{"aria-label":l,class:"esri-directions__other-costs-total",title:l},i.secondary)),A("div",{"aria-label":h,innerHTML:o,title:h}))}_handleSummaryInteraction(){this._activeManeuver=null,this._focusedManeuver=null,this.viewModel.clearHighlights(),this.zoomToRoute()}_getErrorMessage(){const{messages:t}=this,{error:e}=this.viewModel;return"directions-view-model:unable-to-route"===e.name?t.errors.unableToRoute:"directions-view-model:service-metadata-unavailable"===e.name?t.errors.unableToLoadServiceMetadata:t.errors.unknownError}_normalizeSearchSources(t){this._overrideDefaultSources(t),this._applyLocatorSourceOverrides(t)}_overrideDefaultSources(t){t.viewModel.defaultSources.forEach((t=>{t.autoNavigate=!1}))}_applyLocatorSourceOverrides({allSources:t}){0!==t.length&&t.forEach((t=>{"url"in t&&t.url&&(null===t.locationType&&(t.locationType="street"),F(t.url)&&this.apiKey&&null==t.apiKey&&(t.apiKey=this.apiKey,t.url=V))}))}_acquireSearch(t){const e=this.get("viewModel.view");if(this._stopsToSearches.has(t)){const i=this._stopsToSearches.get(t);return i.view=e,this._overrideDefaultSources(i),i}const i=new H({view:e,resultGraphicEnabled:!1,popupEnabled:!1,...this.searchProperties});return this._normalizeSearchSources(i),this._handles.add([b(i,"allSources","change",(()=>this._normalizeSearchSources(i))),i.on("select-result",(()=>{t.result=i.selectedResult,t.result.feature.attributes.Name=i.selectedResult.name,this._processStops(),this.scheduleRender()})),i.on("search-focus",(()=>this._handleStopInputFocus(i,t))),i.on("search-blur",(()=>this._handleStopInputBlur(i,t)))],i),this._stopsToSearches.set(t,i),i}_disposeSearch(t){this._stopsToSearches.get(t).destroy(),this._stopsToSearches.delete(t)}_processStops(){const t=this.viewModel;t.stops.removeAll(),t.stops.addMany(this._stops.filter((t=>!!t.result)).map((t=>t.result.feature))),t.stops.length>1&&t.getDirections()}_renderManeuver(t){let e;const{attributes:i}=t,s=this.get("viewModel.routeParameters.directionsLengthUnits"),{messages:r,messagesUnits:n}=this,o=Mt(r,n,i.length,{toUnits:s}),a=yt(i.time),l=ft(t);!function(t,e){return!(!ft(t)||!e||-22091616e5===t.get("attributes.ETA"))}(t,this.get("viewModel.routeParameters.startTime"))?o&&(e=a?`${o}&nbsp;&middot;&nbsp;${a}`:o):e=function(t,e,i,s){const r=new Date(i),n=new Date(r.getTime()+60*r.getTimezoneOffset()*1e3),o=m(n,{hour:"2-digit",minute:"2-digit",hour12:!1});if(e){const s=(i-e)/1e3/60/60,r=Math.floor(s),n=60*(s-r),a=v(r,{minimumIntegerDigits:2}),l=v(n,{minimumIntegerDigits:2});return`${o} ${t.gmt}${r<0?"":"+"}${a}${l}`}return s?m(n,{hour:"numeric",minute:"numeric"}):o}(r,i.arriveTimeUTC,i.ETA,"now"===this._departureTime);const h=l,c=this._getFormattedManeuverText(t),d=this._getIconPath(i.maneuverType);if(h)return A("li",{class:"esri-directions__maneuver",key:t},A("header",null,l.attributes.Name));const u=`esri-directions__maneuver-${t.uid}`,p=`esri-directions__cumulative-costs-${t.uid}`,_=`esri-directions__intermediate-costs-${t.uid}`;return A("li",{"aria-labelledby":`${u} ${p} ${_}`,bind:this,class:this.classes("esri-directions__maneuver",{"esri-directions__maneuver--active":this._activeManeuver===t}),"data-maneuver":t,key:t,onclick:this._handleManeuverClick,onkeydown:this._handleManeuverClick,onfocus:this._handleManeuverFocus,onmouseover:this._handleManeuverMouseOver,onmouseout:this._handleManeuverMouseOut,onblur:this._handleManeuverBlur,tabIndex:0},A("img",{alt:"",class:"esri-directions__maneuver-icon",src:d}),A("div",{class:"esri-directions__maneuver-costs-container"},A("span",{id:u,innerHTML:c}),A("div",{class:"esri-directions__maneuver-costs"},A("div",{class:"esri-directions__horizontal-splitter"}),A("div",{id:p,"aria-label":r.cumulativeCosts,class:"esri-directions__cost--cumulative",innerHTML:"",title:r.cumulativeCosts}),A("div",{id:_,"aria-label":r.intermediateCosts,class:"esri-directions__cost--intermediate",innerHTML:e,title:r.intermediateCosts}))))}_getIconPath(t){const e=Ct[t],i=2===window.devicePixelRatio?"@2x":"";return`${C("esri/themes/base/images/maneuvers/")}${e}${i}.png`}_handleManeuverClick(t){const e=t.currentTarget["data-maneuver"];if(this._activeManeuver===e)return this._activeManeuver=null,void this.zoomToRoute();this._activeManeuver=e,this.viewModel.centerAt(e),this.viewModel.highlightSegment(e)}_handleManeuverMouseOver(t){this._activeManeuver||this._focusedManeuver||this.viewModel.highlightSegment(t.currentTarget["data-maneuver"])}_handleManeuverMouseOut(){this._activeManeuver||this._focusedManeuver||this.viewModel.clearHighlights()}_handleManeuverBlur(){this._activeManeuver||(this._focusedManeuver=null,this.viewModel.clearHighlights())}_handleManeuverFocus(t){if(this._activeManeuver)return;const e=t.currentTarget["data-maneuver"];this._focusedManeuver=e,this.viewModel.highlightSegment(e)}_getFormattedManeuverText(t){const{attributes:{text:e},strings:i}=t;if(!i)return e;let s=e;return i.forEach((t=>{s=s.replace(t.string,`<strong>${t.string}</strong>`)})),s}};o([L("viewModel.apiKey")],Nt.prototype,"apiKey",void 0),o([L("viewModel.goToOverride")],Nt.prototype,"goToOverride",void 0),o([a()],Nt.prototype,"headingLevel",void 0),o([a()],Nt.prototype,"iconClass",void 0),o([a({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Nt.prototype,"label",void 0),o([L("viewModel.lastRoute")],Nt.prototype,"lastRoute",void 0),o([L("viewModel.maxStops")],Nt.prototype,"maxStops",void 0),o([a(),x("esri/widgets/Directions/t9n/Directions")],Nt.prototype,"messages",void 0),o([a(),x("esri/t9n/common")],Nt.prototype,"messagesCommon",void 0),o([a(),x("esri/core/t9n/Units")],Nt.prototype,"messagesUnits",void 0),o([L("viewModel.routeServiceUrl")],Nt.prototype,"routeServiceUrl",void 0),o([L("viewModel.routeSymbol")],Nt.prototype,"routeSymbol",void 0),o([a()],Nt.prototype,"searchProperties",void 0),o([L("viewModel.stopSymbols")],Nt.prototype,"stopSymbols",void 0),o([L("viewModel.view")],Nt.prototype,"view",void 0),o([a({type:Dt})],Nt.prototype,"viewModel",void 0),o([L("viewModel.getDirections")],Nt.prototype,"getDirections",null),o([L("viewModel.zoomToRoute")],Nt.prototype,"zoomToRoute",null),o([lt()],Nt.prototype,"_handleStopIconClick",null),o([lt()],Nt.prototype,"_handleClearRouteClick",null),o([lt()],Nt.prototype,"_handleReverseStops",null),o([lt()],Nt.prototype,"_handleRemoveStop",null),o([lt()],Nt.prototype,"_handleSectionToggle",null),o([lt()],Nt.prototype,"_handleSummaryInteraction",null),o([lt()],Nt.prototype,"_handleManeuverClick",null),Nt=o([l("esri.widgets.Directions")],Nt);const Ft=Nt;let Vt=class{constructor(i){t(this,i),this.loaded=e(this,"loaded",7),this.position="bottom-left"}validateApiKey(t){t&&this.widget&&(this.widget.apiKey=t)}validateView(t){t&&(this.widget.view=t,"arcgis-expand"!==this.el.parentElement.tagName.toLowerCase()&&this.widget.view.ui.add(this.widget,this.position))}componentWillLoad(){const t={container:this.el};this.apiKey&&(t.apiKey=this.apiKey),this.view&&(t.view=this.view);const e=new Ft(t);this.widget=e,this.loaded.emit(!0)}get el(){return i(this)}static get watchers(){return{apiKey:["validateApiKey"],view:["validateView"]}}};Vt.style="@import url('https://js.arcgis.com/next/esri/themes/light/main.css');";export{Vt as arcgis_directions}