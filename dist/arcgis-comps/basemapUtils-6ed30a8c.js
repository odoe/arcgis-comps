import { s as s$1, x as x$1 } from './Basemap-bec40c12.js';
import { g as s, o as t, R as b$1, aa as z, ab as $, T as T$1 } from './cast-e5ea2533.js';
import { S as S$1 } from './Collection-ac20f1a1.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c=s.getLogger("esri.support.basemapUtils");function u(){return {}}function f(e){for(const r in e){const n=e[r];!1===(null==n?void 0:n.destroyed)&&n.destroy(),delete e[r];}}function y(n,t$1){var a;let l;if("string"==typeof n){if(!(n in s$1)){const e=Object.entries(s$1).filter((([e,n])=>t.apiKey&&!n.classic||!t.apiKey&&n.classic&&!n.deprecated)).map((([e])=>`"${e}"`)).join(", ");return c.warn(`Unable to find basemap definition for: ${n}. Try one of these: ${e}`),null}t$1&&(l=t$1[n]),l||(l=x$1.fromId(n),t$1&&(t$1[n]=l));}else l=b$1(x$1,n);return null!=(a=l)&&a.destroyed&&(c.warn("The provided basemap is already destroyed",{basemap:l}),l=null),l}function p(r,n=null){const t=y(r);if(!t)return null;const a=new x$1({id:t.id,title:t.title,baseLayers:t.baseLayers.slice(),referenceLayers:t.referenceLayers.slice()});return n&&(a.baseLayers=L(a.baseLayers,n.baseLayers),a.referenceLayers=L(a.referenceLayers,n.referenceLayers)),a.load().catch((()=>{})),a.portalItem=t.portalItem,a}function m(e){let r=null;const n=g(e),t=!n.baseLayers.length;for(const a in s$1){const e=U(n,j(s$1[a]),{mustMatchReferences:t});if("equal"===e){r=a;break}"base-layers-equal"===e&&(r=a);}return r}function b(e,r){if(e===r)return !0;return "equal"===U(g(e),g(r),{mustMatchReferences:!0})}function L(e,r){const t=new S$1;return e.forEach((e=>{const n=r.find((r=>M(x(e),x(r))))||e;t.some((e=>e===n))?t.push(e):t.push(n);})),t}function d(e){return !(null==e||!e.baseLayers.concat(e.referenceLayers).some(S))}function S(e){if(v(e.url))return !0;if("vector-tile"===e.type)for(const r in e.sourceNameToSource){const n=e.sourceNameToSource[r];if(v(null==n?void 0:n.sourceUrl))return !0}return !1}const h=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function v(e){if(!e)return !1;const r=new $(T$1(e));return h.test(r.authority)}function g(e){return e?!e.loaded&&e.resourceInfo?j(e.resourceInfo.data):{baseLayers:T(e.baseLayers),referenceLayers:T(e.referenceLayers)}:null}function T(e){return (S$1.isCollection(e)?e.toArray():e).map(x)}function x(e){return {type:e.type,url:R("urlTemplate"in e&&e.urlTemplate||e.url||"styleUrl"in e&&e.styleUrl),minScale:"minScale"in e&&null!=e.minScale?e.minScale:0,maxScale:"maxScale"in e&&null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visible||!!e.visible}}function j(e){return e?{baseLayers:q(e.baseMapLayers.filter((e=>!e.isReference))),referenceLayers:q(e.baseMapLayers.filter((e=>e.isReference)))}:null}function q(e){return e.map((e=>w(e)))}function w(e){let r;switch(e.layerType){case"VectorTileLayer":r="vector-tile";break;case"ArcGISTiledMapServiceLayer":r="tile";break;default:r="unknown";}return {type:r,url:R(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:null!=e.minScale?e.minScale:0,maxScale:null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visibility||!!e.visibility}}function U(e,r,n){if(null!=e!=(null!=r))return "not-equal";if(!e)return "equal";if(!I(e.baseLayers,r.baseLayers))return "not-equal";return I(e.referenceLayers,r.referenceLayers)?"equal":n.mustMatchReferences?"not-equal":"base-layers-equal"}function I(e,r){if(e.length!==r.length)return !1;for(let n=0;n<e.length;n++)if(!M(e[n],r[n]))return !1;return !0}function M(e,r){return e.type===r.type&&e.url===r.url&&e.minScale===r.minScale&&e.maxScale===r.maxScale&&e.visible===r.visible&&e.opacity===r.opacity}function R(e){return e?z(e).replace(/^\s*https?:/i,"").toLowerCase():""}

export { S, b, d, f, u, y };
