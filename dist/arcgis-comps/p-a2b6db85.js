import{K as e}from"./p-e58503d5.js";import{I as s}from"./p-e3500fdc.js";import{a as t}from"./p-2e5dd2d0.js";import{a as r,m as i}from"./p-1676d4c7.js";const n=(e,s)=>e.key.level-s.key.level!=0?e.key.level-s.key.level:e.key.row-s.key.row!=0?e.key.row-s.key.row:e.key.col-s.key.col;class o extends t{constructor(e){super(),this._tileInfoView=e}get requiresDedicatedFBO(){return!1}renderChildren(e){this.sortChildren(n),this.setStencilReference(),super.renderChildren(e)}createRenderParams(e){const{state:s}=e,t=super.createRenderParams(e);return t.requiredLevel=this._tileInfoView.getClosestInfoForScale(s.scale).level,t.displayLevel=this._tileInfoView.tileInfo.scaleToZoom(s.scale),t}prepareRenderPasses(t){const n=super.prepareRenderPasses(t);return n.push(t.registerRenderPass({name:"stencil",brushes:[r],drawPhase:s.DEBUG|s.MAP|s.HIGHLIGHT,target:()=>this.getStencilTarget()})),e("esri-tiles-debug")&&n.push(t.registerRenderPass({name:"tileInfo",brushes:[i],drawPhase:s.DEBUG,target:()=>this.children})),n}getStencilTarget(){return this.children}updateTransforms(e){for(const s of this.children){const t=this._tileInfoView.getTileResolution(s.key);s.setTransform(e,t)}}setStencilReference(){let e=1;for(const s of this.children)s.stencilRef=e++}}export{o}