import{e as p}from"./p-fb38a9d0.js";import{CIMSymbolRasterizer as t}from"./p-a7668340.js";import{n as o,i as e}from"./p-2ae44317.js";import"./p-e58503d5.js";import"./p-53bb6ab4.js";import"./p-c048b814.js";import"./p-b79fcce3.js";import"./p-dc15ecc1.js";import"./p-e273719b.js";import"./p-74de0937.js";import"./p-2f398ed1.js";import"./p-d3105731.js";import"./p-765e6c28.js";import"./p-1a7268a2.js";import"./p-2d0c34e5.js";import"./p-025c0c8e.js";import"./p-ea916a39.js";import"./p-47e1bd73.js";import"./p-1e473dab.js";import"./p-d1d9dbe4.js";import"./p-e6fe5d89.js";import"./p-56ed1c7a.js";import"./p-b392deaf.js";import"./p-9790d1b4.js";import"./p-9e860e7b.js";import"./p-0923eebd.js";import"./p-4019eec3.js";import"./p-6cd1d477.js";import"./p-8bc9b36a.js";import"./p-a9a30646.js";import"./p-7a658388.js";import"./p-f94762ac.js";import"./p-8a919d07.js";import"./p-efbca0ca.js";import"./p-e654504b.js";import"./p-9f58a277.js";import"./p-b0565d49.js";const s=new t(null,!0);async function i(t,i={}){const{size:r,maxSize:m,node:a,opacity:j}=i,c=i.cimOptions||i,{feature:d,fieldMap:l,geometryType:n,style:b}=c,f=o(t),u=Math.min(null!=r?r:f,null!=m?m:p(120));u!==f&&(t=t.clone(),e(t,u,{preserveOutlineWidth:!0}));let y=3;t&&t.data&&t.data.symbol&&"CIMPointSymbol"!==t.data.symbol.type&&(y=1);const M=await s.rasterizeCIMSymbolAsync(t,d,l,n,{scaleFactor:y,style:b}),v=document.createElement("canvas");v.width=M.imageData.width,v.height=M.imageData.height,v.getContext("2d").putImageData(M.imageData,0,0);let h=v.width/y,w=v.height/y;if(null!=r&&(null==(null==i?void 0:i.scale)||(null==i?void 0:i.scale))){const p=h/w;h=p<=1?Math.ceil(u*p):u,w=p<=1?u:Math.ceil(u/p)}const I=new Image(h,w);return I.src=v.toDataURL(),null!=j&&(I.style.opacity=`${j}`),null!=i.effect&&(I.style.filter=i.effect),a&&a.appendChild(I),I}export{i as previewCIMSymbol}