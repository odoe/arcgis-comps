import{K as t}from"./p-e58503d5.js";import{C as s}from"./p-6484267b.js";import{r as i}from"./p-0bb41218.js";import{a as h}from"./p-1c2ff3a7.js";const r=t("mapview-transitions-duration");class e extends h{constructor(){super(...arguments),this._childrenSet=new Set,this._needsSort=!1,this.children=[],this._effectList=null}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode=t,this.requestRender()}get clips(){return this._clips}set clips(t){this._clips=t,this.children.forEach((s=>s.clips=t))}get computedEffects(){var t,s;return null!=(t=null==(s=this._effectList)?void 0:s.effects)?t:null}get effect(){var t,s;return null!=(t=null==(s=this._effectList)?void 0:s.effect)?t:""}set effect(t){(this._effectList||t)&&(this._effectList||(this._effectList=new i(r)),this._effectList.effect=t,this.requestRender())}updateTransitionProperties(t,s){super.updateTransitionProperties(t,s),this._effectList&&(this._effectList.transitionStep(t,s),this._effectList.transitioning&&this.requestRender())}doRender(t){const s=this.createRenderParams(t);this.renderChildren(s)}addChild(t){return this.addChildAt(t,this.children.length)}addChildAt(t,s=this.children.length){if(!t)return t;if(this.contains(t))return t;this._needsSort=!0;const i=t.parent;return i&&i!==this&&i.removeChild(t),s>=this.children.length?this.children.push(t):this.children.splice(s,0,t),this._childrenSet.add(t),t.parent=this,t.stage=this.stage,this!==this.stage&&(t.clips=this.clips),this.requestRender(),t}contains(t){return this._childrenSet.has(t)}removeAllChildren(){this._childrenSet.clear(),this._needsSort=!0;for(const t of this.children)this!==this.stage&&(t.clips=null),t.stage=null,t.parent=null;this.children.length=0}removeChild(t){return this.contains(t)?this.removeChildAt(this.children.indexOf(t)):t}removeChildAt(t){if(t<0||t>=this.children.length)return null;this._needsSort=!0;const s=this.children.splice(t,1)[0];return this._childrenSet.delete(s),this!==this.stage&&(s.clips=null),s.stage=null,s.parent=null,s}sortChildren(t){this._needsSort&&(this.children.sort(t),this._needsSort=!1)}_createTransforms(){return{dvs:s()}}onAttach(){super.onAttach();const t=this.stage;for(const s of this.children)s.stage=t}onDetach(){super.onDetach();for(const t of this.children)t.stage=null}renderChildren(t){for(const s of this.children)s.beforeRender(t);for(const s of this.children)s.processRender(t);for(const s of this.children)s.afterRender(t)}createRenderParams(t){return{...t,blendMode:this.blendMode,effects:this.computedEffects,globalOpacity:t.globalOpacity*this.computedOpacity,inFadeTransition:this.inFadeTransition}}}export{e as n}