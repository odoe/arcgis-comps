import{N as t}from"./p-53bb6ab4.js";function e(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o}const i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0;var s,n;let r;var o,a;function l(t){return"function"==typeof r[t]?r[t]=r[t](i):r[t]}function u(t){return null!=t}function c(t){return null==t}function h(t){return void 0===t}function d(t,e){return u(t)?e(t):null}function f(t){return t}function p(t,e){if(c(t))throw Error(e);return t}function y(t,e){return u(t)?t:"function"==typeof e?e():e}function m(t){return u(t)&&t.destroy(),null}function g(t){return u(t)&&t.dispose(),null}function v(t){return u(t)&&t.remove(),null}function w(t){return u(t)&&t.release(),null}function b(t,e){const i=[];for(const s of t)i.push(S(s,null,e));return i}function M(t,e){for(const i of t)S(i,null,e)}function S(t,e,i){return u(t)?i(t):e}function x(t,e){return u(t)?e(t):null}function k(t){return t.filter((t=>u(t)))}function I(t,...e){let i=t;for(let t=0;t<e.length&&i;++t)i=i[e[t]];return i}function j(t){return t}r=null!=(s=i.dojoConfig)&&s.has||null!=(n=i.esriConfig)&&n.has?{...null==(o=i.dojoConfig)?void 0:o.has,...null==(a=i.esriConfig)?void 0:a.has}:{},l.add=(t,e,i,s)=>((s||void 0===r[t])&&(r[t]=e),i&&l(t)),l.cache=r,l.add("esri-deprecation-warnings",!0),(()=>{l.add("host-webworker",void 0!==i.WorkerGlobalScope&&self instanceof i.WorkerGlobalScope);const t="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document;if(l.add("host-browser",t),l.add("host-node","object"==typeof i.process&&i.process.versions&&i.process.versions.node&&i.process.versions.v8),l.add("dom",t),l("host-browser")){const t=navigator,e=t.userAgent,i=t.appVersion,s=parseFloat(i);if(l.add("wp",parseFloat(e.split("Windows Phone")[1])||void 0),l.add("msapp",parseFloat(e.split("MSAppHost/")[1])||void 0),l.add("khtml",i.includes("Konqueror")?s:void 0),l.add("edge",parseFloat(e.split("Edge/")[1])||void 0),l.add("opr",parseFloat(e.split("OPR/")[1])||void 0),l.add("webkit",!l("wp")&&!l("edge")&&parseFloat(e.split("WebKit/")[1])||void 0),l.add("chrome",!l("edge")&&!l("opr")&&parseFloat(e.split("Chrome/")[1])||void 0),l.add("android",!l("wp")&&parseFloat(e.split("Android ")[1])||void 0),l.add("safari",!i.includes("Safari")||l("wp")||l("chrome")||l("android")||l("edge")||l("opr")?void 0:parseFloat(i.split("Version/")[1])),l.add("mac",i.includes("Macintosh")),!l("wp")&&e.match(/(iPhone|iPod|iPad)/)){const t=RegExp.$1.replace(/P/,"p"),i=e.match(/OS ([\d_]+)/)?RegExp.$1:"1",s=parseFloat(i.replace(/_/,".").replace(/_/g,""));l.add(t,s),l.add("ios",s)}l.add("trident",parseFloat(i.split("Trident/")[1])||void 0),l("webkit")||(!e.includes("Gecko")||l("wp")||l("khtml")||l("trident")||l("edge")||l.add("mozilla",s),l("mozilla")&&l.add("ff",parseFloat(e.split("Firefox/")[1]||e.split("Minefield/")[1])||void 0))}})(),(()=>{if(i.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),i=/iPhone/i.test(t);e&&l.add("esri-mobile",e),i&&l.add("esri-iPhone",i),l.add("esri-geolocation",!!navigator.geolocation)}l.add("esri-canvas-svg-support",!l("trident")),l.add("esri-wasm","WebAssembly"in i),l.add("esri-shared-array-buffer",(()=>"SharedArrayBuffer"in i&&!(!1===i.crossOriginIsolated))),l.add("esri-atomics","Atomics"in i),l.add("esri-workers","Worker"in i),l.add("esri-text-decoder","TextDecoder"in i),l.add("esri-text-encoder","TextEncoder"in i),l.add("web-feat:cache","caches"in i),l.add("esri-workers-arraybuffer-transfer",!l("safari")||Number(l("safari"))>=12),l.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),l.add("featurelayer-simplify-payload-size-factors",[1,1,4]),l.add("featurelayer-snapshot-enabled",!0),l.add("featurelayer-snapshot-point-min-threshold",8e4),l.add("featurelayer-snapshot-point-max-threshold",4e5),l.add("featurelayer-snapshot-point-coverage",.1),l.add("featurelayer-advanced-symbols",!1),l.add("featurelayer-pbf",!0),l.add("featurelayer-pbf-statistics",!1),l.add("feature-layers-workers",!0),l.add("mapview-transitions-duration",200),l.add("mapserver-pbf-enabled",!1),l("host-webworker")||l("host-browser")&&(l.add("esri-csp-restrictions",(()=>{try{Function()}catch{return!0}return!1})),l.add("esri-image-decode",(()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then((()=>{l.add("esri-image-decode",!0,!0,!0)})).catch((()=>{l.add("esri-image-decode",!1,!0,!0)}))}return!1})),l.add("esri-url-encodes-apostrophe",(()=>{const t=i.document.createElement("a");return t.href="?'",t.href.includes("?%27")})),l.add("vectortilelayer-max-buffers",l("ff")?160:1/0))})();class _{constructor(t=1){this._seed=t}set seed(t){this._seed=null==t?Math.random()*_._m:t}getInt(){return this._seed=(_._a*this._seed+_._c)%_._m,this._seed}getFloat(){return this.getInt()/(_._m-1)}getIntRange(t,e){return Math.round(this.getFloatRange(t,e))}getFloatRange(t,e){const i=e-t;return t+this.getInt()/_._m*i}}function T(t,e,i){if(c(t)&&c(e))return!0;if(c(t)||c(e)||t.length!==e.length)return!1;if(i){for(let s=0;s<t.length;s++)if(!i(t[s],e[s]))return!1}else for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function O(t){return t&&"number"==typeof t.length}_._m=2147483647,_._a=48271,_._c=0;const A=!!Array.prototype.fill;function F(t,e){if(A)return Array(t).fill(e);const i=Array(t);for(let s=0;s<t;s++)i[s]=e;return i}function C(t,e){void 0===e&&(e=t,t=0);const i=Array(e-t);for(let s=t;s<e;s++)i[s-t]=s;return i}function P(t){return t.reduce(((t,e)=>t.concat(e||[])),[])}class E{constructor(){this.last=0}}const L=new E;function R(t,e,i,s){const n=Math.max(0,(s=s||L).last-10);for(let r=n;r<i;++r)if(t[r]===e)return s.last=r,r;const r=Math.min(n,i);for(let i=0;i<r;++i)if(t[i]===e)return s.last=i,i;return-1}function N(t,e,i,s){const n=null==i?t.length:i,r=R(t,e,n,s);if(-1!==r)return t[r]=t[n-1],null==i&&t.pop(),e}const D=new Set;function V(t,e){const i=t.indexOf(e);return-1!==i?(t.splice(i,1),e):null}function $(t,e){if(t.forEach)t.forEach(e);else for(let i=0;i<t.length;i++)e(t[i],i,t)}function z(t,e,i){if(t.slice)return t.slice(e,i);void 0===e?e=0:(e<0&&(e+=t.length),e=Math.min(t.length,Math.max(0,e))),void 0===i?i=t.length:(i<0&&(i+=t.length),i=Math.min(t.length,Math.max(0,i)));const s=Math.max(0,i-e),n=new t.constructor(s);for(let i=0;i<s;i++)n[i]=t[e+i];return n}function G(t){return t instanceof ArrayBuffer||t&&t.constructor&&"ArrayBuffer"===t.constructor.name}function U(t){return t instanceof Uint8Array||t&&t.constructor&&"Uint8Array"===t.constructor.name}function q(t){return t instanceof Uint16Array||t&&t.constructor&&"Uint16Array"===t.constructor.name}function B(t){return t instanceof Uint32Array||t&&t.constructor&&"Uint32Array"===t.constructor.name}function W(t,e){let i;if(e)for(i in t)t.hasOwnProperty(i)&&(void 0===t[i]?delete t[i]:t[i]instanceof Object&&W(t[i],!0));else for(i in t)t.hasOwnProperty(i)&&void 0===t[i]&&delete t[i];return t}function H(t){if(!t||"object"!=typeof t||"function"==typeof t)return t;if(function(t){return t instanceof Int8Array||t&&t.constructor&&"Int8Array"===t.constructor.name}(t)||U(t)||function(t){return t instanceof Uint8ClampedArray||t&&t.constructor&&"Uint8ClampedArray"===t.constructor.name}(t)||function(t){return t instanceof Int16Array||t&&t.constructor&&"Int16Array"===t.constructor.name}(t)||q(t)||function(t){return t instanceof Int32Array||t&&t.constructor&&"Int32Array"===t.constructor.name}(t)||B(t)||function(t){return t instanceof Float32Array||t&&t.constructor&&"Float32Array"===t.constructor.name}(t)||function(t){return t instanceof Float64Array||t&&t.constructor&&"Float64Array"===t.constructor.name}(t))return z(t);if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;return t.forEach(((t,i)=>{e.set(i,H(t))})),e}if(t instanceof Set){const e=new Set;return t.forEach((t=>{e.add(H(t))})),e}let e;const i=t;if("function"==typeof i.clone)e=i.clone();else if("function"==typeof i.map&&"function"==typeof i.forEach)e=i.map(H);else if("function"==typeof i.notifyChange&&"function"==typeof i.watch)e=i.clone();else{e={};for(const i of Object.getOwnPropertyNames(t))e[i]=H(t[i])}return e}function J(t,e){return t===e||"number"==typeof t&&isNaN(t)&&"number"==typeof e&&isNaN(e)||"function"==typeof(t||{}).getTime&&"function"==typeof(e||{}).getTime&&t.getTime()===e.getTime()||!1}function Z(t,e,i=!1){return X(t,e,i)}function Q(t,e){if(null!=e)return e[t]||Y(t.split("."),!1,e)}function K(t,e,i){const s=t.split("."),n=s.pop(),r=Y(s,!0,i);r&&n&&(r[n]=e)}function Y(t,e,i){let s=i;for(const i of t){if(null==s)return;if(!(i in s)){if(!e)return;s[i]={}}s=s[i]}return s}function X(t,e,i){return e?Object.keys(e).reduce((function(t,s){let n=t[s],r=e[s];return n===r?t:void 0===n?(t[s]=H(r),t):(Array.isArray(r)||Array.isArray(t)?(n=t[s]=n?Array.isArray(n)?n.concat():[n]:[],r&&(Array.isArray(r)||(r=[r]),i?r.forEach((t=>{-1===n.indexOf(t)&&n.push(t)})):t[s]=r.concat())):r&&"object"==typeof r?t[s]=X(n,r,i):t.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(t[s]=r),t)}),t||{}):t}const tt="20211104",et="f56ab3008fdaea1ce910515531b6ddb258d83e4f",it={apiKey:void 0,applicationUrl:i.location&&i.location.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryService:null,geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",portalUrl:"https://www.arcgis.com",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};i.esriConfig&&(Z(it,i.esriConfig,!0),delete it.has),it.assetsPath||(it.assetsPath=`https://cdn.jsdelivr.net/npm/@arcgis/core@4.22.0-next.${tt}/assets`),it.baseUrl&&console.warn("[esri.config]","baseUrl has been replaced by assetsPath"),Object.defineProperty(it,"baseUrl",{set(){console.warn("[esri.config]","baseUrl has been replaced by assetsPath")}}),it.request.corsEnabledServers=[],it.request.corsEnabledServers.push=function(){return console.warn("[esri.config]","request.corsEnabledServers is not supported and will be removed in a future release. See http://esriurl.com/cors8664"),0};const st=/\{([^\}]+)\}/g;function nt(t){return null==t?"":t}function rt(t,e){return t.replace(st,"object"==typeof e?(t,i)=>nt(Q(i,e)):(t,i)=>nt(e(i)))}function ot(t,e){return t.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,(t=>e&&-1!==e.indexOf(t)?t:"\\"+t))}function at(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}function lt(t){return(new DOMParser).parseFromString(t||"","text/html").body.innerText||""}const ut={info:0,warn:1,error:2,none:3};class ct{constructor(t){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=t.level&&(this.level=t.level),null!=t.writer&&(this.writer=t.writer),this._module=t.module,ct._loggers[this.module]=this;const e=this.module.lastIndexOf(".");-1!==e&&(this._parent=ct.getLogger(this.module.slice(0,e)))}get module(){return this._module}get parent(){return this._parent}error(...t){this._log("error","always",...t)}warn(...t){this._log("warn","always",...t)}info(...t){this._log("info","always",...t)}errorOnce(...t){this._log("error","once",...t)}warnOnce(...t){this._log("warn","once",...t)}infoOnce(...t){this._log("info","once",...t)}errorOncePerTick(...t){this._log("error","oncePerTick",...t)}warnOncePerTick(...t){this._log("warn","oncePerTick",...t)}infoOncePerTick(...t){this._log("info","oncePerTick",...t)}get test(){const t=this;return{loggedMessages:t._loggedMessages,clearLoggedWarnings:()=>t._loggedMessages.warn.clear()}}static get testSingleton(){return{resetLoggers(t={}){const e=ct._loggers;return ct._loggers=t,e},set throttlingDisabled(t){ct._throttlingDisabled=t}}}static getLogger(t){let e=ct._loggers[t];return e||(e=new ct({module:t})),e}_log(t,e,...i){if(this._matchLevel(t)){if("always"!==e&&!ct._throttlingDisabled){const s=this._argsToKey(i),n=this._loggedMessages[t].get(s);if("once"===e&&null!=n||"oncePerTick"===e&&n&&n>=ct._tickCounter)return;this._loggedMessages[t].set(s,ct._tickCounter),ct._scheduleTickCounterIncrement()}for(const e of it.log.interceptors)if(e(t,this.module,...i))return;this._inheritedWriter()(t,this.module,...i)}}_parentWithMember(t,e){let i=this;for(;u(i);){const e=i[t];if(u(e))return e;i=i.parent}return e}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(t,e,...i){console[t](`[${e}]`,...i)}_matchLevel(t){return ut[this._parentWithMember("level",it.log.level?it.log.level:"warn")]<=ut[t]}_argsToKey(...t){return at(JSON.stringify(t,((t,e)=>"object"!=typeof e||Array.isArray(e)?e:"[Object]")))}static _scheduleTickCounterIncrement(){ct._tickCounterScheduled||(ct._tickCounterScheduled=!0,Promise.resolve().then((()=>{ct._tickCounter++,ct._tickCounterScheduled=!1})))}}ct._loggers={},ct._tickCounter=0,ct._tickCounterScheduled=!1,ct._throttlingDisabled=!1;class ht{constructor(t,e,i){this.name=t,this.details=i,this.message=void 0,this instanceof ht&&(this.message=e&&function(t,e){return t.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,(function(t,i){if(""===i)return"$";const s=Q(i,e),n=null==s?"":s;if(void 0===n)throw Error(`could not find key "${i}" in template`);return""+n}))}(e,i)||"")}toString(){return"["+this.name+"]: "+this.message}}class dt extends ht{constructor(t,e,i){if(super(t,e,i),!(this instanceof dt))return new dt(t,e,i)}toJSON(){if(null!=this.details)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,((t,e)=>{if(e&&"object"==typeof e&&"function"==typeof e.toJSON)return e;try{return H(e)}catch(t){return"[object]"}})))}}catch(t){throw ct.getLogger("esri.core.Error").error(t),t}return{name:this.name,message:this.message,details:this.details}}static fromJSON(t){return new dt(t.name,t.message,t.details)}}dt.prototype.type="error";const ft=ct.getLogger("esri.core.urlUtils"),pt=it.request,yt="esri/config: esriConfig.request.proxyUrl is not set.",mt=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,gt=/^\s*http:/i,vt=/^\s*https:/i,wt=/^\s*file:/i,bt=/:\d+$/,Mt=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,St=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,xt=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/;class kt{constructor(t=""){this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let e=this.uri.match(St);this.scheme=e[2]||(e[1]?"":null),this.authority=e[4]||(e[3]?"":null),this.path=e[5],this.query=e[7]||(e[6]?"":null),this.fragment=e[9]||(e[8]?"":null),null!=this.authority&&(e=this.authority.match(xt),this.user=e[3]||null,this.password=e[4]||null,this.host=e[6]||e[7],this.port=e[9]||null)}toString(){return this.uri}}const It=new kt(it.applicationUrl),jt={},_t=(()=>{const t=It.path,e=t.substring(0,t.lastIndexOf(t.split("/")[t.split("/").length-1]));return`${It.scheme}://${It.host}${null!=It.port?":"+It.port:""}${e}`})();function Tt(t){const e={path:null,query:null},i=new kt(t),s=t.indexOf("?");return null===i.query?e.path=t:(e.path=t.substring(0,s),e.query=Ot(i.query)),i.fragment&&(e.hash=i.fragment,null===i.query&&(e.path=e.path.substring(0,e.path.length-(i.fragment.length+1)))),e}function Ot(t){const e=t.split("&"),i={};for(const t of e){if(!t)continue;const e=t.indexOf("=");let s,n;e<0?(s=decodeURIComponent(t),n=""):(s=decodeURIComponent(t.slice(0,e)),n=decodeURIComponent(t.slice(e+1)));let r=i[s];"string"==typeof r&&(r=i[s]=[r]),Array.isArray(r)?r.push(n):i[s]=n}return i}function At(t){return t&&"object"==typeof t&&"toJSON"in t&&"function"==typeof t.toJSON}function Ft(t,e){return t?e&&"function"==typeof e?Object.keys(t).map((i=>encodeURIComponent(i)+"="+encodeURIComponent(e(i,t[i])))).join("&"):Object.keys(t).map((i=>{const s=t[i];if(null==s)return"";const n=encodeURIComponent(i)+"=",r=e&&e[i];return r?n+encodeURIComponent(r(s)):Array.isArray(s)?s.map((t=>At(t)?n+encodeURIComponent(JSON.stringify(t)):n+encodeURIComponent(t))).join("&"):At(s)?n+encodeURIComponent(JSON.stringify(s)):n+encodeURIComponent(s)})).filter((t=>t)).join("&"):""}function Ct(t){const e=Rt(t);let i,s;if(e){const t=Et(e.proxyUrl);i=t.path,s=t.query?Ot(t.query):null}if(i){const e=Tt(t);t=i+"?"+e.path;const n=Ft({...s,...e.query});n&&(t=`${t}?${n}`)}return t}const Pt={path:"",query:""};function Et(t){const e=t.indexOf("?");return-1!==e?(Pt.path=t.slice(0,e),Pt.query=t.slice(e+1)):(Pt.path=t,Pt.query=null),Pt}function Lt(t){return(t=oe(t=function(t){return t&&"/"===t[t.length-1]?t:t+"/"}(t=Et(t).path),!0)).toLowerCase()}function Rt(t){const e=pt.proxyRules,i=Lt(t);for(let t=0;t<e.length;t++)if(0===i.indexOf(e[t].urlPrefix))return e[t]}function Nt(t,e){return t=Dt(t),e=Dt(e),oe(t)===oe(e)}function Dt(t){const e=(t=Bt(t)).indexOf("/sharing");return e>0?t.substring(0,e):t.replace(/\/+$/,"")}function Vt(t){const e=e=>null==e||e instanceof RegExp&&e.test(t)||"string"==typeof e&&t.startsWith(e),i=pt.interceptors;if(i)for(const t of i)if(Array.isArray(t.urls)){if(t.urls.some(e))return t}else if(e(t.urls))return t;return null}function $t(t,e,i=!1){const s=he(t),n=he(e);return!(!i&&s.scheme!==n.scheme)&&null!=s.host&&null!=n.host&&s.host.toLowerCase()===n.host.toLowerCase()&&s.port===n.port}function zt(t){if("string"==typeof t){if(!Jt(t))return!0;t=he(t)}if($t(t,It))return!0;const e=pt.trustedServers||[];for(let i=0;i<e.length;i++){const s=Gt(e[i]);for(let e=0;e<s.length;e++)if($t(t,s[e]))return!0}return!1}function Gt(t){return jt[t]||(jt[t]=ie(t)||ee(t)?[new kt(Ut(t))]:[new kt("http://"+t),new kt("https://"+t)]),jt[t]}function Ut(t,e=_t,i){return ee(t)?i&&i.preserveProtocolRelative?t:"http"===It.scheme&&It.authority===Ht(t).slice(2)?"http:"+t:"https:"+t:ie(t)?t:Wt("/"===t[0]?function(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return-1===i?t:t.slice(0,i)}(e):e,t)}function qt(t,e=_t,i){if(!Jt(t))return t;const s=Bt(t),n=s.toLowerCase(),r=Bt(e).toLowerCase().replace(/\/+$/,""),o=i?Bt(i).toLowerCase().replace(/\/+$/,""):null;if(o&&0!==r.indexOf(o))return t;const a=(t,e,i)=>-1===(i=t.indexOf(e,i))?t.length:i;let l=a(n,"/",n.indexOf("//")+2),u=-1;for(;n.slice(0,l+1)===r.slice(0,l)+"/"&&(u=l+1,l!==n.length);)l=a(n,"/",l+1);if(-1===u)return t;if(o&&u<o.length)return t;t=s.slice(u);const c=r.slice(u-1).replace(/[^/]+/g,"").length;if(c>0)for(let e=0;e<c;e++)t="../"+t;else t="./"+t;return t}function Bt(t){return function(t){const e=pt.httpsDomains;if(!function(t){return gt.test(t)||"http"===It.scheme&&ee(t)}(t))return t;const i=t.indexOf("/",7);let s;if(s=-1===i?t:t.slice(0,i),s=s.toLowerCase().slice(7),bt.test(s)){if(!s.endsWith(":80"))return t;s=s.slice(0,-3),t=t.replace(":80","")}return"http"===It.scheme&&s===It.authority&&!Mt.test(t)||(re()&&s===It.authority||e&&e.some((t=>s===t||s.endsWith("."+t)))||re()&&!Rt(t))&&(t=ne(t)),t}(t=function(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}(t=function(t){if(/^https?:\/\//i.test(t)){const e=Et(t);t=(t=e.path.replace(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+="?"+e.query)}return t}(t=Ut(t=t.trim()))))}function Wt(...t){const e=t.filter(u);if(!e||!e.length)return;const i=[];if(Jt(e[0])){const t=e[0],s=t.indexOf("//");-1!==s&&(i.push(t.slice(0,s+1)),function(t){return wt.test(t)}(e[0])&&(i[0]+="/"),e[0]=t.slice(s+2))}else"/"===e[0][0]&&i.push("");const s=e.reduce(((t,e)=>e?t.concat(e.split("/")):t),[]);for(let t=0;t<s.length;t++){const e=s[t];".."===e&&i.length>0&&".."!==i[i.length-1]?i.pop():(!e&&t===s.length-1||e&&("."!==e||0===i.length))&&i.push(e)}return i.join("/")}function Ht(t,e=!1){if(Zt(t)||Qt(t))return null;let i=t.indexOf("://");if(-1===i&&ee(t))i=2;else{if(-1===i)return null;i+=3}const s=t.indexOf("/",i);return-1!==s&&(t=t.slice(0,s)),e&&(t=oe(t,!0)),t}function Jt(t){return ee(t)||ie(t)}function Zt(t){return null!=t&&"blob:"===t.slice(0,5)}function Qt(t){return"data:"===t.slice(0,5)}function Kt(t){const e=Xt(t);if(!e||!e.isBase64)return null;const i=atob(e.data),s=new Uint8Array(i.length);for(let t=0;t<i.length;t++)s[t]=i.charCodeAt(t);return s.buffer}const Yt=/^data:(.*?)(;base64)?,(.*)$/;function Xt(t){const e=t.match(Yt);if(!e)return null;const[,i,s,n]=e;return{mediaType:i,isBase64:!!s,data:n}}function te(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}function ee(t){return null!=t&&void 0!==t&&"/"===t[0]&&"/"===t[1]}function ie(t){return mt.test(t)}function se(t){return vt.test(t)||"https"===It.scheme&&ee(t)}function ne(t){return ee(t)?"https:"+t:t.replace(gt,"https:")}function re(){return"https"===It.scheme}function oe(t,e=!1){return ee(t)?t.slice(2):(t=t.replace(mt,""),e&&t.length>1&&"/"===t[0]&&"/"===t[1]&&(t=t.slice(2)),t)}function ae(t){let e=0;if(Jt(t)){const i=t.indexOf("//");-1!==i&&(e=i+2)}const i=t.lastIndexOf("/");return i<e?t:t.slice(0,i+1)}function le(t,e){if(!t)return"";const i=Tt(t).path.replace(/\/+$/,""),s=i.substring(i.lastIndexOf("/")+1);if(null==e||!e.length)return s;const n=RegExp(`.(${e.join("|")})$`,"ig");return s.replace(n,"")}function ue(t){return t.replace(/\/+$/,"")}function ce(t,e,i){if(!(e&&i&&t&&Jt(t)))return t;const s=t.indexOf("//"),n=t.indexOf("/",s+2),r=t.indexOf(":",s+2),o=Math.min(n<0?t.length:n,r<0?t.length:r);return t.slice(s+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,s+2)}${i}${t.slice(o)}`}function he(t){return"string"==typeof t?new kt(Ut(t)):(t.scheme||(t.scheme=It.scheme),t)}function de(t){return ve.test(t)}function fe(t,e){const i=Tt(t),s=Object.keys(i.query||{});return s.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${s.join(", ")}.`),i.path}function pe(t,e,i){const s=Tt(t),n=s.query||{};return n[e]=i+"",`${s.path}?${Ft(n)}`}function ye(t,e){const i=Tt(t),s=i.query||{};for(const t in e)s[t]=e[t];const n=Ft(s);return n?`${i.path}?${n}`:i.path}function me(t){if(c(t))return null;const e=t.match(ge);return e?e[1]:null}const ge=/.*?\.([^\/]*)$/,ve=/(^data:image\/svg|\.svg$)/i,we="4.22",be={async request(t,e){var i;const{default:s}=await Promise.resolve().then((function(){return xi})),n=t.options,r=n.responseType;n.signal=null==e?void 0:e.signal,n.responseType="native"===r||"native-request-init"===r?"native-request-init":["blob","json","text"].includes(r)&&null!=(i=Vt(t.url))&&i.after?r:"array-buffer";const o=await s(t.url,n),a={data:o.data,ssl:o.ssl};switch(o.requestOptions.responseType){case"native-request-init":return delete a.data.signal,a;case"blob":a.data=await a.data.arrayBuffer();break;case"json":a.data=(new TextEncoder).encode(JSON.stringify(a.data)).buffer;break;case"text":a.data=(new TextEncoder).encode(a.data).buffer}return{result:a,transferList:[a.data]}}};let Me;function Se(t){Me=t}function xe(t){const e=Me&&Me.findCredential(t);return e&&e.token?pe(t,"token",e.token):t}l("host-webworker")||(l("edge")||l("trident"))&&console.warn("Deprecated browser - see http://esriurl.com/oldbrowser");const ke=function(t){return{setTimeout:(e,i)=>{const s=t.setTimeout(e,i);return{remove:()=>t.clearTimeout(s)}}}}(i);function Ie(t){return t&&("function"==typeof t.on||"function"==typeof t.addEventListener)}function je(t,e,i){if(!Ie(t))throw new TypeError("target is not a Evented or EventTarget object");if("on"in t)return t.on(e,i);if(Array.isArray(e)){const s=e.slice();for(const e of s)t.addEventListener(e,i);return{remove(){for(const e of s)t.removeEventListener(e,i)}}}return t.addEventListener(e,i),{remove(){t.removeEventListener(e,i)}}}function _e(t,e,i){if(!Ie(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const s=je(t,e,(e=>{s.remove(),i.call(t,e)}));return{remove(){s.remove()}}}function Te(t,e,i){let s=!1;const n=je(t,e,(e=>{s||i.call(t,e)}));return{resume(){s=!1},pause(){s=!0},remove(){n.remove()}}}const Oe={Win:"Meta",Scroll:"ScrollLock",Spacebar:" ",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Multiply:"*",Add:"+",Subtract:"-",Decimal:".",Divide:"/"};function Ae({key:t}){return Oe[t]||t}function Fe(t){return Promise.all(t)}function Ce(t){return new Promise(((e,i)=>{try{t(e,i)}catch(t){Promise.resolve().then((()=>i(t)))}}))}function Pe(t="Aborted"){return new dt("AbortError",t)}function Ee(t,e="Aborted"){if(Re(t))throw Pe(e)}function Le(t){return u(t)?"aborted"in t?t:t.signal:t}function Re(t){const e=Le(t);return u(e)&&e.aborted}function Ne(t){if(Ge(t))throw t}function De(t){if(!Ge(t))throw t}function Ve(t,e){const i=Le(t);if(!c(i)){if(!i.aborted)return _e(i,"abort",(()=>e()));e()}}function $e(t,e){const i=Le(t);if(!c(i))return Ee(i),_e(i,"abort",(()=>e(Pe())))}function ze(t,e){return c(Le(e))?t:new Promise(((i,s)=>{let n=Ve(e,(()=>s(Pe())));const r=()=>n=v(n);t.then(r,r),t.then(i,s)}))}function Ge(t){return t&&"AbortError"===t.name}function Ue(t){return t.catch((t=>{if(!Ge(t))throw t}))}function qe(){let t=null;const e=new Promise(((e,i)=>{t={promise:void 0,resolve:e,reject:i}}));return t.promise=e,t}function Be(t){if(!t)return;if("function"!=typeof t.forEach){const e=Object.keys(t);return Be(e.map((e=>t[e]))).then((t=>{const i={};return e.forEach(((e,s)=>i[e]=t[s])),i}))}const e=t;return Ce((t=>{const i=[];let s=e.length;0===s&&t(i),e.forEach((e=>{const n={promise:e||Promise.resolve(e)};i.push(n),n.promise.then((t=>{n.value=t})).catch((t=>{n.error=t})).then((()=>{--s,0===s&&t(i)}))}))}))}function We(t){return Be(t).then((t=>t.filter((t=>!!t.value)).map((t=>t.value))))}function He(t){return Promise.reject(t)}function Je(t){return Promise.resolve(t)}function Ze(t,e,i){const s=new AbortController;return Ve(i,(()=>s.abort())),new Promise(((i,n)=>{let r=setTimeout((()=>{r=0,i(e)}),t);Ve(s,(()=>{r&&(clearTimeout(r),n(Pe()))}))}))}function Qe(t){return t&&"function"==typeof t.then}function Ke(t){return Ye(t)?t:Promise.resolve(t)}function Ye(t){return t&&"object"==typeof t&&"then"in t&&"function"==typeof t.then}function Xe(t,e=-1){let i,s,n,r,o=null;const a=(...l)=>{if(i){s=l,r&&r.reject(Pe()),r=qe();const t=r.promise;if(o){const t=o;o=null,t.abort()}return t}if(n=r||qe(),r=null,e>0){const s=new AbortController;i=Ke(t(...l,s.signal));const n=i;Ze(e).then((()=>{i===n&&(r?s.abort():o=s)}))}else i=1,i=Ke(t(...l));const u=()=>{const t=s;s=n=i=o=null,null!=t&&a(...t)},c=i,h=n;return c.then(u,u),c.then(h.resolve,h.reject),h.promise};return a}function ti(){let t,e;const i=new Promise(((i,s)=>{t=i,e=s})),s=e=>{t(e)};return s.resolve=e=>t(e),s.reject=t=>e(t),s.timeout=(t,e)=>ke.setTimeout((()=>s.reject(e)),t),s.promise=i,s}function ei(t){let e=new AbortController;const i=t(e.signal);let s={promise:i,finished:!1,abort:()=>{e&&(e.abort(),e=null)}};const n=()=>{s&&(s.finished=!0,s=null),e=null};return i.then(n,n),s}const ii=["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"];function si(t){const e=Ht(t,!0);return e&&e.endsWith(".arcgis.com")&&!ii.includes(e)&&!t.endsWith("/sharing/rest/generateToken")}function ni(t,e,i=!1,s){return new Promise(((n,r)=>{if(Re(s))return void r(ri());let o=()=>{h(),r(Error("Unable to load "+e))},a=()=>{const e=t;h(),n(e)},c=()=>{if(!t)return;const e=t;h(),e.src="",r(ri())};const h=()=>{l("esri-image-decode")||(t.removeEventListener("error",o),t.removeEventListener("load",a)),o=null,a=null,t=null,u(s)&&s.removeEventListener("abort",c),c=null,i&&URL.revokeObjectURL(e)};u(s)&&s.addEventListener("abort",c),l("esri-image-decode")?t.decode().then(a,o):(t.addEventListener("error",o),t.addEventListener("load",a))}))}function ri(){try{return new DOMException("Aborted","AbortError")}catch{const t=Error();return t.name="AbortError",t}}async function oi(t,e){var s;const n=Qt(t),r=Zt(t);r||n||(t=Bt(t));const o={url:t,requestOptions:{...e}};let a=Vt(t);if(a){const t=await async function(t,e){if(null!=t.responseData)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,s;try{s=await t.before(e)}catch(t){i=mi("request:interceptor",t,e)}if((s instanceof Error||s instanceof dt)&&(i=mi("request:interceptor",s,e)),i)throw t.error&&t.error(i),i;return s}}(a,o);if(null!=t)return{data:t,getHeader:fi,requestOptions:o.requestOptions,url:o.url};a.after||a.error||(a=null)}if(t=o.url,"image"===(e=o.requestOptions).responseType){if(l("host-webworker")||l("host-node"))throw mi("request:invalid-parameters",Error("responseType 'image' is not supported in Web Workers or Node environment"),o)}else if(n)throw mi("request:invalid-parameters",Error("Data URLs are not supported for responseType = "+e.responseType),o);if("head"===e.method){if(e.body)throw mi("request:invalid-parameters",Error("body parameter cannot be set when method is 'head'"),o);if(n||r)throw mi("request:invalid-parameters",Error("data and blob URLs are not supported for method 'head'"),o)}if(await async function(){l("host-webworker")?ai||(ai=await import("./p-e67e3410.js")):oi._abortableFetch||(oi._abortableFetch=i.fetch.bind(i))}(),ai)return ai.execute(t,e);const u=new AbortController;Ve(e,(()=>u.abort()));const c={controller:u,credential:null,credentialToken:null,fetchOptions:null,hasToken:!1,interceptor:a,params:o,redoRequest:!1,useIdentity:li.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},h=await async function(t){var e,s;let n,r;await async function(t){const e=t.params.url,s=t.params.requestOptions,n=t.controller.signal,r=s.body;let o=null,a=null,l=null;if(ui&&"HTMLFormElement"in i&&(r instanceof FormData?o=r:r instanceof HTMLFormElement&&(a=r,o=new FormData(a))),"string"==typeof r&&(l=r),t.fetchOptions={cache:s.cacheBust&&!oi._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:s.headers||{},method:"head"===s.method?"HEAD":"GET",mode:"cors",redirect:"follow",signal:n},(o||l)&&(t.fetchOptions.body=o||l),"anonymous"===s.authMode&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||s.query&&s.query.token||o&&o.get&&o.get("token")||a&&a.elements.token),!t.hasToken&&it.apiKey&&si(e)&&(s.query||(s.query={}),s.query.token=it.apiKey,t.hasToken=!0),t.useIdentity&&!t.hasToken&&!t.credentialToken&&!vi(e)&&!Re(n)){let i;"immediate"===s.authMode?(await gi(),i=await Me.getCredential(e,{signal:n}),t.credential=i):"no-prompt"===s.authMode?(await gi(),i=await Me.getCredential(e,{prompt:!1,signal:n}).catch((()=>{})),t.credential=i):Me&&(i=Me.findCredential(e)),i&&(t.credentialToken=i.token,t.useSSL=!!i.ssl)}}(t);try{do{[n,r]=await wi(t)}while(!await Mi(t,n,r))}catch(e){const i=mi("request:server",e,t.params,n);throw i.details.ssl=t.useSSL,t.interceptor&&t.interceptor.error&&t.interceptor.error(i),i}const o=t.params.url;if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(o)&&!t.hasToken&&!t.credentialToken&&null!=(e=r)&&null!=(s=e.user)&&s.username&&!zt(o)){const t=Ht(o,!0);t&&li.trustedServers.push(t)}const a=t.credential;if(a&&Me){const t=Me.findServerInfo(a.server);let e=t&&t.owningSystemUrl;if(e){e=e.replace(/\/?$/,"/sharing");const t=Me.findCredential(e,a.userId);t&&-1===Me._getIdenticalSvcIdx(e,t)&&t.resources.unshift(e)}}return{data:r,getHeader:n?t=>n.headers.get(t):fi,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}(c);return null==(s=a)||null==s.after||s.after(h),h}let ai;const li=it.request,ui="FormData"in i,ci=[499,498,403,401],hi=["COM_0056","COM_0057","SB_0008"],di=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],fi=()=>null,pi=Symbol();function yi(t){const e=Ht(t);return!e||e.endsWith(".arcgis.com")||oi._corsServers.includes(e)||zt(e)}function mi(t,e,i,s){let n="Error";const r={url:i.url,requestOptions:i.requestOptions,getHeader:fi,ssl:!1};if(e instanceof dt)return e.details?(e.details=H(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=r,e;if(e){const t=s&&(t=>s.headers.get(t)),i=s&&s.status,o=e.message;o&&(n=o),t&&(r.getHeader=t),r.httpStatus=(null!=e.httpCode?e.httpCode:e.code)||i||0,r.subCode=e.subcode,r.messageCode=e.messageCode,r.messages="string"==typeof e.details?[e.details]:e.details,r.raw=pi in e?e[pi]:e}return Ge(e)?Pe():new dt(t,n,r)}async function gi(){Me||await import("./p-e60d973c.js")}function vi(t){return di.some((e=>e.test(t)))}async function wi(t){let e=t.params.url;const i=t.params.requestOptions,s=t.fetchOptions,n=Zt(e)||Qt(e),r=i.responseType||"json",o=n?0:null!=i.timeout?i.timeout:li.timeout;let a=!1;if(!n){t.useSSL&&(e=ne(e)),i.cacheBust&&"default"===s.cache&&(e=pe(e,"request.preventCache",Date.now()));let n={...i.query};t.credentialToken&&(n.token=t.credentialToken);let r=Ft(n);l("esri-url-encodes-apostrophe")&&(r=r.replace(/'/g,"%27"));const o=e.length+1+r.length;let u;a="delete"===i.method||"post"===i.method||"put"===i.method||!!i.body||o>li.maxUrlLength;const c=i.useProxy||!!Rt(e);if(c){const t=function(t=!1){let e,i=pt.proxyUrl;if("string"==typeof t){e=se(t);const s=Rt(t);s&&(i=s.proxyUrl)}else e=!!t;if(!i)throw ft.warn(yt),new dt("urlutils:proxy-not-set",yt);return e&&re()&&(i=ne(i)),Tt(i)}(e);u=t.path,!a&&u.length+1+o>li.maxUrlLength&&(a=!0),t.query&&(n={...t.query,...n})}if("HEAD"===s.method&&(a||c)){if(a){if(o>li.maxUrlLength)throw mi("request:invalid-parameters",Error("URL exceeds maximum length"),t.params);throw mi("request:invalid-parameters",Error("cannot use POST request when method is 'head'"),t.params)}if(c)throw mi("request:invalid-parameters",Error("cannot use proxy when method is 'head'"),t.params)}if(a?(s.method="delete"===i.method?"DELETE":"put"===i.method?"PUT":"POST",i.body?e=ye(e,n):(s.body=Ft(n),s.headers["Content-Type"]="application/x-www-form-urlencoded")):e=ye(e,n),c&&(t.useProxy=!0,e=`${u}?${e}`),n.token&&ui&&s.body instanceof FormData){const t=s.body;t.set?t.set("token",n.token):t.append("token",n.token)}if(i.hasOwnProperty("withCredentials"))t.withCredentials=i.withCredentials;else if(!$t(e,It))if(zt(e))t.withCredentials=!0;else if(Me){const i=Me.findServerInfo(e);i&&i.webTierAuth&&(t.withCredentials=!0)}t.withCredentials&&(s.credentials="include")}let u,c,h=0,d=!1;o>0&&(h=setTimeout((()=>{d=!0,t.controller.abort()}),o));try{if("native-request-init"===i.responseType)c=s,c.url=e;else if("image"!==i.responseType||"default"!==s.cache||"GET"!==s.method||a||function(t){if(t)for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0;return!1}(i.headers)||!n&&!t.useProxy&&li.proxyUrl&&!yi(e)){if(u=await oi._abortableFetch(e,s),t.useProxy||function(t){const e=Ht(t);e&&!oi._corsServers.includes(e)&&oi._corsServers.push(e)}(e),"native"===i.responseType)c=u;else if("HEAD"!==s.method)if(u.ok){switch(r){case"array-buffer":c=await u.arrayBuffer();break;case"blob":case"image":c=await u.blob();break;default:c=await u.text()}if(h&&(clearTimeout(h),h=0),"json"===r||"xml"===r||"document"===r)if(c)switch(r){case"json":c=JSON.parse(c);break;case"xml":c=bi(c,"application/xml");break;case"document":c=bi(c,"text/html")}else c=null;if(c){if("array-buffer"===r||"blob"===r){const t=u.headers.get("Content-Type");if(/application\/json|text\/plain/i.test(t)&&c["blob"===r?"size":"byteLength"]<=750)try{const t=await new Response(c).json();t.error&&(c=t)}catch{}}"image"===r&&c instanceof Blob&&(c=await Si(URL.createObjectURL(c),t,!0))}}else c=await u.text()}else c=await Si(e,t)}catch(s){if("AbortError"===s.name){if(d)throw Error("Timeout exceeded");throw Pe("Request canceled")}if(!(!u&&s instanceof TypeError&&li.proxyUrl)||i.body||"delete"===i.method||"head"===i.method||"post"===i.method||"put"===i.method||t.useProxy||yi(e))throw s;t.redoRequest=!0,function(t){const e={proxyUrl:t.proxyUrl,urlPrefix:Lt(t.urlPrefix)},i=pt.proxyRules,s=e.urlPrefix;let n=i.length;for(let t=0;t<i.length;t++){const e=i[t].urlPrefix;if(0===s.indexOf(e)){if(s.length===e.length)return-1;n=t;break}0===e.indexOf(s)&&(n=t+1)}i.splice(n,0,e)}({proxyUrl:li.proxyUrl,urlPrefix:Ht(e)})}finally{h&&clearTimeout(h)}return[u,c]}function bi(t,e){let i;try{i=(new DOMParser).parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}async function Mi(t,e,i){if(t.redoRequest)return t.redoRequest=!1,!1;const s=t.params.requestOptions;if(!e||"native"===s.responseType||"native-request-init"===s.responseType)return!0;let n,r,o,a;if(!e.ok)throw n=Error(`Unable to load ${e.url} status: ${e.status}`),n[pi]=i,n;null!=i&&i.error&&(n=i.error),n&&(r=Number(n.code),o=n.hasOwnProperty("subcode")?Number(n.subcode):null,a=n.messageCode,a=a&&a.toUpperCase());const l=s.authMode;if(403===r&&(4===o||n.message&&n.message.toLowerCase().indexOf("ssl")>-1&&-1===n.message.toLowerCase().indexOf("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&("no-prompt"!==l||498===r)&&-1!==ci.indexOf(r)&&!vi(t.params.url)&&(403!==r||-1===hi.indexOf(a)&&(null==o||2===o&&t.credentialToken))){await gi();try{const e=await Me.getCredential(t.params.url,{error:mi("request:server",n,t.params),prompt:"no-prompt"!==l,signal:t.controller.signal,token:t.credentialToken});return t.credential=e,t.credentialToken=e.token,t.useSSL=t.useSSL||e.ssl,!1}catch(e){if("no-prompt"===l)return t.credential=null,t.credentialToken=null,!1;n=e}}if(n)throw n;return!0}function Si(t,e,i=!1){const s=e.controller.signal,n=new Image;return n.crossOrigin=e.withCredentials?"use-credentials":"anonymous",n.alt="",n.src=t,ni(n,t,i,s)}oi._abortableFetch=null,oi._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];const xi=Object.freeze({__proto__:null,default:oi}),ki=ct.getLogger("esri.assets");function Ii(t){if(!it.assetsPath)throw ki.errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new dt("assets:path-not-set","config.assetsPath is not set");return Wt(it.assetsPath,t)}const ji=new Set;function _i(t,e,i={}){if(l("esri-deprecation-warnings")){const{moduleName:s}=i;Oi(t,"Function: "+(s?s+"::":"")+e+"()",i)}}function Ti(t,e,i={}){if(l("esri-deprecation-warnings")){const{moduleName:s}=i;Oi(t,"Property: "+(s?s+"::":"")+e,i)}}function Oi(t,e,i={}){if(l("esri-deprecation-warnings")){const{replacement:s,version:n,see:r,warnOnce:o}=i;let a=e;s&&(a+="\n\t🛠️ Replacement: "+s),n&&(a+="\n\t⚙️ Version: "+n),r&&(a+=`\n\t🔗 See ${r} for more details.`),function(t,e,i=!1){i&&ji.has(e)||(i&&ji.add(e),t.warn("🛑 DEPRECATED - "+e))}(t,a,o)}}function Ai(t){return Fi((()=>t.forEach((t=>u(t)&&t.remove()))))}function Fi(t){return{remove:()=>{t&&(t(),t=void 0)}}}function Ci(t){return t?t.__accessor__?t.__accessor__:t.propertyInvalidated?t:null:null}function Pi(t,e,i){return Ei(t,e,i?{policy:i,path:""}:null)}function Ei(t,e,i){return e?Object.keys(e).reduce((function(t,s){let n=null,r="merge";if(i&&(n=i.path?`${i.path}.${s}`:s,r=i.policy(n)),"replace"===r)return t[s]=e[s],t;if(void 0===t[s])return t[s]=H(e[s]),t;let o=t[s],a=e[s];if(o===a)return t;if(Array.isArray(a)||Array.isArray(t))o=t[s]=o?Array.isArray(o)?o.concat():[o]:[],a&&(Array.isArray(a)||(a=[a]),a.forEach((t=>{-1===o.indexOf(t)&&o.push(t)})));else if(a&&"object"==typeof a)if(i){const e=i.path;i.path=n,t[s]=Ei(o,a,i),i.path=e}else t[s]=Ei(o,a,null);else t.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(t[s]=a);return t}),t||{}):t}function Li(t){return Array.isArray(t)?t:t.split(".")}function Ri(t){return t.indexOf(",")>-1?t.split(",").map((t=>t.trim())):[t.trim()]}function Ni(t,e,i,s){const n=function(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(...Ri(i));return e}return Ri(t)}(e);return 1!==n.length?Ai(n.map((e=>s(t,e,i)))):s(t,n[0],i)}function Di(t){let e=!1;return()=>{e||(e=!0,t())}}function Vi(t,e){const i="?"===t[t.length-1]?t.slice(0,-1):t;if(null!=e.getItemAt||Array.isArray(e)){const t=parseInt(i,10);if(!isNaN(t))return Array.isArray(e)?e[t]:e.getItemAt(t)}const s=Ci(e);return function(t,e){return null!=t&&t.metadatas&&null!=t.metadatas[e]}(s,i)?s.get(i):e[i]}function $i(t,e,i){if(null==t)return t;const s=Vi(e[i],t);return!s&&i<e.length-1?void 0:i===e.length-1?s:$i(s,e,i+1)}function zi(t,e,i=0){return"string"==typeof e&&-1===e.indexOf(".")?Vi(e,t):$i(t,Li(e),i)}function Gi(t,e){return zi(t,e)}function Ui(t,e){return void 0!==zi(e,t)}class qi{constructor(t){this.autoDestroy=!1,this.properties=t}}function Bi(t){let e=t.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!i){const i=Object.create(e.properties),s=e.autoDestroy;for(const t in i)i[t]=H(i[t]);e=new qi(i),e.autoDestroy=s,Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e=new qi({}),Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function Wi(t,e){const i=function(t){return Bi(t).properties}(t);let s=i[e];return s||(s=i[e]={}),s}const Hi=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function Ji(t){return Hi.test(t)?"replace":"merge"}class Zi{constructor(t,e,i,s=1,n=0){if(this.ctor=t,this.acquireFunction=e,this.releaseFunction=i,this.allocationSize=s,this._pool=Array(n),this._initialSize=n,this.ctor)for(let t=0;t<n;t++)this._pool[t]=new this.ctor;this.allocationSize=Math.max(s,1)}destroy(){this.prune(0)}acquire(...t){let e;if(Zi.test.disabled)e=new this.ctor;else{if(0===this._pool.length){const t=this.allocationSize;for(let e=0;e<t;e++)this._pool[e]=new this.ctor}e=this._pool.pop()}return this.acquireFunction?this.acquireFunction(e,...t):function(t){return t&&t.acquire&&"function"==typeof t.acquire}(e)&&e.acquire(...t),e}release(t){t&&!Zi.test.disabled&&(this.releaseFunction?this.releaseFunction(t):function(t){return t&&t.release&&"function"==typeof t.release}(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let e=t;e<this._pool.length;++e)this._dispose(this._pool[e]);this._pool.length=t}}_dispose(t){t.dispose&&"function"==typeof t.dispose&&t.dispose()}}Zi.test={disabled:!1};let Qi,Ki=[];const Yi=ct.getLogger("esri.core.Accessor");function Xi(t){void 0!==Qi&&Qi.onObservableAccessed(t)}let ts=!1,es=!1;function is(t,e,i){if(ts)return ss(t,e,i);ns(t);const s=e.call(i);return rs(),s}function ss(t,e,i){const s=ts;ts=!0,ns(t);let n=null;try{n=e.call(i)}catch(t){es&&Yi.error(t)}return rs(),ts=s,n}function ns(t){Qi=t,Ki.push(t)}function rs(){const t=Ki.pop();Qi=Ki.length>0?Ki[Ki.length-1]:void 0,void 0!==t&&t.onTrackingEnd()}function os(t,e){if(32&e.flags)return;const i=es;es=!1,64&e.flags?ss(e,e.metadata.get,t):ls(t,e),es=i}const as=[];function ls(t,e){128&e.flags||(e.flags|=128,ss(e,(()=>{const i=e.metadata.dependsOn||as;for(const e of i)if("string"==typeof e&&-1===e.indexOf("."))us(t,e,!1);else{const i=Li(e);for(let e=0,s=t;e<i.length&&null!=s&&"object"==typeof s;++e)s=us(s,i[e],e!==i.length-1)}})),e.flags&=-129)}function us(t,e,i){const s="?"===e[e.length-1]?e.slice(0,-1):e;if(null!=t.getItemAt||Array.isArray(t)){const e=parseInt(s,10);if(!isNaN(e))return Array.isArray(t)?t[e]:t.getItemAt(e)}const n=Ci(t),r=null==n?void 0:n.properties.get(s);return r&&(Xi(r),os(t,r)),i?t[s]:void 0}class cs{constructor(t,e){this._observers=t,this._observer=e}remove(){V(this._observers,this._observer)}}class hs{constructor(t,e,i){this.properties=t,this.propertyName=e,this.metadata=i,this._observers=null,this._accessed=null,this._handles=null,this.flags=1|(i.nonNullable?8:0)|(i.hasOwnProperty("value")?16:0)|(void 0===i.get?32:0)|(void 0===i.dependsOn?64:0)}destroy(){this._accessed=null,this._observers=null,this._clearObservationHandles()}getComputed(){Xi(this);const t=this.properties.store,e=this.propertyName,i=this.flags,s=t.get(e);if(4&i)return s;if(1&~i&&t.has(e))return s;this.flags|=4;const n=this.properties.host;let r;64&i?r=is(this,this.metadata.get,n):(ls(n,this),r=this.metadata.get.call(n)),t.set(e,r,1);const o=t.get(e);return o===s?this.flags&=-2:this.commit(),this.flags&=-5,o}onObservableAccessed(t){t!==this&&(null===this._accessed&&(this._accessed=[]),this._accessed.includes(t)||this._accessed.push(t))}onTrackingEnd(){this._clearObservationHandles(),this.flags|=32;const t=this._accessed;if(null===t)return;let e=this._handles;null===e&&(e=this._handles=[]);for(let i=0;i<t.length;++i)e.push(t[i].observe(this));t.length=0}observe(t){return null===this._observers&&(this._observers=[]),this._observers.includes(t)||this._observers.push(t),new cs(this._observers,t)}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}onInvalidated(){2&~this.flags&&(this.flags|=1);const t=this._observers;if(null!==t)for(let e=0;e<t.length;++e)t[e].onInvalidated()}commit(){this.flags&=-2,this.onCommitted()}onCommitted(){if(null===this._observers)return;const t=this._observers.slice();for(let e=0;e<t.length;++e)t[e].onCommitted()}_clearObservationHandles(){const t=this._handles;if(null!==t){for(let e=0;e<t.length;++e)t[e].remove();t.length=0}}}function ds(t){switch(t){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"user":return 6}}function fs(t){switch(t){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"user"}}function ps(t){return fs(t)}class ys{constructor(){this._values=new Map}clone(t){const e=new ys;return this._values.forEach(((i,s)=>{t&&t.has(s)||e.set(s,H(i))})),e}get(t){return this._values.get(t)}originOf(){return 6}keys(){return[...this._values.keys()]}set(t,e){this._values.set(t,e)}delete(t){this._values.delete(t)}has(t){return this._values.has(t)}forEach(t){this._values.forEach(t)}}function ms(t){return void 0!==t}function gs(t,e,i){return!(void 0===t||null==i&&8&t.flags)}function vs(t){return t&&"function"==typeof t.destroy}ct.getLogger("esri.core.accessorSupport.Properties");class ws{constructor(t){this.host=t,this.properties=new Map,this.ctorArgs=null,this.destroyed=!1,this.lifecycle=0,this.store=new ys,this._origin=6;const e=this.host.constructor.__accessorMetadata__,i=e.properties;for(const t in i){const e=new hs(this,t,i[t]);this.properties.set(t,e)}this.metadatas=i,this._autoDestroy=e.autoDestroy}initialize(){this.lifecycle=1}constructed(){this.lifecycle=2}destroy(){if(this.destroyed=!0,this._autoDestroy)for(const[t,e]of this.properties){const i=this.internalGet(t);i&&vs(i)&&(i.destroy(),8&~e.flags&&this._internalSet(e,null)),e.destroy()}else for(const[t,e]of this.properties)e.destroy()}get initialized(){return 0!==this.lifecycle}get(t){const e=this.properties.get(t);if(e.metadata.get)return e.getComputed();Xi(e);const i=this.store;return i.has(t)?i.get(t):e.metadata.value}originOf(t){const e=this.store.originOf(t);if(void 0===e){const e=this.properties.get(t);if(void 0!==e&&16&e.flags)return"defaults"}return fs(e)}has(t){return!!this.properties.has(t)&&this.store.has(t)}keys(){return[...this.properties.keys()]}internalGet(t){const e=this.properties.get(t);if(ms(e))return this.store.has(t)?this.store.get(t):e.metadata.value}internalSet(t,e){const i=this.properties.get(t);ms(i)&&this._internalSet(i,e)}getDependsInfo(t,e,i){const s=this.properties.get(e);if(!ms(s))return"";const n=new Set,r=is({onObservableAccessed:t=>n.add(t),onTrackingEnd:()=>{}},(()=>{var e;return null==(e=s.metadata.get)?void 0:e.call(t)}));let o=`${i}${t.declaredClass.split(".").pop()}.${e}: ${r}\n`;if(0===n.size)return o;i+="  ";for(const t of n){if(!(t instanceof hs))continue;const e=t.properties.host,s=t.propertyName,n=Ci(e);o+=n?n.getDependsInfo(e,s,i):`${i}${s}: undefined\n`}return o}setAtOrigin(t,e,i){const s=this.properties.get(t);if(ms(s))return this._setAtOrigin(s,e,i)}isOverridden(t){const e=this.properties.get(t);return void 0!==e&&!!(2&e.flags)}clearOverride(t){const e=this.properties.get(t);void 0!==e&&2&e.flags&&(e.flags&=-3,e.notifyChange())}override(t,e){const i=this.properties.get(t);if(!gs(i,0,e))return;const s=i.metadata.cast;if(s){const t=this._cast(s,e),{valid:i,value:n}=t;if(bs.release(t),!i)return;e=n}i.flags|=2,this._internalSet(i,e)}set(t,e){const i=this.properties.get(t);if(!gs(i,0,e))return;const s=i.metadata.cast;if(s){const t=this._cast(s,e),{valid:i,value:n}=t;if(bs.release(t),!i)return;e=n}const n=i.metadata.set;n?n.call(this.host,e):this._internalSet(i,e)}setDefaultOrigin(t){this._origin=ds(t)}getDefaultOrigin(){return fs(this._origin)}notifyChange(t){const e=this.properties.get(t);void 0!==e&&e.notifyChange()}invalidate(t){const e=this.properties.get(t);void 0!==e&&e.invalidate()}commit(t){const e=this.properties.get(t);void 0!==e&&e.commit()}_internalSet(t,e){this._setAtOrigin(t,e,0!==this.lifecycle?this._origin:0)}_setAtOrigin(t,e,i){const s=this.store,n=t.propertyName;s.has(n,i)&&J(e,s.get(n))&&2&~t.flags&&i===s.originOf(n)||(t.invalidate(),s.set(n,e,i),t.commit(),os(this.host,t))}_cast(t,e){const i=bs.acquire();return i.valid=!0,i.value=e,t&&(i.value=t.call(this.host,e,i)),i}}const bs=new Zi(class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}});function Ms(t,e,i){if(t&&e)if("object"==typeof e)for(const i of Object.getOwnPropertyNames(e))Ms(t,i,e[i]);else{if(-1!==e.indexOf(".")){const s=e.split("."),n=s.splice(s.length-1,1)[0];return void Ms(Gi(t,s),n,i)}t[e]=i}}function Ss(t){t.length=0}ct.getLogger("esri.core.accessorSupport.set");class xs{constructor(t=50,e=50){this._pool=new Zi(Array,void 0,Ss,e,t)}acquire(){return this._pool.acquire()}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return ks.acquire()}static release(t){return ks.release(t)}static prune(){ks.prune()}}const ks=new xs(100),Is=i.queueMicrotask?i.queueMicrotask:t=>{i.Promise.resolve().then(t)},js=[];function _s(t){js.push(t),1===js.length&&Is((()=>{const t=js.slice();js.length=0;for(const e of t)e()}))}class Ts{constructor(t,e=29){this.name=t,this._counter=0,this._items=Array(e)}record(t){this._items[++this._counter%this._items.length]=t}get median(){return this._items.slice().sort(((t,e)=>t-e))[Math.floor(this._items.length/2)]}get average(){return this._items.reduce(((t,e)=>t+e),0)/this._items.length}get last(){return this._items[this._counter%this._items.length]}}var Os;!function(t){const e=(t,e,i,s)=>{let n=e,r=e;const o=i>>>1,a=t[n-1];for(;r<=o;){r=n<<1,r<i&&s(t[r-1],t[r])<0&&++r;const e=t[r-1];if(s(e,a)<=0)break;t[n-1]=e,n=r}t[n-1]=a},i=(t,e)=>t<e?-1:t>e?1:0;t.sort=function(t,s,n,r){void 0===s&&(s=0),void 0===n&&(n=t.length),void 0===r&&(r=i);for(let i=n>>>1;i>s;i--)e(t,i,n,r);const o=s+1;for(let i=n-1;i>s;i--){const n=t[s];t[s]=t[i],t[i]=n,e(t,o,i,r)}},t.iterableSort=function*(t,s,n,r){void 0===s&&(s=0),void 0===n&&(n=t.length),void 0===r&&(r=i);for(let i=n>>>1;i>s;i--)e(t,i,n,r),yield;const o=s+1;for(let i=n-1;i>s;i--){const n=t[s];t[s]=t[i],t[i]=n,e(t,o,i,r),yield}}}(Os||(Os={}));const As=Os;class Fs{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new E,t&&(t.initialSize&&(this.data=Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),void 0!==t.deallocator&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>Cs(this)))}toArray(){return this.data.slice(0,this.length)}getItemAt(t){if(!(t<0||t>=this._length))return this.data[t]}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let e=t;e<this._length;++e)this.data[e]=this._deallocator(this.data[e]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,e=t.length){for(let i=0;i<e;i++)this.data[this._length++]=t[i]}fill(t,e){for(let i=0;i<e;i++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,Cs(this)}pop(){if(0===this.length)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const e=R(this.data,t,this.length,this._hint);if(-1!==e)return this.data.splice(e,1),this.length=this.length-1,t}removeUnordered(t){const e=N(this.data,t,this.length,this._hint);return void 0!==e&&(this.length=this.length-1),this._shrink(),e}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,e=t.length,i){this.length=function(t,e,i=t.length,s=e.length,n,r){if(0===s||0===i)return i;D.clear();for(let t=0;t<s;++t)D.add(e[t]);const o=Math.max(0,(n=n||L).last-10);for(let e=o;e<i;++e)if(D.has(t[e])&&(r&&r.push(t[e]),D.delete(t[e]),t[e]=t[i-1],--i,--e,0===D.size||0===i))return D.clear(),i;for(let e=0;e<o;++e)if(D.has(t[e])&&(r&&r.push(t[e]),D.delete(t[e]),t[e]=t[i-1],--i,--e,0===D.size||0===i))return D.clear(),i;return D.clear(),i}(this.data,t,this.length,e,this._hint,i),this._shrink()}front(){if(0!==this.length)return this.data[0]}back(){if(0!==this.length)return this.data[this.length-1]}swapElements(t,e){t>=this.length||e>=this.length||t===e||([this.data[t],this.data[e]]=[this.data[e],this.data[t]])}sort(t){As.sort(this.data,0,this.length,t)}iterableSort(t){return As.iterableSort(this.data,0,this.length,t)}some(t,e){for(let i=0;i<this.length;++i)if(t.call(e,this.data[i],i,this.data))return!0;return!1}filterInPlace(t,e){let i=0;for(let s=0;s<this._length;++s){const n=this.data[s];t.call(e,n,s,this.data)&&(this.data[s]=this.data[i],this.data[i]=n,i++)}if(this._deallocator)for(let t=i;t<this._length;t++)this.data[t]=this._deallocator(this.data[t]);return this._length=i,this._shrink(),this}forAll(t,e){const i=this.length,s=this.data;for(let n=0;n<i;++n)t.call(e,s[n],n,s)}forEach(t,e){for(let i=0;i<this.length;++i)t.call(e,this.data[i],i,this.data)}map(t,e){const i=Array(this.length);for(let s=0;s<this.length;++s)i[s]=t.call(e,this.data[s],s,this.data);return i}reduce(t,e){let i=e;for(let e=0;e<this.length;++e)i=t(i,this.data[e],e,this.data);return i}has(t){const e=this.length,i=this.data;for(let s=0;s<e;++s)if(i[s]===t)return!0;return!1}}function Cs(t){t.data.length>1.5*t.length&&(t.data.length=Math.floor(1.1*t.length))}class Ps{constructor(t){this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1}}class Es{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}}let Ls=0;const Rs={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},Ns=["prepare","preRender","render","postRender","update"],Ds=[],Vs=new Fs;class $s{constructor(t){this._task=t}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}}const zs={frameTasks:Vs,willDispatch:!1,clearFrameTasks:function(t=!1){Vs.forAll((t=>{t.removed=!0})),t&&Hs()},dispatch:Js,executeFrameTasks:function(t){const e=t-Ls;Ls=t;const i=1e3/60,s=Math.max(0,e-i);for(let n=0;n<Ns.length;n++){const r=performance.now(),o=Ns[n];Vs.forAll((r=>{var a;r.paused||r.removed||(0===n&&r.ticks++,r.phases[o]&&(Rs.time=t,Rs.deltaTime=0===r.ticks?0:e,Rs.elapsedFrameTime=performance.now()-t,Rs.frameDuration=i-s,null==(a=r.phases[o])||a.call(r,Rs)))})),Qs[n].record(performance.now()-r)}Hs(),Ks.record(performance.now()-t)}};function Gs(t){const e=new Es(t);return Ds.push(e),zs.willDispatch||(zs.willDispatch=!0,_s(Js)),e}function Us(t){const e=new Ps(t);return Vs.push(e),null==qs&&(Ls=performance.now(),qs=requestAnimationFrame(Bs)),new $s(e)}let qs=null;function Bs(){const t=performance.now();qs=null,qs=Vs.length>0?requestAnimationFrame(Bs):null,zs.executeFrameTasks(t)}const Ws=new Fs;function Hs(){Vs.forAll((t=>{t.removed&&Ws.push(t)})),Vs.removeUnorderedMany(Ws.data,Ws.length),Ws.clear()}function Js(){for(;Ds.length;){const t=Ds.shift();t.isActive&&t.callback()}zs.willDispatch=!1}function Zs(t=1,e){const i=ti(),s=()=>{Re(e)?i.reject(Pe()):0===t?i():(--t,_s((()=>s())))};return s(),i.promise}const Qs=Ns.map((t=>new Ts(t))),Ks=new Ts("total");let Ys=0;function Xs(){return++Ys}class tn{constructor(t){this._notify=t,this._accessed=[],this._handles=[],this._invalidCount=0}destroy(){this._accessed.length=0,this.clear()}onInvalidated(){this._invalidCount++}onCommitted(){const t=this._invalidCount;if(1===t)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}onObservableAccessed(t){this._accessed.includes(t)||this._accessed.push(t)}onTrackingEnd(){const t=this._handles,e=this._accessed;for(let i=0;i<e.length;++i)t.push(e[i].observe(this));e.length=0}clear(){const t=this._handles;for(let e=0;e<t.length;++e)t[e].remove();t.length=0}}let en=!1;const sn=[];function nn(t,e){let i=new tn((function r(){if(!i||n)return;if(en)return void an(r);const o=s;i.clear(),en=!0,n=!0,s=is(i,t),n=!1,en=!1,e(s,o),ln()})),s=null,n=!1;return n=!0,s=is(i,t),n=!1,{remove:function(){i&&(i.destroy(),i=null,s=null)}}}function rn(t,e){let i=new tn((function(){e(s,n)})),s=null;function n(){return i?(i.clear(),s=is(i,t),s):null}return n(),{remove:function(){i&&(i.destroy(),i=null),s=null}}}function on(t){let e=new tn((function s(){e&&!i&&(en?an(s):(e.clear(),en=!0,i=!0,is(e,t),i=!1,en=!1,ln()))})),i=!1;return i=!0,is(e,t),i=!1,{remove:function(){e&&(e.destroy(),e=null)}}}function an(t){sn.includes(t)||sn.unshift(t)}function ln(){for(;sn.length;)sn.pop()()}class un{constructor(){this.uid=Xs(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,e,i,s,n){return this.pool.acquire(0,t,e,i,s,n,J)}static acquireTracked(t,e,i,s){return this.pool.acquire(1,t,e,i,null,null,s)}notify(t,e){0===this.type?this.callback.call(this.target,t,e,this.path,this.target):this.callback.call(null,t,e)}acquire(t,e,i,s,n,r,o){this.uid=Xs(),this.removed=!1,this.type=t,this.oldValue=e,this.callback=i,this.getValue=s,this.target=n,this.path=r,this.equals=o}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=Xs(),this.removed=!0}}un.pool=new class extends Zi{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...t){const e=super.acquire(...t);return this._set.delete(e),e}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}}(un);const cn=new xs,hn=new Set;let dn;function fn(t){hn.delete(t),hn.add(t),dn||(dn=Gs(yn))}function pn(t){if(t.removed)return;const e=t.oldValue,i=t.getValue();t.equals(e,i)||(t.oldValue=i,t.notify(i,e))}function yn(){let t=10;for(;dn&&t--;){dn=null;const t=mn(),e=cn.acquire();for(const i of t){const t=i.uid;pn(i),t===i.uid&&i.removed&&e.push(i)}for(const t of hn)t.removed&&(e.push(t),hn.delete(t));for(const t of e)un.pool.release(t);cn.release(e),cn.release(t),gn.forEach((t=>t()))}}function mn(){const t=cn.acquire();t.length=hn.size;let e=0;for(const i of hn)t[e]=i,++e;return hn.clear(),t}const gn=new Set;function vn(t,e){for(const[i,s]of t)if(e(s,i))return!0;return!1}function wn(t,e,i){const s=t.get(e);if(void 0!==s)return s;const n=i();return t.set(e,n),n}const bn=ct.getLogger("esri.core.Accessor");function Mn(t){return null==t?t:new Date(t)}function Sn(t){return null==t?t:!!t}function xn(t){return null==t?t:""+t}function kn(t){return null==t?t:isNaN(t=parseFloat(t))?0:t}function In(t){return null==t?t:Math.round(parseFloat(t))}function jn(t){return t&&t.constructor&&void 0!==t.constructor.__accessorMetadata__}function _n(t,e){return null!=e&&t&&!(e instanceof t)}function Tn(t){return t&&"isCollection"in t}function On(t){return t&&t.Type?"function"==typeof t.Type?t.Type:t.Type.base:null}function An(t,e){return!!jn(e)&&(bn.error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+Cn(t)+"'"),!0)}function Fn(t,e){return null==e?e:Tn(t)?function(t,e){if(!e||!e.constructor||!Tn(e.constructor))return An(t,e)?e:new t(e);const i=On(t.prototype.itemType),s=On(e.constructor.prototype.itemType);return i?s?i===s?e:i.prototype.isPrototypeOf(s.prototype)?new t(e):(An(t,e),e):new t(e):e}(t,e):_n(t,e)?An(t,e)?e:new t(e):e}function Cn(t){return t&&t.prototype&&t.prototype.declaredClass||"unknown"}const Pn=new WeakMap;function En(t){switch(t){case Number:return kn;case Gn:return In;case Boolean:return Sn;case String:return xn;case Date:return Mn;default:return wn(Pn,t,(()=>Fn.bind(null,t)))}}function Ln(t,e){const i=En(t);return 1===arguments.length?i:i(e)}function Rn(t,e,i){return 1===arguments.length?Rn.bind(null,t):e?Array.isArray(e)?e.map((e=>t(e,i))):[t(e,i)]:e}function Nn(t,e,i){return 0!==e&&Array.isArray(i)?i.map((i=>Nn(t,e-1,i))):t(i)}function Dn(t,e,i){if(2===arguments.length)return Dn.bind(null,t,e);if(!i)return i;let s=e,n=i=Nn(t,e,i);for(;s>0&&Array.isArray(n);)s--,n=n[0];if(void 0!==n)for(let t=0;t<s;t++)i=[i];return i}function Vn(t){return!!Array.isArray(t)&&!t.some((e=>{const i=typeof e;return!("string"===i||"number"===i||"function"===i&&t.length>1)}))}function $n(t,e){if(2===arguments.length)return $n(t).call(null,e);const i=new Set,s=t.filter((t=>"function"!=typeof t)),n=t.filter((t=>"function"==typeof t));for(const e of t)"string"!=typeof e&&"number"!=typeof e||i.add(e);let r=null,o=null;return(t,e)=>{if(null==t)return t;const a=typeof t,l="string"===a||"number"===a;return l&&(i.has(t)||n.some((t=>"string"===a&&t===String||"number"===a&&t===Number)))||"object"===a&&n.some((e=>!_n(t,e)))?t:(l&&s.length?(r||(r=s.map((t=>"string"==typeof t?`'${t}'`:""+t)).join(", ")),bn.error("Accessor#set",`'${t}' is not a valid value for this property, only the following values are valid: ${r}`)):"object"==typeof t&&n.length?(o||(o=n.map((t=>Cn(t))).join(", ")),bn.error("Accessor#set",`'${t}' is not a valid value for this property, value must be one of ${o}`)):bn.error("Accessor#set",`'${t}' is not a valid value for this property`),e&&(e.valid=!1),null)}}function zn(t,e){if(2===arguments.length)return zn(t).call(null,e);const i={},s=[],n=[];for(const e in t.typeMap){const r=t.typeMap[e];i[e]=Ln(r),s.push(Cn(r)),n.push(e)}const r=()=>`'${s.join("', '")}'`,o=()=>`'${n.join("', '")}'`,a="string"==typeof t.key?e=>e[t.key]:t.key;return e=>{if(t.base&&!_n(t.base,e))return e;if(null==e)return e;const s=a(e)||t.defaultKeyValue,n=i[s];if(!n)return bn.error("Accessor#set",`Invalid property value, value needs to be one of ${r()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!_n(t.typeMap[s],e))return e;if("string"==typeof t.key&&!jn(e)){const i={};for(const s in e)s!==t.key&&(i[s]=e[s]);return n(i)}return n(e)}}class Gn{}const Un={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function qn(t){switch(t.type){case"native":return Ln(t.value);case"array":return Rn(qn(t.value));case"one-of":return function(t){let e=null;return(i,s)=>Wn(i,t)?i:(null==e&&(e=Bn(t)),bn.error("Accessor#set","Invalid property value, value needs to be of type "+e),s&&(s.valid=!1),null)}(t);default:return null}}function Bn(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Gn:return"integer";case Date:return"date";default:return Cn(t.value)}case"array":return"array of "+Bn(t.value);case"one-of":{const e=t.values.map((t=>Bn(t)));return`one of ${e.slice(0,e.length-1)} or ${e[e.length-1]}`}}return"unknown"}function Wn(t,e){if(null==t)return!0;switch(e.type){case"native":switch(e.value){case Number:case Gn:return"number"==typeof t;case Boolean:return"boolean"==typeof t;case String:return"string"==typeof t}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some((t=>!Wn(t,e.value)));case"one-of":return e.values.some((e=>Wn(t,e)))}}function Hn(t={}){return(e,i)=>{if(e===Function.prototype)throw Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const s=Object.getOwnPropertyDescriptor(e,i),n=Wi(e,i);s&&(s.get||s.set?(n.get=s.get||n.get,n.set=s.set||n.set):"value"in s&&("value"in t&&ct.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),n.value=t.value=s.value)),null!=t.readOnly&&(n.readOnly=t.readOnly);const r=t.aliasOf;if(r){const t="string"==typeof r?r:r.source,e="string"==typeof r?null:!0===r.overridable;let s;n.dependsOn=[t],n.get=function(){let e=Gi(this,t);if("function"==typeof e){s||(s=t.split(".").slice(0,-1).join("."));const i=Gi(this,s);i&&(e=e.bind(i))}return e},n.readOnly||(n.set=e?function(t){void 0!==t?this._override(i,t):this._clearOverride(i)}:function(e){Ms(this,t,e)})}const o=t.type,a=t.types;n.cast||(o?n.cast=function(t){let e=0,i=t;if(function(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}(t))return qn(t);for(;Array.isArray(i)&&1===i.length&&"string"!=typeof i[0]&&"number"!=typeof i[0];)i=i[0],e++;const s=i;if(Vn(s))return 0===e?$n(s):Dn($n(s),e);if(1===e)return function(t,e){return 1===arguments.length?Rn(Ln.bind(null,t)):Rn(Ln.bind(null,t),e)}(s);if(e>1)return function(t,e,i){return 2===arguments.length?Dn(Ln.bind(null,t),e):Dn(Ln.bind(null,t),e,i)}(s,e);return t.from?t.from:Ln(t)}(o):a&&(n.cast=Array.isArray(a)?Rn(zn(a[0])):zn(a))),t.range&&(n.cast=Zn(n.cast,t.range)),function(t,e){Pi(t,e,Ji)}(n,t)}}function Jn(t,e,i){const s=Wi(t,i);s.json||(s.json={});let n=s.json;return void 0!==e&&(n.origins||(n.origins={}),n.origins[e]||(n.origins[e]={}),n=n.origins[e]),n}function Zn(t,e){return i=>{let s=+t(i);return null!=e.step&&(s=Math.round(s/e.step)*e.step),null!=e.min&&(s=Math.max(e.min,s)),null!=e.max&&(s=Math.min(e.max,s)),s}}class Qn extends ht{constructor(t,e,i){if(super(t,e,i),!(this instanceof Qn))return new Qn(t,e,i)}}function Kn(t){return!!t&&t.prototype&&t.prototype.declaredClass&&0===t.prototype.declaredClass.indexOf("esri.core.Collection")}Qn.prototype.type="warning";const Yn=ct.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function Xn(t,e,i){var s,n;t&&(!i&&!e.read||null!=(s=e.read)&&s.reader||!1===(null==(n=e.read)?void 0:n.enabled)||function(t){return"types"in t?or(t.types):rr(t.type)}(t)&&K("read.reader",tr(t),e))}function tr(t){var e;const i=null!=(e=t.ndimArray)?e:0;if(i>1)return function(t){var e;const i=er(t),s=ir.bind(null,i),n=null!=(e=t.ndimArray)?e:0;return(t,e,i)=>{if(null==t)return t;t=s(t,i,n);let r=n,o=t;for(;r>0&&Array.isArray(o);)r--,o=o[0];if(void 0!==o)for(let e=0;e<r;e++)t=[t];return t}}(t);if(1===i)return sr(t);if("type"in t&&nr(t.type)){var s,n;const e=null==(s=t.type.prototype)||null==(n=s.itemType)?void 0:n.Type,i=sr("function"==typeof e?{type:e}:{types:e});return(e,s,n)=>{const r=i(e,s,n);return r?new t.type(r):r}}return er(t)}function er(t){return"type"in t?function(t){return t.prototype.read?(e,i,s)=>{if(null==e)return e;const n=typeof e;if("object"!==n)return void Yn.error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${n}'`);const r=new t;return r.read(e,s),r}:t.fromJSON}(t.type):function(t){var e;let i=null;const s=null!=(e=t.errorContext)?e:"type";return(e,n,r)=>{if(null==e)return e;const o=typeof e;if("object"!==o)return void Yn.error(`Expected JSON value of type 'object' to deserialize, but got '${o}'`);i||(i=function(t){const e={};for(const n in t.typeMap){var i,s;const r=t.typeMap[n],o=Bi(r.prototype);if("function"==typeof t.key)continue;const a=o.properties[t.key];if(!a)continue;null!=(i=a.json)&&i.type&&Array.isArray(a.json.type)&&1===a.json.type.length&&"string"==typeof a.json.type[0]&&(e[a.json.type[0]]=r);const l=null==(s=a.json)?void 0:s.write;if(!l||!l.writer){e[n]=r;continue}const u=l.target,c="string"==typeof u?u:t.key,h={};l.writer(n,h,c),h[c]&&(e[h[c]]=r)}return e}(t));const a=t.key;if("string"!=typeof a)return;const l=e[a],u=l?i[l]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!u){const t=`Type '${l||"unknown"}' is not supported`;return r&&r.messages&&e&&r.messages.push(new Qn(s+":unsupported",t,{definition:e,context:r})),void Yn.error(t)}const c=new u;return c.read(e,r),c}}(t.types)}function ir(t,e,i,s){return 0!==s&&Array.isArray(e)?e.map((e=>ir(t,e,i,s-1))):t(e,void 0,i)}function sr(t){const e=er(t);return(t,i,s)=>{if(null==t)return t;if(Array.isArray(t)){const i=[];for(const n of t){const t=e(n,void 0,s);void 0!==t&&i.push(t)}return i}const n=e(t,void 0,s);return void 0!==n?[n]:void 0}}function nr(t){if(!Kn(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&("function"==typeof e.Type?rr(e.Type):or(e.Type))}function rr(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||nr(t))}function or(t){for(const e in t.typeMap)if(!rr(t.typeMap[e]))return!1;return!0}function ar(t){t.name&&(t.read&&"object"==typeof t.read?void 0===t.read.source&&(t.read.source=t.name):t.read={source:t.name},t.write&&"object"==typeof t.write?void 0===t.write.target&&(t.write.target=t.name):t.write={target:t.name})}function lr(t){"boolean"==typeof t.read?t.read={enabled:t.read}:"function"==typeof t.read?t.read={enabled:!0,reader:t.read}:t.read&&"object"==typeof t.read&&void 0===t.read.enabled&&(t.read.enabled=!0)}function ur(t){"boolean"==typeof t.write?t.write={enabled:t.write}:"function"==typeof t.write?t.write={enabled:!0,writer:t.write}:t.write&&"object"==typeof t.write&&void 0===t.write.enabled&&(t.write.enabled=!0)}const cr=ct.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer");function hr(t,e){var i;if(!e.write||e.write.writer||!1===e.write.enabled&&!e.write.overridePolicy)return;const s=null!=(i=null==t?void 0:t.ndimArray)?i:0;e.write.writer=t&&(1===s||"type"in t&&Kn(t.type))?mr:s>1?function(t){return function(e,i,s,n){let r;if(null===e)r=null;else{r=gr(e,n,t);let i=t,s=r;for(;i>0&&Array.isArray(s);)i--,s=s[0];if(void 0!==s)for(let t=0;t<i;t++)r=[r]}K(s,r,i)}}(s):e.types?Array.isArray(e.types)?function(t){return(e,i,s,n)=>fr(e&&Array.isArray(e)?e.filter((e=>dr(e,t,n))):e,i,s,n)}(e.types[0]):function(t){return(e,i,s,n)=>e?dr(e,t,n)?fr(e,i,s,n):void 0:fr(e,i,s,n)}(e.types):fr}function dr(t,e,i){for(const i in e.typeMap)if(t instanceof e.typeMap[i])return!0;if(null!=i&&i.messages){var s,n;const r=null!=(s=e.errorContext)?s:"type",o=`Values of type '${null!=(n="function"!=typeof e.key?t[e.key]:t.declaredClass)?n:"Unknown"}' cannot be written`;i&&i.messages&&t&&i.messages.push(new dt(r+":unsupported",o,{definition:t,context:i})),cr.error(o)}return!1}function fr(t,e,i,s){K(i,pr(t,s),e)}function pr(t,e){return t&&"function"==typeof t.write?t.write({},e):t&&"function"==typeof t.toJSON?t.toJSON():"number"==typeof t?yr(t):t}function yr(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function mr(t,e,i,s){let n;null===t?n=null:t&&"function"==typeof t.map?(n=t.map((t=>pr(t,s))),"function"==typeof n.toArray&&(n=n.toArray())):n=[pr(t,s)],K(i,n,e)}function gr(t,e,i){return 0!==i&&Array.isArray(t)?t.map((t=>gr(t,e,i-1))):pr(t,e)}function vr(t,e){return br(t,"read",e)}function wr(t,e){return br(t,"write",e)}function br(t,e,i){let s=t&&t.json;if(t&&t.json&&t.json.origins&&i){const n=t.json.origins[i.origin];n&&("any"===e||e in n)&&(s=n)}return s}function Mr(t){return t.type?Sr(t):xr(t)}function Sr(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!Vn(i);)i=i[0],e++;return{type:i,ndimArray:e}}function xr(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}function kr(t){(function(t){if(t.json||(t.json={}),lr(t.json),ur(t.json),ar(t.json),t.json.origins)for(const e in t.json.origins)lr(t.json.origins[e]),ur(t.json.origins[e]),ar(t.json.origins[e]);return!0})(t)&&(function(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const t in i)if(e[t]){const s=e[t];i[t].forEach((t=>{e[t]=s})),delete e[t]}}}(t),function(t){const e=function(t){return t.json.types?xr(t.json):t.type?Sr(t):xr(t)}(t);if(t.json.origins)for(const i in t.json.origins){const s=t.json.origins[i],n=s.types?Mr(s):e;Xn(n,s,!1),s.types&&!s.write&&t.json.write&&t.json.write.enabled&&(s.write={...t.json.write}),hr(n,s)}Xn(e,t.json,!0),hr(e,t.json)}(t))}const Ir=new Set,jr=new Set;function _r(t){return e=>{e.prototype.declaredClass=t,function(t){const e=Bi(t.prototype).properties,i={};for(const t of Object.getOwnPropertyNames(e)){const s=e[t];kr(s),i[t]={enumerable:!0,configurable:!0,get:Tr(t,s),set(e){const i=this.__accessor__;if(void 0!==i){if(!Object.isFrozen(this)){if(i.initialized&&s.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${t}' of ${this.declaredClass}`);if(2===i.lifecycle&&s.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${t}' of ${this.declaredClass}`);i.set(t,e)}}else Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}}}Object.defineProperties(t.prototype,i)}(e);const i=[],s=[];let n=e.prototype;for(;n;)n.hasOwnProperty("initialize")&&!Ir.has(n.initialize)&&(Ir.add(n.initialize),i.push(n.initialize)),n.hasOwnProperty("destroy")&&!jr.has(n.destroy)&&(jr.add(n.destroy),s.push(n.destroy)),n=Object.getPrototypeOf(n);Ir.clear(),jr.clear();class r extends e{constructor(...t){if(super(...t),this.constructor===r&&"function"==typeof this.postscript){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let t=i.length-1;t>=0;t--)i[t].call(this)}}),s.length){let t=!1;Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!t){t=!0;for(let t=0;t<s.length;t++)s[t].call(this)}}})}this.postscript(...t)}}}return r.__accessorMetadata__=Bi(e.prototype),r.prototype.declaredClass=t,r}}function Tr(t,e){return null==e.get?function(){const e=this.__accessor__.properties.get(t);if(void 0===e)return;Xi(e);const i=this.__accessor__.store;return i.has(t)?i.get(t):e.metadata.value}:function(){const e=this.__accessor__.properties.get(t);if(void 0!==e)return e.getComputed()}}function Or(t){if(null==t)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor&&t.constructor.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}class Ar{constructor(...t){if(this.constructor===Ar)throw Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");Object.defineProperty(this,"__accessor__",{enumerable:!1,value:new ws(this)}),t.length>0&&this.normalizeCtorArgs&&(this.__accessor__.ctorArgs=this.normalizeCtorArgs.apply(this,t))}static createSubclass(t={}){if(Array.isArray(t))throw Error("Multi-inheritance unsupported since 4.16");const{properties:e,declaredClass:i,constructor:s}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const n=this;class r extends n{constructor(...t){super(...t),this.inherited=null,s&&s.apply(this,t)}}Bi(r.prototype);for(const e in t){const i=t[e];r.prototype[e]="function"==typeof i?function(...t){const s=this.inherited;let r;this.inherited=function(...t){if(n.prototype[e])return n.prototype[e].apply(this,t)};try{r=i.apply(this,t)}catch(t){throw this.inherited=s,t}return this.inherited=s,r}:t[e]}for(const t in e)Hn(Or(e[t]))(r.prototype,t);return _r(i)(r)}postscript(t){const e=this.__accessor__,i=e.ctorArgs||t;e.initialize(),i&&(this.set(i),e.ctorArgs=null),e.constructed(),this.initialize()}initialize(){}destroy(){this.destroyed||(function(t){for(const e of hn.values())e.target===t&&(e.removed=!0)}(this),this.__accessor__.destroy())}get initialized(){return this.__accessor__&&this.__accessor__.initialized||!1}get constructed(){return this.__accessor__&&2===this.__accessor__.lifecycle||!1}get destroyed(){return this.__accessor__&&this.__accessor__.destroyed||!1}commitProperty(t){this.get(t)}get(t){return Gi(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}isInstanceOf(t){return _i(ct.getLogger(this.declaredClass),"isInstanceOf",{replacement:"Use instanceof directly",version:"4.16"}),this instanceof t}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,e){return Ms(this,t,e),this}watch(t,e,i){return function(t,e,i,s=!1){return!t.__accessor__||t.__accessor__.destroyed?{remove(){}}:s?function(t,e,i){const s=Ni(t,e,i,((t,e,i)=>{let n=!1;return nn((()=>zi(t,e)),((r,o)=>{t.__accessor__.destroyed?s.remove():n||(n=!0,J(o,r)||i.call(t,r,o,e,t),n=!1)}))}));return s}(t,e,i):function(t,e,i){let s=Ni(t,e,i,((t,e,i)=>{let n,r,o=rn((()=>zi(t,e)),((o,a)=>{t.__accessor__.destroyed||n&&n.uid!==r?s.remove():(n||(n=un.acquireUntracked(o,i,a,t,e),r=n.uid),fn(n))}));return{remove:Di((()=>{o.remove(),n&&(n.uid!==r||n.removed||(n.removed=!0,fn(n)),n=null),s=o=null}))}}));return s}(t,e,i)}(this,t,e,i)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_override(t,e){return this.__accessor__.override(t,e)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.notifyChange(t)}_get(t){return this.__accessor__.internalGet(t)}_set(t,e){return this.__accessor__.internalSet(t,e),this}}class Fr{constructor(){this._emitter=new Fr.EventEmitter(this)}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}}!function(t){class i{constructor(t=null){this.target=t,this._listenersMap=null}clear(){this._listenersMap&&this._listenersMap.clear(),this._listenersMap=null}emit(t,e){const i=this._listenersMap&&this._listenersMap.get(t);if(!i)return!1;const s=this.target||this;return[...i].forEach((t=>{t.call(s,e)})),i.length>0}on(t,e){if(Array.isArray(t))return Ai(t.map((t=>this.on(t,e))));if(t.indexOf(",")>-1)throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const i=this._listenersMap.get(t)||[];return i.push(e),this._listenersMap.set(t,i),{remove:()=>{const i=this._listenersMap&&this._listenersMap.get(t)||[],s=i.indexOf(e);s>=0&&i.splice(s,1)}}}once(t,e){const i=this.on(t,(t=>{i.remove(),e.call(null,t)}));return i}hasEventListener(t){const e=this._listenersMap&&this._listenersMap.get(t);return null!=e&&e.length>0}}t.EventEmitter=i,t.EventedMixin=t=>{let s=class extends t{constructor(){super(...arguments),this._emitter=new i}destroy(){this._emitter.clear()}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};return s=e([_r("esri.core.Evented")],s),s};let s=class extends Ar{constructor(){super(...arguments),this._emitter=new Fr.EventEmitter(this)}destroy(){this._emitter.clear()}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};s=e([_r("esri.core.Evented")],s),t.EventedAccessor=s}(Fr||(Fr={}));const Cr=Fr;function Pr(t){return(e,i)=>{e[i]=t}}class Er{constructor(){this._observers=[]}observe(t){return this._observers.includes(t)||this._observers.push(t),new cs(this._observers,t)}notify(){const t=this._observers.slice();for(let e=0;e<t.length;++e){const i=t[e];i.onInvalidated(),i.onCommitted()}}}var Lr;const Rr=new Zi(class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(t){this.defaultPrevented=!1,this.item=t}},void 0,(t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1})),Nr=()=>{};function Dr(t){return t?t instanceof Hr?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function Vr(t){if(t&&t.length)return t[0]}function $r(t,e,i,s){const n=Math.min(t.length-i,e.length-s);let r=0;for(;r<n&&t[i+r]===e[s+r];)r++;return r}function zr(t,e,i,s){e&&e.forEach(((e,n,r)=>{t.push(e),zr(t,i.call(s,e,n,r),i,s)}))}const Gr=new Set,Ur=new Set,qr=new Set,Br=new Map;let Wr=0,Hr=Lr=class extends Cr.EventedAccessor{constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._timer=null,this._observable=new Er,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:Wr++})}static isCollection(t){return null!=t&&t instanceof Lr}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof Lr?{items:t}:t:{}}destroy(){this.removeAll()}*[Symbol.iterator](){yield*this.items}get items(){return Xi(this._observable),this._items}set items(t){this._emitBeforeChanges(1)||(this._splice(0,this.length,...Dr(t)),this._emitAfterChanges(1))}hasEventListener(t){return"change"===t?this._chgListeners.length>0:this._emitter.hasEventListener(t)}on(t,e){if("change"===t){const t=this._chgListeners,i={removed:!1,callback:e};return t.push(i),this._notifications&&this._notifications.push({listeners:t.slice(),items:this._items.slice(),changes:[]}),{remove(){this.remove=Nr,i.removed=!0,t.splice(t.indexOf(i),1)}}}return this._emitter.on(t,e)}once(t,e){const i=this.on(t,e);return{remove(){i.remove()}}}add(t,e){if(Xi(this._observable),this._emitBeforeChanges(1))return this;const i=this.getNextIndex(null!=e?e:null);return this._splice(i,0,t),this._emitAfterChanges(1),this}addMany(t,e=this._items.length){if(Xi(this._observable),!t||!t.length)return this;if(this._emitBeforeChanges(1))return this;const i=this.getNextIndex(e);return this._splice(i,0,...Dr(t)),this._emitAfterChanges(1),this}removeAll(){if(Xi(this._observable),!this.length||this._emitBeforeChanges(2))return[];const t=this._splice(0,this.length)||[];return this._emitAfterChanges(2),t}clone(){return Xi(this._observable),this._createNewInstance({items:this._items.map(H)})}concat(...t){Xi(this._observable);const e=t.map(Dr);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(Xi(this._observable),!this.length||this._emitBeforeChanges(2))return;const i=this._splice(0,this.length),s=i.length;for(let n=0;n<s;n++)t.call(e,i[n],n,i);this._emitAfterChanges(2)}every(t,e){return Xi(this._observable),this._items.every(t,e)}filter(t,e){let i;return Xi(this._observable),i=2===arguments.length?this._items.filter(t,e):this._items.filter(t),this._createNewInstance({items:i})}find(t,e){return Xi(this._observable),this._items.find(t,e)}findIndex(t,e){return Xi(this._observable),this._items.findIndex(t,e)}flatten(t,e){Xi(this._observable);const i=[];return zr(i,this,t,e),new Lr(i)}forEach(t,e){return Xi(this._observable),this._items.forEach(t,e)}getItemAt(t){return Xi(this._observable),this._items[t]}getNextIndex(t){Xi(this._observable);const e=this.length;return(t=null==t?e:t)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return Xi(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return Xi(this._observable),this._items.indexOf(t,e)}join(t=","){return Xi(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return Xi(this._observable),this._items.lastIndexOf(t,e)}map(t,e){Xi(this._observable);const i=this._items.map(t,e);return new Lr({items:i})}reorder(t,e=this.length-1){Xi(this._observable);const i=this.indexOf(t);if(-1!==i){if(e<0?e=0:e>=this.length&&(e=this.length-1),i!==e){if(this._emitBeforeChanges(4))return t;this._splice(i,1),this._splice(e,0,t),this._emitAfterChanges(4)}return t}}pop(){if(Xi(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Vr(this._splice(this.length-1,1));return this._emitAfterChanges(2),t}push(...t){return Xi(this._observable),this._emitBeforeChanges(1)||(this._splice(this.length,0,...t),this._emitAfterChanges(1)),this.length}reduce(t,e){Xi(this._observable);const i=this._items;return 2===arguments.length?i.reduce(t,e):i.reduce(t)}reduceRight(t,e){Xi(this._observable);const i=this._items;return 2===arguments.length?i.reduceRight(t,e):i.reduceRight(t)}remove(t){return Xi(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(Xi(this._observable),t<0||t>=this.length||this._emitBeforeChanges(2))return;const e=Vr(this._splice(t,1));return this._emitAfterChanges(2),e}removeMany(t){if(Xi(this._observable),!t||!t.length||this._emitBeforeChanges(2))return[];const e=t instanceof Lr?t.toArray():t,i=this._items,s=[],n=e.length;for(let t=0;t<n;t++){const n=i.indexOf(e[t]);if(n>-1){const r=1+$r(e,i,t+1,n+1),o=this._splice(n,r);o&&o.length>0&&s.push.apply(s,o),t+=r-1}}return this._emitAfterChanges(2),s}reverse(){if(Xi(this._observable),this._emitBeforeChanges(4))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,...t)),this._emitAfterChanges(4),this}shift(){if(Xi(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Vr(this._splice(0,1));return this._emitAfterChanges(2),t}slice(t=0,e=this.length){return Xi(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return Xi(this._observable),this._items.some(t,e)}sort(t){if(Xi(this._observable),!this.length||this._emitBeforeChanges(4))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,...e),this._emitAfterChanges(4),this}splice(t,e,...i){Xi(this._observable);const s=(e?2:0)|(i.length?1:0);if(this._emitBeforeChanges(s))return[];const n=this._splice(t,e,...i)||[];return this._emitAfterChanges(s),n}toArray(){return Xi(this._observable),this._items.slice()}toJSON(){return Xi(this._observable),this.toArray()}toLocaleString(){return Xi(this._observable),this._items.toLocaleString()}toString(){return Xi(this._observable),""+this._items}unshift(...t){return Xi(this._observable),!t.length||this._emitBeforeChanges(1)||(this._splice(0,0,...t),this._emitAfterChanges(1)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,...i){const s=this._items,n=this.itemType;let r,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=Gs((()=>this._dispatchChange()))),e){if(o=s.splice(t,e),this.hasEventListener("before-remove")){const e=Rr.acquire();e.target=this,e.cancellable=!0;for(let i=0,n=o.length;i<n;i++)r=o[i],e.reset(r),this.emit("before-remove",e),e.defaultPrevented&&(o.splice(i,1),s.splice(t,0,r),t+=1,i-=1,n-=1);Rr.release(e)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const t=Rr.acquire();t.target=this,t.cancellable=!1;const e=o.length;for(let i=0;i<e;i++)t.reset(o[i]),this.emit("after-remove",t);Rr.release(t)}}if(i&&i.length){if(n){const t=[];for(const e of i){const i=n.ensureType(e);null==i&&null!=e||t.push(i)}i=t}const e=this.hasEventListener("before-add"),r=this.hasEventListener("after-add"),o=t===this.length;if(e||r){const n=Rr.acquire();n.target=this,n.cancellable=!0;const a=Rr.acquire();a.target=this,a.cancellable=!1;for(const l of i)e?(n.reset(l),this.emit("before-add",n),n.defaultPrevented||(o?s.push(l):s.splice(t++,0,l),this._set("length",s.length),r&&(a.reset(l),this.emit("after-add",a)))):(o?s.push(l):s.splice(t++,0,l),this._set("length",s.length),a.reset(l),this.emit("after-add",a));Rr.release(a),Rr.release(n)}else{if(o)for(const t of i)s.push(t);else s.splice(t,0,...i);this._set("length",s.length)}}return(i&&i.length||o&&o.length)&&this._notifyChangeEvent(i,o),o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const i=Rr.acquire();i.target=this,i.cancellable=!0,i.type=t,this.emit("before-changes",i),e=i.defaultPrevented,Rr.release(i)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Rr.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Rr.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const t=e.changes;Gr.clear(),Ur.clear(),qr.clear();for(const{added:e,removed:i}of t){if(e)if(0===qr.size&&0===Ur.size)for(const t of e)Gr.add(t);else for(const t of e)Ur.has(t)?(qr.add(t),Ur.delete(t)):qr.has(t)||Gr.add(t);if(i)if(0===qr.size&&0===Gr.size)for(const t of i)Ur.add(t);else for(const t of i)Gr.has(t)?Gr.delete(t):(qr.delete(t),Ur.add(t))}const i=xs.acquire();Gr.forEach((t=>{i.push(t)}));const s=xs.acquire();Ur.forEach((t=>{s.push(t)}));const n=this._items,r=e.items,o=xs.acquire();if(qr.forEach((t=>{r.indexOf(t)!==n.indexOf(t)&&o.push(t)})),e.listeners&&(i.length||s.length||o.length)){const t={target:this,added:i,removed:s,moved:o},n=e.listeners.length;for(let i=0;i<n;i++){const s=e.listeners[i];s.removed||s.callback.call(this,t)}}xs.release(i),xs.release(s),xs.release(o)}Gr.clear(),Ur.clear(),qr.clear()}};Hr.ofType=t=>{if(!t)return Lr;if(Br.has(t))return Br.get(t);let i=null;if("function"==typeof t)i=t.prototype.declaredClass;else if(t.base)i=t.base.prototype.declaredClass;else for(const e in t.typeMap){const s=t.typeMap[e].prototype.declaredClass;i?i+=" | "+s:i=s}let s=class extends Lr{};return e([Pr({Type:t,ensureType:"function"==typeof t?Ln(t):zn(t)})],s.prototype,"itemType",void 0),s=e([_r(`esri.core.Collection<${i}>`)],s),Br.set(t,s),s},e([Hn()],Hr.prototype,"length",void 0),e([Hn()],Hr.prototype,"items",null),Hr=Lr=e([_r("esri.core.Collection")],Hr);const Jr=Hr;let Zr=class extends Ar{constructor(t){super(t),this._groups=new Map}destroy(){this.removeAll()}get size(){let t=0;return this._groups.forEach((e=>{t+=e.length})),t}add(t,e){if(!this._isHandle(t)&&!Array.isArray(t)&&!Jr.isCollection(t))return this;const i=this._getOrCreateGroup(e);return Array.isArray(t)||Jr.isCollection(t)?t.forEach((t=>this._isHandle(t)&&i.push(t))):i.push(t),this.notifyChange("size"),this}forEach(t,e){if("function"==typeof t)this._groups.forEach((e=>e.forEach(t)));else{const i=this._getGroup(t);i&&e&&i.forEach(e)}}has(t){return this._groups.has(this._ensureGroupKey(t))}remove(t){if(Array.isArray(t)||Jr.isCollection(t))return t.forEach(this.remove,this),this;if(!this.has(t))return this;const e=this._getGroup(t);for(let t=0;t<e.length;t++)e[t].remove();return this._deleteGroup(t),this.notifyChange("size"),this}removeAll(){return this._groups.forEach((t=>{for(let e=0;e<t.length;e++)t[e].remove()})),this._groups.clear(),this.notifyChange("size"),this}_isHandle(t){return t&&!!t.remove}_getOrCreateGroup(t){if(this.has(t))return this._getGroup(t);const e=[];return this._groups.set(this._ensureGroupKey(t),e),e}_getGroup(t){return this._groups.get(this._ensureGroupKey(t))}_deleteGroup(t){return this._groups.delete(this._ensureGroupKey(t))}_ensureGroupKey(t){return t||"_default_"}};e([Hn({readOnly:!0})],Zr.prototype,"size",null),Zr=e([_r("esri.core.Handles")],Zr);const Qr=Zr,Kr=/\?(\.|$)/g;function Yr(t,e,i,s){const n=Array.isArray(e)?e:e.indexOf(",")>-1?e.split(","):[e],r=Xr(t,e,i,s);for(const e of n){const s=e.trim().replace(Kr,"$1"),n=t.get(s);i.call(t,n,n,s,t)}return r}function Xr(t,e,i,s){return t.watch(e,i,s)}function to(t,e,i,s){return co(t,e,fo,i,s)}function eo(t,e,i,s){return ho(t,e,fo,i,s)}function io(t,e,i,s){return co(t,e,po,i,s)}function so(t,e,i,s){return ho(t,e,po,i,s)}function no(t,e,i,s){return co(t,e,yo,i,s)}function ro(t,e,i,s){return ho(t,e,yo,i,s)}function oo(t,e,i,s){return co(t,e,mo,i,s)}function ao(t,e,i,s){return ho(t,e,mo,i,s)}function lo(t,e,i,s){let n=!1;const r=t.watch(e,((e,s,r,o)=>{n||i.call(t,e,s,r,o)}),s);return{remove(){r.remove()},pause(){n=!0},resume(){n=!1}}}function uo(t,e,i,s,n,r,o){const a={};function l(e){const s=a[e];s&&(r&&r(s.target,e,t,i),s.handle.remove(),delete a[e])}const u=Yr(t,e,((e,r,o)=>{l(o),Ie(e)&&(a[o]={handle:je(e,i,s),target:e},n&&n(e,o,t,i))}),o);return{remove(){u.remove();for(const t in a)l(t)}}}function co(t,e,i,s,n){const r=t.watch(e,((e,n,r,o)=>{i&&!i(e)||null==s||s.call(t,e,n,r,o)}),n);if(Array.isArray(e))for(const n of e){const r=t.get(n);i&&i(r)&&(null==s||s.call(t,r,r,e,t))}else{const n=t.get(e);i&&i(n)&&(null==s||s.call(t,n,n,e,t))}return r}function ho(t,e,i,s,n){const r="function"==typeof s?s:null,o="object"==typeof s?s:null;"boolean"==typeof s&&(n=s);let a,l=!1;function u(){a&&(a.remove(),a=null)}const c=qe();Ve(o,(()=>{u(),c.reject(Pe())}));const h={then:c.promise.then.bind(c.promise),catch:c.promise.catch.bind(c.promise),remove:u};return Object.freeze(h),a=co(t,e,i,((e,i,s,n)=>{l=!0,u(),r&&r.call(t,e,i,s,n),c.resolve({value:e,oldValue:i,propertyName:s,target:n})}),n),l&&u(),h}function fo(t){return!!t}function po(t){return!t}function yo(t){return!0===t}function mo(t){return!1===t}function go(t,e){return Hn({aliasOf:e?{...e,source:t}:t})}class vo{constructor(t,e={ignoreUnknown:!1}){this.jsonToAPI=t,this.options=e,this.apiValues=[],this.jsonValues=[],this.apiToJSON=this.invertMap(t),this.apiValues=this.getKeysSorted(this.apiToJSON),this.jsonValues=this.getKeysSorted(this.jsonToAPI),this.read=t=>this.fromJSON(t),this.write=(t,e,i)=>{const s=this.toJSON(t);void 0!==s&&K(i,s,e)},this.write.isJSONMapWriter=!0}toJSON(t){return this.apiToJSON.hasOwnProperty(t)?this.apiToJSON[t]:this.options.ignoreUnknown?void 0:t}fromJSON(t){return this.jsonToAPI.hasOwnProperty(t)?this.jsonToAPI[t]:this.options.ignoreUnknown?void 0:t}invertMap(t){const e={};for(const i in t)e[t[i]]=i;return e}getKeysSorted(t){const e=[];for(const i in t)e.push(i);return e.sort(),e}}function wo(){return function(t){return new vo(t,{ignoreUnknown:!0})}}var bo,Mo,So;let xo;const ko=null!=(bo=null==(Mo=i.esriConfig)?void 0:Mo.locale)?bo:null==(So=i.dojoConfig)?void 0:So.locale;function Io(){var t,e;return null!=(t=null!=ko?ko:null==(e=i.navigator)?void 0:e.language)?t:"en"}function jo(){return void 0===xo&&(xo=Io()),xo}const _o=[];function To(t){return _o.push(t),{remove(){_o.splice(_o.indexOf(t),1)}}}const Oo=[];function Ao(t){return Oo.push(t),{remove(){_o.splice(Oo.indexOf(t),1)}}}null==i.addEventListener||i.addEventListener("languagechange",(function(){const t=Io();xo!==t&&(xo=t,[...Oo].forEach((e=>{e.call(null,t)})),[..._o].forEach((e=>{e.call(null,t)})))}));const Fo={year:"numeric",month:"numeric",day:"numeric"},Co={year:"numeric",month:"long",day:"numeric"},Po={year:"numeric",month:"short",day:"numeric"},Eo={year:"numeric",month:"long",weekday:"long",day:"numeric"},Lo={hour:"numeric",minute:"numeric"},Ro={...Lo,second:"numeric"},No={"short-date":Fo,"short-date-short-time":{...Fo,...Lo},"short-date-short-time-24":{...Fo,...Lo,hour12:!1},"short-date-long-time":{...Fo,...Ro},"short-date-long-time-24":{...Fo,...Ro,hour12:!1},"short-date-le":Fo,"short-date-le-short-time":{...Fo,...Lo},"short-date-le-short-time-24":{...Fo,...Lo,hour12:!1},"short-date-le-long-time":{...Fo,...Ro},"short-date-le-long-time-24":{...Fo,...Ro,hour12:!1},"long-month-day-year":Co,"long-month-day-year-short-time":{...Co,...Lo},"long-month-day-year-short-time-24":{...Co,...Lo,hour12:!1},"long-month-day-year-long-time":{...Co,...Ro},"long-month-day-year-long-time-24":{...Co,...Ro,hour12:!1},"day-short-month-year":Po,"day-short-month-year-short-time":{...Po,...Lo},"day-short-month-year-short-time-24":{...Po,...Lo,hour12:!1},"day-short-month-year-long-time":{...Po,...Ro},"day-short-month-year-long-time-24":{...Po,...Ro,hour12:!1},"long-date":Eo,"long-date-short-time":{...Eo,...Lo},"long-date-short-time-24":{...Eo,...Lo,hour12:!1},"long-date-long-time":{...Eo,...Ro},"long-date-long-time-24":{...Eo,...Ro,hour12:!1},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Lo,"long-time":Ro},Do=wo()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});Do.toJSON.bind(Do),Do.fromJSON.bind(Do);const Vo={ar:"ar-u-nu-latn-ca-gregory"};let $o=new WeakMap,zo=No["short-date-short-time"];function Go(t){const e=t||zo;if(!$o.has(e)){const t=jo(),i=Vo[jo()]||t;$o.set(e,new Intl.DateTimeFormat(i,e))}return $o.get(e)}function Uo(t){return No[t]||null}function qo(t,e){return Go(e).format(t)}Ao((()=>{$o=new WeakMap,zo=No["short-date-short-time"]}));const Bo={ar:"ar-u-nu-latn"};let Wo=new WeakMap,Ho={};function Jo(t={}){const e={};return null!=t.digitSeparator&&(e.useGrouping=t.digitSeparator),null!=t.places&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function Zo(t,e){return function(t){const e=t||Ho;if(!Wo.has(e)){const i=jo(),s=Bo[jo()]||i;Wo.set(e,new Intl.NumberFormat(s,t))}return Wo.get(e)}(e).format(t)}Ao((()=>{Wo=new WeakMap,Ho={}}));const Qo=ct.getLogger("esri.intl");function Ko(t,e,i={}){const{format:s={}}=i;return rt(t,(t=>function(t,e,i){let s,n;const r=t.indexOf(":");if(-1===r?s=t.trim():(s=t.slice(0,r).trim(),n=t.slice(r+1).trim()),!s)return"";const o=Q(s,e);if(null==o)return"";const a=i[n]||i[s];return a?function(t,e){switch(e.type){case"date":return qo(t,e.intlOptions);case"number":return Zo(t,e.intlOptions);default:return Qo.warn("missing format descriptor for key {key}"),Yo(t)}}(o,a):n?function(t,e){switch(e.toLowerCase()){case"dateformat":return qo(t);case"numberformat":return Zo(t);default:return Qo.warn("inline format is unsupported since 4.12: "+e),/^(dateformat|datestring)/i.test(e)?qo(t):/^numberformat/i.test(e)?Zo(t):Yo(t)}}(o,n):Yo(o)}(t,e,s)))}function Yo(t){switch(typeof t){case"string":return t;case"number":return Zo(t);case"boolean":return""+t;default:return t instanceof Date?qo(t):""}}const Xo=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,ta={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function ea(t){var e;return null!=(e=ta[t])&&e}const ia=[],sa=new Map;async function na(t){const e=jo();sa.has(t)||sa.set(t,async function(t,e){const i=[];for(const s of ia)if(ra(s.pattern,t))try{return await s.fetchMessageBundle(t,e)}catch(t){i.push(t)}if(i.length)throw new dt("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i});throw new dt("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}(t,e));const i=sa.get(t);return await oa.add(i),i}function ra(t,e){return"string"==typeof t?e.startsWith(t):t.test(e)}Ao((()=>{sa.clear()}));const oa=new class{constructor(){this._numLoading=0}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then((()=>this._decrease()),(()=>this._decrease())),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=qe())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)}};async function aa(t){if(u(ua.fetchBundleAsset))return ua.fetchBundleAsset(t);const e=await oi(t,{responseType:"text"});return JSON.parse(e.data)}class la{constructor({base:t="",pattern:e,location:s=new URL(window.location.href)}){let n;n="string"==typeof s?t=>new URL(t,new URL(s,i.location)).href:s instanceof URL?t=>new URL(t,s).href:s,this.pattern="string"==typeof e?RegExp("^"+e):e,this.getAssetUrl=n,t=t?t.endsWith("/")?t:t+"/":"",this.matcher=RegExp(`^${t}(?:(.*)/)?(.*)$`)}fetchMessageBundle(t,e){return async function(t,e,i,s){const n=e.exec(i);if(!n)throw new dt("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const r=n[1]?n[1]+"/":"",o=n[2],a=function(t){if(!Xo.test(t))return null;const[,e,i]=Xo.exec(t),s=e+(i?"-"+i.toUpperCase():"");return ea(s)?s:ea(e)?e:null}(s),l=`${r}${o}.json`,u=a?`${r}${o}_${a}.json`:l;let c;try{c=await aa(t(u))}catch(e){if(u===l)throw new dt("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:e});try{c=await aa(t(l))}catch(t){throw new dt("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:t})}}return c}(this.getAssetUrl,this.matcher,t,e)}}const ua={};function ca(t){return"string"==typeof t?document.getElementById(t):t}function ha(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)}function da(t,e){const i=e.parentNode;i&&i.insertBefore(t,e)}function fa(t,e){for(;;){const i=t.firstChild;if(!i)break;e.appendChild(i)}}function pa(t){t.parentNode&&t.parentNode.removeChild(t)}!function(t){ia.includes(t)||(function(t){for(const e of sa.keys())ra(t.pattern,e)&&sa.delete(e)}(t),ia.unshift(t))}(new la({pattern:"esri/",location:Ii}));class ya{constructor(t){this.instance=t,this._resolver=qe(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=1,this._cleanUp()}),(()=>{this._status=2,this._cleanUp()}))}addResolvingPromise(t){this._resolvingPromises.push(t),this._tryResolve()}isResolved(){return 1===this._status}isRejected(){return 2===this._status}isFulfilled(){return 0!==this._status}abort(){this._resolver.reject(Pe())}when(t,e){return this._resolver.promise.then(t,e)}_cleanUp(){this._allPromise=this._resolvingPromises=this._allPromise=null}_tryResolve(){if(this.isFulfilled())return;const t=qe(),e=[...this._resolvingPromises,t.promise],i=this._allPromise=Promise.all(e);i.then((()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve(this.instance)}),(t=>{this.isFulfilled()||this._allPromise!==i||Ge(t)||this._resolver.reject(t)})),t.resolve()}}const ma=t=>{let i=class extends t{constructor(...t){super(...t),this._promiseProps=new ya(this),this.addResolvingPromise(Promise.resolve())}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(t,e){return new Promise(((t,e)=>{this._promiseProps.when(t,e)})).then(t,e)}catch(t){return this.when(null,t)}addResolvingPromise(t){t&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in t?t.when():t)}};return i=e([_r("esri.core.Promise")],i),i};let ga=class extends(ma(Ar)){};function va(){const t=wa.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=e=>t[e].toString(16);return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}ga=e([_r("esri.core.Promise")],ga);const wa=i.crypto||i.msCrypto,ba=Object.prototype.toString;function Ma(t){const e="__accessorMetadata__"in t?Ln(t):t;return function(...t){if(t.push(e),"number"==typeof t[2])throw Error("Using @cast has parameter decorator is not supported since 4.16");return Sa.apply(this,t)}}function Sa(t,e,i,s){Wi(t,e).cast=s}function xa(...t){if(3!==t.length||"string"!=typeof t[1])return 1===t.length&&"[object Function]"===ba.call(t[0])?Ma(t[0]):1===t.length&&"string"==typeof t[0]?function(t){return function(e,i){Wi(e,t).cast=e[i]}}(t[0]):void 0}
/*!
 * @esri/arcgis-html-sanitizer - v2.9.0-next.1 - Tue Oct 19 2021 10:19:42 GMT-0400 (Eastern Daylight Time)
 * Copyright (c) 2021 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2017 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 * 
 * Lodash/isPlainObject
 * Copyright (c) JS Foundation and other contributors <https://js.foundation/>
 * MIT License, see https://raw.githubusercontent.com/lodash/lodash/4.17.10-npm/LICENSE for details
 */var ka=Object.prototype,Ia=Function.prototype.toString,ja=ka.hasOwnProperty,_a=Ia.call(Object),Ta=ka.toString,Oa=function(t,e){return function(i){return t(e(i))}}(Object.getPrototypeOf,Object),Aa={exports:{}},Fa={},Ca={exports:{}},Pa={};function Ea(){return{"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1}}var La=/javascript\s*\:/gim;Pa.whiteList={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1},Pa.getDefaultWhiteList=Ea,Pa.onAttr=function(){},Pa.onIgnoreAttr=function(){},Pa.safeAttrValue=function(t,e){return La.test(e)?"":e};var Ra=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},Na=function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")},Da=Pa;function Va(t){return null==t}function $a(t){(t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{})).whiteList=t.whiteList||Da.whiteList,t.onAttr=t.onAttr||Da.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||Da.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||Da.safeAttrValue,this.options=t}$a.prototype.process=function(t){if(!(t=""+(t=t||"")))return"";var e=this.options,i=e.whiteList,s=e.onAttr,n=e.onIgnoreAttr,r=e.safeAttrValue;return function(t,e){";"!==(t=Na(t))[t.length-1]&&(t+=";");var i=t.length,s=!1,n=0,r=0,o="";function a(){if(!s){var i=Ra(t.slice(n,r)),a=i.indexOf(":");if(-1!==a){var l=Ra(i.slice(0,a)),u=Ra(i.slice(a+1));if(l){var c=e(n,o.length,l,u,i);c&&(o+=c+"; ")}}}n=r+1}for(;r<i;r++){var l=t[r];if("/"===l&&"*"===t[r+1]){var u=t.indexOf("*/",r+2);if(-1===u)break;n=(r=u+1)+1,s=!1}else"("===l?s=!0:")"===l?s=!1:";"===l?s||a():"\n"===l&&a()}return Ra(o)}(t,(function(t,e,o,a,l){var u=i[o],c=!1;if(!0===u?c=u:"function"==typeof u?c=u(a):u instanceof RegExp&&(c=u.test(a)),!0!==c&&(c=!1),a=r(o,a)){var h,d={position:e,sourcePosition:t,source:l,isWhite:c};return c?Va(h=s(o,a,d))?o+":"+a:h:Va(h=n(o,a,d))?void 0:h}}))};var za=$a;!function(t,e){var i=Pa,s=za;for(var n in(e=t.exports=function(t,e){return new s(e).process(t)}).FilterCSS=s,i)e[n]=i[n]}(Ca,Ca.exports);var Ga={indexOf:function(t,e){var i,s;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var s,n;if(Array.prototype.forEach)return t.forEach(e,i);for(s=0,n=t.length;s<n;s++)e.call(i,t[s],s,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/.exec(t);return e?e.index:-1}},Ua=Ca.exports.getDefaultWhiteList,qa=Ga;var Ba=new(0,Ca.exports.FilterCSS);function Wa(t){return t.replace(Ha,"&lt;").replace(Ja,"&gt;")}var Ha=/</g,Ja=/>/g,Za=/"/g,Qa=/&quot;/g,Ka=/&#([a-zA-Z0-9]*);?/gim,Ya=/&colon;?/gim,Xa=/&newline;?/gim,tl=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,el=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,il=/u\s*r\s*l\s*\(.*/gi;function sl(t){return t.replace(Za,"&quot;")}function nl(t){return t.replace(Qa,'"')}function rl(t){return t.replace(Ka,(function(t,e){return String.fromCharCode("x"===e[0]||"X"===e[0]?parseInt(e.substr(1),16):parseInt(e,10))}))}function ol(t){return t.replace(Ya,":").replace(Xa," ")}function al(t){for(var e="",i=0,s=t.length;i<s;i++)e+=t.charCodeAt(i)<32?" ":t.charAt(i);return qa.trim(e)}function ll(t){return al(t=ol(t=rl(t=nl(t))))}function ul(t){return Wa(t=sl(t))}Fa.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]},Fa.getDefaultWhiteList=function(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}},Fa.onTag=function(){},Fa.onIgnoreTag=function(){},Fa.onTagAttr=function(){},Fa.onIgnoreTagAttr=function(){},Fa.safeAttrValue=function(t,e,i,s){if(i=ll(i),"href"===e||"src"===e){if("#"===(i=qa.trim(i)))return"#";if("http://"!==i.substr(0,7)&&"https://"!==i.substr(0,8)&&"mailto:"!==i.substr(0,7)&&"tel:"!==i.substr(0,4)&&"data:image/"!==i.substr(0,11)&&"ftp://"!==i.substr(0,6)&&"./"!==i.substr(0,2)&&"../"!==i.substr(0,3)&&"#"!==i[0]&&"/"!==i[0])return""}else if("background"===e){if(tl.lastIndex=0,tl.test(i))return""}else if("style"===e){if(el.lastIndex=0,el.test(i))return"";if(il.lastIndex=0,il.test(i)&&(tl.lastIndex=0,tl.test(i)))return"";!1!==s&&(i=(s=s||Ba).process(i))}return ul(i)},Fa.escapeHtml=Wa,Fa.escapeQuote=sl,Fa.unescapeQuote=nl,Fa.escapeHtmlEntities=rl,Fa.escapeDangerHtml5Entities=ol,Fa.clearNonPrintableCharacter=al,Fa.friendlyAttrValue=ll,Fa.escapeAttrValue=ul,Fa.onIgnoreTagStripAll=function(){return""},Fa.StripTagBody=function(t,e){"function"!=typeof e&&(e=function(){});var i=!Array.isArray(t),s=[],n=!1;return{onIgnoreTag:function(r,o,a){if(function(e){return!!i||-1!==qa.indexOf(t,e)}(r)){if(a.isClosing){return s.push([!1!==n?n:a.position,a.position+10]),n=!1,"[/removed]"}return n||(n=a.position),"[removed]"}return e(r,o,a)},remove:function(t){var e="",i=0;return qa.forEach(s,(function(s){e+=t.slice(i,s[0]),i=s[1]})),e+=t.slice(i)}}},Fa.stripCommentTag=function(t){for(var e="",i=0;i<t.length;){var s=t.indexOf("\x3c!--",i);if(-1===s){e+=t.slice(i);break}e+=t.slice(i,s);var n=t.indexOf("--\x3e",s);if(-1===n)break;i=n+3}return e},Fa.stripBlankChar=function(t){var e=t.split("");return(e=e.filter((function(t){var e=t.charCodeAt(0);return!(127===e||e<=31&&10!==e&&13!==e)}))).join("")},Fa.cssFilter=Ba,Fa.getDefaultCSSWhiteList=Ua;var cl={},hl=Ga;function dl(t){var e=hl.spaceIndex(t);if(-1===e)var i=t.slice(1,-1);else i=t.slice(1,e+1);return"/"===(i=hl.trim(i).toLowerCase()).slice(0,1)&&(i=i.slice(1)),"/"===i.slice(-1)&&(i=i.slice(0,-1)),i}function fl(t){return"</"===t.slice(0,2)}var pl=/[^a-zA-Z0-9_:\.\-]/gim;function yl(t,e){for(;e<t.length;e++){var i=t[e];if(" "!==i)return"="===i?e:-1}}function ml(t,e){for(;e>0;e--){var i=t[e];if(" "!==i)return"="===i?e:-1}}function gl(t){return function(t){return'"'===t[0]&&'"'===t[t.length-1]||"'"===t[0]&&"'"===t[t.length-1]}(t)?t.substr(1,t.length-2):t}cl.parseTag=function(t,e,i){var s="",n=0,r=!1,o=!1,a=0,l=t.length,u="",c="";t:for(a=0;a<l;a++){var h=t.charAt(a);if(!1===r){if("<"===h){r=a;continue}}else if(!1===o){if("<"===h){s+=i(t.slice(n,a)),r=a,n=a;continue}if(">"===h){s+=i(t.slice(n,r)),u=dl(c=t.slice(r,a+1)),s+=e(r,s.length,u,c,fl(c)),n=a+1,r=!1;continue}if('"'===h||"'"===h)for(var d=1,f=t.charAt(a-d);""===f.trim()||"="===f;){if("="===f){o=h;continue t}f=t.charAt(a-++d)}}else if(h===o){o=!1;continue}}return n<t.length&&(s+=i(t.substr(n))),s},cl.parseAttr=function(t,e){var i=0,s=[],n=!1,r=t.length;function o(t,i){if(!((t=(t=hl.trim(t)).replace(pl,"").toLowerCase()).length<1)){var n=e(t,i||"");n&&s.push(n)}}for(var a=0;a<r;a++){var l,u=t.charAt(a);if(!1!==n||"="!==u)if(!1===n||a!==i||'"'!==u&&"'"!==u||"="!==t.charAt(a-1)){if(/\s|\n|\t/.test(u)){if(t=t.replace(/\s|\n|\t/g," "),!1===n){if(-1===(l=yl(t,a))){o(hl.trim(t.slice(i,a))),n=!1,i=a+1;continue}a=l-1;continue}if(-1===(l=ml(t,a-1))){o(n,gl(hl.trim(t.slice(i,a)))),n=!1,i=a+1;continue}}}else{if(-1===(l=t.indexOf(u,a+1)))break;o(n,hl.trim(t.slice(i+1,l))),n=!1,i=(a=l)+1}else n=t.slice(i,a),i=a+1}return i<t.length&&(!1===n?o(t.slice(i)):o(n,gl(hl.trim(t.slice(i))))),hl.trim(s.join(" "))};var vl=Ca.exports.FilterCSS,wl=Fa,bl=cl.parseTag,Ml=cl.parseAttr,Sl=Ga;function xl(t){return null==t}function kl(t){(t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{})).stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=wl.onIgnoreTagStripAll),t.whiteList=t.whiteList||wl.whiteList,t.onTag=t.onTag||wl.onTag,t.onTagAttr=t.onTagAttr||wl.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||wl.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||wl.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||wl.safeAttrValue,t.escapeHtml=t.escapeHtml||wl.escapeHtml,this.options=t,!1===t.css?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new vl(t.css))}kl.prototype.process=function(t){if(!(t=""+(t=t||"")))return"";var e=this.options,i=e.whiteList,s=e.onTag,n=e.onIgnoreTag,r=e.onTagAttr,o=e.onIgnoreTagAttr,a=e.safeAttrValue,l=e.escapeHtml,u=this.cssFilter;e.stripBlankChar&&(t=wl.stripBlankChar(t)),e.allowCommentTag||(t=wl.stripCommentTag(t));var c=!1;e.stripIgnoreTagBody&&(c=wl.StripTagBody(e.stripIgnoreTagBody,n),n=c.onIgnoreTag);var h=bl(t,(function(t,e,c,h,d){var f,p={sourcePosition:t,position:e,isClosing:d,isWhite:i.hasOwnProperty(c)};if(!xl(f=s(c,h,p)))return f;if(p.isWhite){if(p.isClosing)return"</"+c+">";var y=function(t){var e=Sl.spaceIndex(t);if(-1===e)return{html:"",closing:"/"===t[t.length-2]};var i="/"===(t=Sl.trim(t.slice(e+1,-1)))[t.length-1];return i&&(t=Sl.trim(t.slice(0,-1))),{html:t,closing:i}}(h),m=i[c],g=Ml(y.html,(function(t,e){var i,s=-1!==Sl.indexOf(m,t);return xl(i=r(c,t,e,s))?s?(e=a(c,t,e,u))?t+'="'+e+'"':t:xl(i=o(c,t,e,s))?void 0:i:i}));return h="<"+c,g&&(h+=" "+g),y.closing&&(h+=" /"),h+">"}return xl(f=n(c,h,p))?l(h):f}),l);return c&&(h=c.remove(h)),h};var Il=kl;!function(t,e){var i=Fa,s=cl,n=Il;function r(t,e){return new n(e).process(t)}for(var o in(e=t.exports=r).filterXSS=r,e.FilterXSS=n,i)e[o]=i[o];for(var o in s)e[o]=s[o];"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=t.exports)}(Aa,Aa.exports);var jl,_l,Tl=function(){function t(t,e){var i,s=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],audio:["autoplay","controls","loop","muted","preload"],b:[],br:[],dd:["style"],div:["align","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],ol:[],p:["style"],source:["media","src","type"],span:["style"],strong:[],sub:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(t,e,i,n){return"a"===t&&"href"===e||("img"===t||"source"===t)&&"src"===e?s.sanitizeUrl(i):Aa.exports.safeAttrValue(t,e,i,n)}},t&&!e?i=t:t&&e?(i=Object.create(this.arcgisFilterOptions),Object.keys(t).forEach((function(e){"whiteList"===e?i.whiteList=s._extendObjectOfArrays([s.arcgisWhiteList,t.whiteList||{}]):i[e]=t[e]}))):(i=Object.create(this.arcgisFilterOptions)).whiteList=this.arcgisWhiteList,this.xssFilterOptions=i,this._xssFilter=new Aa.exports.FilterXSS(i)}return t.prototype.sanitize=function(t,e){switch(void 0===e&&(e={}),typeof t){case"number":return isNaN(t)||!isFinite(t)?null:t;case"boolean":return t;case"string":return this._xssFilter.process(t);case"object":return this._iterateOverObject(t,e);default:if(e.allowUndefined&&void 0===t)return;return null}},t.prototype.sanitizeUrl=function(t){var e=this._trim(t.substring(0,t.indexOf(":")));return"/"===t||"#"===t||"#"===t[0]||this.allowedProtocols.indexOf(e.toLowerCase())>-1?Aa.exports.escapeAttrValue(t):""},t.prototype.sanitizeHTMLAttribute=function(t,e,i,s){return"function"==typeof this.xssFilterOptions.safeAttrValue?this.xssFilterOptions.safeAttrValue(t,e,i,s):Aa.exports.safeAttrValue(t,e,i,s)},t.prototype.validate=function(t,e){void 0===e&&(e={});var i=this.sanitize(t,e);return{isValid:t===i,sanitized:i}},t.prototype._extendObjectOfArrays=function(t){var e={};return t.forEach((function(t){Object.keys(t).forEach((function(i){e[i]=Array.isArray(t[i])&&Array.isArray(e[i])?e[i].concat(t[i]):t[i]}))})),e},t.prototype._iterateOverObject=function(t,e){var i=this;void 0===e&&(e={});try{var s=!1,n=void 0;if(Array.isArray(t))n=t.reduce((function(t,n){var r=i.validate(n,e);return r.isValid?t.concat([n]):(s=!0,t.concat([r.sanitized]))}),[]);else{if(!function(t){if(!function(t){return!!t&&"object"==typeof t}(t)||"[object Object]"!=Ta.call(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t))return!1;var e=Oa(t);if(null===e)return!0;var i=ja.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&Ia.call(i)==_a}(t)){if(e.allowUndefined&&void 0===t)return;return null}n=Object.keys(t).reduce((function(n,r){var o=t[r],a=i.validate(o,e);return a.isValid?n[r]=o:(s=!0,n[r]=a.sanitized),n}),{})}return s?n:t}catch(t){return null}},t.prototype._trim=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},t}(),Ol=function(t){jl||function(t){if("WebkitTransition"in t.style)jl="webkitTransitionEnd",_l="webkitAnimationEnd";else{if(!("transition"in t.style))throw Error("Your browser is not supported!");jl="transitionend",_l="animationend"}}(t)},Al=function(t,e){return void 0===e&&(e=t+"-active"),function(i){Ol(i);var s=!1,n=function(){s||(s=!0,i.removeEventListener(jl,n),i.removeEventListener(_l,n),i.classList.remove(t),i.classList.remove(e))};i.classList.add(t),i.addEventListener(jl,n),i.addEventListener(_l,n),requestAnimationFrame((function(){i.classList.add(e)}))}},Fl=function(t,e){return void 0===e&&(e=t+"-active"),function(i,s){Ol(i);var n=!1,r=function(){n||(n=!0,i.removeEventListener(jl,r),i.removeEventListener(_l,r),s())};i.classList.add(t),i.addEventListener(jl,r),i.addEventListener(_l,r),requestAnimationFrame((function(){i.classList.add(e)}))}};function Cl(t){const e=xs.acquire();for(let t=0;t<arguments.length;t++){const i=arguments[t],s=typeof i;if("string"===s)e.push(i);else if(Array.isArray(i))e.push.apply(e,i);else if("object"===s)for(const t in i)i[t]&&e.push(t)}const i=e.join(" ");return xs.release(e),i}function Pl(t){const e=null==t?void 0:t.closest("[dir]");return null!==e&&e instanceof HTMLElement&&"rtl"===e.dir||"rtl"===document.dir}function El(t){return Pl(t)?"rtl":"ltr"}function Ll(t){this[t.getAttribute("data-node-ref")]=null}function Rl(t){this[t.getAttribute("data-node-ref")]=t}function Nl(t,e){return("enter"===t?Al:Fl)(e)}ct.getLogger("esri.widgets.support.widgetUtils");const Dl=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"].reduce(((t,e)=>(t[e]=[],t)),{}),Vl=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],$l=new Tl({whiteList:Dl,onTagAttr:(t,e,i)=>{const s=`${e}="${i}"`;if(Vl.includes(e))return s},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function zl(t,e){const i=t.getBoundingClientRect(),s=e.getBoundingClientRect();(i.top+i.height>s.top+s.height||i.top<s.top)&&t.scrollIntoView({block:"end"})}function Gl(t){return"Enter"===t||" "===t}function Ul(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g,"")}function ql(){return Ul().startsWith("dark")}const Bl="http://www.w3.org/",Wl=Bl+"2000/svg",Hl=Bl+"1999/xlink";let Jl,Zl=[],Ql=(t,e)=>{let i={};return Object.keys(t).forEach((e=>{i[e]=t[e]})),e&&Object.keys(e).forEach((t=>{i[t]=e[t]})),i},Kl=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),Yl=t=>{if("string"!=typeof t)throw Error("Style values must be strings")},Xl=(t,e,i)=>{if(""!==e.vnodeSelector)for(let s=i;s<t.length;s++)if(Kl(t[s],e))return s;return-1},tu=(t,e,i,s)=>{let n=t[e];if(""===n.vnodeSelector)return;let r=n.properties;if(!(r?void 0===r.key?r.bind:r.key:void 0))for(let r=0;r<t.length;r++)if(r!==e&&Kl(t[r],n))throw Error(`${i.vnodeSelector} had a ${n.vnodeSelector} child ${"added"===s?s:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)},eu=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},iu=[],su=!1,nu=t=>{(t.children||[]).forEach(nu),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.call(t.properties.bind||t.properties,t.domNode)},ru=()=>{su=!1,iu.forEach(nu),iu.length=0},ou=t=>{iu.push(t),su||(su=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(ru,{timeout:16}):setTimeout(ru,16))},au=t=>{let e=t.domNode;if(t.properties){let i=t.properties.exitAnimation;if(i){e.style.pointerEvents="none";let s=()=>{e.parentNode&&(e.parentNode.removeChild(e),ou(t))};return void i(e,s,t.properties)}}e.parentNode&&(e.parentNode.removeChild(e),ou(t))},lu=(t,e,i)=>{if(!e)return;let s=i.eventHandlerInterceptor,n=Object.keys(e),r=n.length;for(let o=0;o<r;o++){let r=n[o],a=e[r];if("className"===r)throw Error('Property "className" is not supported, use "class".');if("class"===r)hu(t,a,!0);else if("classes"===r){let e=Object.keys(a),i=e.length;for(let s=0;s<i;s++){let i=e[s];a[i]&&t.classList.add(i)}}else if("styles"===r){let e=Object.keys(a),s=e.length;for(let n=0;n<s;n++){let s=e[n],r=a[s];r&&(Yl(r),i.styleApplyer(t,s,r))}}else if("key"!==r&&null!=a){let n=typeof a;"function"===n?(0===r.lastIndexOf("on",0)&&(s&&(a=s(r,a,t,e)),"oninput"===r&&function(){let t=a;a=function(e){t.call(this,e),e.target["oninput-value"]=e.target.value}}()),t[r]=a):i.namespace===Wl?"href"===r?t.setAttributeNS(Hl,r,a):t.setAttribute(r,a):"string"===n&&"value"!==r?"innerHTML"===r?t[r]=$l.sanitize(a):t.setAttribute(r,a):t[r]=a}}},uu=(t,e,i)=>{((t,e,i)=>{if(e)for(let s of e)cu(s,t,void 0,i)})(t,e.children,i),e.text&&(t.textContent=e.text),lu(t,e.properties,i),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.call(e.properties.bind||e.properties,t,i,e.vnodeSelector,e.properties,e.children)},cu=(t,e,i,s)=>{let n,r=0,o=t.vnodeSelector,a=e.ownerDocument;if(""===o)n=t.domNode=a.createTextNode(t.text),void 0!==i?e.insertBefore(n,i):e.appendChild(n);else{for(let l=0;l<=o.length;++l){let u=o.charAt(l);if(l===o.length||"."===u||"#"===u){let u=o.charAt(r-1),c=o.slice(r,l);"."===u?n.classList.add(c):"#"===u?n.id=c:("svg"===c&&(s=Ql(s,{namespace:Wl})),void 0!==s.namespace?n=t.domNode=a.createElementNS(s.namespace,c):(n=t.domNode=t.domNode||a.createElement(c),"input"===c&&t.properties&&void 0!==t.properties.type&&n.setAttribute("type",t.properties.type)),void 0!==i?e.insertBefore(n,i):n.parentNode!==e&&e.appendChild(n)),r=l+1}}uu(n,t,s)}},hu=(t,e,i)=>{e&&e.split(" ").forEach((e=>{e&&t.classList.toggle(e,i)}))};Jl=(t,e,i)=>{let s=t.domNode,n=!1;if(t===e)return!1;let r=!1;if(""===e.vnodeSelector){if(e.text!==t.text){let t=s.ownerDocument.createTextNode(e.text);return s.parentNode.replaceChild(t,s),e.domNode=t,n=!0,n}e.domNode=s}else 0===e.vnodeSelector.lastIndexOf("svg",0)&&(i=Ql(i,{namespace:Wl})),t.text!==e.text&&(r=!0,void 0===e.text?s.removeChild(s.firstChild):s.textContent=e.text),e.domNode=s,r=((t,e,i,s,n)=>{if(i===s)return!1;let r,o=(i=i||Zl).length,a=(s=s||Zl).length,l=0,u=0,c=!1;for(;u<a;){let a=l<o?i[l]:void 0,h=s[u];if(void 0!==a&&Kl(a,h))c=Jl(a,h,n)||c,l++;else{let a=Xl(i,h,l+1);if(a>=0){for(r=l;r<a;r++)au(i[r]),tu(i,r,t,"removed");c=Jl(i[a],h,n)||c,l=a+1}else cu(h,e,l<o?i[l].domNode:void 0,n),eu(h),tu(s,u,t,"added")}u++}if(o>l)for(r=l;r<o;r++)au(i[r]),tu(i,r,t,"removed");return c})(e,s,t.children,e.children,i)||r,r=((t,e,i,s)=>{if(!i)return;let n=!1,r=Object.keys(i),o=r.length;for(let a=0;a<o;a++){let o=r[a],l=i[o],u=e[o];if("class"===o)u!==l&&(hu(t,u,!1),hu(t,l,!0));else if("classes"===o){let e=t.classList,i=Object.keys(l),s=i.length;for(let t=0;t<s;t++){let s=i[t],r=!!l[s];r!==!!u[s]&&(n=!0,r?e.add(s):e.remove(s))}}else if("styles"===o){let e=Object.keys(l),i=e.length;for(let r=0;r<i;r++){let i=e[r],o=l[i];o!==u[i]&&(n=!0,o?(Yl(o),s.styleApplyer(t,i,o)):s.styleApplyer(t,i,""))}}else if(l||"string"!=typeof u||(l=""),"value"===o){let e=t[o];e!==l&&(t["oninput-value"]?e===t["oninput-value"]:l!==u)&&(t[o]=l,t["oninput-value"]=void 0),l!==u&&(n=!0)}else if(l!==u){let e=typeof l;"function"===e&&s.eventHandlerInterceptor||(s.namespace===Wl?"href"===o?t.setAttributeNS(Hl,o,l):t.setAttribute(o,l):"string"===e?"innerHTML"===o?t[o]=$l.sanitize(l):"role"===o&&""===l?t.removeAttribute(o):t.setAttribute(o,l):t[o]!==l&&(t[o]=l),n=!0)}}return n})(s,t.properties,e.properties,i)||r,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.call(e.properties.bind||e.properties,s,i,e.vnodeSelector,e.properties,e.children);return r&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(s,e.properties,t.properties),n};let du=(t,e)=>({getLastRender:()=>t,update:i=>{if(t.vnodeSelector!==i.vnodeSelector)throw Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let s=t;t=i,Jl(s,i,e)},domNode:t.domNode});const fu={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{"-"===e.charAt(0)?t.style.setProperty(e,i):t.style[e]=i}};let pu,yu=t=>Ql(fu,t),mu=(t,e,i)=>(i=yu(i),cu(e,t,void 0,i),du(e,i)),gu=(t,e,i)=>(i=yu(i),cu(e,t.parentNode,t,i),du(e,i)),vu=(t,e,i)=>(i=yu(i),e.domNode=t,uu(t,e,i),du(e,i)),wu=(t,e,i)=>(i=yu(i),cu(e,t.parentNode,t,i),t.parentNode.removeChild(t),du(e,i)),bu=(t,e)=>{let i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i};pu=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let Mu=(t,e)=>{let i=t;return e.forEach((t=>{i=i&&i.children?pu(i.children,(e=>e.domNode===t)):void 0})),i},Su=(t,e,i)=>{let s=function(s){i("domEvent",s);let n=e(),r=bu(s.currentTarget,n.domNode);r.reverse();let o,a=Mu(n.getLastRender(),r);return t.scheduleRender(),a&&(o=a.properties["on"+s.type].apply(a.properties.bind||this,arguments)),i("domEventProcessed",s),o};return()=>s},xu=t=>{let e,i,s=yu(t),n=s.performanceLogger,r=!0,o=!1,a=[],l=[],u=(t,i,r)=>{let o;s.eventHandlerInterceptor=Su(e,(()=>o),n),o=t(i,r(),s),a.push(o),l.push(r)},c=()=>{if(i=void 0,r){r=!1,n("renderStart",void 0);for(let t=0;t<a.length;t++){let e=l[t]();n("rendered",void 0),a[t].update(e),n("patched",void 0)}n("renderDone",void 0),r=!0}};return e={renderNow:c,scheduleRender:()=>{i||o||(i=requestAnimationFrame(c))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),o=!0},resume:()=>{o=!1,r=!0,e.scheduleRender()},append:(t,e)=>{u(mu,t,e)},insertBefore:(t,e)=>{u(gu,t,e)},merge:(t,e)=>{u(vu,t,e)},replace:(t,e)=>{u(wu,t,e)},detach:t=>{for(let e=0;e<l.length;e++)if(l[e]===t)return l.splice(e,1),a.splice(e,1)[0];throw Error("renderFunction was not found")}},e};const ku={handleInterceptedEvent:(t,e,i,s)=>(t.scheduleRender(),e.properties["on"+s.type].call(e.properties.bind||i,s))},Iu={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{t.style[e]=i}},ju=(t,e,i=!1)=>{let s=t;return e.forEach(((t,n)=>{var r;const o=null!=(r=s)&&r.children?((t,e)=>t.find(e))(s.children,(e=>e.domNode===t)):void 0;i&&!o&&n!==e.length-1||(s=o)})),s};let _u=!1;const Tu="undefined"!=typeof window?window:{},Ou=Tu.document||{head:{}},Au={o:0,M:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,i,s)=>t.addEventListener(e,i,s),rel:(t,e,i,s)=>t.removeEventListener(e,i,s),ce:(t,e)=>new CustomEvent(t,e)},Fu=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replace}catch(t){}return!1})(),Cu=new WeakMap,Pu=t=>"sc-"+t.S,Eu={},Lu=t=>"object"==(t=typeof t)||"function"===t,Ru=(t,e,...i)=>{let s=null,n=!1,r=!1,o=[];const a=e=>{for(let i=0;i<e.length;i++)s=e[i],Array.isArray(s)?a(s):null!=s&&"boolean"!=typeof s&&((n="function"!=typeof t&&!Lu(s))&&(s+=""),n&&r?o[o.length-1].I+=s:o.push(n?Nu(null,s):s),r=n)};if(a(i),e){const t=e.className||e.class;t&&(e.class="object"!=typeof t?t:Object.keys(t).filter((e=>t[e])).join(" "))}const l=Nu(t,null);return l._=e,o.length>0&&(l.T=o),l},Nu=(t,e)=>({o:0,O:t,I:e,A:null,T:null,_:null}),Du={},Vu=(t,e,i,s)=>{if(i!==s&&(e.toLowerCase(),"class"===e)){const e=t.classList,n=zu(i),r=zu(s);e.remove(...n.filter((t=>t&&!r.includes(t)))),e.add(...r.filter((t=>t&&!n.includes(t))))}},$u=/\s/,zu=t=>t?t.split($u):[],Gu=(t,e,i,s)=>{const n=11===e.A.nodeType&&e.A.host?e.A.host:e.A,r=t&&t._||Eu,o=e._||Eu;for(s in r)s in o||Vu(n,s,r[s],void 0);for(s in o)Vu(n,s,r[s],o[s])},Uu=(t,e,i)=>{let s,n,r=e.T[i],o=0;if(s=r.A=Ou.createElement(r.O),Gu(null,r),r.T)for(o=0;o<r.T.length;++o)n=Uu(t,r,o),n&&s.appendChild(n);return s},qu=(t,e,i,s,n,r)=>{let o,a=t;for(;n<=r;++n)s[n]&&(o=Uu(null,i,n),o&&(s[n].A=o,a.insertBefore(o,e)))},Bu=(t,e,i,s)=>{for(;e<=i;++e)(s=t[e])&&s.A.remove()},Wu=(t,e)=>t.O===e.O,Hu=(t,e)=>{const i=e.A=t.A,s=t.T,n=e.T;Gu(t,e),null!==s&&null!==n?((t,e,i,s)=>{let n,r=0,o=0,a=e.length-1,l=e[0],u=e[a],c=s.length-1,h=s[0],d=s[c];for(;r<=a&&o<=c;)null==l?l=e[++r]:null==u?u=e[--a]:null==h?h=s[++o]:null==d?d=s[--c]:Wu(l,h)?(Hu(l,h),l=e[++r],h=s[++o]):Wu(u,d)?(Hu(u,d),u=e[--a],d=s[--c]):Wu(l,d)?(Hu(l,d),t.insertBefore(l.A,u.A.nextSibling),l=e[++r],d=s[--c]):Wu(u,h)?(Hu(u,h),t.insertBefore(u.A,l.A),u=e[--a],h=s[++o]):(n=Uu(e&&e[o],i,o),h=s[++o],n&&l.A.parentNode.insertBefore(n,l.A));r>a?qu(t,null==s[c+1]?null:s[c+1].A,i,s,o,c):o>c&&Bu(e,r,a)})(i,s,e,n):null!==n?qu(i,null,e,n,0,n.length-1):null!==s&&Bu(s,0,s.length-1)},Ju=(t,e,i)=>{const s=(t=>hc(t).F)(t);return{emit:t=>Zu(s,e,{bubbles:!!(4&i),composed:!!(2&i),cancelable:!!(1&i),detail:t})}},Zu=(t,e,i)=>{const s=Au.ce(e,i);return t.dispatchEvent(s),s},Qu=(t,e)=>{e&&!t.C&&e["s-p"]&&e["s-p"].push(new Promise((e=>t.C=e)))},Ku=(t,e)=>{if(t.o|=16,!(4&t.o))return Qu(t,t.P),xc((()=>Yu(t,e)));t.o|=512},Yu=(t,e)=>{const i=t.L;let s;return e&&(s=sc(i,"componentWillLoad")),nc(s,(()=>Xu(t,i,e)))},Xu=async(t,e,i)=>{const s=t.F,n=s["s-rc"];i&&(t=>{const e=t.R;((t,e)=>{let i=Pu(e),s=mc.get(i);if(t=11===t.nodeType?t:Ou,s)if("string"==typeof s){let e,n=Cu.get(t=t.head||t);n||Cu.set(t,n=new Set),n.has(i)||(e=Ou.createElement("style"),e.innerHTML=s,t.insertBefore(e,t.querySelector("link")),n&&n.add(i))}else t.adoptedStyleSheets.includes(s)||(t.adoptedStyleSheets=[...t.adoptedStyleSheets,s])})(t.F.getRootNode(),e)})(t);tc(t,e),n&&(n.map((t=>t())),s["s-rc"]=void 0);{const e=s["s-p"],i=()=>ec(t);0===e.length?i():(Promise.all(e).then(i),t.o|=4,e.length=0)}},tc=(t,e)=>{try{e=e.render&&e.render(),t.o&=-17,t.o|=2,((t,e)=>{const i=t.F,s=t.N||Nu(null,null),n=(t=>t&&t.O===Du)(e)?e:Ru(null,null,e);n.O=null,n.o|=4,t.N=n,n.A=s.A=i,Hu(s,n)})(t,e)}catch(e){fc(e,t.F)}return null},ec=t=>{const e=t.F,i=t.P;sc(t.L,"componentDidRender"),64&t.o||(t.o|=64,rc(e),t.D(e),i||ic()),t.C&&(t.C(),t.C=void 0),512&t.o&&Sc((()=>Ku(t,!1))),t.o&=-517},ic=()=>{rc(Ou.documentElement),Sc((()=>Zu(Tu,"appload",{detail:{namespace:t}})))},sc=(t,e,i)=>{if(t&&t[e])try{return t[e](i)}catch(t){fc(t)}},nc=(t,e)=>t&&t.then?t.then(e):e(),rc=t=>t.classList.add("hydrated"),oc=(t,e,i)=>{if(e.V){t.watchers&&(e.$=t.watchers);const s=Object.entries(e.V),n=t.prototype;if(s.map((([t,[s]])=>{(31&s||2&i&&32&s)&&Object.defineProperty(n,t,{get(){return((t,e)=>hc(this).G.get(e))(0,t)},set(i){((t,e,i,s)=>{const n=hc(t),r=n.F,o=n.G.get(e),a=n.o,l=n.L;if(i=((t,e)=>null==t||Lu(t)?t:2&e?parseFloat(t):1&e?t+"":t)(i,s.V[e][0]),!(8&a&&void 0!==o||i===o)&&(n.G.set(e,i),l)){if(s.$&&128&a){const t=s.$[e];t&&t.map((t=>{try{l[t](i,o,e)}catch(t){fc(t,r)}}))}2==(18&a)&&Ku(n,!1)}})(this,t,i,e)},configurable:!0,enumerable:!0})})),1&i){const e=new Map;n.attributeChangedCallback=function(t,i,s){Au.jmp((()=>{const i=e.get(t);this.hasOwnProperty(i)&&(s=this[i],delete this[i]),this[i]=(null!==s||"boolean"!=typeof this[i])&&s}))},t.observedAttributes=s.filter((([t,e])=>15&e[0])).map((([t,i])=>{const s=i[1]||t;return e.set(s,t),s}))}}return t},ac=(t,e)=>{const i={o:e[0],S:e[1]};return i.V=e[2],i.$=t.$,Object.assign(t.prototype,{__registerHost(){dc(this,i)},connectedCallback(){(t=>{if(0==(1&Au.o)){const e=hc(t),i=e.R,s=()=>{};if(!(1&e.o)){e.o|=1;{let i=t;for(;i=i.parentNode||i.host;)if(i["s-p"]){Qu(e,e.P=i);break}}i.V&&Object.entries(i.V).map((([e,[i]])=>{if(31&i&&t.hasOwnProperty(e)){const i=t[e];delete t[e],t[e]=i}})),(async(t,e,i,s,n)=>{if(0==(32&e.o)){{if(e.o|=32,(n=yc(i)).then){const t=()=>{};n=await n,t()}n.isProxied||(i.$=n.watchers,oc(n,i,2),n.isProxied=!0);const t=()=>{};e.o|=8;try{new n(e)}catch(t){fc(t)}e.o&=-9,e.o|=128,t()}if(n.style){let t=n.style;const e=Pu(i);if(!mc.has(e)){const s=()=>{};((t,e,i)=>{let s=mc.get(t);Fu&&i?(s=s||new CSSStyleSheet,s.replace(e)):s=e,mc.set(t,s)})(e,t,!!(1&i.o)),s()}}}const r=e.P,o=()=>Ku(e,!0);r&&r["s-rc"]?r["s-rc"].push(o):o()})(0,e,i)}s()}})(this)},disconnectedCallback(){}}),t.is=i.S,oc(t,i,3)},lc=t=>{t.attachShadow({mode:"open"})},uc=t=>{const e=new URL(t,Au.M);return e.origin!==Tu.location.origin?e.href:e.pathname},cc=new WeakMap,hc=t=>cc.get(t),dc=(t,e)=>{const i={o:0,F:t,R:e,G:new Map};return i.U=new Promise((t=>i.D=t)),t["s-p"]=[],t["s-rc"]=[],cc.set(t,i)},fc=(t,e)=>(0,console.error)(t,e),pc=new Map,yc=t=>{const e=t.S.replace(/-/g,"_"),i=t.B,s=pc.get(i);return s?s[e]:import(`./${i}.entry.js`).then((t=>(pc.set(i,t),t[e])),fc)},mc=new Map,gc=[],vc=[],wc=(t,e)=>i=>{t.push(i),_u||(_u=!0,e&&4&Au.o?Sc(Mc):Au.raf(Mc))},bc=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(t){fc(t)}t.length=0},Mc=()=>{bc(gc),bc(vc),(_u=gc.length>0)&&Au.raf(Mc)},Sc=t=>Promise.resolve(void 0).then(t),xc=wc(vc,!0);let kc;kc="components/assets";const Ic=Symbol("widget"),jc=[],_c={},Tc=new WeakMap;function Oc(t,e){let i=e.children;if(i&&i.length)for(let e=0;e<i.length;++e)i[e]=Oc(t,i[e]);else i=jc;const s=e.vnodeSelector;if(Pc(s)){const n=e.properties||_c,r=n.key||s;return{vnodeSelector:"div",properties:{key:r,afterCreate:Ac,afterUpdate:Fc,afterRemoved:Cc,parentWidget:t,widgetConstructor:s,widgetProperties:{...n,key:r,children:i}},children:void 0,text:void 0,domNode:null}}return e}function Ac(t,e,i,{parentWidget:s,widgetConstructor:n,widgetProperties:r}){const o=new n(r);o.container=t,Tc.set(t,o),null==o.afterCreate||o.afterCreate(o,t),s._internalHandles.add(Fi((()=>Cc(t))))}function Fc(t,e,i,{widgetProperties:s}){const n=Tc.get(t);n&&(n.set(s),null==n.afterUpdate||n.afterUpdate(n,t))}function Cc(t){const e=Tc.get(t);e&&(e.destroy(),Tc.delete(t))}function Pc(t){return"function"==typeof t&&t[Ic]}const Ec="esri.widgets.Widget",Lc=ct.getLogger(Ec);let Rc=0;const Nc=new Map;function Dc(t,e){for(const i in e)null!=t[i]&&("object"==typeof t[i]&&"object"==typeof e[i]?Dc(t[i],e[i]):t[i]=e[i]);return t}const Vc=(t=>{let e;const i={...ku,...t},s=(t=>({...Iu,...t}))(i),n=s.performanceLogger;let r,o=!0,a=!1;const l=[],u=[],c=(t,r,o)=>{let a;s.eventHandlerInterceptor=()=>function(t){let s;n("domEvent",t);const r=((t,e)=>{const i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i})(t.currentTarget,a.domNode),o=r.some((t=>{var e;return customElements.get(null==t||null==(e=t.tagName)?void 0:e.toLowerCase())}));if(t.eventPhase!==Event.CAPTURING_PHASE&&o){const e=t.composedPath(),i=e.slice(e.indexOf(t.currentTarget),e.indexOf(a.domNode)).filter((t=>t.getRootNode()===t.ownerDocument)).reverse();s=ju(a.getLastRender(),i,!0)}else r.reverse(),s=ju(a.getLastRender(),r);let l;return s&&(l=i.handleInterceptedEvent(e,s,this,t)),n("domEventProcessed",t),l},null==i.postProcessProjectionOptions||i.postProcessProjectionOptions(s);const c=o();a=t(r,c,s),l.push(a),u.push(o),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(a,c)};let h=()=>{if(r=void 0,o){o=!1,n("renderStart",void 0);for(let t=0;t<l.length;t++){const e=u[t]();n("rendered",void 0),l[t].update(e),n("patched",void 0)}n("renderDone",void 0),o=!0}};return i.modifyDoRenderImplementation&&(h=i.modifyDoRenderImplementation(h,l,u)),e={renderNow:h,scheduleRender:()=>{r||a||(r=requestAnimationFrame(h))},stop:()=>{r&&(cancelAnimationFrame(r),r=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(t,e)=>{c(mu,t,e)},insertBefore:(t,e)=>{c(gu,t,e)},merge:(t,e)=>{c(vu,t,e)},replace:(t,e)=>{c(wu,t,e)},detach:t=>{for(let e=0;e<u.length;e++)if(u[e]===t)return u.splice(e,1),l.splice(e,1)[0];throw Error("renderFunction was not found")}},e})({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,i=/capture$/i;t.eventHandlerInterceptor=(t,s,n,r)=>{const o=e(t,s,n,r),a=i.test(t);if(!((t=t.replace(i,"")).toLowerCase()in n)||a){const e=t[2].toLowerCase()+t.slice(3),i=t=>o.call(n,t);n.addEventListener(e,i,a);const s=()=>n.removeEventListener(e,i,a),l=r.afterRemoved;r.afterRemoved=t=>{null==l||l(t),s()}}return o}},handleInterceptedEvent(t,e,i,s){const{eventPhase:n,type:r}=s,o=n===Event.CAPTURING_PHASE;let a=`on${r}${o?"capture":""}`;const l=e.properties;(a in l||(a=`on${r[0].toUpperCase()}${r.slice(1)}${o?"Capture":""}`,a in l))&&(Nc.clear(),t.scheduleRender(),l[a].call(l.bind||i,s))}});let $c=!1,zc=class extends(ma(Cr.EventedAccessor)){constructor(t,e){super(t,e),this._attached=!1,this._internalHandles=new Qr,this._projector=Vc,this._readyForTrueRender=!1,this.domNode=null,this.iconClass="esri-icon-checkbox-unchecked",this.label=this.declaredClass.split(".").pop(),this.visible=!0,this.key=this,this._loadLocale=Xe((async()=>{if(this._messageBundleProps&&this._messageBundleProps.length){const t=await Be(this._messageBundleProps.map((async({bundlePath:t,propertyName:e})=>{let i=await na(t);this.uiStrings&&Object.keys(this.uiStrings)&&(i=Dc(H(i),this.uiStrings)),this[e]=i})));for(const e of t)e.error&&Lc.error("widget-intl:locale-error",this.declaredClass,e.error)}await this.loadLocale()})),(t=>{Au.M=t})(Ut(Ii(kc)));const i=Ul()||"light";["light","dark"].includes(i)||Oi(Lc,"The following themes are deprecated: light-blue, dark-blue, light-green, dark-green, light-purple, dark-purple, light-red, and dark-red.",{version:"4.19",warnOnce:!0,see:"https://developers.arcgis.com/javascript/latest/styling/"});const s="esri-widget-uid-"+va(),n=this.render.bind(this);this._trackingTarget=new tn((()=>this.scheduleRender()));const r=()=>{var t;if(!this._readyForTrueRender||this.destroyed)return null;if(!this.visible)return{vnodeSelector:"div",properties:{key:s,class:"",styles:{display:"none"}},domNode:void 0,children:void 0,text:void 0};const e=n();let{properties:i}=e;i||(e.properties=i={});let{key:r,styles:o}=i;r||(i.key=s),o||(i.styles=o={}),o.display||(o.display="");let a=0;return null==(t=e.children)||t.forEach((t=>{if(Pc(t.vnodeSelector))return;let{properties:e}=t;e||(t.properties=e={}),e.key||(e.key=`${this.id}--${a++}`)})),Oc(this,e)};this.render=()=>{if($c)return r();let t=Nc.get(this);if(t)return t;this._trackingTarget.clear(),$c=!0;try{t=is(this._trackingTarget,r)}finally{$c=!1}return Nc.set(this,t),t},this.addResolvingPromise(this._resourcesFetch=this.beforeFirstRender().then((()=>{this._readyForTrueRender=!0,this._postInitialize()})))}normalizeCtorArgs(t,e){const i={...t};return e&&(i.container=e),i}postInitialize(){}beforeFirstRender(){return Promise.all([this.loadDependencies(),this._loadLocale()]).then((()=>{})).catch(De)}async loadDependencies(){}async loadLocale(){}destroy(){this.destroyed||(this._trackingTarget=m(this._trackingTarget),this.viewModel=m(this.viewModel),this._detach(this.container),this._set("container",null),this._internalHandles.destroy(),this._emitter.clear(),this.render=()=>null,this._projector=null,Nc.delete(this))}set container(t){this._get("container")||this._set("container",t)}castContainer(t){return ca(t)}get id(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+Rc++}set id(t){t&&this._set("id",t)}get renderable(){return this._resourcesFetch}get test(){return{projector:this._projector,handles:this._internalHandles}}render(){throw Error("not implemented")}scheduleRender(){this.destroyed||(Nc.delete(this),this._projector.scheduleRender())}classes(...t){return Cl.apply(this,t)}own(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments)),this._internalHandles.add(t)}renderNow(){Nc.delete(this),this._projector.renderNow()}_postInitialize(){var t;if(this.destroyed)return;this.scheduleRender(),null!=(t=this._delegatedEventNames)&&t.length&&this._internalHandles.add(Yr(this,"viewModel",((t,e)=>{e&&this._internalHandles.remove("delegated-events"),t&&this._internalHandles.add(this._delegatedEventNames.map((e=>t.on(e,(t=>{this.emit(e,t)})))),"delegated-events")}))),this.postInitialize();const e=async()=>{await this._loadLocale().catch(De),this.scheduleRender()};this._internalHandles.add([To(e),this.watch("uiStrings",e),eo(this,"container",(async t=>{this.destroyed||this._attach(t)}))])}_attach(t){t&&(this._projector.merge(t,this.render),this._attached=!0)}_detach(t){t&&this._attached&&(this._projector.detach(this.render),t.parentNode&&t.parentNode.removeChild(t),this._attached=!1)}};zc[Ic]=!0,e([Hn()],zc.prototype,"_readyForTrueRender",void 0),e([Hn({value:null})],zc.prototype,"container",null),e([xa("container")],zc.prototype,"castContainer",null),e([Hn({aliasOf:"container"})],zc.prototype,"domNode",void 0),e([Hn()],zc.prototype,"iconClass",void 0),e([Hn()],zc.prototype,"id",null),e([Hn()],zc.prototype,"label",void 0),e([Hn()],zc.prototype,"renderable",null),e([Hn()],zc.prototype,"uiStrings",void 0),e([Hn()],zc.prototype,"viewModel",void 0),e([Hn()],zc.prototype,"visible",void 0),e([Hn()],zc.prototype,"key",void 0),e([Hn()],zc.prototype,"children",void 0),e([Hn()],zc.prototype,"afterCreate",void 0),e([Hn()],zc.prototype,"afterUpdate",void 0),e([Hn()],zc.prototype,"afterRemoved",void 0),zc=e([_r(Ec)],zc);const Gc=zc,Uc=t=>{let i=class extends t{constructor(...t){super(...t),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((t=>{const e=this.load.bind(this);this.load=i=>{const s=new Promise(((t,e)=>{const s=$e(i,e);this.destroyed&&e(new dt("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this._promiseProps.when(t,e).finally((()=>{s&&s.remove()}))}));if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const t=this._loadController=new AbortController;e({signal:t.signal}),Ve(t.signal,(()=>{this._promiseProps.abort()}))}return t(),s}}))),this.when((()=>{this._set("loadStatus","loaded"),this._loadController=null}),(t=>{this._set("loadStatus","failed"),this._set("loadError",t),this._loadController=null}))}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var t;return this.isFulfilled()||(this._set("loadError",new dt("load:cancelled","Cancelled")),null==(t=this._loadController)||t.abort()),this}};return e([Hn({readOnly:!0})],i.prototype,"loaded",null),e([Hn({readOnly:!0})],i.prototype,"loadError",void 0),e([Hn()],i.prototype,"loadStatus",void 0),e([Hn({type:[Qn],readOnly:!0})],i.prototype,"loadWarnings",null),i=e([_r("esri.core.Loadable")],i),i};let qc=class extends(Uc(ga)){};qc=e([_r("esri.core.Loadable")],qc),function(t){t.LoadableMixin=Uc,t.isLoadable=function(t){return!(!t||!t.load)}}(qc||(qc={}));const Bc=qc;function Wc(t,e,i=Jr){return e||(e=new i),e===t||(e.removeAll(),function(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}(t)?e.addMany(t):t&&e.add(t)),e}function Hc(t){return t}function Jc(t,e,i){if(!t||!t.read||!1===t.read.enabled||!t.read.source)return!1;const s=t.read.source;if("string"==typeof s){if(s===e)return!0;if(s.indexOf(".")>-1&&0===s.indexOf(e)&&Ui(s,i))return!0}else for(const t of s){if(t===e)return!0;if(t.indexOf(".")>-1&&0===t.indexOf(e)&&Ui(t,i))return!0}return!1}function Zc(t,e,i,s,n){let r=vr(e[i],n);(function(t){return t&&(!t.read||!1!==t.read.enabled&&!t.read.source)})(r)&&(t[i]=!0);for(const o of Object.getOwnPropertyNames(e))r=vr(e[o],n),Jc(r,i,s)&&(t[o]=!0)}function Qc(t,e,i,s){const n=br(i.metadatas[e],"any",s),r=n&&n.default;if(void 0===r)return;const o="function"==typeof r?r.call(t,e,s):r;void 0!==o&&i.set(e,o)}const Kc={origin:"service"};function Yc(t,e,i=Kc){if(!e||"object"!=typeof e)return;const s=Ci(t),n=s.metadatas,r={};for(const t of Object.getOwnPropertyNames(e))Zc(r,n,t,e,i);s.setDefaultOrigin(i.origin);for(const o of Object.getOwnPropertyNames(r)){const r=vr(n[o],i).read,a=r&&r.source;let l;l=a&&"string"==typeof a?zi(e,a):e[o],r&&r.reader&&(l=r.reader.call(t,l,e,i)),void 0!==l&&s.set(o,l)}if(!i||!i.ignoreDefaults)for(const e of Object.getOwnPropertyNames(n))r[e]||Qc(t,e,s,i);s.setDefaultOrigin("user")}function Xc(t,e,i,s=Kc){var n;const r={...s,messages:[]};i(r),null==(n=r.messages)||n.forEach((e=>{"warning"!==e.type||t.loaded?s&&s.messages&&s.messages.push(e):t.loadWarnings.push(e)}))}const th=ct.getLogger("esri.core.accessorSupport.write");function eh(t,e,i,s,n){var r,o;const a={};return null==(r=e.write)||null==(o=r.writer)||o.call(t,s,a,i,n),a}function ih(t,e,i,s,n,r){if(!s||!s.write)return!1;const o=t.get(i);if(!n&&s.write.overridePolicy){const e=s.write.overridePolicy.call(t,o,i,r);void 0!==e&&(n=e)}if(n||(n=s.write),!n||!1===n.enabled)return!1;if((null===o&&!n.allowNull&&!n.writerEnsuresNonNull||void 0===o)&&n.isRequired){const e=new dt("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return e&&r&&r.messages?r.messages.push(e):e&&!r&&th.error(e.name,e.message),!1}return!(void 0===o||null===o&&!n.allowNull&&!n.writerEnsuresNonNull||function(t,e,i,s,n){const r=s.default;return void 0!==r&&(null!=s.defaultEquals?s.defaultEquals(n):"function"==typeof r?!!Array.isArray(n)&&T(r.call(t,e,i),n):r===n)}(t,i,r,s,o)||void 0===s.default&&!n.ignoreOrigin&&r&&r.origin&&e.store.originOf(i)<ds(r.origin))}function sh(t,e,i,s){const n=Ci(t),r=wr(n.metadatas[e],s);return!!r&&ih(t,n,e,r,i,s)}function nh(t,e,i){if(t&&"function"==typeof t.toJSON&&(!t.toJSON.isDefaultToJSON||!t.write))return Pi(e,t.toJSON());const s=Ci(t),n=s.metadatas;for(const a in n){const l=wr(n[a],i);if(!ih(t,s,a,l,void 0,i))continue;const u=t.get(a),c=eh(t,l,l.write&&"string"==typeof l.write.target?l.write.target:a,u,i);var r,o;Object.keys(c).length>0&&(e=Pi(e,c),null!=i&&null!=(r=i.resources)&&null!=(o=r.pendingOperations)&&o.length&&Promise.all(i.resources.pendingOperations).then((()=>Pi(e,c))),i&&i.writtenProperties&&i.writtenProperties.push({target:t,propName:a,oldOrigin:ps(s.store.originOf(a)),newOrigin:i.origin}))}return e}const rh=t=>{let i=class extends t{constructor(...t){super(...t)}read(t,e){Yc(this,t,e)}write(t={},e){return nh(this,t,e)}toJSON(t){return this.write({},t)}static fromJSON(t,e){return oh.call(this,t,e)}};return i=e([_r("esri.core.JSONSupport")],i),i.prototype.toJSON.isDefaultToJSON=!0,i};function oh(t,e){if(!t)return null;if(t.declaredClass)throw Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}let ah,lh=class extends(rh(Ar)){};function uh(t){return c(t)?Je():t.then((t=>({ok:!0,value:t}))).catch((t=>({ok:!1,error:t})))}function ch(t){return t.then((t=>({ok:!0,value:t}))).catch((t=>(Ne(t),{ok:!1,error:t})))}async function hh(t,e){return await t.load(),dh(t,e)}async function dh(t,e){const i=[],s=(...t)=>{for(const e of t)c(e)||(Array.isArray(e)?s(...e):Jr.isCollection(e)?e.forEach((t=>s(t))):Bc.isLoadable(e)&&i.push(e))};e(s);let n=null;if(await function(t,e){return Be(t.map((t=>e(t)))).then((t=>t.map((t=>t.value))))}(i,(async t=>{!1!==(await uh(function(t){return"loadAll"in t&&"function"==typeof t.loadAll}(t)?t.loadAll():t.load())).ok||n||(n=t)})),n)throw n.loadError;return t}function fh(t,e,i){let s,n;return void 0===e?(n=t,s=[void 0]):"string"!=typeof e?(n=t,s=[void 0],i=e):(n=e,s=Array.isArray(t)?t:[t]),(t,e)=>{const r=t.constructor.prototype;for(const o of s){const s=Jn(t,o,n);s.write&&"object"==typeof s.write||(s.write={}),i&&(s.write.target=i),s.write.writer=r[e]}}}lh=e([_r("esri.core.JSONSupport")],lh);const ph={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(ah=2e3;ah<=2045;ah++)ph[ah]=0;for(ah=2056;ah<=2065;ah++)ph[ah]=0;for(ah=2067;ah<=2135;ah++)ph[ah]=0;for(ah=2137;ah<=2154;ah++)ph[ah]=0;for(ah=2161;ah<=2170;ah++)ph[ah]=0;for(ah=2172;ah<=2193;ah++)ph[ah]=0;for(ah=2195;ah<=2198;ah++)ph[ah]=0;for(ah=2200;ah<=2203;ah++)ph[ah]=0;for(ah=2205;ah<=2217;ah++)ph[ah]=0;for(ah=2222;ah<=2224;ah++)ph[ah]=1;for(ah=2225;ah<=2250;ah++)ph[ah]=2;for(ah=2251;ah<=2253;ah++)ph[ah]=1;for(ah=2257;ah<=2264;ah++)ph[ah]=2;for(ah=2274;ah<=2279;ah++)ph[ah]=2;for(ah=2280;ah<=2282;ah++)ph[ah]=1;for(ah=2283;ah<=2289;ah++)ph[ah]=2;for(ah=2290;ah<=2292;ah++)ph[ah]=0;for(ah=2308;ah<=2313;ah++)ph[ah]=0;for(ah=2315;ah<=2491;ah++)ph[ah]=0;for(ah=2494;ah<=2866;ah++)ph[ah]=0;for(ah=2867;ah<=2869;ah++)ph[ah]=1;for(ah=2870;ah<=2888;ah++)ph[ah]=2;for(ah=2891;ah<=2895;ah++)ph[ah]=2;for(ah=2896;ah<=2898;ah++)ph[ah]=1;for(ah=2902;ah<=2908;ah++)ph[ah]=2;for(ah=2915;ah<=2920;ah++)ph[ah]=2;for(ah=2921;ah<=2923;ah++)ph[ah]=1;for(ah=2924;ah<=2930;ah++)ph[ah]=2;for(ah=2931;ah<=2962;ah++)ph[ah]=0;for(ah=2964;ah<=2968;ah++)ph[ah]=2;for(ah=2969;ah<=2973;ah++)ph[ah]=0;for(ah=2975;ah<=2991;ah++)ph[ah]=0;for(ah=2995;ah<=3051;ah++)ph[ah]=0;for(ah=3054;ah<=3079;ah++)ph[ah]=0;for(ah=3081;ah<=3088;ah++)ph[ah]=0;for(ah=3092;ah<=3101;ah++)ph[ah]=0;for(ah=3106;ah<=3138;ah++)ph[ah]=0;for(ah=3146;ah<=3151;ah++)ph[ah]=0;for(ah=3153;ah<=3166;ah++)ph[ah]=0;for(ah=3168;ah<=3172;ah++)ph[ah]=0;for(ah=3174;ah<=3203;ah++)ph[ah]=0;for(ah=3294;ah<=3358;ah++)ph[ah]=0;for(ah=3367;ah<=3403;ah++)ph[ah]=0;for(ah=3408;ah<=3416;ah++)ph[ah]=0;for(ah=3417;ah<=3438;ah++)ph[ah]=2;for(ah=3441;ah<=3446;ah++)ph[ah]=2;for(ah=3447;ah<=3450;ah++)ph[ah]=0;for(ah=3451;ah<=3459;ah++)ph[ah]=2;for(ah=3460;ah<=3478;ah++)ph[ah]=0;for(ah=3554;ah<=3559;ah++)ph[ah]=0;for(ah=3560;ah<=3570;ah++)ph[ah]=2;for(ah=3571;ah<=3581;ah++)ph[ah]=0;for(ah=3594;ah<=3597;ah++)ph[ah]=0;for(ah=3601;ah<=3604;ah++)ph[ah]=0;for(ah=3637;ah<=3639;ah++)ph[ah]=0;for(ah=3665;ah<=3667;ah++)ph[ah]=0;for(ah=3693;ah<=3695;ah++)ph[ah]=0;for(ah=3701;ah<=3727;ah++)ph[ah]=0;for(ah=3728;ah<=3739;ah++)ph[ah]=2;for(ah=3740;ah<=3751;ah++)ph[ah]=0;for(ah=3753;ah<=3760;ah++)ph[ah]=2;for(ah=3761;ah<=3773;ah++)ph[ah]=0;for(ah=3775;ah<=3777;ah++)ph[ah]=0;for(ah=3779;ah<=3781;ah++)ph[ah]=0;for(ah=3783;ah<=3785;ah++)ph[ah]=0;for(ah=3788;ah<=3791;ah++)ph[ah]=0;for(ah=3797;ah<=3802;ah++)ph[ah]=0;for(ah=3814;ah<=3816;ah++)ph[ah]=0;for(ah=3825;ah<=3829;ah++)ph[ah]=0;for(ah=3832;ah<=3841;ah++)ph[ah]=0;for(ah=3844;ah<=3852;ah++)ph[ah]=0;for(ah=3873;ah<=3885;ah++)ph[ah]=0;for(ah=3890;ah<=3893;ah++)ph[ah]=0;for(ah=3907;ah<=3912;ah++)ph[ah]=0;for(ah=3942;ah<=3950;ah++)ph[ah]=0;for(ah=3968;ah<=3970;ah++)ph[ah]=0;for(ah=3973;ah<=3976;ah++)ph[ah]=0;for(ah=3986;ah<=3989;ah++)ph[ah]=0;for(ah=3994;ah<=3997;ah++)ph[ah]=0;for(ah=4048;ah<=4051;ah++)ph[ah]=0;for(ah=4056;ah<=4063;ah++)ph[ah]=0;for(ah=4093;ah<=4096;ah++)ph[ah]=0;for(ah=4390;ah<=4398;ah++)ph[ah]=0;for(ah=4399;ah<=4413;ah++)ph[ah]=2;for(ah=4418;ah<=4433;ah++)ph[ah]=2;for(ah=4455;ah<=4457;ah++)ph[ah]=2;for(ah=4484;ah<=4489;ah++)ph[ah]=0;for(ah=4491;ah<=4554;ah++)ph[ah]=0;for(ah=4568;ah<=4589;ah++)ph[ah]=0;for(ah=4652;ah<=4656;ah++)ph[ah]=0;for(ah=4766;ah<=4800;ah++)ph[ah]=0;for(ah=5014;ah<=5016;ah++)ph[ah]=0;for(ah=5069;ah<=5072;ah++)ph[ah]=0;for(ah=5105;ah<=5130;ah++)ph[ah]=0;for(ah=5173;ah<=5188;ah++)ph[ah]=0;for(ah=5253;ah<=5259;ah++)ph[ah]=0;for(ah=5269;ah<=5275;ah++)ph[ah]=0;for(ah=5292;ah<=5311;ah++)ph[ah]=0;for(ah=5329;ah<=5331;ah++)ph[ah]=0;for(ah=5343;ah<=5349;ah++)ph[ah]=0;for(ah=5355;ah<=5357;ah++)ph[ah]=0;for(ah=5387;ah<=5389;ah++)ph[ah]=0;for(ah=5459;ah<=5463;ah++)ph[ah]=0;for(ah=5479;ah<=5482;ah++)ph[ah]=0;for(ah=5518;ah<=5520;ah++)ph[ah]=0;for(ah=5530;ah<=5539;ah++)ph[ah]=0;for(ah=5550;ah<=5552;ah++)ph[ah]=0;for(ah=5562;ah<=5583;ah++)ph[ah]=0;for(ah=5623;ah<=5625;ah++)ph[ah]=2;for(ah=5631;ah<=5639;ah++)ph[ah]=0;for(ah=5649;ah<=5653;ah++)ph[ah]=0;for(ah=5663;ah<=5680;ah++)ph[ah]=0;for(ah=5682;ah<=5685;ah++)ph[ah]=0;for(ah=5875;ah<=5877;ah++)ph[ah]=0;for(ah=5896;ah<=5899;ah++)ph[ah]=0;for(ah=5921;ah<=5940;ah++)ph[ah]=0;for(ah=6050;ah<=6125;ah++)ph[ah]=0;for(ah=6244;ah<=6275;ah++)ph[ah]=0;for(ah=6328;ah<=6348;ah++)ph[ah]=0;for(ah=6350;ah<=6356;ah++)ph[ah]=0;for(ah=6366;ah<=6372;ah++)ph[ah]=0;for(ah=6381;ah<=6387;ah++)ph[ah]=0;for(ah=6393;ah<=6404;ah++)ph[ah]=0;for(ah=6480;ah<=6483;ah++)ph[ah]=0;for(ah=6511;ah<=6514;ah++)ph[ah]=0;for(ah=6579;ah<=6581;ah++)ph[ah]=0;for(ah=6619;ah<=6624;ah++)ph[ah]=0;for(ah=6625;ah<=6627;ah++)ph[ah]=2;for(ah=6628;ah<=6632;ah++)ph[ah]=0;for(ah=6634;ah<=6637;ah++)ph[ah]=0;for(ah=6669;ah<=6692;ah++)ph[ah]=0;for(ah=6707;ah<=6709;ah++)ph[ah]=0;for(ah=6720;ah<=6723;ah++)ph[ah]=0;for(ah=6732;ah<=6738;ah++)ph[ah]=0;for(ah=6931;ah<=6933;ah++)ph[ah]=0;for(ah=6956;ah<=6959;ah++)ph[ah]=0;for(ah=7005;ah<=7007;ah++)ph[ah]=0;for(ah=7057;ah<=7070;ah++)ph[ah]=2;for(ah=7074;ah<=7082;ah++)ph[ah]=0;for(ah=7109;ah<=7118;ah++)ph[ah]=0;for(ah=7119;ah<=7127;ah++)ph[ah]=1;for(ah=7374;ah<=7376;ah++)ph[ah]=0;for(ah=7528;ah<=7586;ah++)ph[ah]=0;for(ah=7587;ah<=7645;ah++)ph[ah]=2;for(ah=7692;ah<=7696;ah++)ph[ah]=0;for(ah=7755;ah<=7787;ah++)ph[ah]=0;for(ah=7791;ah<=7795;ah++)ph[ah]=0;for(ah=7799;ah<=7801;ah++)ph[ah]=0;for(ah=7803;ah<=7805;ah++)ph[ah]=0;for(ah=7825;ah<=7831;ah++)ph[ah]=0;for(ah=7845;ah<=7859;ah++)ph[ah]=0;for(ah=8013;ah<=8032;ah++)ph[ah]=0;for(ah=8065;ah<=8068;ah++)ph[ah]=1;for(ah=8518;ah<=8529;ah++)ph[ah]=2;for(ah=8533;ah<=8536;ah++)ph[ah]=2;for(ah=8538;ah<=8540;ah++)ph[ah]=2;for(ah=8677;ah<=8679;ah++)ph[ah]=0;for(ah=8836;ah<=8840;ah++)ph[ah]=0;for(ah=8857;ah<=8859;ah++)ph[ah]=0;for(ah=8908;ah<=8910;ah++)ph[ah]=0;for(ah=9154;ah<=9159;ah++)ph[ah]=0;for(ah=9205;ah<=9218;ah++)ph[ah]=0;for(ah=9271;ah<=9273;ah++)ph[ah]=0;for(ah=9295;ah<=9297;ah++)ph[ah]=0;for(ah=9356;ah<=9360;ah++)ph[ah]=0;for(ah=9404;ah<=9407;ah++)ph[ah]=0;for(ah=9476;ah<=9482;ah++)ph[ah]=0;for(ah=9487;ah<=9494;ah++)ph[ah]=0;for(ah=9697;ah<=9699;ah++)ph[ah]=0;for(ah=20002;ah<=20032;ah++)ph[ah]=0;for(ah=20062;ah<=20092;ah++)ph[ah]=0;for(ah=20135;ah<=20138;ah++)ph[ah]=0;for(ah=20248;ah<=20258;ah++)ph[ah]=0;for(ah=20348;ah<=20358;ah++)ph[ah]=0;for(ah=20436;ah<=20440;ah++)ph[ah]=0;for(ah=20822;ah<=20824;ah++)ph[ah]=0;for(ah=20934;ah<=20936;ah++)ph[ah]=0;for(ah=21035;ah<=21037;ah++)ph[ah]=0;for(ah=21095;ah<=21097;ah++)ph[ah]=0;for(ah=21148;ah<=21150;ah++)ph[ah]=0;for(ah=21413;ah<=21423;ah++)ph[ah]=0;for(ah=21453;ah<=21463;ah++)ph[ah]=0;for(ah=21473;ah<=21483;ah++)ph[ah]=0;for(ah=21780;ah<=21782;ah++)ph[ah]=0;for(ah=21891;ah<=21894;ah++)ph[ah]=0;for(ah=21896;ah<=21899;ah++)ph[ah]=0;for(ah=22171;ah<=22177;ah++)ph[ah]=0;for(ah=22181;ah<=22187;ah++)ph[ah]=0;for(ah=22191;ah<=22197;ah++)ph[ah]=0;for(ah=22234;ah<=22236;ah++)ph[ah]=0;for(ah=22521;ah<=22525;ah++)ph[ah]=0;for(ah=22991;ah<=22994;ah++)ph[ah]=0;for(ah=23028;ah<=23038;ah++)ph[ah]=0;for(ah=23830;ah<=23853;ah++)ph[ah]=0;for(ah=23866;ah<=23872;ah++)ph[ah]=0;for(ah=23877;ah<=23884;ah++)ph[ah]=0;for(ah=23886;ah<=23894;ah++)ph[ah]=0;for(ah=23946;ah<=23948;ah++)ph[ah]=0;for(ah=24311;ah<=24313;ah++)ph[ah]=0;for(ah=24342;ah<=24347;ah++)ph[ah]=0;for(ah=24370;ah<=24374;ah++)ph[ah]=10;for(ah=24375;ah<=24381;ah++)ph[ah]=0;for(ah=24718;ah<=24721;ah++)ph[ah]=0;for(ah=24817;ah<=24821;ah++)ph[ah]=0;for(ah=24877;ah<=24882;ah++)ph[ah]=0;for(ah=24891;ah<=24893;ah++)ph[ah]=0;for(ah=25391;ah<=25395;ah++)ph[ah]=0;for(ah=25828;ah<=25838;ah++)ph[ah]=0;for(ah=26191;ah<=26195;ah++)ph[ah]=0;for(ah=26391;ah<=26393;ah++)ph[ah]=0;for(ah=26701;ah<=26722;ah++)ph[ah]=0;for(ah=26729;ah<=26799;ah++)ph[ah]=2;for(ah=26801;ah<=26803;ah++)ph[ah]=2;for(ah=26811;ah<=26813;ah++)ph[ah]=2;for(ah=26847;ah<=26870;ah++)ph[ah]=2;for(ah=26891;ah<=26899;ah++)ph[ah]=0;for(ah=26901;ah<=26923;ah++)ph[ah]=0;for(ah=26929;ah<=26946;ah++)ph[ah]=0;for(ah=26948;ah<=26998;ah++)ph[ah]=0;for(ah=27037;ah<=27040;ah++)ph[ah]=0;for(ah=27205;ah<=27232;ah++)ph[ah]=0;for(ah=27258;ah<=27260;ah++)ph[ah]=0;for(ah=27391;ah<=27398;ah++)ph[ah]=0;for(ah=27561;ah<=27564;ah++)ph[ah]=0;for(ah=27571;ah<=27574;ah++)ph[ah]=0;for(ah=27581;ah<=27584;ah++)ph[ah]=0;for(ah=27591;ah<=27594;ah++)ph[ah]=0;for(ah=28191;ah<=28193;ah++)ph[ah]=0;for(ah=28348;ah<=28358;ah++)ph[ah]=0;for(ah=28402;ah<=28432;ah++)ph[ah]=0;for(ah=28462;ah<=28492;ah++)ph[ah]=0;for(ah=29118;ah<=29122;ah++)ph[ah]=0;for(ah=29168;ah<=29172;ah++)ph[ah]=0;for(ah=29177;ah<=29185;ah++)ph[ah]=0;for(ah=29187;ah<=29195;ah++)ph[ah]=0;for(ah=29900;ah<=29903;ah++)ph[ah]=0;for(ah=30161;ah<=30179;ah++)ph[ah]=0;for(ah=30491;ah<=30494;ah++)ph[ah]=0;for(ah=30729;ah<=30732;ah++)ph[ah]=0;for(ah=31251;ah<=31259;ah++)ph[ah]=0;for(ah=31265;ah<=31268;ah++)ph[ah]=0;for(ah=31275;ah<=31279;ah++)ph[ah]=0;for(ah=31281;ah<=31297;ah++)ph[ah]=0;for(ah=31461;ah<=31469;ah++)ph[ah]=0;for(ah=31491;ah<=31495;ah++)ph[ah]=0;for(ah=31917;ah<=31922;ah++)ph[ah]=0;for(ah=31965;ah<=32e3;ah++)ph[ah]=0;for(ah=32001;ah<=32003;ah++)ph[ah]=2;for(ah=32005;ah<=32031;ah++)ph[ah]=2;for(ah=32033;ah<=32060;ah++)ph[ah]=2;for(ah=32064;ah<=32067;ah++)ph[ah]=2;for(ah=32074;ah<=32077;ah++)ph[ah]=2;for(ah=32081;ah<=32086;ah++)ph[ah]=0;for(ah=32107;ah<=32130;ah++)ph[ah]=0;for(ah=32133;ah<=32158;ah++)ph[ah]=0;for(ah=32164;ah<=32167;ah++)ph[ah]=2;for(ah=32180;ah<=32199;ah++)ph[ah]=0;for(ah=32201;ah<=32260;ah++)ph[ah]=0;for(ah=32301;ah<=32360;ah++)ph[ah]=0;for(ah=32601;ah<=32662;ah++)ph[ah]=0;for(ah=32664;ah<=32667;ah++)ph[ah]=2;for(ah=32701;ah<=32761;ah++)ph[ah]=0;for(ah=53001;ah<=53004;ah++)ph[ah]=0;for(ah=53008;ah<=53019;ah++)ph[ah]=0;for(ah=53021;ah<=53032;ah++)ph[ah]=0;for(ah=53034;ah<=53037;ah++)ph[ah]=0;for(ah=53042;ah<=53046;ah++)ph[ah]=0;for(ah=53074;ah<=53080;ah++)ph[ah]=0;for(ah=54001;ah<=54004;ah++)ph[ah]=0;for(ah=54008;ah<=54019;ah++)ph[ah]=0;for(ah=54021;ah<=54032;ah++)ph[ah]=0;for(ah=54034;ah<=54037;ah++)ph[ah]=0;for(ah=54042;ah<=54046;ah++)ph[ah]=0;for(ah=54048;ah<=54053;ah++)ph[ah]=0;for(ah=54074;ah<=54080;ah++)ph[ah]=0;for(ah=54098;ah<=54101;ah++)ph[ah]=0;for(ah=102001;ah<=102040;ah++)ph[ah]=0;for(ah=102042;ah<=102063;ah++)ph[ah]=0;for(ah=102065;ah<=102067;ah++)ph[ah]=0;for(ah=102070;ah<=102117;ah++)ph[ah]=0;for(ah=102122;ah<=102216;ah++)ph[ah]=0;for(ah=102221;ah<=102377;ah++)ph[ah]=0;for(ah=102382;ah<=102388;ah++)ph[ah]=0;for(ah=102389;ah<=102398;ah++)ph[ah]=2;for(ah=102399;ah<=102444;ah++)ph[ah]=0;for(ah=102445;ah<=102447;ah++)ph[ah]=2;for(ah=102448;ah<=102458;ah++)ph[ah]=0;for(ah=102459;ah<=102468;ah++)ph[ah]=2;for(ah=102469;ah<=102499;ah++)ph[ah]=0;for(ah=102500;ah<=102519;ah++)ph[ah]=1;for(ah=102520;ah<=102524;ah++)ph[ah]=0;for(ah=102525;ah<=102529;ah++)ph[ah]=2;for(ah=102530;ah<=102588;ah++)ph[ah]=0;for(ah=102590;ah<=102598;ah++)ph[ah]=0;for(ah=102601;ah<=102603;ah++)ph[ah]=0;for(ah=102605;ah<=102628;ah++)ph[ah]=0;for(ah=102629;ah<=102646;ah++)ph[ah]=2;for(ah=102648;ah<=102700;ah++)ph[ah]=2;for(ah=102701;ah<=102703;ah++)ph[ah]=0;for(ah=102707;ah<=102730;ah++)ph[ah]=2;for(ah=102733;ah<=102758;ah++)ph[ah]=2;for(ah=102767;ah<=102900;ah++)ph[ah]=0;for(ah=102965;ah<=102969;ah++)ph[ah]=0;for(ah=102971;ah<=102973;ah++)ph[ah]=0;for(ah=102975;ah<=102989;ah++)ph[ah]=0;for(ah=102990;ah<=102992;ah++)ph[ah]=1;for(ah=102997;ah<=103002;ah++)ph[ah]=0;for(ah=103003;ah<=103008;ah++)ph[ah]=2;for(ah=103009;ah<=103011;ah++)ph[ah]=0;for(ah=103012;ah<=103014;ah++)ph[ah]=2;for(ah=103019;ah<=103021;ah++)ph[ah]=0;for(ah=103022;ah<=103024;ah++)ph[ah]=2;for(ah=103029;ah<=103031;ah++)ph[ah]=0;for(ah=103032;ah<=103034;ah++)ph[ah]=2;for(ah=103065;ah<=103068;ah++)ph[ah]=0;for(ah=103074;ah<=103076;ah++)ph[ah]=0;for(ah=103077;ah<=103079;ah++)ph[ah]=1;for(ah=103080;ah<=103082;ah++)ph[ah]=0;for(ah=103083;ah<=103085;ah++)ph[ah]=2;for(ah=103090;ah<=103093;ah++)ph[ah]=0;for(ah=103097;ah<=103099;ah++)ph[ah]=0;for(ah=103100;ah<=103102;ah++)ph[ah]=2;for(ah=103107;ah<=103109;ah++)ph[ah]=0;for(ah=103110;ah<=103112;ah++)ph[ah]=2;for(ah=103113;ah<=103116;ah++)ph[ah]=0;for(ah=103117;ah<=103120;ah++)ph[ah]=2;for(ah=103153;ah<=103157;ah++)ph[ah]=0;for(ah=103158;ah<=103162;ah++)ph[ah]=2;for(ah=103163;ah<=103165;ah++)ph[ah]=0;for(ah=103166;ah<=103168;ah++)ph[ah]=1;for(ah=103169;ah<=103171;ah++)ph[ah]=2;for(ah=103186;ah<=103188;ah++)ph[ah]=0;for(ah=103189;ah<=103191;ah++)ph[ah]=2;for(ah=103192;ah<=103195;ah++)ph[ah]=0;for(ah=103196;ah<=103199;ah++)ph[ah]=2;for(ah=103200;ah<=103224;ah++)ph[ah]=0;for(ah=103225;ah<=103227;ah++)ph[ah]=1;for(ah=103232;ah<=103237;ah++)ph[ah]=0;for(ah=103238;ah<=103243;ah++)ph[ah]=2;for(ah=103244;ah<=103246;ah++)ph[ah]=0;for(ah=103247;ah<=103249;ah++)ph[ah]=2;for(ah=103254;ah<=103256;ah++)ph[ah]=0;for(ah=103257;ah<=103259;ah++)ph[ah]=2;for(ah=103264;ah<=103266;ah++)ph[ah]=0;for(ah=103267;ah<=103269;ah++)ph[ah]=2;for(ah=103300;ah<=103375;ah++)ph[ah]=0;for(ah=103381;ah<=103383;ah++)ph[ah]=0;for(ah=103384;ah<=103386;ah++)ph[ah]=1;for(ah=103387;ah<=103389;ah++)ph[ah]=0;for(ah=103390;ah<=103392;ah++)ph[ah]=2;for(ah=103397;ah<=103399;ah++)ph[ah]=0;for(ah=103400;ah<=103471;ah++)ph[ah]=2;for(ah=103476;ah<=103478;ah++)ph[ah]=0;for(ah=103479;ah<=103481;ah++)ph[ah]=2;for(ah=103486;ah<=103488;ah++)ph[ah]=0;for(ah=103489;ah<=103491;ah++)ph[ah]=2;for(ah=103492;ah<=103495;ah++)ph[ah]=0;for(ah=103496;ah<=103499;ah++)ph[ah]=2;for(ah=103528;ah<=103543;ah++)ph[ah]=0;for(ah=103544;ah<=103548;ah++)ph[ah]=2;for(ah=103549;ah<=103551;ah++)ph[ah]=0;for(ah=103552;ah<=103554;ah++)ph[ah]=1;for(ah=103555;ah<=103557;ah++)ph[ah]=2;for(ah=103558;ah<=103560;ah++)ph[ah]=0;for(ah=103571;ah<=103573;ah++)ph[ah]=0;for(ah=103574;ah<=103576;ah++)ph[ah]=2;for(ah=103577;ah<=103580;ah++)ph[ah]=0;for(ah=103581;ah<=103583;ah++)ph[ah]=2;for(ah=103595;ah<=103694;ah++)ph[ah]=0;for(ah=103696;ah<=103699;ah++)ph[ah]=0;for(ah=103700;ah<=103793;ah++)ph[ah]=2;for(ah=103794;ah<=103872;ah++)ph[ah]=0;for(ah=103900;ah<=103971;ah++)ph[ah]=2;const yh={102113:!0,102100:!0,3857:!0,3785:!0},mh={102113:!0,102100:!0,3857:!0,3785:!0,4326:!0},gh='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',vh=[-20037508.342788905,20037508.342788905],wh=[-20037508.342787,20037508.342787],bh={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:vh,origin:wh,dx:1e-5},102100:{wkTemplate:gh,valid:vh,origin:wh,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:vh,origin:wh,dx:1e-5},3857:{wkTemplate:gh,valid:vh,origin:wh,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function Mh(t,e){return!c(t)&&!c(e)&&(t===e||(null!=t.wkid||null!=e.wkid?t.wkid===e.wkid||jh(t)&&jh(e)||null!=e.latestWkid&&t.wkid===e.latestWkid||null!=t.latestWkid&&e.wkid===t.latestWkid:!(!t.wkt||!e.wkt)&&t.wkt.toUpperCase()===e.wkt.toUpperCase()))}function Sh(t){return Fh(t)&&t.wkid?bh[t.wkid]:null}function xh(t){return!!Fh(t)&&(t.wkid?null==ph[t.wkid]:!!t.wkt&&!!/^\s*GEOGCS/i.test(t.wkt))}function kh(t){return Fh(t)&&4326===t.wkid}function Ih(t){return Fh(t)&&4490===t.wkid}function jh(t){return Fh(t)&&null!=t.wkid&&!0===yh[t.wkid]}function _h(t){return 104971===t||104905===t}function Th(t){return Fh(t)&&null!=t.wkid&&_h(t.wkid)}function Oh(t){return 104903===t}function Ah(t){return Fh(t)&&null!=t.wkid&&Oh(t.wkid)}function Fh(t){return u(t)&&(null!=t.wkid&&t.wkid>=2e3||null!=t.wkt)}const Ch={wkid:4326,wkt:rt(bh[4326].wkTemplate,{Central_Meridian:"0.0"})};var Ph;let Eh=Ph=class extends lh{constructor(t){super(t),this.latestWkid=null,this.wkid=null,this.wkt=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}static fromJSON(t){if(!t)return null;if(t.wkid){if(102100===t.wkid)return Ph.WebMercator;if(4326===t.wkid)return Ph.WGS84}const e=new Ph;return e.read(t),e}normalizeCtorArgs(t){return t&&"object"==typeof t?t:{["string"==typeof t?"wkt":"wkid"]:t}}get isWGS84(){return kh(this)}get isWebMercator(){return jh(this)}get isGeographic(){return xh(this)}get isWrappable(){return function(t){return Fh(t)&&null!=t.wkid&&!0===mh[t.wkid]}(this)}writeWkt(t,e){this.wkid||(e.wkt=t)}clone(){if(this===Ph.WGS84)return Ph.WGS84;if(this===Ph.WebMercator)return Ph.WebMercator;const t=new Ph;return null!=this.wkid?(t.wkid=this.wkid,null!=this.latestWkid&&(t.latestWkid=this.latestWkid),null!=this.vcsWkid&&(t.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(t.latestVcsWkid=this.latestVcsWkid)):null!=this.wkt&&(t.wkt=this.wkt),this.imageCoordinateSystem&&(t.imageCoordinateSystem=H(this.imageCoordinateSystem)),t}equals(t){if(null==t)return!1;if(this.imageCoordinateSystem||t.imageCoordinateSystem){if(null==this.imageCoordinateSystem||null==t.imageCoordinateSystem)return!1;const{id:e,referenceServiceName:i}=t.imageCoordinateSystem,{geodataXform:s}=t.imageCoordinateSystem,n=this.imageCoordinateSystem;return null==e||s?JSON.stringify(n)===JSON.stringify(t.imageCoordinateSystem):i?n.id===e&&n.referenceServiceName===i:n.id===e}return Mh(this,t)}toJSON(t){return this.write(void 0,t)}};Eh.GCS_NAD_1927=null,Eh.WGS84=null,Eh.WebMercator=null,Eh.PlateCarree=null,e([Hn({readOnly:!0})],Eh.prototype,"isWGS84",null),e([Hn({readOnly:!0})],Eh.prototype,"isWebMercator",null),e([Hn({readOnly:!0})],Eh.prototype,"isGeographic",null),e([Hn({readOnly:!0})],Eh.prototype,"isWrappable",null),e([Hn({type:Gn,json:{write:!0}})],Eh.prototype,"latestWkid",void 0),e([Hn({type:Gn,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:null===this.wkt}}}}}}})],Eh.prototype,"wkid",void 0),e([Hn({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:null===this.wkid}}}}}}})],Eh.prototype,"wkt",void 0),e([fh("wkt"),fh("web-scene","wkt")],Eh.prototype,"writeWkt",null),e([Hn({type:Gn,json:{write:!0}})],Eh.prototype,"vcsWkid",void 0),e([Hn({type:Gn,json:{write:!0}})],Eh.prototype,"latestVcsWkid",void 0),e([Hn()],Eh.prototype,"imageCoordinateSystem",void 0),Eh=Ph=e([_r("esri.geometry.SpatialReference")],Eh),Eh.prototype.toJSON.isDefaultToJSON=!0,Eh.GCS_NAD_1927=new Eh({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),Eh.WGS84=new Eh(Ch),Eh.WebMercator=new Eh({wkid:102100,latestWkid:3857}),Eh.PlateCarree=new Eh({wkid:32662}),Object.freeze&&(Object.freeze(Eh.GCS_NAD_1927),Object.freeze(Eh.WGS84),Object.freeze(Eh.WebMercator));const Lh=Eh;function Rh(t,e,i){let s,n;return void 0===e||Array.isArray(e)?(n=t,i=e,s=[void 0]):(n=e,s=Array.isArray(t)?t:[t]),(t,e)=>{const r=t.constructor.prototype;s.forEach((s=>{const o=Jn(t,s,n);o.read&&"object"==typeof o.read||(o.read={}),o.read.reader=r[e],i&&(o.read.source=(o.read.source||[]).concat(i))}))}}let Nh=class extends lh{constructor(...t){super(...t),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=Lh.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(t,e){if(t instanceof Lh)return t;if(null!=t){const i=new Lh;return i.read(t,e),i}return t}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(t){return this.cache[t]}setCacheValue(t,e){this.cache[t]=e}};e([Hn()],Nh.prototype,"type",void 0),e([Hn({readOnly:!0})],Nh.prototype,"cache",null),e([Hn({readOnly:!0})],Nh.prototype,"extent",null),e([Hn({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Nh.prototype,"hasM",void 0),e([Hn({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],Nh.prototype,"hasZ",void 0),e([Hn({type:Lh,json:{write:!0}})],Nh.prototype,"spatialReference",void 0),e([Rh("spatialReference")],Nh.prototype,"readSpatialReference",null),Nh=e([_r("esri.geometry.Geometry")],Nh);const Dh=Nh;class Vh{constructor(t,e,i,s){this.semiMajorAxis=t,this.flattening=e,this.outerAtmosphereRimWidth=i,this.semiMinorAxis=this.semiMajorAxis*(1-this.flattening),this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=s||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}}const $h=new Vh(6378137,1/298.257223563,3e5,.006694379990137799),zh=new Vh(3396190,1/169.8944472236118,23e4),Gh=new Vh(1737400,0,0);function Uh(t){return 57.29577951308232*t}function qh(t){return.017453292519943*t}function Bh(t){return t/$h.radius}function Wh(t){return Math.PI/2-2*Math.atan(Math.exp(-t/$h.radius))}function Hh(t){return null!=t.wkid||null!=t.wkt}const Jh=[0,0];function Zh(t,e,i,s,n){const r=t,o=n;if(o.spatialReference=i,"x"in r&&"x"in o)[o.x,o.y]=e(r.x,r.y,Jh,s);else if("xmin"in r&&"xmin"in o)[o.xmin,o.ymin]=e(r.xmin,r.ymin,Jh,s),[o.xmax,o.ymax]=e(r.xmax,r.ymax,Jh,s);else if("paths"in r&&"paths"in o||"rings"in r&&"rings"in o){const t="paths"in r?r.paths:r.rings,i=[];let n;for(let r=0;r<t.length;r++){const o=t[r];n=[],i.push(n);for(let t=0;t<o.length;t++)n.push(e(o[t][0],o[t][1],[0,0],s)),o[t].length>2&&n[t].push(o[t][2]),o[t].length>3&&n[t].push(o[t][3])}"paths"in o?o.paths=i:o.rings=i}else if("points"in r&&"points"in o){const t=r.points,i=[];for(let n=0;n<t.length;n++)i[n]=e(t[n][0],t[n][1],[0,0],s),t[n].length>2&&i[n].push(t[n][2]),t[n].length>3&&i[n].push(t[n][3]);o.points=i}return n}function Qh(t,e){const i=t&&(Hh(t)?t:t.spatialReference),s=e&&(Hh(e)?e:e.spatialReference);return!(t&&"type"in t&&"mesh"===t.type||e&&"type"in e&&"mesh"===e.type||!i||!s)&&(!!Mh(s,i)||jh(s)&&kh(i)||jh(i)&&kh(s))}function Kh(t,e){if(c(t))return null;const i=t.spatialReference,s=e&&(Hh(e)?e:e.spatialReference);return Qh(i,s)?Mh(i,s)?H(t):jh(s)?Zh(t,Yh,Lh.WebMercator,!1,H(t)):kh(s)?Zh(t,Xh,Lh.WGS84,!1,H(t)):null:null}function Yh(t,e,i=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const s=qh(e);return i[0]=qh(t)*$h.radius,i[1]=$h.halfSemiMajorAxis*Math.log((1+Math.sin(s))/(1-Math.sin(s))),i}function Xh(t,e,i=[0,0],s=!1){const n=Uh(t/$h.radius);return i[0]=s?n:n-360*Math.floor((n+180)/360),i[1]=Uh(Math.PI/2-2*Math.atan(Math.exp(-e/$h.radius))),i}function td(t,e=!1,i=H(t)){return Zh(t,Yh,Lh.WebMercator,e,i)}function ed(t,e=!1,i=H(t)){return Zh(t,Xh,Lh.WGS84,e,i)}var id;const sd=[0,0];function nd(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}const rd=ct.getLogger("esri.geometry.Point");let od=id=class extends Dh{constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const i=t._get("spatialReference");e._set("spatialReference",Object.isFrozen(i)?i:i.clone())}normalizeCtorArgs(t,e,i,s,n){let r;if(Array.isArray(t))r=t,n=e,t=r[0],e=r[1],i=r[2],s=r[3];else if(t&&"object"==typeof t){if(r=t,t=null!=r.x?r.x:r.longitude,e=null!=r.y?r.y:r.latitude,i=r.z,s=r.m,(n=r.spatialReference)&&"esri.geometry.SpatialReference"!==n.declaredClass&&(n=new Lh(n)),null!=r.longitude||null!=r.latitude)if(null==r.longitude)rd.warn(".longitude=","Latitude was defined without longitude");else if(null==r.latitude)rd.warn(".latitude=","Longitude was defined without latitude");else if(!r.declaredClass&&n&&n.isWebMercator){const i=Yh(r.longitude,r.latitude,sd);t=i[0],e=i[1]}}else nd(i)?(n=i,i=null):nd(s)&&(n=s,s=null);const o={x:t,y:e};return null==o.x&&null!=o.y?rd.warn(".y=","Y coordinate was defined without an X coordinate"):null==o.y&&null!=o.x&&rd.warn(".x=","X coordinate was defined without a Y coordinate"),null!=n&&(o.spatialReference=n),null!=i&&(o.z=i),null!=s&&(o.m=s),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return void 0!==this.m}set hasM(t){t!==(void 0!==this._get("m"))&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return void 0!==this.z}set hasZ(t){t!==(void 0!==this._get("z"))&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){const{spatialReference:t,x:e,y:i}=this;if(t){if(t.isWebMercator)return Xh(e,i,sd)[1];if(t.isGeographic)return i}return null}set latitude(t){const{spatialReference:e,x:i}=this;e&&(e.isWebMercator?this._set("y",Yh(i,t,sd)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){const{x:t,y:e,spatialReference:i}=this;if(i){if(i.isWebMercator)return Xh(t,e,sd)[0];if(i.isGeographic)return t}return null}set longitude(t){const{y:e,spatialReference:i}=this;i&&(i.isWebMercator?this._set("x",Yh(t,e,sd)[0]):i.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,i){e[i]=isNaN(t)?"NaN":t}readX(t){return"string"==typeof t?NaN:t}clone(){const t=new id;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return id.copy(t,this),this}equals(t){if(!t)return!1;const{x:e,y:i,z:s,m:n,spatialReference:r}=this,{z:o,m:a}=t;let{x:l,y:u,spatialReference:c}=t;if(!r.equals(c))if(r.isWebMercator&&c.isWGS84)[l,u]=Yh(l,u),c=r;else{if(!r.isWGS84||!c.isWebMercator)return!1;[l,u]=Xh(l,u),c=r}return e===l&&i===u&&s===o&&n===a&&r.wkid===c.wkid}offset(t,e,i){return function(t,e,i,s){var n;return t.x=t.x+e,t.y=t.y+i,null!=s&&(t.z=(null!=(n=t.z)?n:0)+s),t}(this,t,e,i)}normalize(){if(!this.spatialReference)return this;const t=Sh(this.spatialReference);if(!t)return this;let e=this.x;const[i,s]=t.valid,n=2*s;let r;return e>s?(r=Math.ceil(Math.abs(e-s)/n),e-=r*n):e<i&&(r=Math.ceil(Math.abs(e-i)/n),e+=r*n),this._set("x",e),this}distance(t){return function(t,e){const i=t.x-e.x,s=t.y-e.y,n=t.hasZ&&e.hasZ?t.z-e.z:0;return Math.sqrt(i*i+s*s+n*n)}(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};e([Hn({readOnly:!0})],od.prototype,"cache",null),e([Hn({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],od.prototype,"hasM",null),e([Hn({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],od.prototype,"hasZ",null),e([Hn({type:Number})],od.prototype,"latitude",null),e([Hn({type:Number})],od.prototype,"longitude",null),e([Hn({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),xa((t=>isNaN(t)?t:kn(t)))],od.prototype,"x",void 0),e([fh("x")],od.prototype,"writeX",null),e([Rh("x")],od.prototype,"readX",null),e([Hn({type:Number,json:{write:!0}})],od.prototype,"y",void 0),e([Hn({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],od.prototype,"z",void 0),e([Hn({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],od.prototype,"m",void 0),od=id=e([_r("esri.geometry.Point")],od),od.prototype.toJSON.isDefaultToJSON=!0;const ad=od,ld=[0,0];function ud(t,e){return!!u(e)&&fd(t,e.x,e.y,e.z)}function cd(t,e){if(!e.points||e.points.length)return!1;for(const i of e.points)if(!hd(t,i))return!1;return!0}function hd(t,e){return fd(t,e[0],e[1])}function dd(t,e){return fd(t,e[0],e[1],e[2])}function fd(t,e,i,s){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax&&(null==s||!t.hasZ||s>=t.zmin&&s<=t.zmax)}function pd(t,e){return ld[1]=e.y,ld[0]=e.x,yd(t,ld)}function yd(t,e){return function(t,e){if(!t)return!1;if(function(t){return!Array.isArray(t[0][0])}(t))return md(!1,t,e);let i=!1;for(let s=0,n=t.length;s<n;s++)i=md(i,t[s],e);return i}(t.rings,e)}function md(t,e,i){const[s,n]=i;let r=t,o=0;for(let t=0,i=e.length;t<i;t++){o++,o===i&&(o=0);const[a,l]=e[t],[u,c]=e[o];(l<n&&c>=n||c<n&&l>=n)&&a+(n-l)/(c-l)*(u-a)<s&&(r=!r)}return r}function gd(t,e){return ud(t,e)}function vd(t,e){let i,s,n;if(t.xmin<=e.xmin){if(i=e.xmin,t.xmax<i)return!1}else if(i=t.xmin,e.xmax<i)return!1;if(t.ymin<=e.ymin){if(s=e.ymin,t.ymax<s)return!1}else if(s=t.ymin,e.ymax<s)return!1;if(t.hasZ&&e.hasZ&&e.hasZ)if(t.zmin<=e.zmin){if(n=e.zmin,t.zmax<n)return!1}else if(n=t.zmin,e.zmax<n)return!1;return!0}function wd(t,e){const{points:i,hasZ:s}=e,n=s?dd:hd;for(const e of i)if(n(t,e))return!0;return!1}const bd=[0,0],Md=[0,0],Sd=[0,0],xd=[0,0],kd=[bd,Md,Sd,xd],Id=[[Sd,bd],[bd,Md],[Md,xd],[xd,Sd]];function jd(t,e){bd[0]=t.xmin,bd[1]=t.ymax,Md[0]=t.xmax,Md[1]=t.ymax,Sd[0]=t.xmin,Sd[1]=t.ymin,xd[0]=t.xmax,xd[1]=t.ymin;for(const t of kd)if(yd(e,t))return!0;for(const i of e.rings){if(!i.length)continue;let e=i[0];if(hd(t,e))return!0;for(let s=1;s<i.length;s++){const n=i[s];if(hd(t,n)||Od(e,n,Id))return!0;e=n}}return!1}function _d(t,e){bd[0]=t.xmin,bd[1]=t.ymax,Md[0]=t.xmax,Md[1]=t.ymax,Sd[0]=t.xmin,Sd[1]=t.ymin,xd[0]=t.xmax,xd[1]=t.ymin;const i=e.paths;for(const e of i){if(!i.length)continue;let s=e[0];if(hd(t,s))return!0;for(let i=1;i<e.length;i++){const n=e[i];if(hd(t,n)||Od(s,n,Id))return!0;s=n}}return!1}const Td=[0,0];function Od(t,e,i){for(let s=0;s<i.length;s++)if(Ad(t,e,i[s][0],i[s][1]))return!0;return!1}function Ad(t,e,i,s,n){const[r,o]=t,[a,l]=e,[u,c]=i,[h,d]=s,f=h-u,p=r-u,y=a-r,m=d-c,g=o-c,v=l-o,w=m*y-f*v;if(0===w)return!1;const b=(f*g-m*p)/w,M=(y*g-v*p)/w;return b>=0&&b<=1&&M>=0&&M<=1&&(n&&(n[0]=r+b*(a-r),n[1]=o+b*(l-o)),!0)}function Fd(t){switch(t){case"esriGeometryEnvelope":case"extent":return vd;case"esriGeometryMultipoint":case"multipoint":return wd;case"esriGeometryPoint":case"point":return gd;case"esriGeometryPolygon":case"polygon":return jd;case"esriGeometryPolyline":case"polyline":return _d}}var Cd;function Pd(t,e,i){return null==e?i:null==i?e:t(e,i)}let Ed=Cd=class extends Dh{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,i,s,n){return function(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:"object"==typeof t?(t.spatialReference=null==t.spatialReference?Lh.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:s,spatialReference:null==n?Lh.WGS84:n}}static fromBounds(t,e){return new Cd({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}static fromPoint(t){return new Cd({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new ad({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return null!=this.mmin&&null!=this.mmax}get hasZ(){return null!=this.zmin&&null!=this.zmax}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return null!=t.z&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new Cd;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,null!=this.zmin&&(t.zmin=this.zmin,t.zmax=this.zmax),null!=this.mmin&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Qh(e,i)&&(t=e.isWebMercator?td(t):ed(t,!0)),"point"===t.type?ud(this,t):"extent"===t.type&&function(t,e){const{xmin:i,ymin:s,zmin:n,xmax:r,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?fd(t,i,s,n)&&fd(t,i,o,n)&&fd(t,r,o,n)&&fd(t,r,s,n)&&fd(t,i,s,a)&&fd(t,i,o,a)&&fd(t,r,o,a)&&fd(t,r,s,a):fd(t,i,s)&&fd(t,i,o)&&fd(t,r,o)&&fd(t,r,s)}(this,t)}equals(t){if(this===t)return!0;if(c(t))return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Qh(e,i)&&(t=e.isWebMercator?td(t):ed(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,s=this.height*e;if(this.xmin+=i,this.ymin+=s,this.xmax-=i,this.ymax-=s,this.hasZ){const t=(this.zmax-this.zmin)*e;this.zmin+=t,this.zmax-=t}if(this.hasM){const t=(this.mmax-this.mmin)*e;this.mmin+=t,this.mmax-=t}return this}intersects(t){if(c(t))return!1;"mesh"===t.type&&(t=t.extent);const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&Qh(e,i)&&(t=e.isWebMercator?td(t):ed(t,!0)),Fd(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,null!=i&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Pd(Math.min,this.zmin,t.zmin),this.zmax=Pd(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Pd(Math.min,this.mmin,t.mmin),this.mmax=Pd(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:c(t)||!this.intersects(t)?null:(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=Pd(Math.max,this.zmin,t.zmin),this.zmax=Pd(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=Pd(Math.max,this.mmin,t.mmin),this.mmax=Pd(Math.min,this.mmax,t.mmax)),this)}toJSON(t){return this.write({},t)}_shiftCM(t=Sh(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,i=this._getCM(t);if(i){const s=e.isWebMercator?ed(i):i;this.xmin-=i.x,this.xmax-=i.x,e.isWebMercator||(s.x=this._normalizeX(s.x,t).x),this.spatialReference=new Lh(rt(e.isWGS84?t.altTemplate:t.wkTemplate,{Central_Meridian:s.x}))}return this}_getCM(t){let e=null;const[i,s]=t.valid,n=this.xmin,r=this.xmax;return n>=i&&n<=s&&r>=i&&r<=s||(e=this.center),e}_normalize(t,e,i){const s=this.spatialReference;if(!s)return this;if(!(i=i||Sh(s)))return this;const n=this._getParts(i).map((t=>t.extent));if(n.length<2)return n[0]||this;if(n.length>2)return t?this._shiftCM(i):this.set({xmin:i.valid[0],xmax:i.valid[1]});if(t)return this._shiftCM(i);if(e)return n;let r=!0,o=!0;return n.forEach((t=>{t.hasZ||(r=!1),t.hasM||(o=!1)})),{rings:n.map((t=>{const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];if(r){const i=(t.zmax-t.zmin)/2;for(let t=0;t<e.length;t++)e[t].push(i)}if(o){const i=(t.mmax-t.mmin)/2;for(let t=0;t<e.length;t++)e[t].push(i)}return e})),hasZ:r,hasM:o,spatialReference:s}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:i,ymax:s,spatialReference:n}=this,r=this.width,o=this.xmin,a=this.xmax;let l;t=t||Sh(n);const[u,c]=t.valid;l=this._normalizeX(this.xmin,t);const h=l.x,d=l.frameId;l=this._normalizeX(this.xmax,t);const f=l.x,p=l.frameId,y=h===f&&r>0;if(r>2*c){const t=new Cd(o<a?h:f,i,c,s,n),r=new Cd(u,i,o<a?f:h,s,n),l=new Cd(0,i,c,s,n),y=new Cd(u,i,0,s,n),m=[],g=[];t.contains(l)&&m.push(d),t.contains(y)&&g.push(d),r.contains(l)&&m.push(p),r.contains(y)&&g.push(p);for(let t=d+1;t<p;t++)m.push(t),g.push(t);e.push({extent:t,frameIds:[d]},{extent:r,frameIds:[p]},{extent:l,frameIds:m},{extent:y,frameIds:g})}else h>f||y?e.push({extent:new Cd(h,i,c,s,n),frameIds:[d]},{extent:new Cd(u,i,f,s,n),frameIds:[p]}):e.push({extent:new Cd(h,i,f,s,n),frameIds:[d]});this.cache._parts=e}const i=this.hasZ,s=this.hasM;if(i||s){const t={};i&&(t.zmin=this.zmin,t.zmax=this.zmax),s&&(t.mmin=this.mmin,t.mmax=this.mmax);for(let i=0;i<e.length;i++)e[i].extent.set(t)}return e}_normalizeX(t,e){const[i,s]=e.valid,n=2*s;let r,o=0;return t>s?(r=Math.ceil(Math.abs(t-s)/n),t-=r*n,o=r):t<i&&(r=Math.ceil(Math.abs(t-i)/n),t+=r*n,o=-r),{x:t,frameId:o}}};e([Hn({readOnly:!0})],Ed.prototype,"cache",null),e([Hn({readOnly:!0})],Ed.prototype,"center",null),e([Hn({readOnly:!0})],Ed.prototype,"extent",null),e([Hn({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Ed.prototype,"hasM",null),e([Hn({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],Ed.prototype,"hasZ",null),e([Hn({readOnly:!0})],Ed.prototype,"height",null),e([Hn({readOnly:!0})],Ed.prototype,"width",null),e([Hn({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],Ed.prototype,"xmin",void 0),e([Hn({type:Number,json:{write:!0}})],Ed.prototype,"ymin",void 0),e([Hn({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Ed.prototype,"mmin",void 0),e([Hn({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Ed.prototype,"zmin",void 0),e([Hn({type:Number,json:{write:!0}})],Ed.prototype,"xmax",void 0),e([Hn({type:Number,json:{write:!0}})],Ed.prototype,"ymax",void 0),e([Hn({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],Ed.prototype,"mmax",void 0),e([Hn({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Ed.prototype,"zmax",void 0),Ed=Cd=e([_r("esri.geometry.Extent")],Ed),Ed.prototype.toJSON.isDefaultToJSON=!0;const Ld=Ed;var Rd;const Nd=new vo({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let Dd=Rd=class extends Ar{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){"asc"!==t&&"desc"!==t||this._set("sortOrder",t)}clone(){return new Rd({categories:this.categories?H(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let i,s;if(this.categories&&(i=this.categories.map((t=>Array.isArray(t)?JSON.stringify(t):t))),this.extent){const t=Kh(this.extent,Lh.WGS84);u(t)&&(s=`${t.xmin},${t.ymin},${t.xmax},${t.ymax}`)}let n=this.query;!this.disableExtraQuery&&t.extraQuery&&(n="("+n+")"+t.extraQuery);const r={categories:i,bbox:s,q:n,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(r.sortField=this.sortField.split(",").map((t=>Nd.toJSON(t.trim()))).join(","),r.sortOrder=this.sortOrder),{query:{...e,...r}}}};e([Hn()],Dd.prototype,"categories",void 0),e([Hn()],Dd.prototype,"disableExtraQuery",void 0),e([Hn({type:Ld})],Dd.prototype,"extent",void 0),e([Hn()],Dd.prototype,"filter",void 0),e([Hn()],Dd.prototype,"num",void 0),e([Hn()],Dd.prototype,"query",void 0),e([Hn()],Dd.prototype,"sortField",void 0),e([Hn()],Dd.prototype,"sortOrder",null),e([Hn()],Dd.prototype,"start",void 0),Dd=Rd=e([_r("esri.portal.PortalQueryParams")],Dd);const Vd=Dd;let $d=class extends Ar{constructor(t){super(t),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};e([Hn()],$d.prototype,"nextQueryParams",void 0),e([Hn()],$d.prototype,"queryParams",void 0),e([Hn()],$d.prototype,"results",void 0),e([Hn()],$d.prototype,"total",void 0),$d=e([_r("esri.portal.PortalQueryResult")],$d);const zd=$d;let Gd=class extends lh{constructor(t){super(t),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const t=this.get("portal.restUrl");return t?`${t}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new dt("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};e([Hn({type:Date})],Gd.prototype,"created",void 0),e([Hn()],Gd.prototype,"id",void 0),e([Hn()],Gd.prototype,"portal",void 0),e([Hn()],Gd.prototype,"title",void 0),e([Hn({readOnly:!0})],Gd.prototype,"url",null),e([Hn()],Gd.prototype,"username",void 0),Gd=e([_r("esri.portal.PortalFolder")],Gd);const Ud=Gd;let qd=class extends lh{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal._normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.get("portal.restUrl");return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal._request(this.url+"/categorySchema",t).then((e=>{const i=e.categorySchema||[];return i.some((t=>"contentCategorySetsGroupQuery.LivingAtlas"===t.source))?this._fetchCategorySchemaSet("LivingAtlas",t):i}))}fetchMembers(t){return this.portal._request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+="&w="+t),e}toJSON(){throw new dt("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}queryItems(t,e){let i=Ln(Vd,t);return parseFloat(this.portal.currentVersion)>5?(i=i||new Vd,this.portal._queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",e)):(i=i?i.clone():new Vd,i.query="group:"+this.id+(i.query?" "+i.query:""),this.portal.queryItems(i,e))}_fetchCategorySchemaSet(t,e){return this.portal._fetchSelf(this.portal.authMode,!0,e).then((t=>{const i=t.contentCategorySetsGroupQuery;if(i){const t=new Vd;return t.disableExtraQuery=!0,t.num=1,t.query=i,this.portal.queryGroups(t,e)}throw new dt("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")})).then((i=>{if(i.total){const s=i.results[0],n=new Vd;return n.num=1,n.query=`typekeywords:"${t}"`,s.queryItems(n,e)}throw new dt("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")})).then((t=>t.total?t.results[0].fetchData("json",e).then((t=>{const e=t&&t.categorySchema;return e&&e.length?e:[]})):[]))}};e([Hn()],qd.prototype,"access",void 0),e([Hn({type:Date})],qd.prototype,"created",void 0),e([Hn()],qd.prototype,"description",void 0),e([Hn()],qd.prototype,"id",void 0),e([Hn()],qd.prototype,"isInvitationOnly",void 0),e([Hn({type:Date})],qd.prototype,"modified",void 0),e([Hn()],qd.prototype,"owner",void 0),e([Hn()],qd.prototype,"portal",void 0),e([Hn()],qd.prototype,"snippet",void 0),e([Hn()],qd.prototype,"sortField",void 0),e([Hn()],qd.prototype,"sortOrder",void 0),e([Hn()],qd.prototype,"tags",void 0),e([Hn()],qd.prototype,"thumbnail",void 0),e([Hn({readOnly:!0})],qd.prototype,"thumbnailUrl",null),e([Hn()],qd.prototype,"title",void 0),e([Hn({readOnly:!0})],qd.prototype,"url",null),qd=e([_r("esri.portal.PortalGroup")],qd);const Bd=qd,Wd=Object.freeze({__proto__:null,default:Bd});var Hd;let Jd=Hd=class extends lh{constructor(...t){super(...t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal._normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.get("portal.restUrl");return t?`${t}/content/users/${this.username}`:null}get url(){const t=this.get("portal.restUrl");return t?`${t}/community/users/${this.username}`:null}addItem(t){const e=t&&t.item,i=t&&t.data,s=t&&t.folder,n={method:"post"};e&&(n.query=e.createPostQuery(),null!=i&&("string"==typeof i?n.query.text=i:"object"==typeof i&&(n.query.text=JSON.stringify(i))));let r=this.userContentUrl;return s&&(r+="/"+("string"==typeof s?s:s.id)),this.portal._request(r+"/addItem",n).then((t=>(e.id=t.id,e.portal=this.portal,e.loaded?e.reload():e.load())))}deleteItem(t){let e=this.userContentUrl;return t.ownerFolder&&(e+="/"+t.ownerFolder),this.portal._request(e+`/items/${t.id}/delete`,{method:"post"}).then((()=>{t.id=null,t.portal=null}))}deleteItems(t){const e=this.userContentUrl+"/deleteItems",i=t.map((t=>t.id));if(i.length){const s={method:"post",query:{items:i.join(",")}};return this.portal._request(e,s).then((()=>{t.forEach((t=>{t.id=null,t.portal=null}))}))}return Promise.resolve(void 0)}fetchFolders(){return this.portal._request(this.userContentUrl,{query:{num:1}}).then((t=>{let e;return e=t&&t.folders?t.folders.map((t=>{const e=Ud.fromJSON(t);return e.portal=this.portal,e})):[],e}))}fetchGroups(){return this.portal._request(this.url).then((t=>{let e;return e=t&&t.groups?t.groups.map((t=>{const e=Bd.fromJSON(t);return e.portal=this.portal,e})):[],e}))}fetchItems(t){t||(t={});let e,i=this.userContentUrl;return t.folder&&(i+="/"+t.folder.id),Promise.resolve().then((function(){return hf})).then((({default:s})=>(e=s,this.portal._request(i,{query:{folders:!1,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"}})))).then((t=>{let i;return t&&t.items?(i=t.items.map((t=>{const i=e.fromJSON(t);return i.portal=this.portal,i})),Promise.all(i.map((t=>t.load()))).catch((t=>t)).then((()=>({items:i,nextStart:t.nextStart,total:t.total})))):{items:[],nextStart:-1,total:0}}))}fetchTags(){return this.portal._request(this.url+"/tags").then((t=>t.tags))}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+="&w="+t),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new Bd({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new dt("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new dt("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw Error("JSON object is already hydrated");const e=new Hd;return e.sourceJSON=t,e.read(t),e}};e([Hn()],Jd.prototype,"access",void 0),e([Hn({type:Date})],Jd.prototype,"created",void 0),e([Hn()],Jd.prototype,"culture",void 0),e([Hn()],Jd.prototype,"description",void 0),e([Hn()],Jd.prototype,"email",void 0),e([Hn()],Jd.prototype,"favGroupId",void 0),e([Hn()],Jd.prototype,"fullName",void 0),e([Hn({type:Date})],Jd.prototype,"modified",void 0),e([Hn()],Jd.prototype,"orgId",void 0),e([Hn()],Jd.prototype,"portal",void 0),e([Hn()],Jd.prototype,"preferredView",void 0),e([Hn()],Jd.prototype,"privileges",void 0),e([Hn()],Jd.prototype,"region",void 0),e([Hn()],Jd.prototype,"role",void 0),e([Hn()],Jd.prototype,"roleId",void 0),e([Hn()],Jd.prototype,"sourceJSON",void 0),e([Hn()],Jd.prototype,"thumbnail",void 0),e([Hn({readOnly:!0})],Jd.prototype,"thumbnailUrl",null),e([Hn()],Jd.prototype,"units",void 0),e([Hn({readOnly:!0})],Jd.prototype,"userContentUrl",null),e([Hn({readOnly:!0})],Jd.prototype,"url",null),e([Hn()],Jd.prototype,"username",void 0),e([Hn()],Jd.prototype,"userType",void 0),Jd=Hd=e([_r("esri.portal.PortalUser")],Jd);const Zd=Jd,Qd=Object.freeze({__proto__:null,default:Zd});var Kd;let Yd;const Xd={PortalGroup:()=>Promise.resolve().then((function(){return Wd})),PortalItem:()=>Promise.resolve().then((function(){return hf})),PortalUser:()=>Promise.resolve().then((function(){return Qd}))};let tf=Kd=class extends(rh(Bc)){constructor(t){super(t),this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=it.portalUrl,this.urlKey=null,this.user=null,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return"string"==typeof t?{url:t}:t}destroy(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=null)}readAuthorizedCrossOriginDomains(t){if(t)for(const e of t)-1===it.request.trustedServers.indexOf(e)&&it.request.trustedServers.push(e);return t}readDefaultBasemap(t){return this._readBasemap(t)}readDefaultDevBasemap(t){return this._readBasemap(t)}readDefaultVectorBasemap(t){return this._readBasemap(t)}get extraQuery(){return this.id&&this.user&&this.user.orgId&&!this.canSearchPublic?" AND orgid:"+this.id:null}get isOrganization(){return!!this.access}get restUrl(){let t=this.url;if(t){const e=t.indexOf("/sharing");t=e>0?t.substring(0,e):this.url.replace(/\/+$/,""),t+="/sharing/rest"}return t}get stylesGroupQuery(){return Ti(ct.getLogger(this.declaredClass),"stylesGroupQuery",{replacement:"stylesGroupQuery3d",version:"4.21"}),this.stylesGroupQuery3d}get thumbnailUrl(){const t=this.restUrl,e=this.thumbnail;return t&&e?this._normalizeSSL(t+"/portals/self/resources/"+e):null}readUrlKey(t){return t?t.toLowerCase():t}readUser(t){let e=null;return t&&(e=Zd.fromJSON(t),e.portal=this),e}load(t){const e=Promise.resolve().then((function(){return xf})).then((({default:e})=>{Ee(t),Yd=e})).then((()=>this.sourceJSON?this.sourceJSON:this._fetchSelf(this.authMode,!1,t))).then((t=>{if(Me){const t=Me;this.credential=t.findCredential(this.restUrl),this.credential||this.authMode!==Kd.AUTH_MODE_AUTO||(this._esriId_credentialCreateHandle=t.on("credential-create",(()=>{t.findCredential(this.restUrl)&&this._signIn()})))}this.sourceJSON=t,this.read(t)}));return this.addResolvingPromise(e),Promise.resolve(this)}async createClosestFacilityTask(){_i(ct.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/closestFacility",version:"4.21"}),await this.load();const t=this._getHelperServiceUrl("closestFacility");return new((await import("./p-cc9956bd.js")).default)(t)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),e=(await import("./p-10eaf276.js")).default;return t?t.map((t=>new e({id:t.id,url:t.url}))):[]}async createGeometryService(){_i(ct.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/geometryService",version:"4.21"}),await this.load();const t=this._getHelperServiceUrl("geometry");return new((await import("./p-efa63c30.js")).default)({url:t})}async createPrintTask(){_i(ct.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/print",version:"4.21"}),await this.load();const t=this._getHelperServiceUrl("printTask");return new((await import("./p-07f8310b.js")).default)(t)}async createRouteTask(){_i(ct.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/route",version:"4.21"}),await this.load();const t=this._getHelperServiceUrl("route");return new((await import("./p-afc306cc.js")).default)(t)}async createServiceAreaTask(){_i(ct.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/serviceArea",version:"4.21"}),await this.load();const t=this._getHelperServiceUrl("serviceArea");return new((await import("./p-d5b3abd6.js")).default)(t)}fetchBasemaps(t,e){const i=new Vd;return i.query=t||(it.apiKey&&si(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0,this.queryGroups(i,e).then((t=>{if(i.num=100,i.query='type:"Web Map" -type:"Web Application"',t.total){const s=t.results[0];return i.sortField=s.sortField||"name",i.sortOrder=s.sortOrder||"desc",s.queryItems(i,e)}return null})).then((t=>{let e;return e=t&&t.total?t.results.filter((t=>"Web Map"===t.type)).map((t=>new Yd({portalItem:t}))):[],e}))}fetchCategorySchema(t){return this.hasCategorySchema?this._request(this.restUrl+"/portals/self/categorySchema",t).then((t=>t.categorySchema)):Re(t)?Promise.reject(Pe()):Promise.resolve([])}fetchFeaturedGroups(t){const e=this.featuredGroups,i=new Vd;if(i.num=100,i.sortField="title",e&&e.length){const s=[];for(const t of e)s.push(`(title:"${t.title}" AND owner:${t.owner})`);return i.query=s.join(" OR "),this.queryGroups(i,t).then((t=>t.results))}return Re(t)?Promise.reject(Pe()):Promise.resolve([])}fetchRegions(t){const e=this.user&&this.user.culture||this.culture||jo();return this._request(this.restUrl+"/portals/regions",{...t,query:{culture:e}})}static getDefault(){return Kd._default&&!Kd._default.destroyed||(Kd._default=new Kd),Kd._default}queryGroups(t,e){return this._queryPortal("/community/groups",t,"PortalGroup",e)}queryItems(t,e){return this._queryPortal("/search",t,"PortalItem",e)}queryUsers(t,e){return t.sortField||(t.sortField="username"),this._queryPortal("/community/users",t,"PortalUser",e)}toJSON(){throw new dt("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw Error("JSON object is already hydrated");return new Kd({sourceJSON:t})}_getHelperService(t){const e=this.helperServices&&this.helperServices[t];if(!e)throw new dt("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return e}_getHelperServiceUrl(t){const e=this._getHelperService(t);if(!e.url)throw new dt("portal:service-url-not-found",`The \`helperServices\` entry "${t}" does not include a \`url\` value`);return e.url}_fetchSelf(t=this.authMode,e=!1,i){const s=this.restUrl+"/portals/self",n={authMode:t,query:{culture:jo().toLowerCase()},...i};return"auto"===n.authMode&&(n.authMode="no-prompt"),e&&(n.query.default=!0),this._request(s,n)}_queryPortal(t,e,i,s){const n=Ln(Vd,e),r=e=>this._request(this.restUrl+t,{...n.toRequestOptions(this),...s}).then((t=>{const i=n.clone();return i.start=t.nextStart,new zd({nextQueryParams:i,queryParams:n,total:t.total,results:Kd._resultsToTypedArray(e,{portal:this},t,s)})})).then((t=>Promise.all(t.results.map((e=>"function"==typeof e.when?e.when():t))).then((()=>t),(e=>(Ne(e),t)))));return i&&Xd[i]?Xd[i]().then((({default:t})=>(Ee(s),r(t)))):r()}_signIn(){if(this.authMode===Kd.AUTH_MODE_ANONYMOUS)return Promise.reject(new dt("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const t=t=>Promise.resolve().then((()=>"not-loaded"===this.loadStatus?(t||(this.authMode="immediate"),this.load().then((()=>null))):"loading"===this.loadStatus?this.load().then((()=>this.credential?null:(this.credential=t,this._fetchSelf("immediate")))):this.user&&this.credential===t?null:(this.credential=t,this._fetchSelf("immediate")))).then((t=>{t&&(this.sourceJSON=t,this.read(t))}));return Me?Me.getCredential(this.restUrl).then((e=>t(e))):t(this.credential)}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_normalizeUrl(t){const e=this.credential&&this.credential.token;return this._normalizeSSL(e?t+(t.indexOf("?")>-1?"&":"?")+"token="+e:t)}_requestToTypedArray(t,e,i){return this._request(t,e).then((t=>{const e=Kd._resultsToTypedArray(i,{portal:this},t);return Promise.all(e.map((e=>"function"==typeof e.when?e.when():t))).then((()=>e),(()=>e))}))}_readBasemap(t){if(t){const e=Yd.fromJSON(t);return e.portalItem={portal:this},e}return null}_request(t,e={}){const i={f:"json",...e.query},{authMode:s=(this.authMode===Kd.AUTH_MODE_ANONYMOUS?"anonymous":"auto"),body:n=null,cacheBust:r=!1,method:o="auto",responseType:a="json",signal:l}=e,u={authMode:s,body:n,cacheBust:r,method:o,query:i,responseType:a,timeout:0,signal:l};return oi(this._normalizeSSL(t),u).then((t=>t.data))}static _resultsToTypedArray(t,e,i,s){let n;if(i){const r=u(s)?s.signal:null;n=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(t||e)&&(n=n.map((i=>{const s=Object.assign(t?t.fromJSON(i):i,e);return"function"==typeof s.load&&s.load(r),s})))}else n=[];return n}};tf.AUTH_MODE_ANONYMOUS="anonymous",tf.AUTH_MODE_AUTO="auto",tf.AUTH_MODE_IMMEDIATE="immediate",e([Hn()],tf.prototype,"access",void 0),e([Hn()],tf.prototype,"allSSL",void 0),e([Hn()],tf.prototype,"authMode",void 0),e([Hn()],tf.prototype,"authorizedCrossOriginDomains",void 0),e([Rh("authorizedCrossOriginDomains")],tf.prototype,"readAuthorizedCrossOriginDomains",null),e([Hn()],tf.prototype,"basemapGalleryGroupQuery",void 0),e([Hn()],tf.prototype,"bingKey",void 0),e([Hn()],tf.prototype,"canListApps",void 0),e([Hn()],tf.prototype,"canListData",void 0),e([Hn()],tf.prototype,"canListPreProvisionedItems",void 0),e([Hn()],tf.prototype,"canProvisionDirectPurchase",void 0),e([Hn()],tf.prototype,"canSearchPublic",void 0),e([Hn()],tf.prototype,"canShareBingPublic",void 0),e([Hn()],tf.prototype,"canSharePublic",void 0),e([Hn()],tf.prototype,"canSignInArcGIS",void 0),e([Hn()],tf.prototype,"canSignInIDP",void 0),e([Hn()],tf.prototype,"colorSetsGroupQuery",void 0),e([Hn()],tf.prototype,"commentsEnabled",void 0),e([Hn({type:Date})],tf.prototype,"created",void 0),e([Hn()],tf.prototype,"credential",void 0),e([Hn()],tf.prototype,"culture",void 0),e([Hn()],tf.prototype,"currentVersion",void 0),e([Hn()],tf.prototype,"customBaseUrl",void 0),e([Hn()],tf.prototype,"defaultBasemap",void 0),e([Rh("defaultBasemap")],tf.prototype,"readDefaultBasemap",null),e([Hn()],tf.prototype,"defaultDevBasemap",void 0),e([Rh("defaultDevBasemap")],tf.prototype,"readDefaultDevBasemap",null),e([Hn({type:Ld})],tf.prototype,"defaultExtent",void 0),e([Hn()],tf.prototype,"defaultVectorBasemap",void 0),e([Rh("defaultVectorBasemap")],tf.prototype,"readDefaultVectorBasemap",null),e([Hn()],tf.prototype,"description",void 0),e([Hn()],tf.prototype,"devBasemapGalleryGroupQuery",void 0),e([Hn()],tf.prototype,"eueiEnabled",void 0),e([Hn({readOnly:!0})],tf.prototype,"extraQuery",null),e([Hn()],tf.prototype,"featuredGroups",void 0),e([Hn()],tf.prototype,"featuredItemsGroupQuery",void 0),e([Hn()],tf.prototype,"galleryTemplatesGroupQuery",void 0),e([Hn()],tf.prototype,"livingAtlasGroupQuery",void 0),e([Hn()],tf.prototype,"hasCategorySchema",void 0),e([Hn()],tf.prototype,"helpBase",void 0),e([Hn()],tf.prototype,"helperServices",void 0),e([Hn()],tf.prototype,"helpMap",void 0),e([Hn()],tf.prototype,"homePageFeaturedContent",void 0),e([Hn()],tf.prototype,"homePageFeaturedContentCount",void 0),e([Hn()],tf.prototype,"httpPort",void 0),e([Hn()],tf.prototype,"httpsPort",void 0),e([Hn()],tf.prototype,"id",void 0),e([Hn()],tf.prototype,"ipCntryCode",void 0),e([Hn({readOnly:!0})],tf.prototype,"isOrganization",null),e([Hn()],tf.prototype,"isPortal",void 0),e([Hn()],tf.prototype,"isReadOnly",void 0),e([Hn()],tf.prototype,"layerTemplatesGroupQuery",void 0),e([Hn()],tf.prototype,"maxTokenExpirationMinutes",void 0),e([Hn({type:Date})],tf.prototype,"modified",void 0),e([Hn()],tf.prototype,"name",void 0),e([Hn()],tf.prototype,"portalHostname",void 0),e([Hn()],tf.prototype,"portalMode",void 0),e([Hn()],tf.prototype,"portalProperties",void 0),e([Hn()],tf.prototype,"region",void 0),e([Hn({readOnly:!0})],tf.prototype,"restUrl",null),e([Hn()],tf.prototype,"rotatorPanels",void 0),e([Hn()],tf.prototype,"showHomePageDescription",void 0),e([Hn()],tf.prototype,"sourceJSON",void 0),e([Hn()],tf.prototype,"staticImagesUrl",void 0),e([Hn({readOnly:!0,json:{read:!1}})],tf.prototype,"stylesGroupQuery",null),e([Hn({json:{name:"2DStylesGroupQuery"}})],tf.prototype,"stylesGroupQuery2d",void 0),e([Hn({json:{name:"stylesGroupQuery"}})],tf.prototype,"stylesGroupQuery3d",void 0),e([Hn()],tf.prototype,"supportsHostedServices",void 0),e([Hn()],tf.prototype,"symbolSetsGroupQuery",void 0),e([Hn()],tf.prototype,"templatesGroupQuery",void 0),e([Hn()],tf.prototype,"thumbnail",void 0),e([Hn({readOnly:!0})],tf.prototype,"thumbnailUrl",null),e([Hn()],tf.prototype,"units",void 0),e([Hn()],tf.prototype,"url",void 0),e([Hn()],tf.prototype,"urlKey",void 0),e([Rh("urlKey")],tf.prototype,"readUrlKey",null),e([Hn()],tf.prototype,"user",void 0),e([Rh("user")],tf.prototype,"readUser",null),e([Hn()],tf.prototype,"useStandardizedQuery",void 0),e([Hn()],tf.prototype,"useVectorBasemaps",void 0),e([Hn()],tf.prototype,"vectorBasemapGalleryGroupQuery",void 0),tf=Kd=e([_r("esri.portal.Portal")],tf);const ef=tf,sf=ct.getLogger("esri.portal.PortalItemResource");let nf=class extends Ar{constructor(t){super(t),this.portalItem=null}normalizeCtorArgs(t){return t&&t.portalItem&&t.path?{...t,path:this.normalizePath(t.path,t.portalItem)}:t}set path(t){u(t)&&Jt(t)?sf.error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",t)}_castPath(t){return this.normalizePath(t,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?"./resources/"+this.path:null}fetch(t="json",e){const i=this.url;if(c(i))throw new dt("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal._request(i,{responseType:t,query:{token:this.portalItem.apiKey},signal:I(e,"signal")})}async update(t,e){return(await import("./p-f5b7843f.js")).addOrUpdateResource(this,"update",t,e)}hasPath(){return u(this.path)}normalizePath(t,e){return c(t)?t:(t=t.replace(/^\/+/,""),u(e)&&Jt(t)&&(t=qt(t,e.itemUrl)),t.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}};e([Hn()],nf.prototype,"portalItem",void 0),e([Hn({type:String,value:null})],nf.prototype,"path",null),e([xa("path")],nf.prototype,"_castPath",null),e([Hn({type:String,readOnly:!0})],nf.prototype,"url",null),e([Hn({type:String,readOnly:!0})],nf.prototype,"itemRelativeUrl",null),nf=e([_r("esri.portal.PortalItemResource")],nf);const rf=nf;let of=class extends Ar{constructor(t){super(t),this.created=null,this.rating=null}};e([Hn()],of.prototype,"created",void 0),e([Hn()],of.prototype,"rating",void 0),of=e([_r("esri.portal.PortalRating")],of);const af=of;var lf;let uf=lf=class extends(rh(Bc)){constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}static from(t){return Fn(lf,t)}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let i=t;return"Feature Service"===t||"Feature Collection"===t?i=e.indexOf("Table")>-1?"Table":e.indexOf("Route Layer")>-1?"Route Layer":e.indexOf("Markup")>-1?"Markup":"Feature Layer":"Image Service"===t?i=e.indexOf("Elevation 3D Layer")>-1?"Elevation Layer":e.indexOf("Tiled Imagery")>-1?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===t?i="Scene Layer":"Scene Package"===t?i="Scene Layer Package":"Stream Service"===t?i="Feature Layer":"Geoprocessing Service"===t&&this.portal&&this.portal.isPortal?i=e.indexOf("Web Tool")>-1?"Tool":"Geoprocessing Service":"Geocoding Service"===t?i="Locator":"Geoenrichment Service"===t?i="GeoEnrichment Service":"Microsoft Powerpoint"===t?i="Microsoft PowerPoint":"GeoJson"===t?i="GeoJSON":"Globe Service"===t?i="Globe Layer":"Vector Tile Service"===t?i="Tile Layer":"netCDF"===t?i="NetCDF":"Map Service"===t?i=-1===e.indexOf("Spatiotemporal")&&(e.indexOf("Hosted Service")>-1||e.indexOf("Tiled")>-1)&&-1===e.indexOf("Relational")?"Tile Layer":"Map Image Layer":t&&t.toLowerCase().indexOf("add in")>-1?i=t.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===t?i="Big Data File Share":"Compact Tile Package"===t?i="Tile Package (tpkx)":"OGCFeatureServer"===t&&(i="OGC Feature Layer"),i}readExtent(t){return t&&t.length?new Ld(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type&&this.type.toLowerCase()||"",e=this.typeKeywords||[];let i,s=!1,n=!1,r=!1,o=!1,a=!1,l=!1;return t.indexOf("service")>0||"feature collection"===t||"kml"===t||"wms"===t||"wmts"===t||"wfs"===t?(s=e.indexOf("Hosted Service")>-1,"feature service"===t||"feature collection"===t||"kml"===t||"wfs"===t?(n=e.indexOf("Table")>-1,r=e.indexOf("Route Layer")>-1,o=e.indexOf("Markup")>-1,a=-1!==e.indexOf("Spatiotemporal"),l=-1!==e.indexOf("UtilityNetwork"),i=a&&n?"spatiotemporaltable":n?"table":r?"routelayer":o?"markup":a?"spatiotemporal":s?"featureshosted":l?"utilitynetwork":"features"):i="map service"===t||"wms"===t||"wmts"===t?s||e.indexOf("Tiled")>-1||"wmts"===t?"maptiles":"mapimages":"scene service"===t?e.indexOf("Line")>-1?"sceneweblayerline":e.indexOf("3DObject")>-1?"sceneweblayermultipatch":e.indexOf("Point")>-1?"sceneweblayerpoint":e.indexOf("IntegratedMesh")>-1?"sceneweblayermesh":e.indexOf("PointCloud")>-1?"sceneweblayerpointcloud":e.indexOf("Polygon")>-1?"sceneweblayerpolygon":e.indexOf("Building")>-1?"sceneweblayerbuilding":e.indexOf("Voxel")>-1?"sceneweblayervoxel":"sceneweblayer":"image service"===t?e.indexOf("Elevation 3D Layer")>-1?"elevationlayer":e.indexOf("Tiled Imagery")>-1?"tiledimagerylayer":"imagery":"stream service"===t?"streamlayer":"vector tile service"===t?"vectortile":"datastore catalog service"===t?"datastorecollection":"geocoding service"===t?"geocodeservice":"geoprocessing service"===t&&e.indexOf("Web Tool")>-1&&this.portal&&this.portal.isPortal?"tool":"layers"):i="web map"===t||"cityengine web scene"===t?"maps":"web scene"===t?e.indexOf("ViewingMode-Local")>-1?"webscenelocal":"websceneglobal":"web mapping application"===t||"mobile application"===t||"application"===t||"operation view"===t||"desktop application"===t?"apps":"map document"===t||"map package"===t||"published map"===t||"scene document"===t||"globe document"===t||"basemap package"===t||"mobile basemap package"===t||"mobile map package"===t||"project package"===t||"project template"===t||"pro map"===t||"layout"===t||"layer"===t&&e.indexOf("ArcGIS Pro")>-1||"explorer map"===t&&e.indexOf("Explorer Document")?"mapsgray":"service definition"===t||"csv"===t||"shapefile"===t||"cad drawing"===t||"geojson"===t||"360 vr experience"===t||"netcdf"===t||"administrative report"===t?"datafiles":"explorer add in"===t||"desktop add in"===t||"windows viewer add in"===t||"windows viewer configuration"===t?"appsgray":"arcgis pro add in"===t||"arcgis pro configuration"===t?"addindesktop":"rule package"===t||"file geodatabase"===t||"sqlite geodatabase"===t||"csv collection"===t||"kml collection"===t||"windows mobile package"===t||"map template"===t||"desktop application template"===t||"gml"===t||"arcpad package"===t||"code sample"===t||"form"===t||"document link"===t||"earth configuration"===t||"operations dashboard add in"===t||"rules package"===t||"image"===t||"workflow manager package"===t||"explorer map"===t&&e.indexOf("Explorer Mapping Application")>-1||e.indexOf("Document")>-1?"datafilesgray":"network analysis service"===t||"geoprocessing service"===t||"geodata service"===t||"geometry service"===t||"geoprocessing package"===t||"locator package"===t||"geoprocessing sample"===t||"workflow manager service"===t?"toolsgray":"layer"===t||"layer package"===t||"explorer layer"===t?"layersgray":"scene package"===t?"scenepackage":"mobile scene package"===t?"mobilescenepackage":"tile package"===t||"compact tile package"===t?"tilepackage":"task file"===t?"taskfile":"report template"===t?"report-template":"statistical data collection"===t?"statisticaldatacollection":"insights workbook"===t?"workbook":"insights model"===t?"insightsmodel":"insights page"===t?"insightspage":"insights theme"===t?"insightstheme":"hub initiative"===t?"hubinitiative":"hubpage"===t?"hubpage":"hub event"===t?"hubevent":"hub site application"===t?"hubsite":"relational database connection"===t?"relationaldatabaseconnection":"big data file share"===t?"datastorecollection":"image collection"===t?"imagecollection":"style"===t?"style":"desktop style"===t?"desktopstyle":"dashboard"===t?"dashboard":"raster function template"===t?"rasterprocessingtemplate":"vector tile package"===t?"vectortilepackage":"ortho mapping project"===t?"orthomappingproject":"ortho mapping template"===t?"orthomappingtemplate":"solution"===t?"solutions":"geopackage"===t?"geopackage":"deep learning package"===t?"deeplearningpackage":"real time analytic"===t?"realtimeanalytics":"big data analytic"===t?"bigdataanalytics":"feed"===t?"feed":"excalibur imagery project"===t?"excaliburimageryproject":"notebook"===t?"notebook":"storymap"===t?"storymap":"survey123 add in"===t?"survey123addin":"mission"===t?"mission":"mission report"===t?"missionreport":"quickcapture project"===t?"quickcaptureproject":"pro report"===t?"proreport":"urban model"===t?"urbanmodel":"web experience"===t?"experiencebuilder":"web experience template"===t?"webexperiencetemplate":"workflow"===t?"workflow":"insights script"===t?"insightsscript":"kernel gateway connection"===t?"kernelgatewayconnection":"hub initiative template"===t?"hubinitiativetemplate":"storymap theme"===t?"storymaptheme":"knowledge graph"===t?"knowledgegraph":"native application"===t?"nativeapp":"native application installer"===t?"nativeappinstaller":"link chart"===t?"linkchart":"investigation"===t?"investigation":"ogcfeatureserver"===t?"features":"pro project"===t?"proproject":"insights workbook package"===t?"insightsworkbookpackage":"apache parquet"===t?"apacheparquet":"maps",i?Ii("esri/images/portal/"+i+"16.png"):null}get isLayer(){return["Map Service","Feature Service","Feature Collection","Scene Service","Image Service","Stream Service","Vector Tile Service","WMTS","WMS"].indexOf(this.type)>-1}get itemUrl(){const t=this.get("portal.restUrl");return t?t+"/content/items/"+this.id:null}get thumbnailUrl(){const t=this.itemUrl,e=this.thumbnail;return t&&e?this.portal._normalizeUrl(`${t}/info/${e}?f=json`):null}get userItemUrl(){const t=this.get("portal.restUrl");if(!t)return null;const e=this.owner||this.get("portal.user.username");return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){this.portal||(this.portal=ef.getDefault());const e=this.portal.load(t).then((()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?this.portal._request(this.itemUrl,{signal:u(t)?t.signal:null,query:{token:this.apiKey}}):{})).then((t=>{this.sourceJSON=t,this.read(t)}));return this.addResolvingPromise(e),Promise.resolve(this)}addRating(t){const e={method:"post",query:{}};return t instanceof af&&(t=t.rating),isNaN(t)||"number"!=typeof t||(e.query.rating=t),this.portal._request(this.itemUrl+"/addRating",e).then((()=>new af({rating:t,created:new Date})))}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:H(this.applicationProxies),avgRating:this.avgRating,categories:H(this.categories),created:H(this.created),culture:this.culture,description:this.description,extent:H(this.extent),groupCategories:H(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:H(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:H(this.screenshots),size:this.size,snippet:this.snippet,tags:H(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:H(this.typeKeywords),url:this.url};return this.loaded&&(t.loadStatus="loaded"),new lf({sourceJSON:this.sourceJSON}).set(t)}createPostQuery(){const t=this.toJSON();for(const e in t)"tags"===e&&null!==t[e]&&(t[e]=t[e].join(", ")),"typeKeywords"===e&&null!==t[e]&&(t[e]=t[e].join(", ")),"extent"===e&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}deleteRating(){return this.portal._request(this.itemUrl+"/deleteRating",{method:"post"}).then((()=>{}))}fetchData(t="json",e){return this.portal._request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}fetchRating(t){return this.portal._request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t}).then((t=>null!=t.rating?(t.created=new Date(t.created),new af(t)):null))}fetchRelatedItems(t,e){return this.portal._requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},lf)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+="&w="+t),e}reload(){return this.portal._request(this.itemUrl,{cacheBust:!0,query:{token:this.apiKey}}).then((t=>(this.sourceJSON=t,this.read(t),this)))}update(t){return this.id?this.load().then((()=>this.portal._signIn())).then((()=>{const e=t&&t.data,i={method:"post"};i.query=this.createPostQuery();for(const t in i.query)null===i.query[t]&&(i.query[t]="");return i.query.clearEmptyFields=!0,null!=e&&("string"==typeof e?i.query.text=e:"object"==typeof e&&(i.query.text=JSON.stringify(e))),this.portal._request(this.userItemUrl+"/update",i).then((()=>this.reload()))})):Promise.reject(new dt("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}updateThumbnail(t){return this.id?this.load().then((()=>this.portal._signIn())).then((()=>{const e=t.thumbnail,i=t.filename,s={method:"post"};if("string"==typeof e)s.query=Qt(e)?{data:e}:{url:Ut(e)},u(i)&&(s.query.filename=i);else{const t=new FormData;u(i)?t.append("file",e,i):t.append("file",e),s.body=t}return this.portal._request(this.userItemUrl+"/updateThumbnail",s).then((()=>this.reload()))})):Promise.reject(new dt("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){return(await import("./p-f5b7843f.js")).fetchResources(this,t,e)}async addResource(t,e,i){const s=await import("./p-f5b7843f.js");return t.portalItem=this,s.addOrUpdateResource(t,"add",e,i)}async removeResource(t,e){const i=await import("./p-f5b7843f.js");if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new dt("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return i.removeResource(this,t,e)}async removeAllResources(t){return(await import("./p-f5b7843f.js")).removeAllResources(this,t)}resourceFromPath(t){return new rf({portalItem:this,path:t})}toJSON(){const t=this.extent;return W({created:this.created&&this.created.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,modified:this.modified&&this.modified.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,tags:this.tags,thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:this.typeKeywords,url:this.url})}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw Error("JSON object is already hydrated");return new lf({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)"tags"===e&&null!==t[e]&&(t[e]=t[e].join(", ")),"typeKeywords"===e&&null!==t[e]&&(t[e]=t[e].join(", ")),"extent"===e&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};e([Hn({type:["private","shared","org","public"]})],uf.prototype,"access",void 0),e([Hn()],uf.prototype,"accessInformation",void 0),e([Hn({type:String})],uf.prototype,"apiKey",void 0),e([Hn({json:{read:{source:"appProxies"}}})],uf.prototype,"applicationProxies",void 0),e([Hn()],uf.prototype,"avgRating",void 0),e([Hn()],uf.prototype,"categories",void 0),e([Hn({type:Date})],uf.prototype,"created",void 0),e([Hn()],uf.prototype,"culture",void 0),e([Hn()],uf.prototype,"description",void 0),e([Hn({readOnly:!0})],uf.prototype,"displayName",null),e([Hn({type:Ld})],uf.prototype,"extent",void 0),e([Rh("extent")],uf.prototype,"readExtent",null),e([Hn()],uf.prototype,"groupCategories",void 0),e([Hn({readOnly:!0})],uf.prototype,"iconUrl",null),e([Hn()],uf.prototype,"id",void 0),e([Hn({readOnly:!0})],uf.prototype,"isLayer",null),e([Hn()],uf.prototype,"itemControl",void 0),e([Hn({readOnly:!0})],uf.prototype,"itemUrl",null),e([Hn()],uf.prototype,"licenseInfo",void 0),e([Hn({type:Date})],uf.prototype,"modified",void 0),e([Hn()],uf.prototype,"name",void 0),e([Hn()],uf.prototype,"numComments",void 0),e([Hn()],uf.prototype,"numRatings",void 0),e([Hn()],uf.prototype,"numViews",void 0),e([Hn()],uf.prototype,"owner",void 0),e([Hn()],uf.prototype,"ownerFolder",void 0),e([Hn({type:ef})],uf.prototype,"portal",void 0),e([Hn()],uf.prototype,"screenshots",void 0),e([Hn()],uf.prototype,"size",void 0),e([Hn()],uf.prototype,"snippet",void 0),e([Hn()],uf.prototype,"sourceJSON",void 0),e([Hn()],uf.prototype,"tags",void 0),e([Hn()],uf.prototype,"thumbnail",void 0),e([Hn({readOnly:!0})],uf.prototype,"thumbnailUrl",null),e([Hn()],uf.prototype,"title",void 0),e([Hn()],uf.prototype,"type",void 0),e([Hn()],uf.prototype,"typeKeywords",void 0),e([Hn()],uf.prototype,"url",void 0),e([Hn({readOnly:!0})],uf.prototype,"userItemUrl",null),uf=lf=e([_r("esri.portal.PortalItem")],uf);const cf=uf,hf=Object.freeze({__proto__:null,default:cf}),df={streets:{id:"streets",classic:!0,deprecated:!0,get thumbnailUrl(){return Ii("esri/images/basemap/streets.jpg")},baseMapLayers:[{id:"streets-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Street Map",showLegend:!1,visibility:!0,opacity:1}]},satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Boundaries and Places",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},topo:{id:"topo",classic:!0,deprecated:!0,get thumbnailUrl(){return Ii("esri/images/basemap/topo.jpg")},baseMapLayers:[{id:"topo-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Topo Map",showLegend:!1,visibility:!0,opacity:1}]},gray:{id:"gray",classic:!0,deprecated:!0,get thumbnailUrl(){return Ii("esri/images/basemap/gray.jpg")},baseMapLayers:[{id:"gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"dark-gray":{id:"dark-gray",classic:!0,deprecated:!0,get thumbnailUrl(){return Ii("esri/images/basemap/dark-gray.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"dark-gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"national-geographic":{id:"national-geographic",classic:!0,deprecated:!0,get thumbnailUrl(){return Ii("esri/images/basemap/national-geographic.jpg")},baseMapLayers:[{id:"national-geographic-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer",title:"NatGeo World Map",showLegend:!1,layerType:"ArcGISTiledMapServiceLayer",visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return Ii("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"arcgis-imagery":{get thumbnailUrl(){return Ii("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return Ii("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return Ii("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return Ii("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return Ii("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return Ii("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return Ii("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return Ii("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return Ii("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return Ii("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]}},ff=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),pf=new Set(["csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","map-image","map-notes","ogc-feature","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function yf(t){return!("feature"!==t.type||t.url||!t.source||"memory"!==t.source.type)}function mf(t,e){"maxScale"in t&&(e.maxScale=yr(t.maxScale)),"minScale"in t&&(e.minScale=yr(t.minScale))}function gf(t,e,i){if(!("write"in t)||!t.write)return i&&i.messages&&i.messages.push(new dt("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(function(t,e){if(e.restrictedWebMapWriting){const i=function(t){return"basemap"===t.layerContainerType?ff:"operational-layers"===t.layerContainerType?pf:null}(e);return!u(i)||i.has(t.type)&&!yf(t)}return!0}(t,i)){const e={};return t.write(e,i)?e:null}return u(e)&&function(t,e){if(function(t,e){if(yf(t)){const i=Q("featureCollection.layers",e),s=i&&i[0]&&i[0].layerDefinition;s&&mf(t,s)}else"stream"===t.type?mf(t,e.layerDefinition=e.layerDefinition||{}):"group"!==t.type&&mf(t,e)}(t,e),"blendMode"in t&&(e.blendMode=t.blendMode,"normal"===e.blendMode&&delete e.blendMode),e.opacity=yr(t.opacity),e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&"wmts"!==t.type)if(yf(t)){const i=e.featureCollection;i&&(i.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}(t,e=H(e)),e}var vf;let wf=0;const bf=ct.getLogger("esri.Basemap");let Mf=vf=class extends(rh(Bc)){constructor(t){super(t),this.id=null,this.portalItem=null,this.spatialReference=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+wf++,this.baseLayers=new Jr,this.referenceLayers=new Jr;const e=t=>{t.parent&&t.parent!==this&&"remove"in t.parent&&t.parent.remove(t),t.parent=this,"elevation"===t.type&&bf.error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=t=>{t.parent=null};this.baseLayers.on("after-add",(t=>e(t.item))),this.referenceLayers.on("after-add",(t=>e(t.item))),this.baseLayers.on("after-remove",(t=>i(t.item))),this.referenceLayers.on("after-remove",(t=>i(t.item)))}initialize(){this.when().catch((t=>{bf.error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var t;const e=this.baseLayers.removeAll();for(const t of e)t.destroy();const i=this.referenceLayers.removeAll();for(const t of i)t.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),null==(t=this.portalItem)||t.destroy(),this.portalItem=null}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set baseLayers(t){this._set("baseLayers",Wc(t,this._get("baseLayers")))}_writeBaseLayers(t,e,i){const s=[];t?(i={...i,layerContainerType:"basemap"},this.baseLayers.forEach((t=>{const e=gf(t,i.webmap?i.webmap.getLayerJSONFromResourceInfo(t):null,i);u(e)&&s.push(e)})),this.referenceLayers.forEach((t=>{const e=gf(t,i.webmap?i.webmap.getLayerJSONFromResourceInfo(t):null,i);u(e)&&(e.isReference=!0,s.push(e))})),e.baseMapLayers=s):e.baseMapLayers=s}set referenceLayers(t){this._set("referenceLayers",Wc(t,this._get("referenceLayers")))}writeTitle(t,e){e.title=t||"Basemap"}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return hh(this,(t=>{t(this.baseLayers,this.referenceLayers)}))}clone(){const t={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.slice(),referenceLayers:this.referenceLayers.slice()};return this.loaded&&(t.loadStatus="loaded"),new vf({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}write(t,e){return t=t||{},e&&e.origin||(e={origin:"web-map",...e}),super.write(t,e),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(t.baseMapLayers=this.resourceInfo.data.baseMapLayers.map((t=>{const e=H(t);return e.url&&ee(e.url)&&(e.url="https:"+e.url),e.templateUrl&&ee(e.templateUrl)&&(e.templateUrl="https:"+e.templateUrl),e}))),t}async _loadFromSource(t){const{resourceInfo:e,portalItem:i}=this;Ee(t);const s=[];e?(s.push(this._loadLayersFromJSON(e.data,e.context?e.context.url:null,t)),e.data.id&&!e.data.title&&s.push(async function(t){if(!t)return;const e=t.indexOf("-vector")>-1?t.slice(0,t.indexOf("-vector")):t,i=await na("esri/t9n/basemaps");return i[t]||i[e]}(e.data.id).then((t=>{t&&this.read({title:t},e.context)})))):i&&s.push(this._loadFromItem(i,t)),await Promise.all(s)}async _loadLayersFromJSON(t,e,i){const s=this.resourceInfo&&this.resourceInfo.context,n=this.portalItem&&this.portalItem.portal||s&&s.portal||null,r=s&&"web-scene"===s.origin?"web-scene":"web-map",{populateOperationalLayers:o}=await import("./p-6e889b5e.js"),a=[];if(Ee(i),t.baseMapLayers&&Array.isArray(t.baseMapLayers)){const i={context:{origin:r,url:e,portal:n,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},s=o(this.baseLayers,t.baseMapLayers.filter((t=>!t.isReference)),i);a.push(s);const l=o(this.referenceLayers,t.baseMapLayers.filter((t=>t.isReference)),i);a.push(l)}await Be(a)}async _loadFromItem(t,e){const i=await t.load(e),s=await i.fetchData("json",e),n=Tt(t.itemUrl);return this._set("resourceInfo",{data:s.baseMap,context:{origin:"web-map",portal:t.portal||ef.getDefault(),url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:s.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||ef.getDefault(),url:n}),this._loadLayersFromJSON(this.resourceInfo.data,n,e)}static fromId(t){const e=df[t];if(e){if(e.deprecated){let e=null;"dark-gray"===t?e="dark-gray-vector":"gray"===t?e="gray-vector":"streets"===t?e="streets-vector":"topo"===t&&(e="topo-vector"),Oi(bf,`The ${t} basemap has entered mature support and is no longer being updated.`,{replacement:e,see:"https://arcg.is/1iq8aD",warnOnce:!0})}return vf.fromJSON(e)}return null}};e([Hn({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,i,s){this._writeBaseLayers(t,e,s)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:Jr}},writer(t,e,i,s){this._writeBaseLayers(t,e,s)}}}}}})],Mf.prototype,"baseLayers",null),e([Hn({type:String,json:{origins:{"web-scene":{write:!0}}}})],Mf.prototype,"id",void 0),e([Hn({type:cf})],Mf.prototype,"portalItem",void 0),e([Hn()],Mf.prototype,"referenceLayers",null),e([Hn({readOnly:!0})],Mf.prototype,"resourceInfo",void 0),e([Hn({type:Lh})],Mf.prototype,"spatialReference",void 0),e([Hn()],Mf.prototype,"thumbnailUrl",void 0),e([Hn({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],Mf.prototype,"title",void 0),e([fh("title")],Mf.prototype,"writeTitle",null),Mf=vf=e([_r("esri.Basemap")],Mf);const Sf=Mf,xf=Object.freeze({__proto__:null,default:Sf}),kf=ct.getLogger("esri.support.basemapUtils");function If(t,e){return t===e||"equal"===function(t,e){return null!=t!=(null!=e)?"not-equal":t?Ef(t.baseLayers,e.baseLayers)&&Ef(t.referenceLayers,e.referenceLayers)?"equal":"not-equal":"equal"}(Af(t),Af(e))}function jf(t){return!(null==t||!t.baseLayers.concat(t.referenceLayers).some(_f))}function _f(t){if(Of(t.url))return!0;if("vector-tile"===t.type)for(const e in t.sourceNameToSource){const i=t.sourceNameToSource[e];if(Of(null==i?void 0:i.sourceUrl))return!0}return!1}const Tf=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function Of(t){if(!t)return!1;const e=new kt(Ut(t));return Tf.test(e.authority)}function Af(t){return t?!t.loaded&&t.resourceInfo?function(t){return t?{baseLayers:Pf(t.baseMapLayers.filter((t=>!t.isReference))),referenceLayers:Pf(t.baseMapLayers.filter((t=>t.isReference)))}:null}(t.resourceInfo.data):{baseLayers:Ff(t.baseLayers),referenceLayers:Ff(t.referenceLayers)}:null}function Ff(t){return(Jr.isCollection(t)?t.toArray():t).map(Cf)}function Cf(t){return{type:t.type,url:Rf("urlTemplate"in t&&t.urlTemplate||t.url||"styleUrl"in t&&t.styleUrl),minScale:"minScale"in t&&null!=t.minScale?t.minScale:0,maxScale:"maxScale"in t&&null!=t.maxScale?t.maxScale:0,opacity:null!=t.opacity?t.opacity:1,visible:null==t.visible||!!t.visible}}function Pf(t){return t.map((t=>function(t){let e;switch(t.layerType){case"VectorTileLayer":e="vector-tile";break;case"ArcGISTiledMapServiceLayer":e="tile";break;default:e="unknown"}return{type:e,url:Rf(t.templateUrl||t.urlTemplate||t.styleUrl||t.url),minScale:null!=t.minScale?t.minScale:0,maxScale:null!=t.maxScale?t.maxScale:0,opacity:null!=t.opacity?t.opacity:1,visible:null==t.visibility||!!t.visibility}}(t)))}function Ef(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!Lf(t[i],e[i]))return!1;return!0}function Lf(t,e){return t.type===e.type&&t.url===e.url&&t.minScale===e.minScale&&t.maxScale===e.maxScale&&t.visible===e.visible&&t.opacity===e.opacity}function Rf(t){return t?Bt(t).replace(/^\s*https?:/i,"").toLowerCase():""}function Nf(){return[0,0,0]}function Df(t){return[t[0],t[1],t[2]]}function Vf(t,e,i){return[t,e,i]}function $f(t){const e=[0,0,0],i=Math.min(3,t.length);for(let s=0;s<i;++s)e[s]=t[s];return e}function zf(t,e){return new Float64Array(t,e,3)}function Gf(){return Vf(1,1,1)}function Uf(){return Vf(1,0,0)}function qf(){return Vf(0,1,0)}function Bf(){return Vf(0,0,1)}const Wf=[0,0,0],Hf=Gf(),Jf=Uf(),Zf=qf(),Qf=Bf();Object.freeze({__proto__:null,create:Nf,clone:Df,fromValues:Vf,fromArray:$f,createView:zf,zeros:function(){return[0,0,0]},ones:Gf,unitX:Uf,unitY:qf,unitZ:Bf,ZEROS:Wf,ONES:Hf,UNIT_X:Jf,UNIT_Y:Zf,UNIT_Z:Qf});const Kf=1e-6,Yf=Math.random;function Xf(t){return.017453292519943295*t}function tp(t){return 57.29577951308232*t}function ep(t){const e=t[0],i=t[1],s=t[2];return Math.sqrt(e*e+i*i+s*s)}function ip(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function sp(t,e,i,s){return t[0]=e,t[1]=i,t[2]=s,t}function np(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function rp(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function op(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function ap(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function lp(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function up(t,e){const i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(i*i+s*s+n*n)}function cp(t,e){const i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2];return i*i+s*s+n*n}function hp(t){const e=t[0],i=t[1],s=t[2];return e*e+i*i+s*s}function dp(t,e){const i=e[0],s=e[1],n=e[2];let r=i*i+s*s+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r),t}function fp(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function pp(t,e,i){const s=e[0],n=e[1],r=e[2],o=i[0],a=i[1],l=i[2];return t[0]=n*l-r*a,t[1]=r*o-s*l,t[2]=s*a-n*o,t}function yp(t,e,i,s){const n=e[0],r=e[1],o=e[2];return t[0]=n+s*(i[0]-n),t[1]=r+s*(i[1]-r),t[2]=o+s*(i[2]-o),t}function mp(t,e,i){const s=e[0],n=e[1],r=e[2];return t[0]=i[0]*s+i[4]*n+i[8]*r+i[12],t[1]=i[1]*s+i[5]*n+i[9]*r+i[13],t[2]=i[2]*s+i[6]*n+i[10]*r+i[14],t}function gp(t,e,i){const s=e[0],n=e[1],r=e[2];return t[0]=s*i[0]+n*i[3]+r*i[6],t[1]=s*i[1]+n*i[4]+r*i[7],t[2]=s*i[2]+n*i[5]+r*i[8],t}function vp(t,e,i){const s=i[0],n=i[1],r=i[2],o=e[0],a=e[1],l=e[2];let u=n*l-r*a,c=r*o-s*l,h=s*a-n*o,d=n*h-r*c,f=r*u-s*h,p=s*c-n*u;const y=2*i[3];return u*=y,c*=y,h*=y,d*=2,f*=2,p*=2,t[0]=o+u+d,t[1]=a+c+f,t[2]=l+h+p,t}Object.freeze({__proto__:null,EPSILON:Kf,RANDOM:Yf,toRadian:Xf,toDegree:tp,equals:function(t,e){return Math.abs(t-e)<=Kf*Math.max(1,Math.abs(t),Math.abs(e))}});const wp=[0,0,0],bp=[0,0,0];function Mp(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Sp(t,e,i){const s=i[0]-e[0],n=i[1]-e[1],r=i[2]-e[2];let o=s*s+n*n+r*r;return o>0?(o=1/Math.sqrt(o),t[0]=s*o,t[1]=n*o,t[2]=r*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const xp=rp,kp=ep;function Ip(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function jp(t,e,i,s,n){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t}function _p(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function Tp(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function Op(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}function Ap(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}function Fp(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function Cp(t,e){const i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2],r=e[3]-t[3];return Math.sqrt(i*i+s*s+n*n+r*r)}function Pp(t,e){const i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2],r=e[3]-t[3];return i*i+s*s+n*n+r*r}function Ep(t){const e=t[0],i=t[1],s=t[2],n=t[3];return Math.sqrt(e*e+i*i+s*s+n*n)}function Lp(t){const e=t[0],i=t[1],s=t[2],n=t[3];return e*e+i*i+s*s+n*n}function Rp(t,e){const i=e[0],s=e[1],n=e[2],r=e[3];let o=i*i+s*s+n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=i*o,t[1]=s*o,t[2]=n*o,t[3]=r*o),t}function Np(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Dp(t,e,i,s){const n=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n+s*(i[0]-n),t[1]=r+s*(i[1]-r),t[2]=o+s*(i[2]-o),t[3]=a+s*(i[3]-a),t}function Vp(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3];return t[0]=i[0]*s+i[4]*n+i[8]*r+i[12]*o,t[1]=i[1]*s+i[5]*n+i[9]*r+i[13]*o,t[2]=i[2]*s+i[6]*n+i[10]*r+i[14]*o,t[3]=i[3]*s+i[7]*n+i[11]*r+i[15]*o,t}function $p(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function zp(t,e){const i=t[0],s=t[1],n=t[2],r=t[3],o=e[0],a=e[1],l=e[2],u=e[3];return Math.abs(i-o)<=Kf*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(s-a)<=Kf*Math.max(1,Math.abs(s),Math.abs(a))&&Math.abs(n-l)<=Kf*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-u)<=Kf*Math.max(1,Math.abs(r),Math.abs(u))}Object.freeze({__proto__:null,length:ep,copy:ip,set:sp,add:np,subtract:rp,multiply:op,divide:ap,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},min:function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t},max:function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},scale:lp,scaleAndAdd:function(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t},distance:up,squaredDistance:cp,squaredLength:hp,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},normalize:dp,dot:fp,cross:pp,lerp:yp,hermite:function(t,e,i,s,n,r){const o=r*r,a=o*(2*r-3)+1,l=o*(r-2)+r,u=o*(r-1),c=o*(3-2*r);return t[0]=e[0]*a+i[0]*l+s[0]*u+n[0]*c,t[1]=e[1]*a+i[1]*l+s[1]*u+n[1]*c,t[2]=e[2]*a+i[2]*l+s[2]*u+n[2]*c,t},bezier:function(t,e,i,s,n,r){const o=1-r,a=o*o,l=r*r,u=a*o,c=3*r*a,h=3*l*o,d=l*r;return t[0]=e[0]*u+i[0]*c+s[0]*h+n[0]*d,t[1]=e[1]*u+i[1]*c+s[1]*h+n[1]*d,t[2]=e[2]*u+i[2]*c+s[2]*h+n[2]*d,t},random:function(t,e){e=e||1;const i=2*Yf()*Math.PI,s=2*Yf()-1,n=Math.sqrt(1-s*s)*e;return t[0]=Math.cos(i)*n,t[1]=Math.sin(i)*n,t[2]=s*e,t},transformMat4:mp,transformMat3:gp,transformQuat:vp,rotateX:function(t,e,i,s){const n=[],r=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],r[0]=n[0],r[1]=n[1]*Math.cos(s)-n[2]*Math.sin(s),r[2]=n[1]*Math.sin(s)+n[2]*Math.cos(s),t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t},rotateY:function(t,e,i,s){const n=[],r=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],r[0]=n[2]*Math.sin(s)+n[0]*Math.cos(s),r[1]=n[1],r[2]=n[2]*Math.cos(s)-n[0]*Math.sin(s),t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t},rotateZ:function(t,e,i,s){const n=[],r=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],r[0]=n[0]*Math.cos(s)-n[1]*Math.sin(s),r[1]=n[0]*Math.sin(s)+n[1]*Math.cos(s),r[2]=n[2],t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t},angle:function(t,e){ip(wp,t),ip(bp,e),dp(wp,wp),dp(bp,bp);const i=fp(wp,bp);return i>1?0:i<-1?Math.PI:Math.acos(i)},str:function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},exactEquals:Mp,equals:function(t,e){if(t===e)return!0;const i=t[0],s=t[1],n=t[2],r=e[0],o=e[1],a=e[2];return Math.abs(i-r)<=Kf*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(s-o)<=Kf*Math.max(1,Math.abs(s),Math.abs(o))&&Math.abs(n-a)<=Kf*Math.max(1,Math.abs(n),Math.abs(a))},direction:Sp,sub:xp,mul:op,div:ap,dist:up,sqrDist:cp,len:kp,sqrLen:hp}),Object.freeze({__proto__:null,copy:Ip,set:jp,add:_p,subtract:Tp,multiply:Op,divide:Ap,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},min:function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t},max:function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},scale:Fp,scaleAndAdd:function(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t[3]=e[3]+i[3]*s,t},distance:Cp,squaredDistance:Pp,length:Ep,squaredLength:Lp,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},normalize:Rp,dot:Np,lerp:Dp,random:function(t,e){let i,s,n,r,o,a;e=e||1;do{i=2*Yf()-1,s=2*Yf()-1,o=i*i+s*s}while(o>=1);do{n=2*Yf()-1,r=2*Yf()-1,a=n*n+r*r}while(a>=1);const l=Math.sqrt((1-o)/a);return t[0]=e*i,t[1]=e*s,t[2]=e*n*l,t[3]=e*r*l,t},transformMat4:Vp,transformQuat:function(t,e,i){const s=e[0],n=e[1],r=e[2],o=i[0],a=i[1],l=i[2],u=i[3],c=u*s+a*r-l*n,h=u*n+l*s-o*r,d=u*r+o*n-a*s,f=-o*s-a*n-l*r;return t[0]=c*u+f*-o+h*-l-d*-a,t[1]=h*u+f*-a+d*-o-c*-l,t[2]=d*u+f*-l+c*-a-h*-o,t[3]=e[3],t},str:function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},exactEquals:$p,equals:zp,sub:Tp,mul:Op,div:Ap,dist:Cp,sqrDist:Pp,len:Ep,sqrLen:Lp});const Gp=new Float32Array(1);function Up(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function qp(t,e,i){return Math.min(Math.max(t,e),i)}function Bp(t){return 0==(t&t-1)}function Wp(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function Hp(t,e,i){return t+(e-t)*i}function Jp(t){return t*Math.PI/180}function Zp(t){return 180*t/Math.PI}function Qp(t){return Math.acos(qp(t,-1,1))}function Kp(t){return Math.asin(qp(t,-1,1))}function Yp(t,e,i=1e-6){if(isNaN(t)||isNaN(e))return!1;if(t===e)return!0;const s=Math.abs(t-e),n=Math.abs(t),r=Math.abs(e);if(0===t||0===e||n<1e-12&&r<1e-12){if(s>.01*i)return!1}else if(s/(n+r)>i)return!1;return!0}function Xp(t,e,i=1e-6){return!isNaN(t)&&!isNaN(e)&&(t>e?t-e:e-t)<=i}function ty(t){return ey(Math.max(-sy,Math.min(t,sy)))}function ey(t){return Gp[0]=t,Gp[0]}function iy(t,e){const i=ep(t);return sp(e,i,Kp(t[2]/i),Math.atan2(t[1]/i,t[0]/i)),e}const sy=ey(34028234663852886e22);function ny(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ry(t,e,i,s,n,r,o,a,l,u,c,h,d,f,p,y,m){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t[4]=r,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=d,t[12]=f,t[13]=p,t[14]=y,t[15]=m,t}function oy(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ay(t,e){if(t===e){const i=e[1],s=e[2],n=e[3],r=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=s,t[9]=r,t[11]=e[14],t[12]=n,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function ly(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],y=e[13],m=e[14],g=e[15],v=i*a-s*o,w=i*l-n*o,b=i*u-r*o,M=s*l-n*a,S=s*u-r*a,x=n*u-r*l,k=c*y-h*p,I=c*m-d*p,j=c*g-f*p,_=h*m-d*y,T=h*g-f*y,O=d*g-f*m;let A=v*O-w*T+b*_+M*j-S*I+x*k;return A?(A=1/A,t[0]=(a*O-l*T+u*_)*A,t[1]=(n*T-s*O-r*_)*A,t[2]=(y*x-m*S+g*M)*A,t[3]=(d*S-h*x-f*M)*A,t[4]=(l*j-o*O-u*I)*A,t[5]=(i*O-n*j+r*I)*A,t[6]=(m*b-p*x-g*w)*A,t[7]=(c*x-d*b+f*w)*A,t[8]=(o*T-a*j+u*k)*A,t[9]=(s*j-i*T-r*k)*A,t[10]=(p*S-y*b+g*v)*A,t[11]=(h*b-c*S-f*v)*A,t[12]=(a*I-o*_-l*k)*A,t[13]=(i*_-s*I+n*k)*A,t[14]=(y*w-p*M-m*v)*A,t[15]=(c*M-h*w+d*v)*A,t):null}function uy(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],f=e[10],p=e[11],y=e[12],m=e[13],g=e[14],v=e[15];let w=i[0],b=i[1],M=i[2],S=i[3];return t[0]=w*s+b*a+M*h+S*y,t[1]=w*n+b*l+M*d+S*m,t[2]=w*r+b*u+M*f+S*g,t[3]=w*o+b*c+M*p+S*v,w=i[4],b=i[5],M=i[6],S=i[7],t[4]=w*s+b*a+M*h+S*y,t[5]=w*n+b*l+M*d+S*m,t[6]=w*r+b*u+M*f+S*g,t[7]=w*o+b*c+M*p+S*v,w=i[8],b=i[9],M=i[10],S=i[11],t[8]=w*s+b*a+M*h+S*y,t[9]=w*n+b*l+M*d+S*m,t[10]=w*r+b*u+M*f+S*g,t[11]=w*o+b*c+M*p+S*v,w=i[12],b=i[13],M=i[14],S=i[15],t[12]=w*s+b*a+M*h+S*y,t[13]=w*n+b*l+M*d+S*m,t[14]=w*r+b*u+M*f+S*g,t[15]=w*o+b*c+M*p+S*v,t}function cy(t,e,i){const s=i[0],n=i[1],r=i[2];let o,a,l,u,c,h,d,f,p,y,m,g;return e===t?(t[12]=e[0]*s+e[4]*n+e[8]*r+e[12],t[13]=e[1]*s+e[5]*n+e[9]*r+e[13],t[14]=e[2]*s+e[6]*n+e[10]*r+e[14],t[15]=e[3]*s+e[7]*n+e[11]*r+e[15]):(o=e[0],a=e[1],l=e[2],u=e[3],c=e[4],h=e[5],d=e[6],f=e[7],p=e[8],y=e[9],m=e[10],g=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=u,t[4]=c,t[5]=h,t[6]=d,t[7]=f,t[8]=p,t[9]=y,t[10]=m,t[11]=g,t[12]=o*s+c*n+p*r+e[12],t[13]=a*s+h*n+y*r+e[13],t[14]=l*s+d*n+m*r+e[14],t[15]=u*s+f*n+g*r+e[15]),t}function hy(t,e,i){const s=i[0],n=i[1],r=i[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function dy(t,e,i,s){let n,r,o,a,l,u,c,h,d,f,p,y,m,g,v,w,b,M,S,x,k,I,j,_,T=s[0],O=s[1],A=s[2],F=Math.sqrt(T*T+O*O+A*A);return F<Kf?null:(F=1/F,T*=F,O*=F,A*=F,n=Math.sin(i),r=Math.cos(i),o=1-r,a=e[0],l=e[1],u=e[2],c=e[3],h=e[4],d=e[5],f=e[6],p=e[7],y=e[8],m=e[9],g=e[10],v=e[11],w=T*T*o+r,b=O*T*o+A*n,M=A*T*o-O*n,S=T*O*o-A*n,x=O*O*o+r,k=A*O*o+T*n,I=T*A*o+O*n,j=O*A*o-T*n,_=A*A*o+r,t[0]=a*w+h*b+y*M,t[1]=l*w+d*b+m*M,t[2]=u*w+f*b+g*M,t[3]=c*w+p*b+v*M,t[4]=a*S+h*x+y*k,t[5]=l*S+d*x+m*k,t[6]=u*S+f*x+g*k,t[7]=c*S+p*x+v*k,t[8]=a*I+h*j+y*_,t[9]=l*I+d*j+m*_,t[10]=u*I+f*j+g*_,t[11]=c*I+p*j+v*_,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function fy(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function py(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=s+s,l=n+n,u=r+r,c=s*a,h=s*l,d=s*u,f=n*l,p=n*u,y=r*u,m=o*a,g=o*l,v=o*u;return t[0]=1-(f+y),t[1]=h+v,t[2]=d-g,t[3]=0,t[4]=h-v,t[5]=1-(c+y),t[6]=p+m,t[7]=0,t[8]=d+g,t[9]=p-m,t[10]=1-(c+f),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}const yy=[0,0,0];function my(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}function gy(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function vy(t,e){if(t===e)return!0;const i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],f=t[11],p=t[12],y=t[13],m=t[14],g=t[15],v=e[0],w=e[1],b=e[2],M=e[3],S=e[4],x=e[5],k=e[6],I=e[7],j=e[8],_=e[9],T=e[10],O=e[11],A=e[12],F=e[13],C=e[14],P=e[15];return Math.abs(i-v)<=Kf*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(s-w)<=Kf*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(n-b)<=Kf*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-M)<=Kf*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(o-S)<=Kf*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(a-x)<=Kf*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(l-k)<=Kf*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(u-I)<=Kf*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(c-j)<=Kf*Math.max(1,Math.abs(c),Math.abs(j))&&Math.abs(h-_)<=Kf*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(d-T)<=Kf*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(f-O)<=Kf*Math.max(1,Math.abs(f),Math.abs(O))&&Math.abs(p-A)<=Kf*Math.max(1,Math.abs(p),Math.abs(A))&&Math.abs(y-F)<=Kf*Math.max(1,Math.abs(y),Math.abs(F))&&Math.abs(m-C)<=Kf*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(g-P)<=Kf*Math.max(1,Math.abs(g),Math.abs(P))}function wy(t){const e=Kf,i=t[0],s=t[1],n=t[2],r=t[4],o=t[5],a=t[6],l=t[8],u=t[9],c=t[10];return Math.abs(1-(i*i+r*r+l*l))<=e&&Math.abs(1-(s*s+o*o+u*u))<=e&&Math.abs(1-(n*n+a*a+c*c))<=e}function by(t,e){return t[0]=e[0],t[1]=e[1],t}function My(t,e,i){return t[0]=e,t[1]=i,t}function Sy(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function xy(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function ky(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function Iy(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function jy(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function _y(t,e){const i=e[0]-t[0],s=e[1]-t[1];return Math.sqrt(i*i+s*s)}function Ty(t,e){const i=e[0]-t[0],s=e[1]-t[1];return i*i+s*s}function Oy(t){const e=t[0],i=t[1];return Math.sqrt(e*e+i*i)}function Ay(t){const e=t[0],i=t[1];return e*e+i*i}function Fy(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Cy(t,e){const i=e[0],s=e[1];let n=i*i+s*s;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t}function Py(t,e){return t[0]*e[0]+t[1]*e[1]}function Ey(t,e,i){const s=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=s,t}function Ly(t,e,i){const s=e[0],n=e[1];return t[0]=i[0]*s+i[2]*n+i[4],t[1]=i[1]*s+i[3]*n+i[5],t}Object.freeze({__proto__:null,copy:ny,set:ry,identity:oy,transpose:ay,invert:ly,adjoint:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],y=e[13],m=e[14],g=e[15];return t[0]=a*(d*g-f*m)-h*(l*g-u*m)+y*(l*f-u*d),t[1]=-(s*(d*g-f*m)-h*(n*g-r*m)+y*(n*f-r*d)),t[2]=s*(l*g-u*m)-a*(n*g-r*m)+y*(n*u-r*l),t[3]=-(s*(l*f-u*d)-a*(n*f-r*d)+h*(n*u-r*l)),t[4]=-(o*(d*g-f*m)-c*(l*g-u*m)+p*(l*f-u*d)),t[5]=i*(d*g-f*m)-c*(n*g-r*m)+p*(n*f-r*d),t[6]=-(i*(l*g-u*m)-o*(n*g-r*m)+p*(n*u-r*l)),t[7]=i*(l*f-u*d)-o*(n*f-r*d)+c*(n*u-r*l),t[8]=o*(h*g-f*y)-c*(a*g-u*y)+p*(a*f-u*h),t[9]=-(i*(h*g-f*y)-c*(s*g-r*y)+p*(s*f-r*h)),t[10]=i*(a*g-u*y)-o*(s*g-r*y)+p*(s*u-r*a),t[11]=-(i*(a*f-u*h)-o*(s*f-r*h)+c*(s*u-r*a)),t[12]=-(o*(h*m-d*y)-c*(a*m-l*y)+p*(a*d-l*h)),t[13]=i*(h*m-d*y)-c*(s*m-n*y)+p*(s*d-n*h),t[14]=-(i*(a*m-l*y)-o*(s*m-n*y)+p*(s*l-n*a)),t[15]=i*(a*d-l*h)-o*(s*d-n*h)+c*(s*l-n*a),t},determinant:function(t){const e=t[0],i=t[1],s=t[2],n=t[3],r=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],f=t[12],p=t[13],y=t[14],m=t[15];return(e*o-i*r)*(h*m-d*y)-(e*a-s*r)*(c*m-d*p)+(e*l-n*r)*(c*y-h*p)+(i*a-s*o)*(u*m-d*f)-(i*l-n*o)*(u*y-h*f)+(s*l-n*a)*(u*p-c*f)},multiply:uy,translate:cy,scale:hy,rotate:dy,rotateX:function(t,e,i){const s=Math.sin(i),n=Math.cos(i),r=e[4],o=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*n+u*s,t[5]=o*n+c*s,t[6]=a*n+h*s,t[7]=l*n+d*s,t[8]=u*n-r*s,t[9]=c*n-o*s,t[10]=h*n-a*s,t[11]=d*n-l*s,t},rotateY:function(t,e,i){const s=Math.sin(i),n=Math.cos(i),r=e[0],o=e[1],a=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*n-u*s,t[1]=o*n-c*s,t[2]=a*n-h*s,t[3]=l*n-d*s,t[8]=r*s+u*n,t[9]=o*s+c*n,t[10]=a*s+h*n,t[11]=l*s+d*n,t},rotateZ:function(t,e,i){const s=Math.sin(i),n=Math.cos(i),r=e[0],o=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*n+u*s,t[1]=o*n+c*s,t[2]=a*n+h*s,t[3]=l*n+d*s,t[4]=u*n-r*s,t[5]=c*n-o*s,t[6]=h*n-a*s,t[7]=d*n-l*s,t},fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},fromScaling:function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotation:function(t,e,i){let s,n,r,o=i[0],a=i[1],l=i[2],u=Math.sqrt(o*o+a*a+l*l);return u<Kf?null:(u=1/u,o*=u,a*=u,l*=u,s=Math.sin(e),n=Math.cos(e),r=1-n,t[0]=o*o*r+n,t[1]=a*o*r+l*s,t[2]=l*o*r-a*s,t[3]=0,t[4]=o*a*r-l*s,t[5]=a*a*r+n,t[6]=l*a*r+o*s,t[7]=0,t[8]=o*l*r+a*s,t[9]=a*l*r-o*s,t[10]=l*l*r+n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},fromXRotation:fy,fromYRotation:function(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromZRotation:function(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotationTranslation:py,fromQuat2:function(t,e){const i=yy,s=-e[0],n=-e[1],r=-e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=s*s+n*n+r*r+o*o;return h>0?(i[0]=2*(a*o+c*s+l*r-u*n)/h,i[1]=2*(l*o+c*n+u*s-a*r)/h,i[2]=2*(u*o+c*r+a*n-l*s)/h):(i[0]=2*(a*o+c*s+l*r-u*n),i[1]=2*(l*o+c*n+u*s-a*r),i[2]=2*(u*o+c*r+a*n-l*s)),py(t,e,i),t},getTranslation:function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},getScaling:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.sqrt(i*i+s*s+n*n),t[1]=Math.sqrt(r*r+o*o+a*a),t[2]=Math.sqrt(l*l+u*u+c*c),t},getRotation:function(t,e){const i=e[0]+e[5]+e[10];let s=0;return i>0?(s=2*Math.sqrt(i+1),t[3]=.25*s,t[0]=(e[6]-e[9])/s,t[1]=(e[8]-e[2])/s,t[2]=(e[1]-e[4])/s):e[0]>e[5]&&e[0]>e[10]?(s=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/s,t[0]=.25*s,t[1]=(e[1]+e[4])/s,t[2]=(e[8]+e[2])/s):e[5]>e[10]?(s=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/s,t[0]=(e[1]+e[4])/s,t[1]=.25*s,t[2]=(e[6]+e[9])/s):(s=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/s,t[0]=(e[8]+e[2])/s,t[1]=(e[6]+e[9])/s,t[2]=.25*s),t},fromRotationTranslationScale:function(t,e,i,s){const n=e[0],r=e[1],o=e[2],a=e[3],l=n+n,u=r+r,c=o+o,h=n*l,d=n*u,f=n*c,p=r*u,y=r*c,m=o*c,g=a*l,v=a*u,w=a*c,b=s[0],M=s[1],S=s[2];return t[0]=(1-(p+m))*b,t[1]=(d+w)*b,t[2]=(f-v)*b,t[3]=0,t[4]=(d-w)*M,t[5]=(1-(h+m))*M,t[6]=(y+g)*M,t[7]=0,t[8]=(f+v)*S,t[9]=(y-g)*S,t[10]=(1-(h+p))*S,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},fromRotationTranslationScaleOrigin:function(t,e,i,s,n){const r=e[0],o=e[1],a=e[2],l=e[3],u=r+r,c=o+o,h=a+a,d=r*u,f=r*c,p=r*h,y=o*c,m=o*h,g=a*h,v=l*u,w=l*c,b=l*h,M=s[0],S=s[1],x=s[2],k=n[0],I=n[1],j=n[2],_=(1-(y+g))*M,T=(f+b)*M,O=(p-w)*M,A=(f-b)*S,F=(1-(d+g))*S,C=(m+v)*S,P=(p+w)*x,E=(m-v)*x,L=(1-(d+y))*x;return t[0]=_,t[1]=T,t[2]=O,t[3]=0,t[4]=A,t[5]=F,t[6]=C,t[7]=0,t[8]=P,t[9]=E,t[10]=L,t[11]=0,t[12]=i[0]+k-(_*k+A*I+P*j),t[13]=i[1]+I-(T*k+F*I+E*j),t[14]=i[2]+j-(O*k+C*I+L*j),t[15]=1,t},fromQuat:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=i+i,a=s+s,l=n+n,u=i*o,c=s*o,h=s*a,d=n*o,f=n*a,p=n*l,y=r*o,m=r*a,g=r*l;return t[0]=1-h-p,t[1]=c+g,t[2]=d-m,t[3]=0,t[4]=c-g,t[5]=1-u-p,t[6]=f+y,t[7]=0,t[8]=d+m,t[9]=f-y,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},frustum:function(t,e,i,s,n,r,o){const a=1/(i-e),l=1/(n-s),u=1/(r-o);return t[0]=2*r*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*r*l,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(n+s)*l,t[10]=(o+r)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*r*2*u,t[15]=0,t},perspective:function(t,e,i,s,n){const r=1/Math.tan(e/2);let o;return t[0]=r/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(o=1/(s-n),t[10]=(n+s)*o,t[14]=2*n*s*o):(t[10]=-1,t[14]=-2*s),t},perspectiveFromFieldOfView:function(t,e,i,s){const n=Math.tan(e.upDegrees*Math.PI/180),r=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),u=2/(n+r);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(n-r)*u*.5,t[10]=s/(i-s),t[11]=-1,t[12]=0,t[13]=0,t[14]=s*i/(i-s),t[15]=0,t},ortho:function(t,e,i,s,n,r,o){const a=1/(e-i),l=1/(s-n),u=1/(r-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*a,t[13]=(n+s)*l,t[14]=(o+r)*u,t[15]=1,t},lookAt:function(t,e,i,s){let n,r,o,a,l,u,c,h,d,f;const p=e[0],y=e[1],m=e[2],g=s[0],v=s[1],w=s[2],b=i[0],M=i[1],S=i[2];return Math.abs(p-b)<Kf&&Math.abs(y-M)<Kf&&Math.abs(m-S)<Kf?oy(t):(c=p-b,h=y-M,d=m-S,f=1/Math.sqrt(c*c+h*h+d*d),c*=f,h*=f,d*=f,n=v*d-w*h,r=w*c-g*d,o=g*h-v*c,f=Math.sqrt(n*n+r*r+o*o),f?(f=1/f,n*=f,r*=f,o*=f):(n=0,r=0,o=0),a=h*o-d*r,l=d*n-c*o,u=c*r-h*n,f=Math.sqrt(a*a+l*l+u*u),f?(f=1/f,a*=f,l*=f,u*=f):(a=0,l=0,u=0),t[0]=n,t[1]=a,t[2]=c,t[3]=0,t[4]=r,t[5]=l,t[6]=h,t[7]=0,t[8]=o,t[9]=u,t[10]=d,t[11]=0,t[12]=-(n*p+r*y+o*m),t[13]=-(a*p+l*y+u*m),t[14]=-(c*p+h*y+d*m),t[15]=1,t)},targetTo:function(t,e,i,s){const n=e[0],r=e[1],o=e[2],a=s[0],l=s[1],u=s[2];let c=n-i[0],h=r-i[1],d=o-i[2],f=c*c+h*h+d*d;f>0&&(f=1/Math.sqrt(f),c*=f,h*=f,d*=f);let p=l*d-u*h,y=u*c-a*d,m=a*h-l*c;return f=p*p+y*y+m*m,f>0&&(f=1/Math.sqrt(f),p*=f,y*=f,m*=f),t[0]=p,t[1]=y,t[2]=m,t[3]=0,t[4]=h*m-d*y,t[5]=d*p-c*m,t[6]=c*y-h*p,t[7]=0,t[8]=c,t[9]=h,t[10]=d,t[11]=0,t[12]=n,t[13]=r,t[14]=o,t[15]=1,t},str:function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},frob:function(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)},add:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t},subtract:my,multiplyScalar:function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t},multiplyScalarAndAdd:function(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t[3]=e[3]+i[3]*s,t[4]=e[4]+i[4]*s,t[5]=e[5]+i[5]*s,t[6]=e[6]+i[6]*s,t[7]=e[7]+i[7]*s,t[8]=e[8]+i[8]*s,t[9]=e[9]+i[9]*s,t[10]=e[10]+i[10]*s,t[11]=e[11]+i[11]*s,t[12]=e[12]+i[12]*s,t[13]=e[13]+i[13]*s,t[14]=e[14]+i[14]*s,t[15]=e[15]+i[15]*s,t},exactEquals:gy,equals:vy,isOrthoNormal:wy,mul:uy,sub:my});const Ry=xy;function Ny(){return[0,0]}function Dy(t,e){return[t,e]}function Vy(t,e){return new Float64Array(t,e,2)}function $y(){return Dy(1,1)}function zy(){return Dy(1,0)}function Gy(){return Dy(0,1)}Object.freeze({__proto__:null,copy:by,set:My,add:Sy,subtract:xy,multiply:ky,divide:Iy,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},min:function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},max:function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},scale:jy,scaleAndAdd:function(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t},distance:_y,squaredDistance:Ty,length:Oy,squaredLength:Ay,negate:Fy,inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},normalize:Cy,dot:Py,cross:Ey,lerp:function(t,e,i,s){const n=e[0],r=e[1];return t[0]=n+s*(i[0]-n),t[1]=r+s*(i[1]-r),t},random:function(t,e){e=e||1;const i=2*Yf()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t},transformMat2:function(t,e,i){const s=e[0],n=e[1];return t[0]=i[0]*s+i[2]*n,t[1]=i[1]*s+i[3]*n,t},transformMat2d:Ly,transformMat3:function(t,e,i){const s=e[0],n=e[1];return t[0]=i[0]*s+i[3]*n+i[6],t[1]=i[1]*s+i[4]*n+i[7],t},transformMat4:function(t,e,i){const s=e[0],n=e[1];return t[0]=i[0]*s+i[4]*n+i[12],t[1]=i[1]*s+i[5]*n+i[13],t},rotate:function(t,e,i,s){const n=e[0]-i[0],r=e[1]-i[1],o=Math.sin(s),a=Math.cos(s);return t[0]=n*a-r*o+i[0],t[1]=n*o+r*a+i[1],t},angle:function(t,e){const i=t[0],s=t[1],n=e[0],r=e[1];let o=i*i+s*s;o>0&&(o=1/Math.sqrt(o));let a=n*n+r*r;a>0&&(a=1/Math.sqrt(a));const l=(i*n+s*r)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)},str:function(t){return"vec2("+t[0]+", "+t[1]+")"},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]},equals:function(t,e){const i=t[0],s=t[1],n=e[0],r=e[1];return Math.abs(i-n)<=Kf*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(s-r)<=Kf*Math.max(1,Math.abs(s),Math.abs(r))},projectAndScale:function(t,e,i,s,n){let r=e[0]-i[0],o=e[1]-i[1];const a=(s[0]*r+s[1]*o)*(n-1);return r=s[0]*a,o=s[1]*a,t[0]=e[0]+r,t[1]=e[1]+o,t},len:Oy,sub:Ry,mul:ky,div:Iy,dist:_y,sqrDist:Ty,sqrLen:Ay});const Uy=$y(),qy=zy(),By=Gy();function Wy(t,e,i={}){return Hy(t,e,i,Jy)}function Hy(t,e,i={},s){let n=null;const r=i.once?(t,i)=>{s(t)&&(v(n),e(t,i))}:(t,i)=>{s(t)&&e(t,i)};if(n=function(t,e,i=!1,s=J){return i?function(t,e,i){let s=!1;return nn(t,((t,n)=>{s||(s=!0,i(n,t)||e(t,n),s=!1)}))}(t,e,s):function(t,e,i){let s,n,r=rn(t,((t,o)=>{s&&s.uid!==n?r.remove():(s||(s=un.acquireTracked(t,e,o,i),n=s.uid),fn(s))}));return{remove:Di((()=>{r.remove(),s&&(s.uid!==n||s.removed||(s.removed=!0,fn(s)),s=null),r=null}))}}(t,e,s)}(t,r,i.sync,i.equals),i.initial){const e=t();r(e,e)}return n}function Jy(){return!0}function Zy(t){return!!t}Object.freeze({__proto__:null,create:Ny,clone:function(t){return[t[0],t[1]]},fromValues:Dy,fromArray:function(t){const e=[0,0],i=Math.min(2,t.length);for(let s=0;s<i;++s)e[s]=t[s];return e},createView:Vy,zeros:function(){return[0,0]},ones:$y,unitX:zy,unitY:Gy,ZEROS:[0,0],ONES:Uy,UNIT_X:qy,UNIT_Y:By});const Qy={sync:!0};let Ky=class extends Ar{constructor(){super(...arguments),this._tasks=[],this.running=!1}get length(){return this._tasks.length}destroy(){this.cancelAll()}runTask(t){for(;!t.done&&this._process(t);)t.madeProgress()}push(t,e,i){return this.running=!0,new Promise(((s,n)=>this._tasks.push(new Yy(s,n,t,e,i))))}unshift(t,e,i){return this.running=!0,new Promise(((s,n)=>this._tasks.unshift(new Yy(s,n,t,e,i))))}_process(t){if(0===this._tasks.length)return!1;const e=this._tasks.shift();try{const i=Re(e.signal);if(i&&!e.abortCallback)e.reject(Pe());else{const s=i?e.abortCallback(Pe()):e.callback(t);Ye(s)?s.then(e.resolve,e.reject):e.resolve(s)}}catch(t){e.reject(t)}return this.running=this._tasks.length>0,!0}cancelAll(){const t=Pe();for(const e of this._tasks)if(e.abortCallback){const i=e.abortCallback(t);e.resolve(i)}else e.reject(t);this._tasks.length=0,this.running=!1}};e([Hn()],Ky.prototype,"running",void 0),Ky=e([_r("esri.layers.support.PromiseQueue")],Ky);class Yy{constructor(t,e,i,s,n){this.resolve=t,this.reject=e,this.callback=i,this.signal=s,this.abortCallback=n}}let Xy=class extends Ar{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};e([Hn()],Xy.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),e([Hn()],Xy.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),Xy=e([_r("esri.views.support.DebugFlags")],Xy);const tm=new Xy,em=ct.getLogger("esri.views.support.Scheduler");var im;!function(t){t.RESOURCE_CONTROLLER="schedule",t.SLIDE="slide",t.STREAM_DATA_LOADER="stream loader",t.ELEVATION_QUERY="elevation query",t.TERRAIN_SURFACE="terrain",t.SURFACE_GEOMETRY_UPDATES="surface geometry updates",t.GRAPHICS_CORE="Graphics3D",t.I3S_CONTROLLER="I3S",t.POINT_CLOUD_LAYER="point cloud",t.FEATURE_TILE_FETCHER="feature fetcher",t.OVERLAY="overlay",t.STAGE="stage",t.GRAPHICS_DECONFLICTOR="graphics deconflictor",t.FILTER_VISIBILITY="Graphics3D filter visibility",t.SCALE_VISIBILITY="Graphics3D scale visibility",t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",t.POINT_OF_INTEREST_FREQUENT="POI frequent",t.POINT_OF_INTEREST_INFREQUENT="POI infrequent",t.LABELER="labeler",t.FEATURE_QUERY_ENGINE="feature query",t.FEATURE_TILE_TREE="feature tile tree",t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",t.ELEVATION_ALIGNMENT="elevation alignment",t.TEXT_TEXTURE_ATLAS="text texture atlas",t.TEXTURE_UNLOAD="texture unload",t.LINE_OF_SIGHT_TOOL="line of sight tool",t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",t.ELEVATION_PROFILE="elevation profile",t.SNAPPING="snapping",t.SHADOW_ACCUMULATOR="shadow accumulator",t.CLOUDS_GENERATOR="cloud generator",t[t.TEST_PRIO=1]="TEST_PRIO"}(im||(im={}));const sm=new Map([[im.RESOURCE_CONTROLLER,0],[im.SLIDE,0],[im.STREAM_DATA_LOADER,0],[im.ELEVATION_QUERY,0],[im.TERRAIN_SURFACE,1],[im.SURFACE_GEOMETRY_UPDATES,1],[im.GRAPHICS_CORE,2],[im.I3S_CONTROLLER,2],[im.POINT_CLOUD_LAYER,2],[im.FEATURE_TILE_FETCHER,2],[im.OVERLAY,4],[im.STAGE,4],[im.GRAPHICS_DECONFLICTOR,4],[im.FILTER_VISIBILITY,4],[im.SCALE_VISIBILITY,4],[im.FRUSTUM_VISIBILITY,4],[im.POINT_OF_INTEREST_FREQUENT,6],[im.POINT_OF_INTEREST_INFREQUENT,30],[im.LABELER,8],[im.FEATURE_QUERY_ENGINE,8],[im.FEATURE_TILE_TREE,16],[im.FEATURE_TILE_TREE_ACTIVE,0],[im.ELEVATION_ALIGNMENT,12],[im.TEXT_TEXTURE_ATLAS,12],[im.CLOUDS_GENERATOR,12],[im.TEXTURE_UNLOAD,12],[im.LINE_OF_SIGHT_TOOL,16],[im.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[im.SNAPPING,0],[im.SHADOW_ACCUMULATOR,30]]);function nm(t){return sm.has(t)?sm.get(t):"number"==typeof t?t:1}const rm=1e3/30;var om,am;!function(t){let i=class extends Ar{constructor(t){super(t),this.updating=!0,this._microTaskQueued=!1,this.performanceInfo={total:new Ts("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=null,this._state=1,this._tasks=new Fs,this._runQueue=new Fs,this._load=0,this._idleStateCallbacks=new Fs,this._idleUpdatesStartFired=!1,this._maxReschedule=cm,this._forceTask=!1,this._debug=!1,this._debugHandle=Yr(tm,"SCHEDULER_LOG_SLOW_TASKS",(t=>this._debug=t)),this._budget=new n(t.nowFunc);for(const t of Object.keys(im))this.performanceInfo.tasks.set(im[t],new Ts(im[t]));let e;const i=this;this._test={get state(){return y(e,i._state)},set state(t){e=t},FRAME_SAFETY_BUDGET:6.5,INTERACTING_BUDGET:rm,IDLE_BUDGET:100,get budget(){return i._budget.budget},usedBudget:0,setBudget:t=>i._budget=t,updateTask:t=>this._updateTask(t),getState:t=>this._getState(t),getRuntime:t=>this._getRuntime(t),resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._debugHandle&&this._debugHandle.remove(),this._microTaskQueued=!1}activate(){this._budget.done||this._microTaskQueued||(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.done||(this._maxReschedule=cm,this._schedule(),this.frame()))})))}registerTask(t,e){const i=nm(t),n=new s(this,t,e,i);return this._tasks.push(n),this.performanceInfo.tasks.has(t)||this.performanceInfo.tasks.set(t,new Ts(t)),n}registerIdleStateCallbacks(t,e){const i={idleBegin:t,idleEnd:e};this._idleStateCallbacks.push(i),2===this.state&&this._idleUpdatesStartFired&&i.idleBegin();const s=this;return{remove:()=>this._removeIdleStateCallbacks(i),set idleBegin(t){s._idleUpdatesStartFired&&(i.idleEnd(),2===s._state&&t()),i.idleBegin=t},set idleEnd(t){i.idleEnd=t}}}get now(){return this.nowFunc()}get load(){return this._load}set state(t){this._state!==t&&(this._state=t,2!==this.state&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((t=>t.idleEnd()))))}get state(){return c(this._test.state)?this._state:this._test.state}updateBudget(t){this._test.usedBudget=0;let e=6.5,i=t.frameDuration,s=1;switch(this.state){case 2:e=0,i=Math.max(100,t.frameDuration),s=30;break;case 1:i=Math.max(rm,t.frameDuration)}return i=i-t.elapsedFrameTime-e,2!==this.state&&i<1&&!this._forceTask?(this._forceTask=!0,!1):(i=Math.max(i,s),this._budget.reset(i,this.state),this._maxReschedule=cm,this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case 2:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((t=>t.idleBegin()))),this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset(0,this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(t){this._idleUpdatesStartFired&&t.idleEnd(),this._idleStateCallbacks.removeUnordered(t)}removeTask(t){this._tasks.removeUnordered(t),this._runQueue.removeUnordered(t)}_updateTask(t){this._tasks.forAll((e=>{e.name===t&&e.setPriority(t)}))}_getState(t){if(this._runQueue.some((e=>e.name===t)))return am.SCHEDULED;let e=am.IDLE;return this._tasks.forAll((i=>{i.name===t&&i.needsUpdate&&(i.schedulePriority<=1?e=am.READY:e!==am.READY&&(e=am.WAITING))})),e}_getRuntime(t){let e=0;return this._tasks.forAll((i=>{i.name===t&&(e+=i.runtime)})),e}_resetRuntimes(){this._tasks.forAll((t=>t.runtime=0))}_getRunning(){const t=new Map;if(this._tasks.forAll((e=>{e.needsUpdate&&t.set(e.name,(t.get(e.name)||0)+1)})),0===t.size)return null;let e="";return t.forEach(((t,i)=>{e+=t>1?` ${t}x ${i}`:" "+i})),e}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const t=this._tasks.reduce(((t,e)=>e.needsUpdate?++t:t),0);this._load=.9*this._load+t*(1-.9)}_schedule(){if(this._maxReschedule<=0)return!1;for(this._runQueue.filterInPlace((t=>!!t.needsUpdate||(t.schedulePriority=t.basePriority,!1))),this._tasks.forAll((t=>{0===t.basePriority&&t.needsUpdate&&!this._runQueue.some((e=>e===t))&&this._runQueue.unshift(t)}));0===this._runQueue.length;){let t=!1,e=0;if(this._tasks.forAll((i=>{i.needsUpdate&&0!==i.schedulePriority&&0!==i.basePriority&&(t=!0,e=Math.max(e,i.basePriority),1===i.schedulePriority?(i.schedulePriority=0,this._runQueue.push(i)):--i.schedulePriority)})),!t)return this.updating=!1,!1;this._maxReschedule===cm&&(this._maxReschedule=e),--this._maxReschedule}return this.updating=!0,!0}_run(){const t=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){const e=this._budget.now(),i=this._runQueue.pop();this._budget.resetProgress();try{i.task.runTask(this._budget)}catch(t){em.error(`Exception in task "${i.name}"`,t)}i.schedulePriority=i.basePriority;const s=this._budget.now()-e;if(i.runtime+=s,this._frameTaskTimes.set(i.priority,this._frameTaskTimes.get(i.priority)+s),this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",i.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return void this._recordFrameTaskTimes(this._budget.now()-t)}}while(this._schedule());this._recordFrameTaskTimes(this._budget.now()-t)}_startFrameTaskTimes(){for(const t of Object.keys(im))this._frameTaskTimes.set(im[t],0)}_recordFrameTaskTimes(t){this._frameTaskTimes.forEach(((t,e)=>this.performanceInfo.tasks.get(e).record(t))),this.performanceInfo.total.record(t)}get test(){return this._test}};e([Hn()],i.prototype,"updating",void 0),e([Hn()],i.prototype,"nowFunc",void 0),i=e([_r("esri.views.support.Scheduler")],i),t.Scheduler=i;let s=class extends Ar{constructor(t,e,i,s){super({}),this._scheduler=t,this.name=e,this._basePriority=s,this.runtime=0,this._queue=new Ky,this._handles=new Qr,this.schedulePriority=this._basePriority,this.task=u(i)?i:this._queue,this._handles.add(function(t,e,i={}){return Hy(t,e,i,Zy)}((()=>this.task.running),(()=>t.activate())))}get updating(){return this._queue.running}normalizeCtorArgs(){return{}}remove(){this.processQueue(lm),this._scheduler.removeTask(this),this.schedule=um.schedule,this.reschedule=um.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(t){this.name=t;const e=nm(t);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=e),this._basePriority=e}get priority(){return this.name}set priority(t){this.setPriority(t)}get needsUpdate(){return this.updating||this.task.running}schedule(t,e,i){return this._queue.push(t,e,i)}reschedule(t,e,i){return this._queue.unshift(t,e,i)}processQueue(t){this._queue.runTask(t)}};e([Hn({constructOnly:!0})],s.prototype,"task",void 0),e([Hn({readOnly:!0})],s.prototype,"updating",null),s=e([_r("esri.views.support.SchedulerTask")],s);class n{constructor(t){this.now=t,this._begin=0,this._budget=0,this._state=2,this._didWork=!1,this._enabled=!0}run(t){return!this.done&&(!0===t()&&(this._didWork=!0),!0)}get done(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}get budget(){return this._budget}madeProgress(){this._didWork=!0}get state(){return this._state}get enabled(){return this._enabled}set enabled(t){this._enabled=t}reset(t,e){this._begin=this.now(),this._budget=t,this._state=e,this._didWork=!1}get remaining(){return Math.max(this._budget-this.elapsed,0)}get elapsed(){return this.now()-this._begin}resetProgress(){this._didWork=!1}get hasProgressed(){return this._didWork}}t.Budget=n}(om||(om={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(am||(am={}));const lm=(()=>{const t=new om.Budget((()=>performance.now()));return t.enabled=!1,t})(),um=new class{remove(){}processQueue(){}schedule(t,e,i){try{if(Re(e)){const t=Pe();return i?Promise.resolve(i(t)):Promise.reject(t)}return Ke(t(lm))}catch(t){return Promise.reject(t)}}reschedule(t,e,i){return this.schedule(t,e,i)}},cm=Number.MAX_SAFE_INTEGER;function hm(t){return new Lh({wkt:`GEOCCS["Spherical geocentric",\n    DATUM["Not specified",\n      SPHEROID["Sphere",${t.radius},0]],\n    PRIMEM["Greenwich",0.0,\n      AUTHORITY["EPSG","8901"]],\n    UNIT["m",1.0],\n    AXIS["Geocentric X",OTHER],\n    AXIS["Geocentric Y",EAST],\n    AXIS["Geocentric Z",NORTH]\n  ]`})}const dm=hm($h),fm=hm(zh),pm=hm(Gh),ym=new Lh({wkt:`GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",${$h.radius},298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]`});function mm(t){return t&&t===zh?fm:t&&t===Gh?pm:dm}function gm(t){return t&&(Th(t)||t===fm)?fm:t&&(Ah(t)||t===pm)?pm:dm}function vm(t){return t&&(Th(t)||t===fm)?zh:t&&(Ah(t)||t===pm)?Gh:$h}function wm(t){return _h(t)?zh:Oh(t)?Gh:$h}const bm=39.37,Mm=$h.radius*Math.PI/200,Sm=/UNIT\[([^\]]+)\]\]$/i,xm=ph,km=/UNIT\[([^\]]+)\]/i,Im=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),jm=wo()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),_m=t=>t*t,Tm=t=>t*t*t,Om={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:_m(.001)},"square-centimeters":{inBaseUnits:_m(.01)},"square-decimeters":{inBaseUnits:_m(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:_m(1e3)},"square-inches":{inBaseUnits:_m(.0254)},"square-feet":{inBaseUnits:_m(.3048)},"square-yards":{inBaseUnits:_m(.9144)},"square-miles":{inBaseUnits:_m(1609.344)},"square-us-feet":{inBaseUnits:_m(1200/3937)},acres:{inBaseUnits:.0015625*_m(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*Tm(.001)},"cubic-centimeters":{inBaseUnits:1e3*Tm(.01)},"cubic-decimeters":{inBaseUnits:1e3*Tm(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*Tm(1e3)},"cubic-inches":{inBaseUnits:1e3*Tm(.0254)},"cubic-feet":{inBaseUnits:1e3*Tm(.3048)},"cubic-yards":{inBaseUnits:1e3*Tm(.9144)},"cubic-miles":{inBaseUnits:1e3*Tm(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},Am=function(){const t={};for(const e in Om)for(const i in Om[e].units)t[i]=e;return t}();function Fm(t){const e=Am[t];if(e)return e;throw Error("unknown measure")}function Cm(t,e=null){return e=e||Fm(t),Om[e].baseUnit===t}function Pm(t,e,i){if(e===i)return t;const s=Fm(e);if(s!==Fm(i))throw Error("incompatible units");const n=Cm(e,s)?t:function(t,e,i){return t*Om[i].units[e].inBaseUnits}(t,e,s);return Cm(i,s)?n:function(t,e,i){return t/Om[i].units[e].inBaseUnits}(n,i,s)}function Em(t){return jm.fromJSON(t.toLowerCase())||null}function Lm(t){if(t&&"object"==typeof t&&!function(t){return!(Th(t)||Ah(t))}(t))return 1;const e=Rm(t);return e>1e5?1:e}function Rm(t,e=$h.metersPerDegree){return Nm(t,!0)||e}function Nm(t,e=!1){let i,s,n=null;if(null!=t&&("object"==typeof t?(i=t.wkid,s=t.wkt):"number"==typeof t?i=t:"string"==typeof t&&(s=t)),i){if(_h(i))return zh.metersPerDegree;if(Oh(i))return Gh.metersPerDegree;n=xm.values[xm[i]],!n&&e&&Im.has(i)&&(n=Mm)}else s&&(Gm(s)?n=Dm(Sm.exec(s),n):zm(s)&&(n=Dm(km.exec(s),n)));return n}function Dm(t,e){return t&&t[1]?Vm(t[1]):e}function Vm(t){return parseFloat(t.split(",")[1])}function $m(t){let e,i,s=null;if(null!=t&&("object"==typeof t?(e=t.wkid,i=t.wkt):"number"==typeof t?e=t:"string"==typeof t&&(i=t)),e)s=xm.units[xm[e]];else if(i){const t=Gm(i)?Sm:zm(i)?km:null;if(t){const e=t.exec(i);e&&e[1]&&(s=function(t){const e=/[\\"\\']{1}([^\\"\\']+)/.exec(t);let i=e&&e[1];if(!i||-1===xm.units.indexOf(i)){const e=Vm(t);i=null;const s=xm.values;for(let t=0;t<s.length;++t)if(Math.abs(e-s[t])<1e-7){i=xm.units[t];break}}return i}(e[1]))}}return u(s)?Em(s):null}function zm(t){return/^GEOCCS/i.test(t)}function Gm(t){return/^PROJCS/i.test(t)}const Um={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},qm={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},Bm=wo()(Um),Wm=wo()(qm);function Hm(t,e,i=!1){let{hasM:s,hasZ:n}=t;Array.isArray(e)?4!==e.length||s||n?3===e.length&&i&&!s?(n=!0,s=!1):3===e.length&&s&&n&&(s=!1,n=!1):(s=!0,n=!0):(n=!n&&e.hasZ&&(!s||e.hasM),s=!s&&e.hasM&&(!n||e.hasZ)),t.hasZ=n,t.hasM=s}var Jm;function Zm(t){return(e,i)=>null==e?i:null==i?e:t(e,i)}wo()({...Um,...qm});let Qm=Jm=class extends Dh{constructor(...t){super(...t),this.points=[],this.type="multipoint"}normalizeCtorArgs(t,e){if(!t&&!e)return null;const i={};Array.isArray(t)?(i.points=t,i.spatialReference=e):function(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}(t)?i.spatialReference=t:(t.points&&(i.points=t.points),t.spatialReference&&(i.spatialReference=t.spatialReference),t.hasZ&&(i.hasZ=t.hasZ),t.hasM&&(i.hasM=t.hasM));const s=i.points&&i.points[0];return s&&(void 0===i.hasZ&&void 0===i.hasM?(i.hasZ=s.length>2,i.hasM=!1):void 0===i.hasZ?i.hasZ=s.length>3:void 0===i.hasM&&(i.hasM=s.length>3)),i}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=this.points;if(!t.length)return null;const e=new Ld,i=this.hasZ,s=this.hasM,n=i?3:2,r=t[0],o=Zm(Math.min),a=Zm(Math.max);let l,u,c,h,[d,f]=r,[p,y]=r;for(let e=0,r=t.length;e<r;e++){const r=t[e],[m,g]=r;if(d=o(d,m),f=o(f,g),p=a(p,m),y=a(y,g),i&&r.length>2){const t=r[2];l=o(l,t),c=a(c,t)}if(s&&r.length>n){const t=r[n];u=o(u,t),h=a(h,t)}}return e.xmin=d,e.ymin=f,e.xmax=p,e.ymax=y,e.spatialReference=this.spatialReference,i?(e.zmin=l,e.zmax=c):(e.zmin=null,e.zmax=null),s?(e.mmin=u,e.mmax=h):(e.mmin=null,e.mmax=null),e}writePoints(t,e){e.points=H(this.points)}addPoint(t){return Hm(this,t),this.points.push(Array.isArray(t)?t:t.toArray()),this.notifyChange("points"),this}clone(){const t={points:H(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new Jm(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],i={x:e[0],y:e[1],spatialReference:this.spatialReference};let s=2;return this.hasZ&&(i.z=e[2],s=3),this.hasM&&(i.m=e[s]),new ad(i)}removePoint(t){if(!this._validateInputs(t))return null;const e=new ad(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(Hm(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return null!=t&&t>=0&&t<this.points.length}};e([Hn({readOnly:!0})],Qm.prototype,"cache",null),e([Hn()],Qm.prototype,"extent",null),e([Hn({type:[[Number]],json:{write:{isRequired:!0}}})],Qm.prototype,"points",void 0),e([fh("points")],Qm.prototype,"writePoints",null),Qm=Jm=e([_r("esri.geometry.Multipoint")],Qm),Qm.prototype.toJSON.isDefaultToJSON=!0;const Km=Qm;let Ym,Xm=null;function tg(){return!!Xm}function eg(){return Ym||(Ym=import("./p-80d464d6.js").then((t=>t.p)).then((({default:t})=>t({locateFile:t=>Ii("esri/geometry/support/"+t)}))).then((t=>{yg(t)})),Ym)}var ig,sg,ng;!function(t){function e(t,e,i){Xm.ensureCache.prepare();const s=vg(i),n=i===s,r=Xm.ensureFloat64(s),o=Xm._pe_geog_to_proj(Xm.getPointer(t),e,r);return o&&wg(i,e,r,n),o}function i(t,e,i){return s(t,e,i,0)}function s(t,e,i,s){Xm.ensureCache.prepare();const n=vg(i),r=i===n,o=Xm.ensureFloat64(n),a=Xm._pe_proj_to_geog_center(Xm.getPointer(t),e,o,s);return a&&wg(i,e,o,r),a}t.geogToProj=e,t.projGeog=function(t,s,n,r){switch(r){case sg.PE_TRANSFORM_P_TO_G:return i(t,s,n);case sg.PE_TRANSFORM_G_TO_P:return e(t,s,n)}return 0},t.projToGeog=i,t.projToGeogCenter=s}(ig||(ig={})),function(t){t.init=function(){t.PE_BUFFER_MAX=Xm.PeDefs.prototype.PE_BUFFER_MAX,t.PE_NAME_MAX=Xm.PeDefs.prototype.PE_NAME_MAX,t.PE_MGRS_MAX=Xm.PeDefs.prototype.PE_MGRS_MAX,t.PE_USNG_MAX=Xm.PeDefs.prototype.PE_USNG_MAX,t.PE_DD_MAX=Xm.PeDefs.prototype.PE_DD_MAX,t.PE_DDM_MAX=Xm.PeDefs.prototype.PE_DDM_MAX,t.PE_DMS_MAX=Xm.PeDefs.prototype.PE_DMS_MAX,t.PE_UTM_MAX=Xm.PeDefs.prototype.PE_UTM_MAX,t.PE_PARM_MAX=Xm.PeDefs.prototype.PE_PARM_MAX,t.PE_TYPE_NONE=Xm.PeDefs.prototype.PE_TYPE_NONE,t.PE_TYPE_GEOGCS=Xm.PeDefs.prototype.PE_TYPE_GEOGCS,t.PE_TYPE_PROJCS=Xm.PeDefs.prototype.PE_TYPE_PROJCS,t.PE_TYPE_GEOGTRAN=Xm.PeDefs.prototype.PE_TYPE_GEOGTRAN,t.PE_TYPE_COORDSYS=Xm.PeDefs.prototype.PE_TYPE_COORDSYS,t.PE_TYPE_UNIT=Xm.PeDefs.prototype.PE_TYPE_UNIT,t.PE_TYPE_LINUNIT=Xm.PeDefs.prototype.PE_TYPE_LINUNIT,t.PE_STR_OPTS_NONE=Xm.PeDefs.prototype.PE_STR_OPTS_NONE,t.PE_STR_AUTH_NONE=Xm.PeDefs.prototype.PE_STR_AUTH_NONE,t.PE_STR_AUTH_TOP=Xm.PeDefs.prototype.PE_STR_AUTH_TOP,t.PE_STR_NAME_CANON=Xm.PeDefs.prototype.PE_STR_NAME_CANON,t.PE_PARM_X0=Xm.PeDefs.prototype.PE_PARM_X0,t.PE_PARM_ND=Xm.PeDefs.prototype.PE_PARM_ND,t.PE_TRANSFORM_1_TO_2=Xm.PeDefs.prototype.PE_TRANSFORM_1_TO_2,t.PE_TRANSFORM_2_TO_1=Xm.PeDefs.prototype.PE_TRANSFORM_2_TO_1,t.PE_TRANSFORM_P_TO_G=Xm.PeDefs.prototype.PE_TRANSFORM_P_TO_G,t.PE_TRANSFORM_G_TO_P=Xm.PeDefs.prototype.PE_TRANSFORM_G_TO_P,t.PE_HORIZON_RECT=Xm.PeDefs.prototype.PE_HORIZON_RECT,t.PE_HORIZON_POLY=Xm.PeDefs.prototype.PE_HORIZON_POLY,t.PE_HORIZON_LINE=Xm.PeDefs.prototype.PE_HORIZON_LINE,t.PE_HORIZON_DELTA=Xm.PeDefs.prototype.PE_HORIZON_DELTA}}(sg||(sg={})),function(t){const e={},i={},s=t=>{if(t){const e=t.getType();switch(e){case sg.PE_TYPE_GEOGCS:t=Xm.castObject(t,Xm.PeGeogcs);break;case sg.PE_TYPE_PROJCS:t=Xm.castObject(t,Xm.PeProjcs);break;case sg.PE_TYPE_GEOGTRAN:t=Xm.castObject(t,Xm.PeGeogtran);break;default:e&sg.PE_TYPE_UNIT&&(t=Xm.castObject(t,Xm.PeUnit))}}return t};function n(t,i){let n=null,r=e[t];if(r||(r={},e[t]=r),r.hasOwnProperty(i+""))n=r[i];else{const e=Xm.PeFactory.prototype.factoryByType(t,i);Xm.compare(e,Xm.NULL)||(n=e,r[i]=n)}return n=s(n),n}t.initialize=function(){Xm.PeFactory.prototype.initialize(null)},t.coordsys=function(t){return n(sg.PE_TYPE_COORDSYS,t)},t.factoryByType=n,t.fromString=function(t,e){let n=null,r=i[t];if(r||(r={},i[t]=r),r.hasOwnProperty(e))n=r[e];else{const i=Xm.PeFactory.prototype.fromString(t,e);Xm.compare(i,Xm.NULL)||(n=i,r[e]=n)}return n=s(n),n},t.geogcs=function(t){return n(sg.PE_TYPE_GEOGCS,t)},t.geogtran=function(t){return n(sg.PE_TYPE_GEOGTRAN,t)},t.getCode=function(t){return Xm.PeFactory.prototype.getCode(t)},t.projcs=function(t){return n(sg.PE_TYPE_PROJCS,t)},t.unit=function(t){return n(sg.PE_TYPE_UNIT,t)}}(ng||(ng={}));let rg=null;var og,ag,lg,ug,cg,hg,dg,fg,pg;function yg(t){function e(t,e,i){t[e]=i(t[e])}Xm=t,sg.init(),og.init(),cg.init(),dg.init(),fg.init(),rg=class extends Xm.PeGCSExtent{destroy(){Xm.destroy(this)}};const i=[Xm.PeDatum,Xm.PeGeogcs,Xm.PeGeogtran,Xm.PeObject,Xm.PeParameter,Xm.PePrimem,Xm.PeProjcs,Xm.PeSpheroid,Xm.PeUnit];for(const t of i)e(t.prototype,"getName",(t=>function(){return t.call(this,Array(sg.PE_NAME_MAX))}));for(const t of[Xm.PeGeogtran,Xm.PeProjcs])e(t.prototype,"getParameters",(t=>function(){const e=Array(sg.PE_PARM_MAX);let i=t.call(this);for(let t=0;t<e.length;t++){const s=Xm.getValue(i,"*");e[t]=s?Xm.wrapPointer(s,Xm.PeParameter):null,i+=Int32Array.BYTES_PER_ELEMENT}return e}));e(Xm.PeHorizon.prototype,"getCoord",(t=>function(){const e=this.getSize();if(!e)return null;const i=[];return wg(i,e,t.call(this)),i})),e(Xm.PeGTlistExtendedEntry.prototype,"getEntries",(t=>{const e=Xm._pe_getPeGTlistExtendedGTsSize();return function(){let i=null;const s=t.call(this);if(!Xm.compare(s,Xm.NULL)){i=[s];const t=this.getSteps();if(t>1){const n=Xm.getPointer(s);for(let s=1;s<t;s++)i.push(Xm.wrapPointer(n+e*s,Xm.PeGTlistExtendedGTs))}}return i}}));const s=Xm._pe_getPeHorizonSize(),n=t=>function(){let e=this._cache;if(e||(e=new Map,this._cache=e),e.has(t))return e.get(t);let i=null;const n=t.call(this);if(!Xm.compare(n,Xm.NULL)){i=[n];const t=n.getNump();if(t>1){const e=Xm.getPointer(n);for(let n=1;n<t;n++)i.push(Xm.wrapPointer(e+s*n,Xm.PeHorizon))}}return e.set(t,i),i};e(Xm.PeProjcs.prototype,"horizonGcsGenerate",n),e(Xm.PeProjcs.prototype,"horizonPcsGenerate",n),Xm.PeObject.prototype.toString=function(t=sg.PE_STR_OPTS_NONE){Xm.ensureCache.prepare();const e=Xm.getPointer(this),i=Xm.ensureInt8(Array(sg.PE_BUFFER_MAX));return Xm.UTF8ToString(Xm._pe_object_to_string_ext(e,t,i))}}function mg(t){if(!t)return;const e=Xm.getClass(t);if(!e)return;const i=Xm.getCache(e);if(!i)return;const s=Xm.getPointer(t);s&&delete i[s]}function gg(t,e){const i=[],s=Array(e);for(let e=0;e<t;e++)i.push(Xm.ensureInt8(s));return i}function vg(t){let e;return Array.isArray(t[0])?(e=[],t.forEach((t=>{e.push(t[0],t[1])}))):e=t,e}function wg(t,e,i,s=!1){if(s)for(let s=0;s<2*e;s++)t[s]=Xm.getValue(i+s*Float64Array.BYTES_PER_ELEMENT,"double");else{const s=0===t.length;for(let n=0;n<e;n++)s&&(t[n]=[,,]),t[n][0]=Xm.getValue(i,"double"),t[n][1]=Xm.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}!function(t){let e;t.init=function(){t.PE_GTLIST_OPTS_COMMON=Xm.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,e=Xm._pe_getPeGTlistExtendedEntrySize()},t.getGTlist=function(t,i,s,n,r,o){let a=null;const l=new Xm.PeInteger(o);try{const u=Xm.PeGTlistExtended.prototype.getGTlist(t,i,s,n,r,l);if((o=l.val)&&(a=[u],o>1)){const t=Xm.getPointer(u);for(let i=1;i<o;i++)a.push(Xm.wrapPointer(t+e*i,Xm.PeGTlistExtendedEntry))}}finally{Xm.destroy(l)}return a}}(og||(og={})),(ag||(ag={})).destroy=function(t){if(t&&t.length){for(const e of t)mg(e),e.getEntries().forEach((t=>{mg(t);const e=t.getGeogtran();mg(e),e.getParameters().forEach(mg),[e.getGeogcs1(),e.getGeogcs2()].forEach((t=>{mg(t);const e=t.getDatum();mg(e),mg(e.getSpheroid()),mg(t.getPrimem()),mg(t.getUnit())}))}));Xm.PeGTlistExtendedEntry.prototype.Delete(t[0])}},(lg||(lg={})).geogToGeog=function(t,e,i,s,n){Xm.ensureCache.prepare();const r=vg(i),o=i===r,a=Xm.ensureFloat64(r);let l=0;s&&(l=Xm.ensureFloat64(s));const u=Xm._pe_geog_to_geog(Xm.getPointer(t),e,a,l,n);return u&&wg(i,e,a,o),u},function(t){const e=(t,e,i,s,n,r)=>{let o,a;switch(Xm.ensureCache.prepare(),t){case"dd":o=Xm._pe_geog_to_dd,a=sg.PE_DD_MAX;break;case"ddm":o=Xm._pe_geog_to_ddm,a=sg.PE_DDM_MAX;break;case"dms":o=Xm._pe_geog_to_dms,a=sg.PE_DMS_MAX}let l=0;e&&(l=Xm.getPointer(e));const u=vg(s),c=Xm.ensureFloat64(u),h=gg(i,a),d=o(l,i,c,n,Xm.ensureInt32(h));if(d)for(let t=0;t<i;t++)r[t]=Xm.UTF8ToString(h[t]);return d},i=(t,e,i,s,n)=>{let r;switch(Xm.ensureCache.prepare(),t){case"dd":r=Xm._pe_dd_to_geog;break;case"ddm":r=Xm._pe_ddm_to_geog;break;case"dms":r=Xm._pe_dms_to_geog}let o=0;e&&(o=Xm.getPointer(e));const a=s.map((t=>Xm.ensureString(t))),l=Xm.ensureInt32(a),u=Xm.ensureFloat64(Array(2*i)),c=r(o,i,l,u);return c&&wg(n,i,u),c};t.geog_to_dms=function(t,i,s,n,r){return e("dms",t,i,s,n,r)},t.dms_to_geog=function(t,e,s,n){return i("dms",t,e,s,n)},t.geog_to_ddm=function(t,i,s,n,r){return e("ddm",t,i,s,n,r)},t.ddm_to_geog=function(t,e,s,n){return i("ddm",t,e,s,n)},t.geog_to_dd=function(t,i,s,n,r){return e("dd",t,i,s,n,r)},t.dd_to_geog=function(t,e,s,n){return i("dd",t,e,s,n)}}(ug||(ug={})),function(t){t.init=function(){t.PE_MGRS_STYLE_NEW=Xm.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,t.PE_MGRS_STYLE_OLD=Xm.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,t.PE_MGRS_STYLE_AUTO=Xm.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,t.PE_MGRS_180_ZONE_1_PLUS=Xm.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,t.PE_MGRS_ADD_SPACES=Xm.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES},t.geog_to_mgrs_extended=function(t,e,i,s,n,r,o){Xm.ensureCache.prepare();let a=0;t&&(a=Xm.getPointer(t));const l=vg(i),u=Xm.ensureFloat64(l),c=gg(e,sg.PE_MGRS_MAX),h=Xm.ensureInt32(c),d=Xm._pe_geog_to_mgrs_extended(a,e,u,s,n,r,h);if(d)for(let t=0;t<e;t++)o[t]=Xm.UTF8ToString(c[t]);return d},t.mgrs_to_geog_extended=function(t,e,i,s,n){Xm.ensureCache.prepare();let r=0;t&&(r=Xm.getPointer(t));const o=i.map((t=>Xm.ensureString(t))),a=Xm.ensureInt32(o),l=Xm.ensureFloat64(Array(2*e)),u=Xm._pe_mgrs_to_geog_extended(r,e,a,s,l);return u&&wg(n,e,l),u}}(cg||(cg={})),function(t){t.geog_to_usng=function(t,e,i,s,n,r,o){Xm.ensureCache.prepare();let a=0;t&&(a=Xm.getPointer(t));const l=vg(i),u=Xm.ensureFloat64(l),c=gg(e,sg.PE_MGRS_MAX),h=Xm.ensureInt32(c),d=Xm._pe_geog_to_usng(a,e,u,s,n,r,h);if(d)for(let t=0;t<e;t++)o[t]=Xm.UTF8ToString(c[t]);return d},t.usng_to_geog=function(t,e,i,s){Xm.ensureCache.prepare();let n=0;t&&(n=Xm.getPointer(t));const r=i.map((t=>Xm.ensureString(t))),o=Xm.ensureInt32(r),a=Xm.ensureFloat64(Array(2*e)),l=Xm._pe_usng_to_geog(n,e,o,a);return l&&wg(s,e,a),l}}(hg||(hg={})),function(t){t.init=function(){t.PE_UTM_OPTS_NONE=Xm.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,t.PE_UTM_OPTS_ADD_SPACES=Xm.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,t.PE_UTM_OPTS_NS=Xm.PeNotationUtm.prototype.PE_UTM_OPTS_NS},t.geog_to_utm=function(t,e,i,s,n){Xm.ensureCache.prepare();let r=0;t&&(r=Xm.getPointer(t));const o=vg(i),a=Xm.ensureFloat64(o),l=gg(e,sg.PE_UTM_MAX),u=Xm.ensureInt32(l),c=Xm._pe_geog_to_utm(r,e,a,s,u);if(c)for(let t=0;t<e;t++)n[t]=Xm.UTF8ToString(l[t]);return c},t.utm_to_geog=function(t,e,i,s,n){Xm.ensureCache.prepare();let r=0;t&&(r=Xm.getPointer(t));const o=i.map((t=>Xm.ensureString(t))),a=Xm.ensureInt32(o),l=Xm.ensureFloat64(Array(2*e)),u=Xm._pe_utm_to_geog(r,e,a,s,l);return u&&wg(n,e,l),u}}(dg||(dg={})),function(t){const e=new Map;t.init=function(){t.PE_PCSINFO_OPTION_NONE=Xm.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,t.PE_PCSINFO_OPTION_DOMAIN=Xm.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,t.PE_POLE_OUTSIDE_BOUNDARY=Xm.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,t.PE_POLE_POINT=Xm.PePCSInfo.prototype.PE_POLE_POINT},t.generate=function(i,s=t.PE_PCSINFO_OPTION_DOMAIN){let n,r;return e.has(i)&&(r=e.get(i),r[s]&&(n=r[s])),n||(n=Xm.PePCSInfo.prototype.generate(i,s),r||(r=[],e.set(i,r)),r[s]=n),n}}(fg||(fg={})),(pg||(pg={})).version_string=function(){return Xm.PeVersion.prototype.version_string()};const bg=Object.freeze({__proto__:null,get _pe(){return Xm},isLoaded:tg,isSupported:function(){return!!l("esri-wasm")},load:eg,get PeCSTransformations(){return ig},get PeDefs(){return sg},get PeFactory(){return ng},get PeGCSExtent(){return rg},get PeGTlistExtended(){return og},get PeGTlistExtendedEntry(){return ag},get PeGTTransformations(){return lg},get PeNotationDms(){return ug},get PeNotationMgrs(){return cg},get PeNotationUsng(){return hg},get PeNotationUtm(){return dg},get PePCSInfo(){return fg},get PeVersion(){return pg},_init:yg});function Mg(t,e){const i=e[0]-t[0],s=e[1]-t[1];if(t.length>2&&e.length>2){const n=t[2]-e[2];return Math.sqrt(i*i+s*s+n*n)}return Math.sqrt(i*i+s*s)}function Sg(t,e,i,s){const[n,r]=e,[o,a]=i[s],[l,u]=i[s+1],c=l-o,h=u-a,d=Math.min(1,Math.max(0,((n-o)*c+(r-a)*h)/(c*c+h*h)));return t[0]=o+c*d,t[1]=a+h*d,t}function xg(t,e){return function(t,e){const i=t[0]+.5*(e[0]-t[0]),s=t[1]+.5*(e[1]-t[1]);return t.length>2&&e.length>2?[i,s,t[2]+.5*(e[2]-t[2])]:[i,s]}(t,e)}function kg(t,e,i){const s=t.length;let n=0,r=0,o=0;for(let a=0;a<s;a++){const l=t[a],u=t[(a+1)%s];let c=2;n+=l[0]*u[1]-u[0]*l[1],l.length>2&&u.length>2&&i&&(r+=l[0]*u[2]-u[0]*l[2],c=3),l.length>c&&u.length>c&&e&&(o+=l[0]*u[c]-u[0]*l[c])}return n<=0&&r<=0&&o<=0}function Ig(t){if("rings"in t){for(const e of t.rings)e.length<3||e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]||e.push([e[0][0],e[0][1]]);if(t.rings.length>0&&!kg(t.rings[0],t.hasM,t.hasZ))for(let e=0;e<t.rings.length;++e)t.rings[e]=t.rings[e].reverse()}}function jg(t){return t?function(t,e){if(!t||!t.length)return null;const i=[],s=[],n=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let i=0,r=t.length;i<r;i++){const r=_g(t[i],e,n);r&&s.push(r)}if(s.sort(((t,i)=>{let s=t[2]-i[2];return 0===s&&e&&(s=t[4]-i[4]),s})),s.length&&(i[0]=s[0][0],i[1]=s[0][1],e&&(i[2]=s[0][3]),(i[0]<n[0]||i[0]>n[1]||i[1]<n[2]||i[1]>n[3]||e&&(i[2]<n[4]||i[2]>n[5]))&&(i.length=0)),!i.length){const s=t[0]&&t[0].length?function(t,e){const i=e?[0,0,0]:[0,0],s=e?[0,0,0]:[0,0];let n=0,r=0,o=0,a=0;for(let l=0,u=t.length;l<u-1;l++){const u=t[l],c=t[l+1];if(u&&c){i[0]=u[0],i[1]=u[1],s[0]=c[0],s[1]=c[1],e&&u.length>2&&c.length>2&&(i[2]=u[2],s[2]=c[2]);const t=Mg(i,s);if(t){n+=t;const i=xg(u,c);r+=t*i[0],o+=t*i[1],e&&i.length>2&&(a+=t*i[2])}}}return n>0?e?[r/n,o/n,a/n]:[r/n,o/n]:t.length?t[0]:null}(t[0],e):null;if(!s)return null;i[0]=s[0],i[1]=s[1],e&&s.length>2&&(i[2]=s[2])}return i}(t.rings,t.hasZ):null}function _g(t,e,i){let s=0,n=0,r=0,o=0,a=0;const l=t.length?t[0][0]:0,u=t.length?t[0][1]:0,c=t.length&&e?t[0][2]:0;for(let h=0;h<t.length;h++){const d=t[h],f=t[(h+1)%t.length],[p,y,m]=d,g=p-l,v=y-u,w=e?m-c:void 0,[b,M,S]=f,x=b-l,k=M-u,I=e?S-c:void 0,j=g*k-x*v;if(o+=j,s+=(g+x)*j,n+=(v+k)*j,e&&d.length>2&&f.length>2){const t=g*I-x*w;r+=(w+I)*t,a+=t}p<i[0]&&(i[0]=p),p>i[1]&&(i[1]=p),y<i[2]&&(i[2]=y),y>i[3]&&(i[3]=y),e&&(m<i[4]&&(i[4]=m),m>i[5]&&(i[5]=m))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const h=[s/(6*o)+l,n/(6*o)+u,o];return e&&(i[4]===i[5]||0===a?(h[3]=(i[4]+i[5])/2,h[4]=0):(h[3]=r/(6*a)+c,h[4]=a)),h}function Tg(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}function Og(t){return void 0!==t.points}function Ag(t){return void 0!==t.x&&void 0!==t.y}function Fg(t){return void 0!==t.paths}function Cg(t){return void 0!==t.rings}function Pg(t){return(e,i)=>null==e?i:null==i?e:t(e,i)}const Eg=Pg(Math.min),Lg=Pg(Math.max);function Rg(t,e){return Fg(e)?Dg(t,e.paths,!1,!1):Cg(e)?Dg(t,e.rings,!1,!1):Og(e)?$g(t,e.points,!1,!1,!1,!1):Tg(e)?Vg(t,e):(Ag(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function Ng(t,e){return Fg(e)?Dg(t,e.paths,!0,!1):Cg(e)?Dg(t,e.rings,!0,!1):Og(e)?$g(t,e.points,!0,!1,!0,!1):Tg(e)?Vg(t,e,0,0,!0,!1):(Ag(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function Dg(t,e,i,s){const n=i?3:2;if(!e.length||!e[0].length)return null;let r,o,a,l,[u,c]=e[0][0],[h,d]=e[0][0];for(let t=0;t<e.length;t++){const f=e[t];for(let t=0;t<f.length;t++){const e=f[t],[p,y]=e;if(u=Eg(u,p),c=Eg(c,y),h=Lg(h,p),d=Lg(d,y),i&&e.length>2){const t=e[2];r=Eg(r,t),o=Lg(o,t)}if(s&&e.length>n){const t=e[n];a=Eg(r,t),l=Lg(o,t)}}}return i?s?(t[0]=u,t[1]=c,t[2]=r,t[3]=a,t[4]=h,t[5]=d,t[6]=o,t[7]=l,t.length=8,t):(t[0]=u,t[1]=c,t[2]=r,t[3]=h,t[4]=d,t[5]=o,t.length=6,t):s?(t[0]=u,t[1]=c,t[2]=a,t[3]=h,t[4]=d,t[5]=l,t.length=6,t):(t[0]=u,t[1]=c,t[2]=h,t[3]=d,t.length=4,t)}function Vg(t,e,i,s,n,r){const o=e.xmin,a=e.xmax,l=e.ymin,u=e.ymax;let c=e.zmin,h=e.zmax,d=e.mmin,f=e.mmax;return n?(c=c||0,h=h||0,r?(d=d||0,f=f||0,t[0]=o,t[1]=l,t[2]=c,t[3]=d,t[4]=a,t[5]=u,t[6]=h,t[7]=f,t):(t[0]=o,t[1]=l,t[2]=c,t[3]=a,t[4]=u,t[5]=h,t)):r?(d=d||0,f=f||0,t[0]=o,t[1]=l,t[2]=d,t[3]=a,t[4]=u,t[5]=f,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=u,t)}function $g(t,e,i,s,n,r){const o=i?3:2,a=s&&r,l=i&&n;if(!e.length||!e[0].length)return null;let u,c,h,d,[f,p]=e[0],[y,m]=e[0];for(let t=0;t<e.length;t++){const i=e[t],[s,n]=i;if(f=Eg(f,s),p=Eg(p,n),y=Lg(y,s),m=Lg(m,n),l&&i.length>2){const t=i[2];u=Eg(u,t),c=Lg(c,t)}if(a&&i.length>o){const t=i[o];h=Eg(u,t),d=Lg(c,t)}}return n?(u=u||0,c=c||0,r?(h=h||0,d=d||0,t[0]=f,t[1]=p,t[2]=u,t[3]=h,t[4]=y,t[5]=m,t[6]=c,t[7]=d,t):(t[0]=f,t[1]=p,t[2]=u,t[3]=y,t[4]=m,t[5]=c,t)):r?(h=h||0,d=d||0,t[0]=f,t[1]=p,t[2]=h,t[3]=y,t[4]=m,t[5]=d,t):(t[0]=f,t[1]=p,t[2]=y,t[3]=m,t)}const zg=[];function Gg(t,e,i,s){return{xmin:t,ymin:e,xmax:i,ymax:s}}function Ug(t,e,i,s,n,r){return{xmin:t,ymin:e,zmin:i,xmax:s,ymax:n,zmax:r}}function qg(t,e,i,s,n,r){return{xmin:t,ymin:e,mmin:i,xmax:s,ymax:n,mmax:r}}function Bg(t,e,i,s,n,r,o,a){return{xmin:t,ymin:e,zmin:i,mmin:s,xmax:n,ymax:r,zmax:o,mmax:a}}function Wg(t,e=!1,i=!1){return e?i?Bg(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):Ug(t[0],t[1],t[2],t[3],t[4],t[5]):i?qg(t[0],t[1],t[2],t[3],t[4],t[5]):Gg(t[0],t[1],t[2],t[3])}function Hg(t){return t?function(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}(t)?t:function(t){return void 0!==t.x&&void 0!==t.y}(t)?function(t){const{x:e,y:i,z:s,m:n}=t,r=null!=n;return null!=s?r?Bg(e,i,s,n,e,i,s,n):Ug(e,i,s,e,i,s):r?qg(e,i,n,e,i,n):Gg(e,i,e,i)}(t):function(t){return void 0!==t.rings}(t)?Jg(t):function(t){return void 0!==t.paths}(t)?Zg(t):function(t){return void 0!==t.points}(t)?function(t){const{hasZ:e,hasM:i,points:s}=t;return Wg($g(zg,s,e,i),e,i)}(t):null:null}function Jg(t){const{hasZ:e,hasM:i,rings:s}=t,n=Dg(zg,s,e,i);return n?Wg(n,e,i):null}function Zg(t){const{hasZ:e,hasM:i,paths:s}=t,n=Dg(zg,s,e,i);return n?Wg(n,e,i):null}var Qg;function Kg(t){return!Array.isArray(t[0])}let Yg=Qg=class extends Dh{constructor(...t){super(...t),this.rings=[],this.type="polygon"}static fromExtent(t){const e=t.clone().normalize(),i=t.spatialReference;let s=!1,n=!1;for(const t of e)t.hasZ&&(s=!0),t.hasM&&(n=!0);const r={rings:e.map((function(t){const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];if(s&&t.hasZ){const i=t.zmin+.5*(t.zmax-t.zmin);for(let t=0;t<e.length;t++)e[t].push(i)}if(n&&t.hasM){const i=t.mmin+.5*(t.mmax-t.mmin);for(let t=0;t<e.length;t++)e[t].push(i)}return e})),spatialReference:i};return s&&(r.hasZ=!0),n&&(r.hasM=!0),new Qg(r)}normalizeCtorArgs(t,e){let i,s,n=null,r=null;return t&&!Array.isArray(t)?(n=t.rings?t.rings:null,e||(t.spatialReference?e=t.spatialReference:t.rings||(e=t)),i=t.hasZ,s=t.hasM):n=t,n=n||[],n.length&&n[0]&&null!=n[0][0]&&"number"==typeof n[0][0]&&(n=[n]),r=n[0]&&n[0][0],r&&(void 0===i&&void 0===s?(i=r.length>2,s=r.length>3):void 0===i?i=s?r.length>3:r.length>2:void 0===s&&(s=i?r.length>3:r.length>2)),{rings:n,spatialReference:e=e||Lh.WGS84,hasZ:i,hasM:s}}get cache(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get centroid(){const t=jg(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new ad;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}get extent(){const{spatialReference:t}=this,e=Jg(this);if(!e)return null;const i=new Ld(e);return i.spatialReference=t,i}get isSelfIntersecting(){return function(t){for(let e=0;e<t.length;e++){const i=t[e];for(let s=0;s<i.length-1;s++){const n=i[s],r=i[s+1];for(let i=e+1;i<t.length;i++)for(let e=0;e<t[i].length-1;e++){const s=t[i][e],o=t[i][e+1];if(Ad(n,r,s,o,Td)&&!(Td[0]===n[0]&&Td[1]===n[1]||Td[0]===s[0]&&Td[1]===s[1]||Td[0]===r[0]&&Td[1]===r[1]||Td[0]===o[0]&&Td[1]===o[1]))return!0}}const s=i.length;if(!(s<=4))for(let t=0;t<s-3;t++){let e=s-1;0===t&&(e=s-2);const n=i[t],r=i[t+1];for(let s=t+2;s<e;s++){const t=i[s],e=i[s+1];if(Ad(n,r,t,e,Td)&&!(Td[0]===n[0]&&Td[1]===n[1]||Td[0]===t[0]&&Td[1]===t[1]||Td[0]===r[0]&&Td[1]===r[1]||Td[0]===e[0]&&Td[1]===e[1]))return!0}}}return!1}(this.rings)}writeRings(t,e){e.rings=H(this.rings)}addRing(t){if(!t)return;const e=this.rings,i=e.length;if(Kg(t)){const s=[];for(let e=0,i=t.length;e<i;e++)s[e]=t[e].toArray();e[i]=s}else e[i]=t.concat();return this.notifyChange("rings"),this}clone(){const t=new Qg;return t.spatialReference=this.spatialReference,t.rings=H(this.rings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(c(t))return!1;const e=this.spatialReference,i=t.spatialReference;if(u(e)!==u(i))return!1;if(u(e)&&u(i)&&!e.equals(i))return!1;if(this.rings.length!==t.rings.length)return!1;const s=([t,e,i,s],[n,r,o,a])=>t===n&&e===r&&(null==i&&null==o||i===o)&&(null==s&&null==a||s===a);for(let e=0;e<this.rings.length;e++)if(!T(this.rings[e],t.rings[e],s))return!1;return!0}contains(t){if(!t)return!1;const e=Kh(t,this.spatialReference);return pd(this,u(e)?e:t)}isClockwise(t){let e;return e=Kg(t)?t.map((t=>this.hasZ?this.hasM?[t.x,t.y,t.z,t.m]:[t.x,t.y,t.z]:[t.x,t.y])):t,kg(e,this.hasM,this.hasZ)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.rings[t][e],s=this.hasZ,n=this.hasM;return s&&!n?new ad(i[0],i[1],i[2],void 0,this.spatialReference):n&&!s?new ad(i[0],i[1],void 0,i[2],this.spatialReference):s&&n?new ad(i[0],i[1],i[2],i[3],this.spatialReference):new ad(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(Hm(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t].splice(e,0,i),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new ad(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],i=this.spatialReference,s=e.map((t=>new ad(t,i)));return this.notifyChange("rings"),s}setPoint(t,e,i){return this._validateInputs(t,e)?(Hm(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t][e]=i,this.notifyChange("rings"),this):this}_validateInputs(t,e,i=!1){if(null==t||t<0||t>=this.rings.length)return!1;if(null!=e){const s=this.rings[t];if(i&&(e<0||e>s.length))return!1;if(!i&&(e<0||e>=s.length))return!1}return!0}toJSON(t){return this.write({},t)}};e([Hn({readOnly:!0})],Yg.prototype,"cache",null),e([Hn({readOnly:!0})],Yg.prototype,"centroid",null),e([Hn({readOnly:!0})],Yg.prototype,"extent",null),e([Hn({readOnly:!0})],Yg.prototype,"isSelfIntersecting",null),e([Hn({type:[[[Number]]],json:{write:{isRequired:!0}}})],Yg.prototype,"rings",void 0),e([fh("rings")],Yg.prototype,"writeRings",null),Yg=Qg=e([_r("esri.geometry.Polygon")],Yg),Yg.prototype.toJSON.isDefaultToJSON=!0;const Xg=Yg;var tv;let ev=tv=class extends Dh{constructor(...t){super(...t),this.paths=[],this.type="polyline"}normalizeCtorArgs(t,e){let i,s,n=null,r=null;return t&&!Array.isArray(t)?(n=t.paths?t.paths:null,e||(t.spatialReference?e=t.spatialReference:t.paths||(e=t)),i=t.hasZ,s=t.hasM):n=t,n=n||[],n.length&&n[0]&&null!=n[0][0]&&"number"==typeof n[0][0]&&(n=[n]),r=n[0]&&n[0][0],r&&(void 0===i&&void 0===s?(i=r.length>2,s=!1):void 0===i?i=!s&&r.length>3:void 0===s&&(s=!i&&r.length>3)),{paths:n,spatialReference:e=e||Lh.WGS84,hasZ:i,hasM:s}}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:t}=this,e=Zg(this);if(!e)return null;const i=new Ld(e);return i.spatialReference=t,i}writePaths(t,e){e.paths=H(this.paths)}addPath(t){if(!t)return;const e=this.paths,i=e.length;if(function(t){return!Array.isArray(t[0])}(t)){const s=[];for(let e=0,i=t.length;e<i;e++)s[e]=t[e].toArray();e[i]=s}else e[i]=t.concat();return this.notifyChange("paths"),this}clone(){const t=new tv;return t.spatialReference=this.spatialReference,t.paths=H(this.paths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.paths[t][e],s=this.hasZ,n=this.hasM;return s&&!n?new ad(i[0],i[1],i[2],void 0,this.spatialReference):n&&!s?new ad(i[0],i[1],void 0,i[2],this.spatialReference):s&&n?new ad(i[0],i[1],i[2],i[3],this.spatialReference):new ad(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(Hm(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t].splice(e,0,i),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],i=this.spatialReference,s=e.map((t=>new ad(t,i)));return this.notifyChange("paths"),s}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new ad(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(t,e,i){return this._validateInputs(t,e)?(Hm(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t][e]=i,this.notifyChange("paths"),this):this}_validateInputs(t,e,i=!1){if(null==t||t<0||t>=this.paths.length)return!1;if(null!=e){const s=this.paths[t];if(i&&(e<0||e>s.length))return!1;if(!i&&(e<0||e>=s.length))return!1}return!0}toJSON(t){return this.write({},t)}};e([Hn({readOnly:!0})],ev.prototype,"cache",null),e([Hn({readOnly:!0})],ev.prototype,"extent",null),e([Hn({type:[[[Number]]],json:{write:{isRequired:!0}}})],ev.prototype,"paths",void 0),e([fh("paths")],ev.prototype,"writePaths",null),ev=tv=e([_r("esri.geometry.Polyline")],ev),ev.prototype.toJSON.isDefaultToJSON=!0;const iv=ev;function sv(t=gv){return[t[0],t[1],t[2],t[3]]}function nv(t){return[t[0],t[1],t[2],t[3]]}function rv(t,e,i,s,n=sv()){return n[0]=t,n[1]=e,n[2]=i,n[3]=s,n}function ov(t,e=sv()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function av(t,e){return new Ld({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}function lv(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function uv(t){return c(t)||t[0]>=t[2]?0:t[2]-t[0]}function cv(t){return t[1]>=t[3]?0:t[3]-t[1]}function hv(t){return uv(t)*cv(t)}function dv(t,e){return function(t,e,i){return e>=t[0]&&i>=t[1]&&e<=t[2]&&i<=t[3]}(t,e[0],e[1])}function fv(t,e,i){return e[0]>=t[0]-i&&e[1]>=t[1]-i&&e[0]<=t[2]+i&&e[1]<=t[3]+i}function pv(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function yv(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}const mv=[1/0,1/0,-1/0,-1/0],gv=[0,0,0,0],vv=$h.radius,wv=$h.eccentricitySquared,bv={a1:vv*wv,a2:vv*wv*vv*wv,a3:vv*wv*wv/2,a4:vv*wv*vv*wv*2.5,a5:vv*wv+vv*wv*wv/2,a6:1-wv};let Mv=0;class Sv{constructor(t=null){this.uid=Mv++,t?(this._wkt=void 0!==t.wkt?t.wkt:null,this._wkid=void 0!==t.wkid?t.wkid:-1,this._isInverse=void 0!==t.isInverse&&!0===t.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}static fromGE(t){const e=new Sv;return e._wkt=t.wkt,e._wkid=t.wkid,e._isInverse=t.isInverse,e}get wkt(){return this._wkt}set wkt(t){this._wkt=t,this.uid=Mv++}get wkid(){return this._wkid}set wkid(t){this._wkid=t,this.uid=Mv++}get isInverse(){return this._isInverse}set isInverse(t){this._isInverse=t,this.uid=Mv++}getInverse(){const t=new Sv;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}}class xv{constructor(t){if(this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,t&&t.steps)for(const e of t.steps)this.steps.push(e instanceof Sv?e:new Sv({wkid:e.wkid,wkt:e.wkt,isInverse:e.isInverse}))}static cacheKey(t,e){return[null!=t.wkid?""+t.wkid:"-1",null!=t.wkt?""+t.wkt:"",null!=e.wkid?""+e.wkid:"-1",null!=e.wkt?""+e.wkt:""].join(",")}static fromGE(t){const e=new xv;let i="";for(const s of t.steps){const t=Sv.fromGE(s);e.steps.push(t),i+=t.uid+","}return e._cached_projection={},e._gtlistentry=null,e._chain=i,e}getInverse(){const t=new xv;t.steps=[];for(let e=this.steps.length-1;e>=0;e--)t.steps.push(this.steps[e].getInverse());return t}getGTListEntry(){let t="";for(const e of this.steps)t+=e.uid+",";return t!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=t),this._gtlistentry}assignCachedGe(t,e,i){this._cached_projection[xv.cacheKey(t,e)]=i}getCachedGeTransformation(t,e){let i="";for(const t of this.steps)i+=t.uid+",";i!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=i);const s=this._cached_projection[xv.cacheKey(t,e)];return void 0===s?null:s}}let kv=null,Iv=null,jv=null,_v={};function Tv(){return!!kv&&tg()}function Ov(t){return c(jv)&&(jv=Promise.all([eg(),import("./p-27823887.js").then((t=>t.g)),import("./p-9479e678.js")])),jv.then((([,e,{hydratedAdapter:i}])=>{Ee(t),Iv=i,kv=e.default,kv._enableProjection(bg)}))}function Av(t,e,i=null){return Array.isArray(t)?0===t.length?[]:Fv(Iv,t,t[0].spatialReference,e,i):Fv(Iv,[t],t.spatialReference,e,i)[0]}function Fv(t,e,i,s,n=null){if(c(i)||c(s))return e;if(Ev(i,s,n))return e.map((t=>function(t,e,i){return t?"x"in t?function(t,e,i,s){Mw[0]=t.x,Mw[1]=t.y;const n=t.z;return Mw[2]=void 0!==n?n:0,$v(Mw,e,0,Mw,s,0,1)?(i.x=Mw[0],i.y=Mw[1],i.spatialReference=s,void 0===n?(i.z=void 0,i.hasZ=!1):(i.z=Mw[2],i.hasZ=!0),void 0===t.m?(i.m=void 0,i.hasM=!1):(i.m=t.m,i.hasM=!0),i):null}(t,e,new ad,i):"xmin"in t?function(t,e,i,s){const{xmin:n,ymin:r,xmax:o,ymax:a,hasZ:l,hasM:u}=t;return Vv(n,r,l?t.zmin:0,e,Mw,s)?(i.xmin=Mw[0],i.ymin=Mw[1],l&&(i.zmin=Mw[2]),Vv(o,a,l?t.zmax:0,e,Mw,s)?(i.xmax=Mw[0],i.ymax=Mw[1],l&&(i.zmax=Mw[2]),u&&(i.mmin=t.mmin,i.mmax=t.mmax),i.spatialReference=s,i):null):null}(t,e,new Ld,i):"rings"in t?Nv(t,e,new Xg,i,0):"paths"in t?function(t,e,i,s){const{paths:n,hasZ:r,hasM:o}=t,a=[];return zv(n,r,o,e,a,s,0)?(i.paths=a,i.spatialReference=s,i.hasZ=r,i.hasM=o,i):null}(t,e,new iv,i):"points"in t?function(t,e,i,s){const{points:n,hasZ:r,hasM:o}=t,a=[],l=n.length,u=[];for(const t of n)u.push(t[0],t[1],r?t[2]:0);if(!$v(u,e,0,u,s,0,l))return null;for(let t=0;t<l;++t){const e=3*t,i=u[e],s=u[e+1];a.push(r&&o?[i,s,u[e+2],n[t][3]]:r?[i,s,u[e+2]]:o?[i,s,n[t][2]]:[i,s])}return i.points=a,i.spatialReference=s,i.hasZ=r,i.hasM=o,i}(t,e,new Km,i):null:null}(t,i,s)));if(c(n)){const t=xv.cacheKey(i,s);void 0!==_v[t]?n=_v[t]:(c(n=Cv(i,s,null))&&(n=new xv),_v[t]=n)}if(c(kv))throw new Pv;return kv._project(t,e,i,s,n)}function Cv(t,e,i=null){if(c(kv))throw new Pv;if(c(t)||c(e))return null;const s=kv._getTransformation(Iv,t,e,i,null==i?void 0:i.spatialReference);return null!==s?xv.fromGE(s):null}class Pv extends dt{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}}function Ev(t,e,i){return!i&&(!!Mh(t,e)||Fh(t)&&Fh(e)&&!!hw(t,e,yw))}async function Lv(t,e,i,s){if(!Tv())if(Array.isArray(t)){for(const{source:e,dest:i,geographicTransformation:n}of t)if(!Ev(e,i,n))return Ov(s)}else if(!Ev(t,e,i))return Ov(s)}function Rv(t,e,i=e.spatialReference,s=0){return u(i)&&u(Nv(t,t.spatialReference,e,i,s))}function Nv(t,e,i,s,n){const{rings:r,hasZ:o,hasM:a}=t,l=[];return zv(r,o,a,e,l,s,n)?(i.rings=l,i.spatialReference=s,i.hasZ=o,i.hasM=a,i):null}function Dv(t,e,i,s=0){Mw[0]=t.x,Mw[1]=t.y;const n=t.z;return Mw[2]=void 0!==n?n:s,$v(Mw,t.spatialReference,0,e,i,0,1)}function Vv(t,e,i,s,n,r){return vw[0]=t,vw[1]=e,vw[2]=i,$v(vw,s,0,n,r,0,1)}function $v(t,e,i,s,n,r,o=1){const a=hw(e,n,yw);if(c(a))return!1;if(a===Wv){if(t===s&&i===r)return!0;const e=i+3*o;for(let n=i,o=r;n<e;n++,o++)s[o]=t[n];return!0}const l=i+3*o;for(let e=i,n=r;e<l;e+=3,n+=3)a(t,e,s,n);return!0}function zv(t,e,i,s,n,r,o=0){const a=[];for(const i of t)for(const t of i)a.push(t[0],t[1],e?t[2]:o);if(!$v(a,s,0,a,r,0,a.length/3))return!1;let l=0;n.length=0;for(const s of t){const t=[];for(const n of s)e&&i?t.push([a[l++],a[l++],a[l++],n[3]]):e?t.push([a[l++],a[l++],a[l++]]):i?(t.push([a[l++],a[l++],n[2]]),l++):(t.push([a[l++],a[l++]]),l++);n.push(t)}return!0}function Gv(t,e,i,s){if(c(t)||c(s))return!1;const n=Bv(t,fw),r=Bv(s,pw);if(n===r&&!Uv(r)&&(0!==n||Mh(t,s)))return oy(i),cy(i,i,e),!0;if(Uv(r)){const t=cw[n][11],s=cw[11][r];return!c(t)&&!c(s)&&(t(e,0,ww,0),s(ww,0,bw,0),qv(mw*ww[0],mw*ww[1],i),i[12]=bw[0],i[13]=bw[1],i[14]=bw[2],!0)}if(!(3!==r&&12!==r||2!==n&&1!==n&&3!==n)){const t=cw[n][11],s=cw[11][r];return!c(t)&&!c(s)&&(t(e,0,ww,0),s(ww,0,bw,0),1===n?function(t,e,i){qv(mw*ww[0],mw*ww[1],i),ay(i,i)}(0,0,i):oy(i),i[12]=bw[0],i[13]=bw[1],i[14]=bw[2],!0)}return!1}function Uv(t){return 1===t||7===t||9===t}function qv(t,e,i){const s=Math.sin(t),n=Math.cos(t),r=Math.sin(e),o=Math.cos(e),a=i;return a[0]=-s,a[4]=-r*n,a[8]=o*n,a[12]=0,a[1]=n,a[5]=-r*s,a[9]=o*s,a[13]=0,a[2]=0,a[6]=o,a[10]=r,a[14]=0,a[3]=0,a[7]=0,a[11]=0,a[15]=1,a}function Bv(t,e){return e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=Rm(t,1)),e.spatialReferenceId=t.wkt===dm.wkt?1:kh(t)?2:jh(t)?3:function(t){return Fh(t)&&32662===t.wkid}(t)?12:t.wkt===ym.wkt?4:4490===t.wkid?5:t.wkt===fm.wkt?7:t.wkt===pm.wkt?9:Th(t)?8:Ah(t)?10:0)}function Wv(t,e,i,s){t!==i&&(i[s++]=t[e++],i[s++]=t[e++],i[s]=t[e])}function Hv(t,e,i,s){i[s++]=gw*(t[e++]/$h.radius),i[s++]=gw*(Math.PI/2-2*Math.atan(Math.exp(-t[e++]/$h.radius))),i[s]=t[e]}function Jv(t,e,i,s){!function(t,e,i,s,n){const r=.4999999*Math.PI,o=qp(mw*t[e+1],-r,r),a=Math.sin(o);i[s++]=mw*t[e]*n.radius,i[s++]=n.halfSemiMajorAxis*Math.log((1+a)/(1-a)),i[s]=t[e+2]}(t,e,i,s,$h)}const Zv=$h.radius*Math.PI/180,Qv=180/($h.radius*Math.PI);function Kv(t,e,i,s){i[s]=t[e]*Zv,i[s+1]=t[e+1]*Zv,i[s+2]=t[e+2]}function Yv(t,e,i,s){i[s]=t[e]*Qv,i[s+1]=t[e+1]*Qv,i[s+2]=t[e+2]}function Xv(t){if(c(t))return!1;const e=Bv(t,fw);return!!cw[e][6]}function tw(t,e,i,s,n){const r=n+t[e+2],o=mw*t[e+1],a=mw*t[e],l=Math.cos(o);i[s++]=Math.cos(a)*l*r,i[s++]=Math.sin(a)*l*r,i[s]=Math.sin(o)*r}function ew(t,e,i,s){tw(t,e,i,s,Gh.radius)}function iw(t,e,i,s){tw(t,e,i,s,zh.radius)}function sw(t,e,i,s){tw(t,e,i,s,$h.radius)}function nw(t,e,i,s,n){const r=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(r*r+o*o+a*a),u=Kp(a/(0===l?1:l));i[s++]=gw*Math.atan2(o,r),i[s++]=gw*u,i[s]=l-n}function rw(t,e,i,s){nw(t,e,i,s,Gh.radius)}function ow(t,e,i,s){nw(t,e,i,s,zh.radius)}function aw(t,e,i,s){nw(t,e,i,s,$h.radius)}function lw(t,e,i,s){!function(t,e,i,s,n){const r=mw*t[e],o=mw*t[e+1],a=t[e+2],l=Math.sin(o),u=Math.cos(o),c=n.radius/Math.sqrt(1-n.eccentricitySquared*l*l);i[s++]=(c+a)*u*Math.cos(r),i[s++]=(c+a)*u*Math.sin(r),i[s++]=(c*(1-n.eccentricitySquared)+a)*l}(t,e,i,s,$h)}function uw(t,e,i,s){const n=bv,r=t[e],o=t[e+1],a=t[e+2];let l,u,c,h,d,f,p,y,m,g,v,w,b,M,S,x,k,I,j,_,T;l=Math.abs(a),u=r*r+o*o,c=Math.sqrt(u),h=u+a*a,d=Math.sqrt(h),_=Math.atan2(o,r),f=a*a/h,p=u/h,M=n.a2/d,S=n.a3-n.a4/d,p>.3?(y=l/d*(1+p*(n.a1+M+f*S)/d),j=Math.asin(y),g=y*y,m=Math.sqrt(1-g)):(m=c/d*(1-f*(n.a5-M-p*S)/d),j=Math.acos(m),g=1-m*m,y=Math.sqrt(g)),v=1-$h.eccentricitySquared*g,w=$h.radius/Math.sqrt(v),b=n.a6*w,M=c-w*m,S=l-b*y,k=m*M+y*S,x=m*S-y*M,I=x/(b/v+k),j+=I,T=k+x*I/2,a<0&&(j=-j),i[s++]=gw*_,i[s++]=gw*j,i[s]=T}const cw={2:{5:null,8:null,10:null,11:Wv,6:Wv,1:sw,7:null,9:null,0:null,3:Jv,12:Kv,2:Wv,4:lw},5:{5:Wv,8:null,10:null,11:Wv,6:Wv,1:sw,7:null,9:null,0:null,3:null,12:Kv,2:null,4:lw},8:{5:null,8:Wv,10:null,11:Wv,6:null,1:null,7:iw,9:null,0:null,3:null,12:null,2:null,4:null},10:{5:null,8:null,10:Wv,11:Wv,6:null,1:null,7:null,9:ew,0:null,3:null,12:null,2:null,4:null},3:{5:null,8:null,10:null,11:Hv,6:Hv,1:function(t,e,i,s){Hv(t,e,i,s),sw(i,s,i,s)},7:null,9:null,0:null,3:Wv,12:function(t,e,i,s){Hv(t,e,i,s),Kv(i,s,i,s)},2:Hv,4:function(t,e,i,s){Hv(t,e,i,s),lw(i,s,i,s)}},4:{5:uw,8:null,10:null,11:uw,6:uw,1:function(t,e,i,s){uw(t,e,i,s),sw(i,s,i,s)},7:null,9:null,0:null,3:function(t,e,i,s){uw(t,e,i,s),Jv(i,s,i,s)},12:function(t,e,i,s){uw(t,e,i,s),Kv(i,s,i,s)},2:uw,4:Wv},1:{5:aw,8:null,10:null,11:aw,6:aw,1:Wv,7:null,9:null,0:null,3:function(t,e,i,s){aw(t,e,i,s),Jv(i,s,i,s)},12:function(t,e,i,s){aw(t,e,i,s),Kv(i,s,i,s)},2:aw,4:function(t,e,i,s){aw(t,e,i,s),lw(i,s,i,s)}},7:{5:null,8:ow,10:null,11:ow,6:null,1:null,7:Wv,9:null,0:null,3:null,12:null,2:null,4:null},9:{5:null,8:null,10:rw,11:rw,6:null,1:null,7:null,9:Wv,0:null,3:null,12:null,2:null,4:null},0:{5:null,8:null,10:null,11:null,6:null,1:null,7:null,9:null,0:Wv,3:null,12:null,2:null,4:null},11:{5:Wv,8:Wv,10:Wv,11:Wv,6:Wv,1:sw,7:iw,9:ew,0:null,3:Jv,12:Kv,2:Wv,4:lw},6:{5:null,8:null,10:null,11:Wv,6:Wv,1:sw,7:null,9:null,0:null,3:null,12:Kv,2:Wv,4:lw},12:{5:Yv,8:null,10:null,11:Yv,6:Yv,1:function(t,e,i,s){Yv(t,e,i,s),sw(i,s,i,s)},7:null,9:null,0:null,3:function(t,e,i,s){Yv(t,e,i,s),Jv(i,s,i,s)},12:Wv,2:Yv,4:function(t,e,i,s){Yv(t,e,i,s),lw(i,s,i,s)}}};function hw(t,e,i=dw()){return c(t)||c(e)?null:function(t,e,i){if(c(t)||c(e)||i.source.spatialReference===t&&i.dest.spatialReference===e)return i;const s=Bv(t,i.source),n=Bv(e,i.dest);return i.projector=0===s&&0===n?Mh(t,e)?Wv:null:cw[s][n],i}(t,e,i).projector}function dw(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:Wv}}const fw={spatialReference:null,spatialReferenceId:0},pw={spatialReference:null,spatialReferenceId:0},yw=dw(),mw=Jp(1),gw=Zp(1),vw=[0,0,0],ww=[0,0,0],bw=[0,0,0],Mw=[0,0,0];var Sw;let xw=Sw=class extends lh{constructor(t){super(t),this.cols=null,this.level=0,this.levelValue=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new Sw({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};e([Hn({type:Number,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],xw.prototype,"cols",void 0),e([Hn({type:Gn,json:{write:!0}})],xw.prototype,"level",void 0),e([Hn({type:String,json:{write:!0}})],xw.prototype,"levelValue",void 0),e([Hn({type:Number,json:{write:!0}})],xw.prototype,"resolution",void 0),e([Hn({type:Number,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],xw.prototype,"rows",void 0),e([Hn({type:Number,json:{write:!0}})],xw.prototype,"scale",void 0),xw=Sw=e([_r("esri.layers.support.LOD")],xw);const kw=xw;var Iw;const jw=new vo({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let _w=Iw=class extends lh{constructor(t){super(t),this.dpi=96,this.format=null,this.origin=null,this.minScale=0,this.maxScale=0,this.size=null,this.spatialReference=null}static create(t={}){const{resolutionFactor:e=1,scales:i,size:s=256,spatialReference:n=Lh.WebMercator,numLODs:r=24}=t;if(!Fh(n)){const t=[];if(i)for(let e=0;e<i.length;e++){const s=i[e];t.push({level:e,scale:s,resolution:s})}else{let e=5e-4;for(let i=r-1;i>=0;i--)t.unshift({level:i,scale:e,resolution:e}),e*=2}return new Iw({dpi:96,lods:t,origin:new ad(0,0,n),size:[s,s],spatialReference:n})}const o=Sh(n),a=new ad(t.origin?{x:t.origin.x,y:t.origin.y,spatialReference:n}:o?{x:o.origin[0],y:o.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),l=1/(39.37*Rm(n)*96),u=[];if(i)for(let t=0;t<i.length;t++){const e=i[t];u.push({level:t,scale:e,resolution:e*l})}else{let t=xh(n)?512/s*591657527.5917094:256/s*591657527.591555;const i=Math.ceil(r/e);u.push({level:0,scale:t,resolution:t*l});for(let s=1;s<i;s++){const i=t/2**e;u.push({level:s,scale:i,resolution:i*l}),t=i}}return new Iw({dpi:96,lods:u,origin:a,size:[s,s],spatialReference:n})}get isWrappable(){const{spatialReference:t,origin:e}=this;if(t&&e){const i=Sh(t);return t.isWrappable&&Math.abs(i.origin[0]-e.x)<=i.dx}return!1}readOrigin(t,e){return ad.fromJSON({spatialReference:e.spatialReference,...t})}set lods(t){let e=0,i=0;const s=[];this._levelToLOD={},t&&(e=-1/0,i=1/0,t.forEach((t=>{s.push(t.scale),e=t.scale>e?t.scale:e,i=t.scale<i?t.scale:i,this._levelToLOD[t.level]=t}))),this._set("scales",s),this._set("minScale",e),this._set("maxScale",i),this._set("lods",t),this._initializeUpsampleLevels()}readSize(t,e){return[e.cols,e.rows]}writeSize(t,e){e.cols=t[0],e.rows=t[1]}zoomToScale(t){const e=this.scales;if(t<=0)return e[0];if(t>=e.length-1)return e[e.length-1];{const i=Math.floor(t);return e[i]/(e[i]/e[i+1])**(t-i)}}scaleToZoom(t){const e=this.scales,i=e.length-1;let s=0;for(;s<i;s++){const i=e[s],n=e[s+1];if(i<=t)return s;if(n===t)return s+1;if(i>t&&n<t)return s+Math.log(i/t)/Math.log(i/n)}return s}snapScale(t,e=.95){const i=this.scaleToZoom(t);return this.zoomToScale(i%Math.floor(i)>=e?Math.ceil(i):Math.floor(i))}tileAt(t,e,i,s){const n=this.lodAt(t);if(!n)return null;let r,o;if("number"==typeof e)r=e,o=i;else if(Mh(e.spatialReference,this.spatialReference))r=e.x,o=e.y,s=i;else{const t=Kh(e,this.spatialReference);if(c(t))return null;r=t.x,o=t.y,s=i}const a=n.resolution*this.size[0],l=n.resolution*this.size[1];return s||(s={id:null,level:0,row:0,col:0,extent:sv()}),s.level=t,s.row=Math.floor((this.origin.y-o)/l+.001),s.col=Math.floor((r-this.origin.x)/a+.001),this.updateTileInfo(s),s}updateTileInfo(t,e=0){let i=this.lodAt(t.level);if(!i&&1===e){const e=this.lods[this.lods.length-1];e.level<t.level&&(i=e)}if(!i)return;const s=t.level-i.level,n=i.resolution*this.size[0]/2**s,r=i.resolution*this.size[1]/2**s;t.id=`${t.level}/${t.row}/${t.col}`,t.extent||(t.extent=sv()),t.extent[0]=this.origin.x+t.col*n,t.extent[1]=this.origin.y-(t.row+1)*r,t.extent[2]=t.extent[0]+n,t.extent[3]=t.extent[1]+r}upsampleTile(t){const e=this._upsampleLevels[t.level];return!(!e||-1===e.parentLevel||(t.level=e.parentLevel,t.row=Math.floor(t.row/e.factor+.001),t.col=Math.floor(t.col/e.factor+.001),this.updateTileInfo(t),0))}getTileBounds(t,e){const{resolution:i}=this.lodAt(e.level),s=i*this.size[0],n=i*this.size[1];return t[0]=this.origin.x+e.col*s,t[1]=this.origin.y-(e.row+1)*n,t[2]=t[0]+s,t[3]=t[1]+n,t}lodAt(t){return this._levelToLOD&&this._levelToLOD[t]||null}clone(){return Iw.fromJSON(this.write({}))}_initializeUpsampleLevels(){const t=this.lods;this._upsampleLevels=[];let e=null;for(let i=0;i<t.length;i++){const s=t[i];this._upsampleLevels[s.level]={parentLevel:e?e.level:-1,factor:e?e.resolution/s.resolution:0},e=s}}};e([Hn({type:Number,json:{write:!0}})],_w.prototype,"compressionQuality",void 0),e([Hn({type:Number,json:{write:!0}})],_w.prototype,"dpi",void 0),e([Hn({type:String,json:{read:jw.read,write:jw.write,origins:{"web-scene":{read:!1,write:!1}}}})],_w.prototype,"format",void 0),e([Hn({readOnly:!0})],_w.prototype,"isWrappable",null),e([Hn({type:ad,json:{write:!0}})],_w.prototype,"origin",void 0),e([Rh("origin")],_w.prototype,"readOrigin",null),e([Hn({type:[kw],value:null,json:{write:!0}})],_w.prototype,"lods",null),e([Hn({readOnly:!0})],_w.prototype,"minScale",void 0),e([Hn({readOnly:!0})],_w.prototype,"maxScale",void 0),e([Hn({readOnly:!0})],_w.prototype,"scales",void 0),e([Hn({cast:t=>Array.isArray(t)?t:"number"==typeof t?[t,t]:[256,256]})],_w.prototype,"size",void 0),e([Rh("size",["rows","cols"])],_w.prototype,"readSize",null),e([fh("size",{cols:{type:Gn},rows:{type:Gn}})],_w.prototype,"writeSize",null),e([Hn({type:Lh,json:{write:!0}})],_w.prototype,"spatialReference",void 0),_w=Iw=e([_r("esri.layers.support.TileInfo")],_w);const Tw=_w;var Ow=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:""+t,domNode:null}},Aw=function(t,e){for(var i=0,s=t.length;i<s;i++){var n=t[i];Array.isArray(n)?Aw(n,e):null!=n&&!1!==n&&(n.hasOwnProperty("vnodeSelector")||(n=Ow(n)),e.push(n))}};function Fw(t,e,...i){return"function"!=typeof t||Pc(t)?function(t,e){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];if(1===i.length&&"string"==typeof i[0])return{vnodeSelector:t,properties:e||void 0,children:void 0,text:i[0],domNode:null};var n=[];return Aw(i,n),{vnodeSelector:t,properties:e||void 0,children:n,text:void 0,domNode:null}}(t,e,...i):t(e,...i)}function Cw(t,e){const i="h"+qp(Math.ceil(t.level),1,6);return delete t.level,Fw(i,{...t,class:Cl("esri-widget__heading",t.class)},e)}function Pw(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${e}'`);return{value:Ew(t[e])}}}function Ew(t){return function(e,...i){!function(t){const{type:e}=t;return t instanceof KeyboardEvent||"keyup"===e||"keydown"===e||"keypress"===e}(e)?t.call(this,e,...i):Gl(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click())}}function Lw(t){return function(e,i){e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:i})}}function Rw(t){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const i=e._delegatedEventNames,s=Array.isArray(t)?t:function(t){return t.split(",").map((t=>t.trim()))}(t);i.push(...s)}}function Nw(t){return t&&"function"==typeof t.render}function Dw(t){return t&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}let Vw=class extends Ar{constructor(){super(...arguments),this.updating=!1,this.handleId=0,this.handles=new Qr,this.scheduleHandleId=0,this.pendingPromises=new Set}destroy(){this.removeAll(),this.handles.destroy()}add(t,e,i,s=0){const n=0!=(1&s),r=++this.handleId;n||this.installSyncUpdatingWatch(t,e,r);const o=0!=(2&s)?Yr(t,e,i,n):t.watch(e,i,n);return this.handles.add(o,r),{remove:()=>this.handles.remove(r)}}addOnCollectionPropertyChange(t,e,i,s=0){const n=0!=(2&s),r=++this.handleId;return this.handles.add([uo(t,e,"after-changes",this.createSyncUpdatingCallback()),uo(t,e,"change",i,n?t=>{i({added:t.items,removed:[],moved:[],target:t})}:void 0)],r),{remove:()=>{this.handles.remove(r)}}}addOnCollectionChange(t,e,i=0){const s=0!=(2&i),n=++this.handleId;return this.handles.add([t.on("after-changes",this.createSyncUpdatingCallback()),t.on("change",e)],n),s&&e({added:t.items,removed:[],moved:[],target:t}),{remove:()=>{this.handles.remove(n)}}}addPromise(t){if(c(t))return t;const e=++this.handleId;this.handles.add({remove:()=>{this.pendingPromises.delete(t)&&(0!==this.pendingPromises.size||this.handles.has($w)||this._set("updating",!1))}},e),this.pendingPromises.add(t),this._set("updating",!0);const i=()=>this.handles.remove(e);return t.then(i,i),t}removeAll(){this.pendingPromises.clear(),this.handles.removeAll(),this._set("updating",!1)}installSyncUpdatingWatch(t,e,i){const s=Wy((()=>zi(t,e)),this.createSyncUpdatingCallback(),{sync:!0,equals:()=>!1});return this.handles.add(s,i),s}createSyncUpdatingCallback(){return()=>{this.handles.remove($w),++this.scheduleHandleId;const t=this.scheduleHandleId;this._get("updating")||this._set("updating",!0),this.handles.add(Gs((()=>{t===this.scheduleHandleId&&(this._set("updating",this.pendingPromises.size>0),this.handles.remove($w))})),$w)}}};e([Hn({readOnly:!0})],Vw.prototype,"updating",void 0),Vw=e([_r("esri.views.support.WatchUpdatingTracking")],Vw);const $w=-42,zw=t=>{let i=class extends t{destroy(){this.destroyed||(this.handles.destroy(),this.updatingHandles.destroy())}get handles(){return this._get("handles")||new Qr}get updatingHandles(){return this._get("updatingHandles")||new Vw}};return e([Hn({readOnly:!0})],i.prototype,"handles",null),e([Hn({readOnly:!0})],i.prototype,"updatingHandles",null),i=e([_r("esri.core.HandleOwner")],i),i};let Gw=class extends(zw(Ar)){};Gw=e([_r("esri.core.HandleOwner")],Gw);const Uw=wo()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),qw=wo()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function Bw(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}function Ww(t){return void 0!==t.points}function Hw(t){return void 0!==t.x&&void 0!==t.y}function Jw(t){return void 0!==t.paths}function Zw(t){return void 0!==t.rings}function Qw(t){return c(t)?null:t instanceof Dh?t:Hw(t)?ad.fromJSON(t):Jw(t)?iv.fromJSON(t):Zw(t)?Xg.fromJSON(t):Ww(t)?Km.fromJSON(t):Bw(t)?Ld.fromJSON(t):null}function Kw(t){return t?Hw(t)?"esriGeometryPoint":Jw(t)?"esriGeometryPolyline":Zw(t)?"esriGeometryPolygon":Bw(t)?"esriGeometryEnvelope":Ww(t)?"esriGeometryMultipoint":null:null}const Yw={esriGeometryPoint:ad,esriGeometryPolyline:iv,esriGeometryPolygon:Xg,esriGeometryEnvelope:Ld,esriGeometryMultipoint:Km};function Xw(t){return t&&Yw[t]||null}const tb={base:Dh,key:"type",typeMap:{extent:Ld,multipoint:Km,point:ad,polyline:iv,polygon:Xg}};var eb;function ib(t,e){switch(t.type){case"range":{const i="range"in t?t.range[1]:t.maxValue;if(+e<("range"in t?t.range[0]:t.minValue)||+e>i)return eb.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(null==t.codedValues||t.codedValues.every((t=>null==t||t.code!==e)))return eb.INVALID_CODED_VALUE}return null}function sb(t){if(t&&"range"===t.type)return{min:"range"in t?t.range[0]:t.minValue,max:"range"in t?t.range[1]:t.maxValue}}let nb;function rb(){return nb||(nb=(async()=>{const t=await import("./p-082c34d3.js").then((function(t){return t.as}));return{arcade:t.arcade,arcadeUtils:t,Dictionary:t.Dictionary,Feature:t.arcadeFeature}})()),nb}zn(tb),function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"}(eb||(eb={}));const ob=(t,e,i)=>lb.create(t,e,i,null,["$feature"]),ab=(t,e,i)=>lb.create(t,e,i,null,["$feature","$view"]);class lb{constructor(t,e,i,s,n,r,o,a){this.script=t,this.evaluate=n,this.fields=Array.isArray(o)?o:o.fields,this._syntaxTree=s,this._arcade=e,this._arcadeDictionary=i,this._arcadeFeature=r,this._spatialReference=a,this._referencesGeometry=e.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(t,e,i,s,n,r){const{arcade:o,Feature:a,Dictionary:l}=await rb(),c=Lh.fromJSON(e),h=o.parseScript(t,r),d=n.reduce(((t,e)=>({...t,[e]:null})),{});let f=null;u(s)&&(f=new l(s),f.immutable=!0,d.$config=null);const p=o.scriptUsesGeometryEngine(h)&&o.enableGeometrySupport(),y=o.scriptUsesFeatureSet(h)&&o.enableFeatureSetSupport(),m=o.scriptIsAsync(h)&&o.enableAsyncSupport(),g={vars:d,spatialReference:c,useAsync:!!m},v=new l;v.immutable=!1,v.setField("scale",0);const w=o.compileScript(h,g);return await Promise.all([p,y,m]),new lb(t,o,l,h,(t=>("$view"in t&&t.$view&&(v.setField("scale",t.$view.scale),t.$view=v),f&&(t.$config=f),w({vars:t,spatialReference:c}))),new a,i,c)}repurposeFeature(t){return t.geometry&&!t.geometry.spatialReference&&(t.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(t.geometry,t.attributes,{fields:this.fields}),this._arcadeFeature}repurposeAdapter(t){return this._arcadeFeature.repurposeFromAdapter(t,{fields:this.fields}),this._arcadeFeature}createDictionary(){return new this._arcadeDictionary}referencesMember(t){return this._arcade.referencesMember(this._syntaxTree,t)}referencesFunction(t){return this._arcade.referencesFunction(this._syntaxTree,t)}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}extractFieldLiterals(){return this._arcade.extractExpectedFieldLiterals(this._syntaxTree)}}const ub=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],cb=["field","normalizationField"];function hb(t,e){if(null!=t&&null!=e)for(const i of Array.isArray(t)?t:[t])if(db(ub,i,e),"visualVariables"in i&&i.visualVariables)for(const t of i.visualVariables)db(cb,t,e)}function db(t,e,i){if(t)for(const s of t){const t=Q(s,e),n=t&&"function"!=typeof t&&i.get(t);n&&K(s,n.name,e)}}function fb(t,e){if(null!=t&&null!=e&&e.fields.length)if("startField"in t){const i=e.get(t.startField),s=e.get(t.endField);t.startField=i&&i.name||null,t.endField=s&&s.name||null}else{const i=e.get(t.startTimeField),s=e.get(t.endTimeField);t.startTimeField=i&&i.name||null,t.endTimeField=s&&s.name||null}}const pb=new Set;function yb(t,e){return t&&e?(pb.clear(),mb(pb,t,e),Array.from(pb).sort()):[]}function mb(t,e,i){var s;if(i)if(null!=e&&null!=(s=e.fields)&&s.length)if(i.includes("*"))for(const{name:i}of e.fields)t.add(i);else for(const s of i)gb(t,e,s);else{if(i.includes("*"))return t.clear(),void t.add("*");for(const e of i)t.add(e)}}function gb(t,e,i){if("string"==typeof i)if(e){const s=e.get(i);s&&t.add(s.name)}else t.add(i)}function vb(t,e){return c(e)||c(t)?[]:e.includes("*")?t.fields.map((t=>t.name)):e}async function wb(t,e,i){var s;if(!i)return;const{arcadeUtils:n}=await rb(),r=n.extractFieldNames(i,null==e||null==(s=e.fields)?void 0:s.map((t=>t.name)));for(const i of r)gb(t,e,i)}async function bb(t,e,i){if(i&&"1=1"!==i){const s=(await import("./p-c0f8009d.js")).WhereClause.create(i,e);if(!s.isStandardized)throw new dt("fieldUtils:collectFilterFields","Where clause is not standardized");mb(t,e,s.fieldNames)}}function Mb(t,e){for(const i of t)if(i&&i.valueType&&i.valueType===e)return i.name;return null}async function Sb(t,e){if(!e)return;const i=Q("elevationInfo.featureExpressionInfo",e);return i?i.collectRequiredFields(t,e.fieldsIndex):void 0}async function xb(t,e,i){var s;if(!e||!i||"cluster"!==i.type)return;const n=[];null!=(s=i.popupTemplate)&&s.expressionInfos&&n.push(...i.popupTemplate.expressionInfos.map((i=>wb(t,e.fieldsIndex,i.expression)))),i.fields&&n.push(...i.fields.map((i=>async function(t,e,i){i.outStatistic.onStatisticValueExpression?wb(t,e,i.outStatistic.onStatisticValueExpression):t.add(i.outStatistic.onStatisticField)}(t,e.fieldsIndex,i)))),await Promise.all(n)}async function kb(t,e,i){e&&(e.timeInfo&&u(i)&&i.timeExtent&&mb(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&mb(t,e.fieldsIndex,[e.floorInfo.floorField]),u(i)&&u(i.where)&&await bb(t,e.fieldsIndex,i.where))}async function Ib(t,e,i){e&&i&&await Promise.all(i.map((i=>async function(t,e,i){e&&i&&(i.valueExpression?await wb(t,e.fieldsIndex,i.valueExpression):i.field&&gb(t,e.fieldsIndex,i.field))}(t,e,i))))}function jb(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;return e?yb(t.fieldsIndex,[e&&e.creatorField,e&&e.creationDateField,e&&e.editorField,e&&e.editDateField]):[]}function _b(t){if(!t)return[];const e=t.geometryFieldsInfo;return e?yb(t.fieldsIndex,[e.shapeAreaField,e.shapeLengthField]):[]}async function Tb(t,e){const{labelingInfo:i,fieldsIndex:s}=e;i&&i.length&&await Promise.all(i.map((e=>async function(t,e,i){if(!i)return;const s=i.getLabelExpression(),n=i.where;if("arcade"===s.type)await wb(t,e,s.expression);else{const i=s.expression.match(/{[^}]*}/g);i&&i.forEach((i=>{gb(t,e,i.slice(1,-1))}))}await bb(t,e,n)}(t,s,e))))}function Ob(t){const e=t.defaultValue;return void 0!==e&&Nb(t,e)?e:t.nullable?null:void 0}function Ab(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}function Fb(t){return null===t||Ab(t)}const Cb="isInteger"in Number?Number.isInteger:t=>"number"==typeof t&&isFinite(t)&&Math.floor(t)===t;function Pb(t){return null===t||Cb(t)}function Eb(t){return null!=t&&"string"==typeof t}function Lb(t){return null===t||Eb(t)}function Rb(){return!0}function Nb(t,e){let i;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":i=t.nullable?Pb:Cb;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=t.nullable?Fb:Ab;break;case"string":case"esriFieldTypeString":i=t.nullable?Lb:Eb;break;default:i=Rb}return 1===arguments.length?i:i(e)}const Db=new Set(["integer","small-integer","single","double","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);function Vb(t){return null!=t&&Db.has(t.type)}function $b(t){return null!=t&&("string"===t.type||"esriFieldTypeString"===t.type)}function zb(t){return null!=t&&("date"===t.type||"esriFieldTypeDate"===t.type)}var Gb,Ub;function qb(t){return null==t||"number"==typeof t&&isNaN(t)?null:t}function Bb(t,e){return t.nullable&&null===e?null:Vb(t)&&!function(t,e){const i="string"==typeof t?Hb(t):t;return!!i&&(i.isInteger?Cb(e)&&e>=i.min&&e<=i.max:e>=i.min&&e<=i.max)}(t.type,Number(e))?Gb.OUT_OF_RANGE:Nb(t,e)?t.domain?ib(t.domain,e):null:Ub.INVALID_TYPE}function Wb(t){return sb(t.domain)||(Vb(t)?Hb(t.type):void 0)}function Hb(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return Jb;case"esriFieldTypeInteger":case"integer":return Zb;case"esriFieldTypeSingle":case"single":return Qb;case"esriFieldTypeDouble":case"double":return Kb}}(Gb||(Gb={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range",(Ub||(Ub={})).INVALID_TYPE="type-validation-error::invalid-type";const Jb={min:-32768,max:32767,isInteger:!0},Zb={min:-2147483648,max:2147483647,isInteger:!0},Qb={min:-34e37,max:12e37,isInteger:!1},Kb={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};function Yb(t,e,i){switch(t){case eb.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case eb.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case Ub.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case Gb.OUT_OF_RANGE:{const{min:t,max:s}=Hb(e.type);return`Value ${i} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${t} to ${s}`}}}function Xb(t,e){return!function(t,e,i){if(!e||!e.attributes||!t){if(u(i))for(const e of t)i.add(e);return!0}const s=e.attributes;let n=!1;for(const e of t)if(!(e in s)){if(n=!0,!u(i))break;i.add(e)}return n}(t,e,null)}let tM=class extends lh{constructor(t){super(t),this.type=null}};e([Hn({type:["attachments","custom","fields","media","text"],readOnly:!0,json:{read:!1,write:!0}})],tM.prototype,"type",void 0),tM=e([_r("esri.popup.content.Content")],tM);const eM=tM;var iM;let sM=iM=class extends eM{constructor(t){super(t),this.description=null,this.displayType=null,this.title=null,this.type="attachments"}clone(){return new iM({description:this.description,displayType:this.displayType,title:this.title})}};e([Hn({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],sM.prototype,"description",void 0),e([Hn({type:["auto","preview","list"],json:{write:!0}})],sM.prototype,"displayType",void 0),e([Hn({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],sM.prototype,"title",void 0),e([Hn({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],sM.prototype,"type",void 0),sM=iM=e([_r("esri.popup.content.AttachmentsContent")],sM);const nM=sM;var rM;let oM=rM=class extends eM{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new rM({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?H(this.outFields):null})}};e([Hn()],oM.prototype,"creator",void 0),e([Hn()],oM.prototype,"destroyer",void 0),e([Hn()],oM.prototype,"outFields",void 0),e([Hn({type:["custom"],readOnly:!0})],oM.prototype,"type",void 0),oM=rM=e([_r("esri.popup.content.CustomContent")],oM);const aM=oM;function lM(t,e={}){var i;const s=t instanceof vo?t:new vo(t,e),n={type:null==(i=null==e?void 0:e.ignoreUnknown)||i?s.apiValues:String,readOnly:null==e?void 0:e.readOnly,json:{type:s.jsonValues,read:(null==e||!e.readOnly)&&{reader:s.read},write:{writer:s.write}}};return void 0!==(null==e?void 0:e.default)&&(n.json.default=e.default),void 0!==(null==e?void 0:e.name)&&(n.json.name=e.name),Hn(n)}const uM=wo()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});var cM;uM.toJSON.bind(uM),uM.fromJSON.bind(uM);let hM=cM=class extends lh{constructor(t){super(t),this.dateFormat=null,this.dateTimeFormatOptions=null,this.digitSeparator=!1,this.places=null}clone(){return new cM({dateFormat:this.dateFormat,digitSeparator:this.digitSeparator,places:this.places})}format(t){return this.dateFormat?qo(t,{...Uo(this.dateFormat),...this.dateTimeFormatOptions}):Zo(t,Jo(this))}};e([lM(uM)],hM.prototype,"dateFormat",void 0),e([Hn({type:Object,json:{read:!1}})],hM.prototype,"dateTimeFormatOptions",void 0),e([Hn({type:Boolean,json:{write:!0}})],hM.prototype,"digitSeparator",void 0),e([Hn({type:Gn,json:{write:!0}})],hM.prototype,"places",void 0),hM=cM=e([_r("esri.popup.support.FieldInfoFormat")],hM);const dM=hM;var fM;let pM=fM=class extends lh{constructor(t){super(t),this.fieldName=null,this.format=null,this.isEditable=!1,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new fM({fieldName:this.fieldName,format:this.format?H(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};e([Hn({type:String,json:{write:!0}})],pM.prototype,"fieldName",void 0),e([Hn({type:dM,json:{write:!0}})],pM.prototype,"format",void 0),e([Hn({type:Boolean,json:{write:!0,default:!1}})],pM.prototype,"isEditable",void 0),e([Hn({type:String,json:{write:!0}})],pM.prototype,"label",void 0),e([lM(new vo({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],pM.prototype,"stringFieldOption",void 0),e([Hn({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],pM.prototype,"statisticType",void 0),e([Hn({type:String,json:{write:!0}})],pM.prototype,"tooltip",void 0),e([Hn({type:Boolean,json:{write:!0}})],pM.prototype,"visible",void 0),pM=fM=e([_r("esri.popup.FieldInfo")],pM);const yM=pM;var mM;let gM=mM=class extends eM{constructor(t){super(t),this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(t,e){e.fieldInfos=t&&t.map((t=>t.toJSON()))}clone(){return new mM({description:this.description,fieldInfos:Array.isArray(this.fieldInfos)?H(this.fieldInfos):null,title:this.title})}};e([Hn({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],gM.prototype,"description",void 0),e([Hn({type:[yM]})],gM.prototype,"fieldInfos",void 0),e([fh("fieldInfos")],gM.prototype,"writeFieldInfos",null),e([Hn({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],gM.prototype,"title",void 0),e([Hn({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],gM.prototype,"type",void 0),gM=mM=e([_r("esri.popup.content.FieldsContent")],gM);const vM=gM;let wM=class extends lh{constructor(t){super(t),this.altText=null,this.caption="",this.title="",this.type=null}};e([Hn({type:String,json:{write:!0}})],wM.prototype,"altText",void 0),e([Hn({type:String,json:{write:!0}})],wM.prototype,"caption",void 0),e([Hn({type:String,json:{write:!0}})],wM.prototype,"title",void 0),e([Hn({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],wM.prototype,"type",void 0),wM=e([_r("esri.popup.content.mixins.MediaInfo")],wM);const bM=wM;var MM;let SM=MM=class extends Ar{constructor(t){super(t),this.tooltip=null,this.value=null}clone(){return new MM({tooltip:this.tooltip,value:this.value})}};e([Hn()],SM.prototype,"tooltip",void 0),e([Hn()],SM.prototype,"value",void 0),SM=MM=e([_r("esri.popup.content.support.ChartMediaInfoValueSeries")],SM);const xM=SM;var kM;let IM=kM=class extends lh{constructor(t){super(t),this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new kM({fields:H(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}};e([Hn({type:[String],json:{write:!0}})],IM.prototype,"fields",void 0),e([Hn({type:String,json:{write:!0}})],IM.prototype,"normalizeField",void 0),e([Hn({type:[xM],json:{read:!1}})],IM.prototype,"series",void 0),e([Hn({type:String,json:{write:!0}})],IM.prototype,"tooltipField",void 0),IM=kM=e([_r("esri.popup.content.support.ChartMediaInfoValue")],IM);const jM=IM;let _M=class extends bM{constructor(t){super(t),this.type=null,this.value=null}};e([Hn({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],_M.prototype,"type",void 0),e([Hn({type:jM,json:{write:!0}})],_M.prototype,"value",void 0),_M=e([_r("esri.popup.content.mixins.ChartMediaInfo")],_M);const TM=_M,OM=wo()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var AM;let FM=AM=class extends TM{constructor(t){super(t),this.type="bar-chart"}clone(){return new AM({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};e([Hn({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:OM.write}})],FM.prototype,"type",void 0),FM=AM=e([_r("esri.popup.content.BarChartMediaInfo")],FM);const CM=FM;var PM;let EM=PM=class extends TM{constructor(t){super(t),this.type="column-chart"}clone(){return new PM({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};e([Hn({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:OM.write}})],EM.prototype,"type",void 0),EM=PM=e([_r("esri.popup.content.ColumnChartMediaInfo")],EM);const LM=EM;var RM;let NM=RM=class extends lh{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new RM({linkURL:this.linkURL,sourceURL:this.sourceURL})}};e([Hn({type:String,json:{write:!0}})],NM.prototype,"linkURL",void 0),e([Hn({type:String,json:{write:!0}})],NM.prototype,"sourceURL",void 0),NM=RM=e([_r("esri.popup.content.support.ImageMediaInfoValue")],NM);const DM=NM;var VM;let $M=VM=class extends bM{constructor(t){super(t),this.refreshInterval=null,this.type="image",this.value=null}clone(){return new VM({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}};e([Hn({type:Number,json:{write:!0}})],$M.prototype,"refreshInterval",void 0),e([Hn({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],$M.prototype,"type",void 0),e([Hn({type:DM,json:{write:!0}})],$M.prototype,"value",void 0),$M=VM=e([_r("esri.popup.content.ImageMediaInfo")],$M);const zM=$M;var GM;let UM=GM=class extends TM{constructor(t){super(t),this.type="line-chart"}clone(){return new GM({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};e([Hn({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:OM.write}})],UM.prototype,"type",void 0),UM=GM=e([_r("esri.popup.content.LineChartMediaInfo")],UM);const qM=UM;var BM;let WM=BM=class extends TM{constructor(t){super(t),this.type="pie-chart"}clone(){return new BM({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};e([Hn({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:OM.write}})],WM.prototype,"type",void 0),WM=BM=e([_r("esri.popup.content.PieChartMediaInfo")],WM);const HM=WM,JM={base:bM,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":CM,"column-chart":LM,"line-chart":qM,"pie-chart":HM,image:zM}};var ZM;let QM=ZM=class extends eM{constructor(t){super(t),this.activeMediaInfoIndex=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map((t=>"image"===t.type?zM.fromJSON(t):"barchart"===t.type?CM.fromJSON(t):"columnchart"===t.type?LM.fromJSON(t):"linechart"===t.type?qM.fromJSON(t):"piechart"===t.type?HM.fromJSON(t):void 0)).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map((t=>t.toJSON()))}clone(){return new ZM({activeMediaInfoIndex:this.activeMediaInfoIndex,description:this.description,mediaInfos:this.mediaInfos?H(this.mediaInfos):null,title:this.title})}};e([Hn()],QM.prototype,"activeMediaInfoIndex",void 0),e([Hn({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],QM.prototype,"description",void 0),e([Hn({types:[JM]})],QM.prototype,"mediaInfos",void 0),e([Rh("mediaInfos")],QM.prototype,"readMediaInfos",null),e([fh("mediaInfos")],QM.prototype,"writeMediaInfos",null),e([Hn({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],QM.prototype,"title",void 0),e([Hn({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],QM.prototype,"type",void 0),QM=ZM=e([_r("esri.popup.content.MediaContent")],QM);const KM=QM;var YM;let XM=YM=class extends eM{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new YM({text:this.text})}};e([Hn({type:String,json:{write:!0}})],XM.prototype,"text",void 0),e([Hn({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],XM.prototype,"type",void 0),XM=YM=e([_r("esri.popup.content.TextContent")],XM);const tS=XM,eS={base:null,key:"type",typeMap:{attachment:nM,media:KM,text:tS,field:vM}};var iS;let sS=iS=class extends lh{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new iS({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};e([Hn({type:String,json:{write:!0}})],sS.prototype,"name",void 0),e([Hn({type:String,json:{write:!0}})],sS.prototype,"title",void 0),e([Hn({type:String,json:{write:!0}})],sS.prototype,"expression",void 0),e([Hn({type:["string","number"],json:{write:!0}})],sS.prototype,"returnType",void 0),sS=iS=e([_r("esri.popup.ExpressionInfo")],sS);const nS=sS;var rS;let oS=rS=class extends lh{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new rS({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};e([Hn({type:Boolean,json:{write:!0}})],oS.prototype,"returnTopmostRaster",void 0),e([Hn({type:Boolean,json:{write:!0}})],oS.prototype,"showNoDataRecords",void 0),oS=rS=e([_r("esri.popup.LayerOptions")],oS);const aS=oS;var lS;let uS=lS=class extends lh{constructor(t){super(t),this.field=null,this.order=null}clone(){return new lS({field:this.field,order:this.order})}};e([Hn({type:String,json:{write:!0}})],uS.prototype,"field",void 0),e([Hn({type:["asc","desc"],json:{write:!0}})],uS.prototype,"order",void 0),uS=lS=e([_r("esri.popup.support.RelatedRecordsInfoFieldOrder")],uS);const cS=uS;var hS;let dS=hS=class extends lh{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new hS({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?H(this.orderByFields):null})}};e([Hn({type:Boolean,json:{write:!0}})],dS.prototype,"showRelatedRecords",void 0),e([Hn({type:[cS],json:{write:!0}})],dS.prototype,"orderByFields",void 0),dS=hS=e([_r("esri.popup.RelatedRecordsInfo")],dS);const fS=dS;let pS=0;const yS=t=>{let i=class extends t{constructor(...t){super(...t),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+pS++})}};return i=e([_r("esri.core.Identifiable")],i),i};let mS=class extends(yS(class{})){};var gS;mS=e([_r("esri.core.Identifiable")],mS);let vS=gS=class extends(yS(Ar)){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new gS({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};e([Hn()],vS.prototype,"active",void 0),e([Hn()],vS.prototype,"className",void 0),e([Hn()],vS.prototype,"disabled",void 0),e([Hn()],vS.prototype,"id",void 0),e([Hn()],vS.prototype,"indicator",void 0),e([Hn()],vS.prototype,"title",void 0),e([Hn()],vS.prototype,"type",void 0),e([Hn()],vS.prototype,"visible",void 0),vS=gS=e([_r("esri.support.actions.ActionBase")],vS);const wS=vS;var bS;let MS=bS=class extends wS{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new bS({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};e([Hn()],MS.prototype,"image",void 0),MS=bS=e([_r("esri.support.Action.ActionButton")],MS);const SS=MS;var xS;let kS=xS=class extends wS{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new xS({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};e([Hn()],kS.prototype,"image",void 0),e([Hn()],kS.prototype,"value",void 0),kS=xS=e([_r("esri.support.Action.ActionToggle")],kS);const IS=kS;var jS;const _S=Jr.ofType({key:"type",defaultKeyValue:"button",base:wS,typeMap:{button:SS,toggle:IS}}),TS={base:eM,key:"type",typeMap:{media:KM,custom:aM,text:tS,attachments:nM,fields:vM}},OS="esri.PopupTemplate",AS=ct.getLogger(OS),FS=["attachments","fields","media","text"];let CS=jS=class extends lh{constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title="",this.relatedRecordsInfo=null}castContent(t){return Array.isArray(t)?t.map((t=>zn(TS,t))):"string"==typeof t||"function"==typeof t||t instanceof HTMLElement||Qe(t)?t:(AS.error("content error","unsupported content value",{value:t}),null)}readContent(t,e){const{popupElements:i}=e;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(e):this._readPopupInfo(e)}writeContent(t,e,i,s){"string"!=typeof t?Array.isArray(t)&&(e.popupElements=t.filter((t=>-1!==FS.indexOf(t.type))).map((t=>t&&t.toJSON(s))),e.popupElements.forEach((t=>{"attachments"===t.type?this._writeAttachmentContent(e):"media"===t.type?this._writeMediaContent(t,e):"text"===t.type&&this._writeTextContent(t,e)}))):e.description=t}writeFieldInfos(t,e,i,s){const{content:n}=this,r=Array.isArray(n)?n:null;if(t){const i=r?r.filter((t=>"fields"===t.type)):[],n=i.length&&i.every((t=>{var e;return null==(e=t.fieldInfos)?void 0:e.length}));e.fieldInfos=t.filter(Boolean).map((t=>{const e=t.toJSON(s);return n&&(e.visible=!1),e}))}if(r)for(const t of r)"fields"===t.type&&this._writeFieldsContent(t,e)}writeLayerOptions(t,e,i,s){e[i]=!t||null===t.showNoDataRecords&&null===t.returnTopmostRaster?null:t.toJSON(s)}writeTitle(t,e){e.title=t||""}clone(){const{actions:t}=this,e=t?H(t.toArray()):[];return new jS({actions:e,content:Array.isArray(this.content)?H(this.content):this.content,expressionInfos:Array.isArray(this.expressionInfos)?H(this.expressionInfos):null,fieldInfos:Array.isArray(this.fieldInfos)?H(this.fieldInfos):null,layerOptions:this.layerOptions?H(this.layerOptions):null,lastEditInfoEnabled:this.lastEditInfoEnabled,outFields:Array.isArray(this.outFields)?H(this.outFields):null,overwriteActions:this.overwriteActions,returnGeometry:this.returnGeometry,title:this.title,relatedRecordsInfo:this.relatedRecordsInfo?H(this.relatedRecordsInfo):null})}async collectRequiredFields(t,e){await this._collectExpressionInfoFields(t,e,this.expressionInfos),mb(t,e,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(t){const e=new Set;return await this.collectRequiredFields(e,t),[...e].sort()}_writeFieldsContent(t,e){if(!Array.isArray(t.fieldInfos)||!t.fieldInfos.length)return;const i=H(t.fieldInfos);Array.isArray(e.fieldInfos)?i.forEach((t=>{const i=e.fieldInfos.find((e=>e.fieldName.toLowerCase()===t.fieldName.toLowerCase()));i?i.visible=!0:e.fieldInfos.push(t)})):e.fieldInfos=i}_writeAttachmentContent(t){t.showAttachments||(t.showAttachments=!0)}_writeTextContent(t,e){!e.description&&t.text&&(e.description=t.text)}_writeMediaContent(t,e){if(!Array.isArray(t.mediaInfos)||!t.mediaInfos.length)return;const i=H(t.mediaInfos);e.mediaInfos=Array.isArray(e.mediaInfos)?[...e.mediaInfos,...i]:i}_readPopupInfoElements({description:t,mediaInfos:e,popupElements:i}){const s={description:!1,mediaInfos:!1};return i.map((i=>"media"===i.type?(i.mediaInfos||!e||s.mediaInfos||(i.mediaInfos=e,s.mediaInfos=!0),KM.fromJSON(i)):"text"===i.type?(i.text||!t||s.description||(i.text=t,s.description=!0),tS.fromJSON(i)):"attachments"===i.type?nM.fromJSON(i):"fields"===i.type?vM.fromJSON(i):void 0)).filter(Boolean)}_readPopupInfo({description:t,mediaInfos:e,showAttachments:i}){const s=[];return s.push(t?new tS({text:t}):new vM),Array.isArray(e)&&e.length&&s.push(KM.fromJSON({mediaInfos:e})),i&&s.push(nM.fromJSON({displayType:"auto"})),s.length?s:t}_getContentElementFields(t){return t&&"attachments"!==t.type?"custom"===t.type?t.outFields||[]:"fields"===t.type?this._getFieldInfoFields(t.fieldInfos||this.fieldInfos):"media"===t.type?(t.mediaInfos||[]).reduce(((t,e)=>[...t,...this._getMediaInfoFields(e)]),[]):"text"===t.type?this._extractFieldNames(t.text):void 0:[]}_getMediaInfoFields(t){const{caption:e,title:i,value:s}=t,n=s||{},{fields:r=[],normalizeField:o,tooltipField:a,sourceURL:l,linkURL:u}=n,c=[...this._extractFieldNames(i),...this._extractFieldNames(e),...this._extractFieldNames(l),...this._extractFieldNames(u),...r];return o&&c.push(o),a&&c.push(a),c}_getContentFields(t){return"string"==typeof t?this._extractFieldNames(t):Array.isArray(t)?t.reduce(((t,e)=>[...t,...this._getContentElementFields(e)]),[]):[]}async _collectExpressionInfoFields(t,e,i){i&&await Promise.all(i.map((i=>wb(t,e,i.expression))))}_getFieldInfoFields(t){return t?t.filter((t=>void 0===t.visible||!!t.visible)).map((t=>t.fieldName)).filter((t=>-1===t.indexOf("relationships/")&&-1===t.indexOf("expression/"))):[]}_getActionsFields(t){return t?t.toArray().reduce(((t,e)=>[...t,...this._getActionFields(e)]),[]):[]}_getActionFields(t){const{className:e,title:i,type:s}=t,n="button"===s||"toggle"===s?t.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(e),...this._extractFieldNames(n)]}_getTitleFields(t){return"string"==typeof t?this._extractFieldNames(t):[]}_extractFieldNames(t){if(!t||"string"!=typeof t)return[];const e=t.match(/{[^}]*}/g);if(!e)return[];const i=/\{(\w+):.+\}/,s=e.filter((t=>!(0===t.indexOf("{relationships/")||0===t.indexOf("{expression/")))).map((t=>t.replace(i,"{$1}")));return s?s.map((t=>t.slice(1,-1))):[]}};e([Hn({type:_S})],CS.prototype,"actions",void 0),e([Hn()],CS.prototype,"content",void 0),e([xa("content")],CS.prototype,"castContent",null),e([Rh("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments"])],CS.prototype,"readContent",null),e([fh("content",{popupElements:{type:Jr.ofType(eS)},showAttachments:{type:Boolean},mediaInfos:{type:Jr.ofType(JM)},description:{type:String}})],CS.prototype,"writeContent",null),e([Hn({type:[nS],json:{write:!0}})],CS.prototype,"expressionInfos",void 0),e([Hn({type:[yM]})],CS.prototype,"fieldInfos",void 0),e([fh("fieldInfos")],CS.prototype,"writeFieldInfos",null),e([Hn({type:aS})],CS.prototype,"layerOptions",void 0),e([fh("layerOptions")],CS.prototype,"writeLayerOptions",null),e([Hn({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],CS.prototype,"lastEditInfoEnabled",void 0),e([Hn()],CS.prototype,"outFields",void 0),e([Hn()],CS.prototype,"overwriteActions",void 0),e([Hn()],CS.prototype,"returnGeometry",void 0),e([Hn({json:{type:String}})],CS.prototype,"title",void 0),e([fh("title")],CS.prototype,"writeTitle",null),e([Hn({type:fS,json:{write:!0}})],CS.prototype,"relatedRecordsInfo",void 0),CS=jS=e([_r(OS)],CS);const PS=CS,ES={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function LS(t){return ES[t]||ES[t.toLowerCase()]}function RS(t){var e;return null!=(e=ES[t])?e:ES[t.toLowerCase()]}function NS(t,e,i){i<0&&++i,i>1&&--i;const s=6*i;return s<1?t+(e-t)*s:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function DS(t,e,i,s=1){const n=(t%360+360)%360/360,r=i<=.5?i*(e+1):i+e-i*e,o=2*i-r;return[Math.round(255*NS(o,r,n+1/3)),Math.round(255*NS(o,r,n)),Math.round(255*NS(o,r,n-1/3)),s]}function VS(t){return qp(In(t),0,255)}function $S(t,e,i){return isNaN(t=Number(t))?i:t<e?e:t>i?i:t}class zS{constructor(t){this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t)}static blendColors(t,e,i,s=new zS){return s.r=Math.round(t.r+(e.r-t.r)*i),s.g=Math.round(t.g+(e.g-t.g)*i),s.b=Math.round(t.b+(e.b-t.b)*i),s.a=t.a+(e.a-t.a)*i,s._sanitize()}static fromRgb(t,e){const i=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(i){const t=i[2].split(/\s*,\s*/),s=i[1];if("rgb"===s&&3===t.length||"rgba"===s&&4===t.length){const i=t[0];if("%"===i.charAt(i.length-1)){const i=t.map((t=>2.56*parseFloat(t)));return 4===t.length&&(i[3]=parseFloat(t[3])),zS.fromArray(i,e)}return zS.fromArray(t.map((t=>parseFloat(t))),e)}if("hsl"===s&&3===t.length||"hsla"===s&&4===t.length)return zS.fromArray(DS(parseFloat(t[0]),parseFloat(t[1])/100,parseFloat(t[2])/100,parseFloat(t[3])),e)}return null}static fromHex(t,e=new zS){if(4!==t.length&&7!==t.length||"#"!==t[0])return null;const i=4===t.length?4:8,s=(1<<i)-1;let n=Number("0x"+t.substr(1));return isNaN(n)?null:(["b","g","r"].forEach((t=>{const r=n&s;n>>=i,e[t]=4===i?17*r:r})),e.a=1,e)}static fromArray(t,e=new zS){return e._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(e.a)&&(e.a=1),e._sanitize()}static fromString(t,e){const i=LS(t)?RS(t):null;return i&&zS.fromArray(i,e)||zS.fromRgb(t,e)||zS.fromHex(t,e)}static fromJSON(t){return t&&new zS([t[0],t[1],t[2],t[3]/255])}static toUnitRGB(t){return u(t)?[t.r/255,t.g/255,t.b/255]:null}static toUnitRGBA(t){return u(t)?[t.r/255,t.g/255,t.b/255,null!=t.a?t.a:1]:null}get isBright(){return.299*this.r+.587*this.g+.114*this.b>=127}setColor(t){if("string"==typeof t)zS.fromString(t,this);else if(Array.isArray(t))zS.fromArray(t,this);else{var e,i,s,n;this._set(null!=(e=t.r)?e:0,null!=(i=t.g)?i:0,null!=(s=t.b)?s:0,null!=(n=t.a)?n:1),t instanceof zS||this._sanitize()}return this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(){const t=this.r.toString(16),e=this.g.toString(16),i=this.b.toString(16);return`#${t.length<2?"0"+t:t}${e.length<2?"0"+e:e}${i.length<2?"0"+i:i}`}toCss(t=!1){const e=this.r+", "+this.g+", "+this.b;return t?`rgba(${e}, ${this.a})`:`rgb(${e})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(t=0){const e=VS(this.r),i=VS(this.g),s=VS(this.b);return 0===t||1!==this.a?[e,i,s,VS(255*this.a)]:[e,i,s]}clone(){return new zS(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}_sanitize(){return this.r=Math.round($S(this.r,0,255)),this.g=Math.round($S(this.g,0,255)),this.b=Math.round($S(this.b,0,255)),this.a=$S(this.a,0,1),this}_set(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=s}}zS.prototype.declaredClass="esri.Color";const GS=new vo({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let US=0,qS=class extends lh{constructor(t){super(t),this.id="sym"+US++,this.type=null}set color(t){this._set("color",t)}readColor(t){return t&&null!=t[0]?[t[0],t[1],t[2],t[3]/255]:t}async collectRequiredFields(t,e){}hash(){return JSON.stringify(this.toJSON())}clone(){}};e([Hn({type:GS.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:GS.write}}})],qS.prototype,"type",void 0),e([Hn({type:zS,value:new zS([0,0,0,1]),json:{write:{allowNull:!0}}})],qS.prototype,"color",null),e([Rh("color")],qS.prototype,"readColor",null),qS=e([_r("esri.symbols.Symbol")],qS);const BS=qS;var WS;let HS=WS=class extends BS{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){if(t)for(const i in t)e[i]=t[i]}async collectRequiredFields(t,e){if("CIMSymbolReference"===this.data.type){const i=this.data.primitiveOverrides;if(i){const s=i.map((i=>wb(t,e,i.valueExpressionInfo.expression)));await Promise.all(s)}}}clone(){return new WS({data:H(this.data)})}hash(){return""+at(JSON.stringify(this.data))}};e([Hn({json:{write:!1}})],HS.prototype,"color",void 0),e([Hn({json:{write:!0}})],HS.prototype,"data",void 0),e([Rh("data",["symbol"])],HS.prototype,"readData",null),e([fh("data",{})],HS.prototype,"writeData",null),e([lM({CIMSymbolReference:"cim"},{readOnly:!0})],HS.prototype,"type",void 0),HS=WS=e([_r("esri.symbols.CIMSymbol")],HS);const JS=HS;let ZS=class extends lh{constructor(t){super(t),this.enabled=!0,this.type=null}writeEnabled(t,e,i){t||(e[i]=t)}};e([Hn({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],ZS.prototype,"enabled",void 0),e([fh("enabled")],ZS.prototype,"writeEnabled",null),e([Hn({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],ZS.prototype,"type",void 0),ZS=e([_r("esri.symbols.Symbol3DLayer")],ZS);const QS=ZS,KS=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;function YS(t){return t?t/72*96:0}function XS(t){return t?72*t/96:0}function tx(t){if("string"==typeof t){const e=t.match(KS);if(e){const i=Number(e[1]),s=e[3]&&e[3].toLowerCase(),n="-"===t.charAt(0),r="px"===s?XS(i):i;return n?-r:r}return console.warn("screenUtils.toPt: input not recognized!"),null}return t}function ex(t=0,e=0){return{x:t,y:e}}function ix(t=0,e=0){return[t,e]}function sx(t){const e=In(100*(1-t));return Math.max(0,Math.min(e,100))}function nx(t){return Math.max(0,Math.min(1-t/100,1))}const rx={type:zS,json:{type:[Gn],default:null,read:{source:["color","transparency"],reader:function(t,e){const i=null!=e.transparency?nx(e.transparency):1,s=e.color;return s&&Array.isArray(s)?new zS([s[0]||0,s[1]||0,s[2]||0,i]):null}},write:{target:{color:{type:[Gn]},transparency:{type:Gn}},writer:function(t,e){e.color=t.toJSON().slice(0,3);const i=sx(t.a);0!==i&&(e.transparency=i)}}}},ox={type:Number,cast:tx,json:{write:!0}};let ax=class extends lh{constructor(t){super(t),this.color=new zS([0,0,0,1]),this.extensionLength=0,this.size=XS(1)}clone(){}cloneProperties(){return{color:H(this.color),size:this.size,extensionLength:this.extensionLength}}};e([Hn({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],ax.prototype,"type",void 0),e([Hn(rx)],ax.prototype,"color",void 0),e([Hn({...ox,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],ax.prototype,"extensionLength",void 0),e([Hn(ox)],ax.prototype,"size",void 0),ax=e([_r("esri.symbols.edges.Edges3D")],ax);const lx=ax;var ux;let cx=ux=class extends lx{constructor(t){super(t),this.type="sketch"}clone(){return new ux(this.cloneProperties())}};e([lM({sketch:"sketch"},{readOnly:!0})],cx.prototype,"type",void 0),cx=ux=e([_r("esri.symbols.edges.SketchEdges3D")],cx);const hx=cx;var dx;let fx=dx=class extends lx{constructor(t){super(t),this.type="solid"}clone(){return new dx(this.cloneProperties())}};e([lM({solid:"solid"},{readOnly:!0})],fx.prototype,"type",void 0),fx=dx=e([_r("esri.symbols.support.SolidEdges3D")],fx);const px={types:{key:"type",base:lx,typeMap:{solid:fx,sketch:hx}},json:{write:!0}};var yx;let mx=yx=class extends lh{constructor(t){super(t),this.color=null}clone(){const t={color:u(this.color)?this.color.clone():null};return new yx(t)}};e([Hn(rx)],mx.prototype,"color",void 0),mx=yx=e([_r("esri.symbols.support.Symbol3DMaterial")],mx);const gx=mx;var vx;let wx=vx=class extends QS{constructor(t){super(t),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new vx({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:u(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size})}};e([lM({Extrude:"extrude"},{readOnly:!0})],wx.prototype,"type",void 0),e([Hn({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],wx.prototype,"size",void 0),e([Hn({type:gx,json:{write:!0}})],wx.prototype,"material",void 0),e([Hn({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],wx.prototype,"castShadows",void 0),e([Hn(px)],wx.prototype,"edges",void 0),wx=vx=e([_r("esri.symbols.ExtrudeSymbol3DLayer")],wx);const bx=wx;let Mx=class extends BS{constructor(t){super(t),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};e([lM({esriSLS:"simple-line"},{readOnly:!0})],Mx.prototype,"type",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],Mx.prototype,"width",void 0),Mx=e([_r("esri.symbols.LineSymbol")],Mx);const Sx=Mx;var xx;let kx=xx=class extends lh{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,i,s){e[i]="web-map"===(null==s?void 0:s.origin)?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t&&null!=t[0]?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,i,s){"web-map"===(null==s?void 0:s.origin)||(e[i]=t)}clone(){return new xx({color:H(this.color),placement:this.placement,style:this.style})}hash(){var t;return`${this.placement}.${null==(t=this.color)?void 0:t.hash()}.${this.style}`}};e([Hn({type:["begin","end","begin-end"],json:{write:!0}})],kx.prototype,"placement",void 0),e([lM({"line-marker":"line-marker"},{readOnly:!0}),Hn({json:{origins:{"web-map":{write:!1}}}})],kx.prototype,"type",void 0),e([Hn({type:["arrow","circle","square","diamond","cross","x"]})],kx.prototype,"style",void 0),e([fh("style")],kx.prototype,"writeStyle",null),e([Hn({type:zS,value:null,json:{write:{allowNull:!0}}})],kx.prototype,"color",null),e([Rh("color")],kx.prototype,"readColor",null),e([fh("color")],kx.prototype,"writeColor",null),kx=xx=e([_r("esri.symbols.LineSymbolMarker")],kx);const Ix=kx;var jx;const _x=new vo({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let Tx=jx=class extends Sx{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,i,s,n,r){if(t&&"string"!=typeof t)return t;const o={};return null!=t&&(o.style=t),null!=e&&(o.color=e),null!=i&&(o.width=tx(i)),null!=s&&(o.cap=s),null!=n&&(o.join=n),null!=r&&(o.miterLimit=tx(r)),o}clone(){var t;return new jx({color:H(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:null==(t=this.marker)?void 0:t.clone()})}hash(){var t,e;return`${super.hash()}.${null==(t=this.color)?void 0:t.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${null==(e=this.marker)?void 0:e.hash()}`}};e([lM({esriSLS:"simple-line"},{readOnly:!0})],Tx.prototype,"type",void 0),e([Hn({type:_x.apiValues,json:{read:_x.read,write:_x.write}})],Tx.prototype,"style",void 0),e([Hn({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,i)=>({enabled:"round"!==t&&(null==i||null==i.origin)})}}})],Tx.prototype,"cap",void 0),e([Hn({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,i)=>({enabled:"round"!==t&&(null==i||null==i.origin)})}}})],Tx.prototype,"join",void 0),e([Hn({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":Ix}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],Tx.prototype,"marker",void 0),e([Hn({type:Number,json:{read:!1,write:!1}})],Tx.prototype,"miterLimit",void 0),Tx=jx=e([_r("esri.symbols.SimpleLineSymbol")],Tx);const Ox=Tx;let Ax=class extends BS{constructor(t){super(t),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline&&this.outline.hash()}`}};e([Hn({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Ox}},json:{default:null,write:!0}})],Ax.prototype,"outline",void 0),e([Hn({type:["simple-fill","picture-fill"],readOnly:!0})],Ax.prototype,"type",void 0),Ax=e([_r("esri.symbols.FillSymbol")],Ax);const Fx=Ax;let Cx=class extends lh{constructor(t){super(t)}clone(){}};e([Hn({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Cx.prototype,"type",void 0),Cx=e([_r("esri.symbols.patterns.LinePattern3D")],Cx);const Px=Cx;var Ex;const Lx=wo()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let Rx=Ex=class extends Px{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new Ex({style:this.style})}};e([Hn({type:["style"]})],Rx.prototype,"type",void 0),e([lM(Lx),Hn({type:["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"]})],Rx.prototype,"style",void 0),Rx=Ex=e([_r("esri.symbols.patterns.LineStylePattern3D")],Rx);const Nx=Rx;let Dx=class extends lh{constructor(t){super(t)}clone(){}};e([Hn({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Dx.prototype,"type",void 0),Dx=e([_r("esri.symbols.patterns.Pattern3D")],Dx);const Vx=Dx;var $x;let zx=$x=class extends Vx{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new $x({style:this.style})}};e([Hn({type:["style"]})],zx.prototype,"type",void 0),e([Hn({type:["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"],json:{read:!0,write:!0}})],zx.prototype,"style",void 0),zx=$x=e([_r("esri.symbols.patterns.StylePattern3D")],zx);const Gx=zx,Ux={types:{key:"type",base:Vx,typeMap:{style:Gx}},json:{write:!0}},qx={types:{key:"type",base:Px,typeMap:{style:Nx}},json:{write:!0}},Bx=new zS("white");new zS("black");const Wx=new zS([255,255,255,0]);var Hx;let Jx=Hx=class extends mx{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:u(this.color)?this.color.clone():null,colorMixMode:this.colorMixMode};return new Hx(t)}};function Zx(t=lk){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function Qx(t,e,i,s,n,r,o=Zx()){return o[0]=t,o[1]=e,o[2]=i,o[3]=s,o[4]=n,o[5]=r,o}function Kx(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function Yx(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function Xx(t,e=[0,0,0]){return e[0]=function(t){return t[0]>=t[3]?0:t[3]-t[0]}(t),e[1]=function(t){return t[1]>=t[4]?0:t[4]-t[1]}(t),e[2]=function(t){return t[2]>=t[5]?0:t[5]-t[2]}(t),e}function tk(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function ek(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function ik(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function sk(t){return t?ik(t,ak):Zx(ak)}function nk(t,e){return t[0]=e[0],t[1]=e[1],t[2]=-1/0,t[3]=e[2],t[4]=e[3],t[5]=1/0,t}function rk(t){return 6===t.length}function ok(t,e,i){if(c(t)||c(e))return t===e;if(!rk(t)||!rk(e))return!1;if(i){for(let s=0;s<t.length;s++)if(!i(t[s],e[s]))return!1}else for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}e([lM({multiply:"multiply",replace:"replace",tint:"tint"})],Jx.prototype,"colorMixMode",void 0),Jx=Hx=e([_r("esri.symbols.support.Symbol3DFillMaterial")],Jx);const ak=[1/0,1/0,1/0,-1/0,-1/0,-1/0],lk=[0,0,0,0,0,0];function uk(t,{isPrimitive:e,width:i,depth:s,height:n}){const r=e?10:1;if(null==i&&null==n&&null==s)return[r*t[0],r*t[1],r*t[2]];const o=Vf(i,s,n);let a;for(let e=0;e<3;e++){const i=o[e];if(null!=i){a=i/t[e];break}}for(let e=0;e<3;e++)null==o[e]&&(o[e]=t[e]*a);return o}const ck=Qx(-.5,-.5,-.5,.5,.5,.5),hk=Qx(-.5,-.5,0,.5,.5,1),dk=Qx(-.5,-.5,0,.5,.5,.5);function fk(t){switch(t){case"sphere":case"cube":case"diamond":return ck;case"cylinder":case"cone":case"inverted-cone":return hk;case"tetrahedron":return dk;default:return}}const pk=["butt","square","round"],yk=[...pk,"none"],mk=["miter","bevel","round"];var gk;let vk=gk=class extends lh{constructor(t){super(t),this.color=new zS([0,0,0,1]),this.size=XS(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:u(this.color)?this.color.clone():null,size:this.size,pattern:u(this.pattern)?this.pattern.clone():null,patternCap:this.patternCap};return new gk(t)}};e([Hn(rx)],vk.prototype,"color",void 0),e([Hn(ox)],vk.prototype,"size",void 0),e([Hn(qx)],vk.prototype,"pattern",void 0),e([Hn({type:pk,json:{default:"butt",write:{overridePolicy(){return{enabled:u(this.pattern)}}}}})],vk.prototype,"patternCap",void 0),vk=gk=e([_r("esri.symbols.support.Symbol3DOutline")],vk);const wk=vk;var bk;let Mk=bk=class extends QS{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const t={edges:u(this.edges)?this.edges.clone():null,enabled:this.enabled,material:u(this.material)?this.material.clone():null,pattern:u(this.pattern)?this.pattern.clone():null,castShadows:this.castShadows,outline:u(this.outline)?this.outline.clone():null};return new bk(t)}static fromSimpleFillSymbol(t){var e,i,s,n,r,o;const a=t.outline&&t.outline.style&&"inside-frame"!==t.outline.style&&"solid"!==t.outline.style?new Nx({style:t.outline.style}):null,l={size:null!=(e=null==(i=t.outline)?void 0:i.width)?e:0,color:(null!=(s=null==(n=t.outline)?void 0:n.color)?s:Bx).clone(),pattern:a};return a&&null!=(r=t.outline)&&r.cap&&(l.patternCap=t.outline.cap),new bk({material:new Jx({color:(null!=(o=t.color)?o:Wx).clone()}),pattern:t.style&&"solid"!==t.style?new Gx({style:t.style}):null,outline:l})}};e([lM({Fill:"fill"},{readOnly:!0})],Mk.prototype,"type",void 0),e([Hn({type:Jx,json:{write:!0}})],Mk.prototype,"material",void 0),e([Hn(Ux)],Mk.prototype,"pattern",void 0),e([Hn({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Mk.prototype,"castShadows",void 0),e([Hn({type:wk,json:{write:!0}})],Mk.prototype,"outline",void 0),e([Hn(px)],Mk.prototype,"edges",void 0),Mk=bk=e([_r("esri.symbols.FillSymbol3DLayer")],Mk);const Sk=Mk;var xk;let kk=xk=class extends lh{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return tx(t)}clone(){return new xk({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};e([Hn({type:["underline","line-through","none"],json:{default:"none",write:!0}})],kk.prototype,"decoration",void 0),e([Hn({type:String,json:{write:!0}})],kk.prototype,"family",void 0),e([Hn({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:!i||!i.textSymbol3D})}}})],kk.prototype,"size",void 0),e([xa("size")],kk.prototype,"castSize",null),e([Hn({type:["normal","italic","oblique"],json:{default:"normal",write:!0}})],kk.prototype,"style",void 0),e([Hn({type:["normal","bold","bolder","lighter"],json:{default:"normal",write:!0}})],kk.prototype,"weight",void 0),kk=xk=e([_r("esri.symbols.Font")],kk);const Ik=kk;function jk(t,e){const i=e&&e.url&&e.url.path;if(t&&i&&(t=Ut(t,i,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const i=qt(t,e.portalItem.itemUrl);Fk.test(i)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(i).path)}return Pk(t,e&&e.portal)}function _k(t,e,i=0){if(!t)return t;!Jt(t)&&e&&e.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let s=Ut(t);if(e){const i=e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.rootPath||e.url&&e.url.path;if(i){const n=Pk(i,e.portal);s=qt(Pk(s,e.portal),n,n),s!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(s)}}return s=function(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?ce(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}(s,e&&e.portal),Jt(s)&&(s=Bt(s)),null!=e&&e.resources&&null!=e&&e.portalItem&&!Jt(s)&&!Qt(s)&&0===i&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(s)}),s}function Tk(t,e,i){return jk(t,i)}function Ok(t,e,i,s){const n=_k(t,s);void 0!==n&&(e[i]=n)}const Ak=/\/items\/([^\/]+)\/resources\//,Fk=/^\.\/resources\//;function Ck(t){const e=u(t)?t.match(Ak):null;return u(e)?e[1]:null}function Pk(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const i=`${e.urlKey}.${e.customBaseUrl}`;return $t(It,`${It.scheme}://${i}`)?ce(t,e.portalHostname,i):ce(t,i,e.portalHostname)}const Ek=Object.freeze({__proto__:null,fromJSON:jk,toJSON:_k,read:Tk,write:Ok,itemIdFromResourceUrl:Ck});var Lk;const Rk=wo()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let Nk=Lk=class extends lh{constructor(t){super(t)}readHref(t,e,i){return t?jk(t,i):e.dataURI}writeHref(t,e,i,s){t&&(Qt(t)?e.dataURI=t:(e.href=_k(t,s),Jt(e.href)&&(e.href=Bt(e.href))))}clone(){return new Lk({href:this.href,primitive:this.primitive})}};e([Hn({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],Nk.prototype,"href",void 0),e([Rh("href")],Nk.prototype,"readHref",null),e([fh("href",{href:{type:String},dataURI:{type:String}})],Nk.prototype,"writeHref",null),e([lM(Rk)],Nk.prototype,"primitive",void 0),Nk=Lk=e([_r("esri.symbols.support.IconSymbol3DLayerResource")],Nk);const Dk="circle",Vk=Nk;var $k;let zk=$k=class extends Ar{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new $k({x:this.x,y:this.y})}};e([Hn({type:Number})],zk.prototype,"x",void 0),e([Hn({type:Number})],zk.prototype,"y",void 0),zk=$k=e([_r("esri.symbols.support.Symbol3DAnchorPosition2D")],zk);const Gk=zk;var Uk;let qk=Uk=class extends lh{constructor(t){super(t),this.color=new zS([0,0,0,1]),this.size=XS(1)}clone(){const t={color:u(this.color)?this.color.clone():null,size:this.size};return new Uk(t)}};e([Hn(rx)],qk.prototype,"color",void 0),e([Hn(ox)],qk.prototype,"size",void 0),qk=Uk=e([_r("esri.symbols.support.Symbol3DIconOutline")],qk);const Bk=qk;var Wk;const Hk=ct.getLogger("esri.symbols.IconSymbol3DLayer");let Jk=Wk=class extends QS{constructor(t){super(t),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=void 0,this.outline=void 0}clone(){return new Wk({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:u(this.material)?this.material.clone():null,outline:u(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(t){const e=t.color||Bx,i=Zk(t),s=t.outline&&t.outline.width>0?{size:t.outline.width,color:(t.outline.color||Bx).clone()}:null;return new Wk({size:t.size,resource:{primitive:Yk(t.style)},material:{color:e},outline:s,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(t){const e=!t.color||function(t){return 0===t.r&&0===t.g&&0===t.b}(t.color)?Bx:t.color,i=Zk(t);return new Wk({size:t.width<=t.height?t.height:t.width,resource:{href:t.url},material:{color:e.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(t){return new Wk({resource:{href:te({mediaType:"application/json",data:JSON.stringify(t.data)})}})}};function Zk(t){const e="width"in t?t.width:t.size,i="height"in t?t.height:t.size,s=Qk(t.xoffset),n=Qk(t.yoffset);return(s||n)&&e&&i?{x:-s/e,y:n/i}:null}function Qk(t){return isFinite(t)?t:0}e([Hn({type:gx,json:{write:!0}})],Jk.prototype,"material",void 0),e([Hn({type:Vk,json:{write:!0}})],Jk.prototype,"resource",void 0),e([lM({Icon:"icon"},{readOnly:!0})],Jk.prototype,"type",void 0),e([Hn(ox)],Jk.prototype,"size",void 0),e([lM({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),Hn({json:{default:"center"}})],Jk.prototype,"anchor",void 0),e([Hn({type:zk,json:{type:[Number],read:{reader:t=>new zk({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],Jk.prototype,"anchorPosition",void 0),e([Hn({type:Bk,json:{write:!0}})],Jk.prototype,"outline",void 0),Jk=Wk=e([_r("esri.symbols.IconSymbol3DLayer")],Jk);const Kk={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function Yk(t){return Kk[t]||(Hk.warn(t+' cannot be mapped to Icon symbol. Fallback to "circle"'),"circle")}const Xk=Jk;var tI;let eI=tI=class extends QS{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=XS(1),this.pattern=null}clone(){const t={enabled:this.enabled,material:u(this.material)?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:u(this.pattern)?this.pattern.clone():null};return new tI(t)}static fromSimpleLineSymbol(t){const e={enabled:!0,size:t.width||1,cap:t.cap||"butt",join:t.join||"miter",pattern:t.style&&"inside-frame"!==t.style?new Nx({style:t.style}):null,material:new mx({color:(t.color||Bx).clone()})};return new tI(e)}};e([Hn({type:mx,json:{write:!0}})],eI.prototype,"material",void 0),e([lM({Line:"line"},{readOnly:!0})],eI.prototype,"type",void 0),e([Hn({type:mk,json:{write:!0,default:"miter"}})],eI.prototype,"join",void 0),e([Hn({type:pk,json:{write:!0,default:"butt"}})],eI.prototype,"cap",void 0),e([Hn(ox)],eI.prototype,"size",void 0),e([Hn(qx)],eI.prototype,"pattern",void 0),eI=tI=e([_r("esri.symbols.LineSymbol3DLayer")],eI);const iI=eI;var sI;const nI=wo()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let rI=sI=class extends lh{clone(){return new sI({href:this.href,primitive:this.primitive})}};e([Hn({type:String,json:{read:Tk,write:Ok}})],rI.prototype,"href",void 0),e([lM(nI)],rI.prototype,"primitive",void 0),rI=sI=e([_r("esri.symbols.support.ObjectSymbol3DLayerResource")],rI);const oI="sphere",aI=rI;var lI;let uI=lI=class extends Ar{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new lI({x:this.x,y:this.y,z:this.z})}};var cI;e([Hn({type:Number})],uI.prototype,"x",void 0),e([Hn({type:Number})],uI.prototype,"y",void 0),e([Hn({type:Number})],uI.prototype,"z",void 0),uI=lI=e([_r("esri.symbols.support.Symbol3DAnchorPosition3D")],uI);let hI=cI=class extends QS{constructor(t){super(t),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new cI({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:u(this.material)?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})}get isPrimitive(){return!this.resource||"string"!=typeof this.resource.href}};e([Hn({type:gx,json:{write:!0}})],hI.prototype,"material",void 0),e([Hn({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],hI.prototype,"castShadows",void 0),e([Hn({type:aI,json:{write:!0}})],hI.prototype,"resource",void 0),e([lM({Object:"object"},{readOnly:!0})],hI.prototype,"type",void 0),e([Hn({type:Number,json:{write:!0}})],hI.prototype,"width",void 0),e([Hn({type:Number,json:{write:!0}})],hI.prototype,"height",void 0),e([Hn({type:Number,json:{write:!0}})],hI.prototype,"depth",void 0),e([lM({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),Hn({json:{default:"origin"}})],hI.prototype,"anchor",void 0),e([Hn({type:uI,json:{type:[Number],read:{reader:t=>new uI({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],hI.prototype,"anchorPosition",void 0),e([Hn({type:Number,json:{write:!0}})],hI.prototype,"heading",void 0),e([Hn({type:Number,json:{write:!0}})],hI.prototype,"tilt",void 0),e([Hn({type:Number,json:{write:!0}})],hI.prototype,"roll",void 0),e([Hn({readOnly:!0})],hI.prototype,"isPrimitive",null),hI=cI=e([_r("esri.symbols.ObjectSymbol3DLayer")],hI);const dI=hI;var fI;let pI=fI=class extends QS{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(t,e){return null!=t?t:null==e.height&&null!=e.size?e.size:void 0}readHeight(t,e){return null!=t?t:null==e.width&&null!=e.size?e.size:void 0}clone(){return new fI({enabled:this.enabled,material:u(this.material)?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};e([Hn({type:gx,json:{write:!0}})],pI.prototype,"material",void 0),e([Hn({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],pI.prototype,"castShadows",void 0),e([lM({Path:"path"},{readOnly:!0})],pI.prototype,"type",void 0),e([Hn({type:["circle","quad"],json:{write:!0,default:"circle"}})],pI.prototype,"profile",void 0),e([Hn({type:mk,json:{write:!0,default:"miter"}})],pI.prototype,"join",void 0),e([Hn({type:yk,json:{write:!0,default:"butt"}})],pI.prototype,"cap",void 0),e([Hn({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],pI.prototype,"width",void 0),e([Rh("width",["width","size","height"])],pI.prototype,"readWidth",null),e([Hn({type:Number,json:{write:!0}})],pI.prototype,"height",void 0),e([Rh("height",["height","size","width"])],pI.prototype,"readHeight",null),e([Hn({type:["center","bottom","top"],json:{write:!0,default:"center"}})],pI.prototype,"anchor",void 0),e([Hn({type:["heading","all"],json:{write:!0,default:"all"}})],pI.prototype,"profileRotation",void 0),pI=fI=e([_r("esri.symbols.PathSymbol3DLayer")],pI);const yI=pI;var mI;let gI=mI=class extends lh{constructor(){super(...arguments),this.color=new zS([0,0,0,1]),this.size=0}clone(){return new mI({color:H(this.color),size:this.size})}};e([Hn(rx)],gI.prototype,"color",void 0),e([Hn(ox)],gI.prototype,"size",void 0),gI=mI=e([_r("esri.symbols.support.Symbol3DHalo")],gI);const vI=gI;var wI;let bI=wI=class extends QS{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.material=null,this.text=void 0,this.type="text"}get font(){return this._get("font")||null}set font(t){t&&this._userSize&&(t.size=this._userSize),this._set("font",t)}writeFont(t,e,i,s){const n={...s,textSymbol3D:!0};e.font=t.write({},n),delete e.font.size}get size(){return null!=this._userSize?this._userSize:this.font&&null!=this.font.size?this.font.size:9}set size(t){this._userSize=t,this.font&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){return new wI({enabled:this.enabled,font:this.font&&H(this.font),halo:this.halo&&H(this.halo),material:u(this.material)?this.material.clone():null,size:this.size,text:this.text})}static fromTextSymbol(t){const e=function(t,e){return t&&e>0?{color:H(t),size:e}:null}(t.haloColor,t.haloSize),i=t.font?t.font.clone():new Ik;return new wI({size:i.size,font:i,halo:e,material:t.color?{color:t.color.clone()}:null,text:t.text})}};e([Hn({type:Ik,json:{write:!0}})],bI.prototype,"font",null),e([fh("font")],bI.prototype,"writeFont",null),e([Hn({type:vI,json:{write:!0}})],bI.prototype,"halo",void 0),e([Hn({type:gx,json:{write:!0}})],bI.prototype,"material",void 0),e([Hn(ox),Hn()],bI.prototype,"size",null),e([Hn({type:String,json:{write:!0}})],bI.prototype,"text",void 0),e([lM({Text:"text"},{readOnly:!0})],bI.prototype,"type",void 0),bI=wI=e([_r("esri.symbols.TextSymbol3DLayer")],bI);const MI=bI;var SI;let xI=SI=class extends QS{constructor(t){super(t),this.color=kI.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new SI({color:H(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};e([Hn({type:zS,nonNullable:!0,json:{type:[Gn],write:(t,e,i)=>e[i]=t.toArray(1),default:()=>kI.clone(),defaultEquals:t=>t.toCss(!0)===kI.toCss(!0)}})],xI.prototype,"color",void 0),e([lM({Water:"water"},{readOnly:!0})],xI.prototype,"type",void 0),e([Hn({type:["small","medium","large"],json:{write:!0,default:"medium"}})],xI.prototype,"waterbodySize",void 0),e([Hn({type:Number,json:{write:!0,default:null}})],xI.prototype,"waveDirection",void 0),e([Hn({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],xI.prototype,"waveStrength",void 0),xI=SI=e([_r("esri.symbols.WaterSymbol3DLayer")],xI);const kI=new zS([0,119,190]),II=xI;var jI;let _I=jI=class extends Ar{constructor(){super(...arguments),this.portal=null}clone(){return new jI({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};e([Hn({type:String})],_I.prototype,"name",void 0),e([Hn({type:String})],_I.prototype,"styleUrl",void 0),e([Hn({type:String})],_I.prototype,"styleName",void 0),e([Hn({type:ef})],_I.prototype,"portal",void 0),_I=jI=e([_r("esri.symbols.support.StyleOrigin")],_I);const TI=_I;var OI;let AI=OI=class extends Ar{clone(){return new OI({url:this.url})}};e([Hn({type:String})],AI.prototype,"url",void 0),AI=OI=e([_r("esri.symbols.support.Thumbnail")],AI);const FI=AI,CI={icon:Xk,object:dI,line:iI,path:yI,fill:Sk,extrude:bx,text:MI,water:II},PI=Jr.ofType({base:QS,key:"type",typeMap:CI,errorContext:"symbol-layer"}),EI=ct.getLogger("esri.symbols.Symbol3D");let LI=class extends BS{constructor(t){super(t),this.styleOrigin=null,this.thumbnail=null,this.type=null;const e=this.__accessor__&&this.__accessor__.metadatas&&this.__accessor__.metadatas.symbolLayers;this._set("symbolLayers",new(e&&e.type||Jr))}get color(){return null}set color(t){EI.error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(t){Wc(t,this._get("symbolLayers"))}readStyleOrigin(t,e,i){if(t.styleUrl&&t.name){const e=jk(t.styleUrl,i);return new TI({styleUrl:e,name:t.name})}if(t.styleName&&t.name)return new TI({portal:i&&i.portal||ef.getDefault(),styleName:t.styleName,name:t.name});i&&i.messages&&i.messages.push(new Qn("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:i,definition:t}))}writeStyleOrigin(t,e,i,s){if(t.styleUrl&&t.name){let i=_k(t.styleUrl,s);Jt(i)&&(i=Bt(i)),e.styleOrigin={styleUrl:i,name:t.name}}else t.styleName&&t.name&&(t.portal&&s&&s.portal&&!Nt(t.portal.restUrl,s.portal.restUrl)?s&&s.messages&&s.messages.push(new Qn("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):e.styleOrigin={styleName:t.styleName,name:t.name})}normalizeCtorArgs(t){return t instanceof QS||t&&CI[t.type]?{symbolLayers:[t]}:Array.isArray(t)?{symbolLayers:t}:t}};e([Hn({json:{read:!1,write:!1}})],LI.prototype,"color",null),e([Hn({type:PI,nonNullable:!0,json:{write:!0}}),xa(Hc)],LI.prototype,"symbolLayers",null),e([Hn({type:TI})],LI.prototype,"styleOrigin",void 0),e([Rh("styleOrigin")],LI.prototype,"readStyleOrigin",null),e([fh("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],LI.prototype,"writeStyleOrigin",null),e([Hn({type:FI,json:{read:!1}})],LI.prototype,"thumbnail",void 0),e([Hn({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],LI.prototype,"type",void 0),LI=e([_r("esri.symbols.Symbol3D")],LI);const RI=LI;let NI=class extends lh{constructor(t){super(t),this.visible=!0}clone(){}};e([Hn({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],NI.prototype,"type",void 0),e([Hn({readOnly:!0})],NI.prototype,"visible",void 0),NI=e([_r("esri.symbols.callouts.Callout3D")],NI);const DI=NI;var VI;let $I=VI=class extends lh{constructor(){super(...arguments),this.color=new zS("white")}clone(){return new VI({color:H(this.color)})}};e([Hn(rx)],$I.prototype,"color",void 0),$I=VI=e([_r("esri.symbols.callouts.LineCallout3DBorder")],$I);const zI=$I;var GI;Object.freeze({__proto__:null,get LineCallout3DBorder(){return $I},default:zI});let UI=GI=class extends DI{constructor(t){super(t),this.type="line",this.color=new zS([0,0,0,1]),this.size=XS(1),this.border=null}get visible(){return this.size>0&&u(this.color)&&this.color.a>0}clone(){return new GI({color:H(this.color),size:this.size,border:H(this.border)})}};function qI(t){if(!t)return!1;const e=t.verticalOffset;return!!e&&!(e.screenLength<=0||e.maxWorldLength<=0)}function BI(t){if(!t)return!1;if(!t.supportsCallout||!t.supportsCallout())return!1;const e=t.callout;return!!e&&!!e.visible&&!!qI(t)}e([lM({line:"line"},{readOnly:!0})],UI.prototype,"type",void 0),e([Hn(rx)],UI.prototype,"color",void 0),e([Hn(ox)],UI.prototype,"size",void 0),e([Hn({type:zI,json:{write:!0}})],UI.prototype,"border",void 0),e([Hn({readOnly:!0})],UI.prototype,"visible",null),UI=GI=e([_r("esri.symbols.callouts.LineCallout3D")],UI);const WI={types:{key:"type",base:DI,typeMap:{line:UI}},json:{write:!0}};var HI;let JI=HI=class extends lh{constructor(){super(...arguments),this.screenLength=0,this.minWorldLength=0}clone(){return new HI({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};e([Hn(ox)],JI.prototype,"screenLength",void 0),e([Hn({type:Number,json:{write:!0,default:0}})],JI.prototype,"minWorldLength",void 0),e([Hn({type:Number,json:{write:!0}})],JI.prototype,"maxWorldLength",void 0),JI=HI=e([_r("esri.symbols.support.Symbol3DVerticalOffset")],JI);const ZI=JI;var QI;const KI=Jr.ofType({base:null,key:"type",typeMap:{text:MI}});let YI=QI=class extends RI{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new KI,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return BI(this)}hasVisibleVerticalOffset(){return qI(this)}clone(){return new QI({styleOrigin:H(this.styleOrigin),symbolLayers:H(this.symbolLayers),thumbnail:H(this.thumbnail),callout:H(this.callout),verticalOffset:H(this.verticalOffset)})}static fromTextSymbol(t){return new QI({symbolLayers:[MI.fromTextSymbol(t)]})}};e([Hn({type:ZI,json:{write:!0}})],YI.prototype,"verticalOffset",void 0),e([Hn(WI)],YI.prototype,"callout",void 0),e([Hn({json:{read:!1,write:!1}})],YI.prototype,"styleOrigin",void 0),e([Hn({type:KI})],YI.prototype,"symbolLayers",void 0),e([lM({LabelSymbol3D:"label-3d"},{readOnly:!0})],YI.prototype,"type",void 0),YI=QI=e([_r("esri.symbols.LabelSymbol3D")],YI);const XI=YI;var tj;const ej=Jr.ofType({base:null,key:"type",typeMap:{line:iI,path:yI}}),ij=Jr.ofType({base:null,key:"type",typeMap:{line:iI,path:yI}});let sj=tj=class extends RI{constructor(t){super(t),this.symbolLayers=new ej,this.type="line-3d"}clone(){return new tj({styleOrigin:H(this.styleOrigin),symbolLayers:H(this.symbolLayers),thumbnail:H(this.thumbnail)})}static fromSimpleLineSymbol(t){return new tj({symbolLayers:[iI.fromSimpleLineSymbol(t)]})}};e([Hn({type:ej,json:{type:ij}})],sj.prototype,"symbolLayers",void 0),e([lM({LineSymbol3D:"line-3d"},{readOnly:!0})],sj.prototype,"type",void 0),sj=tj=e([_r("esri.symbols.LineSymbol3D")],sj);const nj=sj;let rj=class extends BS{constructor(t){super(t),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};e([Hn({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],rj.prototype,"angle",void 0),e([Hn({type:["simple-marker","picture-marker"],readOnly:!0})],rj.prototype,"type",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],rj.prototype,"xoffset",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],rj.prototype,"yoffset",void 0),e([Hn({type:Number,cast:t=>"auto"===t?t:tx(t),json:{write:!0}})],rj.prototype,"size",void 0),rj=e([_r("esri.symbols.MarkerSymbol")],rj);const oj=rj;var aj;const lj=Jr.ofType({base:null,key:"type",typeMap:{fill:Sk}});let uj=aj=class extends RI{constructor(t){super(t),this.symbolLayers=new lj,this.type="mesh-3d"}clone(){return new aj({styleOrigin:H(this.styleOrigin),symbolLayers:H(this.symbolLayers),thumbnail:H(this.thumbnail)})}};e([Hn({type:lj})],uj.prototype,"symbolLayers",void 0),e([lM({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],uj.prototype,"type",void 0),uj=aj=e([_r("esri.symbols.MeshSymbol3D")],uj);const cj=uj;function hj(t,e){return function(t){return t&&("service"===t.origin||"portal-item"===t.origin)&&t.layer&&("feature"===t.layer.type||"stream"===t.layer.type)}(e)&&!Jt(t)&&e.layer.parsedUrl?Wt(e.layer.parsedUrl.path,"images",t):jk(t,e)}const dj={json:{read:{source:["imageData","url"],reader:function(t,e,i){return e.imageData?te({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):hj(e.url,i)}},write:{writer(t,e,i,s){!function(t,e,i,s){if(Qt(t)){const n=Xt(t);e.contentType=n.mediaType,e.imageData=n.data,i&&i.imageData===e.imageData&&i.url&&Ok(i.url,e,"url",s)}else Ok(t,e,"url",s)}(t,e,this.source,s)}}}},fj={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,i){const s={};return e.imageData&&(s.imageData=e.imageData),e.contentType&&(s.contentType=e.contentType),e.url&&(s.url=hj(e.url,i)),s}}}};var pj;let yj=pj=class extends Fx{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,i,s){if(t&&"string"!=typeof t&&null==t.imageData)return t;const n={};return t&&(n.url=t),e&&(n.outline=e),null!=i&&(n.width=tx(i)),null!=s&&(n.height=tx(s)),n}clone(){const t=new pj({color:H(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",H(this.source)),t}hash(){var t;return`${super.hash()}.${null==(t=this.color)?void 0:t.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};e([lM({esriPFS:"picture-fill"},{readOnly:!0})],yj.prototype,"type",void 0),e([Hn(dj)],yj.prototype,"url",void 0),e([Hn({type:Number,json:{write:!0}})],yj.prototype,"xscale",void 0),e([Hn({type:Number,json:{write:!0}})],yj.prototype,"yscale",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],yj.prototype,"width",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],yj.prototype,"height",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],yj.prototype,"xoffset",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],yj.prototype,"yoffset",void 0),e([Hn(fj)],yj.prototype,"source",void 0),yj=pj=e([_r("esri.symbols.PictureFillSymbol")],yj);const mj=yj;var gj;let vj=gj=class extends oj{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t&&null==t.imageData)return t;const s={};return t&&(s.url=t),null!=e&&(s.width=tx(e)),null!=i&&(s.height=tx(i)),s}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new gj({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",H(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};e([Hn({json:{write:!1}})],vj.prototype,"color",void 0),e([lM({esriPMS:"picture-marker"},{readOnly:!0})],vj.prototype,"type",void 0),e([Hn(dj)],vj.prototype,"url",void 0),e([Hn(fj)],vj.prototype,"source",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],vj.prototype,"height",void 0),e([Rh("height",["height","size"])],vj.prototype,"readHeight",null),e([Hn({type:Number,cast:tx,json:{write:!0}})],vj.prototype,"width",void 0),e([Hn({json:{write:!1}})],vj.prototype,"size",void 0),vj=gj=e([_r("esri.symbols.PictureMarkerSymbol")],vj);const wj=vj;var bj;const Mj=Jr.ofType({base:null,key:"type",typeMap:{icon:Xk,object:dI,text:MI}}),Sj=Jr.ofType({base:null,key:"type",typeMap:{icon:Xk,object:dI}});let xj=bj=class extends RI{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new Mj,this.type="point-3d"}writeSymbolLayers(t,e,i,s){const n=t.filter((t=>"text"!==t.type));if(s&&s.messages&&n.length<t.length){const e=t.find((t=>"text"===t.type));s.messages.push(new dt("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PointSymbol3D",{symbolLayer:e}))}e[i]=n.map((t=>t.write({},s))).toArray()}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return BI(this)}hasVisibleVerticalOffset(){return qI(this)}clone(){return new bj({verticalOffset:H(this.verticalOffset),callout:H(this.callout),styleOrigin:H(this.styleOrigin),symbolLayers:H(this.symbolLayers),thumbnail:H(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new bj({symbolLayers:[Xk.fromSimpleMarkerSymbol(t)]})}static fromPictureMarkerSymbol(t){return new bj({symbolLayers:[Xk.fromPictureMarkerSymbol(t)]})}static fromCIMSymbol(t){var e,i;return"CIMPointSymbol"!==(null==(e=t.data)||null==(i=e.symbol)?void 0:i.type)?null:new bj(t.data.symbol.callout?{symbolLayers:[Xk.fromCIMSymbol(t)],callout:{type:"line",size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}}:{symbolLayers:[Xk.fromCIMSymbol(t)]})}static fromTextSymbol(t){return new bj({symbolLayers:[MI.fromTextSymbol(t)]})}};e([Hn({type:ZI,json:{write:!0}})],xj.prototype,"verticalOffset",void 0),e([Hn(WI)],xj.prototype,"callout",void 0),e([Hn({type:Mj,json:{type:Sj,origins:{"web-scene":{type:Sj}}}})],xj.prototype,"symbolLayers",void 0),e([fh("web-scene","symbolLayers")],xj.prototype,"writeSymbolLayers",null),e([lM({PointSymbol3D:"point-3d"},{readOnly:!0})],xj.prototype,"type",void 0),xj=bj=e([_r("esri.symbols.PointSymbol3D")],xj);const kj=xj;var Ij;const jj=Jr.ofType({base:null,key:"type",typeMap:{extrude:bx,fill:Sk,icon:Xk,line:iI,object:dI,text:MI,water:II}}),_j=Jr.ofType({base:null,key:"type",typeMap:{extrude:bx,fill:Sk,icon:Xk,line:iI,object:dI,water:II}});let Tj=Ij=class extends RI{constructor(t){super(t),this.symbolLayers=new jj,this.type="polygon-3d"}writeSymbolLayers(t,e,i,s){const n=t.filter((t=>"text"!==t.type));if(s&&s.messages&&n.length<t.length){const e=t.find((t=>"text"===t.type));s.messages.push(new dt("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PolygonSymbol3D",{symbolLayer:e}))}e[i]=n.map((t=>t.write({},s))).toArray()}clone(){return new Ij({styleOrigin:H(this.styleOrigin),symbolLayers:H(this.symbolLayers),thumbnail:H(this.thumbnail)})}static fromJSON(t){const e=new Ij;if(e.read(t),2===e.symbolLayers.length&&"fill"===e.symbolLayers.getItemAt(0).type&&"line"===e.symbolLayers.getItemAt(1).type){const i=e.symbolLayers.getItemAt(0),s=e.symbolLayers.getItemAt(1);!s.enabled||t.symbolLayers&&t.symbolLayers[1]&&!1===t.symbolLayers[1].enable||(i.outline={size:s.size,color:u(s.material)?s.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new Ij({symbolLayers:[Sk.fromSimpleFillSymbol(t)]})}};e([Hn({type:jj,json:{type:_j}})],Tj.prototype,"symbolLayers",void 0),e([fh("web-scene","symbolLayers")],Tj.prototype,"writeSymbolLayers",null),e([lM({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],Tj.prototype,"type",void 0),Tj=Ij=e([_r("esri.symbols.PolygonSymbol3D")],Tj);const Oj=Tj;var Aj;const Fj=new vo({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let Cj=Aj=class extends Fx{constructor(...t){super(...t),this.color=new zS([0,0,0,.25]),this.outline=new Ox,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t)return t;const s={};return t&&(s.style=t),e&&(s.outline=e),i&&(s.color=i),s}clone(){return new Aj({color:H(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};e([Hn()],Cj.prototype,"color",void 0),e([Hn()],Cj.prototype,"outline",void 0),e([lM({esriSFS:"simple-fill"},{readOnly:!0})],Cj.prototype,"type",void 0),e([Hn({type:Fj.apiValues,json:{read:Fj.read,write:Fj.write}})],Cj.prototype,"style",void 0),Cj=Aj=e([_r("esri.symbols.SimpleFillSymbol")],Cj);const Pj=Cj;var Ej;const Lj=new vo({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Rj=Ej=class extends oj{constructor(...t){super(...t),this.color=new zS([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new Ox}normalizeCtorArgs(t,e,i,s){if(t&&"string"!=typeof t)return t;const n={};return t&&(n.style=t),null!=e&&(n.size=tx(e)),i&&(n.outline=i),s&&(n.color=s),n}writeColor(t,e){t&&"x"!==this.style&&"cross"!==this.style&&(e.color=t.toJSON()),null===t&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new Ej({angle:this.angle,color:H(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${null==(t=this.outline)?void 0:t.hash()}`}};e([Hn()],Rj.prototype,"color",void 0),e([fh("color")],Rj.prototype,"writeColor",null),e([lM({esriSMS:"simple-marker"},{readOnly:!0})],Rj.prototype,"type",void 0),e([Hn()],Rj.prototype,"size",void 0),e([Hn({type:Lj.apiValues,json:{read:Lj.read,write:Lj.write}})],Rj.prototype,"style",void 0),e([Hn({type:String,json:{write:!0}})],Rj.prototype,"path",null),e([Hn({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":Ox}},json:{default:null,write:!0}})],Rj.prototype,"outline",void 0),Rj=Ej=e([_r("esri.symbols.SimpleMarkerSymbol")],Rj);const Nj=Rj;var Dj;let Vj=Dj=class extends BS{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new Ik,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment=null,this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t)return t;const s={};return t&&(s.text=t),e&&(s.font=e),i&&(s.color=i),s}writeLineWidth(t,e,i,s){s&&"string"!=typeof s||(e[i]=t)}castLineWidth(t){return tx(t)}writeLineHeight(t,e,i,s){s&&"string"!=typeof s||(e[i]=t)}clone(){return new Dj({angle:this.angle,backgroundColor:H(this.backgroundColor),borderLineColor:H(this.borderLineColor),borderLineSize:this.borderLineSize,color:H(this.color),font:this.font&&this.font.clone(),haloColor:H(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor&&this.backgroundColor.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color.hash()}.${this.font&&this.font.hash()}.${this.haloColor&&this.haloColor.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};e([Hn({type:zS,json:{write:!0}})],Vj.prototype,"backgroundColor",void 0),e([Hn({type:zS,json:{write:!0}})],Vj.prototype,"borderLineColor",void 0),e([Hn({type:Number,json:{write:!0}})],Vj.prototype,"borderLineSize",void 0),e([Hn({type:Ik,json:{write:!0}})],Vj.prototype,"font",void 0),e([Hn({type:["left","right","center","justify"],json:{write:!0}})],Vj.prototype,"horizontalAlignment",void 0),e([Hn({type:Boolean,json:{write:!0}})],Vj.prototype,"kerning",void 0),e([Hn({type:zS,json:{write:!0}})],Vj.prototype,"haloColor",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],Vj.prototype,"haloSize",void 0),e([Hn({type:Boolean,json:{write:!0}})],Vj.prototype,"rightToLeft",void 0),e([Hn({type:Boolean,json:{write:!0}})],Vj.prototype,"rotated",void 0),e([Hn({type:String,json:{write:!0}})],Vj.prototype,"text",void 0),e([lM({esriTS:"text"},{readOnly:!0})],Vj.prototype,"type",void 0),e([Hn({type:["baseline","top","middle","bottom"],json:{write:!0}})],Vj.prototype,"verticalAlignment",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],Vj.prototype,"xoffset",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],Vj.prototype,"yoffset",void 0),e([Hn({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Vj.prototype,"angle",void 0),e([Hn({type:Number,json:{write:!0}})],Vj.prototype,"width",void 0),e([Hn({type:Number})],Vj.prototype,"lineWidth",void 0),e([fh("lineWidth")],Vj.prototype,"writeLineWidth",null),e([xa("lineWidth")],Vj.prototype,"castLineWidth",null),e([Hn({type:Number})],Vj.prototype,"lineHeight",void 0),e([fh("lineHeight")],Vj.prototype,"writeLineHeight",null),Vj=Dj=e([_r("esri.symbols.TextSymbol")],Vj);const $j=Vj;var zj;const Gj=ct.getLogger("esri.symbols.WebStyleSymbol");let Uj=zj=class extends BS{constructor(t){super(t),this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}read(t,e){this.portal=e?e.portal:void 0,super.read(t,e)}clone(){return new zj({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol("webRef",t)}fetchCIMSymbol(t){return this._fetchSymbol("cimRef",t)}async _fetchSymbol(t,e){const i=await import("./p-94382dd8.js");Ee(e);const s=i.resolveWebStyleSymbol(this,{portal:this.portal},t,e);return s.catch((t=>{Gj.error("#fetchSymbol()","Failed to create symbol from style",t)})),s}};e([Hn({json:{write:!1}})],Uj.prototype,"color",void 0),e([Hn({type:String,json:{write:!0}})],Uj.prototype,"styleName",void 0),e([Hn({type:ef,json:{write:!1}})],Uj.prototype,"portal",void 0),e([Hn({type:String,json:{read:Tk,write:Ok}})],Uj.prototype,"styleUrl",void 0),e([Hn({type:FI,json:{read:!1}})],Uj.prototype,"thumbnail",void 0),e([Hn({type:String,json:{write:!0}})],Uj.prototype,"name",void 0),e([lM({styleSymbolReference:"web-style"},{readOnly:!0})],Uj.prototype,"type",void 0),Uj=zj=e([_r("esri.symbols.WebStyleSymbol")],Uj);const qj=Uj;function Bj(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function Wj(t){if(!t)return!1;switch(t.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const Hj={base:BS,key:"type",typeMap:{"simple-fill":Pj,"picture-fill":mj,"picture-marker":wj,"simple-line":Ox,"simple-marker":Nj,text:$j,"label-3d":XI,"line-3d":nj,"mesh-3d":cj,"point-3d":kj,"polygon-3d":Oj,"web-style":qj,cim:JS},errorContext:"symbol"},Jj={base:BS,key:"type",typeMap:{"picture-marker":wj,"simple-marker":Nj,text:$j,"web-style":qj,cim:JS},errorContext:"symbol"},Zj=tr({types:Hj}),Qj={base:BS,key:"type",typeMap:{"simple-fill":Pj,"picture-fill":mj,"picture-marker":wj,"simple-line":Ox,"simple-marker":Nj,text:$j,"line-3d":nj,"mesh-3d":cj,"point-3d":kj,"polygon-3d":Oj,"web-style":qj,cim:JS},errorContext:"symbol"},Kj={base:BS,key:"type",typeMap:{text:$j,"label-3d":XI},errorContext:"symbol"},Yj={base:BS,key:"type",typeMap:{"line-3d":nj,"mesh-3d":cj,"point-3d":kj,"polygon-3d":Oj,"web-style":qj,cim:JS},errorContext:"symbol"},Xj={base:BS,key:"type",typeMap:{"label-3d":XI},errorContext:"symbol"},t_=zn(Hj);var e_;let i_=e_=class extends lh{constructor(...t){super(...t),this.isAggregate=!1,this.layer=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:Xs(),configurable:!0})}normalizeCtorArgs(t,e,i,s){return t&&!t.declaredClass?t:{geometry:t,symbol:e,attributes:i,popupTemplate:s}}set attributes(t){const e=this._get("attributes");e!==t&&(this._set("attributes",t),this._notifyLayer("attributes",e,t))}set geometry(t){const e=this._get("geometry");e!==t&&(this._set("geometry",t),this._notifyLayer("geometry",e,t))}set symbol(t){const e=this._get("symbol");e!==t&&(this._set("symbol",t),this._notifyLayer("symbol",e,t))}set visible(t){const e=this._get("visible");e!==t&&(this._set("visible",t),this._notifyLayer("visible",e,t))}getEffectivePopupTemplate(t=!1){if(this.popupTemplate)return this.popupTemplate;for(const e of[this.sourceLayer,this.layer])if(e){if("popupTemplate"in e&&e.popupTemplate)return e.popupTemplate;if(t&&"defaultPopupTemplate"in e&&u(e.defaultPopupTemplate))return e.defaultPopupTemplate}return null}getAttribute(t){return this.attributes&&this.attributes[t]}setAttribute(t,e){if(this.attributes){const i=this.getAttribute(t);this.attributes[t]=e,this._notifyLayer("attributes",i,e,t)}else this.attributes={[t]:e},this._notifyLayer("attributes",void 0,e,t)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{geometry:u(this.geometry)?this.geometry.toJSON():null,symbol:u(this.symbol)?this.symbol.toJSON():null,attributes:{...this.attributes},popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}clone(){return new e_(this.cloneProperties())}notifyGeometryChanged(){this._notifyLayer("geometry",this.geometry,this.geometry)}cloneProperties(){return{attributes:H(this.attributes),geometry:H(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),sourceLayer:this.sourceLayer,symbol:H(this.symbol),visible:this.visible}}_notifyLayer(t,e,i,s){if(!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:t,oldValue:e,newValue:i};"attributes"===t&&(n.attributeName=s),this.layer.graphicChanged(n)}};e([Hn({value:null})],i_.prototype,"attributes",null),e([Hn({value:null,types:tb,json:{read:Qw}})],i_.prototype,"geometry",null),e([Hn({type:Boolean})],i_.prototype,"isAggregate",void 0),e([Hn()],i_.prototype,"layer",void 0),e([Hn({type:PS})],i_.prototype,"popupTemplate",void 0),e([Hn()],i_.prototype,"sourceLayer",void 0),e([Hn({value:null,types:Hj})],i_.prototype,"symbol",null),e([Hn({type:Boolean,value:!0})],i_.prototype,"visible",null),i_=e_=e([_r("esri.Graphic")],i_),(i_||(i_={})).generateUID=Xs;const s_=i_;function n_(t){return t&&"function"==typeof t.highlight}var r_;let o_=r_=class extends lh{constructor(t){super(t),this.name=null,this.code=null}clone(){return new r_({name:this.name,code:this.code})}};e([Hn({type:String,json:{write:!0}})],o_.prototype,"name",void 0),e([Hn({type:[String,Number],json:{write:!0}})],o_.prototype,"code",void 0),o_=r_=e([_r("esri.layers.support.CodedValue")],o_);const a_=o_,l_=new vo({inherited:"inherited",codedValue:"coded-value",range:"range"});let u_=class extends lh{constructor(t){super(t),this.name=null,this.type=null}};e([Hn({type:String,json:{write:!0}})],u_.prototype,"name",void 0),e([lM(l_)],u_.prototype,"type",void 0),u_=e([_r("esri.layers.support.Domain")],u_);const c_=u_;var h_;let d_=h_=class extends c_{constructor(t){super(t),this.codedValues=null,this.type="coded-value"}getName(t){let e=null;if(this.codedValues){const i=t+"";this.codedValues.some((t=>(t.code+""===i&&(e=t.name),!!e)))}return e}clone(){return new h_({codedValues:H(this.codedValues),name:this.name})}};e([Hn({type:[a_],json:{write:!0}})],d_.prototype,"codedValues",void 0),e([lM({codedValue:"coded-value"})],d_.prototype,"type",void 0),d_=h_=e([_r("esri.layers.support.CodedValueDomain")],d_);const f_=d_;var p_;let y_=p_=class extends c_{constructor(t){super(t),this.type="inherited"}clone(){return new p_}};e([lM({inherited:"inherited"})],y_.prototype,"type",void 0),y_=p_=e([_r("esri.layers.support.InheritedDomain")],y_);const m_=y_;var g_;let v_=g_=class extends c_{constructor(t){super(t),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new g_({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};e([Hn({type:Number,json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range&&e.range[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(t,e,i){e[i]=[this.minValue||0,t]}}}})],v_.prototype,"maxValue",void 0),e([Hn({type:Number,json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range&&e.range[0]},write:{target:"range",writer(t,e,i){e[i]=[t,this.maxValue||0]}}}})],v_.prototype,"minValue",void 0),e([lM({range:"range"})],v_.prototype,"type",void 0),v_=g_=e([_r("esri.layers.support.RangeDomain")],v_);const w_=v_;var b_;let M_=b_=class extends lh{constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new b_(H({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};e([Hn({type:[String],json:{write:!0}})],M_.prototype,"attachmentTypes",void 0),e([Hn({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],M_.prototype,"attachmentsWhere",void 0),e([Hn({type:[String],json:{write:!0}})],M_.prototype,"keywords",void 0),e([Hn({type:[Number],json:{write:!0}})],M_.prototype,"globalIds",void 0),e([Hn({json:{write:!0}})],M_.prototype,"name",void 0),e([Hn({type:Number,json:{read:{source:"resultRecordCount"}}})],M_.prototype,"num",void 0),e([Hn({type:[Number],json:{write:!0}})],M_.prototype,"objectIds",void 0),e([Hn({type:Boolean,json:{default:!1,write:!0}})],M_.prototype,"returnMetadata",void 0),e([Hn({type:[Number],json:{write:!0}})],M_.prototype,"size",void 0),e([Hn({type:Number,json:{read:{source:"resultOffset"}}})],M_.prototype,"start",void 0),e([fh("start"),fh("num")],M_.prototype,"writeStart",null),e([Hn({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],M_.prototype,"where",void 0),M_=b_=e([_r("esri.rest.support.AttachmentQuery")],M_),M_.from=Ln(M_);const S_=M_;var x_;let k_=x_=class extends lh{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new x_({minValue:this.minValue,maxValue:this.maxValue})}};e([Hn({type:Number,json:{write:!0}})],k_.prototype,"minValue",void 0),e([Hn({type:Number,json:{write:!0}})],k_.prototype,"maxValue",void 0),k_=x_=e([_r("esri.renderer.support.AuthoringInfoClassBreakInfo")],k_);const I_=k_;var j_;let __=j_=class extends lh{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[]}clone(){return new j_({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:H(this.classBreakInfos)})}};e([Hn({type:String,json:{write:!0}})],__.prototype,"field",void 0),e([Hn({type:String,json:{write:!0}})],__.prototype,"normalizationField",void 0),e([Hn({type:String,json:{write:!0}})],__.prototype,"label",void 0),e([Hn({type:[I_],json:{write:!0}})],__.prototype,"classBreakInfos",void 0),__=j_=e([_r("esri.renderers.support.AuthoringInfoFieldInfo")],__);const T_=__;var O_;const A_=new vo({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),F_=new vo({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),C_={key:t=>"number"==typeof t?"number":"string",typeMap:{number:Number,string:String},base:null},P_=["high-to-low","above-and-below","centered-on","extremes"],E_=[...new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below","high-to-low","above-and-below","90-10","above","below"])],L_=["seconds","minutes","hours","days","months","years"];let R_=O_=class extends lh{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return"string"==typeof t||"number"==typeof t?t:null}castStartTime(t){return"string"==typeof t||"number"==typeof t?t:null}get style(){return"color"===this.type?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return"color"===this.type||"size"===this.type?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new O_({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};e([Hn({types:C_,json:{write:!0}})],R_.prototype,"endTime",void 0),e([xa("endTime")],R_.prototype,"castEndTime",null),e([Hn({type:String,json:{write:!0}})],R_.prototype,"field",void 0),e([Hn({type:Number,json:{write:!0}})],R_.prototype,"maxSliderValue",void 0),e([Hn({type:Number,json:{write:!0}})],R_.prototype,"minSliderValue",void 0),e([Hn({types:C_,json:{write:!0}})],R_.prototype,"startTime",void 0),e([xa("startTime")],R_.prototype,"castStartTime",null),e([Hn({type:A_.apiValues,value:null,json:{type:A_.jsonValues,read:A_.read,write:A_.write}})],R_.prototype,"style",null),e([Hn({type:E_,value:null,json:{type:E_,origins:{"web-scene":{type:P_,write:{writer:(t,e)=>{P_.indexOf(t)>-1&&(e.theme=t)}}}},write:!0}})],R_.prototype,"theme",null),e([Hn({type:F_.apiValues,json:{type:F_.jsonValues,read:F_.read,write:F_.write}})],R_.prototype,"type",void 0),e([Hn({type:L_,json:{type:L_,write:!0}})],R_.prototype,"units",void 0),R_=O_=e([_r("esri.renderers.support.AuthoringInfoVisualVariable")],R_);const N_=R_;let D_=class extends lh{constructor(t){super(t),this.type=null}};e([Hn({readOnly:!0,json:{read:!1,write:!0}})],D_.prototype,"type",void 0),D_=e([_r("esri.rest.support.ColorRamp")],D_);const V_=D_;var $_;let z_=$_=class extends V_{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new $_({fromColor:H(this.fromColor),toColor:H(this.toColor),algorithm:this.algorithm})}};e([lM({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],z_.prototype,"algorithm",void 0),e([Hn({type:zS,json:{type:[Gn],write:!0}})],z_.prototype,"fromColor",void 0),e([Hn({type:zS,json:{type:[Gn],write:!0}})],z_.prototype,"toColor",void 0),e([Hn({type:["algorithmic"]})],z_.prototype,"type",void 0),z_=$_=e([_r("esri.rest.support.AlgorithmicColorRamp")],z_);const G_=z_;var U_;let q_=U_=class extends V_{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new U_({colorRamps:H(this.colorRamps)})}};e([Hn({type:[G_],json:{write:!0}})],q_.prototype,"colorRamps",void 0),e([Hn({type:["multipart"]})],q_.prototype,"type",void 0),q_=U_=e([_r("esri.rest.support.MultipartColorRamp")],q_);const B_=q_,W_={key:"type",base:V_,typeMap:{algorithmic:G_,multipart:B_}};function H_(t){return t&&t.type?"algorithmic"===t.type?G_.fromJSON(t):"multipart"===t.type?B_.fromJSON(t):null:null}var J_;const Z_=new vo({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),Q_=new vo({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),K_=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"];let Y_=J_=class extends lh{constructor(t){super(t),this.colorRamp=null,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&"relationship"!==e?"class-breaks-size"===e||"class-breaks-color"===e?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){if(t)return H_(t)}get fields(){return this.type&&"predominance"!==this.type?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&"relationship"!==this.type?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&"relationship"!==this.type?null:this._get("field2")}set field2(t){this._set("field2",t)}get focus(){return this.type&&"relationship"!==this.type?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&"relationship"!==t&&"class-breaks-size"!==t&&"class-breaks-color"!==t||this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;"classed-size"===t?e="class-breaks-size":"classed-color"===t&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return"univariate-color-size"===this.type?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){return new J_({classificationMethod:this.classificationMethod,colorRamp:H(this.colorRamp),fields:this.fields&&this.fields.slice(0),field1:H(this.field1),field2:H(this.field2),focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((t=>t.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme})}};e([Hn({type:Z_.apiValues,value:null,json:{type:Z_.jsonValues,read:Z_.read,write:Z_.write,origins:{"web-document":{default:"manual",type:Z_.jsonValues,read:Z_.read,write:Z_.write}}}})],Y_.prototype,"classificationMethod",null),e([Hn({types:W_,json:{write:!0}})],Y_.prototype,"colorRamp",void 0),e([Rh("colorRamp")],Y_.prototype,"readColorRamp",null),e([Hn({type:[String],value:null,json:{write:!0}})],Y_.prototype,"fields",null),e([Hn({type:T_,value:null,json:{write:!0}})],Y_.prototype,"field1",null),e([Hn({type:T_,value:null,json:{write:!0}})],Y_.prototype,"field2",null),e([Hn({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],Y_.prototype,"focus",null),e([Hn({type:Number,value:null,json:{type:Gn,write:!0}})],Y_.prototype,"numClasses",null),e([Hn({type:K_,json:{type:K_,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],Y_.prototype,"lengthUnit",void 0),e([Hn({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Y_.prototype,"maxSliderValue",void 0),e([Hn({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Y_.prototype,"minSliderValue",void 0),e([Hn({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Y_.prototype,"statistics",null),e([Hn({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],Y_.prototype,"standardDeviationInterval",null),e([Hn({type:Q_.apiValues,value:null,json:{type:Q_.jsonValues,read:Q_.read,write:Q_.write}})],Y_.prototype,"type",null),e([Hn({type:[N_],json:{write:!0}})],Y_.prototype,"visualVariables",void 0),e([Hn({type:["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Y_.prototype,"univariateSymbolStyle",null),e([Hn({type:["high-to-low","above-and-below","above","below","90-10"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Y_.prototype,"univariateTheme",null),Y_=J_=e([_r("esri.renderers.support.AuthoringInfo")],Y_);const X_=Y_,tT=new vo({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary"},{ignoreUnknown:!0});let eT=class extends lh{constructor(t){super(t),this.authoringInfo=null,this.type=null}async getRequiredFields(t){if(!this.collectRequiredFields)return[];const e=new Set;return await this.collectRequiredFields(e,t),Array.from(e).sort()}getSymbol(t,e){}async getSymbolAsync(t,e){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};e([Hn({type:X_,json:{write:!0}})],eT.prototype,"authoringInfo",void 0),e([Hn({type:tT.apiValues,readOnly:!0,json:{type:tT.jsonValues,read:!1,write:{writer:tT.write,ignoreOrigin:!0}}})],eT.prototype,"type",void 0),eT=e([_r("esri.renderers.Renderer")],eT);const iT=eT;var sT;let nT=sT=class extends lh{constructor(){super(...arguments),this.title=null}clone(){return new sT({title:this.title})}};e([Hn({type:String,json:{write:!0}})],nT.prototype,"title",void 0),nT=sT=e([_r("esri.renderers.support.LegendOptions")],nT);const rT=nT;var oT;let aT=oT=class extends rT{constructor(){super(...arguments),this.showLegend=null}clone(){return new oT({title:this.title,showLegend:this.showLegend})}};e([Hn({type:Boolean,json:{write:!0}})],aT.prototype,"showLegend",void 0),aT=oT=e([_r("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],aT);const lT=aT,uT=ct.getLogger("esri.renderers.visualVariables.VisualVariable"),cT=new vo({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let hT=class extends lh{constructor(t){super(t),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(t){return null==t?t:"function"==typeof t?(uT.error(".field: field must be a string value"),null):xn(t)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};e([Hn()],hT.prototype,"index",void 0),e([Hn({type:cT.apiValues,readOnly:!0,json:{read:cT.read,write:cT.write}})],hT.prototype,"type",void 0),e([Hn({type:String,json:{write:!0}})],hT.prototype,"field",void 0),e([xa("field")],hT.prototype,"castField",null),e([Hn({type:String,json:{write:!0}})],hT.prototype,"valueExpression",void 0),e([Hn({type:String,json:{write:!0}})],hT.prototype,"valueExpressionTitle",void 0),e([Hn({readOnly:!0})],hT.prototype,"arcadeRequired",null),e([Hn({type:lT,json:{write:!0}})],hT.prototype,"legendOptions",void 0),hT=e([_r("esri.renderers.visualVariables.VisualVariable")],hT);const dT=hT;var fT;let pT=fT=class extends lh{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,i){e[i]=null==t?0:t}clone(){return new fT({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};e([Hn({type:zS,json:{type:[Gn],write:!0}})],pT.prototype,"color",void 0),e([Hn({type:String,json:{write:!0}})],pT.prototype,"label",void 0),e([Hn({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],pT.prototype,"value",void 0),e([fh("value")],pT.prototype,"writeValue",null),pT=fT=e([_r("esri.renderers.visualVariables.support.ColorStop")],pT);const yT=pT;var mT;let gT=mT=class extends dT{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)),this._set("stops",t)}clone(){return new mT({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};e([Hn({readOnly:!0})],gT.prototype,"cache",null),e([Hn({type:["color"],json:{type:["colorInfo"]}})],gT.prototype,"type",void 0),e([Hn({type:String,json:{write:!0}})],gT.prototype,"normalizationField",void 0),e([Hn({type:[yT],json:{write:!0}})],gT.prototype,"stops",null),gT=mT=e([_r("esri.renderers.visualVariables.ColorVariable")],gT);const vT=gT;var wT;let bT=wT=class extends lh{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return nx(e.transparency)}writeOpacity(t,e,i){e[i]=sx(t)}clone(){return new wT({label:this.label,opacity:this.opacity,value:this.value})}};e([Hn({type:String,json:{write:!0}})],bT.prototype,"label",void 0),e([Hn({type:Number,json:{type:Gn,write:{target:"transparency"}}})],bT.prototype,"opacity",void 0),e([Rh("opacity",["transparency"])],bT.prototype,"readOpacity",null),e([fh("opacity")],bT.prototype,"writeOpacity",null),e([Hn({type:Number,json:{write:!0}})],bT.prototype,"value",void 0),bT=wT=e([_r("esri.renderers.visualVariables.support.OpacityStop")],bT);const MT=bT;var ST;let xT=ST=class extends dT{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)),this._set("stops",t)}clone(){return new ST({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};e([Hn({readOnly:!0})],xT.prototype,"cache",null),e([Hn({type:["opacity"],json:{type:["transparencyInfo"]}})],xT.prototype,"type",void 0),e([Hn({type:String,json:{write:!0}})],xT.prototype,"normalizationField",void 0),e([Hn({type:[MT],json:{write:!0}})],xT.prototype,"stops",null),xT=ST=e([_r("esri.renderers.visualVariables.OpacityVariable")],xT);const kT=xT;var IT;let jT=IT=class extends dT{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(t,e,i,s){s&&s.messages&&s.messages.push(new dt("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:`visualVariables[${this.index}].valueExpressionTitle`,context:s}))}clone(){return new IT({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})}};e([Hn({readOnly:!0})],jT.prototype,"cache",null),e([Hn({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],jT.prototype,"axis",void 0),e([Hn({type:["rotation"],json:{type:["rotationInfo"]}})],jT.prototype,"type",void 0),e([Hn({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],jT.prototype,"rotationType",void 0),e([Hn({type:String,json:{write:!0}})],jT.prototype,"valueExpressionTitle",void 0),e([fh("web-scene","valueExpressionTitle")],jT.prototype,"writeValueExpressionTitleWebScene",null),jT=IT=e([_r("esri.renderers.visualVariables.RotationVariable")],jT);const _T=jT;var TT;let OT=TT=class extends lh{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new TT({label:this.label,size:this.size,value:this.value})}};e([Hn({type:String,json:{write:!0}})],OT.prototype,"label",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],OT.prototype,"size",void 0),e([Hn({type:Number,json:{write:!0}})],OT.prototype,"value",void 0),OT=TT=e([_r("esri.renderers.visualVariables.support.SizeStop")],OT);const AT=OT;var FT;let CT=FT=class extends lT{constructor(){super(...arguments),this.customValues=null}clone(){return new FT({title:this.title,showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})}};e([Hn({type:[Number],json:{write:!0}})],CT.prototype,"customValues",void 0),CT=FT=e([_r("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],CT);const PT=CT;function ET(t){return t&&"esri.renderers.visualVariables.SizeVariable"===t.declaredClass}function LT(t){return null!=t&&!isNaN(t)&&isFinite(t)}function RT(t){return t.valueExpression?"expression":t.field&&"string"==typeof t.field?"field":"unknown"}function NT(){}const DT={inches:Pm(1,"meters","inches"),feet:Pm(1,"meters","feet"),"us-feet":Pm(1,"meters","us-feet"),yards:Pm(1,"meters","yards"),miles:Pm(1,"meters","miles"),"nautical-miles":Pm(1,"meters","nautical-miles"),millimeters:Pm(1,"meters","millimeters"),centimeters:Pm(1,"meters","centimeters"),decimeters:Pm(1,"meters","decimeters"),meters:Pm(1,"meters","meters"),kilometers:Pm(1,"meters","kilometers"),"decimal-degrees":1/function(t,e,i){return Pm(1,"meters","meters")/(i*Math.PI/180)}(0,0,$h.radius)},VT=ct.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),$T=new s_,zT=Math.PI,GT=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function UT(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.filter((t=>"color"===t.type))[0]:t;if(!s)return;if("esri.renderers.visualVariables.ColorVariable"!==s.declaredClass)return void VT.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const n="number"==typeof e,r=n?null:e,o=r&&r.attributes;let a=n?e:null;const l=s.field,{ipData:c,hasExpression:h}=s.cache;let d=s.cache.compiledFunc;if(!l&&!h){const t=s.stops;return t&&t[0]&&t[0].color}if("number"!=typeof a)if(h){if(!u(i)||!u(i.arcade))return void VT.error("Use of arcade expressions requires an arcade context");const t=i.arcade.arcadeUtils,e=t.getViewInfo({viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}),n=t.createExecContext(r,e);if(!d){const e=t.createSyntaxTree(s.valueExpression);d=t.createFunction(e),s.cache.compiledFunc=d}a=t.executeFunction(d,n)}else o&&(a=o[l]);const f=s.normalizationField,p=o?parseFloat(o[f]):void 0;if(null!=a&&(!f||n||!isNaN(p)&&0!==p)){isNaN(p)||n||(a/=p);const t=KT(a,c);if(t){const e=t[0],n=t[1],r=e===n?s.stops[e].color:zS.blendColors(s.stops[e].color,s.stops[n].color,t[2],u(i)?i.color:void 0);return new zS(r)}}}function qT(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.filter((t=>"opacity"===t.type))[0]:t;if(!s)return;if("esri.renderers.visualVariables.OpacityVariable"!==s.declaredClass)return void VT.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const n="number"==typeof e,r=n?null:e,o=r&&r.attributes;let a=n?e:null;const l=s.field,{ipData:u,hasExpression:h}=s.cache;let d=s.cache.compiledFunc;if(!l&&!h){const t=s.stops;return t&&t[0]&&t[0].opacity}if("number"!=typeof a)if(h){if(c(i)||c(i.arcade))return void VT.error("Use of arcade expressions requires an arcade context");const t=i.arcade.arcadeUtils,e=t.getViewInfo({viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}),n=t.createExecContext(r,e);if(!d){const e=t.createSyntaxTree(s.valueExpression);d=t.createFunction(e),s.cache.compiledFunc=d}a=t.executeFunction(d,n)}else o&&(a=o[l]);const f=s.normalizationField,p=o?parseFloat(o[f]):void 0;if(null!=a&&(!f||n||!isNaN(p)&&0!==p)){isNaN(p)||n||(a/=p);const t=KT(a,u);if(t){const e=t[0],i=t[1];if(e===i)return s.stops[e].opacity;{const n=s.stops[e].opacity;return n+(s.stops[i].opacity-n)*t[2]}}}}function BT(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.filter((t=>"rotation"===t.type))[0]:t;if(!s)return;if("esri.renderers.visualVariables.RotationVariable"!==s.declaredClass)return void VT.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const n=s.axis||"heading",r="heading"===n&&"arithmetic"===s.rotationType?90:0,o="heading"===n&&"arithmetic"===s.rotationType?-1:1,a="number"==typeof e?null:e,l=a&&a.attributes,u=s.field,{hasExpression:h}=s.cache;let d=s.cache.compiledFunc,f=0;if(!u&&!h)return f;if(h){if(c(i)||c(i.arcade))return void VT.error("Use of arcade expressions requires an arcade context");const t=i.arcade.arcadeUtils,e=t.getViewInfo({viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}),n=t.createExecContext(a,e);if(!d){const e=t.createSyntaxTree(s.valueExpression);d=t.createFunction(e),s.cache.compiledFunc=d}f=t.executeFunction(d,n)}else l&&(f=l[u]||0);return f="number"!=typeof f||isNaN(f)?null:r+o*f,f}function WT(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.filter((t=>"size"===t.type))[0]:t;if(!s)return;if("esri.renderers.visualVariables.SizeVariable"!==s.declaredClass)return void VT.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const n=ZT(function(t,e,i){const s="number"==typeof e,n=s?null:e,r=n&&n.attributes;let o=s?e:null;const{isScaleDriven:a}=t.cache;let l=t.cache.compiledFunc;if(a){const e=u(i)?i.scale:void 0,s=u(i)?i.view:void 0;o=null==e||"3d"===s?function(t){let e=null,i=null;const s=t.stops;return s?(e=s[0].value,i=s[s.length-1].value):(e=t.minDataValue||0,i=t.maxDataValue||0),(e+i)/2}(t):e}else if(!s)switch(t.inputValueType){case"expression":{if(c(i)||c(i.arcade))return void VT.error("Use of arcade expressions requires an arcade context");const e=i.arcade.arcadeUtils,s=e.getViewInfo({viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}),r=e.createExecContext(n,s);if(!l){const i=e.createSyntaxTree(t.valueExpression);l=e.createFunction(i),t.cache.compiledFunc=l}o=e.executeFunction(l,r);break}case"field":r&&(o=r[t.field]);break;case"unknown":o=null}if(!LT(o))return null;if(s||!t.normalizationField)return o;const h=r?parseFloat(r[t.normalizationField]):null;return LT(h)&&0!==h?o/h:null}(s,e,i),s,e,i,s.cache.ipData);return null==n||isNaN(n)?0:n}function HT(t,e,i){return null==t?null:ET(t)?WT(t,e,i):LT(t)?t:null}function JT(t,e,i){return LT(i)&&t>i?i:LT(e)&&t<e?e:t}function ZT(t,e,i,s,n){switch(e.transformationType){case"additive":return function(t,e,i,s){return t+(HT(e.minSize,i,s)||e.minDataValue)}(t,e,i,s);case"constant":return function(t,e,i){const s=t.stops;let n=s&&s.length&&s[0].size;return null==n&&(n=t.minSize),HT(n,e,i)}(e,i,s);case"clamped-linear":return function(t,e,i,s){const n=(t-e.minDataValue)/(e.maxDataValue-e.minDataValue),r=HT(e.minSize,i,s),o=HT(e.maxSize,i,s),a=u(s)?s.shape:void 0;if(t<=e.minDataValue)return r;if(t>=e.maxDataValue)return o;if("area"===e.scaleBy&&a){const t="circle"===a,e=t?zT*(r/2)**2:r*r,i=e+n*((t?zT*(o/2)**2:o*o)-e);return t?2*Math.sqrt(i/zT):Math.sqrt(i)}return r+n*(o-r)}(t,e,i,s);case"proportional":return function(t,e,i,s){const n=u(s)?s.shape:void 0,r=t/e.minDataValue,o=HT(e.minSize,i,s),a=HT(e.maxSize,i,s);let l=null;return l="circle"===n?2*Math.sqrt(r*(o/2)**2):"square"===n||"diamond"===n||"image"===n?Math.sqrt(r*o**2):r*o,JT(l,o,a)}(t,e,i,s);case"stops":return function(t,e,i,s,n){const[r,o,a]=KT(t,n);if(r===o)return HT(e.stops[r].size,i,s);{const t=HT(e.stops[r].size,i,s);return t+(HT(e.stops[o].size,i,s)-t)*a}}(t,e,i,s,n);case"real-world-size":return function(t,e,i,s){const n=(u(s)&&s.resolution?s.resolution:1)*DT[e.valueUnit],r=HT(e.minSize,i,s),o=HT(e.maxSize,i,s),{valueRepresentation:a}=e;let l=null;return l="area"===a?2*Math.sqrt(t/zT)/n:"radius"===a||"distance"===a?2*t/n:t/n,JT(l,r,o)}(t,e,i,s);case"identity":return t;case"unknown":return null}}function QT(t,e,i){const{isScaleDriven:s}=t.cache;if(!(s&&"3d"===i||e))return null;const n={scale:e,view:i};let r=HT(t.minSize,$T,n),o=HT(t.maxSize,$T,n);if(null!=r||null!=o){if(r>o){const t=o;o=r,r=t}return{minSize:r,maxSize:o}}}function KT(t,e){if(!e)return;let i=0,s=e.length-1;return e.some(((e,n)=>t<e?(s=n,!0):(i=n,!1))),[i,s,(t-e[i])/(e[s]-e[i])]}function YT(t,e,i){const s=["proportional","proportional","proportional"];for(const n of t){const t=n.useSymbolValue?"symbol-value":WT(n,e,i);switch(n.axis){case"width":s[0]=t;break;case"depth":s[1]=t;break;case"height":s[2]=t;break;case"width-and-depth":s[0]=t,s[1]=t;break;case"all":case void 0:case null:s[0]=t,s[1]=t,s[2]=t}}return s}const XT=Object.freeze({__proto__:null,getAllSizes:YT,getColor:UT,getOpacity:qT,getRotationAngle:BT,getSize:WT,getSizeForValue:ZT,getSizeFromNumberOrVariable:HT,getSizeRangeAtScale:QT,getVisualVariableValues:function(t,e,i){if(!t.visualVariables)return;const s=[],n=[],r=[],o=[],a=[];for(const e of t.visualVariables)switch(e.type){case"color":n.push(e);break;case"opacity":r.push(e);break;case"rotation":a.push(e);break;case"size":o.push(e)}return n.forEach((t=>{const n=UT(t,e,i);s.push({variable:t,value:n})})),r.forEach((t=>{const n=qT(t,e,i);s.push({variable:t,value:n})})),a.forEach((t=>{const n=BT(t,e,i);s.push({variable:t,value:n})})),o.forEach((t=>{const n=WT(t,e,i);s.push({variable:t,value:n})})),s.filter((t=>null!=t.value))},viewScaleRE:GT});var tO;const eO=ct.getLogger("esri.renderers.visualVariables.SizeVariable"),iO=new vo({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),sO=new vo({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function nO(t){if(null!=t)return"string"==typeof t||"number"==typeof t?tx(t):"size"===t.type?ET(t)?t:(delete(t={...t}).type,new oO(t)):void 0}function rO(t,e,i){if("object"!=typeof t)return t;const s=new oO;return s.read(t,i),s}let oO=tO=class extends dT{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:GT.test(this.valueExpression)}}set expression(t){eO.warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),"view.scale"===t?(this.valueExpression="$view.scale",this._set("expression",t)):this._set("expression",null)}set index(t){ET(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),ET(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return RT(this)}set maxDataValue(t){t&&this.stops&&(eO.warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(eO.warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return nO(t)}readMaxSize(t,e,i){return rO(t,0,i)}set minDataValue(t){t&&this.stops&&(eO.warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(eO.warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return nO(t)}readMinSize(t,e,i){return rO(t,0,i)}get arcadeRequired(){return!!this.valueExpression||this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired}set stops(t){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)):t&&(eO.warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return function(t,e){return"unknown"===(e||RT(t))?"constant":t.stops?"stops":null!=t.minSize&&null!=t.maxSize&&null!=t.minDataValue&&null!=t.maxDataValue?"clamped-linear":"unknown"===(t.valueUnit||"unknown")?null!=t.minSize&&null!=t.minDataValue?t.minSize&&t.minDataValue?"proportional":"additive":"identity":"real-world-size"}(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,i,s){if("$view.scale"===t){if(s&&s.messages){const t=this.index;s.messages.push(new dt("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:("string"==typeof t?t:`visualVariables[${t}]`)+".valueExpression",context:s}))}}else e[i]=t}readValueUnit(t){return t?sO.read(t):null}clone(){return new tO({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:ET(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:ET(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map((t=>t.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})}flipSizes(){if("clamped-linear"===this.transformationType){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if("stops"===this.transformationType){const t=this.stops,e=t.map((t=>t.size)).reverse(),i=t.length;for(let s=0;s<i;s++)t[s].size=e[s];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};e([Hn({readOnly:!0})],oO.prototype,"cache",null),e([Hn({type:iO.apiValues,json:{type:iO.jsonValues,origins:{"web-map":{read:!1}},read:iO.read,write:iO.write}})],oO.prototype,"axis",void 0),e([Hn({type:String,value:null,json:{read:!1}})],oO.prototype,"expression",null),e([Hn()],oO.prototype,"index",null),e([Hn({type:String,readOnly:!0})],oO.prototype,"inputValueType",null),e([Hn({type:PT,json:{write:!0}})],oO.prototype,"legendOptions",void 0),e([Hn({type:Number,value:null,json:{write:!0}})],oO.prototype,"maxDataValue",null),e([Hn({type:Number,value:null,json:{write:!0}})],oO.prototype,"maxSize",null),e([xa("maxSize")],oO.prototype,"castMaxSize",null),e([Rh("maxSize")],oO.prototype,"readMaxSize",null),e([Hn({type:Number,value:null,json:{write:!0}})],oO.prototype,"minDataValue",null),e([Hn({type:Number,value:null,json:{write:!0}})],oO.prototype,"minSize",null),e([xa("minSize")],oO.prototype,"castMinSize",null),e([Rh("minSize")],oO.prototype,"readMinSize",null),e([Hn({type:String,json:{write:!0}})],oO.prototype,"normalizationField",void 0),e([Hn({readOnly:!0})],oO.prototype,"arcadeRequired",null),e([Hn({type:String})],oO.prototype,"scaleBy",void 0),e([Hn({type:[AT],value:null,json:{write:!0}})],oO.prototype,"stops",null),e([Hn({type:["outline"],json:{write:!0}})],oO.prototype,"target",void 0),e([Hn({type:String,readOnly:!0})],oO.prototype,"transformationType",null),e([Hn({type:["size"],json:{type:["sizeInfo"]}})],oO.prototype,"type",void 0),e([Hn({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],oO.prototype,"useSymbolValue",void 0),e([Hn({type:String,json:{write:!0}})],oO.prototype,"valueExpression",void 0),e([Rh("valueExpression",["valueExpression","expression"])],oO.prototype,"readValueExpression",null),e([fh("web-scene","valueExpression")],oO.prototype,"writeValueExpressionWebScene",null),e([Hn({type:["radius","diameter","area","width","distance"],json:{write:!0}})],oO.prototype,"valueRepresentation",void 0),e([Hn({type:sO.apiValues,json:{write:sO.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],oO.prototype,"valueUnit",void 0),e([Rh("valueUnit")],oO.prototype,"readValueUnit",null),oO=tO=e([_r("esri.renderers.visualVariables.SizeVariable")],oO);const aO=oO,lO=ct.getLogger("esri.renderers.visualVariables.VisualVariableFactory"),uO={color:vT,size:aO,opacity:kT,rotation:_T},cO=new vo({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),hO=/^\[([^\]]+)\]$/i;let dO=class extends Ar{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(t){if(this._resetVariables(),(t=t&&t.filter((t=>!!t)))&&t.length){for(const e of t)switch(e.type){case"color":this.colorVariables.push(e);break;case"opacity":this.opacityVariables.push(e);break;case"rotation":this.rotationVariables.push(e);break;case"size":this.sizeVariables.push(e)}this.sizeVariables.length&&this.sizeVariables.some((t=>!!t.target))&&t.sort(((t,e)=>{let i=null;return i=t.target===e.target?0:t.target?1:-1,i}));for(let e=0;e<t.length;e++)t[e].index=e;this._set("visualVariables",t)}else this._set("visualVariables",t)}readVariables(t,e,i){const{rotationExpression:s,rotationType:n}=e,r=s&&s.match(hO),o=r&&r[1];if(o&&(t||(t=[]),t.push({type:"rotationInfo",rotationType:n,field:o})),t)return t.map((t=>{const e=cO.read(t.type),s=uO[e];s||(lO.warn("Unknown variable type: "+e),i&&i.messages&&i.messages.push(new Qn("visual-variable:unsupported",`visualVariable of type '${e}' is not supported`,{definition:t,context:i})));const n=new s;return n.read(t,i),n}))}writeVariables(t,e){const i=[];for(const s of t){const t=s.toJSON(e);t&&i.push(t)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};e([Hn()],dO.prototype,"visualVariables",null),dO=e([_r("esri.renderers.visualVariables.VisualVariableFactory")],dO);const fO=dO,pO={base:dT,key:"type",typeMap:{opacity:kT,color:vT,rotation:_T,size:aO}},yO=t=>{let i=class extends t{constructor(){super(...arguments),this._vvFactory=new fO}set visualVariables(t){this._vvFactory.visualVariables=t,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(t,e,i){return this._vvFactory.readVariables(t,e,i)}writeVisualVariables(t,e,i,s){e[i]=this._vvFactory.writeVariables(t,s)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const t of this.visualVariables)if(t.arcadeRequired)return!0;return!1}hasVisualVariables(t,e){return t?this.getVisualVariablesForType(t,e).length>0:this.getVisualVariablesForType("size",e).length>0||this.getVisualVariablesForType("color",e).length>0||this.getVisualVariablesForType("opacity",e).length>0||this.getVisualVariablesForType("rotation",e).length>0}getVisualVariablesForType(t,e){const i=this.visualVariables;return i?i.filter((i=>i.type===t&&("string"==typeof e?i.target===e:!1!==e||!i.target))):[]}async collectVVRequiredFields(t,e){let i=[];this.visualVariables&&(i=i.concat(this.visualVariables));for(const s of i)s&&(s.field&&gb(t,e,s.field),s.normalizationField&&gb(t,e,s.normalizationField),s.valueExpression&&await wb(t,e,s.valueExpression))}};return e([Hn({types:[pO],value:null,json:{write:!0}})],i.prototype,"visualVariables",null),e([Rh("visualVariables",["visualVariables","rotationType","rotationExpression"])],i.prototype,"readVisualVariables",null),e([fh("visualVariables")],i.prototype,"writeVisualVariables",null),i=e([_r("esri.renderers.mixins.VisualVariablesMixin")],i),i},mO={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function gO(t,e,i,s){const n=function(t,e,i){if(!t)return null;if(i&&"web-scene"===i.origin&&!(t instanceof RI)&&!(t instanceof qj)){const s=function(t,e=mO){if(!t)return{symbol:null};const{retainId:i=mO.retainId,ignoreDrivers:s=mO.ignoreDrivers,hasLabelingContext:n=mO.hasLabelingContext,retainCIM:r=mO.retainCIM}=e;let o;if(Wj(t)||t instanceof qj)o=t.clone();else if("cim"===t.type){var a,l;const e=null==(a=t.data)||null==(l=a.symbol)?void 0:l.type;if("CIMPointSymbol"!==e)return{error:new dt("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${e||"unknown"}' is unsupported in 3D`,{symbol:t})};o=r?t.clone():kj.fromCIMSymbol(t)}else if(t instanceof Ox)o=nj.fromSimpleLineSymbol(t);else if(t instanceof Nj)o=kj.fromSimpleMarkerSymbol(t);else if(t instanceof wj)o=kj.fromPictureMarkerSymbol(t);else if(t instanceof Pj)o=Oj.fromSimpleFillSymbol(t);else{if(!(t instanceof $j))return{error:new dt("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};o=n?XI.fromTextSymbol(t):kj.fromTextSymbol(t)}if(i&&"cim"!==o.type&&(o.id=t.id),s&&Wj(o))for(let t=0;t<o.symbolLayers.length;++t)o.symbolLayers.getItemAt(t)._ignoreDrivers=!0;return{symbol:o}}(t,{retainCIM:!0});return u(s.symbol)?s.symbol.write(e,i):(i.messages&&i.messages.push(new dt("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:i,error:s.error})),null)}return i&&"web-map"===i.origin&&"web-style"===t.type?(i.messages&&i.messages.push(new dt("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in webmaps. Use CIMSymbol instead when working with WebMap in MapView.`,{symbol:t,context:i})),null):t.write(e,i)}(t,{},s);n&&(e[i]=n)}function vO(t,e){return Zj(t,null,e)}const wO={types:Qj,json:{write:{writer:gO},origins:{"web-scene":{types:Yj,write:{writer:gO},read:{reader:tr({types:Yj})}}}}},bO={types:{base:BS,key:"type",typeMap:{"simple-fill":Hj.typeMap["simple-fill"],"picture-fill":Hj.typeMap["picture-fill"],"polygon-3d":Hj.typeMap["polygon-3d"]}},json:{write:{writer:gO},origins:{"web-scene":{type:Oj,write:{writer:gO}}}}};var MO;let SO=MO=class extends lh{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new MO({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};e([Hn({type:String,json:{write:!0}})],SO.prototype,"description",void 0),e([Hn({type:String,json:{write:!0}})],SO.prototype,"label",void 0),e([Hn({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],SO.prototype,"minValue",void 0),e([Hn({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],SO.prototype,"maxValue",void 0),e([Hn(wO)],SO.prototype,"symbol",void 0),SO=MO=e([_r("esri.renderers.support.ClassBreakInfo")],SO);const xO=SO;var kO;const IO=ct.getLogger("esri.renderers.ClassBreaksRenderer"),jO="percent-of-total",_O="field",TO=new vo({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:jO,esriNormalizeByField:_O}),OO=Ln(xO);let AO=kO=class extends(yO(iT)){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,i){if(!Array.isArray(t))return;let s=e.minValue;return t.map((t=>{const e=new xO;return e.read(t,i),null==e.minValue&&(e.minValue=s),null==e.maxValue&&(e.maxValue=e.minValue),s=e.maxValue,e}))}writeClassBreakInfos(t,e,i,s){const n=t.map((t=>t.write({},s)));this._areClassBreaksConsecutive()&&n.forEach((t=>delete t.classMinValue)),e[i]=n}castField(t){return null==t?t:"function"==typeof t?(IO.error(".field: field must be a string value"),null):xn(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,i=null!=this.normalizationTotal;return e||i?(t=(e?_O:i&&jO)||null,e&&i&&IO.warn("warning: both normalizationField and normalizationTotal are set!")):t!==_O&&t!==jO||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,i){let s=null;s="number"==typeof t?new xO({minValue:t,maxValue:e,symbol:t_(i)}):OO(H(t)),this.classBreakInfos.push(s),1===this.classBreakInfos.length&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const i=this.classBreakInfos.length;for(let s=0;s<i;s++){const i=[this.classBreakInfos[s].minValue,this.classBreakInfos[s].maxValue];if(i[0]===t&&i[1]===e){this.classBreakInfos.splice(s,1);break}}}getBreakIndex(t,e){return this.valueExpression&&(c(e)||c(e.arcade))&&IO.warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let i=e;this.valueExpression&&(c(e)||c(e.arcade))&&(i={...i,arcade:await rb()});const s=this.getBreakIndex(t,i);return-1!==s?this.classBreakInfos[s]:null}getSymbol(t,e){if(this.valueExpression&&(c(e)||c(e.arcade)))return void IO.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(t,e);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(c(e)||c(e.arcade))){const t=await rb(),{arcadeUtils:e}=t;e.hasGeometryOperations(this.valueExpression)&&await e.enableGeometryOperations(),i={...i,arcade:t}}const s=this.getBreakIndex(t,i);return s>-1?this.classBreakInfos[s].symbol:this.defaultSymbol}getSymbols(){const t=[];return this.classBreakInfos.forEach((e=>{e.symbol&&t.push(e.symbol)})),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce(((t,e)=>t+e.getMeshHash()),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new kO({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:H(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:H(this.visualVariables),legendOptions:H(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(t,e))),wb(t,e,this.valueExpression)];gb(t,e,this.field),gb(t,e,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(t,e){const{viewingMode:i,scale:s,spatialReference:n,arcade:r}=y(e,{});let o=this._compiledValueExpression.valueExpression===this.valueExpression?this._compiledValueExpression.compiledFunction:null;const a=r.arcadeUtils;if(!o){const t=a.createSyntaxTree(this.valueExpression);o=a.createFunction(t),this._compiledValueExpression.compiledFunction=o}this._compiledValueExpression.valueExpression=this.valueExpression;const l=a.executeFunction(o,a.createExecContext(t,a.getViewInfo({viewingMode:i,scale:s,spatialReference:n})));return this._getBreakIndexfromInfos(l)}_getBreakIndexForField(t){const e=t.attributes,i=this.normalizationType;let s=parseFloat(e[this.field]);if(i){const t=this.normalizationTotal,n=parseFloat(e[this.normalizationField]);if("log"===i)s=Math.log(s)*Math.LOG10E;else if(i!==jO||isNaN(t)){if(i===_O&&!isNaN(n)){if(isNaN(s)||isNaN(n))return-1;s/=n}}else s=s/t*100}return this._getBreakIndexfromInfos(s)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(null!=t&&"number"==typeof t&&!isNaN(t))for(let i=0;i<this.classBreakInfos.length;i++){const s=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(s[0]<=t&&(e?t<=s[1]:t<s[1]))return i}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let i=1;i<e;i++)if(t[i-1].maxValue!==t[i].minValue)return!1;return!0}};e([Hn(bO)],AO.prototype,"backgroundFillSymbol",void 0),e([Hn({type:[xO]})],AO.prototype,"classBreakInfos",void 0),e([Rh("classBreakInfos")],AO.prototype,"readClassBreakInfos",null),e([fh("classBreakInfos")],AO.prototype,"writeClassBreakInfos",null),e([Hn({type:String,json:{write:!0}})],AO.prototype,"defaultLabel",void 0),e([Hn(wO)],AO.prototype,"defaultSymbol",void 0),e([Hn({type:String,json:{write:!0}})],AO.prototype,"field",void 0),e([xa("field")],AO.prototype,"castField",null),e([Hn({type:Boolean})],AO.prototype,"isMaxInclusive",void 0),e([Hn({type:rT,json:{write:!0}})],AO.prototype,"legendOptions",void 0),e([Hn({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],AO.prototype,"minValue",null),e([Hn({type:String,json:{write:!0}})],AO.prototype,"normalizationField",void 0),e([Hn({type:Number,cast:t=>kn(t),json:{write:!0}})],AO.prototype,"normalizationTotal",void 0),e([Hn({type:TO.apiValues,value:null,json:{type:TO.jsonValues,read:TO.read,write:TO.write}})],AO.prototype,"normalizationType",null),e([lM({classBreaks:"class-breaks"})],AO.prototype,"type",void 0),e([Hn({type:String,json:{write:!0}})],AO.prototype,"valueExpression",void 0),e([Hn({type:String,json:{write:!0}})],AO.prototype,"valueExpressionTitle",void 0),AO=kO=e([_r("esri.renderers.ClassBreaksRenderer")],AO);const FO=AO;class CO{constructor(t,e,i){this._namespace=t,this._storage=e,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",i&&(this._storage.registerRemoveFunc(this._namespace,i),this._removeFunc=!0)}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this),this._storage=null}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0}put(t,e,i,s=0){this._storage.put(this._namespace+t,e,i,s)}get(t){const e=this._storage.get(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}pop(t){const e=this._storage.pop(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}updateSize(t,e,i){this._storage.updateSize(this._namespace+t,e,i)}clear(){this._storage.clear(this._namespace)}clearAll(){this._storage.clearAll()}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats()}}class PO{constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new Fs,this._users=new Fs}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace((e=>e[0]!==t))}get size(){return this._size}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,0),this._checkSizeLimit()}put(t,e,i,s){const n=this._db.get(t);if(n&&(this._size-=n.size,this._db.delete(t),n.entry!==e&&this._notifyRemove(t,n.entry,0)),i>this._maxSize)return void this._notifyRemove(t,e,0);if(void 0===e)return void console.warn("Refusing to cache undefined entry ");if(!i||i<0)return void console.warn("Refusing to cache entry with invalid size "+i);const r=1+Math.max(s,-3)- -3;this._db.set(t,{entry:e,size:i,lifetime:r,lives:r}),this._size+=i,this._checkSizeLimit()}updateSize(t,e,i){const s=this._db.get(t);if(s&&s.entry===e){for(this._size-=s.size;i>this._maxSize;){const s=this._notifyRemove(t,e,1);if(!(u(s)&&s>0))return void this._db.delete(t);i=s}s.size=i,this._size+=i,this._checkSizeLimit()}}pop(t){const e=this._db.get(t);if(e)return this._size-=e.size,this._db.delete(t),++this._hit,e.entry;++this._miss}get(t){const e=this._db.get(t);if(void 0!==e)return this._db.delete(t),e.lives=e.lifetime,this._db.set(t,e),++this._hit,e.entry;++this._miss}getStats(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:""+this._db.size},e={},i=[];this._db.forEach(((t,s)=>{const n=t.lifetime;i[n]=(i[n]||0)+t.size,this._users.forAll((i=>{const n=i.namespace;s.startsWith(n)&&(e[n]=(e[n]||0)+t.size)}))}));const s={};this._users.forAll((t=>{const i=t.namespace;!isNaN(t.hitRate)&&t.hitRate>0?(e[i]=e[i]||0,s[i]=Math.round(100*t.hitRate)+"%"):s[i]="0%"}));const n=Object.keys(e);n.sort(((t,i)=>e[i]-e[t])),n.forEach((i=>t[i]=Math.round(e[i]/2**20)+"MB / "+s[i]));for(let e=i.length-1;e>=0;--e){const s=i[e];s&&(t["Priority "+(e+-3-1)]=Math.round(s/this.size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()))}clear(t){this._db.forEach(((e,i)=>{i.startsWith(t)&&(this._size-=e.size,this._db.delete(i),this._notifyRemove(i,e.entry,0))}))}clearAll(){this._db.forEach(((t,e)=>this._notifyRemove(e,t.entry,0))),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,e,i){let s;return this._removeFuncs.some((n=>{if(t.startsWith(n[0])){const t=n[1](e,i);return"number"==typeof t&&(s=t),!0}return!1})),s}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(const[t,e]of this._db){if(this._db.delete(t),e.lives<=1){this._size-=e.size;const i=this._notifyRemove(t,e.entry,1);u(i)&&i>0&&(this._size+=i,e.lives=e.lifetime,e.size=i,this._db.set(t,e))}else--e.lives,this._db.set(t,e);if(this._size<=.9*this.maxSize)return}}}class EO{constructor(t,e){this._storage=new PO,this._storage.maxSize=t,e&&this._storage.registerRemoveFunc("",e)}put(t,e,i){this._storage.put(t,e,i,1)}pop(t){return this._storage.pop(t)}get(t){return this._storage.get(t)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}}var LO;const RO=ct.getLogger("esri.renderers.DictionaryRenderer"),NO={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let DO=LO=class extends(yO(iT)){constructor(t){super(t),this._ongoingRequests=new Map,this._symbolCache=new EO(100),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,i,s){null!=s&&s.origin||super.writeVisualVariables(t,e,i,s)}clone(){return new LO({config:H(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:H(this.fieldMap),url:H(this.url),visualVariables:H(this.visualVariables)})}async getSymbolAsync(t,e){let i;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(e));try{i=await this._dictionaryPromise}catch(t){if(Ge(t))return this._dictionaryPromise=null,null}const s={};if(this.fieldMap)for(const e of this._symbolFields){const i=this.fieldMap[e];s[e]=i&&null!=t.attributes[i]?""+t.attributes[i]:""}const n=i(s,e);if(!n||"string"!=typeof n)return null;const r=""+at(n),o=this._symbolCache.get(r);if(o)return o.catch((()=>{this._symbolCache.pop(r)})),o;const a=n.split(";"),l=[],c=[];for(const t of a)if(t&&0!==t.length)if(-1===t.indexOf("po:"))if(-1!==t.indexOf("|")){for(const e of t.split("|"))if(this._itemNames.has(e)){l.push(e);break}}else this._itemNames.has(t)&&l.push(t);else{const e=t.substr(3).split("|");if(3===e.length){const t=e[0],i=e[1];let s=e[2];if("DashTemplate"===i)s=s.split(" ").map((t=>Number(t)));else if("Color"===i){const t=new zS(s).toRgba();s=[t[0],t[1],t[2],255*t[3]]}else s=Number(s);c.push({primitiveName:t,propertyName:i,value:s})}}const h=!u(t.geometry)||!t.geometry.hasZ&&"point"===t.geometry.type,d=this._cimPartsToCIMSymbol(l,c,h,e);return this._symbolCache.put(r,d,1),d}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await wb(t,e,this.scaleExpression);for(const i in this.fieldMap){const s=this.fieldMap[i];e.has(s)&&t.add(s)}}get arcadeRequired(){return!0}async fetchResources(t){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void RO.error("no valid URL!");const e=u(t)?t.abortOptions:null,i=oi(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},...e}),[{data:s}]=await Promise.all([i,rb()]);if(!s)throw this._dictionaryPromise=null,new dt("esri.renderers.DictionaryRenderer","Bad dictionary data!");const n=s.expression,r=s.authoringInfo;this._refSymbolUrlTemplate=this.url+"/"+s.cimRefTemplateUrl,this._itemNames=new Set(s.itemsNames),this._symbolFields=r.symbol;const o={};if(this.config){const t=this.config;for(const e in t)o[e]=t[e]}if(r.configuration)for(const t of r.configuration)o.hasOwnProperty(t.name)||(o[t.name]=t.value);const a=[];if(u(t)&&t.fields&&this.fieldMap)for(const e of this._symbolFields){const i=this.fieldMap[e],s=t.fields.filter((t=>t.name===i));s.length>0&&a.push({...s[0],name:e})}return this._dictionaryPromise=((t,e,i,s)=>lb.create(t,e,i,s,["$feature","$view"]))(n,u(t)?t.spatialReference:null,a,o).then((t=>{const e={scale:0};return(i,s)=>{const n=t.repurposeFeature({geometry:null,attributes:i});return e.scale=u(s)?s.scale:void 0,t.evaluate({$feature:n,$view:e})}})).catch((t=>(RO.error("Creating dictinoary expression failed:",t),null))),this._dictionaryPromise}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._symbolFields}async _getSymbolPart(t,e){if(this._ongoingRequests.has(t))return this._ongoingRequests.get(t).then((t=>t.data));const i=oi(this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,t),{responseType:"json",query:{f:"json"},...e});this._ongoingRequests.set(t,i);try{return(await i).data}catch(e){return this._ongoingRequests.delete(t),Promise.reject(e)}}_combineSymbolParts(t,e,i){if(!t||0===t.length)return null;const s={...t[0]};if(t.length>1){s.symbolLayers=[];for(const e of t)s.symbolLayers.unshift(...e.symbolLayers)}return i&&(s.callout=NO),{type:"CIMSymbolReference",symbol:s,primitiveOverrides:e}}async _cimPartsToCIMSymbol(t,e,i,s){const n=Array(t.length);for(let e=0;e<t.length;e++)n[e]=this._getSymbolPart(t[e],s);const r=await Promise.all(n);return new JS({data:this._combineSymbolParts(r,e,i)})}};e([Hn({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],DO.prototype,"config",void 0),e([Hn({type:Object,json:{write:!0}})],DO.prototype,"fieldMap",void 0),e([Hn({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],DO.prototype,"scaleExpression",void 0),e([fh("scaleExpression")],DO.prototype,"writeData",null),e([Hn({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],DO.prototype,"scaleExpressionTitle",void 0),e([Hn({type:String,json:{write:!0}})],DO.prototype,"url",void 0),e([fh("visualVariables")],DO.prototype,"writeVisualVariables",null),DO=LO=e([_r("esri.renderers.DictionaryRenderer")],DO);const VO=DO,$O=Object.freeze({__proto__:null,default:VO});var zO;const GO=ct.getLogger("esri.renderers.support.AttributeColorInfo");let UO=zO=class extends lh{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return null==t?t:"function"==typeof t?(GO.error(".field: field must be a string value"),null):xn(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new zO({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};e([Hn({type:zS,json:{type:[Number],write:!0}})],UO.prototype,"color",void 0),e([Hn({type:String,json:{write:!0}})],UO.prototype,"field",void 0),e([xa("field")],UO.prototype,"castField",null),e([Hn({type:String,json:{write:!0}})],UO.prototype,"label",void 0),e([Hn({type:String,json:{write:!0}})],UO.prototype,"valueExpression",void 0),e([Hn({type:String,json:{write:!0}})],UO.prototype,"valueExpressionTitle",void 0),UO=zO=e([_r("esri.renderers.support.AttributeColorInfo")],UO);const qO=UO;var BO;let WO=BO=class extends lh{constructor(){super(...arguments),this.unit=null}clone(){return new BO({unit:this.unit})}};e([Hn({type:String,json:{write:!0}})],WO.prototype,"unit",void 0),WO=BO=e([_r("esri.renderers.support.DotDensityLegendOptions")],WO);const HO=WO;var JO;let ZO=JO=class extends(yO(iT)){constructor(t){super(t),this.attributes=null,this.backgroundColor=new zS([0,0,0,0]),this.blendDots=!0,this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new Ox,this.dotValue=null,this.referenceDotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(t){if(null==this.referenceScale)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new Pj({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes&&this.attributes.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new JO({attributes:H(this.attributes),backgroundColor:H(this.backgroundColor),dotBlendingEnabled:H(this.dotBlendingEnabled),dotShape:H(this.dotShape),dotSize:H(this.dotSize),dotValue:H(this.dotValue),legendOptions:H(this.legendOptions),outline:H(this.outline),referenceScale:H(this.referenceScale),visualVariables:H(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){return`${this.attributes.map((t=>t.field||t.valueExpression||""))}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const i of this.attributes)i.valueExpression&&await wb(t,e,i.valueExpression),i.field&&t.add(i.field)}};e([Hn({type:[qO],json:{write:!0}})],ZO.prototype,"attributes",void 0),e([Hn({type:zS,json:{write:!0}})],ZO.prototype,"backgroundColor",void 0),e([Hn({type:Boolean}),go("dotBlendingEnabled")],ZO.prototype,"blendDots",void 0),e([Hn({type:Boolean,json:{write:!0}})],ZO.prototype,"dotBlendingEnabled",void 0),e([Hn({type:String,json:{write:!1}})],ZO.prototype,"dotShape",void 0),e([Hn({type:Number,json:{write:!1}})],ZO.prototype,"dotSize",void 0),e([Hn({type:HO,json:{write:!0}})],ZO.prototype,"legendOptions",void 0),e([Hn({type:Ox,json:{default:null,write:!0}})],ZO.prototype,"outline",void 0),e([Hn({type:Number,json:{write:!0}})],ZO.prototype,"dotValue",void 0),e([Hn({type:Number}),go("dotValue")],ZO.prototype,"referenceDotValue",void 0),e([Hn({type:Number,json:{write:!0}})],ZO.prototype,"referenceScale",void 0),e([Hn({type:Number,json:{write:!0}})],ZO.prototype,"seed",void 0),e([lM({dotDensity:"dot-density"})],ZO.prototype,"type",void 0),ZO=JO=e([_r("esri.renderers.DotDensityRenderer")],ZO);const QO=ZO;var KO;let YO=KO=class extends lh{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new KO({color:this.color,ratio:this.ratio})}};e([Hn({type:zS,json:{write:!0}})],YO.prototype,"color",void 0),e([Hn({type:Number,json:{write:!0}})],YO.prototype,"ratio",void 0),YO=KO=e([_r("esri.renderers.support.HeatmapColorStop")],YO);const XO=YO;var tA;let eA=tA=class extends iT{constructor(t){super(t),this.blurRadius=10,this.colorStops=[new XO({ratio:0,color:new zS("rgba(255, 140, 0, 0)")}),new XO({ratio:.75,color:new zS("rgba(255, 140, 0, 1)")}),new XO({ratio:.9,color:new zS("rgba(255, 0,   0, 1)")})],this.field=null,this.fieldOffset=0,this.maxPixelIntensity=100,this.minPixelIntensity=0,this.type="heatmap"}async collectRequiredFields(t,e){const i=this.field;i&&"string"==typeof i&&gb(t,e,i)}getAttributeHash(){return null}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new tA({blurRadius:this.blurRadius,colorStops:H(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})}};e([Hn({type:Number,json:{write:!0}})],eA.prototype,"blurRadius",void 0),e([Hn({type:[XO],json:{write:!0}})],eA.prototype,"colorStops",void 0),e([Hn({type:String,json:{write:!0}})],eA.prototype,"field",void 0),e([Hn({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:null==i})}}})],eA.prototype,"fieldOffset",void 0),e([Hn({type:Number,json:{write:!0}})],eA.prototype,"maxPixelIntensity",void 0),e([Hn({type:Number,json:{write:!0}})],eA.prototype,"minPixelIntensity",void 0),e([lM({heatmap:"heatmap"})],eA.prototype,"type",void 0),eA=tA=e([_r("esri.renderers.HeatmapRenderer")],eA);const iA=eA;var sA;let nA=sA=class extends(yO(iT)){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.getSymbols().map((i=>i.collectRequiredFields(t,e))))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){return this.getSymbols().reduce(((t,e)=>t+JSON.stringify(e)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new sA({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:H(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};e([Hn({type:String,json:{write:!0}})],nA.prototype,"description",void 0),e([Hn({type:String,json:{write:!0}})],nA.prototype,"label",void 0),e([Hn(wO)],nA.prototype,"symbol",void 0),e([lM({simple:"simple"})],nA.prototype,"type",void 0),nA=sA=e([_r("esri.renderers.SimpleRenderer")],nA);const rA=nA,oA=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function aA(t){return t instanceof Ar}function lA(t){return t instanceof Jr?Object.keys(t.items):aA(t)?Ci(t).keys():t?Object.keys(t):[]}function uA(t,e){return t instanceof Jr?t.items[e]:t[e]}function cA(t){return t?t.declaredClass:null}function hA(t,e){const i=t.diff;if(i&&"function"==typeof i)return i(t,e);const s=lA(t),n=lA(e);if(0===s.length&&0===n.length)return;if(!s.length||!n.length||function(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}(t,e))return{type:"complete",oldValue:t,newValue:e};const r=n.filter((t=>-1===s.indexOf(t))),o=s.filter((t=>-1===n.indexOf(t))),a=s.filter((i=>n.indexOf(i)>-1&&uA(t,i)!==uA(e,i))).concat(r,o).sort(),l=cA(t);if(l&&oA.indexOf(l)>-1&&a.length)return{type:"complete",oldValue:t,newValue:e};let c;const h=aA(t)&&aA(e);for(const s of a){const n=uA(t,s),r=uA(e,s);let o;(h||"function"!=typeof n&&"function"!=typeof r)&&n!==r&&(null==n&&null==r||(o=i&&i[s]&&"function"==typeof i[s]?i[s](n,r):"object"==typeof n&&"object"==typeof r&&cA(n)===cA(r)?hA(n,r):{type:"complete",oldValue:n,newValue:r},u(o)&&(u(c)?c.diff[s]=o:c={type:"partial",diff:{[s]:o}})))}return c}function dA(t,e){if(c(t))return!1;const i=e.split(".");let s=t;for(const t of i){if("complete"===s.type)return!0;if("partial"!==s.type)return!1;{const e=s.diff[t];if(!e)return!1;s=e}}return!0}function fA(t,e){for(const i of e)if(dA(t,i))return!0;return!1}function pA(t,e){if(!("function"==typeof t||"function"==typeof e||c(t)&&c(e)))return c(t)||c(e)||"object"==typeof t&&"object"==typeof e&&cA(t)!==cA(e)?{type:"complete",oldValue:t,newValue:e}:hA(t,e)}var yA;let mA=yA=class extends lh{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new yA({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol&&this.symbol.toJSON());return`${this.value}.${t}`}};e([Hn({type:String,json:{write:!0}})],mA.prototype,"description",void 0),e([Hn({type:String,json:{write:!0}})],mA.prototype,"label",void 0),e([Hn(wO)],mA.prototype,"symbol",void 0),e([Hn({type:[String,Number],json:{type:String,write:{writer:(t,e)=>{e.value=null==t?void 0:""+t}}}})],mA.prototype,"value",void 0),mA=yA=e([_r("esri.renderers.support.UniqueValueInfo")],mA);const gA=mA,vA={};function wA(t,e,i){return t.styleUrl?async function(t,e){try{return{data:(await SA(t,e)).data,baseUrl:ae(t),styleUrl:t}}catch(t){return Ne(t),null}}(t.styleUrl,i):t.styleName?function(t,e,i){const s=e&&e.portal||ef.getDefault();let n;const r=`${s.url} - ${s.user&&s.user.username} - ${t}`;return vA[r]||(vA[r]=function(t,e,i){return e.load(i).then((()=>{const s=new Vd({disableExtraQuery:!0,query:`owner:${xA} AND type:${kA} AND typekeywords:"${t}"`});return e.queryItems(s,i)})).then((({results:e})=>{let s=null;const n=t.toLowerCase();if(e&&Array.isArray(e))for(const t of e)if(t.typeKeywords.some((t=>t.toLowerCase()===n))&&t.type===kA&&t.owner===xA){s=t;break}if(!s)throw new dt("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return s.load(i)}))}(t,s,i).then((t=>(n=t,t.fetchData()))).then((e=>({data:e,baseUrl:n.itemUrl,styleName:t})))),vA[r]}(t.styleName,e,i):Promise.reject(new dt("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function bA(t){return null===t||"CIMSymbolReference"===t.type?t:{type:"CIMSymbolReference",symbol:t}}function MA(t,e){if("cimRef"===e)return t.cimRef;if(t.formatInfos&&!l("enable-feature:force-wosr"))for(const e of t.formatInfos)if("gltf"===e.type)return e.href;return t.webRef}function SA(t,e){const i={responseType:"json",query:{f:"json"},...e};return oi(Bt(t),i)}const xA="esri_en",kA="Style",IA="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var jA;const _A=ct.getLogger("esri.renderers.UniqueValueRenderer"),TA=Ln(gA);let OA=jA=class extends(yO(iT)){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this.type="unique-value",this.backgroundFillSymbol=null,this.field=null,this.field2=null,this.field3=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.fieldDelimiter=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(t,e){if(!t&&!e)return;if(!t||!e)return{type:"complete",oldValue:t,newValue:e};let i=!1;const s={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let n=0;n<e.length;n++){const r=t.find((t=>t.value===e[n].value));r?pA(r,e[n])?(s.changed.push({type:"complete",oldValue:r,newValue:e[n]}),i=!0):s.unchanged.push({oldValue:r,newValue:e[n]}):(s.added.push(e[n]),i=!0)}for(let n=0;n<t.length;n++)e.find((e=>e.value===t[n].value))||(s.removed.push(t[n]),i=!0);return i?s:void 0}},this._set("uniqueValueInfos",[])}get _cache(){return{compiledFunc:null}}castField(t){return null==t||"function"==typeof t?t:xn(t)}writeField(t,e,i,s){"string"==typeof t?e[i]=t:s&&s.messages?s.messages.push(new dt("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):_A.error(".field: cannot write field to JSON since it's not a string value")}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}readPortal(t,e,i){return i.portal||ef.getDefault()}readStyleOrigin(t,e,i){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const t=jk(e.styleUrl,i);return Object.freeze({styleUrl:t})}}writeStyleOrigin(t,e,i,s){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=_k(t.styleUrl,s))}set uniqueValueInfos(t){this.styleOrigin?_A.error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap())}addUniqueValueInfo(t,e){if(this.styleOrigin)return void _A.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i="object"==typeof t?TA(t):new gA({value:t,symbol:t_(e)}),this.uniqueValueInfos.push(i),this._valueInfoMap[i.value]=i}removeUniqueValueInfo(t){if(this.styleOrigin)_A.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(let e=0;e<this.uniqueValueInfos.length;e++)if(this.uniqueValueInfos[e].value===t+""){delete this._valueInfoMap[t],this.uniqueValueInfos.splice(e,1);break}}async getUniqueValueInfo(t,e){let i=e;return this.valueExpression&&(c(e)||c(e.arcade))&&(i={...i,arcade:await rb()}),this._getUniqueValueInfo(t,i)}getSymbol(t,e){if(this.valueExpression&&(c(e)||c(e.arcade)))return void _A.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(t,e);return i&&i.symbol||this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(c(i)||c(i.arcade))){const t=await rb(),{arcadeUtils:e}=t;e.hasGeometryOperations(this.valueExpression)&&await e.enableGeometryOperations(),i={...i,arcade:t}}const s=this._getUniqueValueInfo(t,i);return s&&s.symbol||this.defaultSymbol}getSymbols(){const t=[];for(const e of this.uniqueValueInfos)e.symbol&&t.push(e.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){return`${JSON.stringify(this.backgroundFillSymbol)}.${JSON.stringify(this.defaultSymbol)}.${this.uniqueValueInfos.reduce(((t,e)=>t+e.getMeshHash()),"")}.${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}.${this.valueExpression}`}clone(){const t=new jA({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:H(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:H(this.visualVariables),legendOptions:H(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:H(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=H(this.uniqueValueInfos);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(H(this.styleOrigin))),Object.freeze(e)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(t,e))),wb(t,e,this.valueExpression)];gb(t,e,this.field),gb(t,e,this.field2),gb(t,e,this.field3),await Promise.all(i)}populateFromStyle(){return wA(this.styleOrigin,{portal:this.portal}).then((t=>{const e=[];return this._valueInfoMap={},t&&t.data&&Array.isArray(t.data.items)&&t.data.items.forEach((i=>{const s=new qj({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:i.name});this.defaultSymbol||i.name!==t.data.defaultItem||(this.defaultSymbol=s,this._isDefaultSymbolDerived=!0);const n=new gA({value:i.name,symbol:s});e.push(n),this._valueInfoMap[i.name]=n})),this._set("uniqueValueInfos",Object.freeze(e)),!this.defaultSymbol&&this.uniqueValueInfos.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this}))}_updateValueInfoMap(){this._valueInfoMap={},this.uniqueValueInfos.forEach((t=>this._valueInfoMap[t.value+""]=t))}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:i,scale:s,spatialReference:n,arcade:r}=y(e,{});let o=this._cache.compiledFunc;const a=r.arcadeUtils;if(!o){const t=a.createSyntaxTree(this.valueExpression);o=a.createFunction(t),this._cache.compiledFunc=o}const l=a.executeFunction(o,a.createExecContext(t,a.getViewInfo({viewingMode:i,scale:s,spatialReference:n})));return this._valueInfoMap[l+""]}_getUnqiueValueInfoForFields(t){const e=this.field,i=t.attributes;let s;if("function"!=typeof e&&this.field2){const t=this.field2,n=this.field3,r=[];e&&r.push(i[e]),t&&r.push(i[t]),n&&r.push(i[n]),s=r.join(this.fieldDelimiter||"")}else"function"==typeof e?s=e(t):e&&(s=i[e]);return this._valueInfoMap[s+""]}static fromPortalStyle(t,e){const i=new jA(e&&e.properties);i._set("styleOrigin",Object.freeze({styleName:t})),i._set("portal",e&&e.portal||ef.getDefault());const s=i.populateFromStyle();return s.catch((e=>{_A.error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",e)})),s}static fromStyleUrl(t,e){const i=new jA(e&&e.properties);i._set("styleOrigin",Object.freeze({styleUrl:t}));const s=i.populateFromStyle();return s.catch((e=>{_A.error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",e)})),s}};e([Hn({readOnly:!0})],OA.prototype,"_cache",null),e([lM({uniqueValue:"unique-value"})],OA.prototype,"type",void 0),e([Hn(bO)],OA.prototype,"backgroundFillSymbol",void 0),e([Hn({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],OA.prototype,"field",void 0),e([xa("field")],OA.prototype,"castField",null),e([fh("field")],OA.prototype,"writeField",null),e([Hn({type:String,json:{write:!0}})],OA.prototype,"field2",void 0),e([Hn({type:String,json:{write:!0}})],OA.prototype,"field3",void 0),e([Hn({type:String,json:{write:!0}})],OA.prototype,"valueExpression",void 0),e([Hn({type:String,json:{write:!0}})],OA.prototype,"valueExpressionTitle",void 0),e([Hn({type:rT,json:{write:!0}})],OA.prototype,"legendOptions",void 0),e([Hn({type:String,json:{write:!0}})],OA.prototype,"defaultLabel",void 0),e([Hn(Z({...wO},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],OA.prototype,"defaultSymbol",null),e([Hn({type:String,json:{write:!0}})],OA.prototype,"fieldDelimiter",void 0),e([Hn({type:ef,readOnly:!0})],OA.prototype,"portal",void 0),e([Rh("portal",["styleName"])],OA.prototype,"readPortal",null),e([Hn({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],OA.prototype,"styleOrigin",void 0),e([Rh("styleOrigin",["styleName","styleUrl"])],OA.prototype,"readStyleOrigin",null),e([fh("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],OA.prototype,"writeStyleOrigin",null),e([Hn({type:[gA],json:{write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],OA.prototype,"uniqueValueInfos",null),OA=jA=e([_r("esri.renderers.UniqueValueRenderer")],OA);const AA=OA,FA={key:"type",base:iT,typeMap:{heatmap:iA,simple:rA,"unique-value":AA,"class-breaks":FO,"dot-density":QO,dictionary:VO},errorContext:"renderer"},CA={key:"type",base:iT,typeMap:{simple:rA,"unique-value":AA,"class-breaks":FO},errorContext:"renderer"};function PA(t,e){return LA(t,null,e)}const EA=tr({types:FA});function LA(t,e,i){return t?t&&(t.styleName||t.styleUrl)&&"uniqueValue"!==t.type?(i&&i.messages&&i.messages.push(new Qn("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:i})),null):EA(t,e,i):null}class RA{constructor(){this._propertyOriginMap=new Map,this._originStores=[,,,,,,,],this._values=new Map}clone(t){const e=new RA,i=this._originStores[0];i&&i.forEach(((t,i)=>{e.set(i,H(t),0)}));for(let i=2;i<7;i++){const s=this._originStores[i];s&&s.forEach(((s,n)=>{t&&t.has(n)||e.set(n,H(s),i)}))}return e}get(t,e){const i=void 0===e?this._values:this._originStores[e];return i?i.get(t):void 0}keys(t){const e=null==t?this._values:this._originStores[t];return e?[...e.keys()]:[]}set(t,e,i=6){let s=this._originStores[i];if(s||(s=new Map,this._originStores[i]=s),s.set(t,e),!this._values.has(t)||this._propertyOriginMap.get(t)<=i){const s=this._values.get(t);return this._values.set(t,e),this._propertyOriginMap.set(t,i),s!==e}return!1}delete(t,e=6){const i=this._originStores[e];if(!i)return;const s=i.get(t);if(i.delete(t),this._values.has(t)&&this._propertyOriginMap.get(t)===e){this._values.delete(t);for(let i=e-1;i>=0;i--){const e=this._originStores[i];if(e&&e.has(t)){this._values.set(t,e.get(t)),this._propertyOriginMap.set(t,i);break}}}return s}has(t,e){const i=void 0===e?this._values:this._originStores[e];return!!i&&i.has(t)}revert(t,e){for(;e>0&&!this.has(t,e);)--e;const i=this._originStores[e],s=i&&i.get(t),n=this._values.get(t);return this._values.set(t,s),this._propertyOriginMap.set(t,e),n!==s}originOf(t){return this._propertyOriginMap.get(t)||0}forEach(t){this._values.forEach(t)}}const NA=t=>{let i=class extends t{constructor(...t){super(...t);const e=Ci(this),i=e.metadatas,s=e.store,n=new RA;e.store=n,s.keys().forEach((t=>{n.set(t,s.get(t),0)})),Object.keys(i).forEach((t=>{e.internalGet(t)&&n.set(t,e.internalGet(t),0)}))}read(t,e){Yc(this,t,e)}getAtOrigin(t,e){const i=DA(this),s=ds(e);if("string"==typeof t)return i.get(t,s);const n={};return t.forEach((t=>{n[t]=i.get(t,s)})),n}originOf(t){return fs(this.originIdOf(t))}originIdOf(t){return DA(this).originOf(t)}revert(t,e){const i=DA(this),s=ds(e),n=Ci(this);let r;r="string"==typeof t?"*"===t?i.keys(s):[t]:t,r.forEach((t=>{n.invalidate(t),i.revert(t,s),n.commit(t)}))}};return i=e([_r("esri.core.ReadOnlyMultiOriginJSONSupport")],i),i};function DA(t){return Ci(t).store}let VA=class extends(NA(Ar)){};VA=e([_r("esri.core.ReadOnlyMultiOriginJSONSupport")],VA);const $A=t=>{let i=class extends t{constructor(...t){super(...t)}clear(t,e="user"){return zA(this).delete(t,ds(e))}write(t={},e){return nh(this,t=t||{},e),t}setAtOrigin(t,e,i){Ci(this).setAtOrigin(t,e,ds(i))}removeOrigin(t){const e=zA(this),i=ds(t),s=e.keys(i);for(const t of s)e.originOf(t)===i&&e.set(t,e.get(t,i),6)}updateOrigin(t,e){const i=zA(this),s=ds(e),n=this.get(t);for(let e=s+1;e<7;++e)i.delete(t,e);i.set(t,n,s)}toJSON(t){return this.write({},t)}};return i=e([_r("esri.core.WriteableMultiOriginJSONSupport")],i),i.prototype.toJSON.isDefaultToJSON=!0,i};function zA(t){return Ci(t).store}const GA=t=>{let i=class extends($A(NA(t))){constructor(...t){super(...t)}};return i=e([_r("esri.core.MultiOriginJSONSupport")],i),i};let UA=class extends(GA(Ar)){};var qA;UA=e([_r("esri.core.MultiOriginJSONSupport")],UA);let BA=qA=class extends lh{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new qA({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};e([Hn({type:String,json:{write:!0}})],BA.prototype,"expression",void 0),e([Hn({type:String,json:{write:!0}})],BA.prototype,"name",void 0),e([Hn({type:["boolean"],json:{write:!0}})],BA.prototype,"returnType",void 0),e([Hn({type:String,json:{write:!0}})],BA.prototype,"title",void 0),BA=qA=e([_r("esri.form.ExpressionInfo")],BA);const WA=BA;let HA=class extends lh{constructor(t){super(t),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};e([Hn({type:String,json:{write:!0}})],HA.prototype,"description",void 0),e([Hn({type:String,json:{write:!0}})],HA.prototype,"label",void 0),e([Hn()],HA.prototype,"type",void 0),e([Hn({type:String,json:{write:!0}})],HA.prototype,"visibilityExpression",void 0),HA=e([_r("esri.form.elements.Element")],HA);const JA=HA;var ZA;let QA=ZA=class extends lh{constructor(t){super(t),this.type=null}clone(){return new ZA({type:this.type})}};e([Hn({type:["attachment","audio","document","image","signature","video"],json:{write:!0}})],QA.prototype,"type",void 0),QA=ZA=e([_r("esri.form.elements.inputs.AttachmentInput")],QA);const KA=QA;var YA;let XA=YA=class extends JA{constructor(t){super(t),this.attachmentKeyword=null,this.editable=!0,this.input=null,this.type="attachment"}clone(){return new YA({attachmentKeyword:this.attachmentKeyword,description:this.description,editable:this.editable,input:this.input,label:this.label,visibilityExpression:this.visibilityExpression})}};e([Hn({type:String,json:{write:!0}})],XA.prototype,"attachmentKeyword",void 0),e([Hn({type:Boolean,json:{write:!0}})],XA.prototype,"editable",void 0),e([Hn({type:KA,json:{read:{source:"inputType"},write:{target:"inputType"}}})],XA.prototype,"input",void 0),e([Hn({type:["attachment"],json:{read:!1,write:!0}})],XA.prototype,"type",void 0),XA=YA=e([_r("esri.form.elements.AttachmentElement")],XA);const tF=XA;let eF=class extends lh{constructor(t){super(t),this.type=null}};e([Hn()],eF.prototype,"type",void 0),eF=e([_r("esri.form.elements.inputs.Input")],eF);const iF=eF;let sF=class extends iF{constructor(t){super(t),this.maxLength=null,this.minLength=0}};e([Hn({type:Number,json:{write:!0}})],sF.prototype,"maxLength",void 0),e([Hn({type:Number,json:{write:!0}})],sF.prototype,"minLength",void 0),sF=e([_r("esri.form.elements.inputs.TextInput")],sF);const nF=sF;var rF;let oF=rF=class extends nF{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new rF({maxLength:this.maxLength,minLength:this.minLength})}};e([Hn({type:["barcode-scanner"],json:{read:!1,write:!0}})],oF.prototype,"type",void 0),oF=rF=e([_r("esri.form.elements.inputs.BarcodeScannerInput")],oF);const aF=oF;var lF;let uF=lF=class extends iF{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!1,this.type="combo-box"}clone(){return new lF({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};e([Hn({type:String,json:{write:!0}})],uF.prototype,"noValueOptionLabel",void 0),e([Hn({type:Boolean,json:{write:!0}})],uF.prototype,"showNoValueOption",void 0),e([Hn({type:["combo-box"],json:{read:!1,write:!0}})],uF.prototype,"type",void 0),uF=lF=e([_r("esri.form.elements.inputs.ComboBoxInput")],uF);const cF=uF;var hF;function dF(t){return null!=t?new Date(t):null}function fF(t){return t?t.getTime():null}let pF=hF=class extends iF{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return dF(e.max)}writeMax(t,e){e.max=fF(t)}readMin(t,e){return dF(e.min)}writeMin(t,e){e.min=fF(t)}clone(){return new hF({includeTime:this.includeTime,max:this.max,min:this.min,type:this.type})}};e([Hn({type:Boolean,json:{write:!0}})],pF.prototype,"includeTime",void 0),e([Hn({type:Date,json:{type:Number,write:!0}})],pF.prototype,"max",void 0),e([Rh("max")],pF.prototype,"readMax",null),e([fh("max")],pF.prototype,"writeMax",null),e([Hn({type:Date,json:{type:Number,write:!0}})],pF.prototype,"min",void 0),e([Rh("min")],pF.prototype,"readMin",null),e([fh("min")],pF.prototype,"writeMin",null),e([Hn({type:["datetime-picker"],json:{read:!1,write:!0}})],pF.prototype,"type",void 0),pF=hF=e([_r("esri.form.elements.inputs.DateTimePickerInput")],pF);const yF=pF;var mF;let gF=mF=class extends iF{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!1,this.type="radio-buttons"}clone(){return new mF({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};e([Hn({type:String,json:{write:!0}})],gF.prototype,"noValueOptionLabel",void 0),e([Hn({type:Boolean,json:{write:!0}})],gF.prototype,"showNoValueOption",void 0),e([Hn({type:["radio-buttons"],json:{read:!1,write:!0}})],gF.prototype,"type",void 0),gF=mF=e([_r("esri.form.elements.inputs.RadioButtonsInput")],gF);const vF=gF;var wF;let bF=wF=class extends iF{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new wF({offValue:this.offValue,onValue:this.onValue})}};e([Hn({type:[String,Number],json:{write:!0}})],bF.prototype,"offValue",void 0),e([Hn({type:[String,Number],json:{write:!0}})],bF.prototype,"onValue",void 0),e([Hn({type:["switch"],json:{read:!1,write:!0}})],bF.prototype,"type",void 0),bF=wF=e([_r("esri.form.elements.inputs.SwitchInput")],bF);const MF=bF;var SF;let xF=SF=class extends nF{constructor(t){super(t),this.type="text-area"}clone(){return new SF({maxLength:this.maxLength,minLength:this.minLength})}};e([Hn({type:["text-area"],json:{read:!1,write:!0}})],xF.prototype,"type",void 0),xF=SF=e([_r("esri.form.elements.inputs.TextAreaInput")],xF);const kF=xF;var IF;let jF=IF=class extends nF{constructor(t){super(t),this.type="text-box"}clone(){return new IF({maxLength:this.maxLength,minLength:this.minLength})}};e([Hn({type:["text-box"],json:{read:!1,write:!0}})],jF.prototype,"type",void 0),jF=IF=e([_r("esri.form.elements.inputs.TextBoxInput")],jF);const _F={base:iF,key:"type",typeMap:{"barcode-scanner":aF,"combo-box":cF,"datetime-picker":yF,"radio-buttons":vF,switch:MF,"text-area":kF,"text-box":jF}},TF={key:"type",base:c_,typeMap:{range:w_,"coded-value":f_,inherited:m_}};function OF(t){if(!t||!t.type)return null;switch(t.type){case"range":return w_.fromJSON(t);case"codedValue":return f_.fromJSON(t);case"inherited":return m_.fromJSON(t)}return null}var AF;let FF=AF=class extends JA{constructor(t){super(t),this.domain=null,this.editable=!0,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field"}clone(){return new AF({description:this.description,domain:this.domain,editable:this.editable,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,visibilityExpression:this.visibilityExpression})}};e([Hn({types:TF,json:{read:{reader:OF},write:!0}})],FF.prototype,"domain",void 0),e([Hn({type:Boolean,json:{write:!0}})],FF.prototype,"editable",void 0),e([Hn({type:String,json:{write:!0}})],FF.prototype,"fieldName",void 0),e([Hn({type:String,json:{write:!0}})],FF.prototype,"hint",void 0),e([Hn({types:_F,json:{read:{source:"inputType"},write:{target:"inputType"}}})],FF.prototype,"input",void 0),e([Hn({type:String,json:{write:!0}})],FF.prototype,"requiredExpression",void 0),e([Hn({type:String,json:{read:!1,write:!0}})],FF.prototype,"type",void 0),FF=AF=e([_r("esri.form.elements.FieldElement")],FF);const CF=FF;var PF;let EF=PF=class extends JA{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editable=!0,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new PF({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editable:this.editable,label:this.label,orderByFields:H(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};e([Hn({type:Number,json:{write:!0}})],EF.prototype,"displayCount",void 0),e([Hn({type:["list"],json:{write:!0}})],EF.prototype,"displayType",void 0),e([Hn({type:Boolean,json:{write:!0}})],EF.prototype,"editable",void 0),e([Hn({type:[cS],json:{write:!0}})],EF.prototype,"orderByFields",void 0),e([Hn({type:Number,json:{write:!0}})],EF.prototype,"relationshipId",void 0),e([Hn({type:["relationship"],json:{read:!1,write:!0}})],EF.prototype,"type",void 0),EF=PF=e([_r("esri.form.elements.RelationshipElement")],EF);const LF=EF;function RF(t){return{typesWithGroup:{base:JA,key:"type",typeMap:{attachment:tF,field:CF,group:t,relationship:LF}},typesWithoutGroup:{base:JA,key:"type",typeMap:{attachment:tF,field:CF,relationship:LF}}}}function NF(t,e,i=!0){if(!t)return null;const s=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter((t=>s[t.type])).map((t=>s[t.type].fromJSON(t)))}function DF(t,e,i=!0){if(!t)return null;const s=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter((t=>s[t.type])).map((t=>t.toJSON()))}function VF(t,e,i=!0){return t?t.map((t=>zn(i?e.typesWithGroup:e.typesWithoutGroup,t))):null}var $F;let zF=$F=class extends JA{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return VF(t,GF,!1)}readElements(t,e){return NF(e.formElements,GF,!1)}writeElements(t,e){e.formElements=DF(t,GF,!1)}clone(){return new $F({description:this.description,elements:H(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};e([Hn({json:{write:!0}})],zF.prototype,"elements",void 0),e([xa("elements")],zF.prototype,"castElements",null),e([Rh("elements",["formElements"])],zF.prototype,"readElements",null),e([fh("elements")],zF.prototype,"writeElements",null),e([Hn({type:["collapsed","expanded"],json:{write:!0}})],zF.prototype,"initialState",void 0),e([Hn({type:String,json:{read:!1,write:!0}})],zF.prototype,"type",void 0),zF=$F=e([_r("esri.form.elements.GroupElement")],zF);const GF=RF(zF);var UF;const qF=RF(zF);let BF=UF=class extends lh{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.title=null}castElements(t){return VF(t,qF)}readElements(t,e){return NF(e.formElements,qF)}writeElements(t,e){e.formElements=DF(t,qF)}clone(){return new UF({description:this.description,expressionInfos:H(this.expressionInfos),elements:H(this.elements),title:this.title})}};e([Hn({type:String,json:{write:!0}})],BF.prototype,"description",void 0),e([Hn({json:{write:!0}})],BF.prototype,"elements",void 0),e([xa("elements")],BF.prototype,"castElements",null),e([Rh("elements",["formElements"])],BF.prototype,"readElements",null),e([fh("elements")],BF.prototype,"writeElements",null),e([Hn({type:[WA],json:{write:!0}})],BF.prototype,"expressionInfos",void 0),e([Hn({type:String,json:{write:!0}})],BF.prototype,"title",void 0),BF=UF=e([_r("esri.form.FormTemplate")],BF);const WF=BF;var HF;const JF=wo()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),ZF=JF.jsonValues.slice();N(ZF,"orthometric");const QF=wo()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let KF=HF=class extends lh{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,i){return JF.write(t,e,i)}readHeightModel(t,e,i){return JF.read(t)||(i&&i.messages&&i.messages.push(function(t,e){return new Qn("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}(t,{context:i})),null)}readHeightUnit(t,e,i){return QF.read(t)||(i&&i.messages&&i.messages.push(YF(t,{context:i})),null)}readHeightUnitService(t,e,i){return Em(t)||QF.read(t)||(i&&i.messages&&i.messages.push(YF(t,{context:i})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new HF({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const i=function(t){return Rm(t)>=(t instanceof Lh?vm(t).metersPerDegree:1e5)?"meters":$m(t)}(e);return new HF({heightModel:t.heightModel,heightUnit:i,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new HF;return e.read(t,{origin:"web-scene"}),e}};function YF(t,e){return new Qn("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}e([Hn({type:JF.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:ZF,default:"ellipsoidal"}}}})],KF.prototype,"heightModel",void 0),e([fh("web-scene","heightModel")],KF.prototype,"writeHeightModel",null),e([Rh(["web-scene","service"],"heightModel")],KF.prototype,"readHeightModel",null),e([Hn({type:QF.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:QF.jsonValues,write:QF.write}}}})],KF.prototype,"heightUnit",void 0),e([Rh("web-scene","heightUnit")],KF.prototype,"readHeightUnit",null),e([Rh("service","heightUnit")],KF.prototype,"readHeightUnitService",null),e([Hn({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],KF.prototype,"vertCRS",void 0),e([Rh("service","vertCRS",["vertCRS","ellipsoid","geoid"])],KF.prototype,"readVertCRS",null),KF=HF=e([_r("esri.geometry.HeightModelInfo")],KF);const XF=KF;let tC=0;const eC=ct.getLogger("esri.layers.Layer");let iC=class extends(Cr.EventedMixin(yS(Bc))){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new Ld(-180,-90,180,90,Lh.WGS84),this.id=Date.now().toString(16)+"-layer-"+tC++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=Lh.WGS84,this.title=null,this.type=null,this.url=null,this.visible=!0}static async fromArcGISServerUrl(t){const e="string"==typeof t?{url:t}:t,i=await import("./p-2bb6ae98.js");try{return await i.fromUrl(e)}catch(t){throw eC.error("#fromArcGISServerUrl({ url: '"+e.url+"'})","Failed to create layer from arcgis server url",t),t}}static async fromPortalItem(t){const e="portalItem"in t?t:{portalItem:t},i=await import("./p-17a36cbe.js");try{return await i.fromItem(e)}catch(t){const i=e&&e.portalItem;throw eC.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+(i&&i.portal&&i.portal.url||it.portalUrl)+"', id: '"+(i&&i.id||"unset")+"')",t),t}}initialize(){this.when().catch((t=>{var e,i;Ge(t)||ct.getLogger(this.declaredClass).error("#load()",`Failed to load layer (title: '${null!=(e=this.title)?e:"no title"}', id: '${null!=(i=this.id)?i:"no id"}')`,{error:t})}))}destroy(){if(this.parent){const t=this,e=this.parent;"layers"in e&&e.layers.includes(t)?e.layers.remove(t):"tables"in e&&e.tables.includes(t)?e.tables.remove(t):"baseLayers"in e&&e.baseLayers.includes(t)?e.baseLayers.remove(t):"baseLayers"in e&&e.referenceLayers.includes(t)&&e.referenceLayers.remove(t)}}get hasAttributionData(){return null!=this.attributionDataUrl}get parsedUrl(){const t=this.url;return t?Tt(t):null}async fetchAttributionData(){const t=this.attributionDataUrl;if(this.hasAttributionData&&t)return(await oi(t,{query:{f:"json"},responseType:"json"})).data;throw new dt("layer:no-attribution-data","Layer does not have attribution data")}};e([Hn({type:String})],iC.prototype,"attributionDataUrl",void 0),e([Hn({type:Ld})],iC.prototype,"fullExtent",void 0),e([Hn({readOnly:!0})],iC.prototype,"hasAttributionData",null),e([Hn({type:String})],iC.prototype,"id",void 0),e([Hn({type:Boolean,nonNullable:!0})],iC.prototype,"legendEnabled",void 0),e([Hn({type:["show","hide","hide-children"]})],iC.prototype,"listMode",void 0),e([Hn({type:Number,range:{min:0,max:1},nonNullable:!0})],iC.prototype,"opacity",void 0),e([Hn()],iC.prototype,"parent",void 0),e([Hn({readOnly:!0})],iC.prototype,"parsedUrl",null),e([Hn({type:Boolean})],iC.prototype,"popupEnabled",void 0),e([Hn({type:Boolean})],iC.prototype,"attributionVisible",void 0),e([Hn({type:Lh})],iC.prototype,"spatialReference",void 0),e([Hn({type:String})],iC.prototype,"title",void 0),e([Hn({type:String,readOnly:!0,json:{read:!1}})],iC.prototype,"type",void 0),e([Hn()],iC.prototype,"url",void 0),e([Hn({type:Boolean,nonNullable:!0})],iC.prototype,"visible",void 0),iC=e([_r("esri.layers.Layer")],iC);const sC=iC;var nC;!function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.OPEN=1]="OPEN",t[t.OPENED=2]="OPENED",t[t.RESPONSE=3]="RESPONSE",t[t.INVOKE=4]="INVOKE",t[t.ABORT=5]="ABORT",t[t.CLOSE=6]="CLOSE",t[t.OPEN_PORT=7]="OPEN_PORT",t[t.ON=8]="ON"}(nC||(nC={}));let rC=0;function oC(){return rC++}function aC(t){return t?JSON.stringify("string"==typeof t?{name:"message",message:t}:t.toJSON?t:{name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function lC(t,e,i,s){if(e.type===nC.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==nC.INVOKE&&e.type!==nC.RESPONSE)return void t.postMessage(e);let n;!function(t){return t&&"object"==typeof t&&("result"in t||"transferList"in t)}(i)?(n=cC(s),e.data=i):(n=cC(i.transferList),e.data=i.result),n?t.postMessage(e,n):t.postMessage(e)}function uC(t){if(!t)return null;const e=t.data;return e?"string"==typeof e?JSON.parse(e):e:null}function cC(t){if(!t||!t.length)return null;if(l("esri-workers-arraybuffer-transfer"))return t;const e=t.filter((t=>!function(t){return t instanceof ArrayBuffer||t&&t.constructor&&"ArrayBuffer"===t.constructor.name}(t)));return e.length?e:null}const hC={statsWorker:()=>import("./p-43743173.js"),geometryEngineWorker:()=>import("./p-ad7e0ffd.js"),CSVSourceWorker:()=>import("./p-e814e1f9.js"),EdgeProcessingWorker:()=>import("./p-4488b27f.js"),ElevationSamplerWorker:()=>import("./p-7791a499.js"),FeatureServiceSnappingSourceWorker:()=>import("./p-559cd771.js"),GeoJSONSourceWorker:()=>import("./p-e8e5d5a8.js"),LercWorker:()=>import("./p-4bb28914.js"),MemorySourceWorker:()=>import("./p-e8c61d1b.js"),PBFDecoderWorker:()=>import("./p-c92aba96.js"),Pipeline:()=>import("./p-4098fe99.js"),PointCloudWorker:()=>import("./p-cd94adcf.js"),RasterWorker:()=>import("./p-b82e8e67.js"),SceneLayerWorker:()=>import("./p-877ab19f.js"),WFSSourceWorker:()=>import("./p-40788336.js"),WorkerTileHandler:()=>import("./p-90c10741.js")},{CLOSE:dC,ABORT:fC,INVOKE:pC,RESPONSE:yC,OPEN_PORT:mC,ON:gC}=nC;class vC{constructor(t){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=t,this._timer=null,this._process=this._process.bind(this)}push(t){t.type===nC.ABORT?this._cancelledJobIds.add(t.jobId):(this._invokeMessages.push(t),null===this._timer&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const t of this._invokeMessages)this._cancelledJobIds.has(t.jobId)||this._invoke(t);this._cancelledJobIds.clear(),this._invokeMessages.length=0}}class wC{constructor(t,e){this._port=t,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new vC((t=>this._onInvokeMessage(t))),this._client=e.client,this._onMessage=this._onMessage.bind(this),this._channel=e.channel,this._schedule=e.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}static connect(t){const e=new MessageChannel;let i;i="function"==typeof t?new t:"default"in t&&"function"==typeof t.default?new t.default:t;const s=new wC(e.port1,{channel:e,client:i});return"object"==typeof i&&"remoteClient"in i&&(i.remoteClient=s),wC.clients.set(s,i),e.port2}static loadWorker(t){const e=hC[t];return e?e():Promise.resolve(null)}close(){this._post({type:dC}),this._close()}isBusy(){return this._outJobs.size>0}invoke(t,e,i){const s=i&&i.signal,n=i&&i.transferList;if(!this._port)return Promise.reject(new dt("worker:port-closed",`Cannot call invoke('${t}'), port is closed`,{methodName:t,data:e}));const r=oC();return new Promise(((i,o)=>{const a=$e(s,(()=>{var t;const e=this._outJobs.get(r);e&&(this._outJobs.delete(r),null==(t=e.abortHandle)||t.remove(),this._post({type:fC,jobId:r}),o(Pe()))}));this._outJobs.set(r,{resolve:i,reject:o,abortHandle:a,debugInfo:t}),this._post({type:pC,jobId:r,methodName:t,abortable:null!=s},e,n)}))}on(t,e){const i=new MessageChannel;function s(t){e(t.data)}return this._port.postMessage({type:nC.ON,eventType:t,port:i.port2},[i.port2]),i.port1.addEventListener("message",s),i.port1.start(),{remove(){i.port1.postMessage({type:nC.CLOSE}),i.port1.close(),i.port1.removeEventListener("message",s)}}}openPort(){const t=new MessageChannel;return this._post({type:mC,port:t.port2}),t.port1}_close(){this._channel&&(this._channel=null),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((t=>{var e;null==(e=t.abortHandle)||e.remove(),t.reject(Pe(`Worker closing, aborting job calling '${t.debugInfo}'`))})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=this._client=this._schedule=null}_onMessage(t){u(this._schedule)?this._schedule((()=>this._processMessage(t))):this._processMessage(t)}_processMessage(t){const e=uC(t);if(e)switch(e.type){case yC:this._onResponseMessage(e);break;case pC:this._invokeQueue.push(e);break;case fC:this._onAbortMessage(e);break;case dC:this._onCloseMessage();break;case mC:this._onOpenPortMessage(e);break;case gC:this._onOnMessage(e)}}_onAbortMessage(t){const e=this._inJobs,i=t.jobId,s=e.get(i);this._invokeQueue.push(t),s&&(s.controller&&s.controller.abort(),e.delete(i))}_onCloseMessage(){const t=this._client;this._close(),t&&"destroy"in t&&wC.clients.get(this)===t&&t.destroy(),wC.clients.delete(this),t&&t.remoteClient&&(t.remoteClient=null)}_onInvokeMessage(t){const{methodName:e,jobId:i,data:s,abortable:n}=t,r=n?new AbortController:null,o=this._inJobs;let a,l=this._client,u=l[e];try{if(!u&&e&&-1!==e.indexOf(".")){const t=e.split(".");for(let e=0;e<t.length-1;e++)l=l[t[e]],u=l[t[e+1]]}if("function"!=typeof u)throw new TypeError(e+" is not a function");a=u.call(l,s,{client:this,signal:r?r.signal:null})}catch(t){return void this._post({type:yC,jobId:i,error:aC(t)})}Qe(a)?(o.set(i,{controller:r,promise:a}),a.then((t=>{o.has(i)&&(o.delete(i),this._post({type:yC,jobId:i},t))}),(t=>{o.has(i)&&(o.delete(i),Ge(t)||this._post({type:yC,jobId:i,error:aC(t||{message:"Error encountered at method "+e})}))}))):this._post({type:yC,jobId:i},a)}_onOpenPortMessage(t){new wC(t.port,{client:this._client})}_onOnMessage(t){const{port:e}=t,i=this._client.on(t.eventType,(t=>{e.postMessage(t)})),s=je(t.port,"message",(t=>{uC(t).type===nC.CLOSE&&(s.remove(),i.remove(),e.close())}))}_onResponseMessage(t){var e;const{jobId:i,error:s,data:n}=t,r=this._outJobs;if(!r.has(i))return;const o=r.get(i);r.delete(i),null==(e=o.abortHandle)||e.remove(),s?o.reject(dt.fromJSON(JSON.parse(s))):o.resolve(n)}_post(t,e,i){return lC(this._port,t,e,i)}}wC.kernelInfo={revision:et,version:"4.22",buildDate:tt},wC.clients=new Map;const bC=ct.getLogger("esri.core.workers.Connection");class MC{constructor(){this._clients=[],this._clientPromises=[],this._clientIdx=0}destroy(){this.close()}get closed(){return!this._clients||!this._clients.length}open(t,e){return new Promise(((i,s)=>{let n=!0;const r=t=>{Ee(e.signal),n&&(n=!1,t())};this._clients.length=t.length,this._clientPromises.length=t.length;for(let n=0;n<t.length;++n){const o=t[n];Qe(o)?this._clientPromises[n]=o.then((t=>(this._clients[n]=new wC(t,e),r(i),this._clients[n])),(()=>(r(s),null))):(this._clients[n]=new wC(o,e),this._clientPromises[n]=Promise.resolve(this._clients[n]),r(i))}}))}broadcast(t,e,i){const s=Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n)s[n]=this._clientPromises[n].then((s=>s.invoke(t,e,i)));return s}close(){for(const t of this._clientPromises)t.then((t=>t.close()));this._clients.length=0,this._clientPromises.length=0}getAvailableClient(){let t;for(let e=0;e<this._clients.length;++e){const i=this._clients[e];if(i){if(!i.isBusy())return Promise.resolve(i)}else t=t||[],t.push(this._clientPromises[e])}return t?Promise.race(t):(this._clientIdx=(this._clientIdx+1)%this._clients.length,Promise.resolve(this._clients[this._clientIdx]))}invoke(t,e,i){let s=null;return Array.isArray(i)?(bC.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),s={transferList:i}):s=i,this.closed?Promise.reject(Error("Connection closed")):this.getAvailableClient().then((i=>i.invoke(t,e,s)))}on(t,e){return Promise.all(this._clientPromises).then((()=>Ai(this._clients.map((i=>i.on(t,e))))))}openPorts(){return new Promise((t=>{const e=Array(this._clientPromises.length);let i=e.length;for(let s=0;s<this._clientPromises.length;++s)this._clientPromises[s].then((n=>{e[s]=n.openPort(),0==--i&&t(e)}))}))}get test(){return{numClients:this._clients.length}}}const SC={};class xC{constructor(){const t=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((e=>{this[e]=(...i)=>t[e](...i)}))}}const kC=i.MutationObserver||i.WebKitMutationObserver,IC=function(){let t;if(i.process&&i.process.nextTick)t=t=>{i.process.nextTick(t)};else if(i.Promise)t=t=>{i.Promise.resolve().then(t)};else if(kC){const e=[],i=document.createElement("div");new kC((()=>{for(;e.length>0;)e.shift()()})).observe(i,{attributes:!0}),t=t=>{e.push(t),i.setAttribute("queueStatus","1")}}return t}(),jC=(()=>{const t=i.MessageEvent;try{new t("message",{data:null})}catch{return(t,e={})=>{const{data:i,bubbles:s=!1,cancelable:n=!1}=e,r=document.createEvent("Event");return r.initEvent(t,s,n),r.data=i,r}}return(e,i)=>new t(e,i)})();class _C{constructor(){this._dispatcher=new xC,this._workerPostMessage({type:nC.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(t){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=t,t&&this.addEventListener("message",t)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(t){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=t,t&&this.addEventListener("messageerror",t)}get onerror(){return this._onerrorHandler}set onerror(t){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=t,t&&this.addEventListener("error",t)}postMessage(t){IC((()=>{this._workerMessageHandler(jC("message",{data:t}))}))}dispatchEvent(t){return this._dispatcher.dispatchEvent(t)}addEventListener(t,e,i){this._dispatcher.addEventListener(t,e,i)}removeEventListener(t,e,i){this._dispatcher.removeEventListener(t,e,i)}_workerPostMessage(t){IC((()=>{this.dispatchEvent(jC("message",{data:t}))}))}async _workerMessageHandler(t){const e=uC(t);if(e&&e.type===nC.OPEN){const{modulePath:t,jobId:i}=e;let s=await wC.loadWorker(t);s||(s=await import(t));const n=wC.connect(s);this._workerPostMessage({type:nC.OPENED,jobId:i,data:n})}}}const TC=ct.getLogger("esri.core.workers"),{HANDSHAKE:OC}=nC;let AC,FC;const CC="Failed to create Worker. Fallback to execute module in main thread";async function PC(t){return new Promise((e=>{function i(n){const r=uC(n);r&&r.type===OC&&(t.removeEventListener("message",i),t.removeEventListener("error",s),e(t))}function s(e){e.preventDefault(),t.removeEventListener("message",i),t.removeEventListener("error",s),TC.warn("Failed to create Worker. Fallback to execute module in main thread",e),(t=new _C).addEventListener("message",i),t.addEventListener("error",s)}t.addEventListener("message",i),t.addEventListener("error",s)}))}let EC=0;const LC=ct.getLogger("esri.core.workers"),{ABORT:RC,INVOKE:NC,OPEN:DC,OPENED:VC,RESPONSE:$C}=nC;class zC{constructor(t,e){this._outJobs=new Map,this._inJobs=new Map,this.worker=t,this.id=e,t.addEventListener("message",this._onMessage.bind(this)),t.addEventListener("error",(t=>{t.preventDefault(),LC.error(t)}))}static async create(t){const e=await async function(){if(!l("esri-workers"))return PC(new _C);if(!AC&&!FC)try{const t='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,buildDate:r,version:t}=configuration.kernelInfo,{revision:n,buildDate:i,version:s}=e.kernelInfo;o!==n&&console.warn(`[esri.core.workers] Version mismatch detected between ArcGIS API for JavaScript and assets:\nAPI version: ${t} [Date: ${r}, Revision: ${o.slice(0,8)}]\nAssets version: ${s} [Date: ${i}, Revision: ${n.slice(0,8)}]`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let e;function t(o){const t=e.connect(o);self.postMessage({type:2,jobId:r,data:t},[t])}"function"==typeof define&&define.amd?require([workerPath],(r=>{e=r.default||r,checkWorkerRevision(e),e.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((r=>(e=r.default,checkWorkerRevision(e),e.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):(self.RemoteClient||importScripts(workerPath),e=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(e),e.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const e=outgoing.get(r);outgoing.delete(r),o.error?e.reject(JSON.parse(o.error)):e.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});'.replace('"{CONFIGURATION}"',`'${function(){let t;if(null!=it.default){const e={...it};delete e.default,t=JSON.parse(JSON.stringify(e))}else t=JSON.parse(JSON.stringify(it));t.assetsPath=Ut(t.assetsPath),t.request.interceptors=[],t.log.interceptors=[],t.locale=jo(),t.has={"esri-csp-restrictions":l("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":l("esri-2d-update-debug"),"esri-2d-query-centroid-enabled":l("esri-2d-query-centroid-enabled"),"featurelayer-pbf":l("featurelayer-pbf"),"featurelayer-simplify-thresholds":l("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":l("featurelayer-simplify-payload-size-factors"),"esri-atomics":l("esri-atomics"),"esri-shared-array-buffer":l("esri-shared-array-buffer"),"esri-tiles-debug":l("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":l("esri-workers-arraybuffer-transfer"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=Ut(t.workers.loaderUrl)),t.workers.workerPath=Ut(t.workers.workerPath?t.workers.workerPath:Ii("esri/core/workers/RemoteClient.js"));const e=it.workers.loaderConfig,i=function(t){var e;const i={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages&&t.packages.concat()||[],paths:{...t.paths}};return t.hasOwnProperty("async")||(i.async=!0),t.hasOwnProperty("isDebug")||(i.isDebug=!1),t.baseUrl||(i.baseUrl=SC.baseUrl),null==(e=SC.packages)||e.forEach((t=>{!function(t,e){for(const i of t)if(i.name===e.name)return;t.push(e)}(i.packages,t)})),i}({baseUrl:null==e?void 0:e.baseUrl,locale:jo(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...null==e?void 0:e.has},map:{...null==e?void 0:e.map},paths:{...null==e?void 0:e.paths},packages:(null==e?void 0:e.packages)||[]});return JSON.stringify({esriConfig:t,loaderConfig:i,kernelInfo:{version:"4.22",buildDate:tt,revision:et}})}()}'`);AC=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}catch(t){FC=t||{}}let t;if(AC)try{t=new Worker(AC,{name:"esri-worker-"+EC++})}catch(e){TC.warn(CC,FC),t=new _C}else TC.warn(CC,FC),t=new _C;return PC(t)}();return new zC(e,t)}terminate(){this.worker.terminate()}async open(t,e={}){const{signal:i}=e,s=oC();return new Promise(((e,n)=>{const r={resolve:e,reject:n,abortHandle:$e(i,(()=>{this._outJobs.delete(s),this._post({type:RC,jobId:s})}))};this._outJobs.set(s,r),this._post({type:DC,jobId:s,modulePath:t})}))}_onMessage(t){const e=uC(t);if(e)switch(e.type){case VC:this._onOpenedMessage(e);break;case $C:this._onResponseMessage(e);break;case RC:this._onAbortMessage(e);break;case NC:this._onInvokeMessage(e)}}_onAbortMessage(t){const e=this._inJobs,i=t.jobId,s=e.get(i);s&&(s.controller&&s.controller.abort(),e.delete(i))}_onInvokeMessage(t){const{methodName:e,jobId:i,data:s,abortable:n}=t,r=n?new AbortController:null,o=this._inJobs,a=be[e];let l;try{if("function"!=typeof a)throw new TypeError(e+" is not a function");l=a.call(null,s,{signal:r?r.signal:null})}catch(t){return void this._post({type:$C,jobId:i,error:aC(t)})}Qe(l)?(o.set(i,{controller:r,promise:l}),l.then((t=>{o.has(i)&&(o.delete(i),this._post({type:$C,jobId:i},t))}),(t=>{o.has(i)&&(o.delete(i),t||(t={message:"Error encountered at method"+e}),Ge(t)||this._post({type:$C,jobId:i,error:aC(t||{message:"Error encountered at method "+e})}))}))):this._post({type:$C,jobId:i},l)}_onOpenedMessage(t){var e;const{jobId:i,data:s}=t,n=this._outJobs.get(i);n&&(this._outJobs.delete(i),null==(e=n.abortHandle)||e.remove(),n.resolve(s))}_onResponseMessage(t){var e;const{jobId:i,error:s,data:n}=t,r=this._outJobs.get(i);r&&(this._outJobs.delete(i),null==(e=r.abortHandle)||e.remove(),s?r.reject(dt.fromJSON(JSON.parse(s))):r.resolve(n))}_post(t,e,i){return lC(this.worker,t,e,i)}}let GC=l("esri-workers-debug")?1:l("host-browser")?navigator.hardwareConcurrency-1:0;GC||(GC=l("safari")&&l("mac")||l("trident")?7:2);let UC=0;const qC=[];async function BC(t,e){const i=new MC;return await i.open(t,e),i}async function WC(t,e={}){if("string"!=typeof t)throw new dt("workers:undefined-module","modulePath is missing");let i=e.strategy||"distributed";if(l("host-webworker")&&!l("esri-workers")&&(i="local"),"local"===i){let i=await wC.loadWorker(t);i||(i=await import(t)),Ee(e.signal);const s=e.client||i;return BC([wC.connect(i)],{...e,client:s})}if(await JC(),Ee(e.signal),"dedicated"===i){const i=UC++%GC;return BC([await qC[i].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const i=Math.min(e.maxNumWorkers,GC);if(i<GC){const s=Array(i);for(let n=0;n<i;++n){const i=UC++%GC;s[n]=qC[i].open(t,e)}return BC(s,e)}}return BC(qC.map((i=>i.open(t,e))),e)}let HC=null;async function JC(){if(HC)return HC;new AbortController;const t=[];for(let e=0;e<GC;e++){const i=zC.create(e).then((t=>(qC[e]=t,t)));t.push(i)}return HC=Promise.all(t),HC}function ZC(t,e,i){if(c(e)||c(i)||i.vcsWkid||Mh(e,i))return null;const s=Lm(e)/Lm(i);if(1===s)return null;switch(t){case"point":case"esriGeometryPoint":return t=>function(t,e){t&&null!=t.z&&(t.z*=e)}(t,s);case"polyline":case"esriGeometryPolyline":return t=>function(t,e){if(t)for(const i of t.paths)for(const t of i)t.length>2&&(t[2]*=e)}(t,s);case"polygon":case"esriGeometryPolygon":return t=>function(t,e){if(t)for(const i of t.rings)for(const t of i)t.length>2&&(t[2]*=e)}(t,s);case"multipoint":case"esriGeometryMultipoint":return t=>function(t,e){if(t)for(const i of t.points)i.length>2&&(i[2]*=e)}(t,s);default:return null}}function QC(t,e,i){if(null==t.hasM||t.hasZ)for(const t of e)for(const e of t)e.length>2&&(e[2]*=i)}function KC(t,e,i){if(!t&&!e||!i)return;const s=Lm(i);YC(t,i,s),YC(e,i,s)}function YC(t,e,i){if(t)for(const s of t)XC(s.geometry,e,i)}function XC(t,e,i){if(c(t)||!t.spatialReference||Mh(t.spatialReference,e))return;const s=Lm(t.spatialReference)/i;if(1!==s)if("x"in t)null!=t.z&&(t.z*=s);else if("rings"in t)QC(t,t.rings,s);else if("paths"in t)QC(t,t.paths,s);else if("points"in t&&(null==t.hasM||t.hasZ))for(const e of t.points)e.length>2&&(e[2]*=s)}function tP(t,e,i){if(!i||!i.features||!i.hasZ)return;const s=ZC(i.geometryType,e,t.outSpatialReference);if(!c(s))for(const t of i.features)s(t.geometry)}const eP=new vo({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"});var iP;const sP=new vo({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let nP=iP=class extends lh{constructor(t){super(t),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=-1,this.name=null,this.nullable=!0,this.type=null,this.valueType=null}readDescription(t,{description:e}){let i;try{i=JSON.parse(e)}catch(t){}return i?i.value:null}readValueType(t,{description:e}){let i;try{i=JSON.parse(e)}catch(t){}return i?sP.fromJSON(i.fieldValueType):null}clone(){return new iP({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})}};e([Hn({type:String,json:{write:!0}})],nP.prototype,"alias",void 0),e([Hn({type:[String,Number],json:{write:{allowNull:!0}}})],nP.prototype,"defaultValue",void 0),e([Hn()],nP.prototype,"description",void 0),e([Rh("description")],nP.prototype,"readDescription",null),e([Hn({types:TF,json:{read:{reader:OF},write:!0}})],nP.prototype,"domain",void 0),e([Hn({type:Boolean,json:{write:!0}})],nP.prototype,"editable",void 0),e([Hn({type:Gn,json:{write:!0}})],nP.prototype,"length",void 0),e([Hn({type:String,json:{write:!0}})],nP.prototype,"name",void 0),e([Hn({type:Boolean,json:{write:!0}})],nP.prototype,"nullable",void 0),e([lM(eP)],nP.prototype,"type",void 0),e([Hn()],nP.prototype,"valueType",void 0),e([Rh("valueType",["description"])],nP.prototype,"readValueType",null),nP=iP=e([_r("esri.layers.support.Field")],nP);const rP=nP,oP=new vo({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let aP=class extends lh{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){const i=Lh.fromJSON(e.spatialReference),s=[];for(let e=0;e<t.length;e++){const n=t[e],r=s_.fromJSON(n),o=n.geometry&&n.geometry.spatialReference;u(r.geometry)&&!o&&(r.geometry.spatialReference=i),s.push(r)}return s}writeGeometryType(t,e,i,s){if(t)return void oP.write(t,e,i,s);const{features:n}=this;if(n)for(const t of n)if(t&&u(t.geometry))return void oP.write(t.geometry.type,e,i,s)}readQueryGeometry(t,e){if(!t)return null;const i=!!t.spatialReference,s=Qw(t);return!i&&e.spatialReference&&(s.spatialReference=Lh.fromJSON(e.spatialReference)),s}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:i}=this;if(i)for(const t of i)if(t&&u(t.geometry)&&t.geometry.spatialReference)return void(e.spatialReference=t.geometry.spatialReference.toJSON())}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let i=0;i<e.features.length;i++){const s=e.features[i];if(s.geometry){const e=t&&t[i];s.geometry=e&&e.toJSON()||s.geometry}}return e}quantize(t){const{scale:[e,i],translate:[s,n]}=t,r=this.features,o=this._getQuantizationFunction(this.geometryType,(t=>Math.round((t-s)/e)),(t=>Math.round((n-t)/i)));for(let t=0,e=r.length;t<e;t++)o(r[t].geometry)||(r.splice(t,1),t--,e--);return this.transform=t,this}unquantize(){const{geometryType:t,features:e,transform:i}=this;if(!i)return this;const{translate:[s,n],scale:[r,o]}=i,a=this._getHydrationFunction(t,(t=>t*r+s),(t=>n-t*o));for(const{geometry:t}of e)u(t)&&a(t);return this.transform=null,this}_quantizePoints(t,e,i){let s,n;const r=[];for(let o=0,a=t.length;o<a;o++){const a=t[o];if(o>0){const t=e(a[0]),o=i(a[1]);t===s&&o===n||(r.push([t-s,o-n]),s=t,n=o)}else s=e(a[0]),n=i(a[1]),r.push([s,n])}return r.length>0?r:null}_getQuantizationFunction(t,e,i){return"point"===t?t=>(t.x=e(t.x),t.y=i(t.y),t):"polyline"===t||"polygon"===t?t=>{const s=Zw(t)?t.rings:t.paths,n=[];for(let t=0,r=s.length;t<r;t++){const r=this._quantizePoints(s[t],e,i);r&&n.push(r)}return n.length>0?(Zw(t)?t.rings=n:t.paths=n,t):null}:"multipoint"===t?t=>{const s=this._quantizePoints(t.points,e,i);return s.length>0?(t.points=s,t):null}:"extent"===t?t=>t:null}_getHydrationFunction(t,e,i){return"point"===t?t=>{t.x=e(t.x),t.y=i(t.y)}:"polyline"===t||"polygon"===t?t=>{const s=Zw(t)?t.rings:t.paths;let n,r;for(let t=0,o=s.length;t<o;t++){const o=s[t];for(let t=0,s=o.length;t<s;t++){const s=o[t];t>0?(n+=s[0],r+=s[1]):(n=s[0],r=s[1]),s[0]=e(n),s[1]=i(r)}}}:"extent"===t?t=>{t.xmin=e(t.xmin),t.ymin=i(t.ymin),t.xmax=e(t.xmax),t.ymax=i(t.ymax)}:"multipoint"===t?t=>{const s=t.points;let n,r;for(let t=0,o=s.length;t<o;t++){const o=s[t];t>0?(n+=o[0],r+=o[1]):(n=o[0],r=o[1]),o[0]=e(n),o[1]=i(r)}}:void 0}};e([Hn({type:String,json:{write:!0}})],aP.prototype,"displayFieldName",void 0),e([Hn({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],aP.prototype,"exceededTransferLimit",void 0),e([Hn({type:[s_],json:{write:!0}})],aP.prototype,"features",void 0),e([Rh("features")],aP.prototype,"readFeatures",null),e([Hn({type:[rP],json:{write:!0}})],aP.prototype,"fields",void 0),e([Hn({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:oP.read}}})],aP.prototype,"geometryType",void 0),e([fh("geometryType")],aP.prototype,"writeGeometryType",null),e([Hn({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],aP.prototype,"hasM",void 0),e([Hn({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],aP.prototype,"hasZ",void 0),e([Hn({types:tb,json:{write:!0}})],aP.prototype,"queryGeometry",void 0),e([Rh("queryGeometry")],aP.prototype,"readQueryGeometry",null),e([Hn({type:Lh,json:{write:!0}})],aP.prototype,"spatialReference",void 0),e([fh("spatialReference")],aP.prototype,"writeSpatialReference",null),e([Hn({json:{write:!0}})],aP.prototype,"transform",void 0),aP=e([_r("esri.rest.support.FeatureSet")],aP),aP.prototype.toJSON.isDefaultToJSON=!0;const lP=aP,uP=Object.freeze({__proto__:null,default:lP});let cP=0;const hP=ct.getLogger("esri.layers.graphics.sources.MemorySource");let dP=class extends(Bc.LoadableMixin(ma(zw(Jr)))){constructor(t){super(t),this._idToClientGraphic=null,this.type="memory"}load(t){const e=u(t)?t.signal:null;return this.addResolvingPromise(this._startWorker(e)),Promise.resolve(this)}destroy(){var t;null==(t=this._connection)||t.close(),this._connection=null}get workerGeometryType(){var t;const e=null==(t=this.layer)?void 0:t.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(t){return this.load().then((()=>this._applyEdits(t)))}openPorts(){return this.load().then((()=>this._connection.openPorts()))}async queryFeatures(t,e={}){await this.load(e);const i=await this._connection.invoke("queryFeatures",t?t.toJSON():null,e);tP(t,this.layer.spatialReference,i);const s=lP.fromJSON(i);if(!this._requiresClientGraphicMapping())return s;const n=this.layer.objectIdField;for(const t of s.features){const e=this._idToClientGraphic.get(t.attributes[n]);e&&(t.geometry=e.geometry)}return s.geometryType=this.layer.geometryType,s}async queryFeaturesJSON(t,e={}){if(this._requiresClientGraphicMapping())throw new dt("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(e);const i=await this._connection.invoke("queryFeatures",t?t.toJSON():null,e);return tP(t,this.layer.spatialReference,i),i}queryFeatureCount(t,e={}){return this.load(e).then((()=>this._connection.invoke("queryFeatureCount",t?t.toJSON():null,e)))}queryObjectIds(t,e={}){return this.load(e).then((()=>this._connection.invoke("queryObjectIds",t?t.toJSON():null,e)))}queryExtent(t,e={}){return this.load(e).then((()=>this._connection.invoke("queryExtent",t?t.toJSON():null,e))).then((t=>({count:t.count,extent:Ld.fromJSON(t.extent)})))}querySnapping(t,e={}){return this.load(e).then((()=>this._connection.invoke("querySnapping",t,e)))}async _applyEdits(t){if(!this._connection)throw new dt("feature-layer-source:edit-failure","Memory source not loaded");const e=this.layer.objectIdField;let i=null;const s=[],n=[];await Promise.all([this._prepareClientMapping(t.addFeatures,null),this._prepareClientMapping(t.updateFeatures,null)]);const r=t=>"objectId"in t&&null!=t.objectId?t.objectId:"attributes"in t&&null!=t.attributes[e]?t.attributes[e]:null;if(t.addFeatures&&(i=this._prepareAddFeatures(t.addFeatures)),t.deleteFeatures)for(const e of t.deleteFeatures){const t=r(e);null!=t&&s.push(t)}const o=t.updateFeatures&&this._idToClientGraphic?new Map:null;if(t.updateFeatures)for(const e of t.updateFeatures)if(n.push(this._serializeFeature(e)),o){const t=r(e);null!=t&&o.set(t,e)}KC(i?i.features:null,n,this.layer.spatialReference);const{fullExtent:a,featureEditResults:l}=await this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:n,deletes:s});return this.fullExtent=a,i&&i.finish(l.uidToObjectId),this._updateClientGraphicIds(o,l),this._createEditsResult(l)}async _prepareClientMapping(t,e){if("mesh"!==this.layerOrSourceGeometryType||c(t))return;const i=[];for(const{geometry:s}of t)!u(s)||"mesh"!==s.type||s.hasExtent||s.loaded||i.push(s.load({signal:e}));i.length&&await Promise.all(i)}_updateClientGraphicIds(t,e){if(this._idToClientGraphic){if(t)for(const i of e.updateResults){if(!i.success)continue;const e=t.get(i.objectId);null!=e&&this._addIdToClientGraphic(e)}for(const t of e.deleteResults)t.success&&this._idToClientGraphic.delete(t.objectId)}}_createEditsResult(t){return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(t){const e=!0===t.success?null:t.error||{code:void 0,description:void 0};return{objectId:t.objectId,globalId:t.globalId,error:e?new dt("feature-layer-source:edit-failure",e.description,{code:e.code}):null}}_prepareAddFeatures(t){const e=new Map,i=Array(t.length);let s=null;for(let n=0;n<t.length;n++){const r=t[n],o=this._serializeFeature(r);!s&&u(r.geometry)&&(s=r.geometry.type),i[n]=o,e.set(""+o.uid,r)}const n=this;return{features:i,inferredGeometryType:s,finish(t){const i=n.sourceJSON.objectIdField;for(const s in t){const r=t[s],o=e.get(s);o&&(o.attributes||(o.attributes={}),-1===r?delete o.attributes[i]:o.attributes[i]=r,n._addIdToClientGraphic(o))}}}}_addIdToClientGraphic(t){if(!this._idToClientGraphic)return;const e=t.attributes&&t.attributes[this.sourceJSON.objectIdField];null!=e&&this._idToClientGraphic.set(e,t)}get layerOrSourceGeometryType(){var t,e,i;return null!=(t=null==(e=this.layer)?void 0:e.geometryType)?t:null==(i=this.sourceJSON)?void 0:i.geometryType}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this.layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(t){return this._geometryTypeRequiresClientGraphicMapping(t.type)}_geometryTypeRequiresClientGraphicMapping(t){return"mesh"===t||"multipatch"===t||"extent"===t}_serializeFeature(t){const{attributes:e}=t,i=this._geometryForSerialization(t),s=""+cP++;return i?{uid:s,geometry:i.toJSON(),attributes:e}:{uid:s,attributes:e}}_geometryForSerialization(t){const{geometry:e}=t;return c(e)?null:this._geometryRequiresClientGraphicMapping(e)?e.extent?Xg.fromExtent(e.extent):null:e}async _startWorker(t){this._connection=await WC("MemorySourceWorker",{strategy:l("feature-layers-workers")?"dedicated":"local",signal:t});const{fields:e,spatialReference:i,objectIdField:s,hasM:n,hasZ:r,timeInfo:o}=this.layer,a="defaults"===this.layer.originOf("spatialReference");await this._prepareClientMapping(this.items,t);const u=this._prepareAddFeatures(this.items);this.handles.add(this.on("before-changes",(t=>{hP.error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),t.preventDefault()})));const c={features:u.features,fields:e&&e.map((t=>t.toJSON())),geometryType:qw.toJSON(this.workerGeometryType),hasM:"mesh"!==this.layerOrSourceGeometryType&&n,hasZ:"mesh"===this.layerOrSourceGeometryType||r,objectIdField:s,spatialReference:a?null:i&&i.toJSON(),timeInfo:o?o.toJSON():null},h=await this._connection.invoke("load",c,{signal:t});for(const t of h.warnings)hP.warn(t.message,{layer:this.layer,warning:t});h.featureErrors.length&&hP.warn(`Encountered ${h.featureErrors.length} validation errors while loading features`,h.featureErrors);const d=h.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(u.inferredGeometryType)&&(d.geometryType=qw.toJSON(u.inferredGeometryType)),this.sourceJSON=d,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),u.finish(h.assignedObjectIds)}};e([Pr({Type:s_,ensureType:Ln(s_)})],dP.prototype,"itemType",void 0),e([Hn()],dP.prototype,"type",void 0),e([Hn({constructOnly:!0})],dP.prototype,"layer",void 0),e([Hn({readOnly:!0})],dP.prototype,"workerGeometryType",null),e([Hn()],dP.prototype,"sourceJSON",void 0),dP=e([_r("esri.layers.graphics.sources.MemorySource")],dP);const fP=dP,pP=t=>{let i=class extends t{get apiKey(){var t;return this._isOverridden("apiKey")?this._get("apiKey"):function(t){return"portalItem"in t}(this)?null==(t=this.portalItem)?void 0:t.apiKey:null}set apiKey(t){null!=t?this._override("apiKey",t):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return e([Hn({type:String})],i.prototype,"apiKey",null),i=e([_r("esri.layers.mixins.APIKeyMixin")],i),i},yP={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},mP=Object.values(yP),gP=RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${mP.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),vP=RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${mP.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),wP=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function bP(t){return!!gP.test(t)}function MP(t){const e=Tt(t),i=e.path.match(gP)||e.path.match(vP);if(!i)return null;const[,s,n,r,o]=i,a=n.indexOf("/");return{title:xP(-1!==a?n.slice(a+1):n),serverType:yP[r.toLowerCase()],sublayer:null!=o&&""!==o?parseInt(o,10):null,url:{path:s}}}function SP(t){const e=Tt(t).path.match(wP);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function xP(t){return(t=t.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function kP(t,e){const i=[];if(t){const e=MP(t);u(e)&&e.title&&i.push(e.title)}if(e){const t=xP(e);i.push(t)}if(2===i.length){if(-1!==i[0].toLowerCase().indexOf(i[1].toLowerCase()))return i[0];if(-1!==i[1].toLowerCase().indexOf(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function IP(t){if(!t)return!1;const e=-1!==(t=t.toLowerCase()).indexOf(".arcgis.com/"),i=-1!==t.indexOf("//services")||-1!==t.indexOf("//tiles")||-1!==t.indexOf("//features");return e&&i}function jP(t,e){return t?ue(fe(t,e)):t}function _P(t){let{url:e}=t;if(!e)return{url:e};e=fe(e,t.logger);const i=Tt(e),s=MP(i.path);let n;if(u(s))null!=s.sublayer&&null==t.layer.layerId&&(n=s.sublayer),e=s.url.path;else if(t.nonStandardUrlAllowed){const t=SP(i.path);u(t)&&(e=t.serviceUrl,n=t.sublayerId)}return{url:ue(e),layerId:n}}function TP(t,e,i,s,n){Ok(e,s,"url",n),s.url&&null!=t.layerId&&(s.url=Wt(s.url,i,""+t.layerId))}function OP(t){if(!t)return!1;const e=t.toLowerCase(),i=-1!==e.indexOf("/services/"),s=-1!==e.indexOf("/mapserver/wmsserver"),n=-1!==e.indexOf("/imageserver/wmsserver"),r=-1!==e.indexOf("/wmsserver");return i&&(s||n||r)}function AP(t){if(!t)return!1;const e=new kt(Ut(t)).authority.toLowerCase();return"server.arcgisonline.com"===e||"services.arcgisonline.com"===e}const FP=t=>{let i=class extends t{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const t=MP(this.url);if(u(t)&&t.title)return t.title}return this._get("title")||""}set title(t){this._set("title",t)}set url(t){this._set("url",jP(t,ct.getLogger(this.declaredClass)))}};return e([Hn()],i.prototype,"title",null),e([Hn({type:String})],i.prototype,"url",null),i=e([_r("esri.layers.mixins.ArcGISService")],i),i};function CP(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}const PP=CP();Object.freeze({__proto__:null,create:CP,clone:function(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},fromValues:function(t,e,i,s,n,r,o,a,l,u,c,h,d,f,p,y){const m=new Float32Array(16);return m[0]=t,m[1]=e,m[2]=i,m[3]=s,m[4]=n,m[5]=r,m[6]=o,m[7]=a,m[8]=l,m[9]=u,m[10]=c,m[11]=h,m[12]=d,m[13]=f,m[14]=p,m[15]=y,m},createView:function(t,e){return new Float32Array(t,e,16)},IDENTITY:PP});class EP{constructor(t,e,i){this.strength=t,this.radius=e,this.threshold=i,this.type="bloom"}interpolate(t,e,i){this.strength=$P(t.strength,e.strength,i),this.radius=$P(t.radius,e.radius,i),this.threshold=$P(t.threshold,e.threshold,i)}clone(){return new EP(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:zP(this.radius),strength:this.strength,threshold:this.threshold}}}class LP{constructor(t){this.radius=t,this.type="blur"}interpolate(t,e,i){this.radius=Math.round($P(t.radius,e.radius,i))}clone(){return new LP(this.radius)}toJSON(){return{type:"blur",radius:zP(this.radius)}}}class RP{constructor(t,e){this.type=t,this.amount=e,"invert"!==this.type&&"grayscale"!==this.type&&"sepia"!==this.type||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,e,i){this.amount=$P(t.amount,e.amount,i),this._updateMatrix()}clone(){return new RP(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||CP();switch(this.type){case"brightness":this._colorMatrix=((t,e)=>{const i=ry(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return ay(i,i)})(t,this.amount);break;case"contrast":this._colorMatrix=((t,e)=>{const i=ry(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return ay(i,i)})(t,this.amount);break;case"grayscale":this._colorMatrix=(t=>{const e=1-this.amount,i=ry(t,.2126+.7874*e,.7152-.7152*e,.0722-.0722*e,0,.2126-.2126*e,.7152+.2848*e,.0722-.0722*e,0,.2126-.2126*e,.7152-.7152*e,.0722+.9278*e,0,0,0,0,1);return ay(i,i)})(t);break;case"invert":this._colorMatrix=((t,e)=>{const i=1-2*e,s=ry(t,i,0,0,e,0,i,0,e,0,0,i,e,0,0,0,1);return ay(s,s)})(t,this.amount);break;case"saturate":this._colorMatrix=((t,e)=>{const i=ry(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return ay(i,i)})(t,this.amount);break;case"sepia":this._colorMatrix=(t=>{const e=1-this.amount,i=ry(t,.393+.607*e,.769-.769*e,.189-.189*e,0,.349-.349*e,.686+.314*e,.168-.168*e,0,.272-.272*e,.534-.534*e,.131+.869*e,0,0,0,0,1);return ay(i,i)})(t)}}}class NP{constructor(t,e,i,s){this.offsetX=t,this.offsetY=e,this.blurRadius=i,this.color=s,this.type="drop-shadow"}interpolate(t,e,i){this.offsetX=$P(t.offsetX,e.offsetX,i),this.offsetY=$P(t.offsetY,e.offsetY,i),this.blurRadius=$P(t.blurRadius,e.blurRadius,i),this.color[0]=Math.round($P(t.color[0],e.color[0],i)),this.color[1]=Math.round($P(t.color[1],e.color[1],i)),this.color[2]=Math.round($P(t.color[2],e.color[2],i)),this.color[3]=$P(t.color[3],e.color[3],i)}clone(){return new NP(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];return t[3]*=255,{type:"drop-shadow",xoffset:zP(this.offsetX),yoffset:zP(this.offsetY),blurRadius:zP(this.blurRadius),color:t}}}class DP{constructor(t){this.angle=t,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,e,i){this.angle=$P(t.angle,e.angle,i),this._updateMatrix()}clone(){return new DP(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||CP();this._colorMatrix=((t,e)=>{const i=Math.sin(e*Math.PI/180),s=Math.cos(e*Math.PI/180),n=ry(t,.213+.787*s-.213*i,.715-.715*s-.715*i,.072-.072*s+.928*i,0,.213-.213*s+.143*i,.715+.285*s+.14*i,.072-.072*s-.283*i,0,.213-.213*s-.787*i,.715-.715*s+.715*i,.072+.928*s+.072*i,0,0,0,0,1);return ay(n,n)})(t,this.angle)}}class VP{constructor(t){this.amount=t,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(t,e,i){this.amount=$P(t.amount,e.amount,i)}clone(){return new VP(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}function $P(t,e,i){return t+(e-t)*i}function zP(t){return Math.round(1e3*XS(t))/1e3}function GP(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new RP(t.type,0);case"saturate":case"brightness":case"contrast":return new RP(t.type,1);case"opacity":return new VP(1);case"hue-rotate":return new DP(0);case"blur":return new LP(0);case"drop-shadow":return new NP(0,0,0,[...RS("transparent")]);case"bloom":return new EP(0,0,0)}}function UP(t,e){const i=t.length>e.length?t:e;return(t.length>e.length?e:t).every(((t,e)=>t.type===i[e].type))}function qP(t,e){const i=t.length>e.length?t:e,s=t.length>e.length?e:t;for(let t=s.length;t<i.length;t++)s.push(GP(i[t]))}var BP,WP={exports:{}};function HP(t){if(!t||0===t.length)return null;if("string"==typeof t){const e=JP(t);return e&&0!==e.length?e:null}const e=t.map((t=>{if(!Number.isFinite(t.scale)||t.scale<=0)throw new dt("effect:invalid-scale","scale must be finite and greater than 0",{stop:t});return{scale:t.scale,effects:JP(t.value)}}));e.sort(((t,e)=>e.effects.length-t.effects.length));for(let t=0;t<e.length-1;t++){if(!UP(e[t].effects,e[t+1].effects))throw new dt("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[t].effects,b:e[t+1].effects});qP(e[t].effects,e[t+1].effects)}return e.sort(((t,e)=>e.scale-t.scale)),e}function JP(t){let e;if(!t)return[];try{e=WP.exports.parse(t)}catch(e){throw new dt("effect:invalid-syntax","Invalid effect syntax",{value:t,error:e})}return e.map((t=>function(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return function(t){let e=1;return ZP(t.parameters,1),1===t.parameters.length&&(e=tE(t.parameters[0])),new RP(t.name,e)}(t);case"opacity":return function(t){let e=1;return ZP(t.parameters,1),1===t.parameters.length&&(e=tE(t.parameters[0])),new VP(e)}(t);case"hue-rotate":return function(t){let e=0;return ZP(t.parameters,1),1===t.parameters.length&&(e=function(t){return function(t){if("quantity"!==t.type||!(0===t.value&&null===t.unit||t.unit&&null!=YP[t.unit]))throw new dt("effect:type-error","Expected <angle>, Actual: "+QP(t),{term:t})}(t),t.value*YP[t.unit]||0}(t.parameters[0])),new DP(e)}(t);case"blur":return function(t){let e=0;return ZP(t.parameters,1),1===t.parameters.length&&(e=eE(t.parameters[0]),KP(e,t.parameters[0])),new LP(e)}(t);case"drop-shadow":return function(t){const e=[];let i=null;for(const s of t.parameters)if("color"===s.type){if(e.length&&Object.freeze(e),i)throw new dt("effect:type-error","Accepts only one color",{});i=iE(s)}else{const t=eE(s);if(Object.isFrozen(e))throw new dt("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(t),3===e.length&&KP(t,s)}if(e.length<2||e.length>3)throw new dt("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new NP(e[0],e[1],e[2]||0,i||sE("black"))}(t);case"bloom":return function(t){let e=1,i=0,s=0;return ZP(t.parameters,3),t.parameters[0]&&(e=tE(t.parameters[0])),t.parameters[1]&&(i=eE(t.parameters[1]),KP(i,t.parameters[1])),t.parameters[2]&&(s=tE(t.parameters[2])),new EP(e,i,s)}(t)}}catch(e){throw e.details.filter=t,e}throw new dt("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}(t)))}function ZP(t,e){if(t.length>e)throw new dt("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function QP(t){if("color"===t.type)return"<color>";if(t.unit){if(XP[t.unit])return"<length>";if(YP[t.unit])return"<angle>";if("%"===t.unit)return"<percentage>"}return"<double>"}function KP(t,e){if(t<0)throw new dt("effect:type-error","Negative values are not allowed, Actual: "+t,{term:e})}(BP=WP).exports&&(BP.exports=function(){function t(e,i,s,n){var r=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(r,t.prototype),r.expected=i,r.found=s,r.location=n,r.name="SyntaxError",r}function e(t,e,i){return i=i||" ",t.length>e?t:t+(i+=i.repeat(e-=t.length)).slice(0,e)}return function(t){function e(){this.constructor=t}e.prototype=Error.prototype,t.prototype=new e}(t),t.prototype.format=function(t){var i="Error: "+this.message;if(this.location){var s,n=null;for(s=0;s<t.length;s++)if(t[s].source===this.location.source){n=t[s].text.split(/\r\n|\n|\r/g);break}var r=this.location.start,o=this.location.source+":"+r.line+":"+r.column;if(n){var a=this.location.end,l=e("",(""+r.line).length),u=n[r.line-1],c=r.line===a.line?a.column:u.length+1;i+="\n --\x3e "+o+"\n"+l+" |\n"+r.line+" | "+u+"\n"+l+" | "+e("",r.column-1)+e("",c-r.column,"^")}else i+="\n at "+o}return i},t.buildMessage=function(t,e){var i={literal:function(t){return'"'+n(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?r(t[0])+"-"+r(t[1]):r(t)}));return"["+(t.inverted?"^":"")+e+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function s(t){return t.charCodeAt(0).toString(16).toUpperCase()}function n(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+s(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+s(t)}))}function r(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+s(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+s(t)}))}function o(t){return i[t.type](t)}return"Expected "+function(t){var e,i,s=t.map(o);if(s.sort(),s.length>0){for(e=1,i=1;e<s.length;e++)s[e-1]!==s[e]&&(s[i]=s[e],i++);s.length=i}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(t)+" but "+function(t){return t?'"'+n(t)+'"':"end of input"}(e)+" found."},{SyntaxError:t,parse:function(e,i){var s,n={},r=(i=void 0!==i?i:{}).grammarSource,o={start:ot},a=ot,l="none",u="grad",c="turn",h=/^[ \t\n\r]/,d=/^[a-z\-]/,f=/^[0-9a-fA-F]/,p=/^[+\-]/,y=/^[0-9]/,m=st("none"),g=et("none",!1),v=et(")",!1),w=et(",",!1),b=st("whitespace"),M=it([" ","\t","\n","\r"],!1,!1),S=st("function"),x=et("(",!1),k=st("identifier"),I=it([["a","z"],"-"],!1,!1),j=st("percentage"),_=et("%",!1),T=st("length"),O=et("px",!1),A=et("cm",!1),F=et("mm",!1),C=et("in",!1),P=et("pt",!1),E=et("pc",!1),L=st("angle"),R=et("deg",!1),N=et("rad",!1),D=et("grad",!1),V=et("turn",!1),$=st("number"),z=st("color"),G=et("#",!1),U=it([["0","9"],["a","f"],["A","F"]],!1,!1),q=it(["+","-"],!1,!1),B=it([["0","9"]],!1,!1),W=et(".",!1),H=et("e",!1),J=0,Z=0,Q=[{line:1,column:1}],K=0,Y=[],X=0;if("startRule"in i){if(!(i.startRule in o))throw Error("Can't start parsing from rule \""+i.startRule+'".');a=o[i.startRule]}function tt(){return e.substring(Z,J)}function et(t,e){return{type:"literal",text:t,ignoreCase:e}}function it(t,e,i){return{type:"class",parts:t,inverted:e,ignoreCase:i}}function st(t){return{type:"other",description:t}}function nt(t){var i,s=Q[t];if(s)return s;for(i=t-1;!Q[i];)i--;for(s={line:(s=Q[i]).line,column:s.column};i<t;)10===e.charCodeAt(i)?(s.line++,s.column=1):s.column++,i++;return Q[t]=s,s}function rt(t){J<K||(J>K&&(K=J,Y=[]),Y.push(t))}function ot(){var t;return(t=at())===n&&(t=function(){var t,e;if(t=[],(e=lt())!==n)for(;e!==n;)t.push(e),e=lt();else t=n;return t}()),t}function at(){var t,i;return X++,t=J,ct(),e.substr(J,4)===l?(i=l,J+=4):(i=n,0===X&&rt(g)),i!==n?(ct(),Z=t,t=[]):(J=t,t=n),X--,t===n&&0===X&&rt(m),t}function lt(){var t,i,s,r;return t=J,ct(),(i=function(){var t,i,s;return X++,t=J,(i=ht())!==n?(40===e.charCodeAt(J)?(s="(",J++):(s=n,0===X&&rt(x)),s!==n?(Z=t,t=i):(J=t,t=n)):(J=t,t=n),X--,t===n&&(i=n,0===X&&rt(S)),t}())!==n?(ct(),(s=function(){var t,i,s,r,o,a,l,u;if(t=J,(i=ut())!==n){for(s=[],r=J,o=ct(),44===e.charCodeAt(J)?(a=",",J++):(a=n,0===X&&rt(w)),a===n&&(a=null),l=ct(),(u=ut())!==n?r=o=[o,a,l,u]:(J=r,r=n);r!==n;)s.push(r),r=J,o=ct(),44===e.charCodeAt(J)?(a=",",J++):(a=n,0===X&&rt(w)),a===n&&(a=null),l=ct(),(u=ut())!==n?r=o=[o,a,l,u]:(J=r,r=n);Z=t,t=function(t,e){return e.length>0?function(t,e){return[t].concat(function(t){return t.map((function(t){return t[3]}))}(e))}(t,e):[t]}(i,s)}else J=t,t=n;return t}())===n&&(s=null),ct(),41===e.charCodeAt(J)?(r=")",J++):(r=n,0===X&&rt(v)),r!==n?(ct(),Z=t,t=function(t,e){return{type:"function",name:t,parameters:e||[]}}(i,s)):(J=t,t=n)):(J=t,t=n),t}function ut(){var t,e;return t=J,(e=dt())===n&&(e=ft())===n&&(e=pt())===n&&(e=function(){var t,e;return X++,t=J,ct(),(e=mt())!==n?(Z=t,t=function(t){return{value:t,unit:null}}(e)):(J=t,t=n),X--,t===n&&0===X&&rt($),t}()),e!==n&&(Z=t,e=function(t){return{type:"quantity",value:t.value,unit:t.unit}}(e)),(t=e)===n&&(t=J,(e=yt())!==n&&(Z=t,e=function(t){return{type:"color",colorType:t.type,value:t.value}}(e)),t=e),t}function ct(){var t,i;for(X++,t=[],h.test(e.charAt(J))?(i=e.charAt(J),J++):(i=n,0===X&&rt(M));i!==n;)t.push(i),h.test(e.charAt(J))?(i=e.charAt(J),J++):(i=n,0===X&&rt(M));return X--,i=n,0===X&&rt(b),t}function ht(){var t,i,s;if(X++,t=J,i=[],d.test(e.charAt(J))?(s=e.charAt(J),J++):(s=n,0===X&&rt(I)),s!==n)for(;s!==n;)i.push(s),d.test(e.charAt(J))?(s=e.charAt(J),J++):(s=n,0===X&&rt(I));else i=n;return i!==n&&(Z=t,i=tt()),X--,(t=i)===n&&(i=n,0===X&&rt(k)),t}function dt(){var t,i,s;return X++,t=J,ct(),(i=mt())!==n?(37===e.charCodeAt(J)?(s="%",J++):(s=n,0===X&&rt(_)),s!==n?(Z=t,t=function(t){return{value:t,unit:"%"}}(i)):(J=t,t=n)):(J=t,t=n),X--,t===n&&0===X&&rt(j),t}function ft(){var t,i,s;return X++,t=J,ct(),(i=mt())!==n?("px"===e.substr(J,2)?(s="px",J+=2):(s=n,0===X&&rt(O)),s!==n?(Z=t,t=function(t){return{value:t,unit:"px"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,ct(),(i=mt())!==n?("cm"===e.substr(J,2)?(s="cm",J+=2):(s=n,0===X&&rt(A)),s!==n?(Z=t,t=function(t){return{value:t,unit:"cm"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,ct(),(i=mt())!==n?("mm"===e.substr(J,2)?(s="mm",J+=2):(s=n,0===X&&rt(F)),s!==n?(Z=t,t=function(t){return{value:t,unit:"mm"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,ct(),(i=mt())!==n?("in"===e.substr(J,2)?(s="in",J+=2):(s=n,0===X&&rt(C)),s!==n?(Z=t,t=function(t){return{value:t,unit:"in"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,ct(),(i=mt())!==n?("pt"===e.substr(J,2)?(s="pt",J+=2):(s=n,0===X&&rt(P)),s!==n?(Z=t,t=function(t){return{value:t,unit:"pt"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,ct(),(i=mt())!==n?("pc"===e.substr(J,2)?(s="pc",J+=2):(s=n,0===X&&rt(E)),s!==n?(Z=t,t=function(t){return{value:t,unit:"pc"}}(i)):(J=t,t=n)):(J=t,t=n)))))),X--,t===n&&0===X&&rt(T),t}function pt(){var t,i,s;return X++,t=J,(i=mt())!==n?("deg"===e.substr(J,3)?(s="deg",J+=3):(s=n,0===X&&rt(R)),s!==n?(Z=t,t=function(t){return{value:t,unit:"deg"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,(i=mt())!==n?("rad"===e.substr(J,3)?(s="rad",J+=3):(s=n,0===X&&rt(N)),s!==n?(Z=t,t=function(t){return{value:t,unit:"rad"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,(i=mt())!==n?(e.substr(J,4)===u?(s=u,J+=4):(s=n,0===X&&rt(D)),s!==n?(Z=t,t=function(t){return{value:t,unit:"grad"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,(i=mt())!==n?(e.substr(J,4)===c?(s=c,J+=4):(s=n,0===X&&rt(V)),s!==n?(Z=t,t=function(t){return{value:t,unit:"turn"}}(i)):(J=t,t=n)):(J=t,t=n)))),X--,t===n&&(i=n,0===X&&rt(L)),t}function yt(){var t,i,s,r;if(X++,t=J,35===e.charCodeAt(J)?(i="#",J++):(i=n,0===X&&rt(G)),i!==n){if(s=[],f.test(e.charAt(J))?(r=e.charAt(J),J++):(r=n,0===X&&rt(U)),r!==n)for(;r!==n;)s.push(r),f.test(e.charAt(J))?(r=e.charAt(J),J++):(r=n,0===X&&rt(U));else s=n;s!==n?(Z=t,t={type:"hex",value:tt()}):(J=t,t=n)}else J=t,t=n;return t===n&&(t=J,(i=lt())!==n&&(Z=t,i=function(t){return{type:"function",value:t}}(i)),(t=i)===n&&(t=J,(i=ht())!==n&&(Z=t,i={type:"named",value:tt()}),t=i)),X--,t===n&&(i=n,0===X&&rt(z)),t}function mt(){var t,i,s,r,o,a,l;for(t=J,p.test(e.charAt(J))?(e.charAt(J),J++):0===X&&rt(q),i=J,s=[],y.test(e.charAt(J))?(r=e.charAt(J),J++):(r=n,0===X&&rt(B));r!==n;)s.push(r),y.test(e.charAt(J))?(r=e.charAt(J),J++):(r=n,0===X&&rt(B));if(46===e.charCodeAt(J)?(r=".",J++):(r=n,0===X&&rt(W)),r!==n){if(o=[],y.test(e.charAt(J))?(a=e.charAt(J),J++):(a=n,0===X&&rt(B)),a!==n)for(;a!==n;)o.push(a),y.test(e.charAt(J))?(a=e.charAt(J),J++):(a=n,0===X&&rt(B));else o=n;o!==n?i=s=[s,r,o]:(J=i,i=n)}else J=i,i=n;if(i===n)if(i=[],y.test(e.charAt(J))?(s=e.charAt(J),J++):(s=n,0===X&&rt(B)),s!==n)for(;s!==n;)i.push(s),y.test(e.charAt(J))?(s=e.charAt(J),J++):(s=n,0===X&&rt(B));else i=n;if(i!==n){if(s=J,101===e.charCodeAt(J)?(r="e",J++):(r=n,0===X&&rt(H)),r!==n){if(p.test(e.charAt(J))?(o=e.charAt(J),J++):(o=n,0===X&&rt(q)),o===n&&(o=null),a=[],y.test(e.charAt(J))?(l=e.charAt(J),J++):(l=n,0===X&&rt(B)),l!==n)for(;l!==n;)a.push(l),y.test(e.charAt(J))?(l=e.charAt(J),J++):(l=n,0===X&&rt(B));else a=n;a!==n?s=r=[r,o,a]:(J=s,s=n)}else J=s,s=n;s===n&&(s=null),Z=t,t=parseFloat(tt())}else J=t,t=n;return t}if((s=a())!==n&&J===e.length)return s;throw s!==n&&J<e.length&&rt({type:"end"}),function(e,i,s){return new t(t.buildMessage(e,i),e,i,s)}(Y,K<e.length?e.charAt(K):null,function(t,e){var i=nt(t),s=nt(e);return{source:r,start:{offset:t,line:i.line,column:i.column},end:{offset:e,line:s.line,column:s.column}}}(K,K<e.length?K+1:K))}}}());const YP={deg:1,grad:.9,rad:180/Math.PI,turn:360},XP={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function tE(t){!function(t){if("quantity"!==t.type||null!==t.unit&&"%"!==t.unit)throw new dt("effect:type-error","Expected <double> or <percentage>, Actual: "+QP(t),{term:t})}(t);const e=t.value;return KP(e,t),"%"===t.unit?.01*e:e}function eE(t){return function(t){if("quantity"!==t.type||!(0===t.value&&null===t.unit||t.unit&&null!=XP[t.unit]))throw new dt("effect:type-error","Expected <length>, Actual: "+QP(t),{term:t})}(t),t.value*XP[t.unit]||0}function iE(t){switch(t.colorType){case"hex":return function(t){const e=t.length>5,i=e?8:4,s=(1<<i)-1,n=e?1:17,r=e?9===t.length:5===t.length;let o=Number("0x"+t.substr(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return r&&(l=o&s,o>>=i,a[3]=n*l/255),l=o&s,o>>=i,a[2]=n*l,l=o&s,o>>=i,a[1]=n*l,l=o&s,o>>=i,a[0]=n*l,a}(t.value);case"named":return sE(t.value);case"function":return function(t){if(ZP(t.parameters,4),nE.test(t.name))return[tE(t.parameters[0]),tE(t.parameters[1]),tE(t.parameters[2]),t.parameters[3]?tE(t.parameters[3]):1];if(rE.test(t.name))return DS(function(t){return function(t){if("quantity"!==t.type||null!==t.unit)throw new dt("effect:type-error","Expected <double>, Actual: "+QP(t),{term:t})}(t),KP(t.value,t),t.value}(t.parameters[0]),tE(t.parameters[1]),tE(t.parameters[2]),t.parameters[3]?tE(t.parameters[3]):1);throw new dt("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}(t.value)}}function sE(t){if(!LS(t))throw new dt("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return function(t){return[...RS(t)]}(t)}const nE=/^rgba?/i,rE=/^hsla?/i;function oE(t,e,i){try{return function(t){if(!t||0===t.length)return null;if(function(t){const e=t[0];return!!e&&"scale"in e}(t)){const e=[];for(const i of t)e.push({scale:i.scale,value:lE(i.value)});return e}return lE(t)}(t)}catch(t){var s;null==i||null==(s=i.messages)||s.push(t)}return null}function aE(t,e,i,s){try{K(i,function(t){const e=HP(t);return e?function(t){const e=t[0];return!!e&&"type"in e}(e)?e.map((t=>t.toJSON())):e.map((({scale:t,effects:e})=>({scale:t,value:e.map((t=>t.toJSON()))}))):null}(t),e)}catch(t){s.messages&&s.messages.push(t)}}function lE(t){if(!t||!t.length)return"";const e=[];for(const i of t){let t=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":t=[uE(i,"amount")];break;case"blur":t=[uE(i,"radius","pt")];break;case"hue-rotate":t=[uE(i,"angle","deg")];break;case"drop-shadow":t=[uE(i,"xoffset","pt"),uE(i,"yoffset","pt"),uE(i,"blurRadius","pt"),cE(i,"color")];break;case"bloom":t=[uE(i,"strength"),uE(i,"radius","pt"),uE(i,"threshold")]}const s=`${i.type}(${t.filter(Boolean).join(" ")})`;HP(s),e.push(s)}return e.join(" ")}function uE(t,e,i){if(null==t[e])throw new dt("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return i?t[e]+i:""+t[e]}function cE(t,e){if(null==t[e])throw new dt("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const i=t[e];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}const hE=t=>{let i=class extends t{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return e([Hn({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0}}}})],i.prototype,"blendMode",void 0),e([Hn({json:{read:!1,write:!1,origins:{"web-map":{read:{reader:oE},write:{allowNull:!0,writer:aE}}}}})],i.prototype,"effect",void 0),i=e([_r("esri.layers.mixins.BlendLayer")],i),i},dE=t=>{let i=class extends t{constructor(){super(...arguments),this.customParameters=null}};return e([Hn({type:Object,json:{write:{overridePolicy:t=>({enabled:!!(t&&Object.keys(t).length>0)})}}})],i.prototype,"customParameters",void 0),i=e([_r("esri.layers.mixins.CustomParametersMixin")],i),i},fE={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8},pE={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};function yE(t,e,i){const s=new Date(t.getTime());if(e&&i){const t=pE[i],{getter:n,setter:r,multiplier:o}=t;s[r](s[n]()+e*o)}return s}function mE(t,e){switch(e){case"milliseconds":return new Date(t.getTime());case"seconds":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());case"minutes":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes());case"hours":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours());case"days":return new Date(t.getFullYear(),t.getMonth(),t.getDate());case"weeks":return new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay());case"months":return new Date(t.getFullYear(),t.getMonth(),1);case"years":return new Date(t.getFullYear(),0,1);case"decades":return new Date(t.getFullYear()-t.getFullYear()%10,0,1);case"centuries":return new Date(t.getFullYear()-t.getFullYear()%100,0,1);default:return new Date}}var gE;let vE=gE=class extends lh{constructor(t){super(t),this.end=null,this.start=null}static get allTime(){return wE}static get empty(){return bE}readEnd(t,e){return null!=e.end?new Date(e.end):null}writeEnd(t,e){e.end=t?t.getTime():null}get isAllTime(){return this.equals(gE.allTime)}get isEmpty(){return this.equals(gE.empty)}readStart(t,e){return null!=e.start?new Date(e.start):null}writeStart(t,e){e.start=t?t.getTime():null}clone(){return new gE({end:this.end,start:this.start})}equals(t){if(!t)return!1;const e=u(this.start)?this.start.getTime():this.start,i=u(this.end)?this.end.getTime():this.end,s=u(t.start)?t.start.getTime():t.start,n=u(t.end)?t.end.getTime():t.end;return e===s&&i===n}expandTo(t){if(this.isEmpty||this.isAllTime)return this.clone();const e=x(this.start,(e=>mE(e,t))),i=x(this.end,(e=>yE(mE(e,t),1,t)));return new gE({start:e,end:i})}intersection(t){if(!t)return this.clone();if(this.isEmpty||t.isEmpty)return gE.empty;if(this.isAllTime)return t.clone();if(t.isAllTime)return this.clone();const e=S(this.start,-1/0,(t=>t.getTime())),i=S(this.end,1/0,(t=>t.getTime())),s=S(t.start,-1/0,(t=>t.getTime())),n=S(t.end,1/0,(t=>t.getTime()));let r,o;if(s>=e&&s<=i?r=s:e>=s&&e<=n&&(r=e),i>=s&&i<=n?o=i:n>=e&&n<=i&&(o=n),!isNaN(r)&&!isNaN(o)){const t=new gE;return t.start=r===-1/0?null:new Date(r),t.end=o===1/0?null:new Date(o),t}return gE.empty}offset(t,e){if(this.isEmpty||this.isAllTime)return this.clone();const i=new gE,{start:s,end:n}=this;return u(s)&&(i.start=yE(s,t,e)),u(n)&&(i.end=yE(n,t,e)),i}union(t){if(!t||t.isEmpty)return this.clone();if(this.isEmpty)return t.clone();if(this.isAllTime||t.isAllTime)return wE.clone();const e=u(this.start)&&u(t.start)?new Date(Math.min(this.start.getTime(),t.start.getTime())):null,i=u(this.end)&&u(t.end)?new Date(Math.max(this.end.getTime(),t.end.getTime())):null;return new gE({start:e,end:i})}};e([Hn({type:Date,json:{write:{allowNull:!0}}})],vE.prototype,"end",void 0),e([Rh("end")],vE.prototype,"readEnd",null),e([fh("end")],vE.prototype,"writeEnd",null),e([Hn({readOnly:!0,json:{read:!1}})],vE.prototype,"isAllTime",null),e([Hn({readOnly:!0,json:{read:!1}})],vE.prototype,"isEmpty",null),e([Hn({type:Date,json:{write:{allowNull:!0}}})],vE.prototype,"start",void 0),e([Rh("start")],vE.prototype,"readStart",null),e([fh("start")],vE.prototype,"writeStart",null),vE=gE=e([_r("esri.TimeExtent")],vE);const wE=new vE,bE=new vE({start:void 0,end:void 0}),ME=vE;var SE;let xE=SE=class extends lh{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new SE({mapLayerId:t,gdbVersion:e})}};var kE;e([lM({mapLayer:"map-layer"})],xE.prototype,"type",void 0),e([Hn({type:Gn,json:{write:!0}})],xE.prototype,"mapLayerId",void 0),e([Hn({type:String,json:{write:!0}})],xE.prototype,"gdbVersion",void 0),xE=SE=e([_r("esri.layers.support.source.MapLayerSource")],xE);let IE=kE=class extends lh{constructor(t){super(t),this.type="query-table"}clone(){var t;const{workspaceId:e,query:i,oidFields:s,spatialReference:n,geometryType:r}=this,o={workspaceId:e,query:i,oidFields:s,spatialReference:null!=(t=null==n?void 0:n.clone())?t:void 0,geometryType:r};return new kE(o)}};var jE;e([lM({queryTable:"query-table"})],IE.prototype,"type",void 0),e([Hn({type:String,json:{write:!0}})],IE.prototype,"workspaceId",void 0),e([Hn({type:String,json:{write:!0}})],IE.prototype,"query",void 0),e([Hn({type:String,json:{write:!0}})],IE.prototype,"oidFields",void 0),e([Hn({type:Lh,json:{write:!0}})],IE.prototype,"spatialReference",void 0),e([lM(Uw)],IE.prototype,"geometryType",void 0),IE=kE=e([_r("esri.layers.support.source.QueryTableDataSource")],IE);let _E=jE=class extends lh{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new jE({workspaceId:t,dataSourceName:e})}};var TE;e([lM({raster:"raster"})],_E.prototype,"type",void 0),e([Hn({type:String,json:{write:!0}})],_E.prototype,"dataSourceName",void 0),e([Hn({type:String,json:{write:!0}})],_E.prototype,"workspaceId",void 0),_E=jE=e([_r("esri.layers.support.source.RasterDataSource")],_E);let OE=TE=class extends lh{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:i}=this;return new TE({workspaceId:t,gdbVersion:e,dataSourceName:i})}};var AE,FE;e([lM({table:"table"})],OE.prototype,"type",void 0),e([Hn({type:String,json:{write:!0}})],OE.prototype,"workspaceId",void 0),e([Hn({type:String,json:{write:!0}})],OE.prototype,"gdbVersion",void 0),e([Hn({type:String,json:{write:!0}})],OE.prototype,"dataSourceName",void 0),OE=TE=e([_r("esri.layers.support.source.TableDataSource")],OE);const CE=wo()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let PE=AE=class extends lh{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,i){return LE()(t,e,i)}castLeftTableSource(t){return zn(NE(),t)}readRightTableSource(t,e,i){return LE()(t,e,i)}castRightTableSource(t){return zn(NE(),t)}clone(){var t,e;const{leftTableKey:i,rightTableKey:s,leftTableSource:n,rightTableSource:r,joinType:o}=this,a={leftTableKey:i,rightTableKey:s,leftTableSource:null!=(t=null==n?void 0:n.clone())?t:void 0,rightTableSource:null!=(e=null==r?void 0:r.clone())?e:void 0,joinType:o};return new AE(a)}};e([lM({joinTable:"join-table"})],PE.prototype,"type",void 0),e([Hn({type:String,json:{write:!0}})],PE.prototype,"leftTableKey",void 0),e([Hn({type:String,json:{write:!0}})],PE.prototype,"rightTableKey",void 0),e([Hn({json:{write:!0}})],PE.prototype,"leftTableSource",void 0),e([Rh("leftTableSource")],PE.prototype,"readLeftTableSource",null),e([xa("leftTableSource")],PE.prototype,"castLeftTableSource",null),e([Hn({json:{write:!0}})],PE.prototype,"rightTableSource",void 0),e([Rh("rightTableSource")],PE.prototype,"readRightTableSource",null),e([xa("rightTableSource")],PE.prototype,"castRightTableSource",null),e([lM(CE)],PE.prototype,"joinType",void 0),PE=AE=e([_r("esri.layers.support.source.JoinTableDataSource")],PE);let EE=null;function LE(){return EE||(EE=tr({types:NE()})),EE}let RE=null;function NE(){return RE||(RE={key:"type",base:null,typeMap:{"data-layer":VE,"map-layer":xE}}),RE}const DE={key:"type",base:null,typeMap:{"join-table":PE,"query-table":IE,raster:_E,table:OE}};let VE=FE=class extends lh{constructor(t){super(t),this.type="data-layer"}clone(){const{fields:t,dataSource:e}=this;return new FE({fields:t,dataSource:e})}};var $E;e([lM({dataLayer:"data-layer"})],VE.prototype,"type",void 0),e([Hn({type:[rP],json:{write:!0}})],VE.prototype,"fields",void 0),e([Hn({types:DE,json:{write:!0}})],VE.prototype,"dataSource",void 0),VE=FE=e([_r("esri.layers.support.source.DataLayerSource")],VE),VE.from=Ln(VE);const zE=new vo({upperLeft:"upper-left",lowerLeft:"lower-left"});let GE=$E=class extends lh{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new $E(H({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};e([Hn({type:Ld,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],GE.prototype,"extent",void 0),e([Hn({type:["view","edit"],json:{write:!0}})],GE.prototype,"mode",void 0),e([Hn({type:String,json:{read:zE.read,write:zE.write}})],GE.prototype,"originPosition",void 0),e([Hn({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],GE.prototype,"tolerance",void 0),GE=$E=e([_r("esri.rest.support.QuantizationParameters")],GE);const UE=GE;var qE;const BE=new vo({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete"});let WE=qE=class extends lh{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){"percentile-continuous"!==this.statisticType&&"percentile-discrete"!==this.statisticType||(e.statisticParameters=H(t))}clone(){return new qE({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:H(this.statisticParameters)})}};e([Hn({type:Number,json:{write:!0}})],WE.prototype,"maxPointCount",void 0),e([Hn({type:Number,json:{write:!0}})],WE.prototype,"maxRecordCount",void 0),e([Hn({type:Number,json:{write:!0}})],WE.prototype,"maxVertexCount",void 0),e([Hn({type:String,json:{write:!0}})],WE.prototype,"onStatisticField",void 0),e([Hn({type:String,json:{write:!0}})],WE.prototype,"outStatisticFieldName",void 0),e([Hn({type:String,json:{read:{source:"statisticType",reader:BE.read},write:{target:"statisticType",writer:BE.write}}})],WE.prototype,"statisticType",void 0),e([Hn({type:Object})],WE.prototype,"statisticParameters",void 0),e([fh("statisticParameters")],WE.prototype,"writeStatisticParameters",null),WE=qE=e([_r("esri.rest.support.StatisticDefinition")],WE);const HE=WE;var JE;const ZE=new vo({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),QE=new vo({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let KE=JE=class extends lh{constructor(t){super(t),this.aggregateIds=null,this.cacheHint=void 0,this.datumTransformation=null,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}static from(t){return Fn(JE,t)}castDatumTransformation(t){return"number"==typeof t||"object"==typeof t?t:null}writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeParameterValues(t,e){if(t){const i={};for(const e in t){const s=t[e];i[e]=Array.isArray(s)?s.map((t=>t instanceof Date?t.getTime():t)):s instanceof Date?s.getTime():s}e.parameterValues=i}}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,e.where="1=1"}writeWhere(t,e){e.where=t||"1=1"}clone(){return new JE(H({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,datumTransformation:this.datumTransformation,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:u(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};KE.MAX_MAX_RECORD_COUNT_FACTOR=5,e([Hn({json:{write:!0}})],KE.prototype,"aggregateIds",void 0),e([Hn({type:Boolean,json:{write:!0}})],KE.prototype,"cacheHint",void 0),e([Hn({json:{write:!0}})],KE.prototype,"datumTransformation",void 0),e([xa("datumTransformation")],KE.prototype,"castDatumTransformation",null),e([Hn({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],KE.prototype,"distance",void 0),e([Hn({type:VE,json:{write:!0}})],KE.prototype,"dynamicDataSource",void 0),e([Hn({type:String,json:{write:!0}})],KE.prototype,"formatOf3DObjects",void 0),e([Hn({type:String,json:{write:!0}})],KE.prototype,"gdbVersion",void 0),e([Hn({types:tb,json:{read:Qw,write:!0}})],KE.prototype,"geometry",void 0),e([Hn({type:Number,json:{write:!0}})],KE.prototype,"geometryPrecision",void 0),e([Hn({type:[String],json:{write:!0}})],KE.prototype,"groupByFieldsForStatistics",void 0),e([Hn({type:String,json:{write:!0}})],KE.prototype,"having",void 0),e([Hn({type:Date})],KE.prototype,"historicMoment",void 0),e([fh("historicMoment")],KE.prototype,"writeHistoricMoment",null),e([Hn({type:Number,json:{write:!0}})],KE.prototype,"maxAllowableOffset",void 0),e([Hn({type:Number,cast:t=>t<1?1:t>JE.MAX_MAX_RECORD_COUNT_FACTOR?JE.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],KE.prototype,"maxRecordCountFactor",void 0),e([Hn({type:["xyFootprint"],json:{write:!0}})],KE.prototype,"multipatchOption",void 0),e([Hn({type:Number,json:{read:{source:"resultRecordCount"}}})],KE.prototype,"num",void 0),e([Hn({json:{write:!0}})],KE.prototype,"objectIds",void 0),e([Hn({type:[String],json:{write:!0}})],KE.prototype,"orderByFields",void 0),e([Hn({type:[String],json:{write:!0}})],KE.prototype,"outFields",void 0),e([Hn({type:Lh,json:{name:"outSR",write:!0}})],KE.prototype,"outSpatialReference",void 0),e([Hn({type:[HE],json:{write:{enabled:!0,overridePolicy(){return{enabled:u(this.outStatistics)&&this.outStatistics.length>0}}}}})],KE.prototype,"outStatistics",void 0),e([Hn({json:{write:!0}})],KE.prototype,"parameterValues",void 0),e([fh("parameterValues")],KE.prototype,"writeParameterValues",null),e([Hn({type:ad,json:{write:!0}})],KE.prototype,"pixelSize",void 0),e([Hn({type:UE,json:{write:!0}})],KE.prototype,"quantizationParameters",void 0),e([Hn({type:[Object],json:{write:!0}})],KE.prototype,"rangeValues",void 0),e([Hn({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],KE.prototype,"relationParameter",void 0),e([Hn({type:String,json:{write:!0}})],KE.prototype,"resultType",void 0),e([Hn({type:Boolean,json:{default:!1,write:!0}})],KE.prototype,"returnCentroid",void 0),e([Hn({type:Boolean,json:{default:!1,write:!0}})],KE.prototype,"returnDistinctValues",void 0),e([Hn({type:Boolean,json:{default:!0,write:!0}})],KE.prototype,"returnExceededLimitFeatures",void 0),e([Hn({type:Boolean,json:{write:!0}})],KE.prototype,"returnGeometry",void 0),e([Hn({type:Boolean,json:{default:!1,write:!0}})],KE.prototype,"returnQueryGeometry",void 0),e([Hn({type:Boolean,json:{default:!1,write:!0}})],KE.prototype,"returnM",void 0),e([Hn({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],KE.prototype,"returnZ",void 0),e([Hn({type:Lh,json:{write:!0}})],KE.prototype,"sourceSpatialReference",void 0),e([lM(ZE,{ignoreUnknown:!1,name:"spatialRel"})],KE.prototype,"spatialRelationship",void 0),e([Hn({type:Number,json:{read:{source:"resultOffset"}}})],KE.prototype,"start",void 0),e([fh("start"),fh("num")],KE.prototype,"writeStart",null),e([Hn({type:String,json:{write:!0}})],KE.prototype,"sqlFormat",void 0),e([Hn({type:String,json:{write:!0}})],KE.prototype,"text",void 0),e([Hn({type:ME,json:{write:!0}})],KE.prototype,"timeExtent",void 0),e([Hn({type:Boolean,json:{default:!1,write:!0}})],KE.prototype,"timeReferenceUnknownClient",void 0),e([lM(QE,{ignoreUnknown:!1}),Hn({json:{write:{overridePolicy(t){return{enabled:t&&this.distance>0}}}}})],KE.prototype,"units",void 0),e([Hn({type:String,json:{write:{overridePolicy(t){return{enabled:null!=t||this.start>0}}}}})],KE.prototype,"where",void 0),e([fh("where")],KE.prototype,"writeWhere",null),KE=JE=e([_r("esri.rest.support.Query")],KE);const YE=KE;var XE;const tL=new vo({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),eL=new vo({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let iL=XE=class extends lh{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:i,spatialRelationship:s,timeExtent:n,objectIds:r,units:o,distance:a}=this;return new YE({geometry:H(i),objectIds:H(r),spatialRelationship:s,timeExtent:H(n),where:e,units:o,distance:a,...t})}clone(){const{where:t,geometry:e,spatialRelationship:i,timeExtent:s,objectIds:n,units:r,distance:o}=this;return new XE({geometry:H(e),objectIds:H(n),spatialRelationship:i,timeExtent:H(s),where:t,units:r,distance:o})}};e([Hn({type:String,json:{write:!0}})],iL.prototype,"where",void 0),e([Hn({types:tb,json:{write:!0}})],iL.prototype,"geometry",void 0),e([Hn({type:tL.apiValues,json:{name:"spatialRel",read:{reader:tL.read},write:{allowNull:!1,writer:tL.write,overridePolicy(){return{enabled:u(this.geometry)}}}}})],iL.prototype,"spatialRelationship",void 0),e([Hn({type:Number,json:{write:{overridePolicy(t){return{enabled:null!=t&&null!=this.geometry}}}}})],iL.prototype,"distance",void 0),e([Hn({type:[Number],json:{write:!0}})],iL.prototype,"objectIds",void 0),e([Hn({type:eL.apiValues,json:{read:eL.read,write:{writer:eL.write,overridePolicy(t){return{enabled:null!=t&&null!=this.geometry}}}}})],iL.prototype,"units",void 0),e([Hn({type:ME,json:{write:!0}})],iL.prototype,"timeExtent",void 0),iL=XE=e([_r("esri.layers.support.FeatureFilter")],iL);const sL=iL;var nL;let rL=nL=class extends lh{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}clone(){return new nL({filter:u(this.filter)&&this.filter.clone(),includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};e([Hn({type:sL,json:{write:!0,origins:{"web-map":{write:{allowNull:!0,writer(t,e,i,s){if(!t)return void(e[i]=t);const n=t.write({},s),r=Object.keys(n);e[i]=1===r.length&&"where"===r[0]?n:null}}}}}})],rL.prototype,"filter",void 0),e([Hn({json:{write:!0,origins:{"web-map":{read:{reader:oE},write:{allowNull:!0,writer:aE}}}}})],rL.prototype,"includedEffect",void 0),e([Hn({json:{write:!0,origins:{"web-map":{read:{reader:oE},write:{allowNull:!0,writer:aE}}}}})],rL.prototype,"excludedEffect",void 0),e([Hn({type:Boolean,json:{write:!0,name:"showExcludedLabels",default:!1}})],rL.prototype,"excludedLabelsVisible",void 0),rL=nL=e([_r("esri.layers.support.FeatureEffect")],rL);const oL=rL,aL=t=>{let i=class extends t{constructor(){super(...arguments),this.featureEffect=null}};return e([Hn({type:oL,json:{origins:{"web-map":{write:{allowNull:!0}}}}})],i.prototype,"featureEffect",void 0),i=e([_r("esri.layers.mixins.FeatureEffectLayer")],i),i},lL={"web-scene/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-map/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,OGCFeatureLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-map/basemap":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},"web-map/tables":{ArcGISFeatureLayer:!0},"portal-item/operational-layers":{ArcGISSceneServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0}};var uL;let cL=uL=class extends lh{async collectRequiredFields(t,e){return wb(t,e,this.expression)}clone(){return new uL({expression:this.expression,title:this.title})}};e([Hn({type:String,json:{write:!0}})],cL.prototype,"expression",void 0),e([Hn({type:String,json:{write:!0}})],cL.prototype,"title",void 0),cL=uL=e([_r("esri.layers.support.FeatureExpressionInfo")],cL);const hL=cL,dL=function(){const t=Object.keys(DT);return t.sort(),t}();var fL;const pL=wo()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),yL=new vo({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let mL=fL=class extends lh{constructor(){super(...arguments),this.offset=null}readFeatureExpressionInfo(t,e){return null!=t?t:e.featureExpression&&0===e.featureExpression.value?{expression:"0"}:void 0}writeFeatureExpressionInfo(t,e,i,s){e[i]=t.write({},s),"0"===t.expression&&(e.featureExpression={value:0})}get mode(){const{offset:t,featureExpressionInfo:e}=this;return this._isOverridden("mode")?this._get("mode"):u(t)||e?"relative-to-ground":"on-the-ground"}set mode(t){this._override("mode",t)}set unit(t){this._set("unit",t)}write(t,e){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(t,e):null}clone(){return new fL({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}};e([Hn({type:hL,json:{write:!0}})],mL.prototype,"featureExpressionInfo",void 0),e([Rh("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],mL.prototype,"readFeatureExpressionInfo",null),e([fh("featureExpressionInfo",{featureExpressionInfo:{type:hL},"featureExpression.value":{type:[0]}})],mL.prototype,"writeFeatureExpressionInfo",null),e([Hn({type:pL.apiValues,nonNullable:!0,json:{type:pL.jsonValues,read:pL.read,write:{writer:pL.write,isRequired:!0}}})],mL.prototype,"mode",null),e([Hn({type:Number,json:{write:!0}})],mL.prototype,"offset",void 0),e([Hn({type:dL,json:{type:String,read:yL.read,write:yL.write}})],mL.prototype,"unit",null),mL=fL=e([_r("esri.layers.support.ElevationInfo")],mL);const gL=mL,vL={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:!0}},wL={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,i){e[i]=!t}}}},bL={type:Boolean,value:!0,json:{name:"showLabels",write:!0}},ML={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:Ok}}},SL={type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:!0}},xL={value:null,type:gL,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:!0}};function kL(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const IL={type:Number,json:{origins:{"web-document":{write:!0,read:!0},"portal-item":{write:!0}}}},jL={...IL,json:{...IL.json,origins:{"web-document":{...IL.json.origins["web-document"],write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,i)=>i&&"service"!==i.origin||!e.drawingInfo||void 0===e.drawingInfo.transparency?e.layerDefinition&&e.layerDefinition.drawingInfo&&void 0!==e.layerDefinition.drawingInfo.transparency?nx(e.layerDefinition.drawingInfo.transparency):void 0:nx(e.drawingInfo.transparency)}}},_L={type:ME,readOnly:!0,get(){var t,e;if(null==(t=this.layer)||!t.timeInfo)return null;const{datesInUnknownTimezone:i,timeOffset:s,useViewTime:n}=this.layer,r=null==(e=this.view)?void 0:e.timeExtent;let o=this.layer.timeExtent;i&&(o=function(t){if(!t)return t;const{start:e,end:i}=t;return new ME({start:u(e)?yE(e,e.getTimezoneOffset(),"minutes"):e,end:u(i)?yE(i,i.getTimezoneOffset(),"minutes"):i})}(o));let a=n?r&&o?r.intersection(o):r||o:o;if(!a||a.isEmpty||a.isAllTime)return a;s&&(a=a.offset(-s.value,s.unit)),i&&(a=function(t){if(!t)return t;const{start:e,end:i}=t;return new ME({start:u(e)?yE(e,-e.getTimezoneOffset(),"minutes"):e,end:u(i)?yE(i,-i.getTimezoneOffset(),"minutes"):i})}(a));const l=this._get("timeExtent");return a.equals(l)?l:a}},TL={type:Ld,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const i=Ld.fromJSON(t);return null!=e.spatialReference&&"object"==typeof e.spatialReference&&(i.spatialReference=Lh.fromJSON(e.spatialReference)),i}}}},read:!1}},OL={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},AL={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}},FL={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}},CL=t=>{let i=class extends t{constructor(){super(...arguments),this.title=null}writeListMode(t,e,i,s){(s&&"ground"===s.layerContainerType||t&&sh(this,i,{},s))&&(e[i]=t)}writeOperationalLayerType(t,e,i,s){!t||s&&"tables"===s.layerContainerType||(e.layerType=t)}writeTitle(t,e){e.title=t||"Layer"}read(t,e){e&&(e.layer=this),Xc(this,0,(e=>super.read(t,e)),e)}write(t,e){if(null!=e&&e.origin){const t=`${e.origin}/${e.layerContainerType||"operational-layers"}`,s=lL[t];let n=s&&s[this.operationalLayerType];var i;if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===t&&(n=!1),!n)return null==(i=e.messages)||i.push(new dt("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${t}'`,{layer:this})),null}const s=super.write(t,{...e,layer:this}),n=!!e&&!!e.messages&&!!e.messages.filter((t=>t instanceof dt&&"web-document-write:property-required"===t.name)).length;var r;return Zt(null==s?void 0:s.url)?(null==e||null==(r=e.messages)||r.push(new dt("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&n?null:s}beforeSave(){}};return e([Hn({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],i.prototype,"id",void 0),e([Hn({json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}})],i.prototype,"listMode",void 0),e([fh("listMode")],i.prototype,"writeListMode",null),e([Hn({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],i.prototype,"operationalLayerType",void 0),e([fh("operationalLayerType")],i.prototype,"writeOperationalLayerType",null),e([Hn(IL)],i.prototype,"opacity",void 0),e([Hn({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],i.prototype,"title",void 0),e([fh("title")],i.prototype,"writeTitle",null),e([Hn({type:Boolean,json:{name:"visibility",origins:{"web-document":{name:"visibility",default:!0},"portal-item":{name:"visibility",read:{source:["visible","visibility"]}}}}})],i.prototype,"visible",void 0),i=e([_r("esri.layers.mixins.OperationalLayer")],i),i};var PL;const EL=new vo({asc:"ascending",desc:"descending"});let LL=PL=class extends lh{constructor(t){super(t),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new PL({field:this.field,valueExpression:this.valueExpression,order:this.order})}};e([Hn({type:String,json:{write:!0}})],LL.prototype,"field",void 0),e([Hn({type:String,json:{write:!0}})],LL.prototype,"valueExpression",void 0),e([Hn({type:EL.apiValues,json:{read:EL.read,write:EL.write}})],LL.prototype,"order",void 0),LL=PL=e([_r("esri.layers.support.OrderByInfo")],LL);const RL=LL;function NL(t,e,i){if(!t)return null;const s=t.find((t=>!!t.field));if(!s)return null;const n=new RL;return n.read(s,i),[n]}function DL(t,e,i){const s=t.find((t=>!!t.field));s&&K(i,[s.toJSON()],e)}const VL=t=>{let i=class extends t{constructor(){super(...arguments),this.orderBy=null}};return e([Hn({type:[RL],json:{origins:{"web-scene":{write:!1,read:!1}},read:{source:"layerDefinition.orderBy",reader:NL},write:{target:"layerDefinition.orderBy",writer:DL}}})],i.prototype,"orderBy",void 0),i=e([_r("esri.layers.mixins.OrderedLayer")],i),i},$L=ct.getLogger("esri.layers.mixins.PortalLayer"),zL=t=>{let i=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0}destroy(){var t;null==(t=this.portalItem)||t.destroy(),this.portalItem=null}set portalItem(t){t!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",t))}readPortalItem(t,e,i){if(e.itemId)return new cf({id:e.itemId,portal:i&&i.portal})}writePortalItem(t,e){t&&t.id&&(e.itemId=t.id)}async loadFromPortal(t,e){if(this.portalItem&&this.portalItem.id)try{const i=await import("./p-37509181.js").then((function(t){return t.l}));return Ee(e),await i.load({instance:this,supportedTypes:t.supportedTypes,validateItem:t.validateItem,supportsData:t.supportsData},e)}catch(t){throw Ge(t)||$L.warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${t}`),t}}async finishLoadEditablePortalLayer(t){this._set("userHasEditingPrivileges",await this.fetchUserHasEditingPrivileges(t).catch((t=>(Ne(t),!0))))}async fetchUserHasEditingPrivileges(t){const e=this.url?null==Me?void 0:Me.findCredential(this.url):null;if(!e)return!0;const i=GL.credential===e?GL.user:await this.fetchEditingUser(t);return GL.credential=e,GL.user=i,c(i)||null==i.privileges||i.privileges.includes("features:user:edit")}async fetchEditingUser(t){var e,i;const s=null==(e=this.portalItem)||null==(i=e.portal)?void 0:i.user;if(s)return s;const n=Me.findServerInfo(this.url);if(null==n||!n.owningSystemUrl)return null;const r=n.owningSystemUrl+"/sharing/rest",o=ef.getDefault();if(o&&o.loaded&&Bt(o.restUrl)===Bt(r))return o.user;const a=r+"/community/self",l=u(t)?t.signal:null,c=await uh(oi(a,{authMode:"no-prompt",query:{f:"json"},signal:l}));return c.ok?Zd.fromJSON(c.value.data):null}read(t,e){e&&(e.layer=this),super.read(t,e)}write(t,e){const i=e&&e.portal,s=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||ef.getDefault());return i&&s&&!Nt(s.restUrl,i.restUrl)?(e.messages&&e.messages.push(new dt("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save the scene, set the layer.portalItem to null or save the scene to the same portal as the item associated with the layer`,{layer:this})),null):super.write(t,{...e,layer:this})}};return e([Hn({type:cf})],i.prototype,"portalItem",null),e([Rh("web-document","portalItem",["itemId"])],i.prototype,"readPortalItem",null),e([fh("web-document","portalItem",{itemId:{type:String}})],i.prototype,"writePortalItem",null),e([Hn()],i.prototype,"resourceReferences",void 0),e([Hn({readOnly:!0})],i.prototype,"userHasEditingPrivileges",void 0),i=e([_r("esri.layers.mixins.PortalLayer")],i),i},GL={credential:null,user:null},UL=new Jr,qL=new WeakMap;function BL(t){return t&&"object"==typeof t&&"refreshInterval"in t&&"refresh"in t}function WL(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:WL(e,t%e):0}let HL=0,JL=0;function ZL(){const t=Date.now();for(const i of UL)if(i.refreshInterval){var e;t-(null!=(e=qL.get(i))?e:0)+5>=6e4*i.refreshInterval&&(qL.set(i,t),i.refresh(t))}}on((()=>{const t=Date.now();let e=0;for(const i of UL)e=WL(Math.round(6e4*i.refreshInterval),e),i.refreshInterval?qL.get(i)||qL.set(i,t):qL.delete(i);if(e!==JL){if(JL=e,clearInterval(HL),0===JL)return void(HL=0);HL=setInterval(ZL,JL)}}));const QL=t=>{let i=class extends t{constructor(...t){super(...t),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=Xe((()=>this.hasDataChanged())),this.when().then((()=>{!function(t){BL(t)&&UL.push(t)}(this)}),(()=>{}))}destroy(){!function(t){BL(t)&&UL.includes(t)&&UL.remove(t)}(this)}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(t=Date.now()){Ue(this._debounceHasDataChanged()).then((e=>{e&&this._set("refreshTimestamp",t),this.emit("refresh",{dataChanged:e})}),(t=>{ct.getLogger(this.declaredClass).error(t),this.emit("refresh",{dataChanged:!1,error:t})}))}async hasDataChanged(){return!0}};return e([Hn({type:Number,cast:t=>t>=.1?t:t<=0?0:.1,json:{write:!0}})],i.prototype,"refreshInterval",void 0),e([Hn({readOnly:!0})],i.prototype,"refreshTimestamp",void 0),e([Hn()],i.prototype,"refreshParameters",null),i=e([_r("esri.layers.mixins.RefreshableLayer")],i),i},KL=t=>{let i=class extends t{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get scaleRangeId(){return`${this.minScale},${this.maxScale}`}};return e([Hn({type:Number,nonNullable:!0,json:{write:!0}})],i.prototype,"minScale",void 0),e([Hn({type:Number,nonNullable:!0,json:{write:!0}})],i.prototype,"maxScale",void 0),e([Hn({readOnly:!0})],i.prototype,"scaleRangeId",null),i=e([_r("esri.layers.mixins.ScaleRangeLayer")],i),i},YL=wo()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});var XL;let tR=XL=class extends lh{constructor(t){super(t),this.value=0,this.unit="milliseconds"}toMilliseconds(){return function(t,e){return 0===t?0:t*fE[e]/1}(this.value,this.unit)}clone(){return new XL({value:this.value,unit:this.unit})}};e([Hn({type:Number,json:{write:!0},nonNullable:!0})],tR.prototype,"value",void 0),e([Hn({type:YL.apiValues,json:{type:YL.jsonValues,read:YL.read,write:YL.write},nonNullable:!0})],tR.prototype,"unit",void 0),tR=XL=e([_r("esri.TimeInterval")],tR);const eR=tR;var iR;let sR=iR=class extends lh{constructor(t){super(t),this.respectsDaylightSaving=!1,this.timezone=null}readRespectsDaylightSaving(t,e){return void 0!==e.respectsDaylightSaving?e.respectsDaylightSaving:void 0!==e.respectDaylightSaving&&e.respectDaylightSaving}clone(){const{respectsDaylightSaving:t,timezone:e}=this;return new iR({respectsDaylightSaving:t,timezone:e})}};e([Hn({type:Boolean,json:{write:!0}})],sR.prototype,"respectsDaylightSaving",void 0),e([Rh("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],sR.prototype,"readRespectsDaylightSaving",null),e([Hn({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],sR.prototype,"timezone",void 0),sR=iR=e([_r("esri.layers.support.TimeReference")],sR);const nR=sR;var rR;let oR=rR=class extends lh{constructor(t){super(t),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeReference=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(t,e){return e.timeExtent&&Array.isArray(e.timeExtent)&&2===e.timeExtent.length?new ME({start:new Date(e.timeExtent[0]),end:new Date(e.timeExtent[1])}):null}writeFullTimeExtent(t,e){e.timeExtent=t&&u(t.start)&&u(t.end)?[t.start.getTime(),t.end.getTime()]:null}readInterval(t,e){return e.timeInterval&&e.timeIntervalUnits?new eR({value:e.timeInterval,unit:YL.fromJSON(e.timeIntervalUnits)}):e.defaultTimeInterval&&e.defaultTimeIntervalUnits?new eR({value:e.defaultTimeInterval,unit:YL.fromJSON(e.defaultTimeIntervalUnits)}):null}writeInterval(t,e){if(t){const i=t.toJSON();e.timeInterval=i.value,e.timeIntervalUnits=i.unit}else e.timeInterval=null,e.timeIntervalUnits=null}clone(){const{cumulative:t,endField:e,hasLiveData:i,interval:s,startField:n,timeReference:r,fullTimeExtent:o,trackIdField:a,useTime:l}=this;return new rR({cumulative:t,endField:e,hasLiveData:i,interval:s,startField:n,timeReference:H(r),fullTimeExtent:H(o),trackIdField:a,useTime:l})}};e([Hn({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],oR.prototype,"cumulative",void 0),e([Hn({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],oR.prototype,"endField",void 0),e([Hn({type:ME,json:{write:{enabled:!0,allowNull:!0}}})],oR.prototype,"fullTimeExtent",void 0),e([Rh("fullTimeExtent",["timeExtent"])],oR.prototype,"readFullTimeExtent",null),e([fh("fullTimeExtent")],oR.prototype,"writeFullTimeExtent",null),e([Hn({type:Boolean,json:{write:!0}})],oR.prototype,"hasLiveData",void 0),e([Hn({type:eR,json:{write:{enabled:!0,allowNull:!0}}})],oR.prototype,"interval",void 0),e([Rh("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],oR.prototype,"readInterval",null),e([fh("interval")],oR.prototype,"writeInterval",null),e([Hn({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],oR.prototype,"startField",void 0),e([Hn({type:nR,json:{write:{enabled:!0,allowNull:!0}}})],oR.prototype,"timeReference",void 0),e([Hn({type:String,json:{write:{enabled:!0,allowNull:!0}}})],oR.prototype,"trackIdField",void 0),e([Hn({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],oR.prototype,"useTime",void 0),oR=rR=e([_r("esri.layers.support.TimeInfo")],oR);const aR=oR,lR=t=>{let i=class extends t{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(t,e){const i=e.timeInfo.exportOptions;if(!i)return null;const s=i.timeOffset,n=YL.fromJSON(i.timeOffsetUnits);return s&&n?new eR({value:s,unit:n}):null}set timeInfo(t){fb(t,this.fieldsIndex),this._set("timeInfo",t)}};return e([Hn({type:ME,json:{write:!1}})],i.prototype,"timeExtent",void 0),e([Hn({type:eR})],i.prototype,"timeOffset",void 0),e([Rh("service","timeOffset",["timeInfo.exportOptions"])],i.prototype,"readOffset",null),e([Hn({value:null,type:aR,json:{write:!0,origins:{"web-document":{read:!1,write:!1}}}})],i.prototype,"timeInfo",null),e([Hn({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],i.prototype,"useViewTime",void 0),i=e([_r("esri.layers.mixins.TemporalLayer")],i),i};var uR;let cR=uR=class extends lh{constructor(t){super(t)}clone(){const{name:t,fields:e,isAscending:i,isUnique:s,description:n}=this;return new uR({name:t,fields:e,isAscending:i,isUnique:s,description:n})}};e([Hn({constructOnly:!0})],cR.prototype,"name",void 0),e([Hn({constructOnly:!0})],cR.prototype,"fields",void 0),e([Hn({constructOnly:!0})],cR.prototype,"isAscending",void 0),e([Hn({constructOnly:!0})],cR.prototype,"isUnique",void 0),e([Hn({constructOnly:!0})],cR.prototype,"description",void 0),cR=uR=e([_r("esri.layers.support.FeatureIndex")],cR);let hR=class extends lh{constructor(){super(...arguments),this.type=null}};e([Hn({type:["selection","cluster"],readOnly:!0,json:{read:!1,write:!0}})],hR.prototype,"type",void 0),hR=e([_r("esri.layers.support.FeatureReduction")],hR);const dR=hR;var fR;let pR=fR=class extends lh{constructor(){super(...arguments),this.statisticType=null,this.onStatisticField=null,this.onStatisticValueExpression=null}clone(){return new fR({statisticType:this.statisticType,onStatisticField:this.onStatisticField,onStatisticValueExpression:this.onStatisticValueExpression})}};e([Hn({type:String,json:{write:!0}})],pR.prototype,"statisticType",void 0),e([Hn({type:String,json:{write:!0}})],pR.prototype,"onStatisticField",void 0),e([Hn({type:String,json:{write:!0}})],pR.prototype,"onStatisticValueExpression",void 0),pR=fR=e([_r("esri.layers.support.OutStatistic")],pR);const yR=pR;var mR;let gR=mR=class extends lh{constructor(){super(...arguments),this.name=null}clone(){return new mR({name:this.name,outStatistic:this.outStatistic.clone()})}};e([Hn({type:String,json:{write:!0}})],gR.prototype,"name",void 0),e([Hn({type:yR,json:{write:!0}})],gR.prototype,"outStatistic",void 0),gR=mR=e([_r("esri.layers.support.AggregateField")],gR);const vR=gR,wR=/__begin__/gi,bR=/__end__/gi,MR=/^__begin__/i,SR=/__end__$/i;function xR(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):null!=t.labelExpression&&(e.expression=function(t){return t.replace(/\[/g,"{").replace(/\]/g,"}")}(t.labelExpression),e.type="conventional"),e}function kR(t){let e;return t?(e=rt(t,(t=>'__begin__$feature["'+t+'"]__end__')),e=MR.test(e)?e.replace(MR,""):'"'+e,e=SR.test(e)?e.replace(SR,""):e+'"',e=e.replace(wR,'" + ').replace(bR,' + "')):e='""',e}const IR=/^\s*\{([^}]+)\}\s*$/i,jR=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,_R=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,TR=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function OR(t){if(!t)return null;let e=jR.exec(t)||_R.exec(t);return e?e[1]||e[3]:(e=TR.exec(t),e?e[2]:null)}var AR;let FR=AR=class extends lh{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(t,e){return e.value?kR(e.value):t}writeExpression(t,e,i){null!=this.value&&(t=kR(this.value)),null!=t&&(e[i]=t)}clone(){return new AR({expression:this.expression,title:this.title,value:this.value})}};e([Hn({type:String,json:{write:{writerEnsuresNonNull:!0}}})],FR.prototype,"expression",void 0),e([Rh("expression",["expression","value"])],FR.prototype,"readExpression",null),e([fh("expression")],FR.prototype,"writeExpression",null),e([Hn({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],FR.prototype,"title",void 0),e([Hn({json:{read:!1,write:!1}})],FR.prototype,"value",void 0),FR=AR=e([_r("esri.layers.support.LabelExpressionInfo")],FR);const CR=FR,PR=[252,146,31,255],ER={type:"esriSMS",style:"esriSMSCircle",size:6,color:PR,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},LR={type:"esriSLS",style:"esriSLSSolid",width:.75,color:PR},RR={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},NR={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},DR={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},VR={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};Nj.fromJSON(ER),Ox.fromJSON(LR),Pj.fromJSON(RR);const $R=$j.fromJSON({type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0}),zR=Nj.fromJSON(NR),GR=Ox.fromJSON(DR),UR=Pj.fromJSON(VR);var qR;const BR=new vo({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function WR(t){return!t||"service"!==t.origin&&!HR(t.layer)}function HR(t){return"map-image"===(null==t?void 0:t.type)}function JR(t){var e,i;return!!HR(t)&&!(null==(e=t.capabilities)||null==(i=e.exportMap)||!i.supportsArcadeExpressionForLabeling)}let ZR=qR=class extends lh{constructor(t){super(t),this.type="label",this.name=null,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.maxScale=0,this.minScale=0,this.symbol=$R,this.useCodedValues=void 0,this.where=null}static evaluateWhere(t,e){const i=function(t,e,i){switch(e){case"=":return t==i;case"<>":return t!=i;case">":return t>i;case">=":return t>=i;case"<":return t<i;case"<=":return t<=i}return!1};try{if(null==t)return!0;const s=t.split(" ");if(3===s.length)return i(e[s[0]],s[1],s[2]);if(7===s.length){const t=i(e[s[0]],s[1],s[2]),n=s[3],r=i(e[s[4]],s[5],s[6]);switch(n){case"AND":return t&&r;case"OR":return t||r}}return!1}catch(e){console.log("Error.: can't parse = "+t)}}readLabelExpression(t,e){const i=e.labelExpressionInfo;if(!i||!i.value&&!i.expression)return t}writeLabelExpression(t,e,i){if(this.labelExpressionInfo)if(null!=this.labelExpressionInfo.value)t=function(t){return t.replace(/\{/g,"[").replace(/\}/g,"]")}(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){const e=OR(this.labelExpressionInfo.expression);e&&(t="["+e+"]")}null!=t&&(e[i]=t)}writeLabelExpressionInfo(t,e,i,s){if(null==t&&null!=this.labelExpression&&WR(s))t=new CR({expression:this.getLabelExpressionArcade()});else if(!t)return;const n=t.toJSON(s);n.expression&&(e[i]=n)}writeMaxScale(t,e){(t||this.minScale)&&(e.maxScale=t)}writeMinScale(t,e){(t||this.maxScale)&&(e.minScale=t)}getLabelExpression(){return xR(this)}getLabelExpressionArcade(){return function(t){const e=xR(t);if(!e)return null;switch(e.type){case"conventional":return kR(e.expression);case"arcade":return e.expression}return null}(this)}getLabelExpressionSingleField(){return function(t){const e=xR(t);if(!e)return null;switch(e.type){case"conventional":return function(t){const e=t.match(IR);return e&&e[1].trim()||null}(e.expression);case"arcade":return OR(e.expression)}return null}(this)}hash(){return JSON.stringify(this)}clone(){return new qR({deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:H(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:H(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};e([Hn({type:String,json:{write:!0}})],ZR.prototype,"name",void 0),e([Hn({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1}}}})],ZR.prototype,"deconflictionStrategy",void 0),e([Hn({type:String,json:{write:{overridePolicy(t,e,i){return this.labelExpressionInfo&&"service"===(null==i?void 0:i.origin)&&JR(i.layer)?{enabled:!1}:{allowNull:!0}}}}})],ZR.prototype,"labelExpression",void 0),e([Rh("labelExpression")],ZR.prototype,"readLabelExpression",null),e([fh("labelExpression")],ZR.prototype,"writeLabelExpression",null),e([Hn({type:CR,json:{write:{overridePolicy:(t,e,i)=>function(t){return WR(t)||JR(t.layer)}(i)?{allowNull:!0}:{enabled:!1}}}})],ZR.prototype,"labelExpressionInfo",void 0),e([fh("labelExpressionInfo")],ZR.prototype,"writeLabelExpressionInfo",null),e([Hn({type:BR.apiValues,json:{type:BR.jsonValues,read:BR.read,write:BR.write}})],ZR.prototype,"labelPlacement",void 0),e([Hn({type:Number})],ZR.prototype,"maxScale",void 0),e([fh("maxScale")],ZR.prototype,"writeMaxScale",null),e([Hn({type:Number})],ZR.prototype,"minScale",void 0),e([fh("minScale")],ZR.prototype,"writeMinScale",null),e([Hn({types:Kj,json:{origins:{"web-scene":{types:Xj,write:gO,default:null}},write:gO,default:null}})],ZR.prototype,"symbol",void 0),e([Hn({type:Boolean,json:{write:!0}})],ZR.prototype,"useCodedValues",void 0),e([Hn({type:String,json:{write:!0}})],ZR.prototype,"where",void 0),ZR=qR=e([_r("esri.layers.support.LabelClass")],ZR);const QR=ZR;var KR;let YR=KR=class extends lh{constructor(t){super(t),this.type="cluster",this.clusterRadius=tx("80px"),this.clusterMinSize=tx("12px"),this.clusterMaxSize=tx("50px"),this.popupEnabled=!0,this.popupTemplate=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=null}clone(){return new KR({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:H(this.labelingInfo),labelsVisible:this.labelsVisible,fields:H(this.fields),popupEnabled:this.popupEnabled,popupTemplate:H(this.popupTemplate)})}};e([Hn({type:["cluster"],readOnly:!0,json:{write:!0}})],YR.prototype,"type",void 0),e([Hn({type:Number,cast:t=>"auto"===t?t:tx(t),json:{write:!0}})],YR.prototype,"clusterRadius",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],YR.prototype,"clusterMinSize",void 0),e([Hn({type:Number,cast:tx,json:{write:!0}})],YR.prototype,"clusterMaxSize",void 0),e([Hn(wL)],YR.prototype,"popupEnabled",void 0),e([Hn({type:PS,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],YR.prototype,"popupTemplate",void 0),e([Hn({types:Jj})],YR.prototype,"symbol",void 0),e([Hn({type:[QR],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],YR.prototype,"labelingInfo",void 0),e([Hn(bL)],YR.prototype,"labelsVisible",void 0),e([Hn({type:[vR],json:{write:!0}})],YR.prototype,"fields",void 0),YR=KR=e([_r("esri.layers.support.FeatureReductionCluster")],YR);const XR=YR;var tN;let eN=tN=class extends dR{constructor(t){super(t),this.type="selection"}clone(){return new tN}};e([Hn({type:["selection"]})],eN.prototype,"type",void 0),eN=tN=e([_r("esri.layers.support.FeatureReductionSelection")],eN);const iN=eN,sN={types:{key:"type",base:dR,typeMap:{selection:iN,cluster:XR}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:{key:"type",base:dR,typeMap:{selection:XR}}},"web-scene":{types:{key:"type",base:dR,typeMap:{selection:iN}}}}}},nN=new vo({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let rN=class extends lh{constructor(t){super(t),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};e([Hn({json:{write:!0}})],rN.prototype,"name",void 0),e([Hn({json:{write:!0}})],rN.prototype,"description",void 0),e([Hn({json:{read:nN.read,write:nN.write}})],rN.prototype,"drawingTool",void 0),e([Hn({json:{write:!0}})],rN.prototype,"prototype",void 0),e([Hn({json:{write:!0}})],rN.prototype,"thumbnail",void 0),rN=e([_r("esri.layers.support.FeatureTemplate")],rN);const oN=rN;let aN=class extends lh{constructor(t){super(t),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(t){const e={};for(const i of Object.keys(t))e[i]=OF(t[i]);return e}writeDomains(t,e){const i={};for(const e of Object.keys(t)){var s;t[e]&&(i[e]=null==(s=t[e])?void 0:s.toJSON())}e.domains=i}};e([Hn({json:{write:!0}})],aN.prototype,"id",void 0),e([Hn({json:{write:!0}})],aN.prototype,"name",void 0),e([Hn({json:{write:!0}})],aN.prototype,"domains",void 0),e([Rh("domains")],aN.prototype,"readDomains",null),e([fh("domains")],aN.prototype,"writeDomains",null),e([Hn({type:[oN],json:{write:!0}})],aN.prototype,"templates",void 0),aN=e([_r("esri.layers.support.FeatureType")],aN);const lN=aN;function uN(t){return"date"===t.type||"esriFieldTypeDate"===t.type}function cN(t){return"oid"===t.type||"esriFieldTypeOID"===t.type}function hN(t){return"global-id"===t.type||"esriFieldTypeGlobalID"===t.type}class dN{constructor(t){if(this.fields=t,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this.dateFields=[],this.numericFields=[],this._requiredFields=null,!t)return;const e=[];for(const i of t){const t=i&&i.name;if(t){const s=fN(t);this._fieldsMap.set(t,i),this._fieldsMap.set(s,i),e.push(s),uN(i)?(this.dateFields.push(i),this._dateFieldsSet.add(i)):Vb(i)&&(this._numericFieldsSet.add(i),this.numericFields.push(i)),cN(i)||hN(i)||(i.editable=null==i.editable||!!i.editable,i.nullable=null==i.nullable||!!i.nullable)}}e.sort(),this.uid=e.join(",")}destroy(){this._fieldsMap.clear()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const t of this.fields)cN(t)||hN(t)||t.nullable||void 0!==Ob(t)||this._requiredFields.push(t)}return this._requiredFields}has(t){return null!=this.get(t)}get(t){return null!=t?this._fieldsMap.get(t)||this._fieldsMap.get(fN(t)):void 0}isDateField(t){return this._dateFieldsSet.has(this.get(t))}isNumericField(t){return this._numericFieldsSet.has(this.get(t))}normalizeFieldName(t){const e=this.get(t);if(e)return e.name}}function fN(t){return t.toLowerCase().trim()}const pN=ct.getLogger("esri.layers.support.fieldProperties");function yN(){return{fields:{type:[rP],value:null},fieldsIndex:{readOnly:!0,get(){return new dN(this.fields||[])}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){const t=this._userOutFields;if(!t||!t.length)return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const e of t)this.fieldsIndex.has(e)||pN.error("field-attributes-layer:invalid-field",`Invalid field ${e} found in outFields`,{layer:this,outFields:t});return yb(this.fieldsIndex,t)}}}}let mN=class extends lh{constructor(t){super(t),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};e([Hn({type:String,json:{read:{source:"shapeAreaFieldName"}}})],mN.prototype,"shapeAreaField",void 0),e([Hn({type:String,json:{read:{source:"shapeLengthFieldName"}}})],mN.prototype,"shapeLengthField",void 0),e([Hn({type:String,json:{read:t=>Bm.read(t)||Wm.read(t)}})],mN.prototype,"units",void 0),mN=e([_r("esri.layers.support.GeometryFieldsInfo")],mN);const gN=mN,vN=/\[([^\[\]]+)\]/gi;function wN(t,e,i){return t?t.map((t=>{const s=new QR;if(s.read(t,i),s.labelExpression){const t=e.fields||e.layerDefinition&&e.layerDefinition.fields||this.fields;s.labelExpression=s.labelExpression.replace(vN,((e,i)=>`[${function(t,e){if(!e)return t;const i=t.toLowerCase();for(let t=0;t<e.length;t++){const s=e[t].name;if(s.toLowerCase()===i)return s}return t}(i,t)}]`))}return s})):null}var bN;let MN=bN=class extends lh{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new Jr}clone(){return new bN({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};e([Hn({type:String,json:{write:!0}})],MN.prototype,"floorField",void 0),e([Hn({json:{read:!1,write:!1}})],MN.prototype,"viewAllMode",void 0),e([Hn({json:{read:!1,write:!1}})],MN.prototype,"viewAllLevelIds",void 0),MN=bN=e([_r("esri.layers.support.LayerFloorInfo")],MN);const SN=MN,xN=new vo({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),kN=new vo({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let IN=class extends lh{constructor(t){super(t),this.cardinality=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};e([Hn({json:{read:xN.read,write:xN.write}})],IN.prototype,"cardinality",void 0),e([Hn({json:{read:!0,write:!0}})],IN.prototype,"composite",void 0),e([Hn({json:{read:!0,write:!0}})],IN.prototype,"id",void 0),e([Hn({json:{read:!0,write:!0}})],IN.prototype,"keyField",void 0),e([Hn({json:{read:!0,write:!0}})],IN.prototype,"keyFieldInRelationshipTable",void 0),e([Hn({json:{read:!0,write:!0}})],IN.prototype,"name",void 0),e([Hn({json:{read:!0,write:!0}})],IN.prototype,"relatedTableId",void 0),e([Hn({json:{read:!0,write:!0}})],IN.prototype,"relationshipTableId",void 0),e([Hn({json:{read:kN.read,write:kN.write}})],IN.prototype,"role",void 0),IN=e([_r("esri.layers.support.Relationship")],IN);const jN=IN;async function _N(t,e,i){const s=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(s&&"unique-value"===s.type&&s.styleOrigin){const n=await uh(s.populateFromStyle());if(Ee(i),!1===n.ok){const i=n.error;e&&e.messages&&e.messages.push(new Qn("renderer:style-reference","Failed to create unique value renderer from style reference: "+i.message,{error:i,context:e})),t.clear("renderer",e.origin)}}}var TN;let ON=TN=class extends lh{constructor(t){super(t),this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,this.start>0&&null==this.where&&(e.definitionExpression="1=1")}clone(){return new TN(H({dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};e([Hn({type:VE,json:{write:!0}})],ON.prototype,"dynamicDataSource",void 0),e([Hn({type:String,json:{write:!0}})],ON.prototype,"gdbVersion",void 0),e([Hn({type:Number,json:{write:!0}})],ON.prototype,"geometryPrecision",void 0),e([Hn({type:Date})],ON.prototype,"historicMoment",void 0),e([fh("historicMoment")],ON.prototype,"_writeHistoricMoment",null),e([Hn({type:Number,json:{write:!0}})],ON.prototype,"maxAllowableOffset",void 0),e([Hn({type:[Number],json:{write:!0}})],ON.prototype,"objectIds",void 0),e([Hn({type:[String],json:{write:!0}})],ON.prototype,"orderByFields",void 0),e([Hn({type:[String],json:{write:!0}})],ON.prototype,"outFields",void 0),e([Hn({type:Lh,json:{read:{source:"outSR"},write:{target:"outSR"}}})],ON.prototype,"outSpatialReference",void 0),e([Hn({json:{write:!0}})],ON.prototype,"relationshipId",void 0),e([Hn({type:Number,json:{read:{source:"resultOffset"}}})],ON.prototype,"start",void 0),e([fh("start"),fh("num")],ON.prototype,"writeStart",null),e([Hn({type:Number,json:{read:{source:"resultRecordCount"}}})],ON.prototype,"num",void 0),e([Hn({json:{write:!0}})],ON.prototype,"returnGeometry",void 0),e([Hn({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],ON.prototype,"returnM",void 0),e([Hn({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],ON.prototype,"returnZ",void 0),e([Hn({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],ON.prototype,"where",void 0),ON=TN=e([_r("esri.rest.support.RelationshipQuery")],ON),ON.from=Ln(ON);const AN=ON;var FN;let CN=FN=class extends lh{constructor(t){super(t),this.groupByFields=void 0,this.topCount=void 0,this.orderByFields=void 0}clone(){return new FN({groupByFields:this.groupByFields,topCount:this.topCount,orderByFields:this.orderByFields})}};e([Hn({type:[String],json:{write:!0}})],CN.prototype,"groupByFields",void 0),e([Hn({type:Number,json:{write:!0}})],CN.prototype,"topCount",void 0),e([Hn({type:[String],json:{write:!0}})],CN.prototype,"orderByFields",void 0),CN=FN=e([_r("esri.rest.support.TopFilter")],CN);const PN=CN;var EN;const LN=new vo({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),RN=new vo({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let NN=EN=class extends lh{constructor(t){super(t),this.cacheHint=void 0,this.distance=void 0,this.geometry=null,this.geometryPrecision=void 0,this.maxAllowableOffset=void 0,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.resultType=null,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.start=void 0,this.spatialRelationship="intersects",this.timeExtent=null,this.topFilter=void 0,this.units=null,this.where="1=1"}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new EN(H({cacheHint:this.cacheHint,distance:this.distance,geometry:this.geometry,geometryPrecision:this.geometryPrecision,maxAllowableOffset:this.maxAllowableOffset,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,resultType:this.resultType,returnGeometry:this.returnGeometry,returnZ:this.returnZ,returnM:this.returnM,start:this.start,spatialRelationship:this.spatialRelationship,timeExtent:this.timeExtent,topFilter:this.topFilter,units:this.units,where:this.where}))}};e([Hn({type:Boolean,json:{write:!0}})],NN.prototype,"cacheHint",void 0),e([Hn({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],NN.prototype,"distance",void 0),e([Hn({types:tb,json:{read:Qw,write:!0}})],NN.prototype,"geometry",void 0),e([Hn({type:Number,json:{write:!0}})],NN.prototype,"geometryPrecision",void 0),e([Hn({type:Number,json:{write:!0}})],NN.prototype,"maxAllowableOffset",void 0),e([Hn({type:Number,json:{read:{source:"resultRecordCount"}}})],NN.prototype,"num",void 0),e([Hn({json:{write:!0}})],NN.prototype,"objectIds",void 0),e([Hn({type:[String],json:{write:!0}})],NN.prototype,"orderByFields",void 0),e([Hn({type:[String],json:{write:!0}})],NN.prototype,"outFields",void 0),e([Hn({type:Lh,json:{read:{source:"outSR"},write:{target:"outSR"}}})],NN.prototype,"outSpatialReference",void 0),e([Hn({type:String,json:{write:!0}})],NN.prototype,"resultType",void 0),e([Hn({json:{write:!0}})],NN.prototype,"returnGeometry",void 0),e([Hn({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],NN.prototype,"returnM",void 0),e([Hn({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],NN.prototype,"returnZ",void 0),e([Hn({type:Number,json:{read:{source:"resultOffset"}}})],NN.prototype,"start",void 0),e([fh("start"),fh("num")],NN.prototype,"writeStart",null),e([Hn({type:String,json:{read:{source:"spatialRel",reader:LN.read},write:{target:"spatialRel",writer:LN.write}}})],NN.prototype,"spatialRelationship",void 0),e([Hn({type:ME,json:{write:!0}})],NN.prototype,"timeExtent",void 0),e([Hn({type:PN,json:{write:!0}})],NN.prototype,"topFilter",void 0),e([Hn({type:String,json:{read:RN.read,write:{writer:RN.write,overridePolicy(t){return{enabled:t&&this.distance>0}}}}})],NN.prototype,"units",void 0),e([Hn({type:String,json:{write:!0}})],NN.prototype,"where",void 0),NN=EN=e([_r("esri.rest.support.TopFeaturesQuery")],NN),NN.from=Ln(NN);const DN=NN,VN=["oid","global-id"],$N=["oid","global-id","guid"];function zN({displayField:t,editFieldsInfo:e,fields:i,objectIdField:s,title:n},r){if(!i)return null;const o=function({editFieldsInfo:t,fields:e,objectIdField:i},s){return function(t,e){const i=t;return e&&(t=t.filter((t=>-1===e.indexOf(t.type)))),t===i&&(t=t.slice()),t.sort(qN),t}(e,(null==s?void 0:s.ignoreFieldTypes)||ZN).map((e=>new yM({fieldName:e.name,isEditable:WN(e,t),label:e.alias,format:HN(e),visible:UN(e,{editFieldsInfo:t,objectIdField:i,visibleFieldNames:null==s?void 0:s.visibleFieldNames})})))}({editFieldsInfo:e,fields:i,objectIdField:s},r);if(!o.length)return null;const a=function(t){const e=function({displayField:t,fields:e}){return t||(e&&e.length?Mb(e,"name-or-title")||Mb(e,"unique-identifier")||Mb(e,"type-or-category")||function(t){for(const e of t){if(!e||!e.name)continue;const t=e.name.toLowerCase();if(t.indexOf("name")>-1||t.indexOf("title")>-1)return e.name}return null}(e):null)}(t),{titleBase:i}=t;return e?`${i}: {${e.trim()}}`:i}({titleBase:n,fields:i,displayField:t}),l=[new vM,new nM];return new PS({title:a,content:l,fieldInfos:o})}const GN=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],UN=(t,{editFieldsInfo:e,objectIdField:i,visibleFieldNames:s})=>s?s.has(t.name):!(BN(t.name,e)||i&&t.name===i||VN.indexOf(t.type)>-1||GN.some((e=>e.test(t.name))));function qN(t,e){return"oid"===t.type?-1:"oid"===e.type?1:JN(t)?-1:JN(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function BN(t,e){if(!t||!e)return!1;const{creationDateField:i,creatorField:s,editDateField:n,editorField:r}=e;return-1!==[i&&i.toLowerCase(),s&&s.toLowerCase(),n&&n.toLowerCase(),r&&r.toLowerCase()].indexOf(t.toLowerCase())}function WN(t,e){return t.editable&&-1===$N.indexOf(t.type)&&!BN(t.name,e)}function HN(t){switch(t.type){case"small-integer":case"integer":case"single":return new dM({digitSeparator:!0,places:0});case"double":return new dM({digitSeparator:!0,places:2});case"date":return new dM({dateFormat:"long-month-day-year"});default:return null}}function JN(t){return"name"===(t.name&&t.name.toLowerCase())||"name"===(t.alias&&t.alias.toLowerCase())||void 0}const ZN=["geometry","blob","raster","guid","xml"],QN=new vo({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),KN={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"},YN="FeatureLayer",XN=ct.getLogger("esri.layers.FeatureLayer");function tD(t){return t&&t instanceof Jr}function eD(t,e,i){return!!(t&&t.hasOwnProperty(e)?t[e]:i)}function iD(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i}const sD=yN();function nD(t,e,i){const s=!(null==i||!i.writeLayerSchema);return{enabled:s,ignoreOrigin:s}}let rD=class extends(aL(hE(VL(lR(KL(QL(FP(CL(zL(GA(dE(pP(sC))))))))))))){constructor(...t){super(...t),this._handles=new Qr,this.capabilities=null,this.charts=null,this.copyright=null,this.datesInUnknownTimezone=!1,this.displayField=null,this.definitionExpression=null,this.dynamicDataSource=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.featureReduction=null,this.fields=null,this.fieldsIndex=null,this.floorInfo=null,this.formTemplate=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.layerId=void 0,this.legendEnabled=!0,this.minScale=0,this.maxScale=0,this.globalIdField=null,this.objectIdField=null,this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.relationships=null,this.sourceJSON=null,this.returnM=void 0,this.returnZ=void 0,this.screenSizePerspectiveEnabled=!0,this.serviceDefinitionExpression=null,this.spatialReference=Lh.WGS84,this.subtypeCode=null,this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.trackIdField=null,this.type="feature",this.typeIdField=null,this.types=null,this.indexes=new(Jr.ofType(cR)),this.userIsAdmin=!1,this.version=void 0,this.visible=!0}destroy(){var t;null==(t=this.source)||t.destroy(),this._handles=m(this._handles)}normalizeCtorArgs(t,e){return"string"==typeof t?{url:t,...e}:t}load(t){const e=u(t)?t.signal:null;if(this.portalItem&&this.portalItem.loaded&&this.source)return void this.addResolvingPromise(this.createGraphicsSource(e).then((t=>this._initLayerProperties(t))));const i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]},t).catch(Ne).then((async()=>{if(this.url&&null==this.layerId&&/FeatureServer|MapServer\/*$/i.test(this.url)){const t=await this._fetchFirstLayerId(e);null!=t&&(this.layerId=t)}if(!this.url&&!this._hasMemorySource())throw new dt("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this._initLayerProperties(await this.createGraphicsSource(e))})).then((()=>this.finishLoadEditablePortalLayer(t)));return this.addResolvingPromise(i),Promise.resolve(this)}readCapabilities(t,e){return{attachment:this._readAttachmentCapabilities((e=e.layerDefinition||e).attachmentProperties),data:this._readDataCapabilities(e),metadata:this._readMetadataCapabilities(e),operations:this._readOperationsCapabilities(e.capabilities||t,e),query:this._readQueryCapabilities(e),queryRelated:this._readQueryRelatedCapabilities(e),editing:this._readEditingCapabilities(e)}}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")||0)+1}get editingEnabled(){return!(this.loaded&&!this.capabilities.operations.supportsEditing)&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(t){null!=t?this._override("editingEnabled",t):this._clearOverride("editingEnabled")}readEditingEnabled(t,e){return this._readEditingEnabled(e,!1)}readEditingEnabledFromWebMap(t,e,i){return this._readEditingEnabled(e,!0,i)}writeEditingEnabled(t,e){this._writeEditingEnabled(t,e,!1)}writeEditingEnabledToWebMap(t,e,i,s){this._writeEditingEnabled(t,e,!0,s)}readEditingInfo(t,e){const{editingInfo:i}=e;return i?{lastEditDate:null!=i.lastEditDate?new Date(i.lastEditDate):null}:null}readIsTable(t,e){return"Table"===(e=e&&e.layerDefinition||e).type||!e.geometryType}writeIsTable(t,e,i,s){null!=s&&s.writeLayerSchema&&K(i,t?"Table":"Feature Layer",e)}readMinScale(t,e){return e.effectiveMinScale||t||0}readMaxScale(t,e){return e.effectiveMaxScale||t||0}readGlobalIdFieldFromService(t,e){if((e=e.layerDefinition||e).globalIdField)return e.globalIdField;if(e.fields)for(const t of e.fields)if("esriFieldTypeGlobalID"===t.type)return t.name}readObjectIdFieldFromService(t,e){if((e=e.layerDefinition||e).objectIdField)return e.objectIdField;if(e.fields)for(const t of e.fields)if("esriFieldTypeOID"===t.type)return t.name}get parsedUrl(){const t=this.url?Tt(this.url):null;return null!=t&&(null!=this.dynamicDataSource?t.path=Wt(t.path,"dynamicLayer"):null!=this.layerId&&(t.path=Wt(t.path,""+this.layerId))),t}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(t){hb(t,this.fieldsIndex),this._set("renderer",t)}readRenderer(t,e,i){const s=(e=e.layerDefinition||e).drawingInfo&&e.drawingInfo.renderer||void 0;if(s){const t=LA(s,e,i)||void 0;return t||XN.error("Failed to create renderer",{rendererDefinition:e.drawingInfo.renderer,layer:this,context:i}),t}if(e.defaultSymbol)return e.types&&e.types.length?new AA({defaultSymbol:oD(e.defaultSymbol,e,i),field:e.typeIdField,uniqueValueInfos:e.types.map((t=>({id:t.id,symbol:oD(t.symbol,t,i)})))}):new rA({symbol:oD(e.defaultSymbol,e,i)})}set source(t){const e=this._get("source");e!==t&&(tD(e)&&this._resetMemorySource(e),tD(t)&&this._initMemorySource(t),this._set("source",t))}castSource(t){return t?Array.isArray(t)||t instanceof Jr?new fP({layer:this,items:t}):t:null}readSource(t,e){const i=lP.fromJSON(e.featureSet);return new fP({layer:this,items:i&&i.features||[]})}readServiceDefinitionExpression(t,e){return e.definitionQuery||e.definitionExpression}readTemplates(t,e){const i=e.editFieldsInfo,s=i&&i.creatorField,n=i&&i.editorField;return t=t&&t.map((t=>oN.fromJSON(t))),this._fixTemplates(t,s),this._fixTemplates(t,n),t}readTitle(t,e){const i=e.layerDefinition&&e.layerDefinition.name||e.name,s=e.title||e.layerDefinition&&e.layerDefinition.title;if(i){const t=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?kP(this.url,i):i;let e=i;if(!e&&this.url){const t=MP(this.url);u(t)&&(e=t.title)}if(!e)return;return"item-title-and-service-name"===this.sublayerTitleMode&&t&&t!==e&&(e=t+" - "+e),xP(e)}if("item-title"===this.sublayerTitleMode&&s)return s}readTitleFromWebMap(t,e){return e.title||e.layerDefinition&&e.layerDefinition.name}readTypeIdField(t,e){let i=(e=e.layerDefinition||e).typeIdField;if(i&&e.fields){i=i.toLowerCase();const t=e.fields.find((t=>t.name.toLowerCase()===i));t&&(i=t.name)}return i}readTypes(t,e){t=(e=e.layerDefinition||e).types;const i=e.editFieldsInfo,s=i&&i.creatorField,n=i&&i.editorField;return t&&t.map((t=>(t=lN.fromJSON(t),this._fixTemplates(t.templates,s),this._fixTemplates(t.templates,n),t)))}set url(t){const e=_P({layer:this,url:t,nonStandardUrlAllowed:!0,logger:XN});this._set("url",e.url),null!=e.layerId&&this._set("layerId",e.layerId)}writeUrl(t,e,i,s){TP(this,t,null,e,s)}readVersion(t,e){return e.currentVersion?e.currentVersion:e.hasOwnProperty("capabilities")||e.hasOwnProperty("drawingInfo")||e.hasOwnProperty("hasAttachments")||e.hasOwnProperty("htmlPopupType")||e.hasOwnProperty("relationships")||e.hasOwnProperty("timeInfo")||e.hasOwnProperty("typeIdField")||e.hasOwnProperty("types")?10:9.3}readVisible(t,e){return e.layerDefinition&&null!=e.layerDefinition.defaultVisibility?!!e.layerDefinition.defaultVisibility:null!=e.visibility?!!e.visibility:void 0}addAttachment(t,e){return this.load().then((()=>this._checkAttachmentSupport(t))).then((()=>{if(!("addAttachment"in this.source))throw new dt(YN,"Layer source does not support addAttachment capability");return this.source.addAttachment(t,e)}))}updateAttachment(t,e,i){return this.load().then((()=>this._checkAttachmentSupport(t))).then((()=>{if(!("updateAttachment"in this.source))throw new dt(YN,"Layer source does not support updateAttachment capability");return this.source.updateAttachment(t,e,i)}))}async applyEdits(t,e){const i=await import("./p-c3ee51b2.js");return await this.load(),i.applyEdits(this,this.source,t,e)}on(t,e){return super.on(t,e)}createPopupTemplate(t){return zN(this,t)}async createGraphicsSource(t){if(this._hasMemorySource())return this.source.load({signal:t});const{default:e}=await ze(import("./p-6e443d26.js"),t);return new e({layer:this}).load({signal:t})}createQuery(){const t=new YE,e=this.get("capabilities.data");t.dynamicDataSource=this.dynamicDataSource,t.gdbVersion=this.gdbVersion,t.historicMoment=this.historicMoment,t.returnGeometry=!0,e&&(e.supportsZ&&null!=this.returnZ&&(t.returnZ=this.returnZ),e.supportsM&&null!=this.returnM&&(t.returnM=this.returnM)),t.outFields=["*"],t.where=this.definitionExpression||"1=1";const{timeOffset:i,timeExtent:s}=this;return t.timeExtent=null!=i&&null!=s?s.offset(-i.value,i.unit):s||null,t.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,t}deleteAttachments(t,e){return this.load().then((()=>this._checkAttachmentSupport(t))).then((()=>{if(!("deleteAttachments"in this.source))throw new dt(YN,"Layer source does not support deleteAttachments capability");return this.source.deleteAttachments(t,e)}))}fetchRecomputedExtents(t){return this.load({signal:null==t?void 0:t.signal}).then((()=>{if(this.source.fetchRecomputedExtents)return this.source.fetchRecomputedExtents(t);throw new dt(YN,"Layer source does not support fetchUpdates capability")}))}getFeatureType(t){const{typeIdField:e,types:i}=this;if(!e||!t)return null;const s=t.attributes?t.attributes[e]:void 0;if(null==s)return null;let n=null;return i.some((t=>{const{id:e}=t;return null!=e&&(""+e==""+s&&(n=t),!!n)})),n}getFieldDomain(t,e){const i=this.getFeatureType(e&&e.feature);if(i){const e=i.domains&&i.domains[t];if(e&&"inherited"!==e.type)return e}return this._getLayerDomain(t)}getField(t){return this.fieldsIndex.get(t)}queryAttachments(t,e){return t=S_.from(t),this.load().then((()=>{if(!this.get("capabilities.data.supportsAttachment"))throw new dt(YN,"this layer doesn't support attachments");const{attachmentTypes:e,objectIds:i,globalIds:s,num:n,size:r,start:o,where:a}=t;if(!this.get("capabilities.operations.supportsQueryAttachments")){const l=e&&e.length,u=s&&s.length,c=r&&r.length;if(i&&i.length>1||l||u||c||n||o||a)throw new dt(YN,"when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported",t)}if(!(i&&i.length||a))throw new dt(YN,"'objectIds' or 'where' are required to perform attachment query",t);if(!("queryAttachments"in this.source))throw new dt(YN,"Layer source does not support queryAttachments capability",t);return this.source.queryAttachments(t)}))}queryFeatures(t,e){return this.load().then((()=>this.source.queryFeatures(YE.from(t)||this.createQuery(),e))).then((t=>{if(null!=t&&t.features)for(const e of t.features)e.layer=e.sourceLayer=this;return t}))}queryObjectIds(t,e){return this.load().then((()=>{if(this.source.queryObjectIds)return this.source.queryObjectIds(YE.from(t)||this.createQuery(),e);throw new dt(YN,"Layer source does not support queryObjectIds capability")}))}queryFeatureCount(t,e){return this.load().then((()=>{if(this.source.queryFeatureCount)return this.source.queryFeatureCount(YE.from(t)||this.createQuery(),e);throw new dt(YN,"Layer source does not support queryFeatureCount capability")}))}queryExtent(t,e){return this.load().then((()=>{if(this.source.queryExtent)return this.source.queryExtent(YE.from(t)||this.createQuery(),e);throw new dt(YN,"Layer source does not support queryExtent capability")}))}queryRelatedFeatures(t,e){return this.load().then((()=>{if("queryRelatedFeatures"in this.source)return this.source.queryRelatedFeatures(AN.from(t),e);throw new dt(YN,"Layer source does not support queryRelatedFeatures capability")}))}queryRelatedFeaturesCount(t,e){return this.load().then((()=>{if("queryRelatedFeaturesCount"in this.source)return this.source.queryRelatedFeaturesCount(AN.from(t),e);throw new dt(YN,"Layer source does not support queryRelatedFeaturesCount capability")}))}queryTopFeatures(t,e){return this.load().then((()=>{if("queryTopFeatures"in this.source&&this.get("capabilities.query.supportsTopFeaturesQuery"))return this.source.queryTopFeatures(DN.from(t),e).then((t=>{if(null!=t&&t.features)for(const e of t.features)e.layer=e.sourceLayer=this;return t}));throw new dt(YN,"Layer source does not support queryTopFeatures capability")}))}queryTopObjectIds(t,e){return this.load().then((()=>{if("queryTopObjectIds"in this.source&&this.get("capabilities.query.supportsTopFeaturesQuery"))return this.source.queryTopObjectIds(DN.from(t),e);throw new dt(YN,"Layer source does not support queryTopObjectIds capability")}))}queryTopFeaturesExtent(t,e){return this.load().then((()=>{if("queryTopExtents"in this.source&&this.get("capabilities.query.supportsTopFeaturesQuery"))return this.source.queryTopExtents(DN.from(t),e);throw new dt(YN,"Layer source does not support queryTopExtents capability")}))}queryTopFeatureCount(t,e){return this.load().then((()=>{if("queryTopCount"in this.source&&this.get("capabilities.query.supportsTopFeaturesQuery"))return this.source.queryTopCount(DN.from(t),e);throw new dt(YN,"Layer source does not support queryFeatureCount capability")}))}read(t,e){const i=t.featureCollection;if(i){const t=i.layers;t&&1===t.length&&(super.read(t[0],e),null!=i.showLegend&&super.read({showLegend:i.showLegend},e))}super.read(t,e),e&&"service"===e.origin&&this.revert(["objectIdField","fields","timeInfo","spatialReference"],"service")}write(t,e){var i,s;const n=(e={...e,writeLayerSchema:null!=(i=null==(s=e)?void 0:s.writeLayerSchema)?i:this._hasMemorySource()}).origin,r=e.layerContainerType,o=e.messages;if(this.isTable){if("web-scene"===n||"web-map"===n&&"tables"!==r)return o&&o.push(new dt("layer:unsupported",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Table source cannot be written to web scenes and web maps`,{layer:this})),null;if(this._hasMemorySource())return o&&o.push(new dt("layer:unsupported",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using an in-memory Table source cannot be written to web scenes and web maps`,{layer:this})),null}else if(this.loaded&&"web-map"===n&&"tables"===r)return o&&o.push(new dt("layer:unsupported",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a non-table source cannot be written to tables in web maps`,{layer:this})),null;return super.write(t,e)}_readEditingEnabled(t,e,i){var s;let n=null==(s=t.layerDefinition)?void 0:s.capabilities;return n?this._hasEditingCapability(n):(n=t.capabilities,e&&"web-map"===(null==i?void 0:i.origin)&&!this._hasMemorySource()&&n?this._hasEditingCapability(n):void 0)}_hasEditingCapability(t){return t.toLowerCase().split(",").map((t=>t.trim())).includes("editing")}_writeEditingEnabled(t,e,i,s){if(!t){var n,r;const t=null!=(n=this.capabilities)&&null!=(r=n.operations)&&r.supportsSync?"Query,Sync":"Query";K("layerDefinition.capabilities",t,e),!i||null!=s&&s.writeLayerSchema||(e.capabilities=t)}}_checkAttachmentSupport(t){const{attributes:e}=t,{objectIdField:i}=this;return this.get("capabilities.data.supportsAttachment")?t?e?e[i]?void 0:Promise.reject(new dt(YN,"feature is missing the identifying attribute "+i)):Promise.reject(new dt(YN,"'attributes' are required on a feature to query attachments")):Promise.reject(new dt(YN,"A feature is required to add/delete/update attachments")):Promise.reject(new dt(YN,"this layer doesn't support attachments"))}_getLayerDomain(t){const e=this.fieldsIndex.get(t);return e?e.domain:null}_fetchFirstLayerId(t){return oi(this.url,{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:t}).then((t=>{const e=t.data;if(e)return Array.isArray(e.layers)&&e.layers.length>0?e.layers[0].id:Array.isArray(e.tables)&&e.tables.length>0?e.tables[0].id:void 0}))}async _initLayerProperties(t){return this._set("source",t),t.sourceJSON&&(this.sourceJSON=t.sourceJSON,this.read(t.sourceJSON,{origin:"service",url:this.parsedUrl})),this._verifySource(),this._verifyFields(),hb(this.renderer,this.fieldsIndex),fb(this.timeInfo,this.fieldsIndex),_N(this,{origin:"service"})}async hasDataChanged(){var t;if(null!=(t=this.source)&&t.refresh)try{var e;const{dataChanged:t,updates:i}=await(null==(e=this.source)?void 0:e.refresh());if(u(i)&&(this.sourceJSON={...this.sourceJSON,...i},this.read(i,{origin:"service",url:this.parsedUrl})),t)return!0}catch{}if(this.definitionExpression)try{return(await async function(t,e){const{WhereClause:i}=await import("./p-c0f8009d.js");return i.create(t,e)}(this.definitionExpression,this.fieldsIndex)).hasDateFunctions}catch{}return!1}_verifyFields(){const t=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+t+")"),this.isTable||this._hasMemorySource()||-1!==t.search(/\/FeatureServer\//i)||this.fields&&this.fields.some((function(t){return"geometry"===t.type}))||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+t+")")}_fixTemplates(t,e){t&&t.forEach((t=>{const i=t.prototype&&t.prototype.attributes;i&&e&&delete i[e]}))}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new dt("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new dt("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(t){t.forEach((t=>{t.layer=this,t.sourceLayer=this})),this._handles.add([t.on("after-add",(t=>{t.item.layer=this,t.item.sourceLayer=this})),t.on("after-remove",(t=>{t.item.layer=null,t.item.sourceLayer=null}))],"fl-source")}_resetMemorySource(t){t.forEach((t=>{t.layer=null,t.sourceLayer=null})),this._handles.remove("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}_readAttachmentCapabilities(t){const e={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1};return t&&Array.isArray(t)&&t.forEach((t=>{const i=KN[t.name];i&&(e[i]=!!t.isEnabled)})),e}_readDataCapabilities(t){return{isVersioned:eD(t,"isDataVersioned",!1),supportsAttachment:eD(t,"hasAttachments",!1),supportsM:eD(t,"hasM",!1),supportsZ:eD(t,"hasZ",!1)}}_readMetadataCapabilities(t){return{supportsAdvancedFieldProperties:eD(t,"supportsFieldDescriptionProperty",!1)}}_readOperationsCapabilities(t,e){const i=t?t.toLowerCase().split(",").map((t=>t.trim())):[],s=i.includes("editing")&&!e.datesInUnknownTimezone;let n=s&&i.includes("create"),r=s&&i.includes("delete"),o=s&&i.includes("update");const a=i.includes("changetracking");return s&&!(n||r||o)&&(n=r=o=!0),{supportsCalculate:eD(e,"supportsCalculate",!1),supportsTruncate:eD(e,"supportsTruncate",!1),supportsValidateSql:eD(e,"supportsValidateSql",!1),supportsAdd:n,supportsDelete:r,supportsEditing:s,supportsChangeTracking:a,supportsQuery:i.includes("query"),supportsQueryAttachments:eD(e.advancedQueryCapabilities,"supportsQueryAttachments",!1),supportsResizeAttachments:eD(e,"supportsAttachmentsResizing",!1),supportsSync:i.includes("sync"),supportsUpdate:o,supportsExceedsLimitStatistics:eD(e,"supportsExceedsLimitStatistics",!1)}}_readQueryCapabilities(t){var e;const i=t.advancedQueryCapabilities,s=t.ownershipBasedAccessControlForFeatures,n=t.archivingInfo,r=null==(e=this.url)?void 0:e.includes("MapServer"),o=!l("mapserver-pbf-enabled")&&r&&this.version<10.81,a=(t.supportedQueryFormats||"").split(",").reduce(((t,e)=>{const i=e.toLowerCase().trim();return i&&t.add(i),t}),new Set);return{supportsStatistics:eD(i,"supportsStatistics",t.supportsStatistics),supportsPercentileStatistics:eD(i,"supportsPercentileStatistics",!1),supportsCentroid:eD(i,"supportsReturningGeometryCentroid",!1),supportsDistance:eD(i,"supportsQueryWithDistance",!1),supportsDistinct:eD(i,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:eD(i,"supportsReturningQueryExtent",!1),supportsGeometryProperties:eD(i,"supportsReturningGeometryProperties",!1),supportsHavingClause:eD(i,"supportsHavingClause",!1),supportsOrderBy:eD(i,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:eD(i,"supportsPagination",!1),supportsQuantization:eD(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:eD(t,"supportsQuantizationEditMode",!1),supportsQueryGeometry:eD(t,"supportsReturningQueryGeometry",!1),supportsResultType:eD(i,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:eD(i,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:eD(i,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:eD(t,"useStandardizedQueries",!1),supportsTopFeaturesQuery:eD(i,"supportsTopFeaturesQuery",!1),supportsQueryByOthers:eD(s,"allowOthersToQuery",!0),supportsHistoricMoment:eD(n,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:!o&&a.has("pbf"),supportsDisjointSpatialRelationship:eD(i,"supportsDisjointSpatialRel",!1),supportsCacheHint:eD(i,"supportsQueryWithCacheHint",!1),maxRecordCountFactor:iD(t,"maxRecordCountFactor",void 0),maxRecordCount:iD(t,"maxRecordCount",void 0),standardMaxRecordCount:iD(t,"standardMaxRecordCount",void 0),tileMaxRecordCount:iD(t,"tileMaxRecordCount",void 0)}}_readQueryRelatedCapabilities(t){const e=t.advancedQueryCapabilities,i=eD(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:eD(e,"supportsQueryRelatedPagination",!1),supportsCount:i,supportsOrderBy:i}}_readEditingCapabilities(t){const e=t.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:eD(t,"allowGeometryUpdates",!0),supportsGlobalId:eD(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:eD(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:eD(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:eD(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:eD(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:eD(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:eD(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:eD(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:eD(e,"allowOthersToUpdate",!0)}}};e([Hn({readOnly:!0,json:{read:!1}})],rD.prototype,"capabilities",void 0),e([Rh("service","capabilities",["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"])],rD.prototype,"readCapabilities",null),e([Hn({json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],rD.prototype,"charts",void 0),e([Hn({readOnly:!0})],rD.prototype,"createQueryVersion",null),e([Hn({type:String,json:{read:{source:"layerDefinition.copyrightText"},origins:{service:{read:{source:"copyrightText"}}}}})],rD.prototype,"copyright",void 0),e([Hn({type:Boolean})],rD.prototype,"datesInUnknownTimezone",void 0),e([Hn({type:String,json:{read:{source:"layerDefinition.displayField"},origins:{service:{read:{source:"displayField"}}}}})],rD.prototype,"displayField",void 0),e([Hn({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],rD.prototype,"definitionExpression",void 0),e([Hn({types:Hj,readOnly:!0})],rD.prototype,"defaultSymbol",void 0),e([Hn({type:VE})],rD.prototype,"dynamicDataSource",void 0),e([Hn({readOnly:!0})],rD.prototype,"editFieldsInfo",void 0),e([Hn({type:Boolean})],rD.prototype,"editingEnabled",null),e([Rh(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],rD.prototype,"readEditingEnabled",null),e([Rh("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],rD.prototype,"readEditingEnabledFromWebMap",null),e([fh(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],rD.prototype,"writeEditingEnabled",null),e([fh("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],rD.prototype,"writeEditingEnabledToWebMap",null),e([Hn({readOnly:!0})],rD.prototype,"editingInfo",void 0),e([Rh("editingInfo")],rD.prototype,"readEditingInfo",null),e([Hn(xL)],rD.prototype,"elevationInfo",void 0),e([Hn(sN)],rD.prototype,"featureReduction",void 0),e([Hn({...sD.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:nD}}}}})],rD.prototype,"fields",void 0),e([Hn(sD.fieldsIndex)],rD.prototype,"fieldsIndex",void 0),e([Hn({type:SN,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],rD.prototype,"floorInfo",void 0),e([Hn({type:WF,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],rD.prototype,"formTemplate",void 0),e([Hn({type:Ld,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}})],rD.prototype,"fullExtent",void 0),e([Hn()],rD.prototype,"gdbVersion",void 0),e([Hn({readOnly:!0,type:gN,json:{read:{source:"geometryProperties"}}})],rD.prototype,"geometryFieldsInfo",void 0),e([Hn({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:QN.read},"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:nD,writer(t,e,i){const s=t?QN.toJSON(t):null;s&&K(i,s,e)}}}},read:{source:"layerDefinition.geometryType",reader:QN.read}}})],rD.prototype,"geometryType",void 0),e([Hn({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}})],rD.prototype,"hasM",void 0),e([Hn({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasZ"}}})],rD.prototype,"hasZ",void 0),e([Hn({readOnly:!0,type:XF})],rD.prototype,"heightModelInfo",void 0),e([Hn({type:Date})],rD.prototype,"historicMoment",void 0),e([Hn(OL)],rD.prototype,"id",void 0),e([Hn({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],rD.prototype,"infoFor3D",void 0),e([Hn({readOnly:!0,json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],rD.prototype,"isTable",void 0),e([Rh("service","isTable",["type","geometryType"]),Rh("isTable",["layerDefinition.type","layerDefinition.geometryType"])],rD.prototype,"readIsTable",null),e([fh("web-map","isTable")],rD.prototype,"writeIsTable",null),e([Hn(bL)],rD.prototype,"labelsVisible",void 0),e([Hn({type:[QR],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:wN},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:wN},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],rD.prototype,"labelingInfo",void 0),e([Hn(jL)],rD.prototype,"opacity",void 0),e([Hn({type:Number,json:{origins:{service:{read:{source:"id"}}},read:!1}})],rD.prototype,"layerId",void 0),e([Hn(SL)],rD.prototype,"legendEnabled",void 0),e([Hn({type:["show","hide"]})],rD.prototype,"listMode",void 0),e([Hn(AL)],rD.prototype,"minScale",void 0),e([Rh("service","minScale",["minScale","effectiveMinScale"])],rD.prototype,"readMinScale",null),e([Hn(FL)],rD.prototype,"maxScale",void 0),e([Rh("service","maxScale",["maxScale","effectiveMaxScale"])],rD.prototype,"readMaxScale",null),e([Hn({type:String})],rD.prototype,"globalIdField",void 0),e([Rh("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"]),Rh("service","globalIdField",["globalIdField","fields"])],rD.prototype,"readGlobalIdFieldFromService",null),e([Hn({type:String,json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:nD}}}}})],rD.prototype,"objectIdField",void 0),e([Rh("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"]),Rh("service","objectIdField",["objectIdField","fields"])],rD.prototype,"readObjectIdFieldFromService",null),e([Hn({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],rD.prototype,"operationalLayerType",void 0),e([Hn(sD.outFields)],rD.prototype,"outFields",void 0),e([Hn({readOnly:!0})],rD.prototype,"parsedUrl",null),e([Hn({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],rD.prototype,"path",void 0),e([Hn(wL)],rD.prototype,"popupEnabled",void 0),e([Hn({type:PS,json:{name:"popupInfo",write:!0}})],rD.prototype,"popupTemplate",void 0),e([Hn({readOnly:!0})],rD.prototype,"defaultPopupTemplate",null),e([Hn({type:[jN],readOnly:!0})],rD.prototype,"relationships",void 0),e([Hn({types:FA,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:CA,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:(t,e,i)=>({ignoreOrigin:null==i?void 0:i.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,i)=>({ignoreOrigin:null==i?void 0:i.writeLayerSchema})}}})],rD.prototype,"renderer",null),e([Rh("service","renderer",["drawingInfo.renderer","defaultSymbol"]),Rh("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],rD.prototype,"readRenderer",null),e([Hn()],rD.prototype,"sourceJSON",void 0),e([Hn({type:Boolean})],rD.prototype,"returnM",void 0),e([Hn({type:Boolean})],rD.prototype,"returnZ",void 0),e([Hn(vL)],rD.prototype,"screenSizePerspectiveEnabled",void 0),e([Hn()],rD.prototype,"source",null),e([xa("source")],rD.prototype,"castSource",null),e([Rh("portal-item","source",["featureSet"]),Rh("web-map","source",["featureSet"])],rD.prototype,"readSource",null),e([Hn({readOnly:!0})],rD.prototype,"serviceDefinitionExpression",void 0),e([Rh("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],rD.prototype,"readServiceDefinitionExpression",null),e([Hn({type:Lh,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:{source:"layerDefinition.extent.spatialReference"}}})],rD.prototype,"spatialReference",void 0),e([Hn({type:Number})],rD.prototype,"subtypeCode",void 0),e([Hn({type:[oN]})],rD.prototype,"templates",void 0),e([Rh("templates",["editFieldsInfo","creatorField","editorField","templates"])],rD.prototype,"readTemplates",null),e([Hn({type:aR})],rD.prototype,"timeInfo",void 0),e([Hn()],rD.prototype,"title",void 0),e([Rh("service","title",["name"]),Rh("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],rD.prototype,"readTitle",null),e([Rh("web-map","title",["layerDefinition.name","title"])],rD.prototype,"readTitleFromWebMap",null),e([Hn({type:String})],rD.prototype,"sublayerTitleMode",void 0),e([Hn({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],rD.prototype,"trackIdField",void 0),e([Hn({json:{read:!1}})],rD.prototype,"type",void 0),e([Hn({type:String})],rD.prototype,"typeIdField",void 0),e([Rh("service","typeIdField"),Rh("typeIdField",["layerDefinition.typeIdField"])],rD.prototype,"readTypeIdField",null),e([Hn({type:[lN]})],rD.prototype,"types",void 0),e([Rh("service","types",["types"]),Rh("types",["layerDefinition.types"])],rD.prototype,"readTypes",null),e([Hn({readOnly:!0,json:{write:!1}})],rD.prototype,"serverGens",void 0),e([Hn({type:Jr.ofType(cR),readOnly:!0})],rD.prototype,"indexes",void 0),e([Hn(ML)],rD.prototype,"url",null),e([fh("url")],rD.prototype,"writeUrl",null),e([Hn({readOnly:!0})],rD.prototype,"userIsAdmin",void 0),e([Hn({json:{origins:{service:{read:!0}},read:!1}})],rD.prototype,"version",void 0),e([Rh("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],rD.prototype,"readVersion",null),e([Hn({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],rD.prototype,"visible",void 0),e([Rh("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],rD.prototype,"readVisible",null),rD=e([_r("esri.layers.FeatureLayer")],rD);const oD=tr({types:Qj}),aD=rD,lD=Object.freeze({__proto__:null,default:aD});function uD(t,e,i,s){return function(t){return"function"==typeof t}(t)?t(e,i,s):t}function cD(t){return[t.r,t.g,t.b,t.a]}function hD(t,e,i){const s=t=>{let e=t.length;for(;e--;)if(-1===" /-,\n".indexOf(t.charAt(e)))return!1;return!0},n=[];let r=0,o=-1;do{if(o=e.indexOf("[",r),o>=r){if(o>r){const t=e.substr(r,o-r);n.push([t,null,s(t)])}if(r=o+1,o=e.indexOf("]",r),o>=r){if(o>r){const i=t[e.substr(r,o-r)];i&&n.push([null,i,!1])}r=o+1}}}while(-1!==o);if(r<e.length-1){const t=e.substr(r);n.push([t,null,s(t)])}return t=>{let e="",s=null;for(const i of n){const[n,r,o]=i;if(n)o?s=n:(s&&(e+=s,s=null),e+=n);else{const i=t.attributes[r];i&&(s&&(e+=s,s=null),e+=i)}}return dD(e,i)}}function dD(t,e){switch("string"!=typeof t&&(t+=""),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function fD(t,e,i,s,n,r,o=!0){const a=e/n,l=i/r,u=Math.ceil(a/2),c=Math.ceil(l/2);for(let i=0;i<r;i++)for(let h=0;h<n;h++){const d=4*(h+(o?r-i-1:i)*n);let f=0,p=0,y=0,m=0,g=0,v=0,w=0;const b=(i+.5)*l;for(let s=Math.floor(i*l);s<(i+1)*l;s++){const i=Math.abs(b-(s+.5))/c,n=(h+.5)*a,r=i*i;for(let i=Math.floor(h*a);i<(h+1)*a;i++){let o=Math.abs(n-(i+.5))/u;const a=Math.sqrt(r+o*o);a>=-1&&a<=1&&(f=2*a*a*a-3*a*a+1,f>0&&(o=4*(i+s*e),w+=f*t[o+3],y+=f,t[o+3]<255&&(f=f*t[o+3]/250),m+=f*t[o],g+=f*t[o+1],v+=f*t[o+2],p+=f))}}s[d]=m/p,s[d+1]=g/p,s[d+2]=v/p,s[d+3]=w/y}}function pD(t){return t?{r:t[0],g:t[1],b:t[2],a:t[3]/255}:{r:0,g:0,b:0,a:0}}function yD(t){var e;return null==(e=t.data)?void 0:e.symbol}function mD(t){return"CIMVectorMarker"===t.type||"CIMPictureMarker"===t.type||"CIMBarChartMarker"===t.type||"CIMCharacterMarker"===t.type||"CIMPieChartMarker"===t.type||"CIMStackedBarChartMarker"===t.type}function gD(t){return"CIMGradientStroke"===t.type||"CIMPictureStroke"===t.type||"CIMSolidStroke"===t.type}function vD(t){return"CIMGradientFill"===t.type||"CIMHatchFill"===t.type||"CIMPictureFill"===t.type||"CIMSolidFill"===t.type||"CIMWaterFill"===t.type}function wD(t){return"CIMMarkerPlacementAlongLineRandomSize"===t.type||"CIMMarkerPlacementAlongLineSameSize"===t.type||"CIMMarkerPlacementAlongLineVariableSize"===t.type||"CIMMarkerPlacementAtExtremities"===t.type||"CIMMarkerPlacementAtMeasuredUnits"===t.type||"CIMMarkerPlacementAtRatioPositions"===t.type||"CIMMarkerPlacementOnLine"===t.type||"CIMMarkerPlacementOnVertices"===t.type}function bD(t){const e=yD(t);if("CIMTextSymbol"===e.type)return e.height;let i=0;if(e.symbolLayers)for(const t of e.symbolLayers)mD(t)&&t.size>i?i=t.size:gD(t)&&t.width>i?i=t.width:vD(t);return i}function MD(t,e,i){const s=yD(t),n=bD(t);0!==n?SD(s,e/n,!1,i):function(t,e){if("CIMTextSymbol"!==t.type){if(t.symbolLayers)for(const i of t.symbolLayers)switch(i.type){case"CIMPictureMarker":case"CIMVectorMarker":i.size=e;break;case"CIMPictureStroke":case"CIMSolidStroke":i.width=e}}else t.height=e}(s,e)}function SD(t,e,i,s){if("CIMTextSymbol"!==t.type){if(i&&t.effects)for(const i of t.effects)kD(i,e);if(t.symbolLayers)for(const i of t.symbolLayers)switch(i.type){case"CIMPictureMarker":case"CIMVectorMarker":xD(i,e,s);break;case"CIMPictureStroke":case"CIMSolidStroke":null!=s&&s.preserveOutlineWidth||(i.width*=e);break;case"CIMPictureFill":i.height*=e,i.offsetX*=e,i.offsetY*=e;break;case"CIMHatchFill":SD(i.lineSymbol,e,!0,{...s,preserveOutlineWidth:!1}),i.offsetX*=e,i.offsetY*=e,i.separation*=e}}else t.height*=e}function xD(t,e,i){if(t.markerPlacement&&function(t,e){switch(wD(t)&&(t.offset*=e),t.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(t.customEndingOffset*=e,t.offsetAlongLine*=e,t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map((t=>t*e));t.placementTemplate=i}break;case"CIMMarkerPlacementAlongLineVariableSize":if(t.maxRandomOffset*=e,t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map((t=>t*e));t.placementTemplate=i}break;case"CIMMarkerPlacementOnLine":t.startPointOffset*=e;break;case"CIMMarkerPlacementAtExtremities":t.offsetAlongLine*=e;break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":t.beginPosition*=e,t.endPosition*=e;break;case"CIMMarkerPlacementPolygonCenter":t.offsetX*=e,t.offsetY*=e;break;case"CIMMarkerPlacementInsidePolygon":t.offsetX*=e,t.offsetY*=e,t.stepX*=e,t.stepY*=e}}(t.markerPlacement,e),t.offsetX*=e,t.offsetY*=e,t.anchorPoint&&"Absolute"===t.anchorPointUnits&&(t.anchorPoint={x:t.anchorPoint.x*e,y:t.anchorPoint.y*e}),t.size*=e,"CIMVectorMarker"===t.type&&t.markerGraphics)for(const s of t.markerGraphics)t.scaleSymbolsProportionally||SD(s.symbol,e,!0,i)}function kD(t,e){switch(t.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":t.width*=e;break;case"CIMGeometricEffectBuffer":t.size*=e;break;case"CIMGeometricEffectCut":t.beginCut*=e,t.endCut*=e,t.middleCut*=e;break;case"CIMGeometricEffectDashes":if(t.customEndingOffset*=e,t.offsetAlongLine*=e,t.dashTemplate&&t.dashTemplate.length){const i=t.dashTemplate.map((t=>t*e));t.dashTemplate=i}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":t.length*=e;break;case"CIMGeometricEffectMove":t.offsetX*=e,t.offsetY*=e;break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":t.offset*=e;break;case"CIMGeometricEffectRegularPolygon":t.radius*=e;break;case"CIMGeometricEffectTaperedPolygon":t.fromWidth*=e,t.length*=e,t.toWidth*=e;break;case"CIMGeometricEffectWave":t.amplitude*=e,t.period*=e}}function ID(t){const e=[];return jD(yD(t),e),e.length?new zS(pD(e[0])):null}function jD(t,e){let i;i="CIMTextSymbol"===t.type?t.symbol:t;const s="CIMPolygonSymbol"===t.type;if(i.symbolLayers)for(const t of i.symbolLayers)if(!(t.colorLocked||s&&(gD(t)||mD(t)&&t.markerPlacement&&wD(t.markerPlacement))))switch(t.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":break;case"CIMVectorMarker":t.markerGraphics.forEach((t=>{jD(t.symbol,e)}));break;case"CIMSolidStroke":case"CIMSolidFill":_D(e,t.color);break;case"CIMHatchFill":jD(t.lineSymbol,e)}}function _D(t,e){for(const i of t)if(i.join(".")===e.join("."))return;t.push(e)}function TD(t,e){e instanceof zS||(e=new zS(e)),OD(yD(t),e)}function OD(t,e){let i;i="CIMTextSymbol"===t.type?t.symbol:t;const s="CIMPolygonSymbol"===t.type;if(i.symbolLayers)for(const t of i.symbolLayers){if(t.colorLocked)continue;if(s&&(gD(t)||mD(t)&&t.markerPlacement&&wD(t.markerPlacement)))continue;const i=e.toArray(0);switch(t.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":break;case"CIMVectorMarker":t.markerGraphics.forEach((t=>{OD(t.symbol,e)}));break;case"CIMSolidStroke":case"CIMSolidFill":t.color=i;break;case"CIMHatchFill":OD(t.lineSymbol,e)}}}class AD{constructor(t,e){this._storage=new PO,this._storage.maxSize=t,e&&this._storage.registerRemoveFunc("",e)}put(t,e){this._storage.put(t,e,1,1)}pop(t){return this._storage.pop(t)}get(t){return this._storage.get(t)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}}const FD="picture-fill",CD="simple-fill",PD="simple-marker",ED=new AD(1e3);function LD(t){const e=t.style;let i=null;if(t)switch(t.type){case PD:"cross"!==e&&"x"!==e&&(i=t.color);break;case CD:"solid"===e?i=t.color:"none"!==e&&(i={type:"pattern",x:0,y:0,src:Ii(`esri/symbols/patterns/${e}.png`),width:5,height:5});break;case FD:i={type:"pattern",src:t.url,width:YS(t.width)*t.xscale,height:YS(t.height)*t.yscale,x:YS(t.xoffset),y:YS(t.yoffset)};break;case"text":i=t.color;break;case"cim":i=ID(t)}return i}function RD(t,e){const i=t+"-"+e;return void 0!==ED.get(i)?Promise.resolve(ED.get(i)):oi(t,{responseType:"image"}).then((t=>{const s=t.data,n=s.naturalWidth,r=s.naturalHeight,o=document.createElement("canvas");o.width=n,o.height=r;const a=o.getContext("2d");a.fillStyle=e,a.fillRect(0,0,n,r),a.globalCompositeOperation="destination-in",a.drawImage(s,0,0);const l=o.toDataURL();return ED.put(i,l),l}))}function ND(t){if(!t)return null;let e;switch(t.type){case CD:case FD:case PD:e=ND(t.outline);break;case"simple-line":{const i=YS(t.width);"none"!==t.style&&0!==i&&(e={color:t.color,style:DD(t.style),width:i,cap:t.cap,join:"miter"===t.join?YS(t.miterLimit):t.join});break}default:e=null}return e}const DD=function(){const t={};return function(e){if(t[e])return t[e];const i=e.replace(/-/g,"");return t[e]=i,i}}(),VD=new zS([128,128,128]),$D=/\/resource\/(.*?)\.svg$/,zD=new zS("white");function GD(t){if(!t)return 0;if(Wj(t)){const e=function(t){const e=t.symbolLayers&&t.symbolLayers.length;if(!e)return;const i=t.symbolLayers.getItemAt(e-1);return"outline"in i?I(i,"outline","size"):void 0}(t);return u(e)?e:0}const e=ND(t);return e&&XS(e.width)||0}function UD(t){if(c(t)||!("symbolLayers"in t)||c(t.symbolLayers))return!1;switch(t.type){case"point-3d":return t.symbolLayers.some((t=>"object"===t.type));case"line-3d":return t.symbolLayers.some((t=>"path"===t.type));case"polygon-3d":return t.symbolLayers.some((t=>"object"===t.type||"extrude"===t.type));default:return!1}}function qD(t,e){const i=e.resource.href;return!l("esri-canvas-svg-support")&&t.styleOrigin&&$D.test(i)?i.replace($D,"/resource/png/$1.png"):i}function BD(t,e){if(null==e)return t;const i=t.toRgba();return i[3]=i[3]*e,new zS(i)}function WD(t,e,i){t&&(e||null!=i)&&(e&&(e=new zS(e)),Wj(t)?function(t,e,i){const s=t.symbolLayers;if(!s)return;const n=t=>{const s=u(t)?t:null;return BD(e=e||s||null!=i&&zD,i)};s.forEach((t=>{if("object"!==t.type||null==t.resource.href||e)if("water"===t.type)t.color=n(t.color);else{const e=u(t.material)?t.material.color:null,s=n(e);c(t.material)?t.material=new gx({color:s}):t.material.color=s,null!=i&&"outline"in t&&u(t.outline)&&u(t.outline.color)&&(t.outline.color=BD(t.outline.color,i))}}))}(t,e,i):Bj(t)&&function(t,e,i){(e=e||t.color)&&(t.color=BD(e,i)),null!=i&&"outline"in t&&t.outline&&t.outline.color&&(t.outline.color=BD(t.outline.color,i))}(t,e,i))}function HD(t){for(const e of t)if("number"==typeof e)return e;return null}function JD(t,e,i){for(let s=0;s<3;s++){const n=t[s];switch(n){case"symbol-value":return null!=i[s]?i[s]/e[s]:1;case"proportional":break;default:if(n&&e[s])return n/e[s]}}return 1}function ZD(t,e,i,s){switch(t){case"proportional":return i*s;case"symbol-value":return null!=e?e:i;default:return t}}async function QD(t,e){if(t&&e)return Wj(t)?async function(t,e){const i=t.symbolLayers;i&&await function(t,e){return Be(t.map((t=>e(t))))}(i,(async t=>async function(t,e){switch(t.type){case"extrude":!function(t,e){t.size="number"==typeof e[2]?e[2]:0}(t,e);break;case"icon":case"line":case"text":!function(t,e){const i=HD(e);u(i)&&(t.size=i)}(t,e);break;case"path":!function(t,e){const i=JD(e,Hf,[t.width,void 0,t.height]);t.width=ZD(e[0],t.width,1,i),t.height=ZD(e[2],t.height,1,i)}(t,e);break;case"object":await async function(t,e){const{resourceSize:i,symbolSize:s}=await async function(t){const e=await import("./p-795c987e.js"),i=await e.computeObjectLayerResourceSize(t,10),{width:s,height:n,depth:r}=t,o=[s,r,n];let a=1;for(let t=0;t<3;t++)if(null!=o[t]){a=o[t]/i[t];break}for(let t=0;t<3;t++)null==o[t]&&(o[t]=i[t]*a);return{resourceSize:i,symbolSize:o}}(t),n=JD(e,i,s);t.width=ZD(e[0],s[0],i[0],n),t.depth=ZD(e[1],s[1],i[1],n),t.height=ZD(e[2],s[2],i[2],n)}(t,e)}}(t,e)))}(t,e):void(Bj(t)&&function(t,e){const i=HD(e);if(!c(i))switch(t.type){case"simple-marker":t.size=i;break;case"picture-marker":{const e=t.width/t.height;e>1?(t.width=i,t.height=i*e):(t.width=i*e,t.height=i);break}case"simple-line":t.width=i;break;case"text":t.font.size=i}}(t,e))}function KD(t,e,i){if(t&&null!=e)if(Wj(t)){const s=t.symbolLayers;s&&s.forEach((t=>{if(t&&"object"===t.type)switch(i){case"tilt":t.tilt=e;break;case"roll":t.roll=e;break;default:t.heading=e}}))}else Bj(t)&&("simple-marker"!==t.type&&"picture-marker"!==t.type&&"text"!==t.type||(t.angle=e))}let YD=null;function XD(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function tV(t,e,i){const{backgroundColor:s,outline:n,dotSize:r}=t,o=i&&i.swatchSize||22,a=Math.round(o*o/r**2*.8),l=window.devicePixelRatio,u=document.createElement("canvas"),c=o*l;u.width=c,u.height=c,u.style.width=u.width/l+"px",u.style.height=u.height/l+"px";const h=u.getContext("2d");if(s&&(h.fillStyle=s.toCss(!0),h.fillRect(0,0,c,c),h.fill()),h.fillStyle=e.toCss(!0),YD&&YD.length/2===a)for(let t=0;t<2*a;t+=2)h.fillRect(YD[t],YD[t+1],r*l,r*l),h.fill();else{YD=[];for(let t=0;t<2*a;t+=2){const t=XD(0,c),e=XD(0,c);YD.push(t,e),h.fillRect(t,e,r*l,r*l),h.fill()}}n&&(n.color&&(h.strokeStyle=n.color.toCss(!0)),h.lineWidth=n.width,h.strokeRect(0,0,c,c));const d=new Image(o,o);return d.src=u.toDataURL(),d.style.filter=i.effect,d}function eV(t,e={}){const i="horizontal"===e.align,s=i?75:24,n=i?24:75,{width:r=s,height:o=n,gradient:a=!0}=e,l=window.devicePixelRatio,u=r*l,c=o*l,h=document.createElement("canvas");h.width=u,h.height=c,h.style.width=r+"px",h.style.height=o+"px";const d=h.getContext("2d");if(a){const e=d.createLinearGradient(0,0,i?u:0,i?0:c),s=t.length,n=1===s?0:1/(s-1);t.forEach(((t,i)=>e.addColorStop(i*n,""+t))),d.fillStyle=e,d.fillRect(0,0,u,c)}else{const e=i?u/t.length:u,s=i?c:c/t.length;let n=0,r=0;for(const o of t)d.fillStyle=""+o,d.fillRect(n,r,e,s),n=i?n+e:0,r=i?0:r+s}const f=document.createElement("div");return f.style.width=r+"px",f.style.height=o+"px",f.style.filter=null==e?void 0:e.effect,f.appendChild(h),f}async function iV(t,e){switch(t.type){case"web-style":{const{previewWebStyleSymbol:i}=await import("./p-eb61ad2f.js");return i(t,iV,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:i}=await import("./p-c3398c92.js");return i(t,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:i}=await import("./p-8e382cf7.js");return i(t,e)}case"cim":{const{previewCIMSymbol:i}=await import("./p-83642948.js");return i(t,e)}default:return}}function sV(t){return t&&"opacity"in t?t.opacity*sV(t.parent):1}async function nV(t,e){var i,s;if(!t)return;const n=t.sourceLayer,r=null!=(i=u(e)&&null!=(s=e.useSourceLayer)&&s?n:t.layer)?i:n,o=sV(r);if(u(t.symbol)&&(!u(e)||!0!==e.ignoreGraphicSymbol)){const i="web-style"===t.symbol.type?await t.symbol.fetchSymbol(u(e)?e.abortOptions:null):t.symbol.clone();return WD(i,null,o),i}const a=u(e)&&e.renderer||r&&"renderer"in r&&r.renderer;let l=a&&"getSymbolAsync"in a?await a.getSymbolAsync(t,e):null;if(!l)return;if(l="web-style"===l.type?await l.fetchSymbol(u(e)?e.abortOptions:null):l.clone(),!("visualVariables"in a)||!a.visualVariables||!a.visualVariables.length)return WD(l,null,o),l;if("arcadeRequiredForVisualVariables"in a&&a.arcadeRequiredForVisualVariables&&(c(e)||c(e.arcade))){const t={...e};t.arcade=await rb(),e=t}const h=await Promise.resolve().then((function(){return XT})),d=[],f=[],p=[],y=[];for(const t of a.visualVariables)switch(t.type){case"color":d.push(t);break;case"opacity":f.push(t);break;case"rotation":y.push(t);break;case"size":t.target||p.push(t)}const m=!!d.length&&d[d.length-1],g=m?h.getColor(m,t,e):null,v=!!f.length&&f[f.length-1];let w=v?h.getOpacity(v,t,e):null;if(null!=o&&(w=null!=w?w*o:o),WD(l,g,w),p.length){const i=h.getAllSizes(p,t,e);await QD(l,i)}for(const i of y)KD(l,h.getRotationAngle(i,t,e),i.axis);return l}function rV(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function oV(t,e,i,s){const n=e[s],r=e[s+1];t[s]=i[0]*n+i[2]*r+i[4],t[s+1]=i[1]*n+i[3]*r+i[5]}function aV(t,e,i,s=0,n=0,r=2){const o=n||e.length/r;for(let n=s;n<o;n++)oV(t,e,i,n*r)}function lV(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function uV(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5];let l=i*r-s*n;return l?(l=1/l,t[0]=r*l,t[1]=-s*l,t[2]=-n*l,t[3]=i*l,t[4]=(n*a-r*o)*l,t[5]=(s*o-i*a)*l,t):null}function cV(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1],h=i[2],d=i[3],f=i[4],p=i[5];return t[0]=s*u+r*c,t[1]=n*u+o*c,t[2]=s*h+r*d,t[3]=n*h+o*d,t[4]=s*f+r*p+a,t[5]=n*f+o*p+l,t}function hV(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=Math.sin(i),c=Math.cos(i);return t[0]=s*c+r*u,t[1]=n*c+o*u,t[2]=s*-u+r*c,t[3]=n*-u+o*c,t[4]=a,t[5]=l,t}function dV(t,e,i){const s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=i[0],u=i[1];return t[0]=e[0]*l,t[1]=s*l,t[2]=n*u,t[3]=r*u,t[4]=o,t[5]=a,t}function fV(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1];return t[0]=s,t[1]=n,t[2]=r,t[3]=o,t[4]=s*u+r*c+a,t[5]=n*u+o*c+l,t}function pV(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=-i,t[3]=s,t[4]=0,t[5]=0,t}function yV(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function mV(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t}function gV(t,e){return e?{...e,query:{...t,...e.query}}:{query:t}}function vV(t){return"string"==typeof t?Tt(t):t}function wV(t,e,i){const s={};for(const n in t){if("declaredClass"===n)continue;const r=t[n];if(null!=r&&"function"!=typeof r)if(Array.isArray(r)){s[n]=[];for(let t=0;t<r.length;t++)s[n][t]=wV(r[t])}else if("object"==typeof r)if(r.toJSON){const t=r.toJSON(i&&i[n]);s[n]=e?t:JSON.stringify(t)}else s[n]=e?r:JSON.stringify(r);else s[n]=r}return s}Object.freeze({__proto__:null,create:rV,clone:function(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},fromValues:function(t,e,i,s,n,r){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=i,o[3]=s,o[4]=n,o[5]=r,o},createView:function(t,e){return new Float32Array(t,e,6)},transform:oV,transformMany:aV}),Object.freeze({__proto__:null,copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},identity:lV,set:function(t,e,i,s,n,r,o){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t[4]=r,t[5]=o,t},invert:uV,determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:cV,rotate:hV,scale:dV,translate:fV,fromRotation:pV,fromScaling:yV,fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},str:function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},frob:function(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)},add:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t},subtract:mV,multiplyScalar:function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t},multiplyScalarAndAdd:function(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t[3]=e[3]+i[3]*s,t[4]=e[4]+i[4]*s,t[5]=e[5]+i[5]*s,t},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},equals:function(t,e){const i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],l=e[0],u=e[1],c=e[2],h=e[3],d=e[4],f=e[5];return Math.abs(i-l)<=Kf*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-u)<=Kf*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(n-c)<=Kf*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-h)<=Kf*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(o-d)<=Kf*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-f)<=Kf*Math.max(1,Math.abs(a),Math.abs(f))},mul:cV,sub:mV});let bV=class extends Ar{constructor(...t){super(...t),this.requestOptions=null,this.url=null}normalizeCtorArgs(t,e){return"string"!=typeof t?t:{url:t,...e}}get parsedUrl(){return this._parseUrl(this.url)}_parseUrl(t){return t?Tt(t):null}_encode(t,e,i){const s={};for(const n in t){if("declaredClass"===n)continue;const r=t[n];if(null!=r&&"function"!=typeof r)if(Array.isArray(r)){s[n]=[];for(let t=0;t<r.length;t++)s[n][t]=this._encode(r[t])}else if("object"==typeof r)if(r.toJSON){const t=r.toJSON(i&&i[n]);s[n]=e?t:JSON.stringify(t)}else s[n]=e?r:JSON.stringify(r);else s[n]=r}return s}};e([Hn({readOnly:!0})],bV.prototype,"parsedUrl",null),e([Hn()],bV.prototype,"requestOptions",void 0),e([Hn({type:String})],bV.prototype,"url",void 0),bV=e([_r("esri.tasks.Task")],bV);const MV=bV,SV=t=>{let i=class extends t{constructor(...t){super(...t),this.goToOverride=null,this.view=null}callGoTo(t){const{view:e}=this;return this.goToOverride?this.goToOverride(e,t):e.goTo(t.target,t.options)}};return e([Hn()],i.prototype,"goToOverride",void 0),e([Hn()],i.prototype,"view",void 0),i=e([_r("esri.widgets.support.GoTo")],i),i};var xV;let kV=xV=class extends lh{constructor(t){super(t),this.type="none"}clone(){return new xV({type:this.type})}};var IV;e([lM({none:"none",stayAbove:"stay-above"})],kV.prototype,"type",void 0),kV=xV=e([_r("esri.ground.NavigationConstraint")],kV);const jV=ct.getLogger("esri.Ground");let _V=IV=class extends(rh(Bc)){constructor(t){super(t),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new Jr;const e=t=>{t.parent&&t.parent!==this&&"remove"in t.parent&&t.parent.remove(t),t.parent=this,"elevation"!==t.type&&"base-elevation"!==t.type&&jV.error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)};this.layers.on("after-add",(t=>e(t.item))),this.layers.on("after-remove",(t=>(t=>{t.parent=null})(t.item)))}initialize(){this.when().catch((t=>{jV.error("#load()","Failed to load ground",t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)e.destroy();this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set layers(t){this._set("layers",Wc(t,this._get("layers")))}writeLayers(t,e,i,s){const n=[];t?(s={...s,layerContainerType:"ground"},t.forEach((t=>{if("write"in t){const e={};(function(t){return()=>t})(t)().write(e,s)&&n.push(e)}else s&&s.messages&&s.messages.push(new dt("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted in the ground`,{layer:t}))})),e.layers=n):e.layers=n}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return hh(this,(t=>{t(this.layers)}))}async queryElevation(t,e){await this.load({signal:null==e?void 0:e.signal});const{ElevationQuery:i}=await import("./p-9d51d07c.js");Ee(e);const s=new i,n=this.layers.filter(TV).toArray();return s.queryAll(n,t,e)}async createElevationSampler(t,e){await this.load({signal:null==e?void 0:e.signal});const{ElevationQuery:i}=await import("./p-9d51d07c.js");Ee(e);const s=new i,n=this.layers.filter(TV).toArray();return s.createSamplerAll(n,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:H(this.surfaceColor),navigationConstraint:H(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new IV({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve(null)}_loadLayersFromJSON(t,e,i){const s=e&&e.origin||"web-scene",n=e&&e.portal||null,r=e&&e.url||null;return import("./p-6e889b5e.js").then((({populateOperationalLayers:e})=>{Ee(i);const o=[];return t.layers&&Array.isArray(t.layers)&&o.push(e(this.layers,t.layers,{context:{origin:s,url:r,portal:n,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"})),Be(o)})).then((()=>{}))}};function TV(t){return"elevation"===t.type||function(t){return t&&"createElevationSampler"in t}(t)}e([Hn({json:{read:!1}})],_V.prototype,"layers",null),e([fh("layers")],_V.prototype,"writeLayers",null),e([Hn({readOnly:!0})],_V.prototype,"resourceInfo",void 0),e([Hn({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:Gn,read:{reader:nx,source:"transparency"},write:{writer:(t,e)=>{e.transparency=sx(t)},target:"transparency"}}})],_V.prototype,"opacity",void 0),e([Hn({type:zS,json:{type:[Gn],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],_V.prototype,"surfaceColor",void 0),e([Hn({type:kV,json:{write:!0}})],_V.prototype,"navigationConstraint",void 0),_V=IV=e([_r("esri.Ground")],_V);const OV=_V;let AV=class extends(zw(Jr)){constructor(t){super(t),this.getCollections=null}initialize(){this.handles.add(on((()=>this.refresh())))}destroy(){this.getCollections=null}refresh(){const t=u(this.getCollections)?this.getCollections():null;if(c(t))return void this.removeAll();let e=0;for(const i of t)u(i)&&(e=this._processCollection(e,i));this.splice(e,this.length)}_createNewInstance(t){return new Jr(t)}_processCollection(t,e){if(!e)return t;const i=this.itemFilterFunction?this.itemFilterFunction:t=>!!t;for(const s of e)if(s){if(i(s)){const e=this.indexOf(s,t);e>=0?e!==t&&this.reorder(s,t):this.add(s,t),++t}if(this.getChildrenFunction){const e=this.getChildrenFunction(s);if(Array.isArray(e))for(const i of e)t=this._processCollection(t,i);else t=this._processCollection(t,e)}}return t}};e([Hn()],AV.prototype,"getCollections",void 0),e([Hn()],AV.prototype,"getChildrenFunction",void 0),e([Hn()],AV.prototype,"itemFilterFunction",void 0),AV=e([_r("esri.core.CollectionFlattener")],AV);const FV=AV;function CV(t){var e;return!(!(t&&t.loaded&&"capabilities"in t&&null!=t&&null!=(e=t.capabilities)&&e.operations&&"supportsEditing"in t.capabilities.operations&&!0===t.capabilities.operations.supportsEditing)||"editingEnabled"in t&&!t.editingEnabled)}const PV=ct.getLogger("esri.support.groundUtils"),EV={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function LV(t){return t&&"group"===t.type}function RV(t,e,i){let s,n;if(t)for(let r=0,o=t.length;r<o;r++){if(s=t.getItemAt(r),s[e]===i)return s;if(LV(s)&&(n=RV(s.layers,e,i),n))return n}}const NV=ct.getLogger("esri.support.LayersMixin"),DV=t=>{let i=class extends t{constructor(...t){super(...t),this.layers=new Jr;const e=t=>{t.parent=this,this.layerAdded(t),"elevation"!==t.type&&"base-elevation"!==t.type||NV.error(`Layer 'title:${t.title}, id:${t.id}' of type '${t.type}' is not supported as an operational layer and will therefore be ignored.`)},i=t=>{t.parent=null,this.layerRemoved(t)};this.layers.on("before-add",(t=>(t=>{t.parent&&"remove"in t.parent&&t.parent.remove(t)})(t.item))),this.layers.on("after-add",(t=>e(t.item))),this.layers.on("after-remove",(t=>i(t.item)))}destroy(){const t=this.layers.removeAll();for(const e of t)this.layerRemoved(e),e.destroy();this.layers.destroy()}set layers(t){this._set("layers",Wc(t,this._get("layers")))}add(t,e){const i=this.layers;if(e=i.getNextIndex(e),t instanceof sC){const s=t;s.parent===this?this.reorder(s,e):i.add(s,e)}else Qe(t)?t.then((t=>{this.destroyed||this.add(t,e)})):NV.error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(t,e){const i=this.layers;e=i.getNextIndex(e),t.slice().forEach((t=>{t.parent!==this?(i.add(t,e),e+=1):this.reorder(t,e)}))}findLayerById(t){return RV(this.layers,"id",t)}findLayerByUid(t){return RV(this.layers,"uid",t)}remove(t){return this.layers.remove(t)}removeMany(t){return this.layers.removeMany(t)}removeAll(){return this.layers.removeAll()}reorder(t,e){return this.layers.reorder(t,e)}layerAdded(t){}layerRemoved(t){}};return e([Hn()],i.prototype,"layers",null),i=e([_r("esri.support.LayersMixin")],i),i},VV="esri.support.TablesMixin",$V=ct.getLogger(VV);function zV(t){return t&&"group"===t.type}function GV(t,e,i){if(t)for(let s=0,n=t.length;s<n;s++){const n=t.getItemAt(s);if(n[e]===i)return n;if(zV(n)){const t=GV(n.tables,e,i);if(t)return t}}}const UV=t=>{let i=class extends t{constructor(...t){super(...t),this.tables=new Jr,this.tables.on("after-add",(t=>{const e=t.item;e.parent&&e.parent!==this&&"tables"in e.parent&&e.parent.tables.remove(e),e.parent=this,"feature"!==e.type&&$V.error(`Layer 'title:${e.title}, id:${e.id}' of type '${e.type}' is not supported as a table and will therefore be ignored.`)})),this.tables.on("after-remove",(t=>{t.item.parent=null}))}destroy(){const t=this.tables.removeAll();for(const e of t)e.destroy();this.tables.destroy()}set tables(t){this._set("tables",Wc(t,this._get("tables")))}findTableById(t){return GV(this.tables,"id",t)}findTableByUid(t){return GV(this.tables,"uid",t)}};return e([Hn()],i.prototype,"tables",null),i=e([_r(VV)],i),i};let qV=class extends(UV(DV(Cr.EventedMixin(Ar)))){constructor(t){super(t),this.allLayers=new FV({getCollections:()=>{var t,e,i;return[null==(t=this.basemap)?void 0:t.baseLayers,null==(e=this.ground)?void 0:e.layers,this.layers,null==(i=this.basemap)?void 0:i.referenceLayers]},getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=new FV({getCollections:()=>[this.tables,this.layers],getChildrenFunction:t=>{const e=[];return"tables"in t&&e.push(t.tables),"layers"in t&&e.push(t.layers),e},itemFilterFunction:t=>{const e=t.parent;return e&&"tables"in e&&e.tables.includes(t)}}),this.basemap=null,this.editableLayers=new FV({getCollections:()=>[this.allLayers],itemFilterFunction:CV}),this.ground=new OV,this._basemapCache={}}destroy(){var t,e;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),null==(t=this.ground)||t.destroy(),null==(e=this.basemap)||e.destroy(),function(t){for(const e in t){const i=t[e];!1===(null==i?void 0:i.destroyed)&&i.destroy(),delete t[e]}}(this._basemapCache),this._basemapCache=null}castBasemap(t){return function(t,e){var i;let s;if("string"==typeof t){if(!(t in df)){const e=Object.entries(df).filter((([t,e])=>it.apiKey&&!e.classic||!it.apiKey&&e.classic&&!e.deprecated)).map((([t])=>`"${t}"`)).join(", ");return kf.warn(`Unable to find basemap definition for: ${t}. Try one of these: ${e}`),null}e&&(s=e[t]),s||(s=Sf.fromId(t),e&&(e[t]=s))}else s=Ln(Sf,t);return null!=(i=s)&&i.destroyed&&(kf.warn("The provided basemap is already destroyed",{basemap:s}),s=null),s}(t,this._basemapCache)}castGround(t){const e=function(t){let e=null;return"string"==typeof t?t in EV?e=new OV({resourceInfo:{data:{layers:[EV[t]]}}}):PV.warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`):e=Ln(OV,t),e}(t);return c(e)?this._get("ground"):e}findLayerById(t){return this.allLayers.find((e=>e.id===t))}findTableById(t){return this.allTables.find((e=>e.id===t))}};e([Hn({readOnly:!0,dependsOn:[]})],qV.prototype,"allLayers",void 0),e([Hn({readOnly:!0})],qV.prototype,"allTables",void 0),e([Hn({type:Sf})],qV.prototype,"basemap",void 0),e([xa("basemap")],qV.prototype,"castBasemap",null),e([Hn({readOnly:!0})],qV.prototype,"editableLayers",void 0),e([Hn({type:OV,nonNullable:!0})],qV.prototype,"ground",void 0),e([xa("ground")],qV.prototype,"castGround",null),qV=e([_r("esri.Map")],qV);const BV=qV;function WV(t){return Math.sqrt(Math.max(t[0]*t[0]+t[4]*t[4]+t[8]*t[8],t[1]*t[1]+t[5]*t[5]+t[9]*t[9],t[2]*t[2]+t[6]*t[6]+t[10]*t[10]))}class HV{constructor(t,e){this.min=t,this.max=e,this.range=e-t}ndiff(t,e=0){return Math.ceil((t-e)/this.range)*this.range+e}_normalize(t,e,i,s=0,n=!1){return(i-=s)<t?i+=this.ndiff(t-i):i>e&&(i-=this.ndiff(i-e)),n&&i===e&&(i=t),i+s}normalize(t,e=0,i=!1){return this._normalize(this.min,this.max,t,e,i)}clamp(t,e=0){return qp(t-e,this.min,this.max)+e}monotonic(t,e,i){return t<e?e:e+this.ndiff(t-e,i)}minimalMonotonic(t,e,i){return this._normalize(t,t+this.range,e,i)}center(t,e,i){return e=this.monotonic(t,e,i),this.normalize((t+e)/2,i)}diff(t,e,i){return this.monotonic(t,e,i)-t}shortestSignedDiff(t,e){t=this.normalize(t);const i=(e=this.normalize(e))-t,s=e<t?this.minimalMonotonic(t,e)-t:e-this.minimalMonotonic(e,t);return Math.abs(i)<Math.abs(s)?i:s}contains(t,e,i){return e=this.minimalMonotonic(t,e),(i=this.minimalMonotonic(t,i))>t&&i<e}}function JV(t){for(const e in t){const i=t[e];i instanceof Function&&(t[e]=i.bind(t))}return t}JV(new HV(0,2*Math.PI)),JV(new HV(-Math.PI,Math.PI));const ZV=JV(new HV(0,360));var QV;let KV=QV=class extends lh{constructor(...t){super(...t),this.position=new ad([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(t,e,i,s){if(t&&"object"==typeof t&&("x"in t||Array.isArray(t))){const n={position:t};return null!=e&&(n.heading=e),null!=i&&(n.tilt=i),null!=s&&(n.fov=s),n}return t}writePosition(t,e,i,s){const n=t.clone();n.x=kn(t.x||0),n.y=kn(t.y||0),n.z=t.hasZ?kn(t.z||0):t.z,e[i]=n.write({},s)}readPosition(t,e){const i=new ad;return i.read(t,e),i.x=kn(i.x||0),i.y=kn(i.y||0),i.z=i.hasZ?kn(i.z||0):i.z,i}equals(t){return!!t&&this.tilt===t.tilt&&this.heading===t.heading&&this.fov===t.fov&&this.position.equals(t.position)}clone(){return new QV({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})}};e([Hn({type:ad,json:{write:{isRequired:!0}}})],KV.prototype,"position",void 0),e([fh("position")],KV.prototype,"writePosition",null),e([Rh("position")],KV.prototype,"readPosition",null),e([Hn({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),xa((t=>ZV.normalize(kn(t))))],KV.prototype,"heading",void 0),e([Hn({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),xa((t=>qp(kn(t),-180,180)))],KV.prototype,"tilt",void 0),e([Hn({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],KV.prototype,"fov",void 0),KV=QV=e([_r("esri.Camera")],KV);const YV=KV;var XV;let t$=XV=class extends lh{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new XV({rotation:this.rotation,scale:this.scale,targetGeometry:u(this.targetGeometry)?this.targetGeometry.clone():null,camera:u(this.camera)?this.camera.clone():null})}};function e$(){return{enabled:!this.camera}}e([Hn({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:e$}}}}})],t$.prototype,"rotation",void 0),e([xa("rotation")],t$.prototype,"castRotation",null),e([Hn({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:e$}}}}})],t$.prototype,"scale",void 0),e([Hn({types:tb,json:{read:Qw,write:!0,origins:{"web-scene":{read:Qw,write:{overridePolicy:e$}}}}})],t$.prototype,"targetGeometry",void 0),e([Hn({type:YV,json:{write:!0}})],t$.prototype,"camera",void 0),t$=XV=e([_r("esri.Viewpoint")],t$);const i$=t$;var s$;let n$=s$=class extends lh{constructor(t){super(t),this.color=new zS([0,0,0,1])}clone(){return new s$(H({color:this.color}))}};e([Hn({type:zS,json:{write:!0}})],n$.prototype,"color",void 0),n$=s$=e([_r("esri.webmap.background.ColorBackground")],n$);const r$=n$,o$={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,s=this.values;return e<=i.xsmall?s.xsmall:e<=i.small?s.small:e<=i.medium?s.medium:e<=i.large?s.large:s.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,s=this.values;return e<=i.xsmall?s.xsmall:e<=i.small?s.small:e<=i.medium?s.medium:e<=i.large?s.large:s.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=this.values;return e[1]>=e[0]?i.portrait:i.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},a$={xsmall:544,small:768,medium:992,large:1200};function l$(t,e){return e?o$[t].valueToClassName[e].split(" "):[]}const u$=t=>{let i=class extends t{constructor(...t){super(...t),this._breakpointsHandles=new Qr,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=a$}initialize(){this._breakpointsHandles.add(Yr(this,["breakpoints","size"],this._updateClassNames))}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=null)}set breakpoints(t){if(t===this._get("breakpoints"))return;const e=function(t){return t&&t.xsmall<t.small&&t.small<t.medium&&t.medium<t.large}(t);if(!e){const t=JSON.stringify(a$,null,2);console.warn("provided breakpoints are not valid, using defaults:"+t)}t=e?t:a$,this._set("breakpoints",{...t})}_updateClassNames(){if(!this.container)return;const t=xs.acquire(),e=xs.acquire();let i,s=!1;for(i in o$){const n=this[i],r=o$[i].getValue({viewSize:this.size,breakpoints:this.breakpoints});n!==r&&(s=!0,this[i]=r,l$(i,n).forEach((t=>e.push(t))),l$(i,r).forEach((e=>t.push(e))))}s&&(this._applyClassNameChanges(t,e),xs.release(t),xs.release(e))}_applyClassNameChanges(t,e){const i=this.container;i&&(e.forEach((t=>i.classList.remove(t))),t.forEach((t=>i.classList.add(t))))}_removeActiveClassNames(){const t=this.container;if(!t)return;let e;for(e in o$)l$(e,this[e]).forEach((e=>t.classList.remove(e)))}};return e([Hn()],i.prototype,"breakpoints",null),e([Hn()],i.prototype,"orientation",void 0),e([Hn()],i.prototype,"widthBreakpoint",void 0),e([Hn()],i.prototype,"heightBreakpoint",void 0),i=e([_r("esri.views.BreakpointsOwner")],i),i};let c$=class extends Ar{constructor(){super(...arguments),this.items=new Jr,this._watchUpdatingTracking=new Vw,this._callbacks=new Map,this._projector=xu(),this._hiddenProjector=xu()}get needsRender(){return this.items.length>0}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(this.items,(t=>{for(const e of t.added){const t=()=>e.render();this._callbacks.set(e,t),this._projector.append(this.surface,t)}for(const e of t.removed){const t=this._projector.detach(this._callbacks.get(e));this.surface.removeChild(t.domNode),this._callbacks.delete(e)}}))}addItem(t){this.items.add(t)}removeItem(t){this.items.remove(t)}destroy(){this.items.removeAll(),this._callbacks.forEach((t=>this._projector.detach(t))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(t){const e=this._hiddenSurface,i=this._hiddenProjector;let s=null;const n=()=>(s=t.render(),s);i.append(e,n),i.renderNow();const r={left:0,top:0,right:0,bottom:0};if(s&&s.domNode){const t=s.domNode.getBoundingClientRect();r.left=t.left,r.top=t.top,r.right=t.right,r.bottom=t.bottom}for(i.detach(n);e.firstChild;)e.removeChild(e.firstChild);return r}overlaps(t,e){const i=this.computeBoundingRect(t),s=this.computeBoundingRect(e);return Math.max(i.left,s.left)<=Math.min(i.right,s.right)&&Math.max(i.top,s.top)<=Math.min(i.bottom,s.bottom)}get hasVisibleItems(){return this.items.some((t=>t.visible))}renderCanvas(t){if(!this.items.some((t=>t.visible)))return;const e=t.getContext("2d");e.save(),e.font="10px "+getComputedStyle(this.surface).fontFamily,this.items.forEach((t=>{e.save(),t.renderCanvas(e),e.restore()})),e.restore()}};e([Hn({readOnly:!0})],c$.prototype,"surface",void 0),e([Hn({readOnly:!0})],c$.prototype,"items",void 0),e([Hn({readOnly:!0})],c$.prototype,"needsRender",null),e([Hn({readOnly:!0})],c$.prototype,"_watchUpdatingTracking",void 0),e([Hn({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],c$.prototype,"updating",void 0),c$=e([_r("esri.views.overlay.ViewOverlay")],c$);const h$=c$;function d$(t,e,i,s){let n=null,r=1e3;"number"==typeof e?(r=e,s=i):(n=null!=e?e:null,r=i);let o,a=0;const l=()=>{a=0,t.apply(s,o)},u=(...t)=>{n&&n.apply(s,t),o=t,r?a||(a=setTimeout(l,r)):l()};return u.remove=()=>{a&&(clearTimeout(a),a=0)},u.forceUpdate=()=>{a&&(clearTimeout(a),l())},u.hasPendingUpdates=()=>!!a,u}const f$=["B","kB","MB","GB","TB"];var p$;const y$={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};let m$=p$=class extends lh{constructor(t){super(t),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null}get orientationInfo(){const{exifInfo:t}=this,e=function(t){const{exifInfo:e,exifName:i,tagName:s}=t;if(!e||!i||!s)return null;const n=e.find((t=>t.name===i));return n?function(t){const{tagName:e,tags:i}=t;if(!i||!e)return null;const s=i.find((t=>t.name===e));return s&&s.value||null}({tagName:s,tags:n.tags}):null}({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:t});return y$[e]||null}clone(){return new p$({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};e([Hn({type:String})],m$.prototype,"contentType",void 0),e([Hn()],m$.prototype,"exifInfo",void 0),e([Hn({readOnly:!0})],m$.prototype,"orientationInfo",null),e([Hn({type:Gn})],m$.prototype,"id",void 0),e([Hn({type:String})],m$.prototype,"globalId",void 0),e([Hn({type:String})],m$.prototype,"keywords",void 0),e([Hn({type:String})],m$.prototype,"name",void 0),e([Hn({json:{read:!1}})],m$.prototype,"parentGlobalId",void 0),e([Hn({json:{read:!1}})],m$.prototype,"parentObjectId",void 0),e([Hn({type:Gn})],m$.prototype,"size",void 0),e([Hn({json:{read:!1}})],m$.prototype,"url",void 0),m$=p$=e([_r("esri.layers.support.AttachmentInfo")],m$);const g$=m$,v$=ct.getLogger("esri.widgets.Feature.support.featureUtils"),w$=/href=(""|'')/gi,b$=/(\{([^\{\r\n]+)\})/g,M$=/\'/g,S$=/^\s*expression\//i,x$=/(\n)/gi,k$=/[\u00A0-\u9999<>\&]/gim,I$=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,j$=/^(?:mailto:|tel:)/,_$="relationships/",T$=Uo("short-date-short-time");function O$(t){if(!c(t))return t.get("sourceLayer")||t.get("layer")}async function A$(t,e){return"function"==typeof t?t.call(null,e):t}function F$(t=""){if(t)return!j$.test(t.trim().toLowerCase())}function C$(t){return!!t&&S$.test(t)}function P$(t,e){const i=function(t,e){if(!C$(e)||!t)return null;const i=e.replace(S$,"").toLowerCase();let s;return t.some((t=>t.name.toLowerCase()===i&&(s=t,!0))),s}(e,null==t?void 0:t.fieldName);return i?i.title||null:t?t.label||t.fieldName:null}function E$(t,e){const i=L$(e,t);return i?i.name:t}function L$(t,e){return t&&"function"==typeof t.getField?t.getField(e):null}function R$(t){return(""+t).trim()}function N$({attributes:t,globalAttributes:e,layer:i,text:s,expressionAttributes:n,fieldInfoMap:r}){return s?D$({formattedAttributes:e,template:$$(s,{...e,...n,...t},i),fieldInfoMap:r}):""}function D$({formattedAttributes:t,template:e,fieldInfoMap:i}){return R$(function(t){return t.replace(w$,"")}(rt(rt(e,(t=>function(t,e){const i=e.get(t.toLowerCase());return`{${i&&i.fieldName||t}}`}(t,i))),t)))}function V$(t,e){return t.replace(b$,((t,i,s)=>{const n=L$(e,s);return n?`{${n.name}}`:i}))}function $$(t,e,i){const s=V$(t,i);return s?s.replace(I$,((t,i,s)=>function(t,e,i){return rt(t,function(t,e=!1){const i={...t};return Object.keys(i).forEach((t=>function(t,e,i=!1){const s=e[t];if("string"==typeof s){const n="%27",r=(i?encodeURIComponent(s):s).replace(M$,n);e[t]=r}}(t,i,e))),i}(i,(e=R$(e))&&"{"!==e[0]))}(t,i||s,e))):s}function z$(t,e){const i=e.fieldName,s=G$(e.fieldInfos,i),n=null==s?void 0:s.clone(),r=e.preventPlacesFormatting,o=e.layer,a=L$(o,i);if(n&&"date"===(null==a?void 0:a.type)){const t=n.format||new dM;t.dateFormat=t.dateFormat||"short-date-short-time",t.dateTimeFormatOptions=function(t){return"feature"===(null==t?void 0:t.type)}(o)&&o.datesInUnknownTimezone||function(t){return!(null==t||!t.layer)}(o)&&function(t){return"map-image"===(null==t?void 0:t.type)}(o.layer)&&o.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,n.format=t}const l=n&&n.format;return"string"==typeof(t=function(t,e){if("string"==typeof t&&e&&null==e.dateFormat&&(null!=e.places||null!=e.digitSeparator)){const e=Number(t);if(!isNaN(e))return e}return t}(t,l))||null==t||null==l?t:r?Zo(t,{...Jo(l),minimumFractionDigits:0,maximumFractionDigits:20}):l.format(t)}function G$(t,e){if(!t||!t.length||!e)return;const i=e.toLowerCase();let s;return t.some((t=>!(!t.fieldName||t.fieldName.toLowerCase()!==i||(s=t,0)))),s}function U$(t){const e=[];if(!t)return e;const{fieldInfos:i,content:s}=t;return i&&e.push(...i),s&&Array.isArray(s)?(s.forEach((t=>{if("fields"===t.type){const i=t&&t.fieldInfos;i&&e.push(...i)}})),e):e}function q$(t){return t.replace(k$,(t=>`&#${t.charCodeAt(0)};`))}function B$(t){return"string"==typeof t?t.replace(x$,'<br class="esri-text-new-line" />'):t}function W$({fieldInfos:t,attributes:e,layer:i,graphic:s,fieldInfoMap:n,relatedInfos:r}){const o={};return null==r||r.forEach((t=>function(t,e){t&&e&&(e.relatedFeatures&&e.relatedFeatures&&e.relatedFeatures.forEach((i=>J$({attributes:t,graphic:i,relatedInfo:e}))),e.relatedStatsFeatures&&e.relatedStatsFeatures&&e.relatedStatsFeatures.forEach((i=>J$({attributes:t,graphic:i,relatedInfo:e}))))}(o,t))),Object.keys(e).forEach((r=>{o[r]=function(t){const{value:e,fieldName:i,fieldInfos:s,fieldInfoMap:n,layer:r,graphic:o}=t;if(null==e)return"";const a=function({fieldName:t,value:e,graphic:i,layer:s}){if(H$(t))return null;if(!s||"function"!=typeof s.getFieldDomain)return null;const n=s.getFieldDomain(t,{feature:i});return n&&"coded-value"===n.type?n.getName(e):null}({fieldName:i,value:e,graphic:o,layer:r});if(a)return a;const l=function({fieldName:t,graphic:e,layer:i}){if(H$(t))return null;if(!i||"function"!=typeof i.getFeatureType)return null;const{typeIdField:s}=i;if(!s||t!==s)return null;const n=i.getFeatureType(e);return n?n.name:null}({fieldName:i,graphic:o,layer:r});if(l)return l;if(n.get(i.toLowerCase()))return z$(e,{fieldInfos:s,fieldName:i,layer:r});const u=r&&r.fieldsIndex;return u&&u.isDateField(i)?qo(e,T$):B$(e)}({fieldName:r,fieldInfos:t,fieldInfoMap:n,layer:i,value:e[r],graphic:s})})),o}function H$(t=""){return!!t&&-1!==t.indexOf(_$)}function J$({attributes:t,graphic:e,relatedInfo:i}){t&&e&&i&&Object.keys(e.attributes).forEach((s=>{const n=function(t){return t?`${_$}${t.layerId}/${t.fieldName}`:""}({layerId:""+i.relation.id,fieldName:s});t[n]=e.attributes[s]}))}const Z$=t=>{if(!t)return!1;const e=t.toUpperCase();return e.indexOf("CURRENT_TIMESTAMP")>-1||e.indexOf("CURRENT_DATE")>-1||e.indexOf("CURRENT_TIME")>-1},Q$=({layer:t,method:e,query:i,definitionExpression:s})=>{var n,r;if(null==(n=t.capabilities)||null==(r=n.query)||!r.supportsCacheHint||"attachments"===e)return;const o=u(i.where)&&i.where,a=u(i.geometry)&&i.geometry;Z$(s)||Z$(o)||"extent"===(null==a?void 0:a.type)||"tile"===i.resultType||(i.cacheHint=!0)},K$={editing:!1,operations:{add:!0,update:!0,delete:!0}},Y$=Jr.ofType(g$);let X$=class extends Gw{constructor(t){super(t),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...K$},this.activeAttachmentInfo=null,this.attachmentInfos=new Y$,this.graphic=null,this.mode="view",this.handles.add([Yr(this,"graphic",(()=>this._graphicChanged()))])}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(t){return{...K$,...t}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1}async getAttachments(){const{_attachmentLayer:t,attachmentInfos:e}=this;if(!t||"function"!=typeof t.queryAttachments)throw new dt("invalid-layer","getAttachments(): A valid layer is required.");const i=this._getFeatureId(),s=new S_({objectIds:[i],returnMetadata:!0}),n=[],r=t.queryAttachments(s).then((t=>t[i]||n)).catch((()=>n));this._getAttachmentsPromise=r,this.notifyChange("state");const o=await r;return e.removeAll(),o.length&&e.addMany(o),this._getAttachmentsPromise=null,this.notifyChange("state"),o}async addAttachment(t){const{_attachmentLayer:e,attachmentInfos:i,graphic:s,abilities:n}=this;if(!t)throw new dt("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});if(!n.operations.add)throw new dt("invalid-abilities","addAttachment(): add abilities are required.");if(!e||"function"!=typeof e.addAttachment)throw new dt("invalid-layer","addAttachment(): A valid layer is required.");const r=e.addAttachment(s,t).then((t=>this._queryAttachment(t.objectId))),o=await r;return i.add(o),o}async deleteAttachment(t){const{_attachmentLayer:e,attachmentInfos:i,graphic:s,abilities:n}=this;if(!t)throw new dt("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!n.operations.delete)throw new dt("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!e||"function"!=typeof e.deleteAttachments)throw new dt("invalid-layer","deleteAttachment(): A valid layer is required.");const r=e.deleteAttachments(s,[t.id]).then((()=>t)),o=await r;return i.remove(o),o}async updateAttachment(t,e=this.activeAttachmentInfo){const{_attachmentLayer:i,attachmentInfos:s,graphic:n,abilities:r}=this;if(!t)throw new dt("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});if(!e)throw new dt("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!r.operations.update)throw new dt("invalid-abilities","updateAttachment(): Update abilities are required.");const o=s.findIndex((t=>t===e));if(!i||"function"!=typeof i.updateAttachment)throw new dt("invalid-layer","updateAttachment(): A valid layer is required.");const a=i.updateAttachment(n,e.id,t).then((t=>this._queryAttachment(t.objectId))),l=await a;return s.splice(o,1,l),l}async _queryAttachment(t){if(!t)throw new dt("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:e}=this,i=this._getFeatureId(),s=new S_({objectIds:[i],attachmentsWhere:"AttachmentId="+t,returnMetadata:!0});return e.queryAttachments(s).then((t=>t[i][0]))}_getFeatureId(){const{_attachmentLayer:t,graphic:e}=this;if(!t||!e)return null;const{objectIdField:i}=t,{attributes:s}=e;return s&&s[i]}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((()=>{})))}_setAttachmentLayer(){const{graphic:t}=this,e=O$(t);this._attachmentLayer=e?"scene"===e.type&&u(e.associatedLayer)?e.associatedLayer:e:null}};e([Hn()],X$.prototype,"abilities",void 0),e([xa("abilities")],X$.prototype,"castAbilities",null),e([Hn()],X$.prototype,"activeAttachmentInfo",void 0),e([Hn({readOnly:!0,type:Y$})],X$.prototype,"attachmentInfos",void 0),e([Hn({type:s_})],X$.prototype,"graphic",void 0),e([Hn()],X$.prototype,"mode",void 0),e([Hn({readOnly:!0})],X$.prototype,"state",null),e([Hn({readOnly:!0})],X$.prototype,"supportsResizeAttachments",null),X$=e([_r("esri.widgets.Attachments.AttachmentsViewModel")],X$);const tz=X$,ez={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},iz=window.CSS;let sz=class extends Gc{constructor(t,e){super(t,e),this.abilities=null,this.displayType="auto",this.graphic=null,this.label=void 0,this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new tz,this.visibleElements={...ez},this._supportsImageOrientation=iz&&iz.supports&&iz.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.own(uo(this,"viewModel.attachmentInfos","change",(()=>this.scheduleRender())),Yr(this,"viewModel.mode",(()=>this._modeChanged())))}get effectiveDisplayType(){return"auto"===this.displayType?this.viewModel.supportsResizeAttachments?"preview":"list":this.displayType}castVisibleElements(t){return{...ez,...t}}addAttachment(){const{_addAttachmentForm:t,viewModel:e}=this;return this._set("submitting",!0),this._set("error",null),e.addAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),e.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new dt("attachments:add-attachment",this.messages.addErrorMessage,t)),t}))}deleteAttachment(t){const{viewModel:e}=this;return this._set("submitting",!0),this._set("error",null),e.deleteAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),e.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new dt("attachments:delete-attachment",this.messages.deleteErrorMessage,t)),t}))}updateAttachment(){const{viewModel:t}=this,{_updateAttachmentForm:e}=this;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(e).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((t=>{throw this._set("submitting",!1),this._set("error",new dt("attachments:update-attachment",this.messages.updateErrorMessage,t)),t}))}render(){const{submitting:t,viewModel:e}=this,{state:i}=e;return Fw("div",{class:this.classes("esri-attachments","esri-widget")},t?this.renderProgressBar():null,"loading"===i?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:t,visibleElements:e}=this;return t&&e.errorMessage?Fw("div",{key:"error-message",class:"esri-attachments__error-message"},t.message):null}renderAttachments(){const{mode:t,activeAttachmentInfo:e}=this.viewModel;return"add"===t?this.renderAddForm():"edit"===t?this.renderDetailsForm(e):this.renderAttachmentContainer()}renderLoading(){return Fw("div",{class:"esri-attachments__loader-container",key:"loader"},Fw("div",{class:"esri-attachments__loader"}))}renderProgressBar(){return this.visibleElements.progressBar?Fw("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}renderAddForm(){const{submitting:t,selectedFile:e}=this,i=t||!e,s=this.visibleElements.cancelAddButton?Fw("button",{type:"button",bind:this,disabled:t,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--tertiary","esri-button--small","esri-button--half",t&&"esri-button--disabled")},this.messages.cancel):null,n=this.visibleElements.addSubmitButton?Fw("button",{type:"submit",disabled:i,class:this.classes("esri-button","esri-button--secondary","esri-button--small","esri-button--half",{"esri-button--disabled":i})},this.messages.add):null,r=e?Fw("span",{key:"file-name",class:"esri-attachments__file-name"},e.name):null,o=Fw("form",{bind:this,afterCreate:Rl,afterRemoved:Ll,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},Fw("fieldset",{class:"esri-attachments__file-fieldset"},r,Fw("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},e?this.messages.changeFile:this.messages.selectFile,Fw("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),n,s);return Fw("div",{key:"add-form-container",class:"esri-attachments__form-node"},o)}renderDetailsForm(t){const{visibleElements:e,viewModel:i,selectedFile:s,submitting:n}=this,{contentType:r,size:o,url:a}=t,{abilities:l}=i,u=n||!s,c=l.editing&&l.operations.delete&&e.deleteButton?Fw("button",{key:"delete-button",type:"button",disabled:n,bind:this,onclick:e=>this._submitDeleteAttachment(e,t),class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-attachments__delete-button",{"esri-button--disabled":n})},this.messages.delete):null,h=l.editing&&l.operations.update&&e.updateButton?Fw("button",{disabled:u,key:"update-button",type:"submit",class:this.classes("esri-button","esri-button--small","esri-button--third",{"esri-button--disabled":u})},this.messages.update):null,d=this.visibleElements.cancelUpdateButton?Fw("button",{disabled:n,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-button--third",{"esri-button--disabled":n})},this.messages.cancel):null,f=s?Fw("span",{key:"file-name",class:"esri-attachments__file-name"},s.name):null,p=l.editing&&l.operations.update?Fw("fieldset",{key:"file",class:"esri-attachments__file-fieldset"},f,Fw("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},this.messages.changeFile,Fw("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,y=Fw("fieldset",{key:"size",class:"esri-attachments__metadata-fieldset"},Fw("label",null,function(t,e){let i=0===e?0:Math.floor(Math.log(e)/Math.log(1024));i=qp(i,0,4);const s=Zo(e/1024**i,{maximumFractionDigits:2});return rt(t.units.bytes[f$[i]],{fileSize:s})}(this.messagesUnits,o))),m=Fw("fieldset",{key:"content-type",class:"esri-attachments__metadata-fieldset"},Fw("label",null,r)),g=Fw("form",{bind:this,afterCreate:Rl,afterRemoved:Ll,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},Fw("div",{class:"esri-attachments__metadata"},y,m),p,Fw("div",{class:"esri-attachments__actions"},c,d,h));return Fw("div",{key:"edit-form-container",class:"esri-attachments__form-node"},Fw("a",{class:"esri-attachments__item-link",href:a,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:t,size:400}),Fw("div",{class:"esri-attachments__item-link-overlay"},Fw("span",{class:"esri-attachments__item-link-overlay-icon"},Fw("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},Fw("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),Fw("path",{fill:"none",d:"M0 0h32v32H0z"}))))),g)}renderImageMask({attachmentInfo:t,size:e}){const{supportsResizeAttachments:i}=this.viewModel,{contentType:s,name:n,url:r}=t,o=i&&function(t){const e=t.toLowerCase();return"image/bmp"===e||"image/emf"===e||"image/exif"===e||"image/gif"===e||"image/x-icon"===e||"image/jpeg"===e||"image/png"===e||"image/tiff"===e||"image/x-wmf"===e}(s),a=this._getCSSTransform(t,o),l=a?{transform:a,"image-orientation":"none"}:{},u=-1===r.indexOf("?")?"?":"&",c=o?`${r}${u}w=${e}`:function(t){const e=Ii("esri/themes/base/images/files/");return t?"text/plain"===t?e+"text-32.svg":"application/pdf"===t?e+"pdf-32.svg":"text/csv"===t?e+"csv-32.svg":"application/gpx+xml"===t?e+"gpx-32.svg":"application/x-dwf"===t?e+"cad-32.svg":"application/postscript"===t||"application/json"===t||"text/xml"===t||"model/vrml"===t?e+"code-32.svg":"application/x-zip-compressed"===t||"application/x-7z-compressed"===t||"application/x-gzip"===t||"application/x-tar"===t||"application/x-gtar"===t||"application/x-bzip2"===t||"application/gzip"===t||"application/x-compress"===t||"application/x-apple-diskimage"===t||"application/x-rar-compressed"===t||"application/zip"===t?e+"zip-32.svg":-1!==t.indexOf("image/")?e+"image-32.svg":-1!==t.indexOf("audio/")?e+"sound-32.svg":-1!==t.indexOf("video/")?e+"video-32.svg":-1!==t.indexOf("msexcel")||-1!==t.indexOf("ms-excel")||-1!==t.indexOf("spreadsheetml")?e+"excel-32.svg":-1!==t.indexOf("msword")||-1!==t.indexOf("ms-word")||-1!==t.indexOf("wordprocessingml")?e+"word-32.svg":-1!==t.indexOf("powerpoint")||-1!==t.indexOf("presentationml")?e+"report-32.svg":e+"generic-32.svg":e+"generic-32.svg"}(s),h={"esri-attachments__image--resizable":i};return Fw("div",{class:this.classes({"esri-attachments__item-mask--icon":!o},"esri-attachments__item-mask")},Fw("img",{styles:l,alt:n,src:c,class:this.classes(h,"esri-attachments__image")}))}renderAttachmentInfo({attachmentInfo:t,displayType:e}){const{viewModel:i}=this,{abilities:s}=i,{name:n,url:r}=t,o=this.renderImageMask({attachmentInfo:t,size:"list"===e?48:400}),a=s.editing?Fw("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",Pl(this.container)?"esri-icon-left":"esri-icon-right")}):null,l=[o,Fw("label",{class:"esri-attachments__label"},Fw("span",{class:"esri-attachments__filename"},n||this.messages.noTitle),a)],u=s.editing?Fw("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":t.id,onclick:()=>this._startEditAttachment(t),type:"button"},l):Fw("a",{key:"details-link",class:"esri-attachments__item-button",href:r,target:"_blank"},l);return Fw("li",{class:"esri-attachments__item",key:t},u)}renderAttachmentContainer(){const{effectiveDisplayType:t,viewModel:e,visibleElements:i}=this,{attachmentInfos:s,abilities:n}=e,r=s&&s.length,o={"esri-attachments__container--list":"preview"!==t,"esri-attachments__container--preview":"preview"===t},a=n.editing&&n.operations.add&&i.addButton?Fw("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes("esri-button","esri-button--tertiary","esri-attachments__add-attachment-button"),type:"button"},Fw("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon","esri-icon-plus")}),this.messages.add):null,l=r?Fw("ul",{class:"esri-attachments__items"},s.toArray().map((e=>this.renderAttachmentInfo({attachmentInfo:e,displayType:t})))):Fw("div",{class:"esri-widget__content--empty"},this.messages.noAttachments);return Fw("div",{key:"attachments-container",class:this.classes("esri-attachments__container",o)},l,a)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(t){const e=t.target,i=e&&e.files&&e.files.item(0);this._set("selectedFile",i)}_submitDeleteAttachment(t,e){t.preventDefault(),this.deleteAttachment(e)}_submitAddAttachment(t){t.preventDefault(),this.addAttachment()}_submitUpdateAttachment(t){t.preventDefault(),this.updateAttachment()}_startEditAttachment(t){const{viewModel:e}=this;e.activeAttachmentInfo=t,e.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(t){t.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(t,e){const{orientationInfo:i}=t;return!this._supportsImageOrientation&&e&&i?[i.rotation?`rotate(${i.rotation}deg)`:"",i.mirrored?"scaleX(-1)":""].join(" "):""}};e([go("viewModel.abilities")],sz.prototype,"abilities",void 0),e([Hn()],sz.prototype,"displayType",void 0),e([Hn({readOnly:!0})],sz.prototype,"effectiveDisplayType",null),e([go("viewModel.graphic")],sz.prototype,"graphic",void 0),e([Hn({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],sz.prototype,"label",void 0),e([Hn(),Lw("esri/widgets/Attachments/t9n/Attachments")],sz.prototype,"messages",void 0),e([Hn(),Lw("esri/core/t9n/Units")],sz.prototype,"messagesUnits",void 0),e([Hn({readOnly:!0})],sz.prototype,"selectedFile",void 0),e([Hn({readOnly:!0})],sz.prototype,"submitting",void 0),e([Hn({readOnly:!0})],sz.prototype,"error",void 0),e([Hn({type:tz})],sz.prototype,"viewModel",void 0),e([Hn()],sz.prototype,"visibleElements",void 0),e([xa("visibleElements")],sz.prototype,"castVisibleElements",null),sz=e([_r("esri.widgets.Attachments")],sz);const nz=sz;let rz=class extends tz{constructor(t){super(t),this.description=null,this.title=null}};e([Hn()],rz.prototype,"description",void 0),e([Hn()],rz.prototype,"title",void 0),rz=e([_r("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],rz);const oz=rz;let az=class extends Gc{constructor(t,e){super(t,e),this.description=null,this.headingLevel=2,this.title=null}render(){return Fw("div",{class:"esri-feature-element-info"},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:t}=this;return t?Fw(Cw,{level:this.headingLevel,class:"esri-feature-element-info__title"},t):null}renderDescription(){const{description:t}=this;return t?Fw("div",{key:"description",class:"esri-feature-element-info__description"},t):null}};e([Hn()],az.prototype,"description",void 0),e([Hn()],az.prototype,"headingLevel",void 0),e([Hn()],az.prototype,"title",void 0),az=e([_r("esri.widgets.Feature.support.FeatureElementInfo")],az);const lz=az;let uz=class extends Gc{constructor(t,e){super(t,e),this._featureElementInfo=null,this.attachmentsWidget=new nz,this.description=null,this.displayType=null,this.graphic=null,this.headingLevel=2,this.title=null,this.viewModel=new oz}initialize(){this._featureElementInfo=new lz,Yr(this,["viewModel.description","viewModel.title","headingLevel"],(()=>this._setupFeatureElementInfo())),Yr(this,"viewModel.graphic",(t=>this.attachmentsWidget.graphic=t))}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}render(){var t;const{attachmentsWidget:e}=this;return Fw("div",{class:"esri-feature-attachments"},null==(t=this._featureElementInfo)?void 0:t.render(),null==e?void 0:e.render())}_setupFeatureElementInfo(){const{description:t,title:e,headingLevel:i}=this;this._featureElementInfo.set({description:t,title:e,headingLevel:i})}};e([Hn({readOnly:!0})],uz.prototype,"attachmentsWidget",void 0),e([go("viewModel.description")],uz.prototype,"description",void 0),e([go("attachmentsWidget.displayType")],uz.prototype,"displayType",void 0),e([go("viewModel.graphic")],uz.prototype,"graphic",void 0),e([Hn()],uz.prototype,"headingLevel",void 0),e([go("viewModel.title")],uz.prototype,"title",void 0),e([Hn({type:oz})],uz.prototype,"viewModel",void 0),uz=e([_r("esri.widgets.Feature.FeatureAttachments")],uz);const cz=uz;let hz=class extends(zw(Ar)){constructor(t){super(t),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(Yr(this,"creator",(t=>{this._destroyContent(),this._createContent(t)})))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:t,graphic:e,destroyer:i}=this;t&&(A$(i,{graphic:e}).catch((()=>null)),this._set("created",null))}async _createContent(t){const{graphic:e}=this,i=A$(t,{graphic:e}).catch((()=>null));this._loadingPromise=i,this.notifyChange("state");const s=await i;i===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",s))}};e([Hn({readOnly:!0})],hz.prototype,"created",void 0),e([Hn()],hz.prototype,"creator",void 0),e([Hn()],hz.prototype,"destroyer",void 0),e([Hn({type:s_})],hz.prototype,"graphic",void 0),e([Hn({readOnly:!0})],hz.prototype,"state",null),hz=e([_r("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],hz);const dz=hz;let fz=class extends Gc{constructor(t,e){super(t,e),this.creator=null,this.graphic=null,this.viewModel=null,this._addTargetToAnchors=t=>{Array.from(t.querySelectorAll("a")).forEach((t=>{F$(t.href)&&!t.hasAttribute("target")&&t.setAttribute("target","_blank")}))}}renderLoading(){return Fw("div",{class:"esri-feature-content__loader-container",key:"loader"},Fw("div",{class:"esri-feature-content__loader"}))}renderCreated(){var t;const e=null==(t=this.viewModel)?void 0:t.created;return e?e instanceof HTMLElement?Fw("div",{key:e,bind:e,afterCreate:this._attachToNode}):Nw(e)?Fw("div",{key:e},!e.destroyed&&e.render()):Fw("div",{key:e,innerHTML:e,afterCreate:this._addTargetToAnchors}):null}render(){var t;return Fw("div",{class:"esri-feature-content"},"loading"===(null==(t=this.viewModel)?void 0:t.state)?this.renderLoading():this.renderCreated())}_attachToNode(t){t.appendChild(this)}};e([go("viewModel.creator")],fz.prototype,"creator",void 0),e([go("viewModel.graphic")],fz.prototype,"graphic",void 0),e([Hn({type:dz})],fz.prototype,"viewModel",void 0),fz=e([_r("esri.widgets.Feature.FeatureContent")],fz);const pz=fz;let yz=class extends Ar{constructor(t){super(t),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:t,fieldInfos:e}=this,i=[];return null==e||e.forEach((e=>{if(e.hasOwnProperty("visible")&&!e.visible)return;const s=e.clone();s.label=P$(s,t),i.push(s)})),i}};e([Hn()],yz.prototype,"attributes",void 0),e([Hn({type:[nS]})],yz.prototype,"expressionInfos",void 0),e([Hn()],yz.prototype,"description",void 0),e([Hn({type:[yM]})],yz.prototype,"fieldInfos",void 0),e([Hn({readOnly:!0})],yz.prototype,"formattedFieldInfos",null),e([Hn()],yz.prototype,"title",void 0),yz=e([_r("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],yz);const mz=yz,gz=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];let vz=class extends Gc{constructor(t,e){super(t,e),this._featureElementInfo=null,this.attributes=null,this.description=null,this.expressionInfos=null,this.fieldInfos=null,this.title=null,this.viewModel=new mz,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new lz,Yr(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo()))}destroy(){this._featureElementInfo.destroy()}renderFieldInfo(t,e){const{attributes:i}=this.viewModel,s=t.fieldName,n=t.label||s,r=i?null==i[s]?"":i[s]:"",o=!(!t.format||!t.format.dateFormat),a="number"!=typeof r||o?function(t,e){if("string"!=typeof e||!e)return e;const i=function(t){let e=null;return gz.some((i=>(i.pattern.test(t)&&(e=i),!!e))),e}(e);if(!i)return e;const s=e.match(i.pattern),n=rt(rt(i.label,{messages:t,hierPart:s&&s[2]}),{appName:i.appName});return e.replace(i.pattern,`<a${i.target?` target="${i.target}"`:""} href="$1"${"_blank"===i.target?' rel="noreferrer"':""}>${n}</a>`)}(this.messagesURIUtils,r):this._forceLTR(r),l={"esri-feature-fields__field-data--date":o};return Fw("tr",{key:`fields-element-info-row-${s}-${e}`},Fw("th",{key:`fields-element-info-row-header-${s}-${e}`,class:"esri-feature-fields__field-header",innerHTML:n}),Fw("td",{key:`fields-element-info-row-data-${s}-${e}`,class:this.classes("esri-feature-fields__field-data",l),innerHTML:a}))}renderFields(){const{formattedFieldInfos:t}=this.viewModel;return null!=t&&t.length?Fw("table",{class:"esri-widget__table",summary:this.messages.fieldsSummary},Fw("tbody",null,t.map(((t,e)=>this.renderFieldInfo(t,e))))):null}render(){var t;return Fw("div",{class:"esri-feature-fields"},null==(t=this._featureElementInfo)?void 0:t.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:t,title:e}=this;this._featureElementInfo.set({description:t,title:e})}_forceLTR(t){return"&lrm;"+t}};e([go("viewModel.attributes")],vz.prototype,"attributes",void 0),e([go("viewModel.description")],vz.prototype,"description",void 0),e([go("viewModel.expressionInfos")],vz.prototype,"expressionInfos",void 0),e([go("viewModel.fieldInfos")],vz.prototype,"fieldInfos",void 0),e([go("viewModel.title")],vz.prototype,"title",void 0),e([Hn({type:mz})],vz.prototype,"viewModel",void 0),e([Hn(),Lw("esri/widgets/Feature/t9n/Feature")],vz.prototype,"messages",void 0),e([Hn(),Lw("esri/widgets/support/t9n/uriUtils")],vz.prototype,"messagesURIUtils",void 0),vz=e([_r("esri.widgets.Feature.FeatureFields")],vz);const wz=vz;function bz(t){const e={};for(const i in t){if("declaredClass"===i)continue;const s=t[i];if(null!=s&&"function"!=typeof s)if(Array.isArray(s)){e[i]=[];for(let t=0;t<s.length;t++)e[i][t]=bz(s[t])}else"object"==typeof s?s.toJSON&&(e[i]=JSON.stringify(s)):e[i]=s}return e}function Mz(t){const e=t.toJSON();return e.attachmentTypes&&(e.attachmentTypes=e.attachmentTypes.join(",")),e.keywords&&(e.keywords=e.keywords.join(",")),e.globalIds&&(e.globalIds=e.globalIds.join(",")),e.objectIds&&(e.objectIds=e.objectIds.join(",")),e.size&&(e.size=e.size.join(",")),e}function Sz(t,e){const i={};for(const s of t){const{parentObjectId:t,parentGlobalId:n,attachmentInfos:r}=s;for(const s of r){const{id:r}=s,o=Ct(xe(`${e}/${t}/attachments/${r}`)),a=g$.fromJSON(s);a.set({url:o,parentObjectId:t,parentGlobalId:n}),i[t]?i[t].push(a):i[t]=[a]}}return i}const xz={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new iv({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:Lh.WebMercator}),minus180Line:new iv({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:Lh.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new iv({paths:[[[180,-180],[180,180]]],spatialReference:Lh.WGS84}),minus180Line:new iv({paths:[[[-180,-180],[-180,180]]],spatialReference:Lh.WGS84})}};function kz(t,e){return Math.ceil((t-e)/(2*e))}function Iz(t,e){const i=jz(t);for(const t of i)for(const i of t)i[0]+=e;return t}function jz(t){return Zw(t)?t.rings:t.paths}function _z(t){const e=(null==t?void 0:t.isWebMercator)?102100:4326;return[xz[e].minX,xz[e].maxX]}function Tz(t){return{geometryType:Kw(t[0]),geometries:t.map((t=>t.toJSON()))}}const Oz=ct.getLogger("esri.geometry.support.normalizeUtils");function Az(t){return"polygon"===t[0].type}function Fz(t){return"polyline"===t[0].type}function Cz(t,e,i){if(e){const e=function(t,e){if(!(t instanceof iv||t instanceof Xg)){const t="straightLineDensify: the input geometry is neither polyline nor polygon";throw Oz.error(t),new dt(t)}const i=jz(t),s=[];for(const t of i){const i=[];s.push(i),i.push([t[0][0],t[0][1]]);for(let s=0;s<t.length-1;s++){const n=t[s][0],r=t[s][1],o=t[s+1][0],a=t[s+1][1],l=Math.sqrt((o-n)*(o-n)+(a-r)*(a-r)),u=(a-r)/l,c=(o-n)/l,h=l/e;if(h>1){for(let t=1;t<=h-1;t++){const s=t*e;i.push([c*s+n,u*s+r])}const t=(l+Math.floor(h-1)*e)/2;i.push([c*t+n,u*t+r])}i.push([o,a])}}return function(t){return"polygon"===t.type}(t)?new Xg({rings:s,spatialReference:t.spatialReference}):new iv({paths:s,spatialReference:t.spatialReference})}(t,1e6);t=ed(e,!0)}return i&&(t=Iz(t,i)),t}function Pz(t,e,i){if(Array.isArray(t)){const s=t[0];if(s>e){const i=kz(s,e);t[0]=s+i*(-2*e)}else if(s<i){const e=kz(s,i);t[0]=s+e*(-2*i)}}else{const s=t.x;if(s>e){const i=kz(s,e);t=t.clone().offset(i*(-2*e),0)}else if(s<i){const e=kz(s,i);t=t.clone().offset(e*(-2*i),0)}}return t}async function Ez(t,e,i){var s;if(!Array.isArray(t))return Ez([t],e);const n=null!=(s=null==e?void 0:e.url)?s:it.geometryServiceUrl;let r,o,a,l,h,d,f,p,y=0;const m=[],g=[];for(const e of t)if(c(e))g.push(e);else if(r||(r=e.spatialReference,o=Sh(r),a=r.isWebMercator,d=a?102100:4326,l=xz[d].maxX,h=xz[d].minX,f=xz[d].plus180Line,p=xz[d].minus180Line),o)if("mesh"===e.type)g.push(e);else if("point"===e.type)g.push(Pz(e.clone(),l,h));else if("multipoint"===e.type){const t=e.clone();t.points=t.points.map((t=>Pz(t,l,h))),g.push(t)}else if("extent"===e.type){const t=e.clone()._normalize(!1,!1,o);g.push(t.rings?new Xg(t):t)}else if(e.extent){const t=e.extent,i=kz(t.xmin,h)*(2*l);let s=0===i?e.clone():Iz(e.clone(),i);t.offset(i,0),t.intersects(f)&&t.xmax!==l?(y=t.xmax>y?t.xmax:y,s=Cz(s,a),m.push(s),g.push("cut")):t.intersects(p)&&t.xmin!==h?(y=t.xmax*(2*l)>y?t.xmax*(2*l):y,s=Cz(s,a,360),m.push(s),g.push("cut")):g.push(s)}else g.push(e.clone());else g.push(e);let v=kz(y,l),w=-90;const b=v,M=new iv;for(;v>0;){const t=360*v-180;M.addPath([[t,w],[t,-1*w]]),w*=-1,v--}if(m.length>0&&b>0){const e=function(t,e){let i=-1;for(let s=0;s<e.cutIndexes.length;s++){const n=e.cutIndexes[s],r=e.geometries[s],o=jz(r);for(let t=0;t<o.length;t++){const e=o[t];e.some((i=>{if(i[0]<180)return!0;{let i=0;for(let t=0;t<e.length;t++){const s=e[t][0];i=s>i?s:i}i=Number(i.toFixed(9));const s=-360*kz(i,180);for(let i=0;i<e.length;i++){const e=r.getPoint(t,i);r.setPoint(t,i,e.clone().offset(s,0))}return!0}}))}if(n===i){if(Az(t))for(const e of jz(r))t[n]=t[n].addRing(e);else if(Fz(t))for(const e of jz(r))t[n]=t[n].addPath(e)}else i=n,t[n]=r}return t}(m,await async function(t,e,i,s){const n="string"==typeof t?Tt(t):t,r=e[0].spatialReference,o={...s,query:{...n.query,f:"json",sr:JSON.stringify(r),target:JSON.stringify({geometryType:Kw(e[0]),geometries:e}),cutter:JSON.stringify(i)}},a=await oi(n.path+"/cut",o),{cutIndexes:l,geometries:u=[]}=a.data;return{cutIndexes:l,geometries:u.map((t=>{const e=Qw(t);return e.spatialReference=r,e}))}}(n,m,M,i)),s=[],r=[];for(let i=0;i<g.length;i++){const n=g[i];if("cut"!==n)r.push(n);else{const n=e.shift(),o=t[i];u(o)&&"polygon"===o.type&&o.rings&&o.rings.length>1&&n.rings.length>=o.rings.length?(s.push(n),r.push("simplify")):r.push(a?td(n):n)}}if(!s.length)return r;const o=await async function(t,e,i){const s="string"==typeof t?Tt(t):t,n=e[0].spatialReference,r=Kw(e[0]),o={...i,query:{...s.query,f:"json",sr:n.wkid?n.wkid:JSON.stringify(n),geometries:JSON.stringify(Tz(e))}};return function(t,e,i){const s=Xw(e);return t.map((t=>{const e=s.fromJSON(t);return e.spatialReference=i,e}))}((await oi(s.path+"/simplify",o)).data,r,n)}(n,s,i),l=[];for(let t=0;t<r.length;t++){const e=r[t];l.push("simplify"!==e?e:a?td(o.shift()):o.shift())}return l}const S=[];for(let t=0;t<g.length;t++){const e=g[t];if("cut"!==e)S.push(e);else{const t=m.shift();S.push(!0===a?td(t):t)}}return Promise.resolve(S)}function Lz(t,e){const i=Sh(e);if(i){const[e,s]=i.valid,n=s-e;if(t<e)for(;t<e;)t+=n;if(t>s)for(;t>s;)t-=n}return t}const Rz=l("esri-text-decoder")?new TextDecoder("utf-8"):null,Nz=l("safari")||l("ios")?6:l("ff")?12:32;class Dz{constructor(t,e,i=0,s=(t?t.byteLength:0)){this._tag=0,this._dataType=99,this.init(t,e,i,s)}init(t,e,i,s){this._data=t,this._dataView=e,this._pos=i,this._end=s}clone(){return new Dz(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(t){this._pos=t}nextTag(t){for(;;){if(this._pos===this._end)return!1;const e=this._decodeVarint();if(this._tag=e>>3,this._dataType=7&e,!t||t===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;const t=this._decodeVarint();return this._tag=t>>3,this._dataType=7&t,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let t=4294967295;return t=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?t:(t=(t|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?t:void 0))))}getUInt64(){return this._decodeVarint()}getSInt32(){const t=this.getUInt32();return t>>>1^-(1&t)|0}getSInt64(){return this._decodeSVarint()}getBool(){const t=0!==this._data[this._pos];return this._skip(1),t}getEnum(){return this._decodeVarint()}getFixed64(){const t=this._dataView,e=this._pos,i=t.getUint32(e,!0)+4294967296*t.getUint32(e+4,!0);return this._skip(8),i}getSFixed64(){const t=this._dataView,e=this._pos,i=t.getUint32(e,!0)+4294967296*t.getInt32(e+4,!0);return this._skip(8),i}getDouble(){const t=this._dataView.getFloat64(this._pos,!0);return this._skip(8),t}getFixed32(){const t=this._dataView.getUint32(this._pos,!0);return this._skip(4),t}getSFixed32(){const t=this._dataView.getInt32(this._pos,!0);return this._skip(4),t}getFloat(){const t=this._dataView.getFloat32(this._pos,!0);return this._skip(4),t}getString(){const t=this._getLength(),e=this._pos,i=this._toString(this._data,e,e+t);return this._skip(t),i}getBytes(){const t=this._getLength(),e=this._pos,i=this._toBytes(this._data,e,e+t);return this._skip(t),i}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(t,e,i,s){const n=this.getMessage(),r=t(n,e,i,s);return n.release(),r}processMessage(t){const e=this.getMessage(),i=t(e);return e.release(),i}getMessage(){const t=this._getLength(),e=Dz.pool.acquire();return e.init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),e}release(){Dz.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw Error("Invalid data type!")}}skipLen(t){this._skip(t)}_skip(t){if(this._pos+t>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=t}_decodeVarint(){const t=this._data;let e,i=this._pos,s=0;if(this._end-i>=10)do{if(e=t[i++],s|=127&e,0==(128&e))break;if(e=t[i++],s|=(127&e)<<7,0==(128&e))break;if(e=t[i++],s|=(127&e)<<14,0==(128&e))break;if(e=t[i++],s|=(127&e)<<21,0==(128&e))break;if(e=t[i++],s+=268435456*(127&e),0==(128&e))break;if(e=t[i++],s+=34359738368*(127&e),0==(128&e))break;if(e=t[i++],s+=4398046511104*(127&e),0==(128&e))break;if(e=t[i++],s+=562949953421312*(127&e),0==(128&e))break;if(e=t[i++],s+=72057594037927940*(127&e),0==(128&e))break;if(e=t[i++],s+=0x8000000000000000*(127&e),0==(128&e))break;throw Error("Varint too long!")}while(0);else{let n=1;for(;i!==this._end&&(e=t[i],0!=(128&e));)++i,s+=(127&e)*n,n*=128;if(i===this._end)throw Error("Varint overrun!");++i,s+=e*n}return this._pos=i,s}_decodeSVarint(){const t=this._decodeVarint();return t%2?-(t+1)/2:t/2}_getLength(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(t,e,i){if((i=Math.min(this._end,i))-e>Nz&&Rz){const s=t.subarray(e,i);return Rz.decode(s)}let s="",n="";for(let r=e;r<i;++r){const e=t[r];128&e?n+="%"+e.toString(16):(s+=decodeURIComponent(n)+String.fromCharCode(e),n="")}return n.length&&(s+=decodeURIComponent(n)),s}_toBytes(t,e,i){return i=Math.min(this._end,i),new Uint8Array(t.buffer,e,i-e)}}Dz.pool=new Zi(Dz,null,(t=>{t._data=null,t._dataView=null}));class Vz{constructor(t=[],e=[],i=!1){this.lengths=null!=t?t:[],this.coords=null!=e?e:[],this.hasIndeterminateRingOrder=i}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce(((t,e)=>t+e))}forEachVertex(t){let e=0;this.lengths.length||t(this.coords[0],this.coords[1]);for(let i=0;i<this.lengths.length;i++){const s=this.lengths[i];for(let i=0;i<s;i++)t(this.coords[2*(i+e)],this.coords[2*(i+e)+1]);e+=s}}clone(t){return t?(t.set(this.coords),new Vz(this.lengths.slice(),t,this.hasIndeterminateRingOrder)):new Vz(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}class $z{constructor(t=null,e={},i,s){this.geometry=t,this.attributes=e,this.centroid=i,this.objectId=s,this.displayId=0,this.geohashX=0,this.geohashY=0}weakClone(){const t=new $z(this.geometry,this.attributes,this.centroid,this.objectId);return t.displayId=this.displayId,t.geohashX=this.geohashX,t.geohashY=this.geohashY,t}}function zz(t){return!(c(t.geometry)||!t.geometry.coords||!t.geometry.coords.length)}class Gz extends $z{}class Uz{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const t=new Uz;return t.objectIdFieldName=this.objectIdFieldName,t.globalIdFieldName=this.globalIdFieldName,t.geohashFieldName=this.geohashFieldName,t.geometryProperties=this.geometryProperties,t.geometryType=this.geometryType,t.spatialReference=this.spatialReference,t.hasZ=this.hasZ,t.hasM=this.hasM,t.features=this.features,t.fields=this.fields,t.transform=this.transform,t.exceededTransferLimit=this.exceededTransferLimit,t.uniqueIdField=this.uniqueIdField,t.queryGeometry=this.queryGeometry,t.queryGeometryType=this.queryGeometryType,t}}const qz=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];class Bz{constructor(t){this.options=t,this.geometryTypes=qz,this._coordinatePtr=0,this._vertexDimension=0}createFeatureResult(){return new Uz}prepareFeatures(t){this._vertexDimension=2,t.hasZ&&this._vertexDimension++,t.hasM&&this._vertexDimension++}finishFeatureResult(t){if(!t||!t.features||!t.hasZ||!this.options.sourceSpatialReference||!t.spatialReference||Mh(t.spatialReference,this.options.sourceSpatialReference)||t.spatialReference.vcsWkid)return;const e=Lm(this.options.sourceSpatialReference)/Lm(t.spatialReference);if(1!==e)for(const i of t.features){if(!zz(i))continue;const t=i.geometry.coords;for(let i=2;i<t.length;i+=3)t[i]*=e}}addFeature(t,e){t.features.push(e)}createFeature(){return new $z}createSpatialReference(){return{wkid:0}}createGeometry(){return new Vz}addField(t,e){t.fields.push(e)}allocateCoordinates(t){t.coords.length=t.lengths.reduce(((t,e)=>t+e),0)*this._vertexDimension,this._coordinatePtr=0}addCoordinate(t,e){t.coords[this._coordinatePtr++]=e}addCoordinatePoint(t,e){t.coords.push(e)}addLength(t,e){t.lengths.push(e)}addQueryGeometry(t,e){t.queryGeometry=e.queryGeometry,t.queryGeometryType=e.queryGeometryType}createPointGeometry(){return new Vz}}const Wz=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],Hz=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],Jz=["upperLeft","lowerLeft"];function Zz(t){return t>=Wz.length?null:Wz[t]}function Qz(t){return t>=Hz.length?null:Hz[t]}function Kz(t){return t>=Jz.length?null:Jz[t]}function Yz(t,e){return e>=t.geometryTypes.length?null:t.geometryTypes[e]}function Xz(t,e,i){const s=e.createPointGeometry(i);for(;t.next();)switch(t.tag()){case 3:{const i=t.getUInt32(),n=t.pos()+i;let r=0;for(;t.pos()<n;)e.addCoordinatePoint(s,t.getSInt64(),r++);break}default:t.skip()}return s}function tG(t,e,i){const s=e.createGeometry(i),n=2+(i.hasZ?1:0)+(i.hasM?1:0);for(;t.next();)switch(t.tag()){case 2:{const i=t.getUInt32(),n=t.pos()+i;let r=0;for(;t.pos()<n;)e.addLength(s,t.getUInt32(),r++);break}case 3:{const i=t.getUInt32(),r=t.pos()+i;let o=0;for(e.allocateCoordinates(s);t.pos()<r;)e.addCoordinate(s,t.getSInt64(),o),o++,o===n&&(o=0);break}default:t.skip()}return s}function eG(t){const e=new Vz;let i="esriGeometryPoint";for(;t.next();)switch(t.tag()){case 2:{const i=t.getUInt32(),s=t.pos()+i;for(;t.pos()<s;)e.lengths.push(t.getUInt32());break}case 3:{const i=t.getUInt32(),s=t.pos()+i;for(;t.pos()<s;)e.coords.push(t.getSInt64());break}case 1:i=qz[t.getEnum()];break;default:t.skip()}return{queryGeometry:e,queryGeometryType:i}}function iG(t){for(;t.next();)switch(t.tag()){case 1:return t.getString();case 2:return t.getFloat();case 3:return t.getDouble();case 4:return t.getSInt32();case 5:return t.getUInt32();case 6:return t.getInt64();case 7:return t.getUInt64();case 8:return t.getSInt64();case 9:return t.getBool();default:return t.skip(),null}return null}function sG(t){const e={type:Zz(0)};for(;t.next();)switch(t.tag()){case 1:e.name=t.getString();break;case 2:e.type=Zz(t.getEnum());break;case 3:e.alias=t.getString();break;case 4:e.sqlType=Qz(t.getEnum());break;default:t.skip();break;case 6:e.defaultValue=t.getString()}return e}function nG(t){const e={};for(;t.next();)switch(t.tag()){case 1:e.name=t.getString();break;case 2:e.isSystemMaintained=t.getBool();break;default:t.skip()}return e}function rG(t,e,i,s){const n=e.createFeature(i);let r=0;for(;t.next();)switch(t.tag()){case 1:{const e=s[r++].name;n.attributes[e]=t.processMessage(iG);break}case 2:n.geometry=t.processMessageWithArgs(tG,e,i);break;case 4:n.centroid=t.processMessageWithArgs(Xz,e,i);break;default:t.skip()}return n}function oG(t){const e=[1,1,1,1];for(;t.next();)switch(t.tag()){case 1:e[0]=t.getDouble();break;case 2:e[1]=t.getDouble();break;case 4:e[2]=t.getDouble();break;case 3:e[3]=t.getDouble();break;default:t.skip()}return e}function aG(t){const e=[0,0,0,0];for(;t.next();)switch(t.tag()){case 1:e[0]=t.getDouble();break;case 2:e[1]=t.getDouble();break;case 4:e[2]=t.getDouble();break;case 3:e[3]=t.getDouble();break;default:t.skip()}return e}function lG(t){const e={originPosition:Kz(0)};for(;t.next();)switch(t.tag()){case 1:e.originPosition=Kz(t.getEnum());break;case 2:e.scale=t.processMessage(oG);break;case 3:e.translate=t.processMessage(aG);break;default:t.skip()}return e}function uG(t){const e={};for(;t.next();)switch(t.tag()){case 1:e.shapeAreaFieldName=t.getString();break;case 2:e.shapeLengthFieldName=t.getString();break;case 3:e.units=t.getString();break;default:t.skip()}return e}function cG(t,e){const i=e.createSpatialReference();for(;t.next();)switch(t.tag()){case 1:i.wkid=t.getUInt32();break;case 5:i.wkt=t.getString();break;case 2:i.latestWkid=t.getUInt32();break;case 3:i.vcsWkid=t.getUInt32();break;case 4:i.latestVcsWkid=t.getUInt32();break;default:t.skip()}return i}function hG(t,e){const i=e.createFeatureResult();i.geometryType=Yz(e,0);let s=!1;for(;t.next();)switch(t.tag()){case 1:i.objectIdFieldName=t.getString();break;case 3:i.globalIdFieldName=t.getString();break;case 4:i.geohashFieldName=t.getString();break;case 5:i.geometryProperties=t.processMessage(uG);break;case 7:i.geometryType=Yz(e,t.getEnum());break;case 8:i.spatialReference=t.processMessageWithArgs(cG,e);break;case 10:i.hasZ=t.getBool();break;case 11:i.hasM=t.getBool();break;case 12:i.transform=t.processMessage(lG);break;case 9:{const e=t.getBool();i.exceededTransferLimit=e;break}case 13:e.addField(i,t.processMessage(sG));break;case 15:s||(e.prepareFeatures(i),s=!0),e.addFeature(i,t.processMessageWithArgs(rG,e,i,i.fields));break;case 2:i.uniqueIdField=t.processMessage(nG);break;default:t.skip()}return e.finishFeatureResult(i),i}function dG(t,e){const i={};let s=null;for(;t.next();)switch(t.tag()){case 4:s=t.processMessageWithArgs(eG);break;case 1:i.featureResult=t.processMessageWithArgs(hG,e);break;default:t.skip()}return u(s)&&i.featureResult&&e.addQueryGeometry(i,s),i}function fG(t,e){const i=function(t,e){try{const i=2,s=new Dz(new Uint8Array(t),new DataView(t)),n={};for(;s.next();)s.tag()===i?n.queryResult=s.processMessageWithArgs(dG,e):s.skip();return n}catch(t){throw new dt("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:t})}}(t,e),s=i.queryResult.featureResult,n=i.queryResult.queryGeometry,r=i.queryResult.queryGeometryType;if(s&&s.features&&s.features.length&&s.objectIdFieldName){const t=s.objectIdFieldName;for(const e of s.features)e.attributes&&(e.objectId=e.attributes[t])}return s&&(s.queryGeometry=n,s.queryGeometryType=r),s}const pG="Layer does not support extent calculation.";function yG(t,e){const i=t.geometry,s=t.toJSON(),n=s;if(u(i)&&(n.geometry=JSON.stringify(i),n.geometryType=Kw(i),n.inSR=i.spatialReference.wkid||JSON.stringify(i.spatialReference)),s.groupByFieldsForStatistics&&(n.groupByFieldsForStatistics=s.groupByFieldsForStatistics.join(",")),s.objectIds&&(n.objectIds=s.objectIds.join(",")),s.orderByFields&&(n.orderByFields=s.orderByFields.join(",")),!s.outFields||!s.returnDistinctValues&&(null!=e&&e.returnCountOnly||null!=e&&e.returnExtentOnly||null!=e&&e.returnIdsOnly)?delete n.outFields:n.outFields=-1!==s.outFields.indexOf("*")?"*":s.outFields.join(","),s.outSR?n.outSR=s.outSR.wkid||JSON.stringify(s.outSR):i&&(s.returnGeometry||s.returnCentroid)&&(n.outSR=n.inSR),s.returnGeometry&&delete s.returnGeometry,s.outStatistics&&(n.outStatistics=JSON.stringify(s.outStatistics)),s.pixelSize&&(n.pixelSize=JSON.stringify(s.pixelSize)),s.quantizationParameters&&(n.quantizationParameters=JSON.stringify(s.quantizationParameters)),s.parameterValues&&(n.parameterValues=JSON.stringify(s.parameterValues)),s.rangeValues&&(n.rangeValues=JSON.stringify(s.rangeValues)),s.dynamicDataSource&&(n.layer=JSON.stringify({source:s.dynamicDataSource}),delete s.dynamicDataSource),s.timeExtent){const t=s.timeExtent,{start:e,end:i}=t;null==e&&null==i||(n.time=e===i?e:`${null==e?"null":e},${null==i?"null":i}`),delete s.timeExtent}return n}async function mG(t,e,i,s){const n=u(e.timeExtent)&&e.timeExtent.isEmpty?{data:{features:[]}}:await SG(t,e,"json",s);return tP(e,i,n.data),n}async function gG(t,e,i,s){if(u(e.timeExtent)&&e.timeExtent.isEmpty)return Promise.resolve({data:i.createFeatureResult()});const n=await vG(t,e,s),r=n;return r.data=fG(n.data,i),r}function vG(t,e,i){return SG(t,e,"pbf",i)}function wG(t,e,i){return u(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):SG(t,e,"json",i,{returnIdsOnly:!0})}function bG(t,e,i){return u(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):SG(t,e,"json",i,{returnIdsOnly:!0,returnCountOnly:!0})}function MG(t,e,i){return u(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):SG(t,e,"json",i,{returnExtentOnly:!0,returnCountOnly:!0}).then((t=>{const e=t.data;if(e.hasOwnProperty("extent"))return t;if(e.features)throw Error(pG);if(e.hasOwnProperty("count"))throw Error(pG);return t}))}function SG(t,e,i,s={},n={}){const r="string"==typeof t?Tt(t):t,o=e.geometry?[e.geometry]:[];return s.responseType="pbf"===i?"array-buffer":"json",Ez(o,null,s).then((t=>{const o=t&&t[0];u(o)&&((e=e.clone()).geometry=o);const a=bz({...r.query,f:i,...n,...yG(e,n)});return oi(Wt(r.path,"query"),{...s,query:{...a,...s.query}})}))}const xG=Object.freeze({__proto__:null,executeQuery:mG,executeQueryForCount:bG,executeQueryForExtent:MG,executeQueryForIds:wG,executeQueryPBF:gG,executeQueryPBFBuffer:vG,queryToQueryStringParameters:yG,runQuery:SG});async function kG(t,e,i){return bG(vV(t),YE.from(e),{...i}).then((t=>t.data.count))}async function IG(t,e,i){return wG(vV(t),YE.from(e),{...i}).then((t=>t.data.objectIds))}async function jG(t,e,i){const s=await _G(t,e,i);return lP.fromJSON(s)}async function _G(t,e,i){const s=vV(t),n={...i},r=YE.from(e),{data:o}=await mG(s,r,r.sourceSpatialReference,n);return o}function TG(t,e){return t?e?4:3:e?3:2}const OG=ct.getLogger("esri.tasks.support.optimizedFeatureSet"),AG={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},FG=(t,e,i,s,n,r)=>{t[i]=n,t[i+1]=r},CG=(t,e,i,s,n,r)=>{t[i]=n,t[i+1]=r,t[i+2]=e[s+2]},PG=(t,e,i,s,n,r)=>{t[i]=n,t[i+1]=r,t[i+2]=e[s+3]},EG=(t,e,i,s,n,r)=>{t[i]=n,t[i+1]=r,t[i+2]=e[s+2],t[i+3]=e[s+3]};function LG(t,e,i,s){if(t){if(i)return e&&s?EG:CG;if(e&&s)return PG}else if(e&&s)return CG;return FG}function RG({scale:t,translate:e},i){return Math.round((i-e[0])/t[0])}function NG({scale:t,translate:e},i){return Math.round((e[1]-i)/t[1])}function DG({scale:t,translate:e},i){return i*t[0]+e[0]}function VG({scale:t,translate:e},i){return e[1]-i*t[1]}function $G(t,e,i){return t?e?i?HG(t):UG(t):i?BG(t):zG(t):null}function zG(t){const e=t.coords;return{x:e[0],y:e[1]}}function GG(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t}function UG(t){const e=t.coords;return{x:e[0],y:e[1],z:e[2]}}function qG(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.z,t}function BG(t){const e=t.coords;return{x:e[0],y:e[1],m:e[2]}}function WG(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.m,t}function HG(t){const e=t.coords;return{x:e[0],y:e[1],z:e[2],m:e[3]}}function JG(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.z,t.coords[3]=e.m,t}function ZG(t,e){return t&&e?JG:t?qG:e?WG:GG}function QG(t,e,i,s,n){const r=ZG(i,s);for(const i of e){const{geometry:e,attributes:s}=i;let o;e&&(o=r(new Vz,e)),t.push(new $z(o,s,null,s[n]))}return t}function KG(t,e,i){if(c(t))return null;const s=TG(e,i),n=[];for(let e=0;e<t.coords.length;e+=s){const i=[];for(let n=0;n<s;n++)i.push(t.coords[e+n]);n.push(i)}return e?i?{points:n,hasZ:e,hasM:i}:{points:n,hasZ:e}:i?{points:n,hasM:i}:{points:n}}function YG(t,e,i,s,n){const r=TG(i,s);for(const i of e){const e=i.geometry,s=i.attributes;let o;e&&(o=XG(new Vz,e,r)),t.push(new $z(o,s,null,s[n]))}return t}function XG(t,e,i=TG(e.hasZ,e.hasM)){t.lengths[0]=e.points.length;const s=t.coords;let n=0;for(const t of e.points)for(let e=0;e<i;e++)s[n++]=t[e];return t}function tU(t,e,i){if(!t)return null;const s=TG(e,i),{coords:n,lengths:r}=t,o=[];let a=0;for(const t of r){const e=[];for(let i=0;i<t;i++){const t=[];for(let e=0;e<s;e++)t.push(n[a++]);e.push(t)}o.push(e)}return e?i?{paths:o,hasZ:e,hasM:i}:{paths:o,hasZ:e}:i?{paths:o,hasM:i}:{paths:o}}function eU(t,e,i,s,n){const r=TG(i,s);for(const i of e){const e=i.geometry,s=i.attributes;let o;e&&(o=iU(new Vz,e,r)),t.push(new $z(o,s,null,s[n]))}return t}function iU(t,e,i=TG(e.hasZ,e.hasM)){const{lengths:s,coords:n}=t;let r=0;for(const t of e.paths){for(const e of t)for(let t=0;t<i;t++)n[r++]=e[t];s.push(t.length)}return t}function sU(t,e,i){if(!t)return null;const s=TG(e,i),{coords:n,lengths:r}=t,o=[];let a=0;for(const t of r){const e=[];for(let i=0;i<t;i++){const t=[];for(let e=0;e<s;e++)t.push(n[a++]);e.push(t)}o.push(e)}return e?i?{rings:o,hasZ:e,hasM:i}:{rings:o,hasZ:e}:i?{rings:o,hasM:i}:{rings:o}}function nU(t,e,i,s,n){for(const r of e){const e=r.geometry,o=r.centroid,a=r.attributes;let l;e&&(l=rU(new Vz,e,i,s)),u(o)?t.push(new $z(l,a,GG(new Vz,o),a[n])):t.push(new $z(l,a,null,a[n]))}return t}function rU(t,e,i=e.hasZ,s=e.hasM){return oU(t,e.rings,i,s),t}function oU(t,e,i,s){const n=TG(i,s),{lengths:r,coords:o}=t;let a=0;r.length=o.length=0;for(const t of e){for(const e of t)for(let t=0;t<n;t++)o[a++]=e[t];r.push(t.length)}return t}const aU=[],lU=[];function uU(t,e,i,s,n){aU[0]=t;const[r]=cU(lU,aU,e,i,s,n);return aU.length=lU.length=0,r}function cU(t,e,i,s,n,r){if(t.length=0,!i){for(const i of e)t.push(new $z(null,i.attributes,null,i.attributes[r]));return t}switch(i){case"esriGeometryPoint":return QG(t,e,s,n,r);case"esriGeometryMultipoint":return YG(t,e,s,n,r);case"esriGeometryPolyline":return eU(t,e,s,n,r);case"esriGeometryPolygon":return nU(t,e,s,n,r);default:OG.error("convertToFeatureSet:unknown-geometry",new dt(`Unable to parse unknown geometry type '${i}'`)),t.length=0}return t}function hU(t,e,i,s,n,r){const o=t.length;switch(i){case"esriGeometryPoint":QG(t,e,s,n,r);break;case"esriGeometryMultipoint":YG(t,e,s,n,r);break;case"esriGeometryPolyline":eU(t,e,s,n,r);break;case"esriGeometryPolygon":nU(t,e,s,n,r);break;default:OG.error("convertToFeatureSet:unknown-geometry",new dt(`Unable to parse unknown geometry type '${i}'`))}for(let s=0;s<e.length;s++)t[s+o].geometryType=i,t[s+o].insertAfter=e[s].insertAfter,t[s+o].groupId=e[s].groupId;return t}function dU(t,e,i,s){lU[0]=t,yU(aU,lU,e,i,s);const n=aU[0];return aU.length=lU.length=0,n}function fU(t,e,i){if(c(t))return null;const s=new Vz;return"hasZ"in t&&null==e&&(e=t.hasZ),"hasM"in t&&null==i&&(i=t.hasM),Hw(t)?ZG(null!=e?e:null!=t.z,null!=i?i:null!=t.m)(s,t):Zw(t)?rU(s,t,e,i):Jw(t)?iU(s,t,TG(e,i)):Ww(t)?XG(s,t,TG(e,i)):void OG.error("convertFromGeometry:unknown-geometry",new dt(`Unable to parse unknown geometry type '${t}'`))}function pU(t,e,i,s){const n=t&&("coords"in t?t:t.geometry);if(c(n))return null;switch(e){case"esriGeometryPoint":{let t=zG;return i&&s?t=HG:i?t=UG:s&&(t=BG),t(n)}case"esriGeometryMultipoint":return KG(n,i,s);case"esriGeometryPolyline":return tU(n,i,s);case"esriGeometryPolygon":return sU(n,i,s);default:return void OG.error("convertToGeometry:unknown-geometry",new dt(`Unable to parse unknown geometry type '${e}'`))}}function yU(t,e,i,s,n){if(t.length=0,c(i))return function(t,e){for(const i of e)t.push({attributes:i.attributes});return t}(t,e);switch(i){case"esriGeometryPoint":return function(t,e,i,s){let n=zG;i&&s?n=HG:i?n=UG:s&&(n=BG);for(const i of e){const{geometry:e,attributes:s}=i,r=u(e)?n(e):null;t.push({attributes:s,geometry:r})}return t}(t,e,s,n);case"esriGeometryMultipoint":return function(t,e,i,s){for(const n of e){const{geometry:e,attributes:r}=n;let o;e&&(o=KG(e,i,s)),t.push({attributes:r,geometry:o})}return t}(t,e,s,n);case"esriGeometryPolyline":return function(t,e,i,s){for(const n of e){const{geometry:e,attributes:r}=n;let o;u(e)&&(o=tU(e,i,s)),t.push({attributes:r,geometry:o})}return t}(t,e,s,n);case"esriGeometryPolygon":return function(t,e,i,s){for(const n of e){const{geometry:e,attributes:r,centroid:o}=n;let a;if(u(e)&&(a=sU(e,i,s)),o){const e=zG(o);t.push({attributes:r,centroid:e,geometry:a})}else t.push({attributes:r,geometry:a})}return t}(t,e,s,n);default:OG.error("convertToFeatureSet:unknown-geometry",new dt(`Unable to parse unknown geometry type '${i}'`))}return t}function mU(t){const{objectIdFieldName:e,spatialReference:i,transform:s,fields:n,hasM:r,hasZ:o,features:a,geometryType:l,exceededTransferLimit:u,uniqueIdField:c,queryGeometry:h,queryGeometryType:d}=t,f={features:yU([],a,l,o,r),fields:n,geometryType:l,objectIdFieldName:e,spatialReference:i,uniqueIdField:c,queryGeometry:pU(h,d,!1,!1)};return s&&(f.transform=s),u&&(f.exceededTransferLimit=u),r&&(f.hasM=r),o&&(f.hasZ=o),f}function gU(t,e){const i=new Uz,{hasM:s,hasZ:n,features:r,objectIdFieldName:o,spatialReference:a,geometryType:l,exceededTransferLimit:u,transform:c,fields:h}=t;return h&&(i.fields=h),i.geometryType=l,i.objectIdFieldName=o||e,i.spatialReference=a,i.objectIdFieldName?(r&&cU(i.features,r,l,n,s,i.objectIdFieldName),u&&(i.exceededTransferLimit=u),s&&(i.hasM=s),n&&(i.hasZ=n),c&&(i.transform=c),i):(OG.error(new dt("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),i)}function vU(t){const{transform:e,features:i,hasM:s,hasZ:n}=t;if(!e)return t;for(const t of i)u(t.geometry)&&IU(t.geometry,t.geometry,s,n,e),t.centroid&&IU(t.centroid,t.centroid,s,n,e);return t.transform=null,t}function wU(t,e){const{geometryType:i,features:s,hasM:n,hasZ:r}=e;if(!t)return e;for(let e=0;e<s.length;e++){const o=s[e],a=o.weakClone();a.geometry=new Vz,bU(a.geometry,o.geometry,n,r,i,t),o.centroid&&(a.centroid=new Vz,bU(a.centroid,o.centroid,n,r,"esriGeometryPoint",t)),s[e]=a}return e.transform=t,e}function bU(t,e,i,s,n,r,o=i,a=s){if(t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0),c(e)||!e.coords.length)return null;const l=AG[n],{coords:u,lengths:h}=e,d=TG(i,s),f=TG(i&&o,s&&a),p=LG(i,s,o,a);if(!h.length)return p(t.coords,u,0,0,RG(r,u[0]),NG(r,u[1])),t.lengths.length&&(t.lengths.length=0),t.coords.length=d,t;let y,m,g,v,w=0,b=0,M=b;for(const e of h){if(e<l)continue;let i=0;b=M,g=y=RG(r,u[w]),v=m=NG(r,u[w+1]),p(t.coords,u,b,w,g,v),i++,w+=d,b+=f;for(let s=1;s<e;s++,w+=d)g=RG(r,u[w]),v=NG(r,u[w+1]),g===y&&v===m||(p(t.coords,u,b,w,g-y,v-m),b+=f,i++,y=g,m=v);i>=l&&(t.lengths.push(i),M=b)}return t.coords.length=M,t.coords.length?t:null}function MU(t,e,i,s,n,r,o=i,a=s){if(t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0),!e||!e.coords.length)return null;const l=AG[n],{coords:u,lengths:c}=e,h=TG(i,s),d=TG(i&&o,s&&a),f=LG(i,s,o,a);if(!c.length)return f(t.coords,u,0,0,u[0],u[1]),t.lengths.length&&(t.lengths.length=0),t.coords.length=h,t;let p=0;const y=r*r;for(const e of c){if(e<l){p+=e*h;continue}const i=t.coords.length/d,s=p,n=p+(e-1)*h;f(t.coords,u,t.coords.length,s,u[s],u[s+1]),xU(t.coords,u,h,y,f,s,n),f(t.coords,u,t.coords.length,n,u[n],u[n+1]);const r=t.coords.length/d-i;r>=l?t.lengths.push(r):t.coords.length=i*d,p+=e*h}return t.coords.length?t:null}function SU(t,e,i,s){const n=t[e],r=t[e+1],o=t[s],a=t[s+1];let l=t[i],u=t[i+1],c=o-l,h=a-u;if(0!==c||0!==h){const t=((n-l)*c+(r-u)*h)/(c*c+h*h);t>1?(l=o,u=a):t>0&&(l+=c*t,u+=h*t)}return c=n-l,h=r-u,c*c+h*h}function xU(t,e,i,s,n,r,o){let a,l=s,u=0;for(let t=r+i;t<o;t+=i)a=SU(e,t,r,o),a>l&&(u=t,l=a);l>s&&(u-r>i&&xU(t,e,i,s,n,r,u),n(t,e,t.length,u,e[u],e[u+1]),o-u>i&&xU(t,e,i,s,n,u,o))}function kU(t,e,i,s){if(c(e)||!e.coords||!e.coords.length)return null;const n=TG(i,s);let r=1/0,o=1/0,a=-1/0,l=-1/0;if(e&&e.coords){const t=e.coords;for(let e=0;e<t.length;e+=n){const i=t[e],s=t[e+1];r=Math.min(r,i),a=Math.max(a,i),o=Math.min(o,s),l=Math.max(l,s)}}return t[0]=r,t[1]=o,t[2]=a,t[3]=l,t}function IU(t,e,i,s,n){const{coords:r,lengths:o}=e,a=i?s?EG:CG:s?CG:FG,l=TG(i,s);if(!r.length)return t!==e&&(t.lengths.length=0,t.coords.length=0),t;if(!o.length)return a(t.coords,r,0,0,DG(n,r[0]),VG(n,r[1])),t!==e&&(t.lengths.length=0,t.coords.length=l),t;const[u,c]=n.scale;let h=0;for(let e=0;e<o.length;e++){const i=o[e];t.lengths[e]=i;let s=DG(n,r[h]),d=VG(n,r[h+1]);a(t.coords,r,h,h,s,d),h+=l;for(let e=1;e<i;e++,h+=l)s+=r[h]*u,d-=r[h+1]*c,a(t.coords,r,h,h,s,d)}return t!==e&&(t.lengths.length=o.length,t.coords.length=r.length),t}function jU(t,e,i,s,n,r){const o=TG(i,s),a=LG(i,s,n,r),l=e.coords;t.coords.length=0,t.lengths.length=0,t.lengths.push(...e.lengths);for(let e=0;e<l.length;e+=o)a(t.coords,l,t.coords.length,e,l[e],l[e+1]);return t}function _U(t,e,i,s){let n=0,r=t[s*e],o=t[s*(e+1)];for(let a=1;a<i;a++){const i=r+t[s*(e+a)],l=o+t[s*(e+a)+1],u=(i-r)*(l+o);r=i,o=l,n+=u}return.5*n}function TU(t,e){const{coords:i,lengths:s}=t;let n=0,r=0;for(let t=0;t<s.length;t++)r+=_U(i,n,s[t],e),n+=t;return Math.abs(r)}function OU(t,e){if(c(t))return null;const i=t.clone(),s=t.coords,n=t.lengths;let r=0;for(let t=0;t<n.length;t++){const o=n[t];let a=s[e*r],l=s[e*r+1];for(let t=1;t<o;t++){const n=a+s[e*(r+t)],o=l+s[e*(r+t)+1];i.coords[e*(r+t)]=n,i.coords[e*(r+t)+1]=o,a=n,l=o}r+=o}return i}function AU(t,e){return e}function FU(t,e,i,s){switch(i){case 0:return LU(t,e+s,0);case 1:return"lowerLeft"===t.originPosition?LU(t,e+s,1):function({translate:t,scale:e},i,s){return t[s]-i*e[s]}(t,e+s,1)}}function CU(t,e,i,s){return 2===i?LU(t,e,2):FU(t,e,i,s)}function PU(t,e,i,s){return 2===i?LU(t,e,3):FU(t,e,i,s)}function EU(t,e,i,s){return 3===i?LU(t,e,3):CU(t,e,i,s)}function LU({translate:t,scale:e},i,s){return t[s]+i*e[s]}class RU{constructor(t){this.options=t,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=AU,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,this.AttributesConstructor=function(){}}createFeatureResult(){return{fields:[],features:[]}}finishFeatureResult(t){if(this.options.applyTransform&&(t.transform=null),this.AttributesConstructor=function(){},this.coordinateBuffer=null,this.lengths.length=0,!t.hasZ)return;const e=ZC(t.geometryType,this.options.sourceSpatialReference,t.spatialReference);if(!c(e))for(const i of t.features)e(i.geometry)}createSpatialReference(){return{}}addField(t,e){t.fields.push(e);const i=t.fields.map((t=>t.name));this.AttributesConstructor=function(){for(const t of i)this[t]=null}}addFeature(t,e){t.features.push(e)}prepareFeatures(t){switch(this.transform=t.transform,this.options.applyTransform&&t.transform&&(this.applyTransform=this.deriveApplyTransform(t)),this.vertexDimension=2,t.hasZ&&this.vertexDimension++,t.hasM&&this.vertexDimension++,t.geometryType){case"esriGeometryPoint":this.addCoordinate=(t,e,i)=>this.addCoordinatePoint(t,e,i),this.createGeometry=t=>this.createPointGeometry(t);break;case"esriGeometryPolygon":this.addCoordinate=(t,e,i)=>this.addCoordinatePolygon(t,e,i),this.createGeometry=t=>this.createPolygonGeometry(t);break;case"esriGeometryPolyline":this.addCoordinate=(t,e,i)=>this.addCoordinatePolyline(t,e,i),this.createGeometry=t=>this.createPolylineGeometry(t);break;case"esriGeometryMultipoint":this.addCoordinate=(t,e,i)=>this.addCoordinateMultipoint(t,e,i),this.createGeometry=t=>this.createMultipointGeometry(t)}}createFeature(){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,{attributes:new this.AttributesConstructor}}allocateCoordinates(){}addLength(t,e,i){0===this.lengths.length&&(this.toAddInCurrentPath=e),this.lengths.push(e)}addQueryGeometry(t,e){const{queryGeometry:i,queryGeometryType:s}=e,n=pU(IU(i.clone(),i,!1,!1,this.transform),s,!1,!1);t.queryGeometryType=s,t.queryGeometry={...n}}createPointGeometry(t){const e={x:0,y:0,spatialReference:t.spatialReference};return t.hasZ&&(e.z=0),t.hasM&&(e.m=0),e}addCoordinatePoint(t,e,i){switch(e=this.applyTransform(this.transform,e,i,0),i){case 0:t.x=e;break;case 1:t.y=e;break;case 2:"z"in t?t.z=e:t.m=e;break;case 3:t.m=e}}transformPathLikeValue(t,e){let i=0;return e<=1&&(i=this.previousCoordinate[e],this.previousCoordinate[e]+=t),this.applyTransform(this.transform,t,e,i)}addCoordinatePolyline(t,e,i){this.dehydratedAddPointsCoordinate(t.paths,e,i)}addCoordinatePolygon(t,e,i){this.dehydratedAddPointsCoordinate(t.rings,e,i)}addCoordinateMultipoint(t,e,i){0===i&&t.points.push([]);const s=this.transformPathLikeValue(e,i);t.points[t.points.length-1].push(s)}createPolygonGeometry(t){return{rings:[[]],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}createPolylineGeometry(t){return{paths:[[]],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}createMultipointGeometry(t){return{points:[],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}dehydratedAddPointsCoordinate(t,e,i){0===i&&0==this.toAddInCurrentPath--&&(t.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);const s=this.transformPathLikeValue(e,i),n=t[t.length-1];0===i&&(this.coordinateBufferPtr=0,this.coordinateBuffer=Array(this.vertexDimension),n.push(this.coordinateBuffer)),this.coordinateBuffer[this.coordinateBufferPtr++]=s}deriveApplyTransform(t){const{hasZ:e,hasM:i}=t;return e&&i?EU:e?CU:i?PU:FU}}function NU(t,e){const i=t.toJSON();return i.objectIds&&(i.objectIds=i.objectIds.join(",")),i.orderByFields&&(i.orderByFields=i.orderByFields.join(",")),!i.outFields||null!=e&&e.returnCountOnly?delete i.outFields:i.outFields=-1!==i.outFields.indexOf("*")?"*":i.outFields.join(","),i.outSpatialReference&&(i.outSR=i.outSR.wkid||JSON.stringify(i.outSR.toJSON()),delete i.outSpatialReference),i.dynamicDataSource&&(i.layer=JSON.stringify({source:i.dynamicDataSource}),delete i.dynamicDataSource),i}async function DU(t,e,i={},s){const n=bz({...t.query,f:"json",...s,...NU(e,s)});return oi(t.path+"/queryRelatedRecords",{...i,query:{...i.query,...n}})}const VU="Layer does not support extent calculation.";function $U(t,e){var i,s;const n=t.geometry,r=t.toJSON(),o=r;if(u(n)&&(o.geometry=JSON.stringify(n),o.geometryType=Kw(n),o.inSR=n.spatialReference.wkid||JSON.stringify(n.spatialReference)),null!=(i=r.topFilter)&&i.groupByFields&&(o.topFilter.groupByFields=r.topFilter.groupByFields.join(",")),null!=(s=r.topFilter)&&s.orderByFields&&(o.topFilter.orderByFields=r.topFilter.orderByFields.join(",")),r.topFilter&&(o.topFilter=JSON.stringify(o.topFilter)),r.objectIds&&(o.objectIds=r.objectIds.join(",")),r.orderByFields&&(o.orderByFields=r.orderByFields.join(",")),r.outFields&&!(null!=e&&e.returnCountOnly||null!=e&&e.returnExtentOnly||null!=e&&e.returnIdsOnly)?o.outFields=-1!==r.outFields.indexOf("*")?"*":r.outFields.join(","):delete o.outFields,r.outSR?o.outSR=r.outSR.wkid||JSON.stringify(r.outSR):n&&r.returnGeometry&&(o.outSR=o.inSR),r.returnGeometry&&delete r.returnGeometry,r.timeExtent){const t=r.timeExtent,{start:e,end:i}=t;null==e&&null==i||(o.time=e===i?e:`${null==e?"null":e},${null==i?"null":i}`),delete r.timeExtent}return o}function zU(t,e,i,s={},n={}){const r="string"==typeof t?Tt(t):t,o=e.geometry?[e.geometry]:[];return s.responseType="pbf"===i?"array-buffer":"json",Ez(o,null,s).then((t=>{const o=t&&t[0];u(o)&&((e=e.clone()).geometry=o);const a=bz({...r.query,f:i,...n,...$U(e,n)});return oi(Wt(r.path,"queryTopFeatures"),{...s,query:{...a,...s.query}})}))}let GU=class extends MV{constructor(t){super(t),this.dynamicDataSource=null,this.fieldsIndex=null,this.format="json",this.gdbVersion=null,this.infoFor3D=null,this.sourceSpatialReference=null}execute(t,e){return this.executeJSON(t,e).then((i=>this.featureSetFromJSON(t,i,e)))}async executeJSON(t,e){var i;const s={...this.requestOptions,...e},n=this._normalizeQuery(t),r=null!=(null==(i=t.outStatistics)?void 0:i[0]),o=l("featurelayer-pbf-statistics"),a=!r||o;let u;if("pbf"===this.format&&a)try{u=await async function(t,e,i){const s=vV(t),n={...i},r=YE.from(e),o=!r.quantizationParameters,{data:a}=await gG(s,r,new RU({sourceSpatialReference:r.sourceSpatialReference,applyTransform:o}),n);return a}(this.url,n,s)}catch(t){if("query:parsing-pbf"!==t.name)throw t;this.format="json"}return"json"!==this.format&&a||(u=await _G(this.url,n,s)),this._normalizeFields(u.fields),u}async featureSetFromJSON(t,e,i){if(!(this._queryIs3DObjectFormat(t)&&u(this.infoFor3D)&&e.features&&e.features.length))return lP.fromJSON(e);const{meshFeatureSetFromJSON:s}=await ze(import("./p-33ff00d0.js").then((function(t){return t.a})),i);return s(t,this.infoFor3D,e)}executeForCount(t,e){const i={...this.requestOptions,...e},s=this._normalizeQuery(t);return kG(this.url,s,i)}executeForExtent(t,e){const i={...this.requestOptions,...e},s=this._normalizeQuery(t);return async function(t,e,i){return MG(vV(t),YE.from(e),{...i}).then((t=>({count:t.data.count,extent:Ld.fromJSON(t.data.extent)})))}(this.url,s,i)}executeForIds(t,e){const i={...this.requestOptions,...e},s=this._normalizeQuery(t);return IG(this.url,s,i)}executeRelationshipQuery(t,e){t=AN.from(t);const i={...this.requestOptions,...e};return(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),async function(t,e,i){return e=AN.from(e),async function(t,e,i){const s=await DU(t,e,i),n=s.data,r=n.geometryType,o=n.spatialReference,a={};for(const t of n.relatedRecordGroups){const e={fields:void 0,objectIdFieldName:void 0,geometryType:r,spatialReference:o,hasZ:!!n.hasZ,hasM:!!n.hasM,features:t.relatedRecords};if(null!=t.objectId)a[t.objectId]=e;else for(const i in t)t.hasOwnProperty(i)&&"relatedRecords"!==i&&(a[t[i]]=e)}return{...s,data:a}}(vV(t),e,i).then((t=>{const e=t.data,i={};return Object.keys(e).forEach((t=>i[t]=lP.fromJSON(e[t]))),i}))}(this.url,t,i)}executeRelationshipQueryForCount(t,e){t=AN.from(t);const i={...this.requestOptions,...e};return(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),async function(t,e,i){return e=AN.from(e),async function(t,e,i){const s=await DU(t,e,i,{returnCountOnly:!0}),n=s.data,r={};for(const t of n.relatedRecordGroups)null!=t.objectId&&(r[t.objectId]=t.count);return{...s,data:r}}(vV(t),e,{...i}).then((t=>t.data))}(this.url,t,i)}executeAttachmentQuery(t,e){const i={...this.requestOptions,...e};return async function(t,e,i){const s=vV(t);return function(t,e,i){let s={query:bz({...t.query,f:"json",...Mz(e)})};return i&&(s={...i,...s,query:{...i.query,...s.query}}),oi(t.path+"/queryAttachments",s)}(s,S_.from(e),{...i}).then((t=>Sz(t.data.attachmentGroups,s.path)))}(this.url,t,i)}executeTopFeaturesQuery(t,e){const i={...this.requestOptions,...e};return async function(t,e,i,s){const n=vV(t),r={...s},{data:o}=await async function(t,e,i,s){const n=await zU(t,e,"json",s);return tP(e,i,n.data),n}(n,DN.from(e),i,r);return lP.fromJSON(o)}(this.parsedUrl,t,this.sourceSpatialReference,i)}executeForTopIds(t,e){const i={...this.requestOptions,...e};return async function(t,e,i){const s=vV(t);return(await async function(t,e,i){return u(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):zU(t,e,"json",i,{returnIdsOnly:!0})}(s,DN.from(e),{...i})).data.objectIds}(this.parsedUrl,t,i)}executeForTopExtents(t,e){const i={...this.requestOptions,...e};return async function(t,e,i){const s=vV(t),n=await async function(t,e,i){return u(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):zU(t,e,"json",i,{returnExtentOnly:!0,returnCountOnly:!0}).then((t=>{const e=t.data;if(e.hasOwnProperty("extent"))return t;if(e.features)throw Error(VU);if(e.hasOwnProperty("count"))throw Error(VU);return t}))}(s,DN.from(e),{...i});return{count:n.data.count,extent:Ld.fromJSON(n.data.extent)}}(this.parsedUrl,t,i)}executeForTopCount(t,e){const i={...this.requestOptions,...e};return async function(t,e,i){const s=vV(t);return(await function(t,e,i){return u(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):zU(t,e,"json",i,{returnIdsOnly:!0,returnCountOnly:!0})}(s,DN.from(e),{...i})).data.count}(this.parsedUrl,t,i)}_normalizeQuery(t){let e=YE.from(t);if(e.sourceSpatialReference=e.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&(e=e===t?e.clone():e,e.gdbVersion=t.gdbVersion||this.gdbVersion,e.dynamicDataSource=t.dynamicDataSource?VE.from(t.dynamicDataSource):this.dynamicDataSource),u(this.infoFor3D)&&this._queryIs3DObjectFormat(t)){e=e===t?e.clone():e,e.formatOf3DObjects=null;for(const t of this.infoFor3D.queryFormats){if("3D_glb"===t.id){e.formatOf3DObjects=t.id;break}"3D_gltf"!==t.id||e.formatOf3DObjects||(e.formatOf3DObjects=t.id)}if(!e.formatOf3DObjects)throw new dt("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if(c(e.outFields)||!e.outFields.includes("*")){e=e===t?e.clone():e,c(e.outFields)&&(e.outFields=[]);const{originX:i,originY:s,originZ:n,translationX:r,translationY:o,translationZ:a,scaleX:l,scaleY:u,scaleZ:h,rotationX:d,rotationY:f,rotationZ:p,rotationDeg:y}=this.infoFor3D.transformFieldRoles;e.outFields.push(i,s,n,r,o,a,l,u,h,d,f,p,y)}}return e}_normalizeFields(t){if(u(this.fieldsIndex)&&u(t))for(const e of t){const t=this.fieldsIndex.get(e.name);t&&Object.assign(e,t.toJSON())}}_queryIs3DObjectFormat(t){return u(this.infoFor3D)&&t.returnGeometry&&"xyFootprint"!==t.multipatchOption&&!t.outStatistics}};e([Hn({type:VE})],GU.prototype,"dynamicDataSource",void 0),e([Hn()],GU.prototype,"fieldsIndex",void 0),e([Hn()],GU.prototype,"format",void 0),e([Hn()],GU.prototype,"gdbVersion",void 0),e([Hn()],GU.prototype,"infoFor3D",void 0),e([Hn()],GU.prototype,"sourceSpatialReference",void 0),GU=e([_r("esri.tasks.QueryTask")],GU);const UU=GU,qU=ct.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),BU=new Map;function WU(t){if(!H$(t))return null;const[e,i]=t.split("/").slice(1);return{layerId:e,fieldName:i}}let HU=class extends Ar{constructor(t){super(t),this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(t){this._setContentElementMedia(t)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(t){const{formattedMediaInfoCount:e}=this;this.activeMediaInfoIndex=(t+e)%e}_pageContentElementMedia(t){const{activeMediaInfoIndex:e}=this;this._setContentElementMedia(e+t)}_formatMediaInfos(){const{attributes:t,mediaInfos:e,formattedAttributes:i,expressionAttributes:s,fieldInfoMap:n,layer:r}=this;return null==e?void 0:e.map((e=>{if(!e)return null;if(e.title=N$({attributes:t,fieldInfoMap:n,globalAttributes:i,expressionAttributes:s,layer:r,text:e.title}),e.caption=N$({attributes:t,fieldInfoMap:n,globalAttributes:i,expressionAttributes:s,layer:r,text:e.caption}),e.altText=N$({attributes:t,fieldInfoMap:n,globalAttributes:i,expressionAttributes:s,layer:r,text:e.altText}),"image"===e.type){const{value:t}=e;return this._setImageValue({value:t,formattedAttributes:i,layer:r}),e.value.sourceURL?e:void 0}if("pie-chart"===e.type||"line-chart"===e.type||"column-chart"===e.type||"bar-chart"===e.type){const{value:s}=e;return this._setChartValue({value:s,chartType:e.type,attributes:t,formattedAttributes:i,layer:r}),e}return null})).filter(Boolean)}_setImageValue(t){const{fieldInfoMap:e}=this,{value:i,formattedAttributes:s,layer:n}=t,{linkURL:r,sourceURL:o}=i;if(o){const t=V$(o,n);i.sourceURL=D$({formattedAttributes:s,template:t,fieldInfoMap:e})}if(r){const t=V$(r,n);i.linkURL=D$({formattedAttributes:s,template:t,fieldInfoMap:e})}}_setChartValue(t){const{value:e,attributes:i,formattedAttributes:s,chartType:n,layer:r}=t,{popupTemplate:o,relatedInfos:a}=this,{fields:l,normalizeField:u}=e;if(e.fields=function(t,e){return t&&t.map((t=>E$(t,e)))}(l,r),u&&(e.normalizeField=E$(u,r)),!l.some((t=>!!(null!=s[t]||H$(t)&&a.size))))return;const c=null==o?void 0:o.fieldInfos;l.forEach((t=>{if(H$(t))return void(e.series=[...e.series,...this._getRelatedChartInfos({fieldInfos:c,fieldName:t,formattedAttributes:s,chartType:n,value:e})]);const r=this._getChartOption({value:e,attributes:i,chartType:n,formattedAttributes:s,fieldName:t,fieldInfos:c});e.series.push(r)}))}_getRelatedChartInfos(t){var e;const{fieldInfos:i,fieldName:s,formattedAttributes:n,chartType:r,value:o}=t,a=[],l=WU(s),{layerId:u,fieldName:c}=l,h=null==(e=this.relatedInfos)?void 0:e.get(""+u);if(!h)return a;const{relatedFeatures:d,relation:f}=h;if(!f||!d)return a;const{cardinality:p}=f;return d.forEach((t=>{const{attributes:e}=t;e&&Object.keys(e).forEach((t=>{t===c&&a.push(this._getChartOption({value:o,attributes:e,formattedAttributes:n,fieldName:s,chartType:r,relatedFieldName:t,fieldInfos:i}))}))})),"one-to-many"===p||"many-to-many"===p?a:[a[0]]}_getTooltip({label:t,value:e,chartType:i}){return"pie-chart"===i?t:`${t}: ${e}`}_getChartOption(t){var e;const{value:i,attributes:s,formattedAttributes:n,fieldName:r,relatedFieldName:o,fieldInfos:a,chartType:l}=t,{layer:u}=this,{normalizeField:c,tooltipField:h}=i,d=c?H$(c)?s[WU(c).fieldName]:s[c]:null,f=o&&void 0!==s[o]?s[o]:void 0!==s[r]?s[r]:n[r],p=void 0===f?null:f&&d?f/d:f,y=new xM({value:p});if(H$(r)){const t=WU(r),e=WU(h),i=e?e.fieldName:null,n=z$(p,{fieldInfos:a,fieldName:o,layer:u,preventPlacesFormatting:!!d}),c=t?t.label||t.fieldName:o;return y.tooltip=this._getTooltip({label:i&&void 0!==s[i]?s[i]:c,value:n,chartType:l}),y}const m=G$(a,r),g=E$(r,u),v=h&&void 0!==n[h]?n[h]:P$(m||new yM({fieldName:g}),null==(e=this.popupTemplate)?void 0:e.expressionInfos);return y.tooltip=this._getTooltip({label:v,value:n[g],chartType:l}),y}};e([Hn()],HU.prototype,"activeMediaInfoIndex",void 0),e([Hn({readOnly:!0})],HU.prototype,"activeMediaInfo",null),e([Hn()],HU.prototype,"attributes",void 0),e([Hn()],HU.prototype,"description",void 0),e([Hn()],HU.prototype,"fieldInfoMap",void 0),e([Hn()],HU.prototype,"formattedAttributes",void 0),e([Hn()],HU.prototype,"expressionAttributes",void 0),e([Hn({readOnly:!0})],HU.prototype,"formattedMediaInfos",null),e([Hn()],HU.prototype,"layer",void 0),e([Hn({readOnly:!0})],HU.prototype,"formattedMediaInfoCount",null),e([Hn()],HU.prototype,"mediaInfos",void 0),e([Hn()],HU.prototype,"popupTemplate",void 0),e([Hn()],HU.prototype,"relatedInfos",void 0),e([Hn()],HU.prototype,"title",void 0),HU=e([_r("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],HU);const JU=HU;var ZU=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],QU=[{name:"default",colors:[].concat(ZU.slice(30,39),ZU.slice(28,30).reverse())},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];const KU=new Map([["ar",()=>import("./p-d24e109e.js").then((t=>t.a))],["bs-ba",()=>import("./p-165f141e.js").then((t=>t.b))],["ca-es",()=>import("./p-36445a12.js").then((t=>t.c))],["cs-cz",()=>import("./p-b138a877.js").then((t=>t.c))],["da-dk",()=>import("./p-28b53674.js").then((t=>t.d))],["de-de",()=>import("./p-295fbc0e.js").then((t=>t.d))],["de-ch",()=>import("./p-a872b03a.js").then((t=>t.d))],["el-gr",()=>import("./p-1ec951ac.js").then((t=>t.e))],["en-us",()=>import("./p-0f564f5d.js").then((t=>t.e))],["en-ca",()=>import("./p-1e21fbd5.js").then((t=>t.e))],["es-es",()=>import("./p-01fac15a.js").then((t=>t.e))],["et-ee",()=>import("./p-27e13221.js").then((t=>t.e))],["fi-fi",()=>import("./p-16a12fde.js").then((t=>t.f))],["fr-fr",()=>import("./p-f03e863b.js").then((t=>t.f))],["he-il",()=>import("./p-1ceae54f.js").then((t=>t.h))],["hr-hr",()=>import("./p-1fc325c7.js").then((t=>t.h))],["hu-hu",()=>import("./p-47772cf1.js").then((t=>t.h))],["id-id",()=>import("./p-c7fb14dd.js").then((t=>t.i))],["it-it",()=>import("./p-0019b2e1.js").then((t=>t.i))],["ja-jp",()=>import("./p-b44094da.js").then((t=>t.j))],["ko-kr",()=>import("./p-6cbe357e.js").then((t=>t.k))],["lt-lt",()=>import("./p-466f16d6.js").then((t=>t.l))],["lv-lv",()=>import("./p-411892f7.js").then((t=>t.l))],["nb-no",()=>import("./p-9531c1b9.js").then((t=>t.n))],["nl-nl",()=>import("./p-c58e407e.js").then((t=>t.n))],["pl-pl",()=>import("./p-5b2248a8.js").then((t=>t.p))],["pt-br",()=>import("./p-009f491a.js").then((t=>t.p))],["pt-pt",()=>import("./p-dcf3890e.js").then((t=>t.p))],["ro-ro",()=>import("./p-bcd2c290.js").then((t=>t.r))],["ru-ru",()=>import("./p-8943a0da.js").then((t=>t.r))],["sk-sk",()=>import("./p-e82931a9.js").then((t=>t.s))],["sl-sl",()=>import("./p-1c2ca123.js").then((t=>t.s))],["sr-rs",()=>import("./p-a9f696ad.js").then((t=>t.s))],["sv-se",()=>import("./p-4ca6902f.js").then((t=>t.s))],["th-th",()=>import("./p-2055e35f.js").then((t=>t.t))],["tr-tr",()=>import("./p-c0b0c346.js").then((t=>t.t))],["uk-ua",()=>import("./p-a7184375.js").then((t=>t.u))],["vi-vn",()=>import("./p-f06c242c.js").then((t=>t.v))],["zh-cn",()=>import("./p-3f123fdb.js").then((t=>t.z))],["zh-hk",()=>import("./p-5cd40670.js").then((t=>t.z))],["zh-tw",()=>import("./p-5cd40670.js").then((t=>t.z))]]);let YU,XU;const tq="esri-feature-media__icon";let eq=class extends Gc{constructor(t,e){super(t,e),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.attributes=null,this.activeMediaInfoIndex=null,this.description=null,this.fieldInfoMap=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null,this.viewModel=new JU,this.messages=null}initialize(){this._featureElementInfo=new lz,this.own(Yr(this,["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],(()=>this._setupMediaRefreshTimer())),Yr(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo())))}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}render(){var t;return Fw("div",{bind:this,class:"esri-feature-media",onkeyup:this._handleMediaKeyup},null==(t=this._featureElementInfo)?void 0:t.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:t}=this.viewModel;return t?Fw("div",{key:"media-element-container",class:"esri-feature-media__container"},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(t){const{_refreshIntervalInfo:e}=this,{activeMediaInfoIndex:i,formattedMediaInfoCount:s}=this.viewModel,{value:n,refreshInterval:r,altText:o,title:a,type:l}=t,{sourceURL:u,linkURL:c}=n,h=F$(c)?"_blank":"_self",d="_blank"===h?"noreferrer":"",f=r?e:null,p=Fw("img",{alt:o||a,key:`media-${l}-${i}-${s}-${f?f.timestamp:0}`,src:f?f.sourceURL:u});return(c?Fw("a",{title:a,href:c,rel:d,target:h},p):null)||p}renderChartMediaInfo(t){const{activeMediaInfoIndex:e,formattedMediaInfoCount:i}=this.viewModel;return Fw("div",{key:`media-${t.type}-${e}-${i}`,bind:this,class:"esri-feature-media__chart",afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:t}=this.viewModel;return t?"image"===t.type?this.renderImageMediaInfo(t):-1!==t.type.indexOf("chart")?this.renderChartMediaInfo(t):null:null}renderMediaInfo(){const{activeMediaInfo:t}=this.viewModel;if(!t)return null;const e=t.title?Fw("div",{key:"media-title",class:"esri-feature-media__item-title",innerHTML:t.title}):null,i=t.caption?Fw("div",{key:"media-caption",class:"esri-feature-media__item-caption",innerHTML:t.caption}):null;return Fw("div",{key:"media-container",class:"esri-feature-media__item-container"},Fw("div",{key:"media-item-container",class:"esri-feature-media__item"},this.renderMediaInfoType()),e,i)}renderMediaPageButton(t){if(this.viewModel.formattedMediaInfoCount<2)return null;const e="previous"===t,i=e?this.messages.previous:this.messages.next,s=this.classes("esri-feature-media__button",e?"esri-feature-media__previous":"esri-feature-media__next"),n=e?this.classes(tq,"esri-feature-media__previous-icon","esri-icon-left-triangle-arrow"):this.classes(tq,"esri-feature-media__next-icon","esri-icon-right-triangle-arrow"),r=e?this.classes(tq,"esri-feature-media__previous-icon--rtl","esri-icon-right-triangle-arrow"):this.classes(tq,"esri-feature-media__next-icon--rtl","esri-icon-left-triangle-arrow");return Fw("button",{type:"button",key:e?"media-previous":"media-next",title:i,"aria-label":i,tabIndex:0,class:s,bind:this,onclick:e?this._previous:this._next},Fw("span",{"aria-hidden":"true",class:n}),Fw("span",{"aria-hidden":"true",class:r}))}_setupFeatureElementInfo(){const{description:t,title:e}=this;this._featureElementInfo.set({description:t,title:e})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getChartDependencies(t){const e=await async function(t=jo()){if(t=function(t){return t?KU.has(t.toLowerCase())?t.toLowerCase():function(t){const e=t.split("-")[0].toLowerCase();let i=null;for(const t of KU.keys())if(t.startsWith(e)){i=t;break}return i}(t)||"en-us":"en-us"}(t),YU&&t===XU)return YU;YU=import("./p-8574655c.js").then((t=>t.i)),XU=t;try{const[e,i]=await Promise.all([YU,KU.get(XU)()]);XU===t&&(e.am4core.options.defaultLocale=i.default),e.am4core.options.suppressWarnings=!0,e.am4core.options.autoDispose=!0}catch{return YU=null,XU=null,null}return YU}(),{activeMediaInfo:i}=this.viewModel;this._renderChart({chartDiv:t,mediaInfo:i,chartsModule:e})}_handleMediaKeyup(t){const e=Ae(t);"ArrowLeft"===e&&(t.stopPropagation(),this.viewModel.previous()),"ArrowRight"===e&&(t.stopPropagation(),this.viewModel.next())}_renderChart(t){const{chartsModule:e,chartDiv:i,mediaInfo:s}=t,{value:n,type:r}=s,{am4core:o}=e,a=function(t,e="default"){const i=QU.find((t=>t.name===e));return i?i.colors.map((e=>t.color(e))):null}(o);ql()&&o.useTheme(e.am4themes_dark),o.useTheme(e.am4themes_animated),o.useTheme((function(t){t instanceof o.ColorSet&&a&&(t.list=a)}));const l="pie-chart"===r?this._createPieChart(t):this._createXYChart(t);i.setAttribute("aria-label",s.altText||s.title),l.data=n.series.map((t=>({tooltip:t.tooltip,value:t.value}))).filter((t=>"pie-chart"!==r||t.value>0))}_customizeChartTooltip(t,e){t.label.wrap=!0,t.label.maxWidth=200,t.autoTextColor=!1,t.getFillFromObject=!1,t.label.fill=e.color("#ffffff"),t.background.fill=e.color({r:0,g:0,b:0,a:.7})}_createPieChart(t){const{chartDiv:e,chartsModule:i}=t,{am4core:s,am4charts:n}=i,r=s.create(e,n.PieChart);r.rtl=Pl(this.container);const o=r.series.push(new n.PieSeries);return o.labels.template.disabled=!0,o.ticks.template.disabled=!0,o.dataFields.value="value",o.dataFields.category="tooltip",this._customizeChartTooltip(o.tooltip,s),r}_getMinSeriesValue(t){let e=0;return t.forEach((t=>e=Math.min(t.value,e))),e}_createColumnChart(t,e){const{chartsModule:i,mediaInfo:s}=e,{value:n}=s,{am4core:r,am4charts:o}=i,a=t.xAxes.push(new o.CategoryAxis);a.dataFields.category="tooltip",a.renderer.labels.template.disabled=!0,this._customizeChartTooltip(a.tooltip,r),a.tooltip.events.on("sizechanged",(()=>{a.tooltip.dy=-a.tooltip.contentHeight}));const l=t.yAxes.push(new o.ValueAxis),u=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(l.tooltip,r),u.wrap=!0;const c=t.series.push(new o.ColumnSeries);c.dataFields.valueY="value",c.dataFields.categoryX="tooltip",t.cursor=new o.XYCursor,n.series.length>15&&(t.scrollbarX=new r.Scrollbar)}_createBarChart(t,e){const{chartsModule:i,mediaInfo:s}=e,{value:n}=s,{am4core:r,am4charts:o}=i,a=t.yAxes.push(new o.CategoryAxis);a.dataFields.category="tooltip",a.renderer.inversed=!0,a.renderer.labels.template.disabled=!0,this._customizeChartTooltip(a.tooltip,r),a.tooltip.events.on("sizechanged",(()=>{a.tooltip.dx=a.tooltip.contentWidth}));const l=t.xAxes.push(new o.ValueAxis),u=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(l.tooltip,r),u.wrap=!0;const c=t.series.push(new o.ColumnSeries);c.dataFields.valueX="value",c.dataFields.categoryY="tooltip",t.cursor=new o.XYCursor,n.series.length>15&&(t.scrollbarY=new r.Scrollbar)}_createLineChart(t,e){const{chartsModule:i,mediaInfo:s}=e,{value:n}=s,{am4core:r,am4charts:o}=i,a=t.xAxes.push(new o.CategoryAxis);a.dataFields.category="tooltip",a.renderer.labels.template.disabled=!0,this._customizeChartTooltip(a.tooltip,r),a.tooltip.events.on("sizechanged",(()=>{a.tooltip.dy=-a.tooltip.contentHeight}));const l=t.yAxes.push(new o.ValueAxis),u=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(l.tooltip,r),u.wrap=!0;const c=t.series.push(new o.LineSeries);c.dataFields.categoryX="tooltip",c.dataFields.valueY="value",t.cursor=new o.XYCursor,n.series.length>15&&(t.scrollbarX=new r.Scrollbar)}_createXYChart(t){const{chartDiv:e,chartsModule:i,mediaInfo:s}=t,{type:n}=s,{am4core:r,am4charts:o}=i,a=r.create(e,o.XYChart);return a.rtl=Pl(this.container),"column-chart"===n&&this._createColumnChart(a,t),"bar-chart"===n&&this._createBarChart(a,t),"line-chart"===n&&this._createLineChart(a,t),a}_clearMediaRefreshTimer(){const{_refreshTimer:t}=this;t&&(clearTimeout(t),this._refreshTimer=null)}_updateMediaInfoTimestamp(t){const e=Date.now();this._refreshIntervalInfo={timestamp:e,sourceURL:this._getImageSource(t,e)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:t}=this.viewModel;t&&"image"===t.type&&t.refreshInterval&&this._setRefreshTimeout(t)}_setRefreshTimeout(t){const{refreshInterval:e,value:i}=t;if(!e)return;const s=6e4*e;this._updateMediaInfoTimestamp(i.sourceURL);const n=setInterval((()=>{this._updateMediaInfoTimestamp(i.sourceURL)}),s);this._refreshTimer=n}_getImageSource(t,e){const i=-1!==t.indexOf("?")?"&":"?",[s,n=""]=t.split("#");return`${s}${i}timestamp=${e}${n?"#":""}${n}`}};e([go("viewModel.attributes")],eq.prototype,"attributes",void 0),e([go("viewModel.activeMediaInfoIndex")],eq.prototype,"activeMediaInfoIndex",void 0),e([go("viewModel.description")],eq.prototype,"description",void 0),e([go("viewModel.fieldInfoMap")],eq.prototype,"fieldInfoMap",void 0),e([go("viewModel.layer")],eq.prototype,"layer",void 0),e([go("viewModel.mediaInfos")],eq.prototype,"mediaInfos",void 0),e([go("viewModel.popupTemplate")],eq.prototype,"popupTemplate",void 0),e([go("viewModel.relatedInfos")],eq.prototype,"relatedInfos",void 0),e([go("viewModel.title")],eq.prototype,"title",void 0),e([Hn({type:JU})],eq.prototype,"viewModel",void 0),e([Hn(),Lw("esri/widgets/Feature/t9n/Feature")],eq.prototype,"messages",void 0),eq=e([_r("esri.widgets.Feature.FeatureMedia")],eq);const iq=eq,sq=["$datastore","$map","$layer","$aggregatedfeatures"],nq=ct.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");async function rq({graphic:t,view:e}){const{isAggregate:i,layer:s}=t;if(!i||!s||"2d"!==(null==e?void 0:e.type))return[];const n=await e.whenLayerView(s);if(!n.createQuery||!n.queryFeatures)return[];const r=n.createQuery();r.aggregateIds=[t.getObjectId()];const{features:o}=await n.queryFeatures(r);return o}async function oq({expressionAttributes:t,info:e,arcadeUtils:i,interceptor:s,spatialReference:n,map:r,graphic:o,view:a}){const l="expression/"+e.name,u=i.createSyntaxTree(e.expression),c=sq.filter((t=>i.hasVariable(u,t))),[h]=await Fe([rq({graphic:o,view:a}),i.loadScriptDependencies(u,!0,c)]),d=i.getViewInfo({spatialReference:n}),f=i.createExecContext(o,d);f.interceptor=s,f.useAsync=!0,function({aggregatedFeatures:t,arcadeUtils:e,featureSetVars:i,context:s,viewInfo:n,map:r,graphic:o,interceptor:a}){i.forEach((i=>{const l=i.toLowerCase();if("$map"===l&&(s.vars[l]=e.convertMapToFeatureSetCollection({map:r,spatialReference:n.sr,interceptor:a})),"$layer"===l&&(s.vars[l]=e.convertFeatureLayerToFeatureSet({layer:o.sourceLayer,spatialReference:n.sr,interceptor:a})),"$datastore"===l&&(s.vars[l]=e.convertServiceUrlToWorkspace({url:o.sourceLayer.url,spatialReference:n.sr,interceptor:a})),"$aggregatedfeatures"===l){const i=o.layer,{fields:r,objectIdField:u,geometryType:c,spatialReference:h,displayField:d}=i,f=new aD({fields:r,objectIdField:u,geometryType:c,spatialReference:h,displayField:d,..."feature"===i.type?{templates:i.templates,typeIdField:i.typeIdField,types:i.types}:null,source:t});s.vars[l]=e.convertFeatureLayerToFeatureSet({layer:f,spatialReference:n.sr,interceptor:a})}}))}({aggregatedFeatures:h,arcadeUtils:i,featureSetVars:c,context:f,viewInfo:d,map:r,graphic:o,interceptor:s});const p=i.createFunction(u,f),y=await i.executeAsyncFunction(p,f).catch((t=>nq.error("arcade-execution-error",{error:t,graphic:o,expressionInfo:e})));t[l]="string"==typeof y?B$(q$(y)):Array.isArray(y)?function(t){return`<ul class="esri-widget__list">${t.map((t=>`<li>${"string"==typeof t?B$(q$(t)):t}</li>`)).join("")}</ul>`}(y):y&&"esri.arcade.Dictionary"===y.declaredClass?function(t){return`<table class="esri-widget__table">${t.keys().map((e=>{const i=t.field(e);return`<tr><th>${e}</th><td>${"string"==typeof i?B$(q$(i)):i}</td></tr>`})).join("")}</table>`}(y):y}async function aq({popupTemplate:t,spatialReference:e,graphic:i,interceptor:s,map:n,view:r}){const o=t.expressionInfos,a=[],l={};if(!o||!o.length)return l;const u=await import("./p-082c34d3.js").then((function(t){return t.as}));for(const t of o)a.push(oq({expressionAttributes:l,info:t,arcadeUtils:u,interceptor:s,spatialReference:e,map:n,graphic:i,view:r}));return await Be(a),l}var lq;const uq="esri.widgets.FeatureViewModel",cq=ct.getLogger(uq),hq={attachmentsContent:!0,customContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0};let dq=lq=class extends Ar{constructor(t){super(t),this._handles=new Qr,this._error=null,this._featureAbortController=null,this.graphicChangedThrottled=d$(this.graphicChanged,1,this),this._expressionAttributes=null,this.abilities={...hq},this.content=null,this.contentViewModels=[],this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=t=>{const{abilities:e}=this;return"attachments"===t.type&&e.attachmentsContent||"custom"===t.type&&e.customContent||"fields"===t.type&&e.fieldsContent||"media"===t.type&&e.mediaContent||"text"===t.type&&e.textContent},this._handles.add(Yr(this,["graphic","_effectivePopupTemplate","abilities"],(()=>this.graphicChangedThrottled())))}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return u(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return function(t,e){const i=new Map;return t&&t.forEach((t=>{const s=E$(t.fieldName,e);t.fieldName=s,i.set(s.toLowerCase(),t)})),i}(U$(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return O$(this.graphic)}castAbilities(t){return{...hq,...t}}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(t){this._set("graphic",t?t.clone():null)}get spatialReference(){return this.get("view.spatialReference")||null}set spatialReference(t){void 0!==t?this._override("spatialReference",t):this._clearOverride("spatialReference")}get map(){return this.get("view.map")||null}set map(t){void 0!==t?this._override("map",t):this._clearOverride("map")}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(t,e){const i=this.contentViewModels[t];i instanceof JU&&i.setActiveMedia(e)}nextMedia(t){const e=this.contentViewModels[t];e instanceof JU&&e.next()}previousMedia(t){const e=this.contentViewModels[t];e instanceof JU&&e.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:t}=this;if(!t)return;const e=new AbortController;this._featureAbortController=e;try{await this._queryFeature({signal:e.signal})}catch(e){Ge(e)||(this._error=e,cq.error("error","The popupTemplate could not be displayed for this feature.",{error:e,graphic:t,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===e&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:t}=this;t&&t.abort(),this._featureAbortController=null}_compileContent(t){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(t)?t.filter(this._isAllowedContentType).map(((t,e)=>"attachments"===t.type?this._compileAttachments(t,e):"custom"===t.type?this._compileCustom(t,e):"fields"===t.type?this._compileFields(t,e):"media"===t.type?this._compileMedia(t,e):"text"===t.type?this._compileText(t,e):void 0)):"string"==typeof t?this._compileText(new tS({text:t}),0).text:t}_destroyContentViewModels(){this.contentViewModels.forEach((t=>t&&!t.destroyed&&t.destroy())),this._set("contentViewModels",[])}_compileAttachments(t,e){const{graphic:i}=this,{description:s,title:n}=t;return this.contentViewModels[e]=new oz({graphic:i,...this._compileTitleAndDesc({title:n,description:s})}),t}_compileCustom(t,e){const{graphic:i}=this,{creator:s,destroyer:n}=t;return this.contentViewModels[e]=new dz({graphic:i,creator:s,destroyer:n}),t}_compileTitleAndDesc({title:t,description:e}){const{_fieldInfoMap:i,_sourceLayer:s,graphic:n,formattedAttributes:r,_expressionAttributes:o}=this,{attributes:a}=n,l=r.global;return{title:N$({attributes:a,fieldInfoMap:i,globalAttributes:l,expressionAttributes:o,layer:s,text:t}),description:N$({attributes:a,fieldInfoMap:i,globalAttributes:l,expressionAttributes:o,layer:s,text:e})}}_compileFields(t,e){const{_effectivePopupTemplate:i,formattedAttributes:s}=this,n=t.clone(),r={...s.global,...s.content[e]},o=(null==t?void 0:t.fieldInfos)||(null==i?void 0:i.fieldInfos),a=null==o?void 0:o.filter((({fieldName:t})=>C$(t)||H$(t)||r.hasOwnProperty(t))),l=null==i?void 0:i.expressionInfos,{description:u,title:c}=n,h=new mz({attributes:r,expressionInfos:l,fieldInfos:a,...this._compileTitleAndDesc({title:c,description:u})});return this.contentViewModels[e]=h,n.fieldInfos=h.formattedFieldInfos.slice(0),n}_compileMedia(t,e){const{graphic:i,_fieldInfoMap:s,_effectivePopupTemplate:n,relatedInfos:r,_sourceLayer:o,_expressionAttributes:a}=this,{attributes:l}=i,u=this.formattedAttributes.global,c=t.clone(),{description:h,mediaInfos:d,title:f}=c,p=new JU({activeMediaInfoIndex:c.activeMediaInfoIndex||0,attributes:l,layer:o,fieldInfoMap:s,formattedAttributes:u,expressionAttributes:a,mediaInfos:d,popupTemplate:n,relatedInfos:r,...this._compileTitleAndDesc({title:f,description:h})});return c.mediaInfos=p.formattedMediaInfos.slice(0),this.contentViewModels[e]=p,c}_compileText(t,e){const i=t.clone(),{graphic:s,_fieldInfoMap:n,_sourceLayer:r,_expressionAttributes:o}=this;if(i&&i.text){const{attributes:t}=s;i.text=N$({attributes:t,fieldInfoMap:n,globalAttributes:this.formattedAttributes.global,expressionAttributes:o,layer:r,text:i.text})}return this.contentViewModels[e]=new dz({graphic:s,creator:i.text}),i}_compileLastEditInfo(){const{_effectivePopupTemplate:t,_sourceLayer:e,graphic:i}=this;if(!t)return;const{lastEditInfoEnabled:s}=t,n=null==e?void 0:e.editFieldsInfo;return s&&n?function(t,e){const{creatorField:i,creationDateField:s,editorField:n,editDateField:r}=t;if(!e)return;const o=e[r];if("number"==typeof o){const t=e[n];return{type:"edit",date:qo(o,T$),user:t}}const a=e[s];if("number"==typeof a){const t=e[i];return{type:"create",date:qo(a,T$),user:t}}return null}(n,i.attributes):void 0}_compileTitle(t){const{_fieldInfoMap:e,_sourceLayer:i,graphic:s,_expressionAttributes:n}=this,{attributes:r}=s;return N$({attributes:r,fieldInfoMap:e,globalAttributes:this.formattedAttributes.global,expressionAttributes:n,layer:i,text:t})}async _getTitle(){const{_effectivePopupTemplate:t,graphic:e}=this;return A$(null==t?void 0:t.title,{graphic:e})}async _getContent(){const{_effectivePopupTemplate:t,graphic:e}=this;return A$(null==t?void 0:t.content,{graphic:e})}async _queryFeature(t){const{_featureAbortController:e,_sourceLayer:i,graphic:s,_effectivePopupTemplate:n,spatialReference:r,map:o,view:a}=this,{content:{value:l},title:{value:u}}=await Be({content:this._getContent(),title:this._getTitle()});if(e!==this._featureAbortController||!s)return;await async function({graphic:t,popupTemplate:e,layer:i,spatialReference:s},n){if(!i||!e)return;if("function"==typeof i.load&&await i.load(n),!t.attributes)return;const r=t.attributes[i.objectIdField];if(null==r)return;const o=[r],a=await e.getRequiredFields(i.fieldsIndex),l=Xb(a,t),u=l?[]:a,c=e.returnGeometry||await async function(t){var e;if(null==(e=t.expressionInfos)||!e.length)return!1;const i=await rb(),{arcadeUtils:{hasGeometryFunctions:s}}=i;return s(t)}(e);if(l&&!c)return;const h=await async function(t,e){var i,s;const{layer:n,graphic:r,outFields:o,objectIds:a,returnGeometry:l,spatialReference:u}=t,c=a[0];if("number"!=typeof c&&"string"!=typeof c)return v$.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",{layer:n,graphic:r,objectId:c,requiredFields:o}),null;if(null==(i=n.capabilities)||null==(s=i.operations)||!s.supportsQuery)return v$.warn("The specified layer cannot be queried. The following fields will not be available.",{layer:n,graphic:r,requiredFields:o,returnGeometry:l}),null;const h=n.createQuery();return h.objectIds=a,h.outFields=null!=o&&o.length?o:[n.objectIdField],h.returnGeometry=!!l,h.returnZ=!!l,h.returnM=!!l,h.outSpatialReference=u,(await n.queryFeatures(h,e)).features[0]}({layer:i,graphic:t,outFields:u,objectIds:o,returnGeometry:c,spatialReference:s},n);h&&(h.geometry&&(t.geometry=h.geometry),h.attributes&&(t.attributes={...t.attributes,...h.attributes}))}({graphic:s,popupTemplate:n,layer:i,spatialReference:r},t);const{expressionAttributes:{value:c}}=await Be({checkForRelatedFeatures:this._checkForRelatedFeatures(t),expressionAttributes:aq({popupTemplate:this._effectivePopupTemplate,spatialReference:r,graphic:s,map:o,interceptor:lq.interceptor,view:a})});e===this._featureAbortController&&s&&(this._expressionAttributes=c,this._set("formattedAttributes",this._createFormattedAttributes(l,c)),this._set("title",this._compileTitle(u)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(l)||null))}_createFormattedAttributes(t,e){const{_effectivePopupTemplate:i,graphic:s,relatedInfos:n,_sourceLayer:r,_fieldInfoMap:o}=this,a={...s.attributes,...e},l={global:W$({fieldInfos:null==i?void 0:i.fieldInfos,graphic:s,attributes:a,layer:r,fieldInfoMap:o,relatedInfos:n}),content:[]};return Array.isArray(t)&&t.forEach(((t,e)=>{"fields"===t.type&&t.fieldInfos&&(l.content[e]=W$({fieldInfos:t.fieldInfos,graphic:s,attributes:a,layer:r,fieldInfoMap:o,relatedInfos:n}))})),l}_checkForRelatedFeatures(t){const{graphic:e,_effectivePopupTemplate:i}=this;return this._queryRelatedInfos(e,U$(i),t)}async _queryRelatedInfos(t,e,i){const{relatedInfos:s,_sourceLayer:n}=this;s.clear();const r=u(n.associatedLayer)?await n.associatedLayer.load(i):n;if(!r)return;const o=e.filter((t=>t&&H$(t.fieldName)));if(!o||!o.length)return;e.forEach((t=>this._configureRelatedInfo(t,r)));const a=await function({relatedInfos:t,layer:e},i){const s={};return t.forEach(((t,n)=>{const{relation:r}=t;if(!r){const t=new dt("relation-required","A relation is required on a layer to retrieve related records.");throw qU.error(t),t}const{relatedTableId:o}=r;if("number"!=typeof o){const t=new dt("A related table ID is required on a layer to retrieve related records.");throw qU.error(t),t}const a=`${e.url}/${o}`,l=BU.get(a),u=l||function(t,e){return oi(t,{query:{f:"json"},signal:e&&e.signal})}(a,i);l||BU.set(a,u),s[n]=u})),Be(s)}({relatedInfos:s,layer:r},i);Object.keys(a).forEach((t=>{var e;const i=s.get(""+t),n=null==(e=a[t])?void 0:e.value;i&&n&&(i.layerInfo=n.data)}));const l=await function({graphic:t,relatedInfos:e,layer:i},s){const n={};return e.forEach(((e,r)=>{e.layerInfo&&(n[r]=async function(t,e,i,s){const n=""+i.layerId,{layerInfo:r,queryTask:o,relation:a,relatedFields:l,outStatistics:u}=e,c=function({originRelationship:t,relationships:e,layerId:i}){let s;return e&&e.some((e=>(""+e.relatedTableId===i&&e.id===t.id&&(s=e),!!s))),s}({originRelationship:a,relationships:r.relationships,layerId:n});if(c.relationshipTableId&&c.keyFieldInRelationshipTable){const e=(await function(t,e,i,s){const n=new AN;return n.outFields=["*"],n.relationshipId="number"==typeof e.id?e.id:parseInt(e.id,10),n.objectIds=[t.attributes[i.objectIdField]],i.queryRelatedFeatures(n,s)}(t,c,i,s))[t.attributes[i.objectIdField]];if(!e)return null;const n=e.features.map((t=>t.attributes[r.objectIdField]));if((null==u?void 0:u.length)>0&&r.supportsStatistics){const t=new YE;return t.where=function(t,e){let i=0;const s=[];for(;i<e.length;)s.push(`${t} IN (${e.slice(i,1e3+i)})`),i+=1e3;return s.join(" OR ")}(r.objectIdField,n),t.outFields=l,t.outStatistics=u,Be({features:Promise.resolve(e),statsFeatures:o.execute(t)})}}const h=null==c?void 0:c.keyField;if(h){const i=Vb(function(t,e){if(null!=t){e=e.toLowerCase();for(const i of t)if(i&&i.name.toLowerCase()===e)return i}return null}(r.fields,h)),n=function(t,e){const i=e.toLowerCase();for(const e in t)if(e.toLowerCase()===i)return t[e];return null}(t.attributes,a.keyField),l=i?`${h}=${n}`:`${h}='${n}'`,u=o.execute(new YE({where:l,outFields:e.relatedFields}),s),c=e.outStatistics&&e.outStatistics.length>0&&r.supportsStatistics?o.execute(new YE({where:l,outFields:e.relatedFields,outStatistics:e.outStatistics}),s):null,d={features:u};return c&&(d.statsFeatures=c),Be(d)}return null}(t,e,i,s))})),Be(n)}({graphic:t,relatedInfos:s,layer:r},i);Object.keys(l).forEach((t=>{var e;!function(t,e){if(!e)return;if(!t)return;const{features:i,statsFeatures:s}=t,n=i&&i.value;e.relatedFeatures=n?n.features:[];const r=s&&s.value;e.relatedStatsFeatures=r?r.features:[]}(null==(e=l[t])?void 0:e.value,s.get(""+t))}))}_configureRelatedInfo(t,e){const{relatedInfos:i}=this,s=WU(t.fieldName);if(!s)return;const{layerId:n,fieldName:r}=s;if(!n)return;const o=i.get(""+n)||function(t,e){const i=function(t,e){if(!e.relationships)return null;let i=null;const{relationships:s}=e;return s.some((e=>e.id===parseInt(t,10)&&(i=e,!0))),i}(t,e);if(!i)return;const s=`${e.url}/${i.relatedTableId}`;return{url:s,queryTask:new UU({url:s,sourceSpatialReference:e.spatialReference}),relation:i,relatedFields:[],outStatistics:[]}}(n,e);o&&(function({relatedInfo:t,fieldName:e,fieldInfo:i}){if(t.relatedFields.push(e),i.statisticType){const s=new HE({statisticType:i.statisticType,onStatisticField:e,outStatisticFieldName:e});t.outStatistics.push(s)}}({relatedInfo:o,fieldName:r,fieldInfo:t}),this.relatedInfos.set(n,o))}};dq.interceptor=new class{constructor(t,e){this.preLayerQueryCallback=t,this.preRequestCallback=e,this.preLayerQueryCallback||(this.preLayerQueryCallback=()=>{}),this.preRequestCallback||(this.preLayerQueryCallback=()=>{})}}((({query:t,layer:e,method:i})=>{Q$({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})}),(({queryPayload:t,layer:e,method:i})=>{Q$({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})})),e([Hn()],dq.prototype,"_error",void 0),e([Hn()],dq.prototype,"_featureAbortController",void 0),e([Hn({readOnly:!0})],dq.prototype,"_effectivePopupTemplate",null),e([Hn({readOnly:!0})],dq.prototype,"_fieldInfoMap",null),e([Hn({readOnly:!0})],dq.prototype,"_sourceLayer",null),e([Hn()],dq.prototype,"abilities",void 0),e([xa("abilities")],dq.prototype,"castAbilities",null),e([Hn({readOnly:!0})],dq.prototype,"content",void 0),e([Hn({readOnly:!0})],dq.prototype,"contentViewModels",void 0),e([Hn({type:Boolean})],dq.prototype,"defaultPopupTemplateEnabled",void 0),e([Hn({readOnly:!0})],dq.prototype,"state",null),e([Hn({readOnly:!0})],dq.prototype,"formattedAttributes",void 0),e([Hn({type:s_,value:null})],dq.prototype,"graphic",null),e([Hn({readOnly:!0})],dq.prototype,"lastEditInfo",void 0),e([Hn()],dq.prototype,"relatedInfos",void 0),e([Hn()],dq.prototype,"spatialReference",null),e([Hn({readOnly:!0})],dq.prototype,"title",void 0),e([Hn()],dq.prototype,"map",null),e([Hn({readOnly:!0})],dq.prototype,"waitingForContent",null),e([Hn()],dq.prototype,"view",void 0),dq=lq=e([_r(uq)],dq);const fq=dq,pq=t=>{let i=class extends t{constructor(){super(...arguments),this.renderNodeContent=t=>Nw(t)&&!t.destroyed?Fw("div",{key:t},t.render()):t instanceof HTMLElement?Fw("div",{key:t,bind:t,afterCreate:this._attachToNode}):Dw(t)?Fw("div",{key:t,bind:t.domNode,afterCreate:this._attachToNode}):null}_attachToNode(t){t.appendChild(this)}};return i=e([_r("esri.widgets.Feature.ContentMixin")],i),i},yq="esri-feature__content-element",mq={title:!0,content:!0,lastEditedInfo:!0};let gq=class extends(pq(Gc)){constructor(t,e){super(t,e),this._contentWidgets=[],this.graphic=null,this.defaultPopupTemplateEnabled=!1,this.headingLevel=2,this.label=void 0,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.spatialReference=null,this.title=null,this.visibleElements={...mq},this.map=null,this.view=null,this.viewModel=new fq}initialize(){this.own(Yr(this,"viewModel.contentViewModels",(()=>this._setupContentWidgets())))}loadDependencies(){return import("./p-314abe69.js")}destroy(){this._destroyContentWidgets()}castVisibleElements(t){return{...mq,...t}}render(){const{state:t}=this.viewModel,e=Fw("div",{class:"esri-feature__size-container",key:"container"},this.renderTitle(),"error"===t?this.renderError():"loading"===t?this.renderLoading():this.renderContentContainer());return Fw("div",{class:this.classes("esri-feature","esri-widget")},e)}setActiveMedia(t,e){this.viewModel.setActiveMedia(t,e)}nextMedia(t){this.viewModel.nextMedia(t)}previousMedia(t){this.viewModel.previousMedia(t)}renderError(){const{messagesCommon:t,messages:e,visibleElements:i}=this;return Fw("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},i.title?Fw("div",{key:"error-title",slot:"title"},t.errorMessage):null,Fw("div",{key:"error-message",slot:"message"},e.loadingError))}renderLoading(){return Fw("div",{key:"loading-container",class:"esri-feature__loading-container"},Fw("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")}))}renderContentContainer(){const{visibleElements:t}=this;return t.content?Fw("div",{class:"esri-feature__main-container"},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:t,title:e}=this;return t.title?Fw(Cw,{level:this.headingLevel,class:"esri-feature__title",innerHTML:e}):null}renderContent(){const t=this.viewModel.content,e="content";if(!t)return null;if(Array.isArray(t))return t.length?Fw("div",{key:e+"-content-elements"},t.map(this.renderContentElement,this)):null;if("string"==typeof t){const t=this._contentWidgets[0];return!t||t.destroyed?null:Fw("div",{key:e+"-content"},t.render())}return this.renderNodeContent(t)}renderContentElement(t,e){const{visibleElements:i}=this;if("boolean"!=typeof i.content&&!i.content[t.type])return null;switch(t.type){case"attachments":return this.renderAttachments(e);case"custom":return this.renderCustom(t,e);case"fields":return this.renderFields(e);case"media":return this.renderMedia(e);case"text":return this.renderText(t,e);default:return null}}renderAttachments(t){const e=this._contentWidgets[t];if(!e||e.destroyed)return null;const{state:i,attachmentInfos:s}=e.viewModel;return"loading"===i||s.length>0?Fw("div",{key:this._buildKey("attachments-element",t),class:this.classes(yq)},e.render()):null}renderCustom(t,e){const{creator:i}=t,s=this._contentWidgets[e];return!s||s.destroyed?null:i?Fw("div",{key:this._buildKey("custom-element",e),class:yq},s.render()):null}renderFields(t){const e=this._contentWidgets[t];return!e||e.destroyed?null:Fw("div",{key:this._buildKey("fields-element",t),class:yq},e.render())}renderMedia(t){const e=this._contentWidgets[t];return!e||e.destroyed?null:Fw("div",{key:this._buildKey("media-element",t),class:yq},e.render())}renderLastEditInfo(){const{visibleElements:t,messages:e}=this,{lastEditInfo:i}=this.viewModel;if(!i||!t.lastEditedInfo)return null;const{date:s,user:n}=i,r=Ko("edit"===i.type?n?e.lastEditedByUser:e.lastEdited:n?e.lastCreatedByUser:e.lastCreated,{date:s,user:n});return Fw("div",{key:"edit-info-element",class:this.classes("esri-feature__last-edited-info",yq)},r)}renderText(t,e){const i=this._contentWidgets[e];return!i||i.destroyed?null:t.text?Fw("div",{key:this._buildKey("text-element",e),class:this.classes(yq,"esri-feature__text")},i.render()):null}_buildKey(t,...e){return`${t}__${this.get("viewModel.graphic.uid")||"0"}-${e.join("-")}`}_destroyContentWidgets(){this._contentWidgets.forEach((t=>{t.viewModel=null,t&&!t.destroyed&&t.destroy()})),this._contentWidgets=[]}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:t,visibleElements:e}=this,i=this.get("viewModel.content"),{contentViewModels:s}=this.viewModel;if(Array.isArray(i))i.forEach(((i,n)=>{"attachments"===i.type&&(this._contentWidgets[n]=new cz({displayType:i.displayType,headingLevel:e.title?t+1:t,viewModel:s[n]})),"fields"===i.type&&(this._contentWidgets[n]=new wz({viewModel:s[n]})),"media"===i.type&&(this._contentWidgets[n]=new iq({viewModel:s[n]})),"text"===i.type&&(this._contentWidgets[n]=new pz({viewModel:s[n]})),"custom"===i.type&&(this._contentWidgets[n]=new pz({viewModel:s[n]}))}),this);else{const t=s[0];t&&!t.destroyed&&(this._contentWidgets[0]=new pz({viewModel:t}))}this.scheduleRender()}};e([go("viewModel.graphic")],gq.prototype,"graphic",void 0),e([go("viewModel.defaultPopupTemplateEnabled")],gq.prototype,"defaultPopupTemplateEnabled",void 0),e([Hn()],gq.prototype,"headingLevel",void 0),e([Hn({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],gq.prototype,"label",void 0),e([Hn(),Lw("esri/widgets/Feature/t9n/Feature")],gq.prototype,"messages",void 0),e([Hn(),Lw("esri/t9n/common")],gq.prototype,"messagesCommon",void 0),e([Hn(),Lw("esri/widgets/support/t9n/uriUtils")],gq.prototype,"messagesURIUtils",void 0),e([go("viewModel.spatialReference")],gq.prototype,"spatialReference",void 0),e([go("viewModel.title")],gq.prototype,"title",void 0),e([Hn()],gq.prototype,"visibleElements",void 0),e([xa("visibleElements")],gq.prototype,"castVisibleElements",null),e([go("viewModel.map")],gq.prototype,"map",void 0),e([go("viewModel.view")],gq.prototype,"view",void 0),e([Hn({type:fq})],gq.prototype,"viewModel",void 0),gq=e([_r("esri.widgets.Feature")],gq);const vq=gq;let wq=class extends Cr.EventedAccessor{constructor(t){super(t),this._anchorHandles=new Qr,this.location=null,this.screenLocation=null,this.screenLocationEnabled=!1,this.view=null,this._anchorHandles.add([Xr(this,["screenLocationEnabled","location","view.size","view.stationary"],(()=>this._updateScreenPointAndHandle())),Xr(this,["view","view.ready"],(()=>this._wireUpView()))])}destroy(){this.view=null,this._anchorHandles&&this._anchorHandles.destroy(),this._anchorHandles=null,this._viewpointHandle=null}_wireUpView(){const t="view";if(this._anchorHandles.remove(t),this._viewpointHandle=null,!this.get("view.ready"))return;this._setScreenLocation();const{view:e}=this,i=lo(e,"3d"===e.type?"camera":"viewpoint",(()=>this._viewpointChange()));this._anchorHandles.add(i,t),this._viewpointHandle=i,this._toggleWatchingViewpoint()}_viewpointChange(){this._setScreenLocation(),this.emit("view-change")}_updateScreenPointAndHandle(){this._setScreenLocation(),this._toggleWatchingViewpoint()}_toggleWatchingViewpoint(){const{_viewpointHandle:t,location:e,screenLocationEnabled:i}=this;t&&(e&&i?t.resume():t.pause())}_setScreenLocation(){const{location:t,view:e,screenLocationEnabled:i}=this,s=this.get("view.ready"),n=i&&s&&u(t)?e.toScreen(t):null;this._set("screenLocation",n)}};e([Hn()],wq.prototype,"location",void 0),e([Hn({readOnly:!0})],wq.prototype,"screenLocation",void 0),e([Hn()],wq.prototype,"screenLocationEnabled",void 0),e([Hn()],wq.prototype,"view",void 0),wq=e([_r("esri.widgets.support.AnchorElementViewModel")],wq);const bq=wq;let Mq=class extends bq{constructor(t){super(t),this.visible=!1}};e([Hn()],Mq.prototype,"visible",void 0),Mq=e([_r("esri.widgets.CompassViewModel")],Mq);const Sq=Mq;let xq=class extends Gc{constructor(t,e){super(t,e),this._animationDelay=500,this._animationPromise=null,this.location=null,this.view=null,this.viewModel=new Sq,this.visible=!1}initialize(){this.own([Xr(this,"visible",(t=>this._visibleChange(t)))])}destroy(){this._animationPromise=null}show(t){const{location:e,promise:i}=t;e&&(this.viewModel.location=e),this.visible=!0,i&&i.catch((()=>{})).then((()=>this.hide()))}hide(){this.visible=!1}render(){const{visible:t}=this,{screenLocation:e}=this.viewModel,i=!!e,s={"esri-spinner--start":t&&i,"esri-spinner--finish":!t&&i},n=this._getPositionStyles();return Fw("div",{class:this.classes("esri-spinner",s),styles:n})}_visibleChange(t){if(t)return void(this.viewModel.screenLocationEnabled=!0);const e=Ze(this._animationDelay);this._animationPromise=e,e.catch((()=>{})).then((()=>{this._animationPromise===e&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)}))}_getPositionStyles(){const{screenLocation:t,view:e}=this.viewModel;if(!e||c(t))return{};const{padding:i}=e;return{left:t.x-i.left+"px",top:t.y-i.top+"px"}}};e([go("viewModel.location")],xq.prototype,"location",void 0),e([go("viewModel.view")],xq.prototype,"view",void 0),e([Hn({type:Sq})],xq.prototype,"viewModel",void 0),e([go("viewModel.visible")],xq.prototype,"visible",void 0),xq=e([_r("esri.widgets.Spinner")],xq);const kq=xq;class Iq{constructor(t=(t=>t.values().next().value)){this._peeker=t,this._items=new Set}get length(){return this._items.size}clear(){this._items.clear()}last(){if(0===this._items.size)return;let t;for(t of this._items);return t}peek(){if(0!==this._items.size)return this._peeker(this._items)}push(t){this.contains(t)||this._items.add(t)}contains(t){return this._items.has(t)}pop(){if(0===this.length)return;const t=this.peek();return this._items.delete(t),t}popLast(){if(0===this.length)return;const t=this.last();return this._items.delete(t),t}remove(t){this._items.delete(t)}filter(t){return this._items.forEach((e=>{t(e)||this._items.delete(e)})),this}}const jq=l("mac")?"Meta":"Ctrl",_q={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let t=48;t<58;t++)_q[t]=String.fromCharCode(t);for(let t=1;t<25;t++)_q[111+t]="F"+t;for(let t=65;t<91;t++)_q[t]=[String.fromCharCode(t+32),String.fromCharCode(t)];function Tq(t){switch(t){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}class Oq{constructor(t,e=[]){this.eventType=t,this.keyModifiers=e}matches(t){if(t.type!==this.eventType)return!1;if(0===this.keyModifiers.length)return!0;const e=t.modifiers;for(const t of this.keyModifiers)if(!e.has(t))return!1;return!0}}const Aq=ct.getLogger("esri.views.input.InputHandler");class Fq{constructor(t){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=t}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const t in this._incoming){const e=this._incoming[t];for(const t of e)this._incomingEventMatches.push(t.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((t=>t.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(t){this._manager?Aq.error("This InputHandler has already been registered with an InputManager"):(t.setEventCallback((t=>this._handleEvent(t))),t.setUninstallCallback((()=>this._onUninstall())),this._manager=t)}onUninstall(){}registerIncoming(t,e,i){let s;"function"==typeof e?(i=e,s=[]):s=e||[];const n="string"==typeof t?new Oq(t,s):t,r=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},o=t=>{const e=this._incoming[t.match.eventType];if(e){const i=e.indexOf(t);e.splice(i,1),r(),this._manager&&this._manager.updateDependencies()}},a=new Cq(n,i,{onPause:o,onRemove:o,onResume:t=>{const e=this._incoming[t.match.eventType];e&&-1===e.indexOf(t)&&(e.push(t),r(),this._manager&&this._manager.updateDependencies())}});let l=this._incoming[n.eventType];return l||(l=[],this._incoming[n.eventType]=l),l.push(a),r(),this._manager&&this._manager.updateDependencies(),a}registerOutgoing(t){if(this._outgoing[t])throw Error("There is already a callback registered for this outgoing InputEvent: "+t);const e=new Pq(t,{onEmit:(t,e,i,s)=>{this._manager.emit(t.eventType,e,i,s)},onRemove:t=>{delete this._outgoing[t.eventType],this._manager.updateDependencies()}});return this._outgoing[t]=e,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),e}startCapturingPointer(t){this._manager.setPointerCapture(t,!0)}stopCapturingPointer(t){this._manager.setPointerCapture(t,!1)}refreshHasPendingInputs(){this._manager.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):Aq.error("This InputHandler is not registered with an InputManager")}_handleEvent(t){const e=this._incoming[t.type];if(e)for(const i of e)if(i.match.matches(t)&&(i.callback(t),t.shouldStopPropagation()))break}}class Cq{constructor(t,e,i){this.match=t,this._callback=e,this._handler=i}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}}class Pq{constructor(t,e){this.eventType=t,this._removed=!1,this._handler=e}emit(t,e,i){this._removed||this._handler.onEmit(this,t,e,i)}remove(){this._removed=!0,this._handler.onRemove(this)}}class Eq extends Fq{constructor(t){super(!0),this._onChange=t,this._value="mouse",this.registerIncoming("pointer-down",(t=>{this._setValue("touch"===t.data.native.pointerType?"touch":"mouse")})),this._moveHandler=this.registerIncoming("pointer-move",(t=>{this._setValue("touch"===t.data.native.pointerType?"touch":"mouse")})),this._moveHandler.pause()}_setValue(t){t!==this._value&&("touch"===t?this._moveHandler.resume():this._moveHandler.pause(),this._value=t,this._onChange(t))}}const Lq=ct.getLogger("esri.views.input.InputManager");let Rq=class extends Ar{constructor(t){super(t),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=jq,this.latestPointerType="mouse",this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const t=Object.keys(this._nameToGroup);for(const e of t)this.uninstallHandlers(e);this.eventSource=null,this._currentPropagation=null}get hasPendingInputs(){return this._handlers.some((t=>t.handler.hasPendingInputs))}installHandlers(t,e,i=Dq.INTERNAL){if(this._nameToGroup[t])return void Lq.error("There is already an InputHandler group registered under the name `"+t+"`");if(0===e.length)return void Lq.error("Can't register a group of zero handlers");const s={name:t,handlers:e.map((t=>({handler:t,active:!0,removed:!1,priorityIndex:0,groupPriority:i,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[t]=s;for(let t=s.handlers.length-1;t>=0;t--){const e=s.handlers[t];this._handlers.push(e),e.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(t,i,s,n,r)=>{this._emitInputEvent(e.priorityIndex+1,t,i,s,r,n)},setPointerCapture:(t,i)=>{this._setPointerCapture(s,e,t,i)},setEventCallback:t=>{e.eventCallback=t},setUninstallCallback:t=>{e.uninstallCallback=t},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(t){const e=this._nameToGroup[t];e?(e.handlers.forEach((t=>{t.removed=!0,t.uninstallCallback()})),delete this._nameToGroup[t],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):Lq.error("There is no InputHandler group registered under the name `"+t+"`")}hasHandlers(t){return void 0!==this._nameToGroup[t]}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const t=new Set,e=new Set;this._handlersPriority=[];for(let t=this._handlers.length-1;t>=0;t--){const e=this._handlers[t];e.priorityIndex=t,this._handlersPriority.push(e)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let i=this._handlersPriority.length-1;i>=0;i--){const s=this._handlersPriority[i];s.priorityIndex=i;let n=s.handler.hasSideEffects;if(!n)for(const e of s.handler.outgoingEventTypes)if(t.has(e)){n=!0;break}if(n)for(const i of s.handler.incomingEventMatches){t.add(i.eventType);for(const t of i.keyModifiers)Tq(t)||e.add(t)}s.active=n}this._sourceEvents=t,this._keyModifiers=e,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointerType(t){this._set("latestPointerType",t)}_onEventReceived(t,e){"pointer-capture-lost"===t&&this._pointerCaptures.delete(e.native.pointerId),this._updateKeyModifiers(t,e),this._emitInputEventFromSource(t,e,null!=this.test.timestamp?this.test.timestamp:e.native?e.native.timestamp:void 0,e.native?e.native.cancelable:void 0)}_updateKeyModifiers(t,e){if(!e)return;let i=!1;const s=()=>{if(!i){const t=new Set;this._activeKeyModifiers.forEach((e=>{t.add(e)})),this._activeKeyModifiers=t,i=!0}},n=(t,e)=>{e&&!this._activeKeyModifiers.has(t)?(s(),this._activeKeyModifiers.add(t)):!e&&this._activeKeyModifiers.has(t)&&(s(),this._activeKeyModifiers.delete(t))};if("key-down"===t||"key-up"===t){const i=e.key;this._keyModifiers.has(i)&&n(i,"key-down"===t)}const r=e.native;n("Alt",!(!r||!r.altKey)),n("Ctrl",!(!r||!r.ctrlKey)),n("Shift",!(!r||!r.shiftKey)),n("Meta",!(!r||!r.metaKey)),n("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerTypeHandler=new Eq((t=>this._setLatestPointerType(t))),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Dq.INTERNAL),this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler],Dq.INTERNAL)}_setPointerCapture(t,e,i,s){const n=t.name+"-"+e.priorityIndex,r=this._pointerCaptures.get(i.pointerId)||new Set;this._pointerCaptures.set(i.pointerId,r),s?(r.add(n),1===r.size&&this.eventSource&&this.eventSource.setPointerCapture(i,!0)):r.has(n)&&(r.delete(n),0===r.size&&(this._pointerCaptures.delete(i.pointerId),this.eventSource&&this.eventSource.setPointerCapture(i,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((t=>!t.removed)),this.updateDependencies()}_emitInputEventFromSource(t,e,i,s){this._emitInputEvent(0,t,e,i,s)}_emitInputEvent(t,e,i,s,n,r){const o=void 0!==s?s:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),a={event:new Nq(e,i,o,r||this._activeKeyModifiers,void 0!==n&&n),priorityIndex:t};this._currentPropagation?this._currentPropagation.events.push(a):this._doNewPropagation(a)}_doNewPropagation(t){this._currentPropagation={events:new Iq,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:t.event.timestamp},this._currentPropagation.events.push(t),this._continuePropagation()}_continuePropagation(){const t=this._currentPropagation;if(t){for(;this._currentPropagation.events.length>0;){const{event:e,priorityIndex:i}=this._currentPropagation.events.pop(),s=e.data&&e.data.eventId;if(null==s||!this._stoppedPropagationEventIds.has(s))for(t.currentHandler=this._handlersPriority[i];t.currentHandler;){if(t.currentHandler.removed)t.needsHandlerGarbageCollect=!0;else{if(t.currentHandler.active&&!e.shouldStopPropagation()&&t.currentHandler.eventCallback(e),e.shouldStopPropagation()){null!=s&&this._stoppedPropagationEventIds.add(s);break}if(e.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:e,priorityIndex:t.currentHandler.priorityIndex+1})}t.currentHandler=this._handlersPriority[t.currentHandler.priorityIndex+1]}}t.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(t){const e=new Iq;for(e.push(t);this._currentPropagation.events.length;)e.push(this._currentPropagation.events.pop());this._currentPropagation.events=e,this._currentPropagation.currentHandler=null}_compareHandlerPriority(t,e){if(t.handler.hasSideEffects!==e.handler.hasSideEffects)return t.handler.hasSideEffects?1:-1;if(t.groupPriority!==e.groupPriority)return t.groupPriority>e.groupPriority?-1:1;for(const i of t.handler.incomingEventMatches)for(const t of e.handler.incomingEventMatches){if(i.eventType!==t.eventType)continue;const e=i.keyModifiers.filter((e=>-1!==t.keyModifiers.indexOf(e)));if(e.length===i.keyModifiers.length!=(e.length===t.keyModifiers.length))return i.keyModifiers.length>t.keyModifiers.length?-1:1}return t.priorityIndex>e.priorityIndex?-1:1}_sortHandlersPriority(t){const e=[];for(const i of t){let t=0;for(;t<e.length&&this._compareHandlerPriority(i,e[t])>=0;)t++;e.splice(t,0,i)}return e}get debug(){const t=t=>{const e=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=e};return{injectEvent:(e,i)=>{t((()=>{this._onEventReceived(e,i)}))},disablePointerCapture:t}}};e([Hn({readOnly:!0})],Rq.prototype,"hasPendingInputs",null),e([Hn()],Rq.prototype,"eventSource",void 0),e([Hn()],Rq.prototype,"recognizers",void 0),e([Hn({readOnly:!0})],Rq.prototype,"latestPointerType",void 0),Rq=e([_r("esri.views.input.InputManager")],Rq);class Nq{constructor(t,e,i,s,n){this.type=t,this.data=e,this.timestamp=i,this.modifiers=s,this.cancelable=n,this._propagationState=0,this._resumeCallback=null}stopPropagation(){this._propagationState|=1}shouldStopPropagation(){return 0!=(1&this._propagationState)}async(t){this._propagationState|=2;const e=(t,e)=>{this._propagationState&=-3;const i=this._resumeCallback;if(this._resumeCallback=null,i&&i(),e)throw t;return t};return("function"==typeof t?t():t).then((t=>e(t,!1)),(t=>e(t,!0)))}shouldPausePropagation(t){return!!(2&this._propagationState)&&(this._resumeCallback=t,!0)}preventDefault(){this.data.native.preventDefault()}}const Dq={DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3},Vq=new SS({id:"zoom-to-feature",title:"{messages.zoom}",className:"esri-icon-zoom-in-magnifying-glass"}),$q=new SS({id:"remove-selected-feature",title:"{messages.remove}",className:"esri-icon-trash"}),zq=new SS({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:"esri-icon-zoom-in-magnifying-glass"}),Gq=new SS({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:"esri-icon-table"}),Uq=ct.getLogger("esri.widgets.Popup.PopupViewModel");function qq(t){const{selectedFeature:e,location:i,view:s}=t;return s?"3d"===s.type?e||i:t.get("selectedFeature.geometry")||i:null}const Bq=Jr.ofType({key:"type",defaultKeyValue:"button",base:wS,typeMap:{button:SS,toggle:IS}}),Wq="esri.widgets.Popup.PopupViewModel",Hq=ct.getLogger(Wq);let Jq=class extends(SV(bq)){constructor(t){super(t),this._handles=new Qr,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new Bq,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new s_({symbol:new Pj({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null}get isLoadingFeature(){return this.featureViewModels.some((t=>t.waitingForContent))}initialize(){this._handles.add([Yr(this,["autoOpenEnabled","view"],(()=>this._autoOpenEnabledChange())),this.on("view-change",(()=>this._autoClose())),Xr(this,["highlightEnabled","selectedFeature","visible","view"],(()=>this._highlightFeature())),Xr(this,"view.animation.state",(t=>this._animationStateChange(t))),Xr(this,"location",(t=>this._locationChange(t))),Xr(this,"selectedFeature",(t=>this._selectedFeatureChange(t))),Xr(this,["selectedFeatureIndex","featureCount","featuresPerPage"],(()=>this._selectedFeatureIndexChange())),Xr(this,["featurePage","selectedFeatureIndex","featureCount","featuresPerPage, featureViewModels"],(()=>this._setGraphicOnFeatureViewModels())),Xr(this,"featureViewModels",(()=>this._featureViewModelsChange())),this.on("trigger-action",(t=>function(t){const{event:e,view:i}=t,{action:s}=e,n=i&&i.popup;if(!s)return Promise.reject(new dt("trigger-action:missing-arguments","Event has no action"));if(!n)return Promise.reject(new dt("trigger-action:missing-arguments","view.popup is missing"));const{disabled:r,id:o}=s;if(!o)return Promise.reject(new dt("trigger-action:invalid-action","action.id is missing"));if(r)return Promise.reject(new dt("trigger-action:invalid-action","Action is disabled"));if(o===Vq.id)return async function(t){const{location:e,selectedFeature:i,view:s,zoomFactor:n}=t,r=qq(t);if(!r){const t=new dt("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:r,view:s});return Uq.error(t),Promise.reject(t)}const o=s.scale/n,a=t.get("selectedFeature.geometry")||e,l=a&&"point"===a.type&&function(t,e){if("3d"!==(null==e?void 0:e.type)||!t||"esri.Graphic"!==t.declaredClass)return!0;const i=e.getViewForGraphic(t);if(i&&"whenGraphicBounds"in i){let e=!1;return i.whenGraphicBounds(t,{useViewElevation:!0}).then((t=>{e=!t||!t.boundingBox||t.boundingBox[0]===t.boundingBox[3]&&t.boundingBox[1]===t.boundingBox[4]&&t.boundingBox[2]===t.boundingBox[5]})).catch((()=>{const e=new dt("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});Uq.error(e)})),e}return!0}(i,s);Vq.active=!0,Vq.disabled=!0,await t.view.goTo({target:r,scale:l?o:void 0}),Vq.active=!1,Vq.disabled=!1,t.zoomToLocation=null,l&&(t.location=a)}(n.viewModel);if(o===zq.id)return async function(t){const{selectedFeature:e,view:i}=t;if("2d"!==(null==i?void 0:i.type)){const t=new dt("zoomToCluster:invalid-view","View must be 2d MapView.",{view:i});throw Uq.error(t),t}if(!e.isAggregate){const t=new dt("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw Uq.error(t),t}const s=e.sourceLayer,n=await i.whenLayerView(s),r=n.createQuery();r.aggregateIds=[e.getObjectId()],zq.active=!0,zq.disabled=!0;const{extent:o}=await n.queryExtent(r);await i.goTo({target:o}),zq.active=!1,zq.disabled=!1}(n.viewModel);if(o===Gq.id)return n.featureMenuOpen=!n.featureMenuOpen,n.viewModel.browseClusterEnabled=!n.viewModel.browseClusterEnabled,Promise.resolve();if(n.viewModel.browseClusterEnabled=!1,o===$q.id){n.close();const{selectedFeature:t}=n;if(!t)return Promise.reject(new dt("trigger-action:"+$q.id,"selectedFeature is required",{selectedFeature:t}));const{sourceLayer:e}=t;return e?e.remove(t):i.graphics.remove(t),Promise.resolve()}return Promise.resolve()}({event:t,view:this.view}))),oo(this,"waitingForResult",(()=>this._waitingForResultChange()),!0),Xr(this,["features","view","view.map","view.spatialReference"],(()=>this._updateFeatureVMs())),Xr(this,["view.scale"],this._viewScaleChange),oo(this,"visible",(()=>this.browseClusterEnabled=!1)),Xr(this,"browseClusterEnabled",(t=>t?this.enableClusterBrowsing():this.disableClusterBrowsing()))])}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const t=this._get("allActions")||new Bq;t.removeAll();const{actions:e,defaultActions:i,defaultPopupTemplateEnabled:s,includeDefaultActions:n,selectedFeature:r}=this,o=n?i.concat(e):e,a=r&&("function"==typeof r.getEffectivePopupTemplate&&r.getEffectivePopupTemplate(s)||r.popupTemplate),l=a&&a.actions,u=a&&a.overwriteActions?l:l?l.concat(o):o;return u&&u.filter(Boolean).forEach((e=>t.add(e))),t}get defaultActions(){var t;const e=this._get("defaultActions")||new Bq;return e.removeAll(),e.addMany(null!=(t=this.selectedFeature)&&t.isAggregate?[zq.clone(),Gq.clone()]:[Vq.clone()]),e}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(t){const e=t||[];this._set("features",e);const{pendingPromisesCount:i,promiseCount:s,selectedFeatureIndex:n}=this,r=s&&e.length;r&&i&&-1===n?this.selectedFeatureIndex=0:r&&-1!==n||(this.selectedFeatureIndex=e.length?0:-1)}get location(){return this._get("location")||null}set location(t){const e=this.get("view.spatialReference.isWebMercator");t&&t.get("spatialReference.isWGS84")&&e&&(t=td(t)),this._set("location",t)}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(t){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(t)||!t.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",t),(t=t.slice(0)).forEach((t=>{this._pendingPromises.add(t),t.then((e=>{this._pendingPromises.has(t)&&this._updateFeatures(e),this._updatePendingPromises(t)}),(()=>this._updatePendingPromises(t)))})),this.notifyChange("pendingPromisesCount")}get selectedFeature(){const{features:t,selectedFeatureIndex:e}=this;return-1===e?null:t[e]||null}get selectedFeatureIndex(){const t=this._get("selectedFeatureIndex");return"number"==typeof t?t:-1}set selectedFeatureIndex(t){const{featureCount:e}=this;this._set("selectedFeatureIndex",t=isNaN(t)||t<-1||!e?-1:(t+e)%e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:t}=this,e=qq(this);if(!e){const i=new dt("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:e,view:t});return Hq.error(i),Promise.reject(i)}return this.callGoTo({target:{target:e,scale:t.scale}})}clear(){this.set({promises:[],features:[],content:null,title:null,location:null})}fetchFeatures(t,e){const{view:i}=this;if(!i||!t){const e=new dt("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:t,view:i});return Hq.error(e),Promise.reject(e)}return i.fetchPopupFeatures(t,{event:e&&e.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:e&&e.signal})}open(t){const e={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...t,visible:!0},{fetchFeatures:i}=e;delete e.fetchFeatures,i&&this._setFetchFeaturesPromises(e.location),this.set(e)}triggerAction(t){const e=this.allActions.getItemAt(t);e&&!e.disabled&&this.emit("trigger-action",{action:e})}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){(function(t){t.features=t.features.filter((t=>t.isAggregate))})(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){await async function(t){const{selectedFeature:e,view:i}=t;if("2d"!==(null==i?void 0:i.type)){const t=new dt("displayClusterExtent:invalid-view","View must be 2d MapView.",{view:i});throw Uq.error(t),t}if(!e.isAggregate){const t=new dt("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw Uq.error(t),t}const s=e.sourceLayer,n=await i.whenLayerView(s),r=n.createQuery();r.aggregateIds=[e.getObjectId()];const{extent:o}=await n.queryExtent(r);t.selectedClusterBoundaryFeature.geometry=o,i.graphics.add(t.selectedClusterBoundaryFeature)}(this),await async function(t){const{selectedFeature:e,view:i}=t;if("2d"!==(null==i?void 0:i.type)){const t=new dt("browseAggregateFeatures:invalid-view","View must be 2d MapView.",{view:i});throw Uq.error(t),t}if(!e.isAggregate){const t=new dt("browseAggregateFeatures:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw Uq.error(t),t}const s=e.sourceLayer,n=await i.whenLayerView(s),r=n.createQuery();r.aggregateIds=[e.getObjectId()],Gq.active=!0,Gq.disabled=!0;const{features:o}=await n.queryFeatures(r);Gq.active=!1,Gq.disabled=!1,i.popup.open({features:[e].concat(o),featureMenuOpen:!0})}(this)}_animationStateChange(t){this.zoomToLocation||(Vq.disabled="waiting-for-target"===t)}_clearBrowsedClusterGraphics(){var t;const e=null==(t=this.view)?void 0:t.graphics;e&&(e.remove(this.selectedClusterBoundaryFeature),e.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){var t;(null!=(t=this.selectedFeature)&&t.isAggregate||this.browseClusterEnabled)&&(this.browseClusterEnabled=!1,this.visible=!1)}_locationChange(t){const{selectedFeature:e,updateLocationEnabled:i}=this;i&&t&&(!e||e.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null}_setGraphicOnFeatureViewModels(){const{features:t,featureCount:e,featurePage:i,featuresPerPage:s,featureViewModels:n}=this;if(null===i)return;const r=((i-1)*s+e)%e;n.slice(r,r+s).forEach(((e,i)=>{e&&!e.graphic&&(e.graphic=t[r+i])}))}async _selectedFeatureChange(t){if(!t)return;const{location:e,updateLocationEnabled:i,view:s}=this;if(this.browseClusterEnabled){if(this._selectedClusterFeature&&(s.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),t.isAggregate)return;return t.symbol=await nV(t),this._selectedClusterFeature=t,void s.graphics.add(this._selectedClusterFeature)}!i&&e||!t.geometry?i&&!t.geometry&&this.centerAtLocation().then((()=>{this.location=s.center.clone()})):this.location=this._getPointFromGeometry(t.geometry)}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}_setFetchFeaturesPromises(t){return this._fetchFeaturesWithController(this._getScreenPoint(t||this.location)).then((t=>{const{clientOnlyGraphics:e,promisesPerLayerView:i}=t,s=Promise.resolve(e),n=i.map((t=>t.promise));this.promises=[s,...n]}))}_destroyFeatureVMs(){this.featureViewModels.forEach((t=>t&&!t.destroyed&&t.destroy())),this._set("featureViewModels",[])}_updateFeatureVMs(){const{selectedFeature:t,features:e,featureViewModels:i}=this;if(null!=t&&t.isAggregate||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!e||!e.length)return;const s=i.slice(0),n=[];e.forEach(((e,i)=>{if(!e)return;let r=null;if(s.some(((t,i)=>(t&&t.graphic===e&&(r=t,s.splice(i,1)),!!r))),r)n[i]=r;else{var o,a;const s=new fq({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:null==(o=this.view)?void 0:o.spatialReference,graphic:e===t?e:null,map:null==(a=this.view)?void 0:a.map,view:this.view});n[i]=s}})),s.forEach((t=>t&&!t.destroyed&&t.destroy())),this._set("featureViewModels",n)}_getScreenPoint(t){const{view:e}=this;return e&&t&&"function"==typeof e.toScreen?e.toScreen(t):null}_autoOpenEnabledChange(){const t="auto-fetch-features",{_handles:e,autoOpenEnabled:i}=this;if(e.remove(t),i&&this.view){const i=this.view.on("click",(t=>{"mouse"===t.pointerType&&0!==t.button||this._fetchFeaturesAndOpen(t)}),Dq.WIDGET);e.add(i,t)}}_cancelFetchingFeatures(){const t=this._fetchFeaturesController;t&&t.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}_fetchFeaturesWithController(t,e){this._cancelFetchingFeatures();const i=new AbortController,{signal:s}=i;this._fetchFeaturesController=i,this.notifyChange("waitingForResult");const n=this.fetchFeatures(t,{signal:s,event:e});return n.catch((()=>{})).then((()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult")})),n}_fetchFeaturesAndOpen(t){const{screenPoint:e,mapPoint:i}=t,{view:s}=this;this._fetchFeaturesWithController(e,t).then((t=>{const{clientOnlyGraphics:e,promisesPerLayerView:n,location:r}=t,o=[Promise.resolve(e),...n.map((t=>t.promise))];return s.popup.open({location:r||i,promises:o}),t}))}_updatePendingPromises(t){t&&this._pendingPromises.has(t)&&(this._pendingPromises.delete(t),this.notifyChange("pendingPromisesCount"))}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}_getPointFromGeometry(t){return c(t)?null:"point"===t.type?t:"extent"===t.type?t.center:"polygon"===t.type?t.centroid:"multipoint"===t.type||"polyline"===t.type?t.extent.center:null}async _getLayerView(t,e){return await t.when(),t.whenLayerView(e)}async _highlightFeature(){const t="highlight";this._handles.remove(t);const{selectedFeature:e,highlightEnabled:i,view:s,visible:n}=this;if(!(e&&s&&i&&n))return;let{layer:r,sourceLayer:o}=e;if("map-notes"!==(null==o?void 0:o.type)&&"subtype-group"!==(null==o?void 0:o.type)||(r=o),!(r&&r instanceof sC))return;const a=this._getLayerView(s,r);this._highlightPromise=a;const l=await a;if(!(l&&n_(l)&&this._highlightPromise===a&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const u="objectIdField"in r&&r.objectIdField,c=e.attributes,h=l.highlight(c&&u&&c[u]||e);this._handles.add(h,t)}_updateFeatures(t){const{features:e}=this;if(!t||!t.length)return;if(!e.length)return void(this.features=t);const i=t.filter((t=>-1===e.indexOf(t)));this.features=e.concat(i)}};e([Hn()],Jq.prototype,"featurePage",void 0),e([Hn()],Jq.prototype,"isLoadingFeature",null),e([Hn({type:Bq})],Jq.prototype,"actions",void 0),e([Hn({readOnly:!0})],Jq.prototype,"active",null),e([Hn({readOnly:!0})],Jq.prototype,"allActions",null),e([Hn({type:Boolean})],Jq.prototype,"defaultPopupTemplateEnabled",void 0),e([Hn()],Jq.prototype,"autoCloseEnabled",void 0),e([Hn()],Jq.prototype,"autoOpenEnabled",void 0),e([Hn()],Jq.prototype,"browseClusterEnabled",void 0),e([Hn()],Jq.prototype,"content",void 0),e([Hn({type:Bq,readOnly:!0})],Jq.prototype,"defaultActions",null),e([Hn({readOnly:!0})],Jq.prototype,"featureCount",null),e([Hn()],Jq.prototype,"features",null),e([Hn()],Jq.prototype,"featuresPerPage",void 0),e([Hn()],Jq.prototype,"featureViewModelAbilities",void 0),e([Hn({readOnly:!0})],Jq.prototype,"featureViewModels",void 0),e([Hn()],Jq.prototype,"highlightEnabled",void 0),e([Hn()],Jq.prototype,"includeDefaultActions",void 0),e([Hn({type:ad})],Jq.prototype,"location",null),e([Hn({readOnly:!0})],Jq.prototype,"pendingPromisesCount",null),e([Hn({readOnly:!0})],Jq.prototype,"selectedClusterBoundaryFeature",void 0),e([Hn({readOnly:!0})],Jq.prototype,"waitingForResult",null),e([Hn({readOnly:!0})],Jq.prototype,"promiseCount",null),e([Hn()],Jq.prototype,"promises",null),e([Hn({value:null,readOnly:!0})],Jq.prototype,"selectedFeature",null),e([Hn({value:-1})],Jq.prototype,"selectedFeatureIndex",null),e([Hn({readOnly:!0})],Jq.prototype,"selectedFeatureViewModel",null),e([Hn({readOnly:!0})],Jq.prototype,"state",null),e([Hn()],Jq.prototype,"title",void 0),e([Hn()],Jq.prototype,"updateLocationEnabled",void 0),e([Hn()],Jq.prototype,"view",void 0),e([Hn()],Jq.prototype,"visible",void 0),e([Hn()],Jq.prototype,"zoomFactor",void 0),e([Hn()],Jq.prototype,"zoomToLocation",void 0),e([Hn()],Jq.prototype,"centerAtLocation",null),Jq=e([_r(Wq)],Jq);const Zq=Jq,Qq="selected-index",Kq="popup-spinner",Yq="esri-popup__button",Xq="esri-popup__icon",tB={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},eB="esri-popup";function iB(t,e){return void 0===e?`${eB}__${t}`:`${eB}__${t}-${e}`}const sB="esri.widgets.Popup",nB=ct.getLogger(sB),rB={closeButton:!0,featureNavigation:!0};let oB=class extends(pq(Gc)){constructor(t,e){super(t,e),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new Qr,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([t])=>{null!=t&&t.isIntersecting&&this.viewModel.featurePage++},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback),this._displaySpinnerThrottled=d$((()=>this._displaySpinner()),0),this.actions=null,this.alignment="auto",this.autoCloseEnabled=null,this.autoOpenEnabled=null,this.defaultPopupTemplateEnabled=null,this.content=null,this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureCount=null,this.featureMenuOpen=!1,this.features=null,this.goToOverride=null,this.headingLevel=2,this.highlightEnabled=null,this.location=null,this.label=void 0,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.promises=null,this.selectedFeature=null,this.selectedFeatureIndex=null,this.spinnerEnabled=!0,this.title=null,this.updateLocationEnabled=null,this.view=null,this.viewModel=new Zq,this.visible=null,this.visibleElements={...rB},this._addSelectedFeatureIndexHandle(),this.own([Xr(this,"viewModel.screenLocation",(()=>this._positionContainer())),Xr(this,["viewModel.active","dockEnabled"],(()=>this._toggleScreenLocationEnabled())),Xr(this,"viewModel.screenLocation",((t,e)=>{!!t!=!!e&&this.reposition()})),Xr(this,["viewModel.view.padding","viewModel.view.size","viewModel.active","viewModel.location","alignment"],(()=>this.reposition())),Xr(this,"spinnerEnabled",(t=>this._spinnerEnabledChange(t))),Xr(this,"viewModel.view.size",((t,e)=>this._updateDockEnabledForViewSize(t,e))),Xr(this,"viewModel.view",((t,e)=>this._viewChange(t,e))),Xr(this,"viewModel.view.ready",((t,e)=>this._viewReadyChange(t,e))),Xr(this,["viewModel.waitingForResult","viewModel.location"],(()=>{this._hideSpinner(),this._displaySpinnerThrottled()})),Xr(this,["selectedFeatureWidget.viewModel.title","selectedFeatureWidget.viewModel.state"],(()=>this._setTitleFromFeatureWidget())),Xr(this,["selectedFeatureWidget.viewModel.content","selectedFeatureWidget.viewModel.state"],(()=>this._setContentFromFeatureWidget())),oo(this,"collapsed",(()=>{var t,e;"xsmall"===(null==(t=this.viewModel)||null==(e=t.view)?void 0:e.widthBreakpoint)&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation()})),uo(this,"viewModel.allActions","change",(()=>this._watchActions())),Yr(this,"viewModel.allActions",(()=>this._watchActions())),Xr(this,"viewModel.featureViewModels",(()=>this._featureMenuViewportScrollTop()))])}destroy(){var t,e;this._destroySelectedFeatureWidget(),this._destroySpinner(),null==(t=this._handles)||t.destroy(),this._unobserveFeatureMenuObserver(),null==(e=this._featureMenuIntersectionObserver)||e.disconnect(),this._handles=null}get actionsMenuId(){return this.id+"-actions-menu"}get actionsMenuButtonId(){return this.id+"-actions-menu-button"}get featureMenuId(){return this.id+"-feature-menu"}get titleId(){return this.id+"-popup-title"}get contentId(){return this.id+"-popup-content"}get hasContent(){var t,e,i,s,n,r,o;return!!(this.selectedFeatureWidget?(null==(t=this.selectedFeatureWidget)||null==(e=t.viewModel)?void 0:e.waitingForContent)||"error"===(null==(i=this.selectedFeatureWidget)||null==(s=i.viewModel)?void 0:s.state)||(null==(n=this.selectedFeatureWidget)||null==(r=n.viewModel)?void 0:r.content):null==(o=this.viewModel)?void 0:o.content)}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}set actionsMenuOpen(t){this._set("actionsMenuOpen",!!t)}get actionsMenuOpen(){return!!this.viewModel.active&&this._get("actionsMenuOpen")}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||tB}set dockOptions(t){const e={...tB},i=this.get("viewModel.view.breakpoints"),s={};i&&(s.width=i.xsmall,s.height=i.xsmall);const n={...e,...t},r={...e.breakpoint,...s},{breakpoint:o}=n;!0===o?n.breakpoint=r:"object"==typeof o&&(n.breakpoint={...r,...o}),this._set("dockOptions",n),this._setCurrentDockPosition(),this.reposition()}get selectedFeatureWidget(){const{_feature:t,visibleElements:e,headingLevel:i}=this,{selectedFeatureViewModel:s}=this.viewModel,n={...e,title:!1};return s?(t?(t.viewModel=s,t.visibleElements=n):this._feature=new vq({headingLevel:i+1,viewModel:s,visibleElements:n}),this._feature):null}castVisibleElements(t){return{...rB,...t}}blur(){const{active:t}=this.viewModel;t||nB.warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}clear(){this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(t,e){return this.viewModel.fetchFeatures(t,e)}focus(){const{active:t}=this.viewModel;t||nB.warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}next(){return this.viewModel.next()}open(t){var e,i;this._handles.remove(Qq);const s={collapsed:!!t&&!!t.collapsed,actionsMenuOpen:!!t&&!!t.actionsMenuOpen,featureMenuOpen:!!t&&!!t.featureMenuOpen};"xsmall"===(null==(e=this.viewModel)||null==(i=e.view)?void 0:i.widthBreakpoint)&&(s.collapsed=!0),this.set(s),this.viewModel.open(t),this._addSelectedFeatureIndexHandle()}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(t){this.viewModel.triggerAction(t)}render(){var t,e,i,s;const{actionsMenuOpen:n,dockEnabled:r,featureMenuVisible:o,dividedActions:a,currentAlignment:l,currentDockPosition:u}=this,{active:c}=this.viewModel,{menuActions:h}=a,d=null==(t=this.selectedFeature)||null==(e=t.layer)?void 0:e.title,f=null==(i=this.selectedFeature)||null==(s=i.layer)?void 0:s.id;return Fw("div",{class:this.classes("esri-popup",{"esri-popup--aligned-top-center":"top-center"===l,"esri-popup--aligned-bottom-center":"bottom-center"===l,"esri-popup--aligned-top-left":"top-left"===l,"esri-popup--aligned-bottom-left":"bottom-left"===l,"esri-popup--aligned-top-right":"top-right"===l,"esri-popup--aligned-bottom-right":"bottom-right"===l,"esri-popup--is-docked":c&&r,"esri-popup--shadow":c&&!r,"esri-popup--is-docked-top-left":"top-left"===u,"esri-popup--is-docked-top-center":"top-center"===u,"esri-popup--is-docked-top-right":"top-right"===u,"esri-popup--is-docked-bottom-left":"bottom-left"===u,"esri-popup--is-docked-bottom-center":"bottom-center"===u,"esri-popup--is-docked-bottom-right":"bottom-right"===u,"esri-popup--feature-menu-open":o,"esri-popup--actions-menu-open":c&&h.length>1&&n}),role:"presentation","data-layer-title":d,"data-layer-id":f,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},c?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return Fw("span",{"aria-hidden":"true",class:this.classes(Xq,"esri-icon-loading-indicator","esri-rotating")})}renderNavigationLoading(){const{messagesCommon:t}=this;return this.viewModel.pendingPromisesCount?Fw("div",{key:iB("loading-container"),role:"presentation",class:"esri-popup__loading-container","aria-label":t.loading,title:t.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const t=Pl(this.container);return Fw("span",{"aria-hidden":"true",class:this.classes(Xq,{"esri-icon-right-triangle-arrow":t,"esri-popup__pagination-previous-icon--rtl":t,"esri-icon-left-triangle-arrow":!t,"esri-popup__pagination-previous-icon":!t})})}renderPreviousButton(){const{messages:t}=this;return Fw("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(Yq,"esri-popup__pagination-previous"),"aria-label":t.previous,title:t.previous},this.renderPreviousIcon())}renderNextIcon(){const t=Pl(this.container);return Fw("span",{"aria-hidden":"true",class:this.classes(Xq,{"esri-icon-left-triangle-arrow":t,"esri-popup__pagination-next-icon--rtl":t,"esri-icon-right-triangle-arrow":!t,"esri-popup__pagination-next-icon":!t})})}renderNextButton(){const{messages:t}=this;return Fw("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(Yq,"esri-popup__pagination-next"),"aria-label":t.next,title:t.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:t,featureMenuId:e,messagesCommon:i}=this,{featureCount:s,selectedFeatureIndex:n}=this.viewModel;return Fw("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(Yq,"esri-popup__feature-menu-button"),"aria-haspopup":"true","aria-controls":e,"aria-expanded":""+t,"aria-label":i.menu,title:i.menu},this._getPageText(s,n))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:t}=this,e=this._wouldDockTo();return Fw("span",{"aria-hidden":"true",class:this.classes({"esri-icon-minimize":t,"esri-popup__icon--dock-icon":!t,"esri-icon-dock-right":!t&&("top-right"===e||"bottom-right"===e),"esri-icon-dock-left":!t&&("top-left"===e||"bottom-left"===e),"esri-icon-maximize":!t&&"top-center"===e,"esri-icon-dock-bottom":!t&&"bottom-center"===e},Xq)})}renderDockButton(){var t,e,i;const{dockEnabled:s,messages:n}=this,r=null==(t=this.viewModel)||null==(e=t.view)?void 0:e.widthBreakpoint,o=s?n.undock:n.dock;return"xsmall"!==r&&null!=(i=this.dockOptions)&&i.buttonEnabled?Fw("div",{role:"button","aria-label":o,title:o,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(Yq,"esri-popup__button--dock")},this.renderDockIcon()):null}renderTitle(){const{title:t}=this.viewModel,{titleId:e,collapsible:i,contentCollapsed:s,messagesCommon:n}=this,r={"esri-popup__header-container--button":i},o=Fw(Cw,{level:this.headingLevel,class:"esri-popup__header-title",innerHTML:t}),a=i?Fw("button",{key:t+"--collapsible",id:e,title:s?n.expand:n.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes("esri-popup__header-container",r),"aria-expanded":s?"false":"true",onclick:this._toggleCollapsed},o):Fw("div",{key:t,id:e,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes("esri-popup__header-container",r)},o);return t?a:null}renderCloseIcon(){return Fw("span",{"aria-hidden":"true",class:this.classes(Xq,"esri-icon-close")})}renderCloseButton(){const{visibleElements:t,messagesCommon:e}=this;return t.closeButton?Fw("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:Yq,"aria-label":e.close,title:e.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return Fw("header",{class:"esri-popup__header"},this.renderTitle(),Fw("div",{class:"esri-popup__header-buttons"},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:t,hasContent:e,contentCollapsed:i}=this,{content:s}=this.viewModel;return e&&!i?Fw("article",{key:s,enterAnimation:this._createFeatureUpdatedAnimation(),id:t,class:"esri-popup__content"},this.renderContent()):null}renderActionsMenuButton(){const{actionsMenuId:t,actionsMenuButtonId:e,actionsMenuOpen:i,dividedActions:s,messagesCommon:n}=this,r=i?n.close:n.open,{menuActions:o}=s;return o.length?Fw("div",{key:iB("actions-menu-button"),class:this.classes(Yq,"esri-popup__actions-menu-button"),role:"button",id:e,"aria-haspopup":"true","aria-controls":i?t:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":r,title:r},Fw("span",{"aria-hidden":"true",class:"esri-icon-handle-horizontal"})):null}renderMenuActions(){const{actionsMenuId:t,actionsMenuButtonId:e,actionsMenuOpen:i,dividedActions:s}=this,{menuActions:n,inlineActions:r}=s;return n.length&&i?Fw("ul",{id:t,role:"menu","aria-labelledby":e,key:iB("actions"),class:"esri-popup__actions",bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},n.toArray().map(((t,e)=>this.renderAction({action:t,index:e+r.length,type:"menu-item"})))):null}renderInlineActions(){const{inlineActions:t}=this.dividedActions;return!!t.length&&t.toArray().map(((t,e)=>this.renderAction({action:t,index:e,type:"inline"})))}renderInlineActionsContainer(){const{inlineActions:t,menuActions:e}=this.dividedActions,i=!!t.length,s=!!e.length;return i||s?Fw("div",{key:"inline-actions-container","data-inline-actions":""+i,"data-menu-actions":""+s,class:"esri-popup__inline-actions-container"},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?Fw("section",{key:iB("navigation"),class:this.classes("esri-popup__navigation")},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:t,dividedActions:e}=this,{inlineActions:i,menuActions:s}=e,n=!!i.length,r={"esri-popup__footer--has-pagination":t,"esri-popup__footer--has-actions":n,"esri-popup__footer--has-actions-menu":!!s.length};return t||n?Fw("div",{key:iB("feature-buttons"),class:this.classes("esri-popup__footer",r)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:t}=this,{featureViewModels:e,isLoadingFeature:i}=this.viewModel,s=Ko(t.selectedFeatures,{total:e.length});return Fw("section",{key:iB("menu"),class:"esri-popup__feature-menu"},Fw("strong",{class:"esri-popup__feature-menu-header"},s),Fw("nav",{bind:this,class:"esri-popup__feature-menu-viewport","data-node-ref":"_featureMenuViewportNode",afterCreate:Rl},this.renderFeatureMenu(),Fw("div",{class:"esri-popup__feature-menu-observer",bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),i?Fw("div",{class:"esri-popup__feature-menu-loader"},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:Fw("div",{key:iB("pointer"),class:"esri-popup__pointer",role:"presentation"},Fw("div",{class:this.classes("esri-popup__pointer-direction","esri-popup--shadow")}))}renderMainContainer(){const{dockEnabled:t,currentAlignment:e,currentDockPosition:i,titleId:s,contentId:n,collapsible:r,hasContent:o,contentCollapsed:a,visibleElements:l}=this,{title:u}=this.viewModel,c="bottom-left"===e||"bottom-center"===e||"bottom-right"===e||"top-left"===i||"top-center"===i||"top-right"===i,h="top-left"===e||"top-center"===e||"top-right"===e||"bottom-left"===i||"bottom-center"===i||"bottom-right"===i;return Fw("div",{class:this.classes("esri-popup__main-container","esri-widget",{"esri-popup--shadow":t,"esri-popup--is-collapsible":r,"esri-popup--is-collapsed":a}),tabIndex:l.closeButton?null:-1,role:"dialog","aria-labelledby":u?s:"","aria-describedby":o&&!a?n:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},c?this.renderFooter():null,c?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),h?this.renderFooter():null,h?this.renderFeatureMenuContainer():null)}renderContent(){var t;const e=null==(t=this.viewModel)?void 0:t.content;return e?"string"==typeof e?Fw("div",{key:e,innerHTML:e}):this.renderNodeContent(e):null}renderActionText(t){return Fw("span",{key:"text",class:"esri-popup__action-text"},t)}renderActionIcon(t){const e=this._getActionClass(t),i=this._getActionImage(t),s={"esri-icon-loading-indicator":t.active,"esri-rotating":t.active,[Xq]:!!e,"esri-popup__action-image":!t.active&&!!i};return e&&(s[e]=!t.active),Fw("span",{key:"icon","aria-hidden":"true",class:this.classes(Xq,s),styles:this._getIconStyles(i)})}renderAction(t){const{action:e,index:i,type:s}=t,n=this._getActionTitle(e),r={"esri-popup__action":"toggle"!==e.type,"esri-popup__action-toggle":"toggle"===e.type,"esri-popup__action-toggle--on":"toggle"===e.type&&e.value,"esri-popup__button--disabled":e.disabled},o=[this.renderActionIcon(e),this.renderActionText(n)],a="menu-item"===s?Fw("li",{key:e.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(Yq,r),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},o):Fw("div",{key:e.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(Yq,r),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},o);return e.visible?a:null}renderFeatureMenuItem(t,e){const{messages:i,messagesCommon:s}=this,{selectedFeatureIndex:n,selectedFeatureViewModel:r}=this.viewModel,o=t===r,a={"esri-popup__feature-menu-item--selected":o},l=o?Fw("span",{key:iB("feature-menu-selected-feature-"+n),title:i.selectedFeature,"aria-label":i.selectedFeature,class:"esri-icon-check-mark"}):null,u=Fw("span",{innerHTML:t.title||s.untitled});return Fw("li",{role:"menuitem",tabIndex:-1,key:iB("feature-menu-feature-"+n),class:this.classes(a,"esri-popup__feature-menu-item"),bind:this,"data-feature-index":e,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature},Fw("span",{class:"esri-popup__feature-menu-title"},u,l))}renderFeatureMenu(){const{featureMenuId:t}=this,{featureViewModels:e}=this.viewModel;return e.length>1?Fw("ol",{class:"esri-popup__feature-menu-list",id:t,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},e.filter((t=>!!t.graphic)).map(((t,e)=>this.renderFeatureMenuItem(t,e)))):null}_getActionTitle(t){const{messages:e,selectedFeature:i,messagesCommon:s}=this,{id:n}=t,r=null==i?void 0:i.attributes,o="zoom-to-feature"===n?Ko(t.title,{messages:e}):"remove-selected-feature"===n?Ko(t.title,{messages:s}):"zoom-to-clustered-features"===n||"browse-clustered-features"===n?Ko(t.title,{messages:e}):t.title;return o&&r?Ko(o,r):o}_getActionClass(t){const{selectedFeature:e}=this,i=null==e?void 0:e.attributes,{className:s,image:n}=t,r=n||s?s:"esri-icon-default-action";return r&&i?Ko(r,i):r}_getActionImage(t){const{selectedFeature:e}=this,i=null==e?void 0:e.attributes,{image:s}=t;return s&&i?Ko(s,i):s}_createFeatureUpdatedAnimation(){return Nl("enter","esri-popup--feature-updated")}_getInlineActionCount(){const{maxInlineActions:t,featureNavigationVisible:e}=this;if("number"!=typeof t)return null;const i=Math.round(t);return Math.max(e?i-1:i,0)}_watchActions(){const{allActions:t}=this.viewModel;this.notifyChange("dividedActions");const e="actions";this._handles.remove(e),t&&t.forEach((t=>{this._handles.add(Xr(t,["active","className","disabled","id","title","image","visible"],(()=>this.scheduleRender())),e)}))}_divideActions(){const{allActions:t}=this.viewModel,e=this._getInlineActionCount(),i=null===e,s=0===e;return{inlineActions:i?t.slice(0):s?new Jr:t.slice(0,e),menuActions:i?new Jr:t.slice(s?0:e)}}_featureMenuOpenChanged(t){t?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}_actionsMenuOpenChanged(t){t?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}_setTitleFromFeatureWidget(){const{selectedFeatureWidget:t,messagesCommon:e}=this;var i,s;t&&(this.viewModel.title="error"===(null==(i=t.viewModel)?void 0:i.state)?e.errorMessage:(null==(s=t.viewModel)?void 0:s.title)||"")}_setContentFromFeatureWidget(){const{selectedFeatureWidget:t}=this;t&&(this.viewModel.content=t)}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(t){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(t),this._featureMenuIntersectionObserverNode=t}_handleFeatureMenuKeyup(t){"Escape"===Ae(t)&&(t.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}_handleActionMenuKeyup(t){"Escape"===Ae(t)&&(t.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}_handleFeatureMenuItemKeyup(t){const e=Ae(t),{_featureMenuNode:i}=this,s=t.currentTarget["data-feature-index"];if(!i)return;const n=i.querySelectorAll("li"),r=n.length;"ArrowUp"!==e?"ArrowDown"!==e?"Home"!==e?"End"!==e||(t.stopPropagation(),n[n.length-1].focus()):(t.stopPropagation(),n[0].focus()):(t.stopPropagation(),n[(s+1+r)%r].focus()):(t.stopPropagation(),n[(s-1+r)%r].focus())}_handleActionMenuItemKeyup(t){const e=Ae(t),{_actionsMenuNode:i}=this,s=t.currentTarget["data-action-index"];if(!i)return;const n=i.querySelectorAll("li"),r=n.length;"ArrowUp"!==e?"ArrowDown"!==e?"Home"!==e?"End"!==e||(t.stopPropagation(),n[n.length-1].focus()):(t.stopPropagation(),n[0].focus()):(t.stopPropagation(),n[(s+1+r)%r].focus()):(t.stopPropagation(),n[(s-1+r)%r].focus())}_handleMainKeyup(t){const e=Ae(t);"ArrowLeft"===e&&(t.stopPropagation(),this.previous()),"ArrowRight"===e&&(t.stopPropagation(),this.next())}_spinnerEnabledChange(t){if(this._destroySpinner(),!t)return;const e=this.get("viewModel.view");this._createSpinner(e)}_hideSpinner(){const{_spinner:t}=this;t&&(t.location=null,t.hide())}_displaySpinner(){const{_spinner:t}=this;if(!t)return;const{location:e,waitingForResult:i}=this.viewModel;i?t.show({location:e}):t.hide()}_getIconStyles(t){return{"background-image":t?`url(${t})`:""}}_addSelectedFeatureIndexHandle(){const t=Xr(this,"viewModel.selectedFeatureIndex",((t,e)=>this._selectedFeatureIndexUpdated(t,e)));this._handles.add(t,Qq)}_selectedFeatureIndexUpdated(t,e){const{featureCount:i}=this;i&&t!==e&&-1!==t&&(this.actionsMenuOpen=!1,this.featureMenuOpen=!1)}_destroySelectedFeatureWidget(){const{_feature:t}=this;t&&(t.viewModel=null,t&&!t.destroyed&&t.destroy()),this._feature=null}_isScreenLocationWithinView(t,e){return t.x>-1&&t.y>-1&&t.x<=e.width&&t.y<=e.height}_isOutsideView(t){const{popupHeight:e,popupWidth:i,screenLocation:s,side:n,view:r}=t;if(isNaN(i)||isNaN(e)||!r||!s)return!1;const o=r.padding;return"right"===n&&s.x+i/2>r.width-o.right||"left"===n&&s.x-i/2<o.left||"top"===n&&s.y-e<o.top||"bottom"===n&&s.y+e>r.height-o.bottom}_calculateAutoAlignment(t){if("auto"!==t)return t;const{_pointerOffsetInPx:e,_containerNode:i,_mainContainerNode:s,viewModel:n}=this,{screenLocation:r,view:o}=n;if(c(r)||!o||!i)return"top-center";if(!this._isScreenLocationWithinView(r,o))return this._get("currentAlignment")||"top-center";function a(t){return parseInt(t.replace(/[^-\d\.]/g,""),10)}const l=s?window.getComputedStyle(s,null):null,u=l?a(l.getPropertyValue("max-height")):0,h=l?a(l.getPropertyValue("height")):0,{height:d,width:f}=i.getBoundingClientRect(),p=f+e,y=Math.max(d,u,h)+e,m=this._isOutsideView({popupHeight:y,popupWidth:p,screenLocation:r,side:"right",view:o}),g=this._isOutsideView({popupHeight:y,popupWidth:p,screenLocation:r,side:"left",view:o}),v=this._isOutsideView({popupHeight:y,popupWidth:p,screenLocation:r,side:"top",view:o}),w=this._isOutsideView({popupHeight:y,popupWidth:p,screenLocation:r,side:"bottom",view:o});return g?v?"bottom-right":"top-right":m?v?"bottom-left":"top-left":v?w?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(t){return"function"==typeof t?t.call(this):t}_getCurrentAlignment(){const{alignment:t,dockEnabled:e}=this;return e||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(t)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(t){const e=["left","right"];return Pl(this.container)&&e.reverse(),t.replace(/leading/gi,e[0]).replace(/trailing/gi,e[1])}_callDockPosition(t){return"function"==typeof t?t.call(this):t}_getDockPosition(){var t;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null==(t=this.dockOptions)?void 0:t.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(t){var e;if("auto"!==t)return t;const i=null==(e=this.viewModel)?void 0:e.view,s=Pl(this.container)?"top-left":"top-right";if(!i)return s;const n=i.padding||{left:0,right:0,top:0,bottom:0},r=i.width-n.left-n.right,{breakpoints:o}=i;return o&&r<=o.xsmall?"bottom-center":s}_positionContainer(t=this._containerNode){if(t&&(this._containerNode=t),!t)return;const{screenLocation:e}=this.viewModel,{width:i}=t.getBoundingClientRect(),s=this._calculatePositionStyle(e,i);s&&(t.style.top=s.top,t.style.left=s.left,t.style.bottom=s.bottom,t.style.right=s.right)}_calculateFullWidth(t){const{currentAlignment:e,_pointerOffsetInPx:i}=this;return"top-left"===e||"bottom-left"===e||"top-right"===e||"bottom-right"===e?t+i:t}_calculateAlignmentPosition(t,e,i,s){const{currentAlignment:n,_pointerOffsetInPx:r}=this,o=s/2,a=i.height-e,l=i.width-t,{padding:u}=this.view;return"bottom-center"===n?{top:e+r-u.top,left:t-o-u.left}:"top-left"===n?{bottom:a+r-u.bottom,right:l+r-u.right}:"bottom-left"===n?{top:e+r-u.top,right:l+r-u.right}:"top-right"===n?{bottom:a+r-u.bottom,left:t+r-u.left}:"bottom-right"===n?{top:e+r-u.top,left:t+r-u.left}:"top-center"===n?{bottom:a+r-u.bottom,left:t-o-u.left}:void 0}_calculatePositionStyle(t,e){const{dockEnabled:i,view:s}=this;if(!s)return;if(i)return{left:"",top:"",right:"",bottom:""};if(c(t)||!e)return;const n=this._calculateFullWidth(e),r=this._calculateAlignmentPosition(t.x,t.y,s,n);return r?{top:void 0!==r.top?r.top+"px":"auto",left:void 0!==r.left?r.left+"px":"auto",bottom:void 0!==r.bottom?r.bottom+"px":"auto",right:void 0!==r.right?r.right+"px":"auto"}:void 0}_viewChange(t,e){t&&e&&(this.close(),this.clear())}_viewReadyChange(t,e){if(t){const t=this.get("viewModel.view");this._wireUpView(t)}else e&&(this.close(),this.clear())}_wireUpView(t){if(this._destroySpinner(),!t)return;const{spinnerEnabled:e}=this;e&&this._createSpinner(t),this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(t,e,i){const[s,n]=t,[r,o]=e,{width:a,height:l}=i;return s<=a&&r>a||s>a&&r<=a||n<=l&&o>l||n>l&&o<=l}_updateDockEnabledForViewSize(t,e){if(!t||!e)return;const i=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},s=i.left+i.right,n=i.top+i.bottom,r=[],o=[];r[0]=t[0]-s,r[1]=t[1]-n,o[0]=e[0]-s,o[1]=e[1]-n;const{dockOptions:a}=this;this._dockingThresholdCrossed(r,o,a.breakpoint)&&this._setDockEnabledForViewSize(a),this._setCurrentDockPosition()}_focusDockButtonNode(t){this._focusDockButton&&(this._focusDockButton=!1,t.focus())}_closeButtonNodeUpdated(t){return this._focusClose?(this._focusClose=!1,void t.focus()):this._blurClose?(this._blurClose=!1,void t.blur()):void 0}_mainContainerNodeUpdated(t){return this._mainContainerNode=t,this._focusContainer?(this._focusContainer=!1,void t.focus()):this._blurContainer?(this._blurContainer=!1,void t.blur()):void 0}_featureMenuNodeUpdated(t){if(this._featureMenuNode=t,!t||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const e=t.querySelectorAll("li");e.length&&e[0].focus()}_actionsMenuNodeUpdated(t){if(this._actionsMenuNode=t,!t||!this._focusFirstAction)return;this._focusFirstAction=!1;const e=t.querySelectorAll("li");e.length&&e[0].focus()}_focusFeatureMenuButtonNode(t){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,t.focus())}_focusActionsMenuButtonNode(t){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,t.focus())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}_toggleScreenLocationEnabled(){const{dockEnabled:t,viewModel:e}=this;e&&(e.screenLocationEnabled=e.active&&!t)}_shouldDockAtCurrentViewSize(t){var e,i;const s=t.breakpoint,n=null==(e=this.viewModel)||null==(i=e.view)?void 0:i.ui;if(!n)return!1;const{width:r,height:o}=n;if(isNaN(r)||isNaN(o))return!1;const a=s.hasOwnProperty("width")&&r<=s.width,l=s.hasOwnProperty("height")&&o<=s.height;return a||l}_setDockEnabledForViewSize(t){t.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(t))}_getPageText(t,e){return this.featureNavigationVisible?Ko(this.messages.pageText,{index:e+1,total:t}):null}_destroySpinner(){const{_spinner:t,view:e}=this;t&&(e&&e.ui&&e.ui.remove(this._spinner,Kq),t.destroy(),this._spinner=null)}_createSpinner(t){t&&(this._spinner=new kq({view:t}),t.ui.add(this._spinner,{key:Kq,position:"manual"}))}_toggleCollapsed(){this.collapsed=!this.collapsed}_close(){this.close(),this.view&&this.view.focus()}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}_toggleFeatureMenu(){const t=!this.featureMenuOpen;this._featureMenuOpenChanged(t),this.actionsMenuOpen=!1,this.featureMenuOpen=t}_toggleActionsMenu(){const t=!this.actionsMenuOpen;this._actionsMenuOpenChanged(t),this.featureMenuOpen=!1,this.actionsMenuOpen=t}_triggerAction(t){const e=t.currentTarget["data-action-index"],i=this.viewModel.allActions.getItemAt(e);i&&"toggle"===i.type&&(i.value=!i.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(e)}_selectFeature(t){const e=t.currentTarget["data-feature-index"];isNaN(e)||(this.viewModel.selectedFeatureIndex=e),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}_next(){this.next()}_previous(){this.previous()}};e([Hn({readOnly:!0})],oB.prototype,"actionsMenuId",null),e([Hn({readOnly:!0})],oB.prototype,"actionsMenuButtonId",null),e([Hn({readOnly:!0})],oB.prototype,"featureMenuId",null),e([Hn({readOnly:!0})],oB.prototype,"titleId",null),e([Hn({readOnly:!0})],oB.prototype,"contentId",null),e([Hn({readOnly:!0})],oB.prototype,"hasContent",null),e([Hn({readOnly:!0})],oB.prototype,"featureNavigationVisible",null),e([Hn({readOnly:!0})],oB.prototype,"collapsible",null),e([Hn({readOnly:!0})],oB.prototype,"featureMenuVisible",null),e([Hn({readOnly:!0})],oB.prototype,"contentCollapsed",null),e([Hn({readOnly:!0})],oB.prototype,"dividedActions",null),e([go("viewModel.actions")],oB.prototype,"actions",void 0),e([Hn()],oB.prototype,"actionsMenuOpen",null),e([Hn()],oB.prototype,"alignment",void 0),e([go("viewModel.autoCloseEnabled")],oB.prototype,"autoCloseEnabled",void 0),e([go("viewModel.autoOpenEnabled")],oB.prototype,"autoOpenEnabled",void 0),e([go("viewModel.defaultPopupTemplateEnabled")],oB.prototype,"defaultPopupTemplateEnabled",void 0),e([go("viewModel.content")],oB.prototype,"content",void 0),e([Hn()],oB.prototype,"collapsed",void 0),e([Hn()],oB.prototype,"collapseEnabled",void 0),e([Hn({readOnly:!0})],oB.prototype,"currentAlignment",null),e([Hn({readOnly:!0})],oB.prototype,"currentDockPosition",null),e([Hn()],oB.prototype,"dockOptions",null),e([Hn()],oB.prototype,"dockEnabled",void 0),e([go("viewModel.featureCount")],oB.prototype,"featureCount",void 0),e([Hn()],oB.prototype,"featureMenuOpen",void 0),e([go("viewModel.features")],oB.prototype,"features",void 0),e([go("viewModel.goToOverride")],oB.prototype,"goToOverride",void 0),e([Hn()],oB.prototype,"headingLevel",void 0),e([go("viewModel.highlightEnabled")],oB.prototype,"highlightEnabled",void 0),e([go("viewModel.location")],oB.prototype,"location",void 0),e([Hn({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],oB.prototype,"label",void 0),e([Hn()],oB.prototype,"maxInlineActions",void 0),e([Hn(),Lw("esri/widgets/Popup/t9n/Popup")],oB.prototype,"messages",void 0),e([Hn(),Lw("esri/t9n/common")],oB.prototype,"messagesCommon",void 0),e([go("viewModel.promises")],oB.prototype,"promises",void 0),e([go("viewModel.selectedFeature")],oB.prototype,"selectedFeature",void 0),e([go("viewModel.selectedFeatureIndex")],oB.prototype,"selectedFeatureIndex",void 0),e([Hn({readOnly:!0})],oB.prototype,"selectedFeatureWidget",null),e([Hn()],oB.prototype,"spinnerEnabled",void 0),e([go("viewModel.title")],oB.prototype,"title",void 0),e([go("viewModel.updateLocationEnabled")],oB.prototype,"updateLocationEnabled",void 0),e([go("viewModel.view")],oB.prototype,"view",void 0),e([Hn({type:Zq}),Rw(["triggerAction","trigger-action"])],oB.prototype,"viewModel",void 0),e([go("viewModel.visible")],oB.prototype,"visible",void 0),e([Hn()],oB.prototype,"visibleElements",void 0),e([xa("visibleElements")],oB.prototype,"castVisibleElements",null),e([Pw()],oB.prototype,"_close",null),e([Pw()],oB.prototype,"_toggleDockEnabled",null),e([Pw()],oB.prototype,"_toggleFeatureMenu",null),e([Pw()],oB.prototype,"_toggleActionsMenu",null),e([Pw()],oB.prototype,"_triggerAction",null),e([Pw()],oB.prototype,"_selectFeature",null),e([Pw()],oB.prototype,"_next",null),e([Pw()],oB.prototype,"_previous",null),oB=e([_r(sB)],oB);const aB=oB,lB=[0,0];function uB(t){t&&(ha(t),t.parentNode&&t.parentNode.removeChild(t))}const cB=t=>{let i=class extends t{constructor(...t){super(...t),this._freqInfo={freq:16,time:750},this._overlayRenderTaskHandle=null,this.height=0,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.handles.add([this.watch("cursor",(t=>{const e=this.surface;e&&e.setAttribute("data-cursor",t)})),this.watch("interacting",(t=>{const e=this.surface;e&&e.setAttribute("data-interacting",""+t)}))])}initialize(){this.handles.add(this.watch("ui",((t,e)=>this._handleUIChange(t,e)))),this._wireUI(this.ui),this.handles.add([this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))])}destroy(){this.destroyed||(this.ui&&(this.ui.destroy(),this.ui=null),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}set container(t){const e=this._get("container");if(e===t)return;const i="dom-size";if(this.handles.remove(i),this._stopMeasuring(),e&&(e.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),uB(this.root),this._set("root",null),fa(this.userContent,e),uB(this.userContent),this._set("userContent",null)),t){t.classList.add("esri-view");const e=document.createElement("div");e.className="esri-view-user-storage",fa(t,e),t.appendChild(e),this._set("userContent",e);const s=document.createElement("div");s.className="esri-view-root",t.insertBefore(s,t.firstChild),this._set("root",s);const n=document.createElement("div");n.className="esri-view-surface",n.setAttribute("role","application"),n.tabIndex=0,s.appendChild(n),this._set("surface",n);const r=new h$;s.appendChild(r.surface),this._set("overlay",r),r.watch("needsRender",(t=>{t&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=Us({render:()=>{this.overlay.render()}}):this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null)})),this.forceDOMReadyCycle(),this.handles.add(Yr(this,"size",(t=>{const[e,i]=t,s="esri-view-surface--inset-outline";e>=document.body.clientWidth||i>=document.body.clientHeight?n.classList.add(s):n.classList.remove(s)})),i),this._set("container",t),this._startMeasuring()}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null)}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}get popup(){return this._get("popup")||new aB({view:this})}set popup(t){const e=this._get("popup");e&&e!==t&&e.destroy(),this._set("popup",t)}get size(){return[this.width,this.height]}blur(){this.surface&&this.surface.blur()}focus(){this.surface&&this.surface.focus()}pageToContainer(t,e,i){const s=this.position;return t-=s[0],e-=s[1],i?(i[0]=t,i[1]=e):i=[t,e],i}containerToPage(t,e,i){const s=this.position;return t+=s[0],e+=s[1],i?(i[0]=t,i[1]=e):i=[t,e],i}_handleUIChange(t,e){e&&(this.handles.remove("ui"),e.destroy()),t&&this._wireUI(t),this._set("ui",t)}_wireUI(t){this.handles.remove("ui"),t&&(t.view=this,this.handles.add([Yr(this,"root",(e=>{t.container=e?function(t){const e=document.createElement("div");return t.appendChild(e),e}(e):null})),Yr(this,"popup",((e,i)=>{const s="popup";i&&t.remove(i,s),e&&(e.view=t.view,t.add(e,{key:s,position:"manual"}))}))],"ui"))}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=16,t.time=750,this.handles.add([(()=>{const e=()=>{t.freq=16,t.time=750};return window.addEventListener("resize",e),{remove(){window.removeEventListener("resize",e)}}})(),Us({prepare:t=>{const e=this._measure(),i=this._freqInfo;if(i.time+=t.deltaTime,e&&(i.freq=16,this._get("resizing")||this._set("resizing",!0)),i.time<i.freq)return;i.time=0;const s=this._position();i.freq=s||e?16:Math.min(750,2*i.freq),!e&&i.freq>=512&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,e=t?t.clientWidth:0,i=t?t.clientHeight:0;if(0===e||0===i)return this.suspended||this._set("suspended",!0),!1;const s=this.width,n=this.height;return e===s&&i===n?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",e),this._set("height",i),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:s,oldHeight:n,width:e,height:i}),!0)}_position(){const t=this.position,e=function(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return lB[0]=i.left+e.pageXOffset,lB[1]=i.top+e.pageYOffset,lB}(this.container);return!(t&&e[0]===t[0]&&e[1]===t[1]||(this._set("position",[e[0],e[1]]),0))}forceDOMReadyCycle(){}};return e([Hn({value:null,cast:t=>ca(t)})],i.prototype,"container",null),e([Hn({readOnly:!0})],i.prototype,"focused",null),e([Hn({readOnly:!0})],i.prototype,"height",void 0),e([Hn({type:aB})],i.prototype,"popup",null),e([Hn({type:h$})],i.prototype,"overlay",void 0),e([Hn({readOnly:!0})],i.prototype,"position",void 0),e([Hn({readOnly:!0})],i.prototype,"resizing",void 0),e([Hn({readOnly:!0})],i.prototype,"root",void 0),e([Hn({value:null,readOnly:!0})],i.prototype,"size",null),e([Hn({readOnly:!0})],i.prototype,"surface",void 0),e([Hn({readOnly:!0})],i.prototype,"suspended",void 0),e([Hn()],i.prototype,"ui",void 0),e([Hn({readOnly:!0})],i.prototype,"userContent",void 0),e([Hn({readOnly:!0})],i.prototype,"width",void 0),e([Hn()],i.prototype,"widthBreakpoint",void 0),i=e([_r("esri.views.DOMContainer")],i),i},hB=t=>{let i=class extends t{async fetchPopupFeatures(t,e){await this.when();const{location:i,queryArea:s,layerViewsAndGraphics:n,clientOnlyGraphics:r}=await this._prepareFetchPopupFeatures(t,e),o=Promise.resolve(r),a=this._queryLayerPopupFeatures(s,n,e);return{location:i,clientOnlyGraphics:r,allGraphicsPromise:We([o,...a.map((t=>t.promise))]).then(P),promisesPerLayerView:a}}_queryLayerPopupFeatures(t,e,i){return e.map((({layerView:e,graphics:s})=>{const n={clientGraphics:s,event:u(i)?i.event:null,signal:u(i)?i.signal:null,defaultPopupTemplateEnabled:!!u(i)&&!!i.defaultPopupTemplateEnabled},r=e.fetchPopupFeatures(t,n);return{layerView:e,promise:r}}))}_isValidPopupGraphic(t,e){return t&&!!t.getEffectivePopupTemplate(u(e)&&e.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(t,e){const{clientGraphics:i,queryArea:s,location:n}=await this._popupHitTestGraphics(t,e),r=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:o,clientOnlyGraphics:a}=this._graphicsPerFetchPopupLayerView(i,r);return{clientOnlyGraphics:a,layerViewsAndGraphics:o,queryArea:s,location:n}}async _popupHitTestGraphics(t,e){const{results:i,mapPoint:s}=await this.popupHitTest(t),n=i.filter((t=>this._isValidPopupGraphic(t.graphic,e))),r=n.length?n[0].mapPoint:null;return{clientGraphics:n.map((t=>t.graphic)),queryArea:s,location:s||r}}_getFetchPopupLayerViews(){const t=[];return this.allLayerViews.forEach((e=>{this._isValidPopupLayerView(e)&&t.push(e)})),u(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&t.push(this.graphicsView),t.reverse()}_isValidPopupLayerView(t){return u(t)&&(!("layer"in t)||!t.suspended)&&"fetchPopupFeatures"in t}_graphicsPerFetchPopupLayerView(t,e){const i=[],s=new Map,n=e.map((t=>{const e=[];return s.set("layer"in t?t.layer:t.graphics,e),{layerView:t,graphics:e}}));for(const e of t){const t=s.get(e.layer)||s.get(e.sourceLayer)||null;t?t.push(e):i.push(e)}return{layerViewsAndGraphics:n,clientOnlyGraphics:i}}};return i=e([_r("esri.views.PopupView")],i),i};ct.getLogger("esri.core.support.OwningCollection");let dB=class extends(zw(Jr)){constructor(t){super(t),this.handles.add([this.on("before-add",(t=>{c(t.item)&&t.preventDefault()})),this.on("after-add",(t=>this._own(t.item))),this.on("after-remove",(t=>this._release(t.item)))])}get owner(){return this._get("owner")}set owner(t){t!==this._get("owner")&&(this._releaseAll(),this._set("owner",t),this._ownAll())}_ownAll(){for(const t of this.items)this._own(t)}_releaseAll(){for(const t of this.items)this._release(t)}_createNewInstance(t){return this.itemType?new(Jr.ofType(this.itemType.Type))(t):new Jr(t)}};function fB(t,e){return{type:t,cast:Hc,set(i){const s=Wc(i,this._get(e),t);s.owner=this,this._set(e,s)}}}e([Hn()],dB.prototype,"owner",null),dB=e([_r("esri.core.support.OwningCollection")],dB);let pB=class extends dB{_own(t){t.layer&&"remove"in t.layer&&t.layer!==this.owner&&t.layer.remove(t),t.layer=this.owner}_release(t){t.layer===this.owner&&(t.layer=null)}};e([Pr({Type:s_,ensureType:Ln(s_)})],pB.prototype,"itemType",void 0),pB=e([_r("esri.support.GraphicsCollection")],pB);let yB=class extends Ar{constructor(t){super(t),this.view=null,this.baseLayerViews=new Jr,this.referenceLayerViews=new Jr,this._loadingHandle=Yr(this,"view.map.basemap",(t=>{t&&t.load().catch((()=>{}))}))}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null)}get suspended(){return!this.view||this.view.suspended}get updating(){return!(this.view&&this.view.suspended||!(this.view&&this.view.map&&this.view.map.basemap)||this.view.map.basemap.loaded)}};e([Hn({constructOnly:!0})],yB.prototype,"view",void 0),e([Hn({readOnly:!0})],yB.prototype,"baseLayerViews",void 0),e([Hn({readOnly:!0})],yB.prototype,"referenceLayerViews",void 0),e([Hn({readOnly:!0})],yB.prototype,"suspended",null),e([Hn({type:Boolean,readOnly:!0})],yB.prototype,"updating",null),yB=e([_r("esri.views.BasemapView")],yB);const mB=ct.getLogger("esri.views.LayerViewManager");class gB{constructor(t,e,i){this.layer=t,this.view=e,this.layerViewImporter=i,this._controller=new AbortController,this._deferred=qe(),this._started=!1,this.done=!1,Ve(this._controller.signal,(()=>{const e=new dt("cancelled:layerview-create","layerview creation cancelled",{layer:t});this._deferred.reject(e)}))}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:t}=this;if(!t)return;const{layer:e,view:i}=this;e.emit("layerview-destroy",{view:i,layerView:t}),i.emit("layerview-destroy",{layer:e,layerView:t}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null}async start(){if(this._started)return;this._started=!0;const{_controller:{signal:t},layer:e,view:i}=this;this._map=i.map;try{var s,n;let r,o;if(await e.load({signal:t}),"prefetchResources"in e&&await e.prefetchResources({signal:t}),e.createLayerView)r=await e.createLayerView(i,{signal:t});else{if(!this.layerViewImporter.hasLayerViewModule(e))throw new dt("layer:view-not-supported","No layerview implementation was found");const s=await this.layerViewImporter.importLayerView(e);Ee(t),r="default"in s?new s.default({layer:e,view:i}):new s({layer:e,view:i})}const a=()=>{o=v(o),r.destroyed||r.destroy(),r.layer=null,r.parent=null,r.view=null,this.done=!0};o=Ve(t,a),Ee(t);try{await r.when()}catch(t){throw a(),t}if(!(null==(s=this._map)||null==(n=s.allLayers)?void 0:n.includes(e)))return a(),void this._deferred.reject(new dt("view:no-layerview-for-layer","The layer has been removed from the map",{layer:e}));this.layerView=r,e.emit("layerview-create",{view:i,layerView:r}),i.emit("layerview-create",{layer:e,layerView:r}),this.done=!0,this._deferred.resolve(r)}catch(t){e.emit("layerview-create-error",{view:i,error:t}),i.emit("layerview-create-error",{layer:e,error:t}),this.done=!0,this._deferred.reject(new dt("layerview:create-error","layerview creation failed",{layer:e,error:t}))}}}let vB=class extends Gw{constructor(t){super(t),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new Vw,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var t;const e=null==(t=this.view.map)?void 0:t.allLayers;if(e)for(const t of e)this.layerViewImporter.hasLayerViewModule(t)&&this.layerViewImporter.importLayerView(t)},this._reschedule=()=>(c(this._workPromise)&&(this._workPromise=qe()),this.handles.remove("reschedule"),this.handles.add(Gs(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var t,e,i;const s=this.view.map;if(this._map!==s&&(this.clear(),this._map=s),c(this._workPromise))return void this.notifyChange("updating");this.handles.remove("reschedule"),this.handles.remove("collection-change");const n=new FV({getCollections:()=>this._rootCollectionNames.map((t=>this.get(t))),getChildrenFunction:t=>t&&"layers"in t?t.layers:null});if(!n)return this._workPromise.resolve(),void(this._workPromise=null);for(const t of n)this._createLayerView(t);this._refreshCollections();for(const[t,e]of this._layerLayerViewInfoMap)n.includes(t)||(this._layerLayerViewInfoMap.delete(e.layer),e.destroy());const r=n.filter((t=>"group"===t.type)).map((t=>t.layers)),o=[null==s||null==(t=s.ground)?void 0:t.layers,null==s||null==(e=s.basemap)?void 0:e.baseLayers,null==s||null==(i=s.basemap)?void 0:i.referenceLayers,null==s?void 0:s.layers,...r].filter((t=>!!t));this.handles.add(o.map((t=>this._watchUpdatingTracking.addOnCollectionChange(t,this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.handles.add([uo(this,"view.map.allLayers","change",this._preloadLayerViewModules,this._preloadLayerViewModules),Yr(this.view,["map.basemap","map.ground","map.layers","ready"],this._reschedule,!0)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null}get _layersToLayerViews(){const t=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&t.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(t)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return u(this._workPromise)||this._watchUpdatingTracking.updating||vn(this._layerLayerViewInfoMap,(t=>!t.done))}get updatingRemaining(){let t=0;for(const e of this._layerLayerViewInfoMap.values())e.done||++t;return t}clear(){if(!this.destroyed){for(const t of this._layerLayerViewInfoMap.values())t.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections()}}async whenLayerView(t){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(t))throw new dt("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:t});return this._layerLayerViewInfoMap.get(t).promise}_refreshCollections(){for(const[t,e]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(t),this.get(e),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(t,e,i){if(!t||!e)return void(e&&e.removeAll());let s=0;for(const n of t){const t=this._layerLayerViewInfoMap.get(n);if(!t||!t.layerView)continue;const r=t.layerView;r.layer=n,r.parent=i,e.getItemAt(s)!==r&&e.splice(s,0,r),n.layers&&this._populateLayerViewsOwners(n.layers,r.layerViews,r),s+=1}s<e.length&&e.splice(s,e.length)}_createLayerView(t){if(this._layerLayerViewInfoMap.has(t))return this.view.ready&&this._layerLayerViewInfoMap.get(t).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");t.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(t)&&this.layerViewImporter.importLayerView(t);const e=new gB(t,this.view,this.layerViewImporter);e.promise.then((()=>this._refreshCollections()),(e=>{var i,s;e&&(Ge(e)||"cancelled:layerview-create"===e.name)||mB.error(`Failed to create layerview for layer title:'${null!=(i=t.title)?i:"no title"}', id:'${null!=(s=t.id)?s:"no id"}' of type '${t.type}'.`,{layer:t,error:e}),this._refreshCollections()})),this._layerLayerViewInfoMap.set(t,e),this.view.ready&&e.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};e([Hn()],vB.prototype,"_workPromise",void 0),e([Hn({readOnly:!0})],vB.prototype,"_watchUpdatingTracking",void 0),e([Hn({readOnly:!0})],vB.prototype,"_layersToLayerViews",null),e([Hn({readOnly:!0})],vB.prototype,"_rootCollectionNames",null),e([Hn()],vB.prototype,"layerViewImporter",void 0),e([Hn()],vB.prototype,"supportsGround",void 0),e([Hn({readOnly:!0})],vB.prototype,"updating",null),e([Hn({readOnly:!0})],vB.prototype,"updatingRemaining",null),e([Hn({constructOnly:!0})],vB.prototype,"view",void 0),vB=e([_r("esri.views.LayerViewManager")],vB);const wB=vB;let bB=class extends Ar{constructor(t){super(t),this.factor=1.5,this.offset=ex(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};e([Hn({type:Number})],bB.prototype,"factor",void 0),e([Hn({nonNullable:!0})],bB.prototype,"offset",void 0),e([Hn()],bB.prototype,"position",void 0),e([Hn({type:Number,range:{min:0}})],bB.prototype,"size",void 0),e([Hn()],bB.prototype,"maskUrl",void 0),e([Hn()],bB.prototype,"maskEnabled",void 0),e([Hn()],bB.prototype,"overlayUrl",void 0),e([Hn()],bB.prototype,"overlayEnabled",void 0),e([Hn({readOnly:!0})],bB.prototype,"version",null),e([Hn({type:Boolean})],bB.prototype,"visible",void 0),bB=e([_r("esri.views.Magnifier")],bB);const MB=bB;class SB{constructor(t,e){this._stage=t,this._textureRequests=new Map,this._frameTask=u(e)?e.registerTask(im.TEXTURE_UNLOAD):um}destroy(){this._frameTask.remove(),this._textureRequests.forEach((t=>this._releaseTextureRequest(t))),this._textureRequests.clear()}fromData(t,e){const i=this.makeUid(t);let s=this._textureRequests.get(i);return s||(s={referenceCount:0,texture:e(),textureAsync:null,abortController:null},this._stage&&(this._stage.add(s.texture),this._stage.loadSynchronous(s.texture)),this._textureRequests.set(i,s)),s.referenceCount++,{uid:i,texture:s.texture,release:()=>this._release(i)}}_release(t){if(!this._textureRequests)return;const e=this._textureRequests.get(t);e?(e.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+t),e.referenceCount--,e.referenceCount<1&&this._frameTask.schedule((()=>this._releaseNow(t)))):console.warn(`TextureCollection: texture doesn't exist: '${t}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(t){if(!this._textureRequests)return;const e=this._textureRequests.get(t);!e||e.referenceCount>0||(this._releaseTextureRequest(e),this._textureRequests.delete(t))}_releaseTextureRequest(t){var e;t.texture?null==(e=this._stage)||e.remove(t.texture):t.abortController&&(t.abortController.abort(),t.abortController=null)}makeUid(t,e=null){return u(e)?`${t}.${e}px`:t}}const xB=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],kB={};function IB(t){return!!kB[t]}xB.forEach((t=>{kB[t]=!0}));class jB{constructor(t){this.handlers=new Map,this.counter=0,this.handlerCounts=new Map,this.view=t,this.inputManager=null}connect(t){t&&this.disconnect(),this.inputManager=t,this.handlers.forEach((({handler:t,priority:e},i)=>this.inputManager.installHandlers(i,[t],e)))}disconnect(){this.inputManager&&this.handlers.forEach(((t,e)=>this.inputManager.uninstallHandlers(e))),this.inputManager=null}destroy(){this.disconnect(),this.handlers.clear(),this.view=null}on(t,e,i,s){const n=Array.isArray(t)?t:t.split(",");if(!function(t){for(const e of t)if(!IB(e))return!1;return!0}(n))return n.some(IB)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let r,o;Array.isArray(e)?o=e:(r=e,o=[]),"function"==typeof i?r=i:s=i,s=null!=s?s:Dq.DEFAULT;const a=this.createUniqueGroupName(),l=new _B(this.view,n,o,r);this.handlers.set(a,{handler:l,priority:s});for(const t of n){const e=this.handlerCounts.get(t)||0;this.handlerCounts.set(t,e+1)}return this.inputManager&&this.inputManager.installHandlers(a,[l],s),{remove:()=>this.removeHandler(a,n)}}hasHandler(t){return!!this.handlerCounts.get(t)}removeHandler(t,e){if(this.handlers.has(t)){this.handlers.delete(t);for(const t of e){const e=this.handlerCounts.get(t);void 0===e?console.error("Trying to remove handler for event that has no handlers registered: ",t):1===e?this.handlerCounts.delete(t):this.handlerCounts.set(t,e-1)}}this.inputManager&&this.inputManager.uninstallHandlers(t)}createUniqueGroupName(){return this.counter+=1,"viewEvents_"+this.counter}}class _B extends Fq{constructor(t,e,i,s){super(!0),this.view=t;for(const t of e)switch(t){case"click":this.registerIncoming("click",i,(t=>s(this.wrapClick(t))));break;case"double-click":this.registerIncoming("double-click",i,(t=>s(this.wrapDoubleClick(t))));break;case"immediate-click":this.registerIncoming("immediate-click",i,(t=>s(this.wrapImmediateClick(t))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,(t=>s(this.wrapImmediateDoubleClick(t))));break;case"hold":this.registerIncoming("hold",i,(t=>s(this.wrapHold(t))));break;case"drag":this.registerIncoming("drag",i,(t=>{const e=this.wrapDrag(t);e&&s(e)}));break;case"key-down":this.registerIncoming("key-down",i,(t=>s(this.wrapKeyDown(t))));break;case"key-up":this.registerIncoming("key-up",i,(t=>s(this.wrapKeyUp(t))));break;case"pointer-down":this.registerIncoming("pointer-down",i,(t=>s(this.wrapPointer(t,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",i,(t=>s(this.wrapPointer(t,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",i,(t=>s(this.wrapPointer(t,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,(t=>s(this.wrapPointerDrag(t))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,(t=>s(this.wrapMouseWheel(t))));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,(t=>s(this.wrapPointer(t,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,(t=>s(this.wrapPointer(t,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",i,(t=>{s(this.wrapGamepad(t))}));break;case"focus":this.registerIncoming("focus",i,(t=>{s(this.wrapFocus(t))}));break;case"blur":this.registerIncoming("blur",i,(t=>{s(this.wrapBlur(t))}))}}wrapFocus(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapBlur(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapClick(t){const{pointerType:e,button:i,buttons:s,x:n,y:r,native:o,eventId:a}=t.data,{cancelable:l,timestamp:u}=t;return{type:"click",pointerType:e,button:i,buttons:s,x:n,y:r,native:o,timestamp:u,screenPoint:ex(n,r),mapPoint:this.getMapPoint(n,r),eventId:a,cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapDoubleClick(t){const{pointerType:e,button:i,buttons:s,x:n,y:r,native:o,eventId:a}=t.data,{cancelable:l,timestamp:u}=t;return{type:"double-click",pointerType:e,button:i,buttons:s,x:n,y:r,native:o,timestamp:u,mapPoint:this.getMapPoint(n,r),eventId:a,cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateClick(t){const{pointerType:e,button:i,buttons:s,x:n,y:r,native:o,eventId:a}=t.data,l=o.pointerId,{cancelable:u,timestamp:c}=t;return{type:"immediate-click",pointerId:l,pointerType:e,button:i,buttons:s,x:n,y:r,native:o,timestamp:c,mapPoint:this.getMapPoint(n,r),eventId:a,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateDoubleClick(t){const{pointerType:e,button:i,buttons:s,x:n,y:r,native:o,eventId:a}=t.data,l=o.pointerId,{cancelable:u,timestamp:c}=t;return{type:"immediate-double-click",pointerId:l,pointerType:e,button:i,buttons:s,x:n,y:r,native:o,timestamp:c,mapPoint:this.getMapPoint(n,r),eventId:a,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapHold(t){const{pointerType:e,button:i,buttons:s,x:n,y:r,native:o}=t.data,{cancelable:a,timestamp:l}=t;return{type:"hold",pointerType:e,button:i,buttons:s,x:n,y:r,native:o,timestamp:l,mapPoint:this.getMapPoint(n,r),cancelable:a,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}getMapPoint(t,e){return this.view.toMap(ex(t,e),{exclude:[]})}wrapDrag(t){const e=t.data,{x:i,y:s}=e.center,{action:n,pointerType:r,button:o}=e;if("start"===n&&(this.latestDragStart=e),!this.latestDragStart)return;const a=e.pointer.native,l=e.buttons,{cancelable:u,timestamp:c}=t,h={x:this.latestDragStart.center.x,y:this.latestDragStart.center.y};return"end"===n&&(this.latestDragStart=void 0),{type:"drag",action:n,x:i,y:s,origin:h,pointerType:r,button:o,buttons:l,radius:e.radius,angle:Zp(e.angle),native:a,timestamp:c,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapKeyDown(t){const{key:e,repeat:i,native:s}=t.data,{cancelable:n,timestamp:r}=t;return{type:"key-down",key:e,repeat:i,native:s,timestamp:r,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapKeyUp(t){const{key:e,native:i}=t.data,{cancelable:s,timestamp:n}=t;return{type:"key-up",key:e,native:i,timestamp:n,cancelable:s,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointer(t,e){const{x:i,y:s,button:n,buttons:r,native:o,eventId:a}=t.data,l=o.pointerId,u=o.pointerType,{cancelable:c,timestamp:h}=t;return{type:e,x:i,y:s,pointerId:l,pointerType:u,button:n,buttons:r,native:o,timestamp:h,eventId:a,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointerDrag(t){const{x:e,y:i,buttons:s,native:n,eventId:r}=t.data.currentEvent,{button:o}=t.data.startEvent,a=t.data.startEvent.native.pointerId,l=t.data.startEvent.native.pointerType,u=t.data.action,c={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:h,timestamp:d}=t;return{type:"pointer-drag",x:e,y:i,pointerId:a,pointerType:l,button:o,buttons:s,action:u,origin:c,native:n,timestamp:d,eventId:r,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapMouseWheel(t){const{cancelable:e,data:i,timestamp:s}=t,{x:n,y:r,deltaY:o,native:a}=i;return{type:"mouse-wheel",x:n,y:r,deltaY:o,native:a,timestamp:s,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapGamepad(t){const{action:e,state:i,device:s}=t.data,{cancelable:n,timestamp:r}=t,{buttons:o,axes:a}=i;return{type:"gamepad",device:s,timestamp:r,action:e,buttons:o,axes:a,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}}function TB(t){return[t.on("after-add",(t=>{const e=t.item;e.view&&e.view.ready&&!e.attached&&e.attach()})),t.on("after-remove",(t=>{const e=t.item;e.active&&(e.view.activeTool=null),e.attached&&e.detach()}))]}function OB(t){return t.visible&&t.getEditableFlag(0)&&t.getEditableFlag(1)}function AB(t){return ex(t.x,t.y)}function FB(t,e){const i=(t instanceof HTMLElement?t:t.surface).getBoundingClientRect();return ex(e.clientX-i.left,e.clientY-i.top)}function CB(t,e){return e instanceof Event?FB(t,e):AB(e)}function PB(t){if(t instanceof Event)return!0;if("object"==typeof t&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}class EB{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._currentlyActiveTool=null,this._revertToActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}handleInputEvent(t,e){const i=()=>t.stopPropagation();switch(t.type){case"pointer-move":LB(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(i(),"end"===t.action&&(this._stopDrag=!1));break;case"pointer-down":{if(!RB(t))break;const s=AB(t),n=this._intersect(s,t.pointerType,e.forEachTool);if(c(n))break;const r=this._findToolAndManipulatorByKey(n,e.forEachTool,NB),o=d(r,(t=>t.manipulator)),a=d(r,(t=>t.tool));!(u(o)&&u(a)&&o.interactive)||o.grabbable&&o.grabbableForEvent(t)||!o.grabbing||o.dragging||this._ungrabManipulatorBeforeDragging(o,a,t),u(o)&&o.interactive&&o.grabbable&&o.grabbableForEvent(t)&&!o.grabbing&&(this._grabbedManipulators.set(t.pointerId,{key:n,start:s,pointerType:t.pointerType}),1===this._grabbedManipulators.size&&e.activeTool!==n.tool&&(this._currentlyActiveTool=e.activeTool,this._revertToActiveTool=!0,e.setActiveTool(n.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:s}),i());break}case"pointer-up":this._handlePointerEnd(t,e);break;case"pointer-drag":{if(!RB(t))break;const s=this._grabbedManipulators.get(t.pointerId),n=this._draggedManipulators.get(t.pointerId),r=d(s||n,(({key:t})=>t)),o=this._findManipulatorByKey(r,e.forEachTool);if(c(o))break;const a=AB(t);a.x=qp(a.x,0,e.view.width),a.y=qp(a.y,0,e.view.height);const l=(s||n).start;switch(t.action){case"start":case"update":"update"!==t.action&&1!==this._grabbedManipulators.size||(o.dragging=!0,o.events.emit("drag",n?{action:"update",start:l,screenPoint:a}:{action:"start",start:l,screenPoint:a,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{key:r,start:l}));break;case"end":o.dragging=!1,n&&o.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,e)}i();break}case"immediate-click":{const s=AB(t),n=this._intersect(s,t.pointerType,e.forEachTool),r=this._findToolAndManipulatorByKey(n,e.forEachTool,NB);if(function(t){return!!t.native.shiftKey}(t)||e.forEachTool((t=>{if((!u(r)||r.tool!==t||t.automaticManipulatorSelection)&&t.manipulators){let e=!1;t.manipulators.forEach((({manipulator:t})=>{t.selected&&(t.selected=!1,e=!0)})),e&&t.manipulatorSelectionChanged&&t.manipulatorSelectionChanged()}})),c(r))break;const{manipulator:o,tool:a}=r;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.manipulatorSelectionChanged&&a.manipulatorSelectionChanged()),o.events.emit("immediate-click",{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:t.native.shiftKey,stopPropagation:i});break}case"click":{const s=AB(t),n=this._intersect(s,t.pointerType,e.forEachTool),r=this._findManipulatorByKey(n,e.forEachTool);if(c(r)||!r.interactive)break;r.events.emit(t.type,{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:t.native.shiftKey}),i();break}case"double-click":{const s=AB(t),n=this._intersect(s,t.pointerType,e.forEachTool),r=this._findManipulatorByKey(n,e.forEachTool);if(c(r)||!r.interactive)break;r.events.emit("double-click",{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:t.native.shiftKey,stopPropagation:i});break}case"immediate-double-click":{const s=AB(t),n=this._intersect(s,t.pointerType,e.forEachTool),r=this._findManipulatorByKey(n,e.forEachTool);if(c(r)||!r.interactive)break;r.events.emit("immediate-double-click",{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:t.native.shiftKey,stopPropagation:i});break}}this._updateCursor(e.forEachTool)}_ungrabManipulatorBeforeDragging(t,e,i){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:AB(i)}),this._grabbedManipulators.forEach((({key:i},s)=>{i.tool===e&&e.manipulators.findById(i.manipulatorId)===t&&this._grabbedManipulators.delete(s)}))}_handlePointerEnd(t,e){const i=d(this._grabbedManipulators.get(t.pointerId),(({key:t})=>t)),s=this._findManipulatorByKey(i,e.forEachTool);u(s)&&!s.dragging&&(1===this._grabbedManipulators.size&&0===this._draggedManipulators.size&&this._revertToActiveTool&&(e.setActiveTool(this._currentlyActiveTool),this._revertToActiveTool=!1,this._currentlyActiveTool=null),s.grabbing&&(s.grabbing=!1,s.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:AB(t)})),this._grabbedManipulators.delete(t.pointerId))}_cursorFromMap(t,e){let i=null;return vn(t,(({key:t})=>{const s=this._findManipulatorByKey(t,e);return!!(u(s)&&s.interactive&&"cursor"in s&&s.cursor)&&(i=s.cursor,!0)})),i}_updateCursor(t){this._cursor=this._grabbedManipulators.size>0?this._cursorFromMap(this._grabbedManipulators,t)||"grabbing":this._hoveredManipulators.size>0?this._cursorFromMap(this._hoveredManipulators,t)||"pointer":null}clearPointers(t,e,i=!0,s){const n=e=>e.tool===t&&(c(s)||e.manipulatorId===s);this._grabbedManipulators.forEach((({key:t,pointerType:i},s)=>{if(n(t)){this._grabbedManipulators.delete(s);const n=this._findManipulatorByKey(t,e);u(n)&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:i}))}})),this._draggedManipulators.forEach((({key:t},i)=>{if(n(t)){this._draggedManipulators.delete(i);const s=this._findManipulatorByKey(t,e);u(s)&&(s.dragging=!1,s.events.emit("drag",{action:"cancel"}))}})),i&&this._hoveredManipulators.forEach((({key:t},i)=>{if(n(t)){this._hoveredManipulators.delete(i);const s=this._findManipulatorByKey(t,e);u(s)&&(s.hovering=!1)}})),this._updateCursor(e)}_intersect(t,e,i){let s=null;return i((i=>{if(null==i.manipulators||!OB(i))return!1;const n=i.manipulators.intersect(t,e);return!c(n)&&(s={manipulatorId:n.id,tool:i},!0)})),s}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach(((e,i)=>{this._updateHoveredStateForPointerAtScreenPosition(ex(e.x,e.y),i,e.pointerType,t)}))}handleHoverEvent(t,e){"pointer-up"!==t.type&&"immediate-click"!==t.type&&"pointer-move"!==t.type||!LB(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(AB(t),t.pointerId,t.pointerType,e)}_updateHoveredStateForPointerAtScreenPosition(t,e,i,s){const n=this._intersect(t,i,s);let r=this._findManipulatorByKey(n,s);const o=d(this._hoveredManipulators.get(e),(({key:t})=>t)),a=this._findManipulatorByKey(o,s);u(r)&&!r.interactive&&(r=null),a!==r&&(u(a)&&(a.hovering=!1),u(r)?(r.hovering=!0,this._hoveredManipulators.set(e,{key:n})):this._hoveredManipulators.delete(e),this._updateCursor(s))}_findManipulatorByKey(t,e){return this._findToolAndManipulatorByKey(t,e,NB)?NB.manipulator:null}_findToolAndManipulatorByKey(t,e,i){return c(t)?null:(i.tool=null,i.manipulator=null,e((e=>{if(e!==t.tool||null==e.manipulators||!OB(e))return!1;const s=e.manipulators.findById(t.manipulatorId);return!!u(s)&&(i.manipulator=s,i.tool=e,!0)})),i.manipulator?i:null)}}function LB(t){return"mouse"===t}function RB(t){return"mouse"!==t.pointerType||0===t.button}const NB={manipulator:null,tool:null},DB=ct.getLogger("esri.views.ToolViewManager"),VB="manipulators";let $B=class extends Gw{constructor(t){super(t),this._manipulatorState=new EB,this.tools=new Jr,this.cursor=null,this._forEachTool=t=>{for(const e of this.tools.items)if(t(e))return}}initialize(){this.handles.add([this.view.on(xB,(t=>{this._handleInputEvent(t)}),Dq.TOOL),...TB(this.tools),this.tools.on("before-add",(t=>{const e=t.item;if(null==e||this.tools.includes(e))return DB.warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault()})),this.tools.on("before-remove",(({item:t})=>{this._manipulatorState.clearPointers(t,this._forEachTool)})),this.tools.on("change",(()=>{this._refreshToolWatchers()}))])}destroy(){this._forEachTool((t=>t.destroy()))}set activeTool(t){if(u(t)&&!this.view.ready)return void DB.error("Cannot set active tool while view is not ready.");if(t===this.activeTool)return void(u(t)&&DB.warn("Tool is already active - ignoring activation request."));u(this.activeTool)&&this.activeTool.deactivate(),u(t)&&t.activate(),this._set("activeTool",t),this._removeIncompleteTools(t);const e=c(this.activeTool);for(const t of this.tools){t.setEditableFlag(1,e||t===this.activeTool);const i=OB(t);!e&&i||this._manipulatorState.clearPointers(t,this._forEachTool,!i)}this._updateCursor()}get updating(){return this.updatingHandles.updating||this.tools.some((t=>t.updating))}attach(){this._forEachTool((t=>t.attach())),"3d"===this.view.type?(this._set("textures",new SB(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([this.view.state.watch("camera",(()=>{this._forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange()}))})),this.view.elevationProvider.on("elevation-change",(t=>{this._forEachManipulator((e=>{null!=e.onElevationChange&&e.onElevationChange(t)}))}))],VB)):this.handles.add(this.view.watch("extent",(()=>{this._forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange()}))})))}detach(){u(this.activeTool)&&(this.activeTool=null),this._forEachTool((t=>{t.detach(),t.destroy()})),this.tools.removeAll(),this.handles.remove(VB)}_forEachManipulator(t){this._forEachTool((e=>{e.manipulators&&e.manipulators.forEach((({manipulator:i})=>t(i,e)))}))}_handleInputEvent(t){let e=!1;const i={...t,stopPropagation:()=>{e=!0,t.stopPropagation()}};u(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool((t=>{!e&&t.attached&&t.visible&&t.handleInputEvent(i)})),!e&&"key-down"===t.type&&"Escape"===t.key&&this.activeTool&&(t.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t},view:this.view}),!e&&u(this.activeTool)&&this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor()}_refreshToolWatchers(){this.handles.remove("tools"),this._forEachTool((t=>{if(t instanceof Ar){const e=Xr(t,["cursor","visible","editable"],(()=>{OB(t)||this._manipulatorState.clearPointers(t,this._forEachTool),this._updateCursor()}));this.handles.add(e,"tools")}t.manipulators&&this.handles.add(t.manipulators.on("change",(e=>{e.removed.forEach((({id:e})=>{this._manipulatorState.clearPointers(t,this._forEachTool,!0,e)})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})),"tools")})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateCursor(){let t=this._manipulatorState.cursor;this._forEachTool((e=>!(!u(e.cursor)||!e.visible||(t=e.cursor,0)))),this._get("cursor")!==t&&this._set("cursor",t)}_removeIncompleteTools(t){this.tools.filter((e=>(c(t)||e!==t)&&!e.completed)).forEach((t=>{this.tools.remove(t),t.destroy()}))}};e([Hn({constructOnly:!0,nonNullable:!0})],$B.prototype,"view",void 0),e([Hn({readOnly:!0,nonNullable:!0})],$B.prototype,"textures",void 0),e([Hn({value:null})],$B.prototype,"activeTool",null),e([Hn({readOnly:!0,type:Jr})],$B.prototype,"tools",void 0),e([Hn({readOnly:!0})],$B.prototype,"cursor",void 0),e([Hn({readOnly:!0})],$B.prototype,"updating",null),$B=e([_r("esri.views.ToolViewManager")],$B);const zB=$B;let GB=class extends Ar{constructor(t){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",this._detectedDeviceType="standard"===t.mapping?"standard":UB.test(t.id)?"spacemouse":"unknown",this.nativeIndex=t.index}get native(){return(navigator.getGamepads?navigator.getGamepads():[])[this.nativeIndex]}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return qB[this.deviceType]}};e([Hn({nonNullable:!0,readOnly:!0})],GB.prototype,"nativeIndex",void 0),e([Hn({type:String,readOnly:!0})],GB.prototype,"deviceType",null),e([Hn({type:Number,readOnly:!0})],GB.prototype,"axisThreshold",null),GB=e([_r("esri.views.input.gamepad.GamepadInputDevice")],GB);const UB=/^(3dconnexion|space(mouse|navigator|pilot|explorer))/i,qB={standard:.15,spacemouse:.025,unknown:0},BB=GB;let WB=class extends Ar{constructor(...t){super(...t),this.devices=new Jr,this.enabledFocusMode="document"}};e([Hn({type:Jr.ofType(BB),readOnly:!0})],WB.prototype,"devices",void 0),e([Hn({type:["document","view","none"]})],WB.prototype,"enabledFocusMode",void 0),WB=e([_r("esri.views.input.gamepad.GamepadSettings")],WB);const HB=WB;let JB=class extends Ar{constructor(){super(...arguments),this.gamepad=new HB}};e([Hn({readOnly:!0})],JB.prototype,"gamepad",void 0),JB=e([_r("esri.views.input.Input")],JB);const ZB=JB;let QB=class extends Ar{constructor(t){super(t),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};e([Hn({type:Boolean,nonNullable:!0})],QB.prototype,"enabled",void 0),e([Hn({type:BB})],QB.prototype,"device",void 0),e([Hn({type:["pan","zoom"],nonNullable:!0})],QB.prototype,"mode",void 0),e([Hn({type:["forward-down","forward-up"],nonNullable:!0})],QB.prototype,"tiltDirection",void 0),e([Hn({type:Number,nonNullable:!0})],QB.prototype,"velocityFactor",void 0),QB=e([_r("esri.views.navigation.gamepad.GamepadSettings")],QB);const KB=QB;let YB=class extends Ar{constructor(t){super(t),this.browserTouchPanEnabled=!0,this.gamepad=new KB,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};e([Hn({type:Boolean})],YB.prototype,"browserTouchPanEnabled",void 0),e([Hn({type:KB,nonNullable:!0})],YB.prototype,"gamepad",void 0),e([Hn({type:Boolean})],YB.prototype,"momentumEnabled",void 0),e([Hn({type:Boolean})],YB.prototype,"mouseWheelZoomEnabled",void 0),YB=e([_r("esri.views.navigation.Navigation")],YB);const XB=YB;function tW(t){return"heightModelInfo"in t}function eW(t){if("unknown"===t.type||!("capabilities"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"wfs":return!0;default:return!1}}function iW(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"analysis":case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"map-image":case"map-notes":case"ogc-feature":case"open-street-map":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}const sW=new XF({heightModel:"gravity-related-height"});var nW;const rW=ct.getLogger("esri.views.support.DefaultsFromMap");let oW=nW=class extends Ar{constructor(){super(...arguments),this._handles=new Qr,this._waitTask=null,this._extentProjectController=null,this._spatialReferenceCandidates=null,this._extentCandidates=null,this.logDebugInformation=!1,this.isSpatialReferenceDone=!1,this.isTileInfoDone=!1,this.isHeightModelInfoSearching=!1,this.spatialReference=null,this.extent=null,this.heightModelInfo=null,this.vcsWkid=null,this.latestVcsWkid=null,this.mapCollectionPaths=nW.DefaultMapCollectionPaths.slice(),this.tileInfo=null}initialize(){this.watch("mapCollectionPaths",(()=>{this._running&&(this.reset(),this.start())}))}destroy(){this._set("view",null),this._handles=m(this._handles),this._cancelLoading()}get _running(){return!!(this._handles&&this._handles.size>0)}reset(){this._handles.removeAll(),this._set("isSpatialReferenceDone",!1),this._set("isTileInfoDone",!1),this._set("isHeightModelInfoSearching",!1),this._set("spatialReference",null),this._set("extent",null),this._set("heightModelInfo",null),this._set("vcsWkid",null),this._set("latestVcsWkid",null),this._set("tileInfo",null),this._spatialReferenceCandidates=null,this._extentCandidates=null}start(){this._handles.removeAll();const t=this._updateLayerChange.bind(this);for(const e of this.mapCollectionPaths)this._handles.add(uo(this.view,"map."+e,"change",t,t,t,!0));this._handles.add(to(this,"isSpatialReferenceDone",(()=>this._updateTileInfo()),!0))}_ownerNameFromCollectionName(t){const e=t.lastIndexOf(".");return-1===e?"view":"view."+t.slice(0,e)}_ensureLoadedOwnersFromCollectionName(t){const e=this._ownerNameFromCollectionName(t).split(".");let i;for(let s=0;s<e.length&&(i=this.get(e.slice(0,s+1).join(".")),i);s++)if(i.load&&!i.isFulfilled())return{collectionName:t,owner:null,loading:i.load().catch((()=>{}))};return{collectionName:t,owner:i}}_cancelLoading(){this._waitTask=null,this._extentProjectController&&(this._extentProjectController.abort(),this._extentProjectController=null)}_updateWhen(t){let e=!0,i=!1;const s=t.catch((()=>{})).then((()=>{e?i=!0:s===this._waitTask&&this._update()}));return e=!1,i||(this._waitTask=s),i}_updateLayerChange(){this.isSpatialReferenceDone&&!this.spatialReference&&this._set("isSpatialReferenceDone",!1),this._update()}_update(){if(this._cancelLoading(),this.view){if(!this.isSpatialReferenceDone){this._debugLog("Starting search for spatial reference...");const t=this._processMapCollections((t=>this._processSpatialReferenceSource(t)));if(this._debugLog(`Search ended with status '${lW(t)}'`),0!==t){let t=null,e=this._spatialReferenceCandidates;if(!e||e.length<1?(t=this.defaultSpatialReference,this._debugLog(`No spatial reference found, locking to default (${aW(t)})`)):(this.defaultSpatialReference&&e.length>1&&e.findIndex((t=>t.equals(this.defaultSpatialReference)))>-1&&(e=[this.defaultSpatialReference]),t=e[0],this._debugLog("Locking to "+aW(t))),this._set("spatialReference",t),t)if(this.extent)this._set("isSpatialReferenceDone",!0);else{const e=this.logDebugInformation;this.logDebugInformation=!1,this._processMapCollections((e=>this._findExtent(e,t))),this.logDebugInformation=e,this._projectExtentCandidate().catch((()=>{})).then((()=>this._set("isSpatialReferenceDone",!0)))}else this._set("isSpatialReferenceDone",!0)}}if(null==this.heightModelInfo&&this.view.isHeightModelInfoRequired){this._debugLog("Starting search for height model info...");const t=this._processMapCollections((t=>this._processHeightModelInfoSource(t)),(t=>function(t){return null!=t.layers||iW(t)||eW(t)||tW(t)}(t)));this._debugLog("Search ended with status "+lW(t)),this._set("isHeightModelInfoSearching",0===t)}this._updateTileInfo()}}_processMapCollections(t,e){this._preloadMapCollections(e);let i=2;return this._forAllMapCollectionSources((t=>{if(2!==i)return!1;const{collectionName:e}=t;return this._debugLog(`Processing collection ${e}...`),!(t.loading&&!this._updateWhen(t.loading)&&(this._debugLog(`Collection ${t.collectionName} owner is loading -> wait`),i=0,1))}),(s=>!(2!==i||(null==e||e(s)?!s.load||s.isFulfilled()||this._updateWhen(s.load())?(!s.load||s.isResolved())&&t(s)&&(i=1,1):(this._debugLog(`Source ${s.id} is loading -> wait`),i=0,1):(this._debugLog(`Source ${s.id} is skipped due to predicate`),1))))),i}_preloadMapCollections(t){let e=10;const i=this.logDebugInformation;this.logDebugInformation=!1,this._forAllMapCollectionSources((()=>!0),(s=>0!==e&&!(null!=t&&!t(s)||(s.load&&!s.isFulfilled()&&(this.logDebugInformation=i,this._debugLog("Pre-loading source "+s.id),this.logDebugInformation=!1,s.load().catch((()=>{})),e--),0)))),this.logDebugInformation=i}_forAllMapCollectionSources(t,e){for(const i of this.mapCollectionPaths){const s="map."+i,n=this._ensureLoadedOwnersFromCollectionName(s);if(!1===t(n))continue;const r=n.owner;if(!r||r.isRejected&&r.isRejected()){this._debugLog(`Collection ${s} owner is invalid or rejected -> skip`);continue}const o=this.view.get(s);o?this._forEachSource(o,e):this._debugLog(`Collection ${s} does not exist -> skip`)}}_forEachSource(t,e){for(const i of t.items)!1!==e(i)&&"layers"in i&&i.layers&&this._forEachSource(i.layers,e)}_processSpatialReferenceSource(t){let e=this._getSupportedSpatialReferences(t);return 0!==e.length&&(this._spatialReferenceCandidates?(e=function(t,e,i){return t&&e?t.filter(i?function(t){return e.findIndex((function(e){return i(t,e)}))>-1}:function(t){return e.indexOf(t)>-1}):[]}(e,this._spatialReferenceCandidates,((t,e)=>t.equals(e))),e.length>0?this._spatialReferenceCandidates=e:this._debugLog(`Layer ${t.id} is ignored because its supported spatial\n          references are not compatible with the previous candidates`)):this._spatialReferenceCandidates=e,1===this._spatialReferenceCandidates.length)}_findExtent(t,e){const i="fullExtents"in t&&t.fullExtents||(u(t.fullExtent)?[t.fullExtent]:[]),s=i.find((t=>t.spatialReference.equals(e)));if(s)return this._set("extent",s),!0;if(this._getSupportedSpatialReferences(t).length>0){const e=i.map((e=>({extent:e,layer:t})));this._extentCandidates=(this._extentCandidates||[]).concat(e)}return!1}async _projectExtentCandidate(){if(!this._extentCandidates||!this._extentCandidates.length)return;const t=this.spatialReference,e=this._extentCandidates.find((e=>Qh(e.extent.spatialReference,t)));if(u(e))this._set("extent",Kh(e.extent,t));else{const e=this._extentCandidates[0];this._extentProjectController=new AbortController;const i=await import("./p-38a59446.js");try{const s=await i.projectGeometry(e.extent,t,e.layer.portalItem,this._extentProjectController.signal);this._set("extent",s)}catch{}this._extentProjectController=null}}_getSupportedSpatialReferences(t){const e="supportedSpatialReferences"in t&&t.supportedSpatialReferences||(t.spatialReference?[t.spatialReference]:[]);if(0===e.length)return this._debugLog(`Layer ${t.id} is ignored because it does not have any spatial references`),[];const i=e.filter((e=>this.view.isSpatialReferenceSupported(e,t,(t=>this._debugLog(t)))));return this._debugLog(0===i.length?`Layer ${t.id} has spatial references but none of them are supported (or layer doesn't require locking)`:`Layer ${t.id} has spatial references. Resulting candidate set: ${i.map(aW).join(", ")}`),i}_processHeightModelInfoSource(t){const e=function(t){const e=t.url&&MP(t.url);return null==(t.spatialReference&&t.spatialReference.vcsWkid)&&u(e)&&"ImageServer"===e.serverType||!tW(t)||!t.heightModelInfo?function(t){return eW(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):iW(t)}(t)?XF.deriveUnitFromSR(sW,t.spatialReference):null:t.heightModelInfo}(t);return!!e&&(this._set("heightModelInfo",e),this._set("isHeightModelInfoSearching",!1),t.spatialReference&&(this._set("vcsWkid",t.spatialReference.vcsWkid),this._set("latestVcsWkid",t.spatialReference.latestVcsWkid)),!0)}_updateTileInfo(){if(null!=this.tileInfo)return;if(!this.view.isTileInfoRequired())return void this._set("isTileInfoDone",!0);if(!this.isSpatialReferenceDone)return;const t=this.get("view.map");if(!t)return void this._debugLog("updateTileInfo: no map");const e=t.basemap,i=t.get("layers.0");let s=null;if(e&&"failed"!==e.loadStatus){if(!e.loaded)return this._updateWhen(e.load()),void this._debugLog("updateTileInfo: basemap still loading");const t=e&&e.get("baseLayers.0");if(t&&"failed"!==t.loadStatus){if(!t.loaded)return this._updateWhen(t.load()),void this._debugLog("updateTileInfo: first basemap layer still loading");s="tileInfo"in t&&t.tileInfo}else{if(!i||"failed"===i.loadStatus)return this._debugLog("updateTileInfo: no tileInfo"),void this._set("isTileInfoDone",!0);if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo}}else if(i&&"failed"!==i.loadStatus){if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo}s&&!s.spatialReference.equals(this.spatialReference)&&(s=null),this._debugLog("updateTileInfo: setting "+s),this._set("tileInfo",s),this._set("isTileInfoDone",!0)}_debugLog(t){this.logDebugInformation&&rW.info(t)}};function aW(t){return t?JSON.stringify(t.toJSON()):"undefined"}function lW(t){switch(t){case 0:return"Waiting";case 1:return"Found";case 2:return"Exhausted"}}oW.DefaultMapCollectionPaths=["basemap.baseLayers","layers","ground.layers","basemap.referenceLayers"],e([Hn()],oW.prototype,"logDebugInformation",void 0),e([Hn({readOnly:!0})],oW.prototype,"isSpatialReferenceDone",void 0),e([Hn({readOnly:!0})],oW.prototype,"isTileInfoDone",void 0),e([Hn({readOnly:!0})],oW.prototype,"isHeightModelInfoSearching",void 0),e([Hn({constructOnly:!0})],oW.prototype,"view",void 0),e([Hn({readOnly:!0})],oW.prototype,"spatialReference",void 0),e([Hn({readOnly:!0})],oW.prototype,"extent",void 0),e([Hn({readOnly:!0})],oW.prototype,"heightModelInfo",void 0),e([Hn({readOnly:!0})],oW.prototype,"vcsWkid",void 0),e([Hn({readOnly:!0})],oW.prototype,"latestVcsWkid",void 0),e([Hn()],oW.prototype,"mapCollectionPaths",void 0),e([Hn()],oW.prototype,"defaultSpatialReference",void 0),e([Hn({readOnly:!0})],oW.prototype,"tileInfo",void 0),oW=nW=e([_r("esri.views.support.DefaultsFromMap")],oW);const uW=oW;var cW;const hW=ct.getLogger("esri.views.View");let dW=cW=class extends(zw(Cr.EventedMixin(ma(Ar)))){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new FV({getCollections:()=>{var t,e,i;return[null==(t=this.basemapView)?void 0:t.baseLayerViews,null==(e=this.groundView)?void 0:e.layerViews,this.layerViews,null==(i=this.basemapView)?void 0:i.referenceLayerViews]},getChildrenFunction:t=>t.layerViews}),this.groundView=null,this.animation=null,this.basemapView=null,this.defaultsFromMap=new uW({view:this}),this.fatalError=null,this.extent=null,this.graphics=new pB,this.navigating=!1,this.layerViews=new Jr,this.magnifier=new MB,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new ZB,this.navigation=new XB,this.layerViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new jB(this),this.persistableViewModels=new Jr,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(this.watch("preconditionsReady",(t=>{t?(this._currentSpatialReference=this.spatialReference,cW.views.add(this)):(this._currentSpatialReference=null,cW.views.remove(this)),this.notifyChange("spatialReference"),!t&&this.ready?(this.layerViewManager.clear(),this.toolViewManager.detach(),this._teardown()):t&&!this.ready&&(this._startup(),this.toolViewManager.attach())}),!0))}initialize(){let t;this.addResolvingPromise(this.validate().then((()=>(this._isValid=!0,eo(this,"ready"))))),this.basemapView=new yB({view:this}),this.layerViewManager=new wB({view:this,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new zB({view:this}),this._resetInitialViewPropertiesFromContent(),Yr(this.defaultsFromMap,"isSpatialReferenceDone",(e=>{const i=!!(this.map&&this.map.allLayers.length>0);if(e&&!this.spatialReference&&i||!t){if(e&&!this.spatialReference&&i&&!t){const e=t=Ze(this.spatialReferenceWarningDelay);t.then((()=>{e===t&&hW.warn("#spatialReference","no spatial reference could be derived from the currently added map layers")})).catch((()=>{}))}}else t=null}),!0)}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=m(this.graphics),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.toolViewManager=m(this.toolViewManager),this.layerViewManager=m(this.layerViewManager),this.basemapView=m(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const t=this.map;this.map=null,null==t||t.destroy()}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return hW.error("#toMap()","Not implemented on this instance of View"),null}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get preconditionsReady(){return!!(!this.fatalError&&this._isValid&&!this._readyCycleForced&&this.map&&(!Bc.isLoadable(this.map)||this.map.loaded)&&0!==this.width&&0!==this.height&&this.spatialReference&&this.isSpatialReferenceSupported(this.spatialReference)&&(this._currentSpatialReference||!this.initialExtentRequired||this.initialExtent||this.defaultsFromMap&&this.defaultsFromMap.isSpatialReferenceDone)&&this.defaultsFromMap&&this.defaultsFromMap.isTileInfoDone)}set map(t){var e;t!==this._get("map")&&(null!=(e=t)&&e.destroyed&&(hW.warn("#map","The provided map is already destroyed",{map:t}),t=null),Bc.isLoadable(t)&&t.load().catch((()=>{})),this.initialized&&(this.forceReadyCycle(),this._resetInitialViewPropertiesFromContent()),this._set("map",t))}get spatialReference(){let t=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return t&&this.isHeightModelInfoRequired&&this.defaultsFromMap&&(t=t.clone(),t.vcsWkid=this.defaultsFromMap.vcsWkid,t.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),t}set spatialReference(t){this._userSpatialReference=t,this._set("spatialReference",t)}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get initialExtent(){return this.defaultsFromMap&&this.defaultsFromMap.extent}get cursor(){const t=this.toolViewManager?this.toolViewManager.cursor:null;return u(t)?t:this._cursor||"default"}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}whenLayerView(t){return this.layerViewManager.whenLayerView(t)}getDefaultSpatialReference(){return this.get("defaultsFromMap.spatialReference")}getDefaultHeightModelInfo(){return this.get("map.supportsHeightModelInfo")&&this.get("map.heightModelInfo")||this.get("defaultsFromMap.heightModelInfo")||null}importLayerView(t){throw new dt("importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}invalidate(){this._isValid=!1}isSpatialReferenceSupported(t,e,i){return!0}isTileInfoRequired(){return!1}when(t,e){return this.isResolved()&&!this.ready&&hW.warn("#when()",'Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use watchUtils.whenOnce(view, "ready").then(...) instead.'),super.when(t,e)}forceReadyCycle(){this.ready&&(this._readyCycleForced=!0,ao(this,"preconditionsReady",(()=>this._readyCycleForced=!1)))}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}_resetInitialViewPropertiesFromContent(){if(!this.defaultsFromMap)return;const t=()=>this.defaultsFromMap&&this.defaultsFromMap.start();this.defaultsFromMap.reset(),this._currentSpatialReference=null,this.notifyChange("spatialReference"),this.handles.remove("defaultsFromMap"),this.handles.add([Xr(this,"spatialReference",((e,i)=>{Mh(e,i)||t()})),Xr(this,"initialExtentRequired",t),Gs(t)],"defaultsFromMap")}};dW.views=new Jr,e([go("toolViewManager.activeTool")],dW.prototype,"activeTool",void 0),e([Hn({readOnly:!0})],dW.prototype,"allLayerViews",void 0),e([Hn()],dW.prototype,"groundView",void 0),e([Hn()],dW.prototype,"animation",void 0),e([Hn()],dW.prototype,"basemapView",void 0),e([Hn()],dW.prototype,"defaultsFromMap",void 0),e([Hn()],dW.prototype,"fatalError",void 0),e([Hn({type:Ld})],dW.prototype,"extent",void 0),e([Hn(fB(pB,"graphics"))],dW.prototype,"graphics",void 0),e([Hn({readOnly:!0,type:XF,dependsOn:["map.heightModelInfo?","defaultsFromMap.heightModelInfo"]})],dW.prototype,"heightModelInfo",null),e([Hn({readOnly:!0})],dW.prototype,"interacting",null),e([Hn({readOnly:!0})],dW.prototype,"navigating",void 0),e([Hn({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","initialExtentRequired","initialExtent","defaultsFromMap.isSpatialReferenceDone","defaultsFromMap.isTileInfoDone"]})],dW.prototype,"preconditionsReady",null),e([Hn({type:Jr,readOnly:!0})],dW.prototype,"layerViews",void 0),e([Hn({type:MB})],dW.prototype,"magnifier",void 0),e([Hn({value:null,type:BV})],dW.prototype,"map",null),e([Hn()],dW.prototype,"padding",void 0),e([Hn({readOnly:!0})],dW.prototype,"ready",void 0),e([Hn({type:Lh})],dW.prototype,"spatialReference",null),e([Hn()],dW.prototype,"spatialReferenceWarningDelay",void 0),e([Hn()],dW.prototype,"stationary",null),e([Hn({readOnly:!0})],dW.prototype,"supportsGround",void 0),e([Hn({type:ME})],dW.prototype,"timeExtent",void 0),e([go("toolViewManager.tools")],dW.prototype,"tools",void 0),e([Hn()],dW.prototype,"toolViewManager",void 0),e([Hn({readOnly:!0})],dW.prototype,"type",void 0),e([Hn({type:Number})],dW.prototype,"scale",void 0),e([Hn({readOnly:!0})],dW.prototype,"updating",void 0),e([Hn({readOnly:!0})],dW.prototype,"initialExtentRequired",void 0),e([Hn({readOnly:!0,type:Ld})],dW.prototype,"initialExtent",null),e([Hn()],dW.prototype,"cursor",null),e([Hn({readOnly:!0})],dW.prototype,"input",void 0),e([Hn({type:XB,nonNullable:!0})],dW.prototype,"navigation",void 0),e([Hn()],dW.prototype,"layerViewManager",void 0),e([Hn()],dW.prototype,"width",void 0),e([Hn()],dW.prototype,"height",void 0),e([Hn({readOnly:!0})],dW.prototype,"resizing",void 0),e([Hn({value:null,readOnly:!0})],dW.prototype,"size",null),e([Hn({readOnly:!0})],dW.prototype,"suspended",void 0),e([Hn({readOnly:!0})],dW.prototype,"viewEvents",void 0),e([Hn({readOnly:!0})],dW.prototype,"persistableViewModels",void 0),e([Hn()],dW.prototype,"_isValid",void 0),e([Hn()],dW.prototype,"_readyCycleForced",void 0),e([Hn()],dW.prototype,"_currentSpatialReference",void 0),dW=cW=e([_r("esri.views.View")],dW);const fW=dW;let pW=class extends ga{constructor(t){super(t),this.state="running",this.target=null}initialize(){this.addResolvingPromise(new Promise(((t,e)=>this._dfd={resolve:t,reject:e})))}get done(){return"finished"===this.state||"stopped"===this.state}stop(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._dfd.reject(new dt("ViewAnimation stopped")))}finish(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._dfd.resolve())}update(t,e){e||(e=Qe(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",e)}};e([Hn({readOnly:!0})],pW.prototype,"done",null),e([Hn({readOnly:!0,type:String})],pW.prototype,"state",void 0),e([Hn()],pW.prototype,"target",void 0),pW=e([_r("esri.views.ViewAnimation")],pW),(pW||(pW={})).State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"};const yW=pW;function mW(t,e,i,s){const n=3*t,r=3*(i-t)-n,o=1-n-r,a=3*e,l=3*(s-e)-a,u=1-a-l;function c(t){return((o*t+r)*t+n)*t}function h(t){return(3*o*t+2*r)*t+n}return function(t,e=1e-6){return function(t){return((u*t+l)*t+a)*t}(function(t,e){let i,s,n,r,o,a;for(n=t,a=0;a<8;a++){if(r=c(n)-t,Math.abs(r)<e)return n;if(o=h(n),Math.abs(o)<1e-6)break;n-=r/o}if(i=0,s=1,n=t,n<i)return i;if(n>s)return s;for(;i<s;){if(r=c(n),Math.abs(r-t)<e)return n;t>r?i=n:s=n,n=.5*(s-i)+i}return n}(t,e))}}const gW=/^cubic-bezier\((.*)\)/,vW={};function wW(){return[1,0,0,1,0,0]}function bW(t,e,i,s){return s&&i&&!s.equals(i)&&Qh(s,i)&&s.isWebMercator?s.isWebMercator?function(t,e){let i=e[1];return i>89.99999?i=89.99999:i<-89.99999&&(i=-89.99999),i=Math.sin(Xf(i)),My(t,Xf(e[0])*$h.radius,.5*$h.radius*Math.log((1+i)/(1-i)))}(t,e):function(t,e){const i=tp(e[0]/$h.radius);return My(t,i-360*Math.floor((i+180)/360),tp(.5*Math.PI-2*Math.atan(Math.exp(-e[1]/$h.radius))))}(t,e):by(t,e)}function MW(t){return t.wkid?t:t.spatialReference||Lh.WGS84}function SW(t,e){return e.type?My(t,e.x,e.y):by(t,e)}function xW(t){return Rm(t)}function kW(t,e){return Math.max(t.width/e[0],t.height/e[1])*function(t){return Fh(t)?39.37*xW(t)*96:1}(t.spatialReference)}async function IW(t,e,i,s){let n,r;if(!t)return null;if(Array.isArray(t)&&!t.length)return null;if(Jr.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&"object"==typeof t[0]){const n=t.every((t=>"attributes"in t)),r=t.some((t=>!t.geometry));let o=t;if(n&&r&&e&&e.allLayerViews){const i=new Map;for(const e of t){const t=e.layer,s=i.get(t)||[],n=e.attributes[t.objectIdField];null!=n&&s.push(n),i.set(t,s)}const s=[];i.forEach(((t,i)=>{const n=e.allLayerViews.find((t=>t.layer.id===i.id));if("queryFeatures"in n){const e=i.createQuery();e.objectIds=t,e.returnGeometry=!0,s.push(n.queryFeatures(e))}}));const n=await Promise.all(s),r=[];for(const t of n)if(t&&t.features&&t.features.length)for(const e of t.features)u(e.geometry)&&r.push(e.geometry);o=r}for(const t of o)s=await IW(t,e,i,s);return s}if(Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1])n=new ad(t);else if(t instanceof Dh)n=t;else if("geometry"in t)if(t.geometry)n=t.geometry;else if(t.layer){const i=t.layer,s=e.allLayerViews.find((t=>t.layer.id===i.id));if("queryFeatures"in s){const e=i.createQuery();e.objectIds=[t.attributes[i.objectIdField]],e.returnGeometry=!0,n=I(await s.queryFeatures(e),"features",0,"geometry")}}if(c(n))return null;if(r="point"===n.type?new Ld({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference}):n.extent,!r)return null;const o=Kh(r,i);return c(o)?null:s=s?s.union(o):o}function jW(t,e){const i=t.targetGeometry,s=e.targetGeometry;return i.x=s.x,i.y=s.y,i.spatialReference=s.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function _W(t,e,i){return i?My(t,.5*(e[0]-i.right+i.left),.5*(e[1]-i.bottom+i.top)):jy(t,e,.5)}vW.ease=mW(.25,.1,.25,1),vW.linear=mW(0,0,1,1),vW.easeIn=vW["ease-in"]=mW(.42,0,1,1),vW.easeOut=vW["ease-out"]=mW(0,0,.58,1),vW.easeInOut=vW["ease-in-out"]=mW(.42,0,.58,1),Object.freeze({__proto__:null,create:wW,clone:function(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]},fromValues:function(t,e,i,s,n,r){return[t,e,i,s,n,r]},createView:function(t,e){return new Float64Array(t,e,6)}});const TW=function(){const t=[0,0];return function(e,i,s){const n=i.targetGeometry;SW(t,n);const r=.5*FW(i);return e.xmin=t[0]-r*s[0],e.ymin=t[1]-r*s[1],e.xmax=t[0]+r*s[0],e.ymax=t[1]+r*s[1],e.spatialReference=n.spatialReference,e}}(),OW=function(){const t=[0,0];return function(e,i,s){return Ry(e,function(t,e){return jy(t,e,.5)}(e,i),_W(t,i,s))}}(),AW=function(){const t=[1,0,0,1,0,0],e=[0,0];return function(i,s,n,r){const o=FW(s),a=CW(s);return My(e,o,o),yV(t,e),hV(t,t,a),fV(t,t,OW(e,n,r)),fV(t,t,[0,r.top-r.bottom]),My(i,t[4],t[5])}}();function FW(t){return t.scale*function(t){return u(t)&&Fh(t.spatialReference)?1/(39.37*xW(t.spatialReference)*96):1}(t.targetGeometry)}function CW(t){return Xf(t.rotation)||0}const PW=function(){const t=[0,0],e=[0,0],i=[0,0];return function(s,n,r,o,a,l){return Fy(t,n),jy(e,r,.5*l),My(i,1/o*l,-1/o*l),lV(s),fV(s,s,e),a&&hV(s,s,a),dV(s,s,i),fV(s,s,t),s}}(),EW=function(){const t=[0,0];return function(e,i,s,n){const r=FW(i),o=CW(i);return SW(t,i.targetGeometry),PW(e,t,s,r,o,n)}}(),LW=function(){const t=[0,0];return function(e,i,s,n){const r=FW(i);return SW(t,i.targetGeometry),PW(e,t,s,r,0,n)}}();function RW(t){if(t.isWrappable){const e=Sh(t);return e.valid[1]-e.valid[0]}return 0}const NW=function(){const t=[0,0],e=[0,0],i=[0,0,0];return function(s,n,r){xy(t,s,n),Cy(t,t),xy(e,s,r),Cy(e,e),Ey(i,t,e);let o=57.29577951308232*Math.acos(Py(t,e)/(Oy(t)*Oy(e)));return i[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),DW=function(){const t=[0,0];return function(e,i,s,n){const r=e.targetGeometry;return jW(e,i),AW(t,i,s,n),r.x+=t[0],r.y+=t[1],e}}(),VW=function(){const t=[0,0];return function(e,i,s){jW(e,i);const n=e.targetGeometry,r=MW(s),o=MW(n);return SW(t,s),bW(t,t,r,o),n.x=t[0],n.y=t[1],e}}(),$W=function(){const t=[0,0];return function(e,i,s,n,r){r||(r="center"),Ry(t,s,n),jy(t,t,.5);const o=t[0],a=t[1];switch(r){case"center":My(t,0,0);break;case"left":My(t,-o,0);break;case"top":My(t,0,a);break;case"right":My(t,o,0);break;case"bottom":My(t,0,-a);break;case"top-left":My(t,-o,a);break;case"bottom-left":My(t,-o,-a);break;case"top-right":My(t,o,a);break;case"bottom-right":My(t,o,-a)}return JW(e,i,t),e}}();function zW(t,e,i){return jW(t,e),t.rotation+=i,t}const GW=function(){const t=[0,0];return function(e,i,s,n,r){return jW(e,i),isNaN(s)||0===s||(WW(t,n,i,r),e.scale=i.scale*s,HW(t,t,e,r),JW(e,e,My(t,t[0]-n[0],n[1]-t[1]))),e}}();function UW(t,e,i){return jW(t,e),t.scale=i,t}const qW=function(){const t=[0,0];return function(e,i,s,n,r,o){return jW(e,i),isNaN(s)||0===s||(WW(t,r,i,o),e.scale=i.scale*s,e.rotation+=n,HW(t,t,e,o),JW(e,e,My(t,t[0]-r[0],r[1]-t[1]))),e}}(),BW=function(){const t=[0,0],e=[0,0];return function(i,s,n,r,o,a,l){return OW(e,a,l),Sy(t,o,e),r?qW(i,s,n,r,t,a):GW(i,s,n,t,a)}}(),WW=function(){const t=[1,0,0,1,0,0];return function(e,i,s,n){return Ly(e,i,function(t,e,i){return EW(t,e,i,1),uV(t,t)}(t,s,n))}}(),HW=function(){const t=[1,0,0,1,0,0];return function(e,i,s,n){return Ly(e,i,EW(t,s,n,1))}}(),JW=function(){const t=[0,0],e=[1,0,0,1,0,0];return function(i,s,n){jW(i,s);const r=FW(s),o=i.targetGeometry;return pV(e,CW(s)),dV(e,e,Dy(r,r)),Ly(t,n,e),o.x+=t[0],o.y+=t[1],i}}();class ZW{constructor(t,e,i,s){const n=t.targetGeometry,r=e.targetGeometry;s?"string"==typeof s&&(s=function(t){let e=vW[t]||null;if(!e){const i=gW.exec(t);if(i){const t=i[1].split(",").map((t=>parseFloat(t.trim())));4!==t.length||t.some((t=>isNaN(t)))||(e=mW.apply(mW,t))}}return e}(s)||vW.ease):s=vW.ease,this.easing=s,this.duration=i,this.sCenterX=n.x,this.sCenterY=n.y,this.sScale=t.scale,this.sRotation=t.rotation,this.tCenterX=r.x,this.tCenterY=r.y,this.tScale=e.scale,this.tRotation=e.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(t,e){const i=this.easing(e);let s,n,r,o;e>=1?(s=this.tCenterX,n=this.tCenterY,r=this.tRotation,o=this.tScale):(s=this.sCenterX+i*this.dCenterX,n=this.sCenterY+i*this.dCenterY,r=this.sRotation+i*this.dRotation,o=this.sScale+i*this.dScale),t.targetGeometry.x=s,t.targetGeometry.y=n,t.scale=o,t.rotation=r}}let QW=class extends Ar{constructor(t){super(t),this.duration=200,this.transition=null,this.easing=vW.ease,this.view=null,this.viewpoint=null,this.viewpoint=new i$({targetGeometry:new ad,scale:0,rotation:0}),this._updateTask=Us({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask.remove(),this._updateTask=null}animate(t,e,i){this.stop(),jW(this.viewpoint,e),this.transition=new ZW(this.viewpoint,t.target,i&&i.duration||this.duration,i&&i.easing||this.easing);const s=()=>{this.animation===t&&this._updateTask&&("finished"===t.state&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return t.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=t,t}animateContinous(t,e){this.stop(),this.updateFunction=e,this.viewpoint=t;const i=new yW({target:t.clone()}),s=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(t){const e=this.animation;if(e&&e.state!==yW.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,t.deltaTime);else{const t=(performance.now()-this._startTime)/this.transition.duration,e=t>=1;this.transition.applyRatio(this.viewpoint,t),e&&this.animation.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};e([Hn()],QW.prototype,"animation",void 0),e([Hn()],QW.prototype,"duration",void 0),e([Hn()],QW.prototype,"transition",void 0),e([Hn()],QW.prototype,"easing",void 0),e([Hn()],QW.prototype,"view",void 0),e([Hn()],QW.prototype,"viewpoint",void 0),QW=e([_r("esri.views.2d.AnimationManager")],QW);const KW=QW;class YW{constructor(t){this.view=t,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.updateEnabled=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions},this.update=()=>{if(this._updateRequested=!1,!this.updateEnabled)return;const{basemapView:t,graphicsView:e,labelManager:i,layerViews:s,state:{id:n}}=this.view;t.baseLayerViews.forEach(this._updateLayerView,this),s.forEach(this._updateLayerView,this),t.referenceLayerViews.forEach(this._updateLayerView,this),u(i)&&(i.lastUpdateId!==n&&(i.viewChange(),i.lastUpdateId=n),i.updateRequested&&i.processUpdate(this._updateParameters)),u(e)&&(e.lastUpdateId!==n&&(e.viewChange(),e.lastUpdateId=n),e.updateRequested&&e.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause()}}destroy(){this.stop()}start(){this.stationary=this.view.stationary,this._updateParameters={state:this.view.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:this.view.renderingOptions},this._stationaryHandle=this.view.watch("stationary",(t=>{this.stationary=t,this.requestFrame()})),this._frameTaskHandle=Us(this)}stop(){this._frameTaskHandle&&(this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(t){const e=this.view.state,i=t.lastUpdateId;null!=i&&(this.stationary||t.moving)||(t.moving=!0,t.moveStart()),i!==e.id&&t.viewChange(),this.stationary&&t.moving&&(t.moving=!1,t.moveEnd()),t.lastUpdateId=e.id,t.updateRequested&&t.processUpdate(this._updateParameters),"layerViews"in t&&t.layerViews.forEach(this._updateLayerView,this)}}function XW(){return Promise.all([import("./p-8298edc6.js"),import("./p-2f4bee32.js")])}const tH=()=>XW().then((()=>import("./p-9f7ef109.js"))),eH=()=>XW().then((()=>import("./p-121d0deb.js"))),iH={"base-dynamic":()=>XW().then((()=>import("./p-0448574b.js"))),"base-tile":tH,"bing-maps":tH,csv:eH,"geo-rss":()=>XW().then((()=>import("./p-b61f5e0a.js"))),feature:eH,geojson:eH,graphics:()=>XW().then((()=>import("./p-c82bf2b2.js"))),group:()=>XW().then((()=>import("./p-ef3b2ea6.js"))),imagery:()=>XW().then((()=>import("./p-8e7a50cd.js"))),"imagery-tile":()=>XW().then((()=>import("./p-d835e67c.js"))),kml:()=>XW().then((()=>import("./p-3248c900.js"))),"map-image":()=>XW().then((()=>import("./p-ed6efa59.js"))),"map-notes":()=>XW().then((()=>import("./p-87c454ff.js"))),"ogc-feature":()=>XW().then((()=>import("./p-5e00ef0f.js"))),"open-street-map":tH,route:()=>XW().then((()=>import("./p-51d9880c.js"))),stream:()=>XW().then((()=>import("./p-0a0ec5b8.js"))),"subtype-group":()=>XW().then((()=>import("./p-0a1e6c50.js"))),tile:tH,"vector-tile":()=>XW().then((()=>import("./p-d9b3ce35.js"))),wcs:()=>XW().then((()=>import("./p-d835e67c.js"))),"web-tile":tH,wfs:eH,wms:()=>XW().then((()=>import("./p-37218cc7.js"))),wmts:()=>XW().then((()=>import("./p-47830a73.js"))),analysis:null,"base-elevation":null,"building-scene":null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};var sH;const nH=ct.getLogger("esri.views.MapView");let rH=sH=class extends Ar{constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){return c(this.geometry)||!this.spatialReference?null:this.spatialReference.equals(this.geometry.spatialReference)?this.geometry:Qh(this.geometry,this.spatialReference)?Kh(this.geometry,this.spatialReference):Tv()?Av(this.geometry,this.spatialReference):(nH.error("#constraints.geometry","unsupported coordinate system. The source geometry cannot be projected to the view's coordinate system. The projection engine cannot be loaded.",{geometry:this.geometry}),null)}constrain(t,e){if(c(this.normalizedGeometry))return t;const i=t.targetGeometry;if("extent"===this.normalizedGeometry.type?ud(this.normalizedGeometry,i):pd(this.normalizedGeometry,i))return t;const{coordinate:s}=function(t,e){const{spatialReference:i}=e,s=[e.x,e.y];let n=1/0,r=0,o=0;const a=[0,0],l="extent"===t.type?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:t.rings;for(const t of l)for(let e=0;e<t.length-1;e++){Sg(a,s,t,e);const i=_y(s,a);i<n&&(n=i,r=a[0],o=a[1])}return{coordinate:new ad({x:r,y:o,spatialReference:i}),distance:n}}(this.normalizedGeometry,i);return s?(t.targetGeometry=s,t):t}clone(){var t,e;return new sH({geometry:null==(t=this.geometry)?void 0:t.clone(),spatialReference:null==(e=this.spatialReference)?void 0:e.clone()})}};var oH;e([Hn({constructOnly:!0})],rH.prototype,"geometry",void 0),e([Hn({readOnly:!0})],rH.prototype,"normalizedGeometry",null),e([Hn({constructOnly:!0})],rH.prototype,"spatialReference",void 0),rH=sH=e([_r("esri.views.2d.constraints.GeometryConstraint")],rH);let aH=oH=class extends Ar{constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e?(this.rotationEnabled||(t.rotation=e.rotation),t):t}clone(){return new oH({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};e([Hn()],aH.prototype,"enabled",void 0),e([Hn()],aH.prototype,"rotationEnabled",void 0),aH=oH=e([_r("esri.views.2d.constraints.RotationConstraint")],aH);const lH=aH;var uH;let cH=uH=class extends Ar{constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:i,maxScale:s,minZoom:n,maxZoom:r}=this,o=-1,a=-1,l=!1,u=!1;if(0!==i&&0!==s&&i<s&&([i,s]=[s,i]),!e||!e.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",s);e=e.map((t=>t.clone())),e.sort(((t,e)=>e.scale-t.scale)),e.forEach(((t,e)=>t.level=e));for(const n of e)!l&&i>0&&i>=n.scale&&(o=n.level,l=!0),!u&&s>0&&s>=n.scale&&(a=t?t.level:-1,u=!0),t=n;-1===n&&(n=0===i?0:o),-1===r&&(r=0===s?e.length-1:a),n=Math.max(n,0),n=Math.min(n,e.length-1),r=Math.max(r,0),r=Math.min(r,e.length-1),n>r&&([n,r]=[r,n]),i=e[n].scale,s=e[r].scale,e.splice(0,n),e.splice(r-n+1,e.length),e.forEach(((t,e)=>{this._lodByScale[t.scale]=t,this._scales[e]=t.scale})),this._set("effectiveLODs",e),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",r),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",s)}constrain(t,e){if(e&&t.scale===e.scale)return t;const i=this.effectiveMinScale,s=this.effectiveMaxScale,n=t.targetGeometry,r=e&&e.targetGeometry,o=0!==i&&t.scale>i;if(0!==s&&t.scale<s||o){const a=o?i:s;if(r){const i=(a-e.scale)/(t.scale-e.scale);n.x=r.x+(n.x-r.x)*i,n.y=r.y+(n.y-r.y)*i}t.scale=a}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale);return t.scale=this.zoomToScale(Math.abs(e-Math.floor(e))>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;const e=this._scales;if((t=Math.max(0,t-=this.effectiveMinZoom))<=0)return e[0];if(t>=e.length)return e[e.length-1];const i=Math.round(t-.5),s=Math.round(t);return e[s]+(s-t)*(e[i]-e[s])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let i,s;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let n=0;n<e.length-1;n++){if(i=e[n],s=e[n+1],s===t)return n+this.effectiveMinZoom+1;if(i>t&&s<t)return n+this.effectiveMinZoom+1-(t-s)/(i-s)}}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i-1)}clone(){return new uH({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce(((e,i)=>Math.abs(i-t)<=Math.abs(e-t)?i:e),this._scales[0])),this._lodByScale[t].scale}};e([Hn({readOnly:!0})],cH.prototype,"effectiveLODs",void 0),e([Hn({readOnly:!0})],cH.prototype,"effectiveMinZoom",void 0),e([Hn({readOnly:!0})],cH.prototype,"effectiveMaxZoom",void 0),e([Hn({readOnly:!0})],cH.prototype,"effectiveMinScale",void 0),e([Hn({readOnly:!0})],cH.prototype,"effectiveMaxScale",void 0),e([Hn({type:[kw]})],cH.prototype,"lods",void 0),e([Hn()],cH.prototype,"minZoom",void 0),e([Hn()],cH.prototype,"maxZoom",void 0),e([Hn()],cH.prototype,"minScale",void 0),e([Hn()],cH.prototype,"maxScale",void 0),e([Hn()],cH.prototype,"snapToZoom",void 0),cH=uH=e([_r("esri.views.2d.constraints.ZoomConstraint")],cH);const hH=cH,dH={base:null,key:"type",typeMap:{extent:Ld,polygon:Xg}};let fH=class extends Cr.EventedAccessor{constructor(){super(...arguments),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0}initialize(){this.watch(["_zoom","_rotation"],this.emit.bind(this,"update"),!0)}destroy(){this.view=null,this._set("_zoom",null),this._set("_rotation",null)}set geometry(t){this._set("geometry",t||null)}get _defaultLODs(){const t=this.get("view.defaultsFromMap.tileInfo"),e=this.get("view.spatialReference");return t&&e&&t.spatialReference.equals(e)?t.lods:null}get _geometry(){return new rH({geometry:this.geometry,spatialReference:this.view.spatialReference})}get _rotation(){return new lH({rotationEnabled:this.rotationEnabled})}get _zoom(){return new hH({lods:this.lods||this._defaultLODs,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})}canZoomInTo(t){const e=this.effectiveMaxScale;return 0===e||t>=e}canZoomOutTo(t){const e=this.effectiveMinScale;return 0===e||t<=e}constrain(t,e){return this._zoom.constrain(t,e),this._rotation.constrain(t,e),this._geometry.constrain(t,e),t}constrainByGeometry(t){return this._geometry.constrain(t)}fit(t){return this._zoom.fit(t)}zoomToScale(t){return this._zoom.zoomToScale(t)}scaleToZoom(t){return this._zoom.scaleToZoom(t)}snapScale(t){return this._zoom.snapToClosestScale(t)}snapToNextScale(t){return this._zoom.snapToNextScale(t)}snapToPreviousScale(t){return this._zoom.snapToPreviousScale(t)}};e([Hn({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],fH.prototype,"effectiveLODs",void 0),e([Hn({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],fH.prototype,"effectiveMinScale",void 0),e([Hn({readOnly:!0,aliasOf:"_zoom.effectiveMaxScale"})],fH.prototype,"effectiveMaxScale",void 0),e([Hn({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],fH.prototype,"effectiveMinZoom",void 0),e([Hn({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],fH.prototype,"effectiveMaxZoom",void 0),e([Hn({types:dH,value:null})],fH.prototype,"geometry",null),e([Hn({type:[kw]})],fH.prototype,"lods",void 0),e([Hn()],fH.prototype,"minScale",void 0),e([Hn()],fH.prototype,"maxScale",void 0),e([Hn()],fH.prototype,"minZoom",void 0),e([Hn()],fH.prototype,"maxZoom",void 0),e([Hn()],fH.prototype,"rotationEnabled",void 0),e([Hn()],fH.prototype,"snapToZoom",void 0),e([Hn()],fH.prototype,"view",void 0),e([Hn()],fH.prototype,"_defaultLODs",null),e([Hn({type:rH})],fH.prototype,"_geometry",null),e([Hn({type:lH})],fH.prototype,"_rotation",null),e([Hn({readOnly:!0,type:hH})],fH.prototype,"_zoom",null),fH=e([_r("esri.views.2d.MapViewConstraints")],fH);const pH=fH;function yH(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function mH(t,e,i,s,n,r,o,a,l,u){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t[4]=r,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t}function gH(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function vH(t,e){if(t===e){const i=e[1],s=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=s,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function wH(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=i[0],f=i[1],p=i[2],y=i[3],m=i[4],g=i[5],v=i[6],w=i[7],b=i[8];return t[0]=d*s+f*o+p*u,t[1]=d*n+f*a+p*c,t[2]=d*r+f*l+p*h,t[3]=y*s+m*o+g*u,t[4]=y*n+m*a+g*c,t[5]=y*r+m*l+g*h,t[6]=v*s+w*o+b*u,t[7]=v*n+w*a+b*c,t[8]=v*r+w*l+b*h,t}function bH(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=i[0],f=i[1];return t[0]=s,t[1]=n,t[2]=r,t[3]=o,t[4]=a,t[5]=l,t[6]=d*s+f*o+u,t[7]=d*n+f*a+c,t[8]=d*r+f*l+h,t}function MH(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=Math.sin(i),f=Math.cos(i);return t[0]=f*s+d*o,t[1]=f*n+d*a,t[2]=f*r+d*l,t[3]=f*o-d*s,t[4]=f*a-d*n,t[5]=f*l-d*r,t[6]=u,t[7]=c,t[8]=h,t}function SH(t,e,i){const s=i[0],n=i[1],r=i[2];return t[0]=s*e[0],t[1]=s*e[1],t[2]=s*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=r*e[6],t[7]=r*e[7],t[8]=r*e[8],t}function xH(t,e,i){const s=i[0],n=i[1];return t[0]=s*e[0],t[1]=s*e[1],t[2]=s*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t}function kH(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],f=e[11],p=e[12],y=e[13],m=e[14],g=e[15],v=i*a-s*o,w=i*l-n*o,b=i*u-r*o,M=s*l-n*a,S=s*u-r*a,x=n*u-r*l,k=c*y-h*p,I=c*m-d*p,j=c*g-f*p,_=h*m-d*y,T=h*g-f*y,O=d*g-f*m;let A=v*O-w*T+b*_+M*j-S*I+x*k;return A?(A=1/A,t[0]=(a*O-l*T+u*_)*A,t[1]=(l*j-o*O-u*I)*A,t[2]=(o*T-a*j+u*k)*A,t[3]=(n*T-s*O-r*_)*A,t[4]=(i*O-n*j+r*I)*A,t[5]=(s*j-i*T-r*k)*A,t[6]=(y*x-m*S+g*M)*A,t[7]=(m*b-p*x-g*w)*A,t[8]=(p*S-y*b+g*v)*A,t):null}function IH(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}function jH(t){const e=Kf,i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8];return Math.abs(1-(i*i+r*r+l*l))<=e&&Math.abs(1-(s*s+o*o+u*u))<=e&&Math.abs(1-(n*n+a*a+c*c))<=e}function _H(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function TH(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function OH(){return new Float32Array(2)}function AH(t,e){const i=new Float32Array(2);return i[0]=t,i[1]=e,i}function FH(){return OH()}function CH(){return AH(1,1)}function PH(){return AH(1,0)}function EH(){return AH(0,1)}Object.freeze({__proto__:null,fromMat4:yH,copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},set:mH,identity:gH,transpose:vH,invert:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*o-a*u,d=-c*r+a*l,f=u*r-o*l;let p=i*h+s*d+n*f;return p?(p=1/p,t[0]=h*p,t[1]=(-c*s+n*u)*p,t[2]=(a*s-n*o)*p,t[3]=d*p,t[4]=(c*i-n*l)*p,t[5]=(-a*i+n*r)*p,t[6]=f*p,t[7]=(-u*i+s*l)*p,t[8]=(o*i-s*r)*p,t):null},adjoint:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t[0]=o*c-a*u,t[1]=n*u-s*c,t[2]=s*a-n*o,t[3]=a*l-r*c,t[4]=i*c-n*l,t[5]=n*r-i*a,t[6]=r*u-o*l,t[7]=s*l-i*u,t[8]=i*o-s*r,t},determinant:function(t){const e=t[3],i=t[4],s=t[5],n=t[6],r=t[7],o=t[8];return t[0]*(o*i-s*r)+t[1]*(-o*e+s*n)+t[2]*(r*e-i*n)},multiply:wH,translate:bH,rotate:MH,scale:SH,scaleByVec2:xH,fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},fromRotation:function(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=0,t[3]=-i,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromScaling:function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat2d:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},fromQuat:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=i+i,a=s+s,l=n+n,u=i*o,c=s*o,h=s*a,d=n*o,f=n*a,p=n*l,y=r*o,m=r*a,g=r*l;return t[0]=1-h-p,t[3]=c-g,t[6]=d+m,t[1]=c+g,t[4]=1-u-p,t[7]=f-y,t[2]=d-m,t[5]=f+y,t[8]=1-u-h,t},normalFromMat4Legacy:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10],h=c*o-a*u,d=-c*r+a*l,f=u*r-o*l,p=i*h+s*d+n*f;if(!p)return null;const y=1/p;return t[0]=h*y,t[1]=(-c*s+n*u)*y,t[2]=(a*s-n*o)*y,t[3]=d*y,t[4]=(c*i-n*l)*y,t[5]=(-a*i+n*r)*y,t[6]=f*y,t[7]=(-u*i+s*l)*y,t[8]=(o*i-s*r)*y,t},normalFromMat4:kH,projection:function(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},str:function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},frob:function(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)},add:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t},subtract:IH,multiplyScalar:function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t},multiplyScalarAndAdd:function(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t[3]=e[3]+i[3]*s,t[4]=e[4]+i[4]*s,t[5]=e[5]+i[5]*s,t[6]=e[6]+i[6]*s,t[7]=e[7]+i[7]*s,t[8]=e[8]+i[8]*s,t},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},equals:function(t,e){const i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=e[0],d=e[1],f=e[2],p=e[3],y=e[4],m=e[5],g=e[6],v=e[7],w=e[8];return Math.abs(i-h)<=Kf*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(s-d)<=Kf*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(n-f)<=Kf*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(r-p)<=Kf*Math.max(1,Math.abs(r),Math.abs(p))&&Math.abs(o-y)<=Kf*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(a-m)<=Kf*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(l-g)<=Kf*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-v)<=Kf*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-w)<=Kf*Math.max(1,Math.abs(c),Math.abs(w))},isOrthoNormal:jH,mul:wH,sub:IH}),Object.freeze({__proto__:null,create:_H,clone:TH,fromValues:function(t,e,i,s,n,r,o,a,l){const u=new Float32Array(9);return u[0]=t,u[1]=e,u[2]=i,u[3]=s,u[4]=n,u[5]=r,u[6]=o,u[7]=a,u[8]=l,u},createView:function(t,e){return new Float32Array(t,e,9)}});const LH=FH(),RH=CH(),NH=PH(),DH=EH();function VH(t){return function(t){return t instanceof Float32Array&&t.length>=2}(t)||function(t){return Array.isArray(t)&&t.length>=2}(t)}var $H;Object.freeze({__proto__:null,create:OH,clone:function(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e},fromValues:AH,createView:function(t,e){return new Float32Array(t,e,2)},zeros:FH,ones:CH,unitX:PH,unitY:EH,ZEROS:LH,ONES:RH,UNIT_X:NH,UNIT_Y:DH});const zH=[0,0];let GH=$H=class extends lh{constructor(t){super(t),this._viewpoint2D={center:[0,0],rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new Ld,this.id=0,this.inverseTransform=[1,0,0,1,0,0],this.resolution=0,this.rotation=0,this.scale=0,this.transform=[1,0,0,1,0,0],this.transformNoRotation=[1,0,0,1,0,0],this.displayMat3=_H(),this.displayViewMat3=_H(),this.viewMat3=_H(),this.viewMat2d=rV(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}copy(t){const e=this.size,i=this.viewpoint;return i&&e?(this.viewpoint=jW(i,t.viewpoint),this._set("size",by(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new $H({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,i){return VH(e)?Ly(t,e,this.inverseTransform):(zH[0]=e,zH[1]=i,Ly(t,zH,this.inverseTransform))}toScreen(t,e,i){return VH(e)?Ly(t,e,this.transform):(zH[0]=e,zH[1]=i,Ly(t,zH,this.transform))}toScreenNoRotation(t,e,i){return VH(e)?Ly(t,e,this.transformNoRotation):(zH[0]=e,zH[1]=i,Ly(t,zH,this.transformNoRotation))}getScreenTransform(t,e){const{center:i}=this._viewpoint2D,s=this._get("pixelRatio")||1,n=this._get("size");return PW(t,i,n,e,0,s),t}_update(){const{center:t,spatialReference:e,scale:i,rotation:s}=this._viewpoint2D,n=this._get("pixelRatio")||1,r=this._get("size"),o=new i$({targetGeometry:new ad(t[0],t[1],e),scale:i,rotation:s});if(this._set("viewpoint",o),!r||!e||!i)return;this.resolution=FW(o),this.rotation=s,this.scale=i,this.spatialReference=e,by(this.center,t),mH(this.displayMat3,0!==r[0]?2/r[0]:0,0,0,0,0!==r[1]?-2/r[1]:0,0,-1,1,1);const a=gH(this.viewMat3),l=AH(r[0]/2,r[1]/2),u=AH(-r[0]/2,-r[1]/2),c=Xf(s);bH(a,a,l),MH(a,a,c),bH(a,a,u),wH(this.displayViewMat3,this.displayMat3,a);const h=lV(this.viewMat2d);return fV(h,h,l),hV(h,h,c),fV(h,h,u),TW(this.extent,o,r),EW(this.transform,o,r,n),uV(this.inverseTransform,this.transform),LW(this.transformNoRotation,o,r,n),this.worldScreenWidth=function(t,e){return Math.round(RW(t)/e)}(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};e([Hn({readOnly:!0})],GH.prototype,"id",void 0),e([Hn({value:1,json:{write:!0}})],GH.prototype,"pixelRatio",null),e([Hn({json:{write:!0}})],GH.prototype,"size",null),e([Hn({type:i$,json:{write:!0}})],GH.prototype,"viewpoint",null),GH=$H=e([_r("esri.views.2d.ViewState")],GH);const UH=GH;let qH=class extends Ar{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}};e([Hn()],qH.prototype,"left",void 0),e([Hn()],qH.prototype,"top",void 0),e([Hn()],qH.prototype,"right",void 0),e([Hn()],qH.prototype,"bottom",void 0),qH=e([_r("esri.views.2d.PaddedViewState.Padding")],qH);let BH=class extends UH{constructor(...t){super(...t),this.paddedViewState=new UH,this._updateContent=(()=>{const t=[0,0];return()=>{const e=this._get("size"),i=this._get("padding");if(!e||!i)return;const s=this.paddedViewState;My(t,i.left+i.right,i.top+i.bottom),xy(t,e,t),by(s.size,t);const n=s.viewpoint;n&&(this.viewpoint=n)}})(),this.watch(["size","padding"],this._updateContent,!0),this.padding=new qH,this.size=[0,0]}set padding(t){this._set("padding",t||new qH)}set viewpoint(t){if(t){const e=t.clone();this.paddedViewState.viewpoint=t,DW(e,t,this._get("size"),this._get("padding"));const i=this._viewpoint2D,s=e.targetGeometry;i.center[0]=s.x,i.center[1]=s.y,i.rotation=e.rotation,i.scale=e.scale,i.spatialReference=s.spatialReference,this._update()}}};e([Hn()],BH.prototype,"paddedViewState",void 0),e([Hn({type:qH})],BH.prototype,"padding",null),e([Hn()],BH.prototype,"viewpoint",null),BH=e([_r("esri.views.2d.PaddedViewState")],BH);const WH=BH;class HH{constructor(t,e){this.item=t,this.controller=e,this.promise=null}}class JH{constructor(t){this._deferreds=new Map,this._controllers=new Map,this._processingItems=new Map,this._isPaused=!1,this._schedule=null,this._task=null,this.concurrency=1,t.concurrency&&(this.concurrency=t.concurrency),this._queue=new Iq(t.peeker),this.process=t.process;const e=t.scheduler;t.priority&&u(e)&&(this._task=e.registerTask(t.priority,this))}destroy(){this.clear(),this._schedule&&(this._schedule.remove(),this._schedule=null),this._task&&(this._task.remove(),this._task=null)}get length(){return this._processingItems.size+this._queue.length}abort(t){const e=this._controllers.get(t);e&&e.abort()}clear(){this._queue.clear();const t=[];this._controllers.forEach((e=>t.push(e))),this._controllers.clear(),t.forEach((t=>t.abort())),this._processingItems.clear(),this._cancelNext()}forEach(t){this._deferreds.forEach(((e,i)=>t(i)))}get(t){const e=this._deferreds.get(t);return e?e.promise:void 0}isOngoing(t){return this._processingItems.has(t)}has(t){return this._deferreds.has(t)}pause(){this._isPaused||(this._isPaused=!0,this._cancelNext())}push(t,e){const i=this.get(t);if(i)return i;const s=new AbortController;let n=null;e&&(n=Ve(e,(()=>s.abort())));const r=()=>{o.remove(),u(n)&&n.remove(),this._deferreds.delete(t),this._controllers.delete(t),this._queue.remove(t),this._processingItems.delete(t),this._scheduleNext()},o=$e(s.signal,(()=>{const e=this._processingItems.get(t);e&&e.controller.abort(),r(),a.reject(Pe())})),a=qe();return this._deferreds.set(t,a),this._controllers.set(t,s),a.promise.then(r,r),this._queue.push(t),this._scheduleNext(),a.promise}last(){return this._queue.last()}peek(){return this._queue.peek()}popLast(){return this._queue.popLast()}reset(){const t=[];this._processingItems.forEach((e=>t.push(e))),this._processingItems.clear();for(const e of t)this._queue.push(e.item),e.controller.abort();this._scheduleNext()}resume(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())}takeAll(){const t=[];for(;this._queue.length;)t.push(this._queue.pop());return this.clear(),t}get running(){return!this._isPaused&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(t){for(;!t.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),t.madeProgress()}_scheduleNext(){this._task||this._isPaused||this._schedule||(this._schedule=Gs((()=>{this._schedule=null,this._next()})))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(t,e){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).resolve(e))}_processError(t,e){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).reject(e))}_canProcessFulfillment(t){return!!this._deferreds.get(t.item)&&this._processingItems.get(t.item)===t}_process(t){if(c(t))return;let e;const i=new AbortController,s=new HH(t,i);this._processingItems.set(t,s);try{e=this.process(t,i.signal)}catch(t){this._processError(s,t)}Qe(e)?(s.promise=e,e.then((t=>this._processResult(s,t)),(t=>this._processError(s,t)))):this._processResult(s,e)}get test(){return{update:t=>this.runTask(t)}}}const ZH=new Set,QH=[],KH=new Map,YH=[0,0];let XH=class extends Ar{constructor(t){super(t),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:t,process:e}=this;this._queue=new JH({concurrency:t,process:(t,i)=>{const s=this._keyToItem.get(t);return e(s,{signal:i})},peeker:t=>t.values().next().value})}destroy(){this.clear(),this._queue.destroy(),this._queue=null}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(t){this._queue.abort("string"==typeof t?t:t.id)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(t){return this._keyToItem.has("string"==typeof t?t:t.id)}isOngoing(t){const e="string"==typeof t?t:t.id;return this.has(e)&&this._queue.isOngoing(e)}pause(){this._queue.pause()}push(t,e){const i=t.key.id+"-"+e;if(this.has(i))return this.get(i);const s=this._queue.push(i),n=()=>{this._keyToItem.delete(i),this.notifyChange("updating")};return this._keyToItem.set(i,t),s.then(n,n),this.notifyChange("updating"),s}reset(){this._queue.reset(),this.notifyChange("updating")}resume(){this._queue.resume()}_peekByScaleFirst(t){if(!this.state)return t.values().next().value;const e=this.tileInfoView;let i=-1/0,s=1/0;t.forEach((t=>{const e=this._keyToItem.get(t),n=this.tileInfoView.getTileScale(e.key);KH.has(n)||(KH.set(n,[]),i=Math.max(n,i),s=Math.min(n,s)),KH.get(n).push(e.key),ZH.add(n)}));let n=this.state.scale;KH.has(n)||(function(t,e){t.length=0,e.forEach((e=>t.push(e)))}(QH,ZH),QH.sort(((t,e)=>t-e)),n=QH.reduce(((t,e)=>Math.abs(e-n)<Math.abs(t-n)?e:t),QH[0])),n=Math.min(n,i),n=Math.max(n,s);const r=KH.get(n),o=e.getClosestInfoForScale(n),a=o.getColumnForX(this.state.center[0]),l=o.getRowForY(this.state.center[1]);return r.sort(((t,e)=>{const i=o.denormalizeCol(t.col,t.world),s=o.denormalizeCol(e.col,e.world);return Math.sqrt((a-i)*(a-i)+(l-t.row)*(l-t.row))-Math.sqrt((a-s)*(a-s)+(l-e.row)*(l-e.row))})),ZH.clear(),KH.clear(),r[0].id}_peekByCenterFirst(t){if(!this.state)return t.values().next().value;const e=this.tileInfoView,i=this.state.center;let s=1/0,n=null;return t.forEach((t=>{const r=this._keyToItem.get(t);e.getTileCoords(YH,r.key);const o=_y(YH,i);o<s&&(s=o,n=r.key)})),n.id}};e([Hn({constructOnly:!0})],XH.prototype,"concurrency",void 0),e([Hn({constructOnly:!0})],XH.prototype,"process",void 0),e([Hn()],XH.prototype,"state",void 0),e([Hn({constructOnly:!0})],XH.prototype,"strategy",void 0),e([Hn({constructOnly:!0})],XH.prototype,"tileInfoView",void 0),e([Hn({readOnly:!0})],XH.prototype,"updating",null),XH=e([_r("esri.views.2d.tiling.PagedTileQueue")],XH);class tJ{constructor(t,e,i,s){this.set(t,e,i,s)}static getId(t,e,i,s){return"object"==typeof t?`${t.level}/${t.row}/${t.col}/${t.world}`:`${t}/${e}/${i}/${s}`}get key(){return this}get id(){return""+this}set id(t){this.set(t)}get hash(){return(3&this.world)<<30|(4095&this.col)<<22|(4095&this.row)<<8|63&this.level}acquire(t,e,i,s){this.set(t,e,i,s)}contains(t){const e=t.level-this.level;return this.row===t.row>>e&&this.col===t.col>>e&&this.world===t.world}equals(t){return this.level===t.level&&this.row===t.row&&this.col===t.col&&this.world===t.world}clone(){return new tJ(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(t,e,i,s){if(null==t)this.level=0,this.row=0,this.col=0,this.world=0;else if("object"==typeof t)this.level=t.level||0,this.row=t.row||0,this.col=t.col||0,this.world=t.world||0;else if("string"==typeof t){const[e,i,s,n]=t.split("/");this.level=parseFloat(e),this.row=parseFloat(i),this.col=parseFloat(s),this.world=parseFloat(n)}else this.level=+t,this.row=+e,this.col=+i,this.world=+s||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new tJ(this.level-1,this.row>>1,this.col>>1,this.world)}getChildKeys(){const t=this.level+1,e=this.row<<1,i=this.col<<1,s=this.world;return[new tJ(t,e,i,s),new tJ(t,e,i+1,s),new tJ(t,e+1,i,s),new tJ(t,e+1,i+1,s)]}compareRowMajor(t){return this.row<t.row?-1:this.row>t.row?1:this.col<t.col?-1:this.col>t.col?1:0}}function eJ(t,e){return[t,e]}function iJ(t,e,i){return t[0]=e,t[1]=i,t}tJ.pool=new Zi(tJ,null,null,25,50);const sJ=new tJ("0/0/0/0");class nJ{constructor(t,e,i,s,n,r,o,a,l,u,c,h){this.level=t,this.resolution=e,this.scale=i,this.origin=s,this.first=n,this.last=r,this.size=o,this.norm=a,this.worldStart=l,this.worldEnd=u,this.worldSize=c,this.wrap=h}static create(t,e,i=null){const s=Sh(t.spatialReference),n=eJ(t.origin.x,t.origin.y),r=eJ(t.size[0]*e.resolution,t.size[1]*e.resolution),o=eJ(-1/0,-1/0),a=eJ(1/0,1/0),l=eJ(1/0,1/0);u(i)&&(iJ(o,Math.max(0,Math.floor((i.xmin-n[0])/r[0])),Math.max(0,Math.floor((n[1]-i.ymax)/r[1]))),iJ(a,Math.max(0,Math.floor((i.xmax-n[0])/r[0])),Math.max(0,Math.floor((n[1]-i.ymin)/r[1]))),iJ(l,a[0]-o[0]+1,a[1]-o[1]+1));const{cols:c,rows:h}=e;let d,f,p,y;return!i&&c&&h&&(iJ(o,0,0),iJ(a,c-1,h-1),iJ(l,c,h)),t.isWrappable?(d=eJ(Math.ceil(Math.round((s.valid[1]-s.valid[0])/e.resolution)/t.size[0]),l[1]),f=eJ(Math.floor((s.origin[0]-n[0])/r[0]),o[1]),p=eJ(d[0]+f[0]-1,a[1]),y=!0):(f=o,p=a,d=l,y=!1),new nJ(e.level,e.resolution,e.scale,n,o,a,l,r,f,p,d,y)}normalizeCol(t){if(!this.wrap)return t;const e=this.worldSize[0];return t<0?e-1-Math.abs((t+1)%e):t%e}denormalizeCol(t,e){return this.wrap?this.worldSize[0]*e+t:t}getWorldForColumn(t){return this.wrap?Math.floor(t/this.worldSize[0]):0}getFirstColumnForWorld(t){return t*this.worldSize[0]+this.first[0]}getLastColumnForWorld(t){return t*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(t){return(t-this.origin[0])/this.norm[0]}getXForColumn(t){return this.origin[0]+t*this.norm[0]}getRowForY(t){return(this.origin[1]-t)/this.norm[1]}getYForRow(t){return this.origin[1]-t*this.norm[1]}getTileBounds(t,e,i=!1){sJ.set(e);const s=i?sJ.col:this.denormalizeCol(sJ.col,sJ.world),n=sJ.row;return function(t,e,i,s,n){t[0]=e,t[1]=i,t[2]=s,t[3]=n}(t,this.getXForColumn(s),this.getYForRow(n+1),this.getXForColumn(s+1),this.getYForRow(n)),t}getTileCoords(t,e,i=!1){sJ.set(e);const s=i?sJ.col:this.denormalizeCol(sJ.col,sJ.world);return Array.isArray(t)?iJ(t,this.getXForColumn(s),this.getYForRow(sJ.row)):(t.x=this.getXForColumn(s),t.y=this.getYForRow(sJ.row)),t}}class rJ{constructor(){this.spans=[]}acquire(t){this.lodInfo=t}release(){this.lodInfo=null,this.spans.length=0}forEach(t,e){const{spans:i,lodInfo:s}=this,{level:n}=s;if(0!==i.length)for(const{row:r,colFrom:o,colTo:a}of i)for(let i=o;i<=a;i++)t.call(e,n,r,s.normalizeCol(i),s.getWorldForColumn(i))}}rJ.pool=new Zi(rJ);class oJ{constructor(t,e,i){this.row=t,this.colFrom=e,this.colTo=i}}const aJ=new tJ("0/0/0/0");class lJ{constructor(t,e,i,s,n,r,o,a){this.x=t,this.ymin=e,this.ymax=i,this.invM=s,this.leftAdjust=n,this.rightAdjust=r,this.leftBound=o,this.rightBound=a}static create(t,e){t[1]>e[1]&&([t,e]=[e,t]);const[i,s]=t,[n,r]=e,o=n-i,a=r-s,l=0!==a?o/a:0,u=(Math.ceil(s)-s)*l,c=(Math.floor(s)-s)*l;return new lJ(i,Math.floor(s),Math.ceil(r),l,o<0?u:c,o<0?c:u,o<0?n:i,o<0?i:n)}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}}const uJ=[[0,0],[0,0],[0,0],[0,0]];class cJ{constructor(t,e=null){this.tileInfo=t,this.fullExtent=e,this.scales=[],this._lodInfos=null,this._infoByScale={},this._infoByLevel={};const i=t.lods.slice();i.sort((function(t,e){return e.scale-t.scale}));const s=this._lodInfos=i.map((i=>nJ.create(t,i,e)));i.forEach(((t,e)=>{this._infoByLevel[t.level]=s[e],this._infoByScale[t.scale]=s[e],this.scales[e]=t.scale}),this),this._wrap=t.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(t){return this._infoByLevel["number"==typeof t?t:t.level]}getTileBounds(t,e,i=!1){aJ.set(e);const s=this._infoByLevel[aJ.level];return s?s.getTileBounds(t,aJ,i):t}getTileCoords(t,e,i=!1){aJ.set(e);const s=this._infoByLevel[aJ.level];return s?s.getTileCoords(t,aJ,i):t}getTileCoverage(t,e=192,i="closest"){const s="closest"===i?this.getClosestInfoForScale(t.scale):this.getSmallestInfoForScale(t.scale),n=rJ.pool.acquire(s),r=this._wrap;let o,a,l,u=1/0,c=-1/0;const h=n.spans;uJ[0][0]=uJ[0][1]=uJ[1][1]=uJ[3][0]=-e,uJ[1][0]=uJ[2][0]=t.size[0]+e,uJ[2][1]=uJ[3][1]=t.size[1]+e;for(const e of uJ)t.toMap(e,e),e[0]=s.getColumnForX(e[0]),e[1]=s.getRowForY(e[1]);const d=[];let f=3;for(let t=0;t<4;t++){if(uJ[t][1]===uJ[f][1]){f=t;continue}const e=lJ.create(uJ[t],uJ[f]);u=Math.min(e.ymin,u),c=Math.max(e.ymax,c),void 0===d[e.ymin]&&(d[e.ymin]=[]),d[e.ymin].push(e),f=t}if(null==u||null==c||c-u>100)return null;let p=[];for(o=u;o<c;){null!=d[o]&&(p=p.concat(d[o])),a=1/0,l=-1/0;for(let t=p.length-1;t>=0;t--){const e=p[t];a=Math.min(a,e.getLeftCol()),l=Math.max(l,e.getRightCol())}if(a=Math.floor(a),l=Math.floor(l),o>=s.first[1]&&o<=s.last[1])if(r)if(s.size[0]<s.worldSize[0]){const t=Math.floor(l/s.worldSize[0]);for(let e=Math.floor(a/s.worldSize[0]);e<=t;e++)h.push(new oJ(o,Math.max(s.getFirstColumnForWorld(e),a),Math.min(s.getLastColumnForWorld(e),l)))}else h.push(new oJ(o,a,l));else a>s.last[0]||l<s.first[0]||(a=Math.max(a,s.first[0]),l=Math.min(l,s.last[0]),h.push(new oJ(o,a,l)));o+=1;for(let t=p.length-1;t>=0;t--){const e=p[t];e.ymax>=o?e.incrRow():p.splice(t,1)}}return n}getTileParentId(t){aJ.set(t);const e=this._lodInfos.indexOf(this._infoByLevel[aJ.level])-1;return e<0?null:(this._getTileIdAtLOD(aJ,this._lodInfos[e],aJ),aJ.id)}getTileResolution(t){const e=this._infoByLevel["object"==typeof t?t.level:t];return e?e.resolution:-1}getTileScale(t){const e=this._infoByLevel[t.level];return e?e.scale:-1}intersects(t,e){aJ.set(e);const i=this._infoByLevel[aJ.level],s=t.lodInfo;if(s.resolution>i.resolution){this._getTileIdAtLOD(aJ,s,aJ);const e=s.denormalizeCol(aJ.col,aJ.world);for(const i of t.spans)if(i.row===aJ.row&&i.colFrom<=e&&i.colTo>=e)return!0}if(s.resolution<i.resolution){const[e,n,r,o]=t.spans.reduce(((t,e)=>(t[0]=Math.min(t[0],e.row),t[1]=Math.max(t[1],e.row),t[2]=Math.min(t[2],e.colFrom),t[3]=Math.max(t[3],e.colTo),t)),[1/0,-1/0,1/0,-1/0]),a=i.denormalizeCol(aJ.col,aJ.world),l=s.getColumnForX(i.getXForColumn(a)),u=s.getRowForY(i.getYForRow(aJ.row)),c=s.getColumnForX(i.getXForColumn(a+1))-1,h=s.getRowForY(i.getYForRow(aJ.row+1))-1;return!(l>o||c<r||u>n||h<e)}const n=s.denormalizeCol(aJ.col,aJ.world);return t.spans.some((t=>t.row===aJ.row&&t.colFrom<=n&&t.colTo>=n))}normalizeBounds(t,e,i){if(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],this._wrap){const e=Sh(this.tileInfo.spatialReference),s=-i*(e.valid[1]-e.valid[0]);t[0]+=s,t[2]+=s}return t}getSmallestInfoForScale(t){const e=this.scales;if(this._infoByScale[t])return this._infoByScale[t];if(t>e[0])return this._infoByScale[e[0]];for(let i=1;i<e.length-1;i++)if(t>e[i]+1e-6)return this._infoByScale[e[i-1]];return this._infoByScale[e[e.length-1]]}getClosestInfoForScale(t){const e=this.scales;return this._infoByScale[t]||(t=e.reduce(((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e),e[0])),this._infoByScale[t]}scaleToLevel(t){const e=this.scales;if(this._infoByScale[t])return this._infoByScale[t].level;for(let i=e.length-1;i>=0;i--)if(t<e[i])return i===e.length-1?this._infoByScale[e[e.length-1]].level:this._infoByScale[e[i]].level+(e[i]-t)/(e[i]-e[i+1]);return this._infoByScale[e[0]].level}scaleToZoom(t){return this.tileInfo.scaleToZoom(t)}_getTileIdAtLOD(t,e,i){const s=this._infoByLevel[i.level];return t.set(i),e.resolution<s.resolution?null:(e.resolution===s.resolution||(t.level=e.level,t.col=Math.floor(i.col*s.resolution/e.resolution+.01),t.row=Math.floor(i.row*s.resolution/e.resolution+.01)),t)}}const hJ=new Set,dJ=[],fJ=new Map,pJ=[0,0];let yJ=class extends Ar{constructor(t){super(t),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:t,process:e,strategy:i}=this;this._queue=new JH({concurrency:t,process:(t,i)=>{const s=this._keyToItem.get(t);return e(s,{signal:i})},peeker:"scale-first"===i?t=>this._peekByScaleFirst(t):t=>this._peekByCenterFirst(t)})}destroy(){this.clear(),this._queue.destroy(),this._queue=null}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(t){this._queue.abort("string"==typeof t?t:t.id)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(t){return this._keyToItem.has("string"==typeof t?t:t.id)}isOngoing(t){const e="string"==typeof t?t:t.id;return this.has(e)&&this._queue.isOngoing(e)}pause(){this._queue.pause()}push(t){const e=t.key.id;if(this._queue.has(e))return this._queue.get(e);const i=this._queue.push(e),s=()=>{this._keyToItem.delete(e),this.notifyChange("updating")};return this._keyToItem.set(e,t),i.then(s,s),this.notifyChange("updating"),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peekByScaleFirst(t){if(!this.state)return t.values().next().value;const e=this.tileInfoView;let i=-1/0,s=1/0;t.forEach((t=>{const e=this._keyToItem.get(t),n=this.tileInfoView.getTileScale(e.key);fJ.has(n)||(fJ.set(n,[]),i=Math.max(n,i),s=Math.min(n,s)),fJ.get(n).push(e.key),hJ.add(n)}));let n=this.state.scale;fJ.has(n)||(function(t,e){t.length=0,e.forEach((e=>t.push(e)))}(dJ,hJ),dJ.sort(((t,e)=>t-e)),n=dJ.reduce(((t,e)=>Math.abs(e-n)<Math.abs(t-n)?e:t),dJ[0])),n=Math.min(n,i),n=Math.max(n,s);const r=fJ.get(n),o=e.getClosestInfoForScale(n),a=o.getColumnForX(this.state.center[0]),l=o.getRowForY(this.state.center[1]);return r.sort(((t,e)=>{const i=o.denormalizeCol(t.col,t.world),s=o.denormalizeCol(e.col,e.world);return Math.sqrt((a-i)*(a-i)+(l-t.row)*(l-t.row))-Math.sqrt((a-s)*(a-s)+(l-e.row)*(l-e.row))})),hJ.clear(),fJ.clear(),r[0].id}_peekByCenterFirst(t){if(!this.state)return t.values().next().value;const e=this.tileInfoView,i=this.state.center;let s=1/0,n=null;return t.forEach((t=>{const r=this._keyToItem.get(t);e.getTileCoords(pJ,r.key);const o=_y(pJ,i);o<s&&(s=o,n=r.key)})),n.id}};e([Hn({constructOnly:!0})],yJ.prototype,"concurrency",void 0),e([Hn({constructOnly:!0})],yJ.prototype,"process",void 0),e([Hn()],yJ.prototype,"state",void 0),e([Hn({constructOnly:!0})],yJ.prototype,"strategy",void 0),e([Hn({constructOnly:!0})],yJ.prototype,"tileInfoView",void 0),e([Hn({readOnly:!0})],yJ.prototype,"updating",null),yJ=e([_r("esri.views.2d.tiling.TileQueue")],yJ);const mJ=yJ;class gJ{constructor(t,e,i){this.maxSize=t,this.tileInfoView=e,this.removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}has(t){return this._tilePerId.has(t)}get(t){return this._tilePerId.get(t)}pop(t){const e=this._tilePerId.get(t);if(!e)return null;const i=this._tileKeysPerLevel[e.key.level];vJ(this._tilePerId,t);for(let e=0;e<i.length;e++)if(i[e].id===t){i.splice(e,1);break}return e.visible=!0,e}add(t){t.visible=!1;const e=t.key,i=e.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,t);const s=e.level;this._tileKeysPerLevel[s]||(this._tileKeysPerLevel[s]=[]),this._tileKeysPerLevel[s].push(e)}prune(t,e,i){let s=this._tilePerId.size;if(s<=this.maxSize)return;let n=this._tileKeysPerLevel.length-1;for(;s>this.maxSize&&n>=0;)n!==t&&(s=this._pruneAroundCenterTile(s,e,i,n)),n--;s>this.maxSize&&(s=this._pruneAroundCenterTile(s,e,i,t))}_pruneAroundCenterTile(t,e,i,s){const n=this._tileKeysPerLevel[s];if(!n||0===n.length)return t;const{size:r,origin:o}=this.tileInfoView.tileInfo,a=i*r[0],l=i*r[1],u=[0,0],c=[0,0];for(n.sort(((t,i)=>(u[0]=o.x+a*(t.col+.5),u[1]=o.y-l*(t.row+.5),c[0]=o.x+a*(i.col+.5),c[1]=o.y-l*(i.row+.5),Ty(u,e)-Ty(c,e))));n.length>0;){const e=n.pop();if(this._removeTile(e.id),--t===this.maxSize)break}return t}_removeTile(t){const e=this._tilePerId.get(t);this.removedFunc&&this.removedFunc(e),vJ(this._tilePerId,t)}}function vJ(t,e){t.delete(e)}const wJ=new tJ(0,0,0,0),bJ=new Map,MJ=[],SJ=[];class xJ{constructor(t){this._previousScale=1/0,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=t.acquireTile,this.releaseTile=t.releaseTile,this.tileInfoView=t.tileInfoView,this.resampling=null==t.resampling||!!t.resampling,t.cachePolicy&&(this.cachePolicy=t.cachePolicy),t.coveragePolicy&&(this.coveragePolicy=t.coveragePolicy),null!=t.buffer&&(this.buffer=t.buffer),t.cacheSize&&(this._tileCache=new gJ(t.cacheSize,this.tileInfoView,(t=>{this.releaseTile(t)})))}destroy(){this.tileIndex.clear()}update(t){const{resampling:e,tileIndex:i}=this,s=this.tileInfoView.getTileCoverage(t.state,this.buffer,this.coveragePolicy);if(SJ.length=0,MJ.length=0,bJ.clear(),!s)return;const{minScale:n,maxScale:r}=this.tileInfoView.tileInfo,{spans:o,lodInfo:a}=s,{level:l}=a,{scale:u,center:c,resolution:h}=t.state,d=!t.stationary&&u>this._previousScale;if(this._previousScale=u,this.tiles.length=0,!e&&(u>n||u<r))return this.tiles.length=0,bJ.clear(),i.forEach((t=>{this.releaseTile(t)})),i.clear(),SJ.length=0,MJ.length=0,bJ.clear(),rJ.pool.release(s),!0;i.forEach((t=>t.visible=!0));let f=0,p=0;if(o.length>0)for(const{row:t,colFrom:e,colTo:s}of o)for(let n=e;n<=s;n++){f++;const e=wJ.set(l,t,a.normalizeCol(n),a.getWorldForColumn(n)).id;if(i.has(e)){const t=i.get(e);t.isReady?(bJ.set(e,t),p++):d||this._addParentTile(e,bJ)}else{let t;if(this._tileCache&&this._tileCache.has(e)){if(t=this._tileCache.pop(e),this.tileIndex.set(e,t),t.isReady){bJ.set(e,t),p++;continue}}else t=this.acquireTile(wJ),this.tileIndex.set(e,t);d||this._addParentTile(e,bJ)}}const y=p===f;i.forEach(((t,e)=>{if(wJ.set(e),bJ.has(e))return;const i=this.tileInfoView.intersects(s,wJ),n="purge"===this.cachePolicy?wJ.level!==l:wJ.level>l;!i||!d&&y?!n&&i||MJ.push(e):t.isReady?n&&"purge"===this.cachePolicy&&this._hasReadyAncestor(wJ,l)?MJ.push(e):SJ.push(e):n&&MJ.push(e)}));for(const t of SJ){const e=i.get(t);e&&e.isReady&&bJ.set(t,e)}for(const t of MJ){const e=i.get(t);this._tileCache?this._tileCache.add(e):this.releaseTile(e),i.delete(t)}return bJ.forEach((t=>this.tiles.push(t))),i.forEach((t=>{bJ.has(t.key.id)||(t.visible=!1)})),this._tileCache&&this._tileCache.prune(l,c,h),rJ.pool.release(s),bJ.clear(),y}clear(t=!0){const{tileIndex:e}=this;t&&e.forEach((t=>{this.releaseTile(t)})),e.clear()}updateCacheSize(t){this._tileCache&&(this._tileCache.maxSize=t)}_addParentTile(t,e){let i=t,s=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(s=this.tileIndex.get(i),s&&s.isReady){e.has(s.key.id)||e.set(s.key.id,s);break}}else if(this._tileCache&&this._tileCache.has(i)&&(s=this._tileCache.pop(i),this.tileIndex.set(i,s),s&&s.isReady)){e.has(s.key.id)||e.set(s.key.id,s);break}}_hasReadyAncestor(t,e){const i=sv();this.tileInfoView.getTileBounds(i,t,!0);for(const s of this.tileIndex.values())if(s.isReady&&s.key.level>=e&&s.key.level<t.level){const t=sv();if(this.tileInfoView.getTileBounds(t,s.key,!0),yv(t,i))return!0}return!1}}var kJ,IJ,jJ={exports:{}};kJ=jJ,void 0!==(IJ=function(){function t(i,s,n,r,o){for(;r>n;){if(r-n>600){var a=r-n+1,l=s-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(i,s,Math.max(n,Math.floor(s-l*c/a+h)),Math.min(r,Math.floor(s+(a-l)*c/a+h)),o)}var d=i[s],f=n,p=r;for(e(i,n,s),o(i[r],d)>0&&e(i,n,r);f<p;){for(e(i,f,p),f++,p--;o(i[f],d)<0;)f++;for(;o(i[p],d)>0;)p--}0===o(i[n],d)?e(i,n,p):e(i,++p,r),p<=s&&(n=p+1),s<=p&&(r=p-1)}}function e(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}function i(t,e){return t<e?-1:t>e?1:0}return function(e,s,n,r,o){t(e,s,n||0,r||e.length-1,o||i)}}())&&(kJ.exports=IJ);const _J=jJ.exports;function TJ(t,e){if(!(this instanceof TJ))return new TJ(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&("function"==typeof e?this.toBBox=e:this._initFormat(e)),this.clear()}function OJ(t,e,i){if(!i)return e.indexOf(t);for(var s=0;s<e.length;s++)if(i(t,e[s]))return s;return-1}function AJ(t,e){FJ(t,0,t.children.length,e,t)}function FJ(t,e,i,s,n){n||(n=zJ(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var r,o=e;o<i;o++)r=t.children[o],CJ(n,t.leaf?s(r):r);return n}function CJ(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function PJ(t,e){return t.minX-e.minX}function EJ(t,e){return t.minY-e.minY}function LJ(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function RJ(t){return t.maxX-t.minX+(t.maxY-t.minY)}function NJ(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function DJ(t,e){var i=Math.max(t.minX,e.minX),s=Math.max(t.minY,e.minY),n=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,n-i)*Math.max(0,r-s)}function VJ(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function $J(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function zJ(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function GJ(t,e,i,s,n){for(var r,o=[e,i];o.length;)(i=o.pop())-(e=o.pop())<=s||(_J(t,r=e+Math.ceil((i-e)/s/2)*s,e,i,n),o.push(e,r,r,i))}TJ.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],s=this.toBBox;if(!$J(t,e))return i;for(var n,r,o,a,l=[];e;){for(n=0,r=e.children.length;n<r;n++)o=e.children[n],$J(t,a=e.leaf?s(o):o)&&(e.leaf?i.push(o):VJ(t,a)?this._all(o,i):l.push(o));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!$J(t,e))return!1;for(var s,n,r,o,a=[];e;){for(s=0,n=e.children.length;s<n;s++)if(r=e.children[s],$J(t,o=e.leaf?i(r):r)){if(e.leaf||VJ(t,o))return!0;a.push(r)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var s=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===s.height)this._splitRoot(this.data,s);else{if(this.data.height<s.height){var n=this.data;this.data=s,s=n}this._insert(s,this.data.height-s.height-1,!0)}else this.data=s;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=zJ([]),this},remove:function(t,e){if(!t)return this;for(var i,s,n,r,o=this.data,a=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),s=l[l.length-1],i=u.pop(),r=!0),o.leaf&&-1!==(n=OJ(t,o.children,e)))return o.children.splice(n,1),l.push(o),this._condense(l),this;r||o.leaf||!VJ(o,a)?s?(i++,o=s.children[i],r=!1):o=null:(l.push(o),u.push(i),i=0,s=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:PJ,compareMinY:EJ,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,s){var n,r=i-e+1,o=this._maxEntries;if(r<=o)return AJ(n=zJ(t.slice(e,i+1)),this.toBBox),n;s||(o=Math.ceil(r/Math.pow(o,(s=Math.ceil(Math.log(r)/Math.log(o)))-1))),(n=zJ([])).leaf=!1,n.height=s;var a,l,u,c=Math.ceil(r/o),h=c*Math.ceil(Math.sqrt(o));for(GJ(t,e,i,h,this.compareMinX),a=e;a<=i;a+=h)for(GJ(t,a,u=Math.min(a+h-1,i),c,this.compareMinY),l=a;l<=u;l+=c)n.children.push(this._build(t,l,Math.min(l+c-1,u),s-1));return AJ(n,this.toBBox),n},_chooseSubtree:function(t,e,i,s){for(var n,r,o,a,l,u,c,h;s.push(e),!e.leaf&&s.length-1!==i;){for(c=h=1/0,n=0,r=e.children.length;n<r;n++)l=LJ(o=e.children[n]),(u=NJ(t,o)-l)<h?(h=u,c=l<c?l:c,a=o):u===h&&l<c&&(c=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,i){var s=i?t:(0,this.toBBox)(t),n=[],r=this._chooseSubtree(s,this.data,e,n);for(r.children.push(t),CJ(r,s);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(s,n,e)},_split:function(t,e){var i=t[e],s=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,s);var r=this._chooseSplitIndex(i,n,s),o=zJ(i.children.splice(r,i.children.length-r));o.height=i.height,o.leaf=i.leaf,AJ(i,this.toBBox),AJ(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(t,e){this.data=zJ([t,e]),this.data.height=t.height+1,this.data.leaf=!1,AJ(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var s,n,r,o,a,l,u,c;for(l=u=1/0,s=e;s<=i-e;s++)o=DJ(n=FJ(t,0,s,this.toBBox),r=FJ(t,s,i,this.toBBox)),a=LJ(n)+LJ(r),o<l?(l=o,c=s,u=a<u?a:u):o===l&&a<u&&(u=a,c=s);return c},_chooseSplitAxis:function(t,e,i){var s=t.leaf?this.compareMinX:PJ,n=t.leaf?this.compareMinY:EJ;this._allDistMargin(t,e,i,s)<this._allDistMargin(t,e,i,n)&&t.children.sort(s)},_allDistMargin:function(t,e,i,s){t.children.sort(s);var n,r,o=this.toBBox,a=FJ(t,0,e,o),l=FJ(t,i-e,i,o),u=RJ(a)+RJ(l);for(n=e;n<i-e;n++)r=t.children[n],CJ(a,t.leaf?o(r):r),u+=RJ(a);for(n=i-e-1;n>=e;n--)r=t.children[n],CJ(l,t.leaf?o(r):r),u+=RJ(l);return u},_adjustParentBBoxes:function(t,e,i){for(var s=i;s>=0;s--)CJ(e[s],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():AJ(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=Function("a","b",e.join(t[0])),this.compareMinY=Function("a","b",e.join(t[1])),this.toBBox=Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};class UJ{constructor(t,e){this.key=new tJ(0,0,0,0),this.bounds=sv(),this.objectIds=new Set,this.key.set(e);const i=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.scale=i.scale,this.level=i.level}get id(){return this.key.id}get extent(){return Ld.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createChildTiles(){const t=this.key.getChildKeys(),e=xs.acquire();for(let i=0;i<t.length;i++)e[i]=new UJ(this.tileInfoView,t[i]);return e}getQuantizationParameters(){return UE.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}}const qJ={added:[],removed:[]},BJ=new Set,WJ=new tJ(0,0,0,0);class HJ extends Cr{constructor(t){super(),this._tiles=new Map,this._index=TJ(9,l("esri-csp-restrictions")?t=>({minX:t.bounds[0],minY:t.bounds[1],maxX:t.bounds[2],maxY:t.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=t}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(t){return this._tiles.has(t)}get(t){return this._tiles.get(t)}boundsIntersections(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})}updateTiles(t){const e={added:[],removed:[]};for(const i of t.added)if(!this.has(i)){const t=new UJ(this.tileScheme,i);this._tiles.set(i,t),this._index.insert(t),e.added.push(t)}for(const i of t.removed)if(this.has(i)){const t=this.get(i);this._tiles.delete(i),this._index.remove(t),e.removed.push(t)}this.tiles.length=0,this._tiles.forEach((t=>this.tiles.push(t))),(e.added.length||e.removed.length)&&this.emit("update",e)}setViewState(t){const e=this.tileScheme.getTileCoverage(t,0);if(!e)return;const{spans:i,lodInfo:s}=e,{level:n}=s;if(i.length>0)for(const{row:t,colFrom:e,colTo:r}of i)for(let i=e;i<=r;i++){const e=WJ.set(n,t,s.normalizeCol(i),s.getWorldForColumn(i)).id;if(BJ.add(e),!this.has(e)){const t=new UJ(this.tileScheme,e);this._tiles.set(e,t),this._index.insert(t),this.tiles.push(t),qJ.added.push(t)}}for(let t=this.tiles.length-1;t>=0;t--){const e=this.tiles[t];BJ.has(e.id)||(this._tiles.delete(e.id),this.tiles.splice(t,1),this._index.remove(e),qJ.removed.push(e))}(qJ.added.length||qJ.removed.length)&&this.emit("update",qJ),rJ.pool.release(e),BJ.clear(),qJ.added.length=0,qJ.removed.length=0}}class JJ{constructor(){this._names=new Map}begin(t){this._names.has(t)||(this._names.set(t,!1),(t=>-1!==t.indexOf("Brush"))(t)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${t}.Start`))}end(t){this._names.has(t)&&!this._names.get(t)&&(this._names.set(t,!0),performance.mark(`Esri.${t}.End`))}record(t){this._names.has(t)||(this._names.set(t,!0),performance.mark("Esri."+t))}}const ZJ=ct.getLogger("esri.views.MapView");let QJ=class extends(hB(fW)){constructor(t){super(t),this._stationaryTimer=null,this.frameTask=new YW(this),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.initialExtent=null,this.labelManager=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.resizeAlign="center",this.supportsGround=!1,this.timeline=new JJ,this.type="2d",this.constraints=new pH,this.padding={top:0,right:0,bottom:0,left:0};const e=this.handles,i=()=>this.notifyChange("updating");e.add([this.watch("viewpoint",(()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(160)}),!0),this.on("resize",(t=>this._resizeHandler(t))),this.watch("animationManager.animation",(t=>{this.animation=t})),this.allLayerViews.on("change",(()=>{i(),e.remove("map-view-base-layerViewsUpdating"),e.add(this.allLayerViews.map((t=>t.watch("updating",i))),"map-view-base-layerViewsUpdating")}))],"map-view-base")}destroy(){this.destroyed||(this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null)}set animation(t){const e=this._get("animation");if(t===e)return;if(e&&e.stop(),!t||t.isFulfilled())return void this._set("animation",null);this._set("animation",t),this.frameTask.animationInProgress=!0;const i=()=>{t===this._get("animation")&&(this._set("animation",null),this.frameTask.requestFrame()),this.frameTask.animationInProgress=!1};t.when(i,i)}get center(){if(!this.ready)return this._get("center");const{center:t,spatialReference:e}=this.state.paddedViewState;return new ad({x:t[0],y:t[1],spatialReference:e})}set center(t){if(null==t)return;if(!this._normalizeInput(t))return void ZJ.error("#center",`incompatible spatialReference ${JSON.stringify(t.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`);if(!this.ready)return this._set("center",t),void this.notifyChange("initialExtentRequired");const e=this.viewpoint;VW(e,e,t),this.viewpoint=e}set constraints(t){const e=this._get("constraints");e&&(this.handles.remove("map-view-base-constraints"),e.destroy()),this._set("constraints",t),t&&(t.view=this,this.ready&&(this.state.viewpoint=t.fit(this.state.paddedViewState.viewpoint)),this.handles.add(t.on("update",(()=>{this.ready&&this.state&&(this.state.viewpoint=t.fit(this.state.paddedViewState.viewpoint))})),"map-view-base-constraints"))}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(t){if(null==t)return;const e=this._normalizeInput(t);if(!e)return void ZJ.error("#center",`incompatible spatialReference ${JSON.stringify(t.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`);if(!e.width||!e.height)return void ZJ.error("#extent","invalid extent size");if(!this.ready)return this._set("extent",e),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");const i=this.viewpoint;(function(t,e,i,s,n){VW(t,e,i.center),t.scale=kW(i,s),n&&n.constraints&&n.constraints.constrain(t)})(i,i,e,this.size,{constraints:this.constraints}),this.viewpoint=i}get graphicsTileStore(){return new HJ(this.featuresTilingScheme)}get initialExtentRequired(){const{extent:t,center:e,scale:i,viewpoint:s,zoom:n}=this;return!(this.get("map.initialViewProperties.viewpoint")||t||e&&(0!==i||-1!==n)||s)}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(t){this.ready?(this.state.padding=t,this._set("padding",this.state.padding)):this._set("padding",t)}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(t){if(isNaN(t))return;if(!this.ready)return void this._set("rotation",t);const e=this.viewpoint;(function(t,e,i){jW(t,e),t.rotation=i})(e,e,t),this.viewpoint=e}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(t){if(!t||isNaN(t))return;if(!this.ready){this._set("scale",t),this._set("zoom",-1);const e=this._get("extent");return e&&(this._set("extent",null),this._set("center",e.center)),void this.notifyChange("initialExtentRequired")}const e=this.viewpoint;UW(e,e,t),this.viewpoint=e}get stationary(){return!(this.animation||this.navigating||this._get("resizing")||this._stationaryTimer)}get updating(){return!this.destroyed&&(!0===this.get("layerViewManager.updating")||!0===this.get("labelManager.updating")||!0===this.get("graphicsView.updating")||this.allLayerViews.some((t=>!t.destroyed&&!("layerViews"in t)&&!0===t.updating)))}get viewpoint(){if(!this.ready)return this._get("viewpoint");const t=this.state.paddedViewState;return t&&t.viewpoint.clone()}set viewpoint(t){if(null==t)return;const e=this._normalizeInput(t);if(!e)return void(!t.scale||isNaN(t.scale)?ZJ.error("#viewpoint","invalid scale value of "+t.scale):c(t.targetGeometry)?ZJ.error("#viewpoint","geometry not defined"):ZJ.error("#viewpoint",`incompatible spatialReference ${JSON.stringify(t.targetGeometry.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`));if(!this.ready)return this._set("viewpoint",e),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");const i=new i$({targetGeometry:new ad,scale:0,rotation:0});jW(i,e),this.constraints.constrain(i,this.state.paddedViewState.viewpoint),this.state.viewpoint=i,this.frameTask.requestFrame(),this._set("viewpoint",i)}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(t){if(null==t)return;if(!this.ready){this.notifyChange("initialExtentRequired"),this._set("zoom",t),this._set("scale",0);const e=this._get("extent");e&&(this._set("extent",null),this._set("center",e.center))}if(!this.constraints.effectiveLODs)return;const e=this.viewpoint;UW(e,e,this.constraints.zoomToScale(t)),this.viewpoint=e,this._set("zoom",this.constraints.scaleToZoom(this.scale))}goTo(t,e){if(t)return this.animation&&(this.animation=null),this._createAnimation(),ro(this,"ready",e&&e.signal).then((()=>{const i={animate:!0,...e},s=function(t,e){return async function(t,e){if(!t||!e)return new i$({targetGeometry:new ad,scale:0,rotation:0});let i=e.spatialReference;const{constraints:s,padding:n,viewpoint:r,size:o}=e,a=[n?o[0]-n.left-n.right:o[0],n?o[1]-n.top-n.bottom:o[1]];let l=null;t instanceof i$?l=t:t.viewpoint?l=t.viewpoint:t.target&&"esri.Viewpoint"===t.target.declaredClass&&(l=t.target);let c=null;l&&l.targetGeometry?c=l.targetGeometry:t instanceof Ld?c=t:(t||t&&("center"in t||"extent"in t||"target"in t))&&(c=await IW(t.center,e,i)||await IW(t.extent,e,i)||await IW(t.target,e,i)||await IW(t,e,i)),!c&&r&&r.targetGeometry?c=r.targetGeometry:!c&&e.extent&&(c=e.extent);const h=MW(c);if(i||(i=MW(e.spatialReference||e.extent||c)),!Qh(c,i)&&h&&!h.equals(i))return null;const d=SW([0,0],c.center?c.center:c),f=new ad(bW(d,d,h,i),i);let p=null;if(l&&u(l.targetGeometry)&&"point"===l.targetGeometry.type)p=l.scale;else if(t.hasOwnProperty("scale")&&t.scale)p=t.scale;else if(t.hasOwnProperty("zoom")&&-1!==t.zoom&&s&&s.effectiveLODs)p=s.zoomToScale(t.zoom);else if(Array.isArray(c)||"point"===c.type||"extent"===c.type&&0===c.width&&0===c.height){const t=Kh(e.extent,i);p=u(t)?kW(t,a):e.extent?kW(e.extent,a):r.scale}else p=Qh(c.extent,i)?kW(Kh(c.extent,i),a):kW(c.extent,a);const y=function(t){if(t&&(!Array.isArray(t)||"number"!=typeof t[0])&&("object"==typeof t||Array.isArray(t)&&"object"==typeof t[0])){if("layer"in t&&t.layer&&t.layer.minScale&&t.layer.maxScale){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every((t=>"layer"in t))){let e=0,i=0;for(const s of t){const t=s.layer;t&&t.minScale&&t.maxScale&&(e=t.minScale<e?t.minScale:e,i=t.maxScale>i?t.maxScale:i)}return e&&i?{min:e,max:i}:null}}}(t);y&&(y.min&&y.min>p?p=y.min:y.max&&y.max<p&&(p=y.max));let m=0;l?m=l.rotation:t.hasOwnProperty("rotation")?m=t.rotation:r&&(m=r.rotation);let g=new i$({targetGeometry:f,scale:p,rotation:m});return s&&(g=s.fit(g),s.constrainByGeometry(g),s.rotationEnabled||(g.rotation=m)),g}(t,e)}(t,this);return this.animation.update(s),this._gotoTask={},i.animate?this._gotoAnimated(s,i):this._gotoImmediate(s,i)}));ZJ.error("#goTo()","target cannot be null or undefined")}hitTest(t){return Promise.reject("Should be implemented by subclasses")}popupHitTest(t){return this.hitTest(t).then((e=>({...e,mapPoint:this.toMap(t)})))}toMap(t){if(!this.ready)return null;const[e,i]=this.state.toMap([0,0],[t.x,t.y]);return new ad({x:e,y:i,spatialReference:this.spatialReference})}isTileInfoRequired(){return!0}toScreen(t){if(!this.ready)return null;const e=this._normalizeInput(t),i=[e.x,e.y];return this.state.toScreen(i,i),ex(i[0],i[1])}pixelSizeAt(){return this.ready?this.state.resolution:(ZJ.error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}getDefaultSpatialReference(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||null}isSpatialReferenceSupported(t,e){return!(!e&&!this._get("ready"))||null!==this._getDefaultViewpoint()}importLayerView(t){return(t=>{const e=iH[t.type];if(!u(e))throw function(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",i=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new dt(i+":view-not-supported",e+" is not supported in 2D")}(t);return e(t)})(t)}hasLayerViewModule(t){return(t=>u(iH[t.type]))(t)}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new yW),this.animation}_cancellableGoTo(t,e,i){const s=()=>t===this._gotoTask,n=i.then((()=>{s()&&(this.animation=null)})).catch((t=>{throw s()&&(this.animation=null,e.done||(e.stop(),this.frameTask.animationInProgress=!1)),t})),r=new Promise((t=>t(n)));return e.when().catch((()=>{s()&&r.cancel&&r.cancel()})),r}_gotoImmediate(t,e){const i=this._gotoTask,s=this.animation,n=t.then((t=>{if(Ee(e),i!==this._gotoTask)throw new dt("view:goto-interrupted","Goto was interrupted");this.viewpoint=s.target=t,s.finish()}));return this._cancellableGoTo(i,s,n)}_gotoAnimated(t,e){const i=this._gotoTask,s=this.animation,n=t.then((t=>{if(Ee(e),i!==this._gotoTask)throw new dt("view:goto-interrupted","Goto was interrupted");return s.update(t),this.animationManager.animate(s,this.viewpoint,e),s.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(i,s,n)}_resizeHandler(t){const e=this.state;if(!e)return;let i=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();e.size=[t.width,t.height],$W(i,i,s,this.state.paddedViewState.size,this.resizeAlign),i=this.constraints.constrain(i,null),this.state.viewpoint=i}_startup(){const t=this._getDefaultViewpoint();this.constraints.view=this,this.constraints.fit(t),this._set("animationManager",new KW({view:this})),this._set("state",new WH({padding:this._get("padding"),size:this.size,viewpoint:t})),this._set("featuresTilingScheme",new cJ(Tw.create({spatialReference:this.spatialReference,size:512,numLODs:36}))),this._set("ready",!0),this.frameTask&&this.frameTask.start()}_teardown(){this.frameTask&&this.frameTask.stop(),this._set("ready",!1),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null);const{center:[t,e],spatialReference:i,rotation:s,scale:n}=this.state.paddedViewState,r=new ad({x:t,y:e,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",r),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("spatialReference",i),this.constraints.view=null,this.animationManager.destroy(),this._set("animationManager",null),this._set("state",null),this.animation=null}_flipStationary(t){return null!==this._stationaryTimer||(this._stationaryTimer=setTimeout((()=>{this._stationaryTimer=null;const t=performance.now()-this._lastStationaryEventTimestamp;t<160&&(this._stationaryTimer=this._flipStationary(t))}),t)),this._stationaryTimer}_normalizeInput(t,e=this.spatialReference){const i=t&&t.targetGeometry||t;return e?i?e.equals(i.spatialReference)?t:Qh(i,e)?function(t){return t&&"esri.Viewpoint"===t.declaredClass}(t)?(t.targetGeometry=Kh(i,e),t):Kh(i,e):null:null:t}_getDefaultViewpoint(){const t=this.constraints,e={zoom:this._get("zoom"),scale:this._get("scale"),center:this._normalizeInput(this._get("center")),extent:this._normalizeInput(this._get("extent")),rotation:this._get("rotation"),viewpoint:this._normalizeInput(this._get("viewpoint")),spatialReference:this._userSpatialReference};t.effectiveLODs?-1!==e.zoom&&(e.scale=t.zoomToScale(e.zoom)):e.zoom=-1;let i=null,s=null,n=0;const r=e.viewpoint&&e.viewpoint.rotation,o=e.viewpoint&&e.viewpoint.targetGeometry;u(o)&&("extent"===o.type?i=o:"point"===o.type&&(s=o,n=e.viewpoint.scale));const a=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent")),l=this._normalizeInput(this.initialExtent),c=e.extent||i||a||l,h=e.center||s||c&&c.center,d=this.get("map.initialViewProperties.viewpoint.scale"),f=e.scale||n||d||c&&kW(c,this.size),p=this.get("map.initialViewProperties.viewpoint.rotation");return h&&f?new i$({targetGeometry:h,scale:f,rotation:e.rotation||r||p||0}):null}};e([Hn()],QJ.prototype,"_stationaryTimer",void 0),e([Hn()],QJ.prototype,"animation",null),e([Hn({readOnly:!0})],QJ.prototype,"animationManager",void 0),e([Hn({value:null,type:ad,dependsOn:["state.id","ready"]})],QJ.prototype,"center",null),e([Hn({type:pH})],QJ.prototype,"constraints",null),e([Hn({value:null,type:Ld,dependsOn:["state.id","ready"]})],QJ.prototype,"extent",null),e([Hn({readOnly:!0})],QJ.prototype,"featuresTilingScheme",void 0),e([Hn()],QJ.prototype,"fullOpacity",void 0),e([Hn({readOnly:!0})],QJ.prototype,"graphicsTileStore",null),e([Hn()],QJ.prototype,"graphicsView",void 0),e([Hn({type:Ld})],QJ.prototype,"initialExtent",void 0),e([Hn({dependsOn:["map.initialViewProperties?.viewpoint"]})],QJ.prototype,"initialExtentRequired",null),e([Hn()],QJ.prototype,"labelManager",void 0),e([Hn({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],QJ.prototype,"padding",null),e([Hn({type:Object})],QJ.prototype,"renderingOptions",void 0),e([Hn()],QJ.prototype,"resizeAlign",void 0),e([Hn({readOnly:!0,dependsOn:["state.id"]})],QJ.prototype,"resolution",null),e([Hn({value:0,type:Number,dependsOn:["state.id","ready"]})],QJ.prototype,"rotation",null),e([Hn({value:0,type:Number,dependsOn:["state.id","ready"]})],QJ.prototype,"scale",null),e([Hn({type:Lh,dependsOn:["map.initialViewProperties?.spatialReference","defaultsFromMap.isSpatialReferenceDone"]})],QJ.prototype,"spatialReference",void 0),e([Hn({readOnly:!0})],QJ.prototype,"state",void 0),e([Hn({dependsOn:["animation","navigating","resizing","_stationaryTimer"]})],QJ.prototype,"stationary",null),e([Hn({readOnly:!0})],QJ.prototype,"supportsGround",void 0),e([Hn({type:JJ,readOnly:!0})],QJ.prototype,"timeline",void 0),e([Hn({readOnly:!0})],QJ.prototype,"type",void 0),e([Hn({readOnly:!0,dependsOn:["layerViewManager.updating","labelManager.updating","graphicsView?.updating"]})],QJ.prototype,"updating",null),e([Hn({value:null,type:i$,dependsOn:["state.id","ready"]})],QJ.prototype,"viewpoint",null),e([Hn({value:-1,dependsOn:["state.id"]})],QJ.prototype,"zoom",null),QJ=e([_r("esri.views.MapViewBase")],QJ);const KJ=QJ;function YJ(t,e){switch(e){case"primary":return"touch"===t.pointerType||0===t.button;case"secondary":return"touch"!==t.pointerType&&2===t.button;case"tertiary":return"touch"!==t.pointerType&&1===t.button}}class XJ extends Fq{constructor(t,e){super(!0),this.view=t,this.registerIncoming("double-click",e,(t=>this._handleDoubleClick(t,e)))}_handleDoubleClick(t,e){YJ(t.data,"primary")&&(t.stopPropagation(),e?this.view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this.view.mapViewNavigation.zoomIn([t.data.x,t.data.y]))}}class tZ extends Fq{constructor(t,e,i){super(!0),this.view=t,this.pointerType=e,this.registerIncoming("double-tap-drag",i,(t=>this._handleDoubleTapDrag(t)))}_handleDoubleTapDrag(t){const{data:e}=t,{pointerType:i}=e;if(i!==this.pointerType)return;t.stopPropagation();const{action:s,delta:n}=e,{view:r}=this,{mapViewNavigation:o}=r;switch(s){case"begin":{const{scale:t}=r;this._startScale=t,this._currentScale=t,this._previousDelta=n,o.begin();break}case"update":{if(this._previousDelta.y===n.y)return;this._previousDelta=n;const t=this._startScale*1.015**n.y;o.setViewpointImmediate(t/this._currentScale),this._currentScale=t;break}case"end":{const{constraints:t}=r,{effectiveLODs:e,snapToZoom:i}=t;if(!i||!e)return void o.end();const s=t.snapScale(this._currentScale),a=(n.y>0?Math.max(s,t.snapToPreviousScale(this._startScale)):Math.min(s,t.snapToNextScale(this._startScale)))/this._currentScale;o.zoom(a);break}}}}class eZ{constructor(t){this.callbacks=t,this.currentCount=0,this.callbacks.condition||(this.callbacks.condition=()=>!0)}handle(t){const e=t.data,i=e.pointers.size;switch(e.action){case"start":this.currentCount=i,this.emitStart(t);break;case"added":this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"update":this.emitUpdate(t);break;case"removed":this.startEvent&&this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"end":this.emitEnd(t),this.currentCount=0}this.previousEvent=t}emitStart(t){this.startEvent=t,this.callbacks.condition(this.currentCount,t)&&this.callbacks.start(this.currentCount,t,this.startEvent)}emitUpdate(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.update(this.currentCount,t,this.startEvent)}emitEnd(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.end(this.currentCount,t,this.startEvent),this.startEvent=null}}class iZ extends Fq{constructor(t,e,i){super(!0),this.view=t,this.pointerAction=e,this.registerIncoming("drag",i,(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()));const s=this.view.mapViewNavigation;this.dragEventSeparator=new eZ({start:(t,e)=>{s.pan.begin(this.view,e.data),e.stopPropagation()},update:(t,e)=>{s.pan.update(this.view,e.data),e.stopPropagation()},end:(t,e)=>{s.pan.end(this.view,e.data),e.stopPropagation()},condition:(t,e)=>1===t&&YJ(e.data,this.pointerAction)})}_handleDrag(t){const e=this.view.mapViewNavigation;e.pinch.zoomMomentum||e.pinch.rotateMomentum?this.stopMomentumNavigation():this.dragEventSeparator.handle(t)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}}class sZ extends Fq{constructor(t,e,i){super(!0),this.view=t,this.pointerAction=e;const s=this.view.mapViewNavigation;this.dragEventSeparator=new eZ({start:(t,e)=>{s.rotate.begin(this.view,e.data),e.stopPropagation()},update:(t,e)=>{s.rotate.update(this.view,e.data),e.stopPropagation()},end:(t,e)=>{s.rotate.end(),e.stopPropagation()},condition:(t,e)=>1===t&&YJ(e.data,this.pointerAction)}),this.registerIncoming("drag",i,(t=>this.dragEventSeparator.handle(t)))}}function nZ(t){let e=t*t;return t<0&&(e*=-1),e}class rZ extends Fq{constructor(t){super(!0),this.view=t,this.frameTask=null,this.watchHandles=new Qr,this.currentDevice=null,this.transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this.handle=this.registerIncoming("gamepad",(t=>this.handleEvent(t))),this.handle.pause()}onInstall(t){super.onInstall(t),this.watchHandles.add([Yr(this.view.navigation.gamepad,"enabled",(t=>{t?(this.handle.resume(),this.frameTask||(this.frameTask=Us({update:t=>this.frameUpdate(t.deltaTime)}))):(this.handle.pause(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null))}))])}onUninstall(){this.watchHandles.removeAll(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null),super.onUninstall()}handleEvent(t){const e=this.view.navigation.gamepad.device;e&&t.data.device!==e||this.currentDevice&&this.currentDevice!==t.data.device||("end"===t.data.action?(this.currentDevice=null,function(t){t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0}(this.transformation)):(this.currentDevice=t.data.device,function(t,e,i){const s=i,n=t.state,r=t.device,o="forward-down"===e.tiltDirection?1:-1;"standard"===r.deviceType?(s.translation[0]=nZ(n.axes[0]),s.translation[1]=nZ(n.axes[1]),s.translation[2]=nZ(n.buttons[7])-nZ(n.buttons[6]),s.heading=nZ(n.axes[2]),s.tilt=nZ(n.axes[3])):"spacemouse"===r.deviceType&&(s.translation[0]=1.2*nZ(n.axes[0]),s.translation[1]=1.2*nZ(n.axes[1]),s.translation[2]=2*-nZ(n.axes[2]),s.heading=1.2*nZ(n.axes[5]),s.tilt=1.2*nZ(n.axes[3])),s.tilt*=o,lp(s.translation,s.translation,1)}(t.data,this.view.navigation.gamepad,this.transformation)))}frameUpdate(t){const e=this.transformation;if(function(t){return 0===t.translation[0]&&0===t.translation[1]&&0===t.translation[2]&&0===t.heading&&0===t.tilt&&0===t.zoom}(e))return;const i=this.view.viewpoint.clone(),s=aZ*this.view.navigation.gamepad.velocityFactor*t;JW(i,i,[e.translation[0]*s,-e.translation[1]*s]);const n=this.view.size;qW(i,i,1+e.translation[2]*lZ*t,this.view.constraints.rotationEnabled?-e.heading*oZ*t:0,[n[0]/2,n[1]],n);const r=this.view.constraints.constrain(i,this.view.viewpoint);this.view.viewpoint=r}}const oZ=.06,aZ=.7,lZ=6e-4;class uZ extends Fq{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._pressed=!1,this._keyMap={[e.left]:"left",[e.right]:"right",[e.up]:"up",[e.down]:"down"},this.registerIncoming("key-down",i,(t=>this._handleKeyDown(t))),this.registerIncoming("key-up",i,(t=>this._handleKeyUp(t))),this.registerIncoming("blur",i,(()=>this._handleBlur()))}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,e){const i=this._keyMap[t.data.key];if(this._pressed=null!=i,this._pressed){if(e)switch(this.view.mapViewNavigation.begin(),i){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}}class cZ extends Fq{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._pressed=!1,this._keyToDirection={[e.clockwiseOption1]:"clockwise",[e.clockwiseOption2]:"clockwise",[e.counterClockwiseOption1]:"counterClockwise",[e.counterClockwiseOption2]:"counterClockwise",[e.resetOption1]:"reset",[e.resetOption2]:"reset"},this.registerIncoming("key-down",i,(t=>this._handleKeyDown(t))),this.registerIncoming("key-up",i,(t=>this._handleKeyUp(t))),this.registerIncoming("blur",i,(()=>this._handleBlur()))}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,e){const i=t.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection[t.data.key];if(this._pressed=null!=s,this._pressed){if(e)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}}class hZ extends Fq{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._keysToZoomAction={},this.registerIncoming("key-down",i,(t=>this._handleKeyDown(t))),e.zoomIn.forEach((t=>this._keysToZoomAction[t]=0)),e.zoomOut.forEach((t=>this._keysToZoomAction[t]=1))}_handleKeyDown(t){this._handleKey(t)}_handleKey(t){const e=t.modifiers;if(e.size>0&&!e.has("Shift"))return;const{key:i}=t.data;if(!(i in this._keysToZoomAction))return;const s=this._keysToZoomAction[i],{mapViewNavigation:n}=this.view;let r=null;switch(s){case 0:r=n.zoomIn();break;case 1:r=n.zoomOut();break;default:return}n.begin(),r.then((()=>n.end())),t.stopPropagation()}}class dZ extends Fq{constructor(t,e){super(!0),this.view=t,this._canZoom=!0,this.registerIncoming("mouse-wheel",e,(t=>this._handleMouseWheel(t)))}_handleMouseWheel(t){if(!this.view.navigation.mouseWheelZoomEnabled)return;if(t.preventDefault(),t.stopPropagation(),!this._canZoom)return;const e=this.view.mapViewNavigation,{x:i,y:s,deltaY:n}=t.data,r=e.zoom(1/.6**(1/60*n),[i,s]);r&&(this._canZoom=!1,r.catch((()=>{})).then((()=>{this._canZoom=!0,e.end()})))}}class fZ extends Fq{constructor(t){super(!0),this.view=t,this.registerIncoming("drag",(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()));const e=this.view.mapViewNavigation;this.dragEventSeparator=new eZ({start:(t,i)=>{e.pinch.begin(this.view,i.data),i.stopPropagation()},update:(t,i)=>{e.pinch.update(this.view,i.data),i.stopPropagation()},end:(t,i)=>{e.pinch.end(this.view),i.stopPropagation()},condition:t=>t>=2})}_handleDrag(t){this.dragEventSeparator.handle(t)}stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}}function pZ(t){const e=t.native;return e?{buttons:e.buttons.map((t=>t.pressed?t.value?t.value:1:0)),axes:e.axes.map((e=>function(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}(e,t.axisThreshold)))}:{buttons:[],axes:[]}}class yZ{constructor(t,e){this.element=t,this.input=e,this._hasEventListeners=!1,this.onConnectGamepad=t=>{this.connectGamepad(t.gamepad)},this.onDisconnectGamepad=t=>{const e=t.gamepad,i=e.index,s=this.inputDevices[i];s&&(this.emitGamepadEvent(e,pZ(s),!1),this.inputDevices.splice(i,1),this.latestUpdate.splice(i,1),this.input.gamepad.devices.remove(s),this.ensurePollingState())},this.frameTask=null,this.latestUpdate=[],this.inputDevices=[],this.callback=null;const i="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=i&&s,this.supported&&(this.forEachGamepad((t=>this.connectGamepad(t))),window.addEventListener("gamepadconnected",this.onConnectGamepad),window.addEventListener("gamepaddisconnected",this.onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this.onConnectGamepad),window.removeEventListener("gamepaddisconnected",this.onDisconnectGamepad))}set hasEventListeners(t){this._hasEventListeners!==t&&(this._hasEventListeners=t,this.ensurePollingState())}get eventsEnabled(){return this.supported&&this.inputDevices.length>0&&this._hasEventListeners}set onEvent(t){this.callback=t}connectGamepad(t){const e=new BB(t);"unknown"!==e.deviceType&&(this.inputDevices[t.index]=e,this.input.gamepad.devices.add(e)),this.ensurePollingState()}ensurePollingState(){this.eventsEnabled?this.startPolling():this.stopPolling()}startPolling(){null==this.frameTask&&(this.frameTask=Us({update:()=>this.readGamepadState()}))}stopPolling(){null!=this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=[])}readGamepadState(){const t=document.hasFocus(),e=this.element.contains(document.activeElement),i="document"===this.input.gamepad.enabledFocusMode&&!t||"view"===this.input.gamepad.enabledFocusMode&&!e;this.forEachGamepad((t=>{const e=this.inputDevices[t.index];if(!e)return;const s=this.latestUpdate[t.index],n=pZ(e),r=i||function(t){for(let e=0;e<t.axes.length;e++)if(0!==t.axes[e])return!1;for(let e=0;e<t.buttons.length;e++)if(0!==t.buttons[e])return!1;return!0}(n);if(s){if(s.timestamp===t.timestamp)return;if(!s.active&&r)return;if(function(t,e){if(t.axes.length!==e.axes.length)return!1;if(t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}(s.state,n))return}this.emitGamepadEvent(t,n,!r)}))}forEachGamepad(t){const e=window.navigator.getGamepads();for(let i=0;i<e.length;i++){const s=e[i];this.validate(s)&&t(s)}}emitGamepadEvent(t,e,i){const s=this.latestUpdate[t.index],n=s&&s.active;if(!n&&!i)return;const r=!n&&i?"start":n&&i?"update":"end";this.latestUpdate[t.index]={timestamp:t.timestamp,state:e,active:i},this.callback&&this.callback({device:this.inputDevices[t.index],state:e,action:r})}validate(t){if(!t)return!1;if(!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}}const mZ=l("trident"),gZ=l("edge"),vZ=l("chrome"),wZ=l("ff"),bZ=l("safari"),MZ="esri-view-surface--touch-none",SZ="esri-view-surface--touch-pan";class xZ{constructor(t,e){this.input=e,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=t,t.getAttribute("tabindex")||t.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new yZ(t,this.input),this._gamepadSource.onEvent=t=>this._callback("gamepad",t)}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach((t=>{this._releasePointerCaptureSafe(t)})),this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=null),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(t){this._browserTouchPanningEnabled=t,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(t){this._callback=t}set activeEvents(t){for(const e in this._active)t&&t.has(e)||(this._element.removeEventListener(kZ[e],this._active[e]),delete this._active[e]);t&&t.forEach((t=>{if(!this._active[t]&&kZ[t]){const e=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(kZ[t],e),this._active[t]=e}})),this._gamepadSource.hasEventListeners=t&&t.has("gamepad")}setPointerCapture(t,e){e?(this._element.setPointerCapture(t.pointerId),this._activePointerCaptures.add(t.pointerId)):(this._releasePointerCaptureSafe(t.pointerId),this._activePointerCaptures.delete(t.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?MZ:SZ),this._element.classList.add(this._browserTouchPanningEnabled?SZ:MZ)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(MZ),this._element.classList.remove(SZ),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_releasePointerCaptureSafe(t){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(t))return;this._element.releasePointerCapture(t)}catch(t){}}_updateNormalizedPointerLikeEvent(t,e){const i=FB(this._element,t);return xZ.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),e.x=i.x,e.y=i.y,e}_handleKey(t,e){const i=function(t){if(void 0!==t.key)return Ae(t);const e=_q[t.keyCode];return Array.isArray(e)?t.shiftKey?e[1]:e[0]:e}(e);i&&"key-up"===t&&this._keyDownState.delete(i);const s={native:e,key:i,repeat:i&&this._keyDownState.has(i)};i&&"key-down"===t&&this._keyDownState.add(s.key),this._callback(t,s)}_handlePointer(t,e){const i=this._updateNormalizedPointerLikeEvent(e,{native:e,x:0,y:0,pointerType:e.pointerType,button:e.button,buttons:e.buttons,eventId:this._eventId++});this._callback(t,i)}_handlePointerPreventDefault(t,e){const i=this._updateNormalizedPointerLikeEvent(e,{native:e,x:0,y:0,pointerType:e.pointerType,button:e.button,buttons:e.buttons,eventId:this._eventId++});e.preventDefault(),this._callback(t,i)}_handleMouseWheel(t,e){let i=e.deltaY;switch(e.deltaMode){case 0:(mZ||gZ)&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}mZ||gZ?i*=.7:vZ||bZ?i*=.6:wZ&&(i*=1.375);const s=Math.abs(i);s>100&&(i=i/s*200/(1+Math.exp(-.02*(s-100))));const n=this._updateNormalizedPointerLikeEvent(e,{native:e,x:0,y:0,deltaY:i});this._callback(t,n)}_handlePointerCaptureLost(t,e){this._activePointerCaptures.delete(e.pointerId),this._handleDefault(t,e)}_handleDefault(t,e){const i={native:e};e.preventDefault(),this._callback(t,i)}_preventAltKeyDefault(t){"Alt"===t.key&&t.preventDefault()}_preventMultiTouchPanning(t){t.touches.length>1&&t.preventDefault()}}xZ.test={disableSubpixelCoordinates:!1};const kZ={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};class IZ extends Fq{constructor(){super(!0),this.registerIncoming("context-menu",(t=>{t.data.native.preventDefault()}))}}function jZ(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}class _Z extends Fq{constructor(t=250,e=10,i=350,s=35,n=ke){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=e,this.maximumDoubleTouchDelay=i,this.maximumDoubleTouchDistance=s,this._clock=n,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("drag",this._handleDrag.bind(this))}onUninstall(){this._pointerState.forEach((t=>{null!=t.doubleClickTimeout&&(t.doubleClickTimeout.remove(),t.doubleClickTimeout=null)}))}get hasPendingInputs(){return vn(this._pointerState,(t=>null!=t.doubleClickTimeout))}_pointerId(t){const e=t.native;return"mouse"===e.pointerType?`${e.pointerId}:${e.button}`:""+e.pointerType}_handleImmediateClick(t){const e=t.data,i=this._pointerId(e),s=this._pointerState.get(i);if(s){const n="touch"===e.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;jZ(s.event.data,e)>n?(this._clearDoubleClickTimeout(i,!0),this._startClick(t)):(this._clearDoubleClickTimeout(i,!1),this._doubleClick.emit(s.event.data,void 0,s.event.modifiers))}else this._startClick(t)}_startClick(t){const e=this._pointerId(t.data);this._pointerState.set(e,{event:t,doubleClickTimeout:this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(e)),"touch"===t.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay)}),this.refreshHasPendingInputs()}_handlePointerDrag(t){const e=this._pointerId(t.data.currentEvent);this._clearDoubleClickTimeout(e,!0)}_handleDrag(t){const e=this._pointerId(t.data.pointer);this._clearDoubleClickTimeout(e,!0)}_clearDoubleClickTimeout(t,e){const i=this._pointerState.get(t);i&&(i.doubleClickTimeout.remove(),i.doubleClickTimeout=null,e&&this._doubleClickTimeoutExceeded(t),this._pointerState.delete(t),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(t){const e=this._pointerState.get(t);this._click.emit(e.event.data,void 0,e.event.modifiers),e.doubleClickTimeout=null,this._pointerState.delete(t),this.refreshHasPendingInputs()}}class TZ extends Fq{constructor(t=250,e=10,i=350,s=35,n=ke){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=e,this.maximumDoubleTouchDelay=i,this.maximumDoubleTouchDistance=s,this._clock=n,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=ex(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new eZ({start:(t,e)=>this._dragStart(t,e),update:(t,e)=>this._dragUpdate(e),end:(t,e)=>this._dragEnd(e)}),this.registerIncoming("drag",(t=>this._dragEventSeparator.handle(t))),this.registerIncoming("pointer-down",(t=>this._handlePointerDown(t))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()))}onUninstall(){this._pointerState.forEach((t=>{null!=t.doubleTapTimeout&&(t.doubleTapTimeout.remove(),t.doubleTapTimeout=null)}))}get hasPendingInputs(){return vn(this._pointerState,(t=>null!=t.doubleTapTimeout))}_clearPointerDown(t){const e=this._pointerState.get(t);e&&(e.doubleTapTimeout.remove(),e.doubleTapTimeout=null,this._pointerState.delete(t),this.refreshHasPendingInputs())}_createDoubleTapDragData(t,e,i){const{button:s,buttons:n,pointer:r,pointers:o,pointerType:a,timestamp:l}=i;return{action:t,delta:e,button:s,buttons:n,pointer:r,pointers:o,pointerType:a,timestamp:l}}_dragStart(t,e){if(!this._doubleTapDragReady||1!==t)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:s}=e,{center:n}=i;this._dragStartCenter=n;const r=this._createDoubleTapDragData("begin",ex(0,0),i);this._doubleTapDrag.emit(r,void 0,s),e.stopPropagation()}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:i}=t,{center:s}=e,n=ex(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r=this._createDoubleTapDragData("update",n,e);this._doubleTapDrag.emit(r,void 0,i),t.stopPropagation()}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:i}=t,{center:s}=e,n=ex(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r=this._createDoubleTapDragData("end",n,e);this._doubleTapDrag.emit(r,void 0,i),this._doubleTapDragActive=!1,t.stopPropagation()}_handlePointerDown(t){const{data:e}=t,i=this._pointerId(e),s=this._pointerState.get(i),{pointerType:n}=e.native;if(s){const r="touch"===n?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;this._clearPointerDown(i),jZ(s.event.data,e)>r?this._storePointerDown(t):this._doubleTapDragReady=!0}else this._storePointerDown(t)}_handlePointerUp(){this._doubleTapDragReady=!1}_pointerId(t){const{native:e}=t,{pointerId:i,button:s,pointerType:n}=e;return"mouse"===n?`${i}:${s}`:""+n}_storePointerDown(t){const{data:e}=t,{pointerType:i}=e.native,s=this._pointerId(e),n=this._clock.setTimeout((()=>this._clearPointerDown(s)),"touch"===i?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay);this._pointerState.set(s,{event:t,doubleTapTimeout:n}),this.refreshHasPendingInputs()}}class OZ extends Fq{constructor(t){super(!1),this.navigationTouch=t,this.startStateModifiers=new Set,this.activePointerMap=new Map,this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this.handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this.handlePointerUpAndPointerLost.bind(this))}createPayload(t,e,i,s){return{action:t,pointerType:this.pointerType,button:this.mouseButton,buttons:e.buttons,timestamp:s,pointers:CZ(this.activePointerMap),pointer:e,angle:i.angle,radius:i.radius,center:i.center}}addPointer(t){const e=t.native.pointerId,i=FZ(this.activePointerMap).angle,s={event:t,initialAngle:0,lastAngle:0};this.activePointerMap.set(e,s);const n=PZ(s,AZ(this.activePointerMap));s.initialAngle=n,s.lastAngle=n,this.updatePointerAngles(i)}updatePointer(t){if(t&&null==t.x&&null==t.y)return;const e=this.activePointerMap.get(t.native.pointerId);e?e.event=t:this.addPointer(t)}removePointer(t){const e=FZ(this.activePointerMap).angle;this.activePointerMap.delete(t),this.updatePointerAngles(e)}updatePointerAngles(t){const e=FZ(this.activePointerMap);this.activePointerMap.forEach((i=>{i.initialAngle=PZ(i,e)-t,i.lastAngle=PZ(i,e)-t}))}emitEvent(t,e,i){const s=FZ(this.activePointerMap);this.drag.emit(this.createPayload(t,e,s,i),void 0,this.startStateModifiers)}handlePointerUpAndPointerLost(t){const e=t.data.native.pointerId,i=t.timestamp;this.activePointerMap.get(e)&&(1===this.activePointerMap.size?(this.updatePointer(t.data),!this.isCurrentDragSuppressed&&this.emitEvent("end",t.data,i),this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.removePointer(e)):(this.removePointer(e),this.emitEvent("removed",t.data,t.timestamp)))}handlePointerDrag(t){const e=t.data,i=e.currentEvent,s=t.timestamp;switch(e.action){case"start":case"update":this.isDragging?this.activePointerMap.has(i.native.pointerId)?(this.updatePointer(i),!this.isCurrentDragSuppressed&&this.emitEvent("update",i,s)):(this.addPointer(i),this.emitEvent("added",i,s),this.isCurrentDragSuppressed=this.isSuppressed):(this.updatePointer(i),this.pointerType=t.data.startEvent.pointerType,this.mouseButton=t.data.startEvent.button,this.startStateModifiers=t.modifiers,this.isDragging=!0,this.isCurrentDragSuppressed=this.isSuppressed,!this.isCurrentDragSuppressed&&this.emitEvent("start",i,s))}}get isSuppressed(){return this.navigationTouch&&!this.navigationTouch.browserTouchPanEnabled&&"touch"===this.pointerType&&1===this.activePointerMap.size}}function AZ(t){const e=[];return t.forEach((t=>{e.push(ex(t.event.x,t.event.y))})),function(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:ex()},0===t.length)return e;if(1===t.length)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(2===t.length){const[i,s]=t,[n,r]=[s.x-i.x,s.y-i.y];return e.radius=Math.sqrt(n*n+r*r)/2,e.center.x=(i.x+s.x)/2,e.center.y=(i.y+s.y)/2,e}let i=0,s=0;for(let e=0;e<t.length;e++)i+=t[e].x,s+=t[e].y;i/=t.length,s/=t.length;const n=t.map((t=>t.x-i)),r=t.map((t=>t.y-s));let o=0,a=0,l=0,u=0,c=0,h=0,d=0;for(let t=0;t<n.length;t++){const e=n[t],i=r[t],s=e*e,f=i*i;o+=s,a+=f,l+=e*i,u+=s*e,c+=f*i,h+=e*f,d+=i*s}const f=.5*(u+h),p=.5*(c+d),y=o*a-l*l,m=(f*a-p*l)/y,g=(o*p-l*f)/y,v=ex(m+i,g+s);return{radius:Math.sqrt(m*m+g*g+(o+a)/t.length),center:v}}(e)}function FZ(t){const e=AZ(t);let i=0;return t.forEach((t=>{let s=PZ(t,e),n=s-t.lastAngle;for(;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;s=t.lastAngle+n,t.lastAngle=s,i+=s-t.initialAngle})),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function CZ(t){const e=new Map;return t.forEach(((t,i)=>e.set(i,t.event))),e}function PZ(t,e){const i=t.event;return Math.atan2(i.y-e.center.y,i.x-e.center.x)}var EZ;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"}(EZ||(EZ={}));class LZ extends Fq{constructor(t=250,e=10,i=350,s=35,n=ke){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=e,this.maximumDoubleTouchDelay=i,this.maximumDoubleTouchDistance=s,this._clock=n,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up")})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost")})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel")}))}onUninstall(){this._pointerState.forEach((t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove()})),super.onUninstall()}_handlePointerDown(t){const e=t.data,i=this._pointerId(e);this._pointerState.has(i)||(this._pointerState.set(i,{downButton:e.native.button,immediateDoubleClick:null}),this.startCapturingPointer(e.native))}_handlePointerLoss(t,e){const i=t.data,s=this._pointerId(i),n=this._pointerState.get(s);if(n&&"pointer-up"===e&&n.downButton===i.native.button){const e=n.immediateDoubleClick;if(e){e.timeoutHandle.remove();const s="touch"===t.data.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;jZ(e,t.data)>s?this._startImmediateDoubleClick(t,n):(this._immediateDoubleClick.emit(t.data,void 0,e.modifiers),this._removeState(i))}else this._startImmediateDoubleClick(t,n)}}_startImmediateDoubleClick(t,e){e.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(t.data)),"touch"===t.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay)}}_pointerId(t){const e=t.native;return"mouse"===e.pointerType?`${e.pointerId}:${e.button}`:""+e.pointerType}_removeState(t){const e=this._pointerId(t);this._pointerState.delete(e),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs()}}class RZ extends Fq{constructor(t=300,e=1.5,i=6,s=6,n=500,r=ke){super(!1),this.maximumClickDelay=t,this.movementUntilMouseDrag=e,this.movementUntilPenDrag=i,this.movementUntilTouchDrag=s,this.holdDelay=n,this._clock=r,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up")})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost")})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel")})),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach((t=>{null!=t.holdTimeout&&(t.holdTimeout.remove(),t.holdTimeout=null)})),super.onUninstall()}_handlePointerDown(t){const e=t.data,i=e.native.pointerId;let s=null;0===this._pointerState.size&&(s=this._clock.setTimeout((()=>{const e=this._pointerState.get(i);e&&(e.isDragging||(this._pointerHold.emit(e.previousEvent,void 0,t.modifiers),e.holdEmitted=!0),e.holdTimeout=null)}),this.holdDelay));const n={startEvent:e,previousEvent:e,startTimestamp:t.timestamp,isDragging:!1,downButton:e.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(i,n),this.startCapturingPointer(e.native),this._moveHandle.resume(),this._pointerState.size>1&&this.startDragging(t)}_createPointerDragData(t,e,i){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}_handlePointerMove(t){const e=t.data,i=this._pointerState.get(e.native.pointerId);i&&(i.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",i,e),void 0,i.modifiers):function(t,e){const i=e.x-t.x,s=e.y-t.y;return Math.sqrt(i*i+s*s)}(e,i.startEvent)>this._getDragThreshold(e.native.pointerType)&&this.startDragging(t),i.previousEvent=e)}_getDragThreshold(t){switch(t){case"touch":return this.movementUntilTouchDrag;case"pen":return this.movementUntilPenDrag;default:return this.movementUntilMouseDrag}}startDragging(t){const e=t.data,i=e.native.pointerId;this._pointerState.forEach((s=>{null!=s.holdTimeout&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=t.modifiers,s.isDragging=!0,i===s.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",s,e)):this._pointerDrag.emit(this._createPointerDragData("start",s,s.previousEvent),t.timestamp))}))}_handlePointerLoss(t,e){const i=t.data,s=i.native.pointerId,n=this._pointerState.get(s);n&&(null!=n.holdTimeout&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",n,"pointer-up"===e?i:n.previousEvent),void 0,n.modifiers):"pointer-up"===e&&n.downButton===i.native.button&&t.timestamp-n.startTimestamp<=this.maximumClickDelay&&!n.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(s),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause())}}const NZ={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},DZ={zoomIn:["=","+"],zoomOut:["-","_"]},VZ={clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"};let $Z=class extends Ar{constructor(){super(...arguments),this._handles=new Qr}initialize(){this._handles.add([io(this.view,"ready",(()=>this._disconnect())),to(this.view,"ready",(()=>this._connect()))])}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect()}_disconnect(){this._inputManager&&(this.view.viewEvents.disconnect(),this._inputManager.destroy(),this._inputManager=null,this._source.destroy(),this._source=null)}_connect(){const t=new xZ(this.view.surface,this.view.input),e=[new LZ,new RZ,new _Z,new OZ(this.view.navigation),new TZ],i=new Rq({eventSource:t,recognizers:e});i.installHandlers("prevent-context-menu",[new IZ],Dq.INTERNAL),i.installHandlers("navigation",[new fZ(this.view),new rZ(this.view),new dZ(this.view),new XJ(this.view),new XJ(this.view,["Ctrl"]),new iZ(this.view,"primary"),new uZ(this.view,NZ),new hZ(this.view,DZ),new cZ(this.view,VZ),new sZ(this.view,"secondary"),new tZ(this.view,"touch")],Dq.INTERNAL),this.view.viewEvents.connect(i),this._source=t,this._inputManager=i,Yr(this.view.navigation,"browserTouchPanEnabled",(t=>{this._source.browserTouchPanningEnabled=!t}))}get test(){return{inputManager:this._inputManager}}};e([Hn()],$Z.prototype,"view",void 0),$Z=e([_r("esri.views.2d.input.MapViewInputManager")],$Z);const zZ=$Z;let GZ=0,UZ=class extends Ar{constructor(){super(...arguments),this.color=new zS([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}get version(){return GZ++}};e([Hn({readOnly:!0})],UZ.prototype,"version",null),e([Hn({type:zS})],UZ.prototype,"color",void 0),e([Hn({type:zS})],UZ.prototype,"haloColor",void 0),e([Hn()],UZ.prototype,"haloOpacity",void 0),e([Hn()],UZ.prototype,"fillOpacity",void 0),UZ=e([_r("esri.views.2d.support.HighlightOptions")],UZ);const qZ=UZ;function BZ(t,e,i,s){s.premultipliedAlpha&&function(t){const e=t.data,i=e.length;for(let t=0;t<i;t+=4){const i=e[t+3];if(i>0){const s=i/255;e[t+0]=e[t+0]/s,e[t+1]=e[t+1]/s,e[t+2]=e[t+2]/s}}}(t),i.width=t.width,i.height=t.height;const n=i.getContext("2d");n.putImageData(t,0,0),s.flipY&&function(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}(n);const r=n.getImageData(0,0,t.width,t.height),o=function(t,e){return t.toDataURL(YZ[e.format],e.quality/100)}(i,e);return i.width=0,i.height=0,{dataUrl:o,data:r}}function WZ(t,e,i){if(!t||!e)throw Error("Cannot construct image data without dimensions");if(KZ)try{return new ImageData(t,e)}catch(t){KZ=!1}return ZZ(t,e,i)}function HZ(t,e,i,s){if(!e||!i)throw Error("Cannot construct image data without dimensions");if(KZ)try{return new ImageData(t,e,i)}catch(t){KZ=!1}const n=ZZ(e,i,s);return n.data.set(t,0),n}function JZ(t,e,i,s=0,n=0,r=t.width-s,o=t.height-n,a=!1){const{data:l}=t,{width:u,height:c,data:h}=e,d=r/u,f=o/c,p=Math.ceil(d/2),y=Math.ceil(f/2),m=t.width;for(let t=0;t<c;t++)for(let e=0;e<u;e++){const r=4*(e+(a?c-t-1:t)*u);let o=0,g=0,v=0,w=0,b=0,M=0;const S=(t+.5)*f;for(let r=Math.floor(t*f);r<(t+1)*f;r++){const t=Math.abs(S-(r+.5))/y,a=(e+.5)*d,u=t*t;for(let t=Math.floor(e*d);t<(e+1)*d;t++){const e=Math.abs(a-(t+.5))/p,c=Math.sqrt(u+e*e);if(c>=1)continue;let h=2*c*c*c-3*c*c+1;const d=4*(s+t+(n+r)*m);M+=h*l[d+3],g+=h,!i&&l[d+3]<255&&(h=h*l[d+3]/255),v+=h*l[d],w+=h*l[d+1],b+=h*l[d+2],o+=h}}h[r]=v/o,h[r+1]=w/o,h[r+2]=b/o,h[r+3]=M/g}return e}function ZZ(t,e,i){return i||(QZ||(QZ=document.createElement("canvas"),QZ.width=1,QZ.height=1),i=QZ),i.getContext("2d").createImageData(t,e)}let QZ=null,KZ=!0;const YZ={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},XZ="png",tQ={png:100,jpg:98,jpeg:98};function eQ(t,e,i={}){if(!window.WebGLRenderingContext)return sQ(t,nQ),null;const s=iQ(t,e,i);return c(s)&&sQ(t,rQ),s}function iQ(t,e,i={}){const s=1===e?["webgl","experimental-webgl","webkit-3d","moz-webgl"]:["webgl2"];let n=null;for(const e of s){try{n=t.getContext(e,i)}catch(t){}if(n)break}return n}function sQ(t,e){const i=t.parentNode;i&&(i.innerHTML='<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+e+"</div></div></td></tr></table>")}const nQ='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',rQ='It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>';let oQ;function aQ(){return oQ||(oQ=function(){const t={available:!1,version:0,majorPerformanceCaveat:!1,maxTextureSize:0,supportsHighPrecisionFragment:!1,supportsVertexShaderSamplers:!1,supportsElementIndexUint:!1,supportsStandardDerivatives:!1,supportsInstancedArrays:!1,supportsTextureFloat:!1,supportsColorBufferFloat:!1};if(void 0===typeof WebGLRenderingContext)return t;const e=document.createElement("canvas");if(!e)return t;let i=iQ(e,1,{failIfMajorPerformanceCaveat:!0});if(c(i)&&(i=iQ(e,1),u(i)&&(t.majorPerformanceCaveat=!0)),c(i))return t;const s=i.getParameter(i.VERSION);if(!s)return t;const n=s.match(/^WebGL\s+([\d.]*)/);if(n){t.available=parseFloat(n[1])>=.94;const e=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);e&&(t.supportsHighPrecisionFragment=e.precision>0),t.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0,t.supportsElementIndexUint=null!==i.getExtension("OES_element_index_uint"),t.supportsStandardDerivatives=null!==i.getExtension("OES_standard_derivatives"),t.supportsInstancedArrays=null!==i.getExtension("ANGLE_instanced_arrays"),t.supportsTextureFloat=null!==i.getExtension("OES_texture_float"),t.supportsColorBufferFloat=null!==i.getExtension("WEBGL_color_buffer_float")&&null!==i.getExtension("EXT_float_blend")}return t.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),t.version=function(){if(void 0===typeof WebGL2RenderingContext)return!1;const t=document.createElement("canvas");return!!t&&!!u(iQ(t,2))}()?2:1,t}()),oQ}const lQ={checkMajorWebPerformanceCaveat:!0};let uQ=class extends Ar{constructor(){super(...arguments),this.widget=null}destroy(){this.widget&&this.widget.destroy(),this.node=null}get id(){return this.get("widget.id")||this.get("node.id")}set node(t){const e=this._get("node");t!==e&&(t&&t.classList.add("esri-component"),e&&e.classList.remove("esri-component"),this._set("node",t))}castNode(t){return t?"string"==typeof t||function(t){return t&&"nodeType"in t}(t)?(this._set("widget",null),ca(t)):(function(t){return t&&"function"==typeof t.render}(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};e([Hn({dependsOn:[]})],uQ.prototype,"id",null),e([Hn()],uQ.prototype,"node",null),e([xa("node")],uQ.prototype,"castNode",null),e([Hn({readOnly:!0})],uQ.prototype,"widget",void 0),uQ=e([_r("esri.views.ui.Component")],uQ);const cQ=uQ,hQ={left:0,top:0,bottom:0,right:0},dQ={bottom:30,top:15,right:15,left:15},fQ="manual",pQ="esri-ui-corner";function yQ(t){const e=t,i="object"==typeof e&&null!==e&&Object.getPrototypeOf(e);return null!==i&&i!==Object.prototype||!("component"in e||"index"in e||"position"in e)?null:t}function mQ(t,{top:e,bottom:i,left:s,right:n}){t.style.top=e,t.style.bottom=i,t.style.left=s,t.style.right=n}let gQ=class extends Cr.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=[],this._componentToKey=new Map,this._handles=new Qr,this.view=null,this._initContainers()}initialize(){this._handles.add([Yr(this,"view.padding, container",this._applyViewPadding.bind(this)),Yr(this,"padding",this._applyUIPadding.bind(this))])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(t){const e=this._get("container");t!==e&&(t&&(t.classList.add("esri-ui"),t.classList.add("calcite-theme-"+(ql()?"dark":"light")),this._attachContainers(t)),e&&(e.classList.remove("esri-ui"),mQ(e,{top:"",bottom:"",left:"",right:""}),ha(e)),this._set("container",t))}get height(){const t=this.get("view.height")||0;if(0===t)return t;const e=this._getViewPadding();return Math.max(t-(e.top+e.bottom),0)}get padding(){return this._get("padding")}set padding(t){t?this._override("padding",t):this._clearOverride("padding")}castPadding(t){return"number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...dQ,...t}}get width(){const t=this.get("view.width")||0;if(0===t)return t;const e=this._getViewPadding();return Math.max(t-(e.left+e.right),0)}add(t,e){let i,s;if(Array.isArray(t))return void t.forEach((t=>this.add(t,e)));const n=yQ(t);n&&({index:i,position:e,component:t,key:s}=n),e&&"object"==typeof e&&({index:i,key:s,position:e}=e),!t||e&&!this._isValidPosition(e)||this._add(t,e,i,s)}remove(t,e){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,e)));const i=this._find(t);if(i){const s=this._componentToKey;if(s.has(t)&&s.get(t)!==e)return;const n=this._components.indexOf(i);return i.node.parentNode&&i.node.parentNode.removeChild(i.node),this._componentToKey.delete(t),this._components.splice(n,1)[0]}}empty(t){return Array.isArray(t)?t.map((t=>this.empty(t))).reduce(((t,e)=>t.concat(e))):(t=t||fQ)===fQ?Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(pQ))).map((t=>this.remove(t))):this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null}move(t,e){if(Array.isArray(t)&&t.forEach((t=>this.move(t,e))),!t)return;let i;const s=yQ(t)||yQ(e);if(s&&(i=s.index,e=s.position,t=s.component||t),e&&!this._isValidPosition(e))return;const n=this.remove(t);n&&this.add(n,{position:e,index:i})}find(t){if(!t)return null;const e=this._findById(t);return e&&(e.widget||e.node)}getPosition(t){for(const e in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[e].contains(t))return e;return null}_add(t,e,i,s){t instanceof cQ||(t=new cQ({node:t})),this._place({component:t,position:e,index:i}),this._components.push(t),s&&this._componentToKey.set(t,s)}_find(t){return t?t instanceof cQ?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.get("view.padding")||hQ}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add("esri-ui-inner-container"),t.classList.add("esri-ui-corner-container");const e=document.createElement("div");e.classList.add("esri-ui-inner-container"),e.classList.add("esri-ui-manual-container");const i=document.createElement("div");i.classList.add("esri-ui-top-left"),i.classList.add(pQ),t.appendChild(i);const s=document.createElement("div");s.classList.add("esri-ui-top-right"),s.classList.add(pQ),t.appendChild(s);const n=document.createElement("div");n.classList.add("esri-ui-bottom-left"),n.classList.add(pQ),t.appendChild(n);const r=document.createElement("div");r.classList.add("esri-ui-bottom-right"),r.classList.add(pQ),t.appendChild(r),this._innerContainer=t,this._manualContainer=e;const o=Pl();this._cornerNameToContainerLookup={"top-left":i,"top-right":s,"bottom-left":n,"bottom-right":r,"top-leading":o?s:i,"top-trailing":o?i:s,"bottom-leading":o?r:n,"bottom-trailing":o?n:r},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const e=t.component,i=t.index,s=this._positionNameToContainerLookup[t.position||fQ],n=i>-1;if(function(t){return t&&!t._started&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}(e.widget)&&e.widget.startup(),!n)return void s.appendChild(e.node);const r=Array.prototype.slice.call(s.children);0!==i?i>=r.length?s.appendChild(e.node):da(e.node,r[i]):s.firstChild?da(e.node,s.firstChild):s.appendChild(e.node)}_applyViewPadding(){const t=this.container;t&&mQ(t,this._toPxPosition(this._getViewPadding()))}_applyUIPadding(){const t=this._innerContainer;t&&mQ(t,this._toPxPosition(this.padding))}_toPxPosition(t){return{top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}}_toPxUnit(t){return 0===t?"0":t+"px"}_findByComponent(t){let e,i=null;return this._components.some((s=>(e=s===t,e&&(i=s),e))),i}_findById(t){let e,i=null;return this._components.some((s=>(e=s.id===t,e&&(i=s),e))),i}_findByNode(t){let e,i=null;return this._components.some((s=>(e=s.node===t,e&&(i=s),e))),i}};e([Hn()],gQ.prototype,"container",null),e([Hn()],gQ.prototype,"height",null),e([Hn({value:dQ})],gQ.prototype,"padding",null),e([xa("padding")],gQ.prototype,"castPadding",null),e([Hn()],gQ.prototype,"view",void 0),e([Hn()],gQ.prototype,"width",null),gQ=e([_r("esri.views.ui.UI")],gQ);const vQ=gQ;function wQ(t,e){return t&&"copyright"in t&&(!e||"function"==typeof t.originOf&&"user"===t.originOf("copyright"))}function bQ(t,e,i){i&&e&&(t.find((t=>t.layerView===e&&t.text===i))||t.push({text:i,layerView:e}))}const MQ=[];let SQ=class extends Gw{constructor(t){super(t),this.clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new Jr,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const e=this.get("view.allLayerViews");e&&this.handles.add(e.map((t=>t.watch(["suspended","attributionVisible"],this._updateAttributionItems))),"suspension"),t&&t.removed&&t.removed.forEach((t=>{this._pendingAttributions.delete(t),this._fetchedAttributionData.delete(t)})),this._updateAttributionItems()},this._updateAttributionItems=()=>{const t=this.get("view.allLayerViews");MQ.length=0,t?(t.forEach((t=>{if(t.suspended||!t.get("layer.attributionVisible"))return;const e=t.layer;if(wQ(e,"user"))return void bQ(MQ,t,e.copyright);if(e.hasAttributionData){if(this._fetchedAttributionData.has(t)){const i=this._fetchedAttributionData.get(t);return void(i?bQ(MQ,t,this._getDynamicAttribution(i,this.view,e)):wQ(e)&&bQ(MQ,t,e.copyright))}return void this._fetchAttributionData(t)}const i=e.get("portalItem.accessInformation");bQ(MQ,t,i||e.copyright)})),function(t,e){return t.length!==e.length||t.some(((t,i)=>t.text!==e[i].text))}(this.items,MQ)&&(this.items.removeAll(),this.items.addMany(MQ)),MQ.length=0,this.notifyChange("state")):this.clear()},this.handles.add([uo(this,"view.allLayerViews","change",this._allLayerViewsChange,this._allLayerViewsChange,this.clear),no(this,"view.stationary",(()=>this._updateAttributionItems()))])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await uh(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const i=e.ok?this._createContributionIndex(e.value,function(t){return"bing-maps"===t.type}(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,i)}this._updateAttributionItems()}_createContributionIndex(t,e){const i=t.contributors,s={};if(!i)return s;for(let t=0;t<i.length;t++){const n=i[t],r=n.coverageAreas;if(!r)return;for(const i of r){const r=i.bbox,o=i.zoomMin-(e&&i.zoomMin?1:0),a=i.zoomMax-(e&&i.zoomMax?1:0),l={extent:td({xmin:r[1],ymin:r[0],xmax:r[3],ymax:r[2],spatialReference:Lh.WGS84}),attribution:n.attribution||"",score:null!=i.score?i.score:100,id:t};for(let t=o;t<=a;t++)s[t]=s[t]||[],s[t].push(l)}}return s.maxKey=Math.max.apply(null,Object.keys(s)),s}_getDynamicAttribution(t,e,i){const{extent:s,scale:n}=e;let r=i.tileInfo.scaleToZoom(n);if(r=Math.min(t.maxKey,Math.round(r)),!s||null==r||r<=-1)return"";const o=t[r],a=Kh(s.center.clone().normalize(),e.spatialReference),l={};return o?o.filter((t=>{const e=!l[t.id]&&a&&ud(t.extent,a);return e&&(l[t.id]=!0),e})).sort(((t,e)=>e.score-t.score||t.objectId-e.objectId)).map((t=>t.attribution)).join(", "):""}};e([Hn({readOnly:!0,type:Jr})],SQ.prototype,"items",void 0),e([Hn({readOnly:!0})],SQ.prototype,"state",null),e([Hn()],SQ.prototype,"view",void 0),SQ=e([_r("esri.widgets.Attribution.AttributionViewModel")],SQ);const xQ=SQ;let kQ=class extends Gc{constructor(t,e){super(t,e),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this.iconClass="esri-icon-description",this.itemDelimiter=" | ",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new xQ}initialize(){this.own(uo(this,"viewModel.items","change",(()=>this.scheduleRender())))}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((t,e)=>(-1===t.indexOf(e.text)&&t.push(e.text),t)),[]).join(this.itemDelimiter)}render(){return Fw("div",{bind:this,class:this.classes("esri-attribution esri-widget",{"esri-attribution--open":this._isOpen}),onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return Fw("div",{class:"esri-attribution__powered-by"},"Powered by"," ",Fw("a",{class:"esri-attribution__link",href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const t=this._isOpen,e=this._isInteractive,i=e?0:-1,{attributionText:s}=this,n=e?"button":void 0;return Fw("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes("esri-attribution__sources",{"esri-attribution__sources--open":t,"esri-interactive":e}),innerHTML:s,role:n,tabIndex:i})}_afterSourcesNodeCreate(t){this._prevSourceNodeHeight=t.clientWidth}_afterSourcesNodeUpdate(t){let e=!1;const{clientHeight:i,clientWidth:s,scrollWidth:n}=t,r=n>=s,o=this._attributionTextOverflowed!==r;if(this._attributionTextOverflowed=r,o&&(e=!0),this._isOpen){const t=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,t&&(this._isOpen=!1,e=!0)}e&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};e([Hn()],kQ.prototype,"_isOpen",void 0),e([Hn()],kQ.prototype,"_isInteractive",null),e([Hn()],kQ.prototype,"_attributionTextOverflowed",void 0),e([Hn()],kQ.prototype,"_prevSourceNodeHeight",void 0),e([Hn({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],kQ.prototype,"attributionText",null),e([Hn()],kQ.prototype,"iconClass",void 0),e([Hn()],kQ.prototype,"itemDelimiter",void 0),e([Hn({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],kQ.prototype,"label",void 0),e([Hn(),Lw("esri/widgets/Attribution/t9n/Attribution")],kQ.prototype,"messages",void 0),e([go("viewModel.view")],kQ.prototype,"view",void 0),e([Hn({type:xQ})],kQ.prototype,"viewModel",void 0),e([Pw()],kQ.prototype,"_toggleState",null),kQ=e([_r("esri.widgets.Attribution")],kQ);const IQ=kQ;let jQ=class extends(SV(Ar)){constructor(t){super(t),this._handles=new Qr,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._handles.add(Yr(this,"view",this._updateRotationWatcher))}destroy(){this._handles.destroy(),this._handles=null,this.view=null}get canShowNorth(){const t=this.get("view.spatialReference");return!(!t||!t.isWebMercator&&!t.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const t={};"2d"===this.view.type?t.rotation=0:t.heading=0,this.callGoTo({target:t})}_updateForRotation(t){null!=t&&(this.orientation={z:t})}_updateForCamera(t){t&&(this.orientation={x:0,y:0,z:-t.heading})}_updateRotationWatcher(t){this._handles.removeAll(),t&&this._handles.add("2d"===t.type?Yr(this,"view.rotation",this._updateForRotation):Yr(this,"view.camera",this._updateForCamera))}};e([Hn({readOnly:!0})],jQ.prototype,"canShowNorth",null),e([Hn()],jQ.prototype,"orientation",void 0),e([Hn({readOnly:!0})],jQ.prototype,"state",null),e([Hn()],jQ.prototype,"view",void 0),jQ=e([_r("esri.widgets.CompassViewModel")],jQ);const _Q=jQ;let TQ=class extends Gc{constructor(t,e){super(t,e),this.goToOverride=null,this.iconClass="esri-icon-locate-circled",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new _Q}reset(){return this.viewModel.reset()}render(){const{orientation:t,state:e}=this.viewModel,i="disabled"===e,s="compass"==("rotation"===e?"rotation":"compass"),n=i?-1:0,r={"esri-disabled":i,"esri-interactive":!i},o={"esri-icon-compass":s,"esri-icon-dial":!s},{messages:a}=this;return Fw("div",{bind:this,class:this.classes("esri-compass esri-widget--button esri-widget",r),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:n,"aria-label":a.reset,title:a.reset},Fw("span",{"aria-hidden":"true",class:this.classes("esri-compass__icon",o),styles:this._toRotationTransform(t)}),Fw("span",{class:"esri-icon-font-fallback-text"},a.reset))}_reset(){this.viewModel.reset()}_toRotationTransform(t){return{transform:`rotateZ(${t.z}deg)`}}};e([go("viewModel.goToOverride")],TQ.prototype,"goToOverride",void 0),e([Hn()],TQ.prototype,"iconClass",void 0),e([Hn({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],TQ.prototype,"label",void 0),e([Hn(),Lw("esri/widgets/Compass/t9n/Compass")],TQ.prototype,"messages",void 0),e([go("viewModel.view")],TQ.prototype,"view",void 0),e([Hn({type:_Q})],TQ.prototype,"viewModel",void 0),e([Pw()],TQ.prototype,"_reset",null),TQ=e([_r("esri.widgets.Compass")],TQ);const OQ=TQ;let AQ=class extends Ar{constructor(t){super(t),this._handles=new Qr,this.navigationMode="pan",this.view=null}initialize(){this._handles.add(to(this,"view.inputManager",this._setNavigationMode.bind(this)))}destroy(){this._handles.destroy(),this._handles=null,this.view=null}get state(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate"}};e([Hn({readOnly:!0})],AQ.prototype,"state",null),e([Hn()],AQ.prototype,"navigationMode",void 0),e([Hn()],AQ.prototype,"view",void 0),AQ=e([_r("esri.widgets.NavigationToggleViewModel")],AQ);const FQ=AQ,CQ="esri-navigation-toggle__button esri-widget--button";let PQ=class extends Gc{constructor(t,e){super(t,e),this.iconClass="esri-icon-pan2",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new FQ}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t)}toggle(){return this.viewModel.toggle()}render(){const t="disabled"===this.get("viewModel.state"),e="pan"===this.get("viewModel.navigationMode"),i={"esri-navigation-toggle__button--active":e},s={"esri-navigation-toggle__button--active":!e},n=t?-1:0,r=this.messages.toggle;return Fw("div",{bind:this,class:this.classes("esri-navigation-toggle esri-widget",{"esri-disabled":t,"esri-navigation-toggle--horizontal":"horizontal"===this.layout}),onclick:this._toggle,onkeydown:this._toggle,tabIndex:n,"aria-label":r,title:r},Fw("div",{class:this.classes(CQ,"esri-navigation-toggle__button--pan",i)},Fw("span",{class:"esri-icon-pan"})),Fw("div",{class:this.classes(CQ,"esri-navigation-toggle__button--rotate",s)},Fw("span",{class:"esri-icon-rotate"})))}_toggle(){this.toggle()}};e([Hn()],PQ.prototype,"iconClass",void 0),e([Hn({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],PQ.prototype,"label",void 0),e([Hn({value:"vertical"})],PQ.prototype,"layout",null),e([Hn(),Lw("esri/widgets/NavigationToggle/t9n/NavigationToggle")],PQ.prototype,"messages",void 0),e([go("viewModel.view")],PQ.prototype,"view",void 0),e([Hn({type:FQ})],PQ.prototype,"viewModel",void 0),e([Pw()],PQ.prototype,"_toggle",null),PQ=e([_r("esri.widgets.NavigationToggle")],PQ);const EQ=PQ;let LQ=class extends Gc{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title=""}render(){const t=this.enabled?0:-1,e={[this.iconClass]:!!this.iconClass};return Fw("div",{bind:this,class:this.classes("esri-widget--button esri-widget",{"esri-disabled":!this.enabled,"esri-interactive":this.enabled}),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:t,title:this.title},Fw("span",{"aria-hidden":"true",role:"presentation",class:this.classes("esri-icon",e)}),Fw("span",{class:"esri-icon-font-fallback-text"},this.title))}_triggerAction(){this.action.call(this)}};e([Hn()],LQ.prototype,"action",void 0),e([Hn()],LQ.prototype,"enabled",void 0),e([Hn()],LQ.prototype,"iconClass",void 0),e([Hn()],LQ.prototype,"title",void 0),e([Pw()],LQ.prototype,"_triggerAction",null),LQ=e([_r("esri.widgets.IconButton")],LQ);const RQ=LQ;let NQ=class extends Ar{get canZoomIn(){if(!this.get("view.ready"))return!1;const t=this.get("view.animation.target.scale")||this.get("view.scale"),e=this.get("view.constraints.effectiveMaxScale");return 0===e||t>e}get canZoomOut(){if(!this.get("view.ready"))return!1;const t=this.get("view.animation.target.scale")||this.get("view.scale"),e=this.get("view.constraints.effectiveMinScale");return 0===e||t<e}};e([Hn({readOnly:!0})],NQ.prototype,"canZoomIn",null),e([Hn({readOnly:!0})],NQ.prototype,"canZoomOut",null),e([Hn()],NQ.prototype,"view",void 0),NQ=e([_r("esri.widgets.Zoom.ZoomConditions2D")],NQ);const DQ=NQ;let VQ=class extends Ar{get canZoomIn(){return!!this.get("view.ready")}get canZoomOut(){return!!this.get("view.ready")}};e([Hn({readOnly:!0})],VQ.prototype,"canZoomIn",null),e([Hn({readOnly:!0})],VQ.prototype,"canZoomOut",null),e([Hn()],VQ.prototype,"view",void 0),VQ=e([_r("esri.widgets.Zoom.ZoomConditions3D")],VQ);const $Q=VQ;let zQ=class extends Ar{constructor(t){super(t),this.canZoomIn=!1,this.canZoomOut=!1}destroy(){this.view=null}get state(){return this.get("view.ready")?"ready":"disabled"}set view(t){t?"2d"===t.type?this._zoomConditions=new DQ({view:t}):"3d"===t.type&&(this._zoomConditions=new $Q({view:t})):this._zoomConditions=null,this._set("view",t)}zoomIn(){if(!this.canZoomIn)return;const t=this.view;"2d"===t.type?t.mapViewNavigation.zoomIn():Ue(t.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const t=this.view;"2d"===t.type?t.mapViewNavigation.zoomOut():Ue(t.goTo({zoomFactor:.5}))}};e([Hn()],zQ.prototype,"_zoomConditions",void 0),e([Hn({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],zQ.prototype,"canZoomIn",void 0),e([Hn({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],zQ.prototype,"canZoomOut",void 0),e([Hn({readOnly:!0})],zQ.prototype,"state",null),e([Hn()],zQ.prototype,"view",null),zQ=e([_r("esri.widgets.Zoom.ZoomViewModel")],zQ);const GQ=zQ;let UQ=class extends Gc{constructor(t,e){super(t,e),this.iconClass="esri-icon-zoom-in-magnifying-glass",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new GQ}initialize(){this._zoomInButton=new RQ({action:this.zoomIn.bind(this),iconClass:"esri-icon-plus"}),this._zoomOutButton=new RQ({action:this.zoomOut.bind(this),iconClass:"esri-icon-minus"})}destroy(){this._zoomInButton.destroy(),this._zoomOutButton.destroy(),this._zoomInButton=null,this._zoomOutButton=null}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t)}render(){const t=this.viewModel,e={"esri-zoom--horizontal":"horizontal"===this.layout};return this._zoomInButton.enabled="ready"===t.state&&t.canZoomIn,this._zoomOutButton.enabled="ready"===t.state&&t.canZoomOut,this._zoomInButton.title=this.messages.zoomIn,this._zoomOutButton.title=this.messages.zoomOut,Fw("div",{class:this.classes("esri-zoom esri-widget",e)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};e([Hn()],UQ.prototype,"iconClass",void 0),e([Hn({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],UQ.prototype,"label",void 0),e([Hn({value:"vertical"})],UQ.prototype,"layout",null),e([Hn(),Lw("esri/widgets/Zoom/t9n/Zoom")],UQ.prototype,"messages",void 0),e([go("viewModel.view")],UQ.prototype,"view",void 0),e([Hn({type:GQ})],UQ.prototype,"viewModel",void 0),UQ=e([_r("esri.widgets.Zoom")],UQ);const qQ=UQ,BQ="esri.views.ui.DefaultUI";ct.getLogger(BQ);let WQ=class extends vQ{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-leading","navigation-toggle":"top-leading",zoom:"top-leading"},this.components=[]}initialize(){this._handles.add([Yr(this,"components",this._componentsWatcher.bind(this)),Yr(this,"view",this._updateViewAwareWidgets.bind(this))])}_add(t,e,i,s){if("string"==typeof t&&this._defaultPositionLookup[t]){if(this._find(t))return;t=this._createComponent(t)}super._add(t,e,i,s)}_removeComponents(t){t.forEach((t=>{const e=this._find(t);e&&(this.remove(e),e.destroy())}))}_updateViewAwareWidgets(t){this.components.forEach((e=>{const i=this._find(e),s=i&&i.widget;(function(t){return t&&void 0!==t.view})(s)&&(s.view=t)}))}_componentsWatcher(t,e){this._removeComponents(e),this._addComponents(t),this._adjustPadding(t)}_adjustPadding(t){if(-1===t.indexOf("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t}}_addComponents(t){this.initialized&&t.forEach((t=>this.add(this._createComponent(t),this._defaultPositionLookup[t])))}_createComponent(t){const e=this._createWidget(t);if(e)return new cQ({id:t,node:e})}_createWidget(t){return"attribution"===t?this._createAttribution():"compass"===t?this._createCompass():"navigation-toggle"===t?this._createNavigationToggle():"zoom"===t?this._createZoom():void 0}_createAttribution(){return new IQ({view:this.view})}_createCompass(){return new OQ({view:this.view})}_createNavigationToggle(){return new EQ({view:this.view})}_createZoom(){return new qQ({view:this.view})}};e([Hn()],WQ.prototype,"components",void 0),WQ=e([_r(BQ)],WQ);const HQ=WQ;let JQ=class extends HQ{constructor(t){super(t),this.components=["attribution","zoom"]}};e([Hn()],JQ.prototype,"components",void 0),JQ=e([_r("esri.views.ui.2d.DefaultUI2D")],JQ);const ZQ=JQ,QQ=ct.getLogger("esri.views.MapView");let KQ,YQ,XQ,tK,eK,iK;function sK(t,e,i){if(t)if(Array.isArray(t)||Jr.isCollection(t)){if(0===t.length)return;t.forEach((t=>sK(t,e,i)))}else!function(t){return t instanceof s_}(t)?i.add(t):e.add(t)}let nK=class extends(u$(cB(KJ))){constructor(t){super(t),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new FV({getCollections:()=>{var t,e;return[null==(t=this.basemapView)?void 0:t.baseLayerViews,this.layerViews,null==(e=this.basemapView)?void 0:e.referenceLayerViews]},getChildrenFunction:()=>null}),this.floors=new Jr,this.graphicsView=null,this.highlightOptions=new qZ,this.inputManager=new zZ({view:this}),this.mapViewNavigation=null,this.supersampleScreenshotsEnabled=!1,this.ui=new ZQ,this.rendering=!1,JC()}destroy(){this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get background(){return this.get("map.initialViewProperties.background")||null}set background(t){void 0===t?this._clearOverride("background"):this._override("background",t)}get textureManager(){return this._stage.painter.textureManager}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}toMap(t){if(PB(t)){const e=CB(this,t);return super.toMap(e)}return super.toMap(t)}hitTest(t,e){const i=PB(t)?CB(this,t):t;if(!this.ready||isNaN(i.x)||isNaN(i.y))return Promise.resolve({screenPoint:i,results:[]});const s=this.toMap(i),n=[this.graphicsView];n.push.apply(n,this.allLayerViews.toArray().reverse());const r=new Set,o=new Set,a=new Set,l=new Set;return e&&(sK(e&&e.include,r,a),sK(e&&e.exclude,o,l)),Promise.all(n.map((t=>!t||!t.hitTest||a.size>0&&!t.layer||a.size>0&&t.layer&&!a.has(t.layer)||l.size>0&&t.layer&&l.has(t.layer)?null:t.hitTest(i.x,i.y)))).then((t=>({screenPoint:i,results:t.filter((t=>null!=t&&(!(r.size>0)||r.has(t))&&(!(o.size>0)||!o.has(t)))).map((t=>({mapPoint:s,graphic:t})))})))}takeScreenshot(t){if(t=t||{},!this.ready)return Promise.reject("Map view cannot be used before it is ready");const e=this.supersampleScreenshotsEnabled?Math.min(4,function(t,e){return e/Math.max(t[0],t[1])}(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let i;t.layers?(i=[],t.layers.forEach((t=>{const e=this.allLayerViews.find((e=>e.layer.id===t.id));e&&"container"in e&&e.container&&i.push(e.container)}))):i=this._stage.children;const{format:s,quality:n}=function(t,e){const i=function(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return XZ}}(t);return{format:i,quality:qp(null!=e?e:tQ[i],0,100)}}(t.format,t.quality),r=function(t,e,i,s,n,r,o,a){let l;t.ignorePadding&&(s={left:0,right:0,top:0,bottom:0}),null!=t.width&&null!=t.height?l=[t.width,t.height]:null==t.width&&null!=t.height?l=[t.height,t.height]:null!=t.width&&null==t.height?l=[t.width,t.width]:null==t.width&&null==t.height&&(l=null);const u=i[0]-(s.left+s.right),c=i[1]-(s.top+s.bottom);let h,d,f=t.area||{x:0,y:0,width:u,height:c};if(l){const t=l[0]/l[1];if(t>u/c){const e=f.width/t;f={x:f.x,y:Math.round(f.y+(f.height-e)/2),width:f.width,height:Math.round(e)}}else{const e=f.height*t;f={x:Math.round(f.x+(f.width-e)/2),y:f.y,width:Math.round(e),height:f.height}}}else l=[f.width,f.height];return l[0]>f.width?(h=Math.min(l[0]/f.width,e),d=l[0]/f.width/h):(h=1,d=l[0]/f.width),{resolutionScale:h,cropArea:{x:Math.round((f.x+s.left)*h),y:Math.round((f.y+s.top)*h),width:Math.round(f.width*h),height:Math.round(f.height*h)},outputScale:d,format:n,quality:r,children:o,rotation:a}}(t,e,this.size,this.padding,s,n,i,t.rotation);return this._stage.takeScreenshot(r)}on(t,e,i,s){return this.inputManager&&this.viewEvents.on(t,e,i,s)||super.on(t,e)}hasEventListener(t){return super.hasEventListener(t)||this.viewEvents.hasHandler(t)}whenLayerView(t){return super.whenLayerView(t)}graphicChanged(t){this.graphicsView&&this.graphicsView.graphicUpdateHandler(t)}whenReady(){return new Promise((t=>{this.ready?t(this):this._resolveWhenReady.push(t)}))}forceDOMReadyCycle(){this.forceReadyCycle()}validate(){let t=function(t){t={...lQ,...t};const e=aQ();return e.available?t.checkMajorWebPerformanceCaveat&&e.majorPerformanceCaveat?new dt("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?e.supportsElementIndexUint?e.supportsStandardDerivatives?e.supportsInstancedArrays?null:new dt("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported."):new dt("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported."):new dt("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported."):new dt("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new dt("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new dt("webgl:required","WebGL is required but not supported.")}({checkMajorWebPerformanceCaveat:!1});return l("safari")&&l("safari")<9&&(t=new dt("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:l("safari")})),u(t)?(QQ.warn("#validate()",t.message),Promise.reject(t)):async function(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:i,MapViewNavigation:s,MagnifierView2D:n,Stage:r}]=await Promise.all([import("./p-8298edc6.js"),import("./p-2f4bee32.js")]);YQ=t,XQ=e,tK=i,eK=s,iK=n,KQ=r}()}_startup(){this.timeline.begin("MapView Startup"),super._startup(),this.graphics.owner=this;const t=new KQ(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline}),e=new YQ({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new XQ(this.featuresTilingScheme)}),i=new eK({view:this,animationManager:this.animationManager}),s=new tK({view:this});this._magnifierView=new iK,this._magnifierView.magnifier=this.magnifier,this._stage=t,this.frameTask.graphicsView=e,this._set("graphicsView",e),this._set("mapViewNavigation",i),this._set("labelManager",s),this.handles.add([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),t.on("post-render",(()=>this._set("rendering",t.renderRequested))),t.on("will-render",(()=>this._set("rendering",t.renderRequested))),t.on("webgl-error",(t=>this.fatalError=t.error)),Yr(this,"stationary",(e=>t.stationary=e),!0),Yr(this,"state.id",(()=>t.state=this.state),!0),Yr(this,"background",(e=>{t.background=e,this._magnifierView.background=e}),!0),Yr(this,"magnifier",(t=>this._magnifierView.magnifier=t),!0),Yr(this,"renderingOptions",(e=>t.renderingOptions=e),!0),Yr(this,"highlightOptions",(()=>t.highlightOptions=this.highlightOptions),!0)],"map-view"),t.state=this.state,this._updateStageChildren();const n=this._resolveWhenReady;this._resolveWhenReady=[],n.forEach((t=>t(this))),this.timeline.end("MapView Startup")}_teardown(){this.handles.remove("map-view"),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this.graphicsView.destroy(),this.mapViewNavigation.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,super._teardown()}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach((t=>{this._stage.addChild(t.container)})),this._stage.addChild(this.graphicsView.container),this._stage.addChild(this._magnifierView)}};e([Hn({type:r$})],nK.prototype,"background",null),e([Hn()],nK.prototype,"floors",void 0),e([Hn()],nK.prototype,"graphicsView",void 0),e([Hn({type:qZ})],nK.prototype,"highlightOptions",void 0),e([Hn({readOnly:!0})],nK.prototype,"inputManager",void 0),e([Hn({readOnly:!0})],nK.prototype,"textureManager",null),e([Hn({readOnly:!0})],nK.prototype,"mapViewNavigation",void 0),e([Hn({type:Boolean})],nK.prototype,"navigating",null),e([Hn({type:Boolean,constructOnly:!0})],nK.prototype,"supersampleScreenshotsEnabled",void 0),e([Hn({type:ZQ})],nK.prototype,"ui",void 0),e([Hn({readOnly:!0})],nK.prototype,"rendering",void 0),e([Hn({constructOnly:!0})],nK.prototype,"renderCanvas",void 0),e([Hn({constructOnly:!0})],nK.prototype,"deactivatedWebGLExtensions",void 0),e([Hn({constructOnly:!0})],nK.prototype,"debugWebGLExtensions",void 0),nK=e([_r("esri.views.MapView")],nK);const rK=nK;export{Xv as $,dv as A,ti as B,Ah as C,fv as D,oi as E,ov as F,Th as G,Rm as H,Nf as I,ip as J,rp as K,np as L,Jp as M,lp as N,fp as O,Qr as P,Yr as Q,Sf as R,Jr as S,ct as T,Bc as U,ma as V,ef as W,xa as X,Xr as Y,uo as Z,If as _,Ge as a,vo as a$,go as a0,Lw as a1,Pw as a2,Gc as a3,eo as a4,Fw as a5,Cw as a6,Ii as a7,ro as a8,lo as a9,Go as aA,qo as aB,Wy as aC,Rl as aD,Te as aE,Qy as aF,Zo as aG,Jo as aH,Uo as aI,je as aJ,T as aK,s_ as aL,S_ as aM,V as aN,To as aO,n_ as aP,na as aQ,aD as aR,aO as aS,zS as aT,XO as aU,ND as aV,LD as aW,UD as aX,GD as aY,Wj as aZ,TD as a_,Nw as aa,Dw as ab,pa as ac,El as ad,ca as ae,zw as af,Pl as ag,Gl as ah,Ae as ai,$l as aj,Cr as ak,f_ as al,Vb as am,$b as an,zb as ao,ib as ap,Ub as aq,Bb as ar,jb as as,_b as at,eb as au,Gb as av,sb as aw,Wb as ax,Ko as ay,jo as az,dt as b,cf as b$,Nj as b0,Pj as b1,lE as b2,PA as b3,Be as b4,Xe as b5,ao as b6,ye as b7,xe as b8,eV as b9,PS as bA,Rw as bB,zl as bC,ot as bD,GA as bE,Tt as bF,MP as bG,Rh as bH,UA as bI,ME as bJ,fh as bK,eR as bL,K as bM,lM as bN,eP as bO,Gn as bP,i$ as bQ,r$ as bR,we as bS,hh as bT,Xc as bU,P as bV,gf as bW,ed as bX,jf as bY,_f as bZ,AP as b_,tV as ba,iV as bb,PT as bc,XS as bd,no as be,Cl as bf,xu as bg,YS as bh,yS as bi,lh as bj,Xg as bk,ad as bl,Ln as bm,vV as bn,wV as bo,gV as bp,MV as bq,Ti as br,l as bs,td as bt,it as bu,SV as bv,wj as bw,Ox as bx,$j as by,Ze as bz,Tw as c,Re as c$,Qt as c0,Xt as c1,pe as c2,BV as c3,rK as c4,Xw as c5,Kw as c6,cV as c7,fV as c8,lV as c9,bA as cA,i as cB,Ez as cC,UU as cD,KC as cE,Sz as cF,ER as cG,LR as cH,RR as cI,lP as cJ,wo as cK,ue as cL,Q as cM,WC as cN,Fi as cO,FP as cP,CL as cQ,zL as cR,w as cS,Ne as cT,Ft as cU,XF as cV,ML as cW,sC as cX,F as cY,EO as cZ,Zs as c_,hV as ca,rV as cb,dV as cc,Me as cd,HP as ce,UP as cf,qP as cg,_L as ch,bm as ci,Qw as cj,iv as ck,RD as cl,qD as cm,DD as cn,oI as co,Dk as cp,VD as cq,SA as cr,vO as cs,ae as ct,wA as cu,jk as cv,MA as cw,FI as cx,TI as cy,IA as cz,Hn as d,xz as d$,Fs as d0,rP as d1,WT as d2,UT as d3,qT as d4,BT as d5,Bt as d6,QT as d7,ex as d8,si as d9,Xf as dA,qp as dB,DT as dC,d$ as dD,Dq as dE,sp as dF,ep as dG,JW as dH,ix as dI,OW as dJ,Sy as dK,qW as dL,_W as dM,zW as dN,NW as dO,by as dP,BW as dQ,ei as dR,de as dS,Hw as dT,Ww as dU,Bw as dV,Zw as dW,Jw as dX,Rg as dY,_d as dZ,Sh as d_,k as da,_N as db,eQ as dc,q as dd,B as de,g as df,Bp as dg,Ly as dh,PW as di,Dy as dj,De as dk,Dz as dl,JH as dm,My as dn,OH as dp,O as dq,Vf as dr,Ny as ds,wW as dt,JJ as du,Us as dv,_H as dw,JZ as dx,BZ as dy,WZ as dz,e,pA as e$,kz as e0,jz as e1,jh as e2,hU as e3,jg as e4,iU as e5,MU as e6,bU as e7,tU as e8,Vz as e9,Fh as eA,Mh as eB,Qh as eC,Fv as eD,Lv as eE,tJ as eF,x as eG,OU as eH,fU as eI,tx as eJ,y as eK,uD as eL,NR as eM,DR as eN,VR as eO,hD as eP,ab as eQ,ET as eR,AT as eS,rA as eT,cU as eU,gU as eV,dU as eW,pU as eX,zz as eY,TU as eZ,IU as e_,_z as ea,TJ as eb,pv as ec,Lz as ed,nv as ee,aQ as ef,uv as eg,cv as eh,Ig as ei,GR as ej,UR as ek,zR as el,gH as em,wH as en,bH as eo,AH as ep,SH as eq,MH as er,pV as es,aV as et,rv as eu,Zi as ev,lv as ew,Wp as ex,Yh as ey,Xh as ez,im as f,Hg as f$,b as f0,M as f1,dN as f2,_ as f3,xH as f4,oU as f5,rU as f6,mH as f7,S as f8,Iq as f9,av as fA,ud as fB,Kh as fC,Av as fD,ze as fE,uh as fF,yv as fG,rb as fH,BS as fI,W_ as fJ,H_ as fK,Ob as fL,$z as fM,Ch as fN,nk as fO,kU as fP,mv as fQ,AD as fR,PO as fS,CO as fT,m as fU,ik as fV,ak as fW,Kx as fX,lm as fY,h as fZ,Zx as f_,at as fa,pD as fb,lb as fc,dD as fd,fD as fe,W as ff,kt as fg,$t as fh,Ot as fi,Rt as fj,Ut as fk,Se as fl,SP as fm,le as fn,Wt as fo,I as fp,me as fq,Dh as fr,Km as fs,kg as ft,Ce as fu,He as fv,Je as fw,Ad as fx,Fe as fy,Qe as fz,Bh as g,YE as g$,$m as g0,xh as g1,jU as g2,$G as g3,sU as g4,KG as g5,vd as g6,Fd as g7,cd as g8,j as g9,vm as gA,gm as gB,Ih as gC,yH as gD,vH as gE,gp as gF,kH as gG,jH as gH,Nm as gI,Lm as gJ,Pm as gK,Kf as gL,Ip as gM,_p as gN,Fp as gO,Np as gP,Dp as gQ,Ep as gR,Lp as gS,Rp as gT,$p as gU,zp as gV,kp as gW,Yf as gX,ch as gY,Gw as gZ,MG as g_,R as ga,_J as gb,E as gc,dp as gd,C as ge,$ as gf,pp as gg,Qp as gh,Sp as gi,up as gj,Up as gk,jp as gl,Zp as gm,hy as gn,dy as go,cy as gp,ly as gq,mp as gr,Gv as gs,uy as gt,$v as gu,vy as gv,Mp as gw,gy as gx,mm as gy,Df as gz,Ee as h,mb as h$,gG as h0,Bz as h1,vU as h2,mG as h3,bG as h4,hv as h5,qe as h6,Vw as h7,aR as h8,so as h9,rT as hA,yT as hB,xv as hC,Tv as hD,Ov as hE,Ev as hF,Cv as hG,z as hH,se as hI,ne as hJ,Uw as hK,xs as hL,mW as hM,mJ as hN,xJ as hO,Wc as hP,ga as hQ,rJ as hR,oL as hS,sL as hT,yb as hU,vb as hV,Tb as hW,Sb as hX,kb as hY,xb as hZ,Ib as h_,uU as ha,qb as hb,Yb as hc,ZC as hd,Xs as he,fG as hf,lG as hg,Zz as hh,vG as hi,wU as hj,MC as hk,dA as hl,fA as hm,We as hn,RG as ho,NG as hp,IP as hq,Gz as hr,$h as hs,Ue as ht,cJ as hu,HJ as hv,mU as hw,Uz as hx,G as hy,vp as hz,_r as i,xP as i$,gb as i0,Xb as i1,Hc as i2,pB as i3,RW as i4,ok as i5,Ng as i6,TH as i7,Gk as i8,xD as i9,pP as iA,dE as iB,ds as iC,OL as iD,wL as iE,In as iF,xE as iG,Ci as iH,zN as iI,SN as iJ,QR as iK,FA as iL,CA as iM,VE as iN,lN as iO,FV as iP,fs as iQ,kL as iR,gL as iS,yN as iT,Qn as iU,dh as iV,px as iW,va as iX,TL as iY,xL as iZ,kP as i_,cD as ia,bD as ib,MD as ic,Xx as id,uk as ie,fk as ig,lc as ih,Ru as ii,Du as ij,ac as ik,uc as il,Ju as im,Ok as io,_k as ip,HZ as iq,Fn as ir,Dv as is,qt as it,Wf as iu,oy as iv,hE as iw,lR as ix,KL as iy,QL as iz,Ve as j,Ht as j$,_P as j0,TP as j1,Tk as j2,UV as j3,DV as j4,kh as j5,SL as j6,VL as j7,aL as j8,hb as j9,jP as jA,Jn as jB,Jt as jC,Ck as jD,Zt as jE,Wi as jF,Ek as jG,Rv as jH,rh as jI,lt as jJ,fB as jK,qw as jL,kw as jM,rt as jN,ee as jO,nS as jP,ho as jQ,dR as jR,iN as jS,nx as jT,LA as jU,FL as jV,AL as jW,tr as jX,Qj as jY,bP as jZ,Gs as j_,fb as ja,sN as jb,bL as jc,wN as jd,IL as je,vL as jf,oN as jg,tb as jh,Ke as ji,jG as jj,IG as jk,kG as jl,Zn as jm,kn as jn,yO as jo,_T as jp,QD as jq,YT as jr,KD as js,FO as jt,xO as ju,AA as jv,Un as jw,B_ as jx,X_ as jy,gA as jz,Lh as k,_t as k0,ay as k1,hp as k2,ny as k3,yp as k4,WV as k5,Vp as k6,xp as k7,iy as k8,_s as k9,fy as kA,wn as kB,NT as kC,Hf as kD,d as kE,xi as kF,XT as kG,$O as kH,uP as kI,lD as kJ,xG as kK,Vy as ka,zf as kb,jL as kc,OP as kd,sh as ke,ph as kf,wm as kg,HE as kh,AN as ki,p as kj,xR as kk,ob as kl,OR as km,cp as kn,U as ko,ni as kp,Hp as kq,tk as kr,ek as ks,wy as kt,CP as ku,Yx as kv,$f as kw,sk as kx,ap as ky,Kt as kz,H as l,Pe as m,Wh as n,Ld as o,Ar as p,Xp as q,u as r,v as s,c as t,sv as u,N as v,f as w,Yp as x,ty as y,sy as z}