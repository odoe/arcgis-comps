import { e as e$f, i as i$j, f as s$k, k as S$8, h as s$l, ad as h$h, l as l$j, T as T$7, a as d$h, M as S$9, ab as t$i, aa as b$7, a1 as z$3, aU as $$3, Y as T$8, aV as n$u, p as p$u, g as t$j, H as c$y, u as u$j, q as i$l, aW as t$k, F as i$m, m as m$l, K as r$f, S as S$a, ap as u$l, L as L$7, A as r$g, at as a$y, z as z$4, $ as $$4, n as n$v, aX as g$g, aY as p$w, aZ as d$j, o as o$i, b as e$h, E as E$6, aj as i$o, a_ as i$p, a$ as E$7, b0 as s$o, aK as d$k, G as s$p, w as f$e, O as O$5, b1 as L$8, s as s$q, b2 as h$k, y as e$l, b3 as f$g, t as t$n, b4 as t$o, b5 as r$h, b6 as A$5, b7 as e$n, N as a$C, b8 as E$8, b9 as M$4, ba as A$6, a7 as j$4, aN as s$r, aw as v$7, bb as n$w, bc as o$k, bd as l$n, be as s$s, bf as s$t, bg as n$x, bh as a$D, v as g$i, a9 as m$o, aq as O$6, au as m$p, d as d$o, bi as o$o, bj as n$B, bk as m$q, bl as k$4, bm as o$q, C as v$b, bn as g$j } from './jsxFactory-a3b6abde.js';
import { f as r$c, a5 as m$k, a6 as n$r, k as r$d, j as r$e, n as n$t, h as h$i, a7 as E$5, a1 as D$5, a8 as N$5, a9 as O$4, aa as F$3, ab as J$2, ac as K$2, b as e$g, ad as u$k, a as a$x, ae as ce$1, Z as h$j, af as i$n, ag as c$z, ah as B$6, ai as c$A, aj as c$B, ak as a$A, al as c$C, am as a$B, S as S$b, an as R$6, ao as b$a, g as o$j, ap as i$q, aq as d$l, ar as c$D, as as m$n, at as g$h, au as M$5, av as E$9, M as M$6, z as k$3, aw as o$l, a3 as s$u, ax as s$v, ay as H$3, az as I$7, aA as p$x, aB as S$c, aC as o$n, aD as r$l, aE as c$G, aF as v$a, aG as d$p } from './Graphic-08cda9ca.js';
import { p as p$v } from './CollectionFlattener-6fc74400.js';
import { c as c$H } from './workers-82dadb41.js';
import { l as l$k, d as d$i, a as a$z } from './HandleOwner-a0b41b75.js';
import { l as l$l } from './executeQueryJSON-21f02626.js';
import { u as u$m, l as l$m } from './TopFeaturesQuery-4aea53d6.js';
import { s as s$n, f as f$f } from './Heading-312c4ffe.js';
import { e as e$i, t as t$l } from './widget-7d4c291e.js';
import { b as b$8, m as m$m } from './Query-a20a7572.js';
import { Q as Q$3 } from './QueryTask-74d4023b.js';
import Ge from './FeatureLayer-6179c233.js';
import { b as b$9 } from './MultiOriginJSONSupport-22dd2d29.js';
import { e as e$j, l as l$p, h as h$n } from './TileStore-f74dddba.js';
import { e as e$k, a as e$m } from './GoTo-5947d15d.js';
import { t as t$m } from './vmEvent-bdc3bebc.js';
import { a as a$w, i as i$k } from './JSONSupport-4f0a3248.js';
import { U as U$8 } from './mathUtils-6ae1ce0d.js';
import { p as p$y, j as j$6 } from './TileInfo-11d4e5af.js';
import { s as s$m, x as x$4 } from './Basemap-726ae687.js';
import { o as o$h } from './compilerUtils-a5ae094d.js';
import { n as n$s } from './loadAll-b50c1134.js';
import { c as c$x, p as p$t } from './TablesMixin-92eb787e.js';
import { y as y$d } from './TimeExtent-a92e5996.js';
import { c as c$E, a as a$E } from './GraphicsCollection-bd1f8010.js';
import { v as v$8 } from './HeightModelInfo-5a7b6583.js';
import { f as f$h, D as D$6 } from './Scheduler-1618ba8f.js';
import { d as d$m } from './arcgisLayerUrl-a1acfaeb.js';
import { r as r$k, t as t$q } from './unitBezier-0f2e6a45.js';
import { n as n$z, i as i$r, c as c$F, e as e$o, r as r$j, M as M$7, h as h$l, a as n$A } from './mat2d-c1b9a27f.js';
import { r as r$i, a as a$F, l as l$o, x as x$5, F as F$4, o as o$m, v as v$9, A as A$7, j as j$5, b as b$b, D as D$7, s as s$w, d as d$n } from './vec2-42a7347f.js';
import { n as n$y, t as t$p } from './vec2f64-503345b4.js';
import { H as H$4, O as O$7 } from './projection-0b5fc15a.js';
import { s as s$x, r as r$m, M as M$8, h as h$m, i as i$s } from './mat3-1b3794e5.js';
import { t as t$r } from './vec2f32-7c7b1123.js';
import './TileStrategy-813150bb.js';
import './TileKey-6190320d.js';
import { g as g$k, l as l$q } from './screenshotUtils-f5f99bb9.js';
import { o as o$p } from './capabilities-2d1bcd77.js';
import { a as a$G } from './asyncUtils-9a49e799.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var t$h;let p$s=t$h=class extends a$w{constructor(o){super(o),this.type="none";}clone(){return new t$h({type:this.type})}};e$f([r$c({none:"none",stayAbove:"stay-above"})],p$s.prototype,"type",void 0),p$s=t$h=e$f([i$j("esri.ground.NavigationConstraint")],p$s);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var w$7;const C$5=s$k.getLogger("esri.Ground");let S$7=w$7=class extends(i$k(m$k)){constructor(r){super(r),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new S$8;const e=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,"elevation"!==r.type&&"base-elevation"!==r.type&&C$5.error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`);},t=r=>{r.parent=null;};this.layers.on("after-add",(r=>e(r.item))),this.layers.on("after-remove",(r=>t(r.item)));}initialize(){this.when().catch((r=>{C$5.error("#load()","Failed to load ground",r);})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context);}destroy(){const r=this.layers.removeAll();for(const e of r)e.destroy();this.layers.destroy();}normalizeCtorArgs(r){return r&&"resourceInfo"in r&&(this._set("resourceInfo",r.resourceInfo),delete(r={...r}).resourceInfo),r}set layers(r){this._set("layers",n$r(r,this._get("layers")));}writeLayers(r,e,o,t){const i=[];r?(t={...t,layerContainerType:"ground"},r.forEach((r=>{if("write"in r){const e={};o$h(r)().write(e,t)&&i.push(e);}else t&&t.messages&&t.messages.push(new s$l("layer:unsupported",`Layers (${r.title}, ${r.id}) of type '${r.declaredClass}' cannot be persisted in the ground`,{layer:r}));})),e.layers=i):e.layers=i;}load(r){return this.addResolvingPromise(this._loadFromSource(r)),Promise.resolve(this)}loadAll(){return n$s(this,(r=>{r(this.layers);}))}async queryElevation(r,e){await this.load({signal:null==e?void 0:e.signal});const{ElevationQuery:o}=await import('./ElevationQuery-2cc55a71.js');h$h(e);const t=new o,s=this.layers.filter(L$6).toArray();return t.queryAll(s,r,e)}async createElevationSampler(r,e){await this.load({signal:null==e?void 0:e.signal});const{ElevationQuery:o}=await import('./ElevationQuery-2cc55a71.js');h$h(e);const t=new o,s=this.layers.filter(L$6).toArray();return t.createSamplerAll(s,r,e)}clone(){const r={opacity:this.opacity,surfaceColor:l$j(this.surfaceColor),navigationConstraint:l$j(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(r.loadStatus="loaded"),new w$7({resourceInfo:this.resourceInfo}).set(r)}read(r,e){this.resourceInfo||this._set("resourceInfo",{data:r,context:e}),super.read(r,e);}_loadFromSource(r){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,r):Promise.resolve(null)}_loadLayersFromJSON(r,e,o){const t=e&&e.origin||"web-scene",s=e&&e.portal||null,a=e&&e.url||null;return import('./layersCreator-3a9c0e33.js').then((({populateOperationalLayers:e})=>{h$h(o);const i=[];if(r.layers&&Array.isArray(r.layers)){const o={context:{origin:t,url:a,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};i.push(e(this.layers,r.layers,o));}return T$7(i)})).then((()=>{}))}};function I$6(r){return r&&"createElevationSampler"in r}function L$6(r){return "elevation"===r.type||I$6(r)}e$f([d$h({json:{read:!1}})],S$7.prototype,"layers",null),e$f([r$d("layers")],S$7.prototype,"writeLayers",null),e$f([d$h({readOnly:!0})],S$7.prototype,"resourceInfo",void 0),e$f([d$h({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:S$9,read:{reader:r$e,source:"transparency"},write:{writer:(r,e)=>{e.transparency=n$t(r);},target:"transparency"}}})],S$7.prototype,"opacity",void 0),e$f([d$h({type:h$i,json:{type:[S$9],write:(r,e)=>{e.surfaceColor=r.toJSON().slice(0,3);}}})],S$7.prototype,"surfaceColor",void 0),e$f([d$h({type:p$s,json:{write:!0}})],S$7.prototype,"navigationConstraint",void 0),S$7=w$7=e$f([i$j("esri.Ground")],S$7);const A$4=S$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function i$i(i){var n;return !!(i&&i.loaded&&"capabilities"in i&&null!=i&&null!=(n=i.capabilities)&&n.operations&&"supportsEditing"in i.capabilities.operations&&!0===i.capabilities.operations.supportsEditing)&&!("editingEnabled"in i&&!i.editingEnabled)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$w=s$k.getLogger("esri.support.basemapUtils");function u$i(){return {}}function f$d(e){for(const r in e){const n=e[r];!1===(null==n?void 0:n.destroyed)&&n.destroy(),delete e[r];}}function y$c(n,t){var a;let l;if("string"==typeof n){if(!(n in s$m)){const e=Object.entries(s$m).filter((([e,n])=>t$i.apiKey&&!n.classic||!t$i.apiKey&&n.classic&&!n.deprecated)).map((([e])=>`"${e}"`)).join(", ");return c$w.warn(`Unable to find basemap definition for: ${n}. Try one of these: ${e}`),null}t&&(l=t[n]),l||(l=x$4.fromId(n),t&&(t[n]=l));}else l=b$7(x$4,n);return null!=(a=l)&&a.destroyed&&(c$w.warn("The provided basemap is already destroyed",{basemap:l}),l=null),l}function p$r(r,n=null){const t=y$c(r);if(!t)return null;const a=new x$4({id:t.id,title:t.title,baseLayers:t.baseLayers.slice(),referenceLayers:t.referenceLayers.slice()});return n&&(a.baseLayers=L$5(a.baseLayers,n.baseLayers),a.referenceLayers=L$5(a.referenceLayers,n.referenceLayers)),a.load().catch((()=>{})),a.portalItem=t.portalItem,a}function m$j(e){let r=null;const n=g$f(e),t=!n.baseLayers.length;for(const a in s$m){const e=U$7(n,j$3(s$m[a]),{mustMatchReferences:t});if("equal"===e){r=a;break}"base-layers-equal"===e&&(r=a);}return r}function b$6(e,r){if(e===r)return !0;return "equal"===U$7(g$f(e),g$f(r),{mustMatchReferences:!0})}function L$5(e,r){const t=new S$8;return e.forEach((e=>{const n=r.find((r=>M$3(x$3(e),x$3(r))))||e;t.some((e=>e===n))?t.push(e):t.push(n);})),t}function d$g(e){return !(null==e||!e.baseLayers.concat(e.referenceLayers).some(S$6))}function S$6(e){if(v$6(e.url))return !0;if("vector-tile"===e.type)for(const r in e.sourceNameToSource){const n=e.sourceNameToSource[r];if(v$6(null==n?void 0:n.sourceUrl))return !0}return !1}const h$g=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function v$6(e){if(!e)return !1;const r=new $$3(T$8(e));return h$g.test(r.authority)}function g$f(e){return e?!e.loaded&&e.resourceInfo?j$3(e.resourceInfo.data):{baseLayers:T$6(e.baseLayers),referenceLayers:T$6(e.referenceLayers)}:null}function T$6(e){return (S$8.isCollection(e)?e.toArray():e).map(x$3)}function x$3(e){return {type:e.type,url:R$5("urlTemplate"in e&&e.urlTemplate||e.url||"styleUrl"in e&&e.styleUrl),minScale:"minScale"in e&&null!=e.minScale?e.minScale:0,maxScale:"maxScale"in e&&null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visible||!!e.visible}}function j$3(e){return e?{baseLayers:q$4(e.baseMapLayers.filter((e=>!e.isReference))),referenceLayers:q$4(e.baseMapLayers.filter((e=>e.isReference)))}:null}function q$4(e){return e.map((e=>w$6(e)))}function w$6(e){let r;switch(e.layerType){case"VectorTileLayer":r="vector-tile";break;case"ArcGISTiledMapServiceLayer":r="tile";break;default:r="unknown";}return {type:r,url:R$5(e.templateUrl||e.urlTemplate||e.styleUrl||e.url),minScale:null!=e.minScale?e.minScale:0,maxScale:null!=e.maxScale?e.maxScale:0,opacity:null!=e.opacity?e.opacity:1,visible:null==e.visibility||!!e.visibility}}function U$7(e,r,n){if(null!=e!=(null!=r))return "not-equal";if(!e)return "equal";if(!I$5(e.baseLayers,r.baseLayers))return "not-equal";return I$5(e.referenceLayers,r.referenceLayers)?"equal":n.mustMatchReferences?"not-equal":"base-layers-equal"}function I$5(e,r){if(e.length!==r.length)return !1;for(let n=0;n<e.length;n++)if(!M$3(e[n],r[n]))return !1;return !0}function M$3(e,r){return e.type===r.type&&e.url===r.url&&e.minScale===r.minScale&&e.maxScale===r.maxScale&&e.visible===r.visible&&e.opacity===r.opacity}function R$5(e){return e?z$3(e).replace(/^\s*https?:/i,"").toLowerCase():""}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const i$h=s$k.getLogger("esri.support.groundUtils"),t$g={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function a$v(r){let a=null;if("string"==typeof r)if(r in t$g){const o=t$g[r];a=new A$4({resourceInfo:{data:{layers:[o]}}});}else i$h.warn(`Unable to find ground definition for: ${r}. Try "world-elevation"`);else a=b$7(A$4,r);return a}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let f$c=class extends(c$x(p$t(n$u.EventedMixin(p$u)))){constructor(e){super(e),this.allLayers=new p$v({getCollections:()=>{var e,s,r;return [null==(e=this.basemap)?void 0:e.baseLayers,null==(s=this.ground)?void 0:s.layers,this.layers,null==(r=this.basemap)?void 0:r.referenceLayers]},getChildrenFunction:e=>"layers"in e?e.layers:null}),this.allTables=new p$v({getCollections:()=>[this.tables,this.layers],getChildrenFunction:e=>{const s=[];return "tables"in e&&s.push(e.tables),"layers"in e&&s.push(e.layers),s},itemFilterFunction:e=>{const s=e.parent;return s&&"tables"in s&&s.tables.includes(e)}}),this.basemap=null,this.editableLayers=new p$v({getCollections:()=>[this.allLayers],itemFilterFunction:i$i}),this.ground=new A$4,this._basemapCache=u$i();}destroy(){var e,s;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),null==(e=this.ground)||e.destroy(),null==(s=this.basemap)||s.destroy(),f$d(this._basemapCache),this._basemapCache=null;}castBasemap(e){return y$c(e,this._basemapCache)}castGround(e){const s=a$v(e);return t$j(s)?this._get("ground"):s}findLayerById(e){return this.allLayers.find((s=>s.id===e))}findTableById(e){return this.allTables.find((s=>s.id===e))}};e$f([d$h({readOnly:!0,dependsOn:[]})],f$c.prototype,"allLayers",void 0),e$f([d$h({readOnly:!0})],f$c.prototype,"allTables",void 0),e$f([d$h({type:x$4})],f$c.prototype,"basemap",void 0),e$f([c$y("basemap")],f$c.prototype,"castBasemap",null),e$f([d$h({readOnly:!0})],f$c.prototype,"editableLayers",void 0),e$f([d$h({type:A$4,nonNullable:!0})],f$c.prototype,"ground",void 0),e$f([c$y("ground")],f$c.prototype,"castGround",null),f$c=e$f([i$j("esri.Map")],f$c);const j$2=f$c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const l$i={widthBreakpoint:{getValue(e){const i=e.viewSize[0],s=e.breakpoints,a=this.values;return i<=s.xsmall?a.xsmall:i<=s.small?a.small:i<=s.medium?a.medium:i<=s.large?a.large:a.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const i=e.viewSize[1],s=e.breakpoints,a=this.values;return i<=s.xsmall?a.xsmall:i<=s.small?a.small:i<=s.medium?a.medium:i<=s.large?a.large:a.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const i=e.viewSize,s=i[0],a=i[1],t=this.values;return a>=s?t.portrait:t.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},h$f={xsmall:544,small:768,medium:992,large:1200};function n$q(e){const i=e;return i&&i.xsmall<i.small&&i.small<i.medium&&i.medium<i.large}function o$g(e,i){return i?l$i[e].valueToClassName[i].split(" "):[]}const m$i=m=>{let g=class extends m{constructor(...e){super(...e),this._breakpointsHandles=new u$j,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=h$f;}initialize(){this._breakpointsHandles.add(i$l(this,["breakpoints","size"],this._updateClassNames));}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=null);}set breakpoints(e){if(e===this._get("breakpoints"))return;const i=n$q(e);if(!i){const e=JSON.stringify(h$f,null,2);console.warn("provided breakpoints are not valid, using defaults:"+e);}e=i?e:h$f,this._set("breakpoints",{...e});}_updateClassNames(){if(!this.container)return;const e=t$k.acquire(),s=t$k.acquire();let a,t=!1;for(a in l$i){const i=this[a],r=l$i[a].getValue({viewSize:this.size,breakpoints:this.breakpoints});i!==r&&(t=!0,this[a]=r,o$g(a,i).forEach((e=>s.push(e))),o$g(a,r).forEach((i=>e.push(i))));}t&&(this._applyClassNameChanges(e,s),t$k.release(e),t$k.release(s));}_applyClassNameChanges(e,i){const s=this.container;s&&(i.forEach((e=>s.classList.remove(e))),e.forEach((e=>s.classList.add(e))));}_removeActiveClassNames(){const e=this.container;if(!e)return;let i;for(i in l$i)o$g(i,this[i]).forEach((i=>e.classList.remove(i)));}};return e$f([d$h()],g.prototype,"breakpoints",null),e$f([d$h()],g.prototype,"orientation",void 0),e$f([d$h()],g.prototype,"widthBreakpoint",void 0),e$f([d$h()],g.prototype,"heightBreakpoint",void 0),g=e$f([i$j("esri.views.BreakpointsOwner")],g),g};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let c$v=class extends p$u{constructor(){super(...arguments),this.items=new S$8,this._watchUpdatingTracking=new l$k,this._callbacks=new Map,this._projector=i$m(),this._hiddenProjector=i$m();}get needsRender(){return this.items.length>0}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(this.items,(t=>{for(const e of t.added){const t=()=>e.render();this._callbacks.set(e,t),this._projector.append(this.surface,t);}for(const e of t.removed){const t=this._projector.detach(this._callbacks.get(e));this.surface.removeChild(t.domNode),this._callbacks.delete(e);}}));}addItem(t){this.items.add(t);}removeItem(t){this.items.remove(t);}destroy(){this.items.removeAll(),this._callbacks.forEach((t=>this._projector.detach(t))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy();}render(){this._projector.renderNow();}computeBoundingRect(t){const e=this._hiddenSurface,r=this._hiddenProjector;let o=null;const s=()=>(o=t.render(),o);r.append(e,s),r.renderNow();const i={left:0,top:0,right:0,bottom:0};if(o&&o.domNode){const t=o.domNode.getBoundingClientRect();i.left=t.left,i.top=t.top,i.right=t.right,i.bottom=t.bottom;}for(r.detach(s);e.firstChild;)e.removeChild(e.firstChild);return i}overlaps(t,e){const r=this.computeBoundingRect(t),o=this.computeBoundingRect(e);return Math.max(r.left,o.left)<=Math.min(r.right,o.right)&&Math.max(r.top,o.top)<=Math.min(r.bottom,o.bottom)}get hasVisibleItems(){return this.items.some((t=>t.visible))}renderCanvas(t){if(!this.items.some((t=>t.visible)))return;const e=t.getContext("2d");e.save(),e.font=`10px ${getComputedStyle(this.surface).fontFamily}`,this.items.forEach((t=>{e.save(),t.renderCanvas(e),e.restore();})),e.restore();}};e$f([d$h({readOnly:!0})],c$v.prototype,"surface",void 0),e$f([d$h({readOnly:!0})],c$v.prototype,"items",void 0),e$f([d$h({readOnly:!0})],c$v.prototype,"needsRender",null),e$f([d$h({readOnly:!0})],c$v.prototype,"_watchUpdatingTracking",void 0),e$f([d$h({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],c$v.prototype,"updating",void 0),c$v=e$f([i$j("esri.views.overlay.ViewOverlay")],c$v);const n$p=c$v;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function e$e(e,t,l,n){let u=null,a=1e3;"number"==typeof t?(a=t,n=l):(u=null!=t?t:null,a=l);let o,p=0;const r=()=>{p=0,e.apply(n,o);},c=(...e)=>{u&&u.apply(n,e),o=e,a?p||(p=setTimeout(r,a)):r();};return c.remove=()=>{p&&(clearTimeout(p),p=0);},c.forceUpdate=()=>{p&&(clearTimeout(p),r());},c.hasPendingUpdates=()=>!!p,c}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function a$u(t,n,i){return t.units[n][i]}function f$b(t,n,i,r=2,o="abbr"){return `${m$l(n,{minimumFractionDigits:r,maximumFractionDigits:r})} ${a$u(t,i,o)}`}function b$5(t,n,o,u=2,e="abbr"){const s=E$5(n,o);return f$b(t,D$5(n,o,s),s,u,e)}function l$h(t,n,i,u=2,e="abbr"){const s=N$5(n,i);return f$b(t,D$5(n,i,s),s,u,e)}function g$e(t,n,i,o=2,e="abbr"){const s=O$4(n,i);return f$b(t,D$5(n,i,s),s,o,e)}function F$2(t,n,i,o=2,u="abbr"){const s=F$3(n,i);return f$b(t,D$5(n,i,s),s,o,u)}function h$e(t,n,i,o=2,u="abbr"){const e=J$2(n,i);return f$b(t,D$5(n,i,e),e,o,u)}function x$2(t,n,i,o=2,u="abbr"){const e=K$2(n,i);return f$b(t,D$5(n,i,e),e,o,u)}function d$f(t,n,i=2){let o=D$5(t,n,"degrees"),u=o-Math.floor(o);o-=u,u*=60;let e=u-Math.floor(u);return u-=e,e*=60,`${o.toFixed()}Â° ${u.toFixed()}' ${e.toFixed(i)}"`}function p$q(t,n,i=2){const o=D$5(t,n,"degrees");return m$l(o,{style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:i,minimumFractionDigits:i})}const D$4=["B","kB","MB","GB","TB"];function M$2(i,r){let o=0===r?0:Math.floor(Math.log(r)/Math.log(1024));o=e$g(o,0,D$4.length-1);const u=m$l(r/1024**o,{maximumFractionDigits:2});return r$f(i.units.bytes[D$4[o]],{fileSize:u})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$u="esri.widgets.Feature.support.featureUtils",d$e=s$k.getLogger(c$u),p$p=/href=(""|'')/gi,m$h=/(\{([^\{\r\n]+)\})/g,y$b=/\'/g,g$d=/^\s*expression\//i,h$d=/(\n)/gi,b$4=/[\u00A0-\u9999<>\&]/gim,F$1=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,I$4=/^(?:mailto:|tel:)/,w$5="relationships/",N$4=S$a("short-date-short-time");function x$1(e){if(!t$j(e))return e.get("sourceLayer")||e.get("layer")}async function E$4(e,t){return "function"==typeof e?e.call(null,t):e}function v$5(e=""){if(e)return !I$4.test(e.trim().toLowerCase())}function j$1(e){return !!e&&g$d.test(e)}function T$5(e,t){if(!j$1(t)||!e)return null;const r=t.replace(g$d,"").toLowerCase();let n;return e.some((e=>e.name.toLowerCase()===r&&(n=e,!0))),n}function C$4(e,t){const r=T$5(t,null==e?void 0:e.fieldName);return r?r.title||null:e?e.label||e.fieldName:null}function q$3(e,t){const r=t.get(e.toLowerCase());return `{${r&&r.fieldName||e}}`}function D$3(e){return e.replace(p$p,"")}function R$4(e,t){const r=M$1(t,e);return r?r.name:e}function L$4(e,t){return e&&e.map((e=>R$4(e,t)))}function M$1(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function U$6(e){return `${e}`.trim()}function $$2({attributes:e,globalAttributes:t,layer:r,text:n,expressionAttributes:i,fieldInfoMap:o}){return n?A$3({formattedAttributes:t,template:P$3(n,{...t,...i,...e},r),fieldInfoMap:o}):""}function A$3({formattedAttributes:e,template:t,fieldInfoMap:r}){return U$6(D$3(r$f(r$f(t,(e=>q$3(e,r))),e)))}function O$3(e,t,r=!1){const n=t[e];if("string"==typeof n){const i="%27",o=(r?encodeURIComponent(n):n).replace(y$b,i);t[e]=o;}}function S$5(e,t=!1){const r={...e};return Object.keys(r).forEach((e=>O$3(e,r,t))),r}function G$4(e,t,r){const i=(t=U$6(t))&&"{"!==t[0];return r$f(e,S$5(r,i))}function k$2(e,t){return e.replace(m$h,((e,r,n)=>{const i=M$1(t,n);return i?`{${i.name}}`:r}))}function P$3(e,t,r){const n=k$2(e,r);return n?n.replace(F$1,((e,r,n)=>G$4(e,r||n,t))):n}function _$8(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}function z$2(e){return "feature"===(null==e?void 0:e.type)}function H$2(e){return "map-image"===(null==e?void 0:e.type)}function Q$2(e){return !(null==e||!e.layer)}function Z$1(e,t){const r=t.fieldInfos,n=t.fieldName,i=B$5(r,n),o=null==i?void 0:i.clone(),l=t.preventPlacesFormatting,f=t.layer,c=M$1(f,n);if(o&&"date"===(null==c?void 0:c.type)){const e=o.format||new u$k;e.dateFormat=e.dateFormat||"short-date-short-time",e.dateTimeFormatOptions=z$2(f)&&f.datesInUnknownTimezone||Q$2(f)&&H$2(f.layer)&&f.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,o.format=e;}const d=o&&o.format;return "string"==typeof(e=_$8(e,d))||null==e||null==d?e:l?m$l(e,{...u$l(d),minimumFractionDigits:0,maximumFractionDigits:20}):d.format(e)}function B$5(e,t){if(!e||!e.length||!t)return;const r=t.toLowerCase();let n;return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==r)&&(n=e,!0))),n}function J$1({fieldName:e,graphic:t,layer:r}){if(ae(e))return null;if(!r||"function"!=typeof r.getFeatureType)return null;const{typeIdField:n}=r;if(!n||e!==n)return null;const i=r.getFeatureType(t);return i?i.name:null}function K$1({fieldName:e,value:t,graphic:r,layer:n}){if(ae(e))return null;if(!n||"function"!=typeof n.getFieldDomain)return null;const i=n.getFieldDomain(e,{feature:r});return i&&"coded-value"===i.type?i.getName(t):null}function V$3(e,t){const{creatorField:r,creationDateField:n,editorField:o,editDateField:a}=e;if(!t)return;const u=t[a];if("number"==typeof u){const e=t[o];return {type:"edit",date:L$7(u,N$4),user:e}}const l=t[n];if("number"==typeof l){const e=t[r];return {type:"create",date:L$7(l,N$4),user:e}}return null}function W$3(e,t){const r=new Map;return e&&e.forEach((e=>{const n=R$4(e.fieldName,t);e.fieldName=n,r.set(n.toLowerCase(),e);})),r}function X$1(e){const t=[];if(!e)return t;const{fieldInfos:r,content:n}=e;return r&&t.push(...r),n&&Array.isArray(n)?(n.forEach((e=>{if("fields"===e.type){const r=e&&e.fieldInfos;r&&t.push(...r);}})),t):t}function Y$1(e){return e.replace(b$4,(e=>`&#${e.charCodeAt(0)};`))}function ee(e){return "string"==typeof e?e.replace(h$d,'<br class="esri-text-new-line" />'):e}function te(e){const{value:t,fieldName:r,fieldInfos:n,fieldInfoMap:o,layer:a,graphic:u}=e;if(null==t)return "";const l=K$1({fieldName:r,value:t,graphic:u,layer:a});if(l)return l;const s=J$1({fieldName:r,graphic:u,layer:a});if(s)return s;if(o.get(r.toLowerCase()))return Z$1(t,{fieldInfos:n,fieldName:r,layer:a});const f=a&&a.fieldsIndex;return f&&f.isDateField(r)?L$7(t,N$4):ee(t)}function re({fieldInfos:e,attributes:t,layer:r,graphic:n,fieldInfoMap:i,relatedInfos:o}){const a={};return null==o||o.forEach((e=>se(a,e))),Object.keys(t).forEach((o=>{const u=t[o];a[o]=te({fieldName:o,fieldInfos:e,fieldInfoMap:i,layer:r,value:u,graphic:n});})),a}async function ne(e,t){var r,n;const{layer:i,graphic:o,outFields:a,objectIds:u,returnGeometry:l,spatialReference:s}=e,f=u[0];if("number"!=typeof f&&"string"!=typeof f){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:i,graphic:o,objectId:f,requiredFields:a};return d$e.warn(e,t),null}if(null==(r=i.capabilities)||null==(n=r.operations)||!n.supportsQuery){const e="The specified layer cannot be queried. The following fields will not be available.",t={layer:i,graphic:o,requiredFields:a,returnGeometry:l};return d$e.warn(e,t),null}const c=i.createQuery();c.objectIds=u,c.outFields=null!=a&&a.length?a:[i.objectIdField],c.returnGeometry=!!l,c.returnZ=!!l,c.returnM=!!l,c.outSpatialReference=s;return (await i.queryFeatures(c,t)).features[0]}async function ie(e){var t;if(null==(t=e.expressionInfos)||!t.length)return !1;const r=await a$x(),{arcadeUtils:{hasGeometryFunctions:n}}=r;return n(e)}async function oe({graphic:e,popupTemplate:t,layer:r,spatialReference:n},i){if(!r||!t)return;if("function"==typeof r.load&&await r.load(i),!e.attributes)return;const o=e.attributes[r.objectIdField];if(null==o)return;const a=[o],u=await t.getRequiredFields(r.fieldsIndex),s=ce$1(u,e),f=s?[]:u,c=t.returnGeometry||await ie(t);if(s&&!c)return;const d=await ne({layer:r,graphic:e,outFields:f,objectIds:a,returnGeometry:c,spatialReference:n},i);d&&(d.geometry&&(e.geometry=d.geometry),d.attributes&&(e.attributes={...e.attributes,...d.attributes}));}function ae(e=""){return !!e&&-1!==e.indexOf(w$5)}function ue(e){return e?`${w$5}${e.layerId}/${e.fieldName}`:""}function le({attributes:e,graphic:t,relatedInfo:r}){e&&t&&r&&Object.keys(t.attributes).forEach((n=>{const i=ue({layerId:r.relation.id.toString(),fieldName:n});e[i]=t.attributes[n];}));}function se(e,t){e&&t&&(t.relatedFeatures&&t.relatedFeatures&&t.relatedFeatures.forEach((r=>le({attributes:e,graphic:r,relatedInfo:t}))),t.relatedStatsFeatures&&t.relatedStatsFeatures&&t.relatedStatsFeatures.forEach((r=>le({attributes:e,graphic:r,relatedInfo:t}))));}const fe=e=>{if(!e)return !1;const t=e.toUpperCase();return t.indexOf("CURRENT_TIMESTAMP")>-1||t.indexOf("CURRENT_DATE")>-1||t.indexOf("CURRENT_TIME")>-1},ce=({layer:e,method:t,query:n,definitionExpression:i})=>{var o,a;if(null==(o=e.capabilities)||null==(a=o.query)||!a.supportsCacheHint||"attachments"===t)return;const u=r$g(n.where)&&n.where,l=r$g(n.geometry)&&n.geometry;fe(i)||fe(u)||"extent"===(null==l?void 0:l.type)||"tile"===n.resultType||(n.cacheHint=!0);},de=({query:e,layer:t,method:r})=>{ce({layer:t,method:r,query:e,definitionExpression:`${t.definitionExpression} ${t.serviceDefinitionExpression}`});},pe=({queryPayload:e,layer:t,method:r})=>{ce({layer:t,method:r,query:e,definitionExpression:`${t.definitionExpression} ${t.serviceDefinitionExpression}`});};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const p$o={editing:!1,operations:{add:!0,update:!0,delete:!0}},u$h=S$8.ofType(l$l),y$a="graphic.layer.capabilities.operations.supportsResizeAttachments";let f$a=class extends d$i{constructor(t){super(t),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...p$o},this.activeAttachmentInfo=null,this.attachmentInfos=new u$h,this.graphic=null,this.mode="view",this.handles.add([i$l(this,"graphic",(()=>this._graphicChanged()))]);}destroy(){this._attachmentLayer=null,this.graphic=null;}castAbilities(t){return {...p$o,...t}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){return this.get(y$a)||!1}async getAttachments(){const{_attachmentLayer:t,attachmentInfos:e}=this;if(!t||"function"!=typeof t.queryAttachments)throw new s$l("invalid-layer","getAttachments(): A valid layer is required.");const a=this._getFeatureId(),n=new u$m({objectIds:[a],returnMetadata:!0}),r=[],s=t.queryAttachments(n).then((t=>t[a]||r)).catch((()=>r));this._getAttachmentsPromise=s,this.notifyChange("state");const o=await s;return e.removeAll(),o.length&&e.addMany(o),this._getAttachmentsPromise=null,this.notifyChange("state"),o}async addAttachment(t){const{_attachmentLayer:e,attachmentInfos:a,graphic:n,abilities:r}=this;if(!t)throw new s$l("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});if(!r.operations.add)throw new s$l("invalid-abilities","addAttachment(): add abilities are required.");if(!e||"function"!=typeof e.addAttachment)throw new s$l("invalid-layer","addAttachment(): A valid layer is required.");const s=e.addAttachment(n,t).then((t=>this._queryAttachment(t.objectId))),o=await s;return a.add(o),o}async deleteAttachment(t){const{_attachmentLayer:e,attachmentInfos:a,graphic:n,abilities:r}=this;if(!t)throw new s$l("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!r.operations.delete)throw new s$l("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!e||"function"!=typeof e.deleteAttachments)throw new s$l("invalid-layer","deleteAttachment(): A valid layer is required.");const s=e.deleteAttachments(n,[t.id]).then((()=>t)),o=await s;return a.remove(o),o}async updateAttachment(t,e=this.activeAttachmentInfo){const{_attachmentLayer:a,attachmentInfos:n,graphic:r,abilities:s}=this;if(!t)throw new s$l("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});if(!e)throw new s$l("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!s.operations.update)throw new s$l("invalid-abilities","updateAttachment(): Update abilities are required.");const o=n.findIndex((t=>t===e));if(!a||"function"!=typeof a.updateAttachment)throw new s$l("invalid-layer","updateAttachment(): A valid layer is required.");const c=a.updateAttachment(r,e.id,t).then((t=>this._queryAttachment(t.objectId))),h=await c;return n.splice(o,1,h),h}async _queryAttachment(t){if(!t)throw new s$l("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:e}=this,a=this._getFeatureId(),n=new u$m({objectIds:[a],attachmentsWhere:`AttachmentId=${t}`,returnMetadata:!0});return e.queryAttachments(n).then((t=>t[a][0]))}_getFeatureId(){const{_attachmentLayer:t,graphic:e}=this;if(!t||!e)return null;const{objectIdField:a}=t,{attributes:i}=e;return i&&i[a]}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((()=>{})));}_setAttachmentLayer(){const{graphic:t}=this,e=x$1(t);this._attachmentLayer=e?"scene"===e.type&&r$g(e.associatedLayer)?e.associatedLayer:e:null;}};e$f([d$h()],f$a.prototype,"abilities",void 0),e$f([c$y("abilities")],f$a.prototype,"castAbilities",null),e$f([d$h()],f$a.prototype,"activeAttachmentInfo",void 0),e$f([d$h({readOnly:!0,type:u$h})],f$a.prototype,"attachmentInfos",void 0),e$f([d$h({type:h$j})],f$a.prototype,"graphic",void 0),e$f([d$h()],f$a.prototype,"mode",void 0),e$f([d$h({readOnly:!0})],f$a.prototype,"state",null),e$f([d$h({readOnly:!0})],f$a.prototype,"supportsResizeAttachments",null),f$a=e$f([i$j("esri.widgets.Attachments.AttachmentsViewModel")],f$a);const A$2=f$a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function e$d(i){const e=i.toLowerCase();return "image/bmp"===e||"image/emf"===e||"image/exif"===e||"image/gif"===e||"image/x-icon"===e||"image/jpeg"===e||"image/png"===e||"image/tiff"===e||"image/x-wmf"===e}function p$n(e){const p=a$y("esri/themes/base/images/files/");return e?"text/plain"===e?`${p}text-32.svg`:"application/pdf"===e?`${p}pdf-32.svg`:"text/csv"===e?`${p}csv-32.svg`:"application/gpx+xml"===e?`${p}gpx-32.svg`:"application/x-dwf"===e?`${p}cad-32.svg`:"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?`${p}code-32.svg`:"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?`${p}zip-32.svg`:-1!==e.indexOf("image/")?`${p}image-32.svg`:-1!==e.indexOf("audio/")?`${p}sound-32.svg`:-1!==e.indexOf("video/")?`${p}video-32.svg`:-1!==e.indexOf("msexcel")||-1!==e.indexOf("ms-excel")||-1!==e.indexOf("spreadsheetml")?`${p}excel-32.svg`:-1!==e.indexOf("msword")||-1!==e.indexOf("ms-word")||-1!==e.indexOf("wordprocessingml")?`${p}word-32.svg`:-1!==e.indexOf("powerpoint")||-1!==e.indexOf("presentationml")?`${p}report-32.svg`:`${p}generic-32.svg`:`${p}generic-32.svg`}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const f$9={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},v$4={base:"esri-attachments",loaderContainer:"esri-attachments__loader-container",loader:"esri-attachments__loader",fadeIn:"esri-attachments--fade-in",container:"esri-attachments__container",containerList:"esri-attachments__container--list",containerPreview:"esri-attachments__container--preview",actions:"esri-attachments__actions",deleteButton:"esri-attachments__delete-button",addAttachmentButton:"esri-attachments__add-attachment-button",errorMessage:"esri-attachments__error-message",items:"esri-attachments__items",item:"esri-attachments__item",itemButton:"esri-attachments__item-button",itemMask:"esri-attachments__item-mask",itemMaskIcon:"esri-attachments__item-mask--icon",itemImage:"esri-attachments__image",itemImageResizable:"esri-attachments__image--resizable",itemLabel:"esri-attachments__label",itemFilename:"esri-attachments__filename",itemChevronIcon:"esri-attachments__item-chevron-icon",itemLink:"esri-attachments__item-link",itemLinkOverlay:"esri-attachments__item-link-overlay",itemLinkOverlayIcon:"esri-attachments__item-link-overlay-icon",itemEditIcon:"esri-attachments__item-edit-icon",itemAddIcon:"esri-attachments__item-add-icon",itemAddButton:"esri-attachments__item-add-button",formNode:"esri-attachments__form-node",fileFieldset:"esri-attachments__file-fieldset",fileLabel:"esri-attachments__file-label",fileName:"esri-attachments__file-name",fileInput:"esri-attachments__file-input",metadata:"esri-attachments__metadata",metadataFieldset:"esri-attachments__metadata-fieldset",progressBar:"esri-attachments__progress-bar",esriWidget:"esri-widget",esriButton:"esri-button",buttonDisabled:"esri-button--disabled",esriButtonSecondary:"esri-button--secondary",esriButtonTertiary:"esri-button--tertiary",esriButtonThird:"esri-button--third",esriButtonSmall:"esri-button--small",esriButtonHalf:"esri-button--half",empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},y$9=window.CSS;let B$4=class extends z$4{constructor(t,e){super(t,e),this.abilities=null,this.displayType="auto",this.graphic=null,this.label=void 0,this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new A$2,this.visibleElements={...f$9},this._supportsImageOrientation=y$9&&y$9.supports&&y$9.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null;}initialize(){this.own($$4(this,"viewModel.attachmentInfos","change",(()=>this.scheduleRender())),i$l(this,"viewModel.mode",(()=>this._modeChanged())));}get effectiveDisplayType(){return "auto"===this.displayType?this.viewModel.supportsResizeAttachments?"preview":"list":this.displayType}castVisibleElements(t){return {...f$9,...t}}addAttachment(){const{_addAttachmentForm:t,viewModel:s}=this;return this._set("submitting",!0),this._set("error",null),s.addAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),s.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new s$l("attachments:add-attachment",this.messages.addErrorMessage,t)),t}))}deleteAttachment(t){const{viewModel:s}=this;return this._set("submitting",!0),this._set("error",null),s.deleteAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),s.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new s$l("attachments:delete-attachment",this.messages.deleteErrorMessage,t)),t}))}updateAttachment(){const{viewModel:t}=this,{_updateAttachmentForm:s}=this;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(s).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((t=>{throw this._set("submitting",!1),this._set("error",new s$l("attachments:update-attachment",this.messages.updateErrorMessage,t)),t}))}render(){const{submitting:t,viewModel:e}=this,{state:s}=e;return n$v("div",{class:this.classes(v$4.base,v$4.esriWidget)},t?this.renderProgressBar():null,"loading"===s?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:t,visibleElements:e}=this;return t&&e.errorMessage?n$v("div",{key:"error-message",class:v$4.errorMessage},t.message):null}renderAttachments(){const{mode:t,activeAttachmentInfo:e}=this.viewModel;return "add"===t?this.renderAddForm():"edit"===t?this.renderDetailsForm(e):this.renderAttachmentContainer()}renderLoading(){return n$v("div",{class:v$4.loaderContainer,key:"loader"},n$v("div",{class:v$4.loader}))}renderProgressBar(){return this.visibleElements.progressBar?n$v("div",{class:v$4.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:t,selectedFile:e}=this,s=t||!e,i=this.visibleElements.cancelAddButton?n$v("button",{type:"button",bind:this,disabled:t,onclick:this._cancelForm,class:this.classes(v$4.esriButton,v$4.esriButtonTertiary,v$4.esriButtonSmall,v$4.esriButtonHalf,t&&v$4.buttonDisabled)},this.messages.cancel):null,a=this.visibleElements.addSubmitButton?n$v("button",{type:"submit",disabled:s,class:this.classes(v$4.esriButton,v$4.esriButtonSecondary,v$4.esriButtonSmall,v$4.esriButtonHalf,{[v$4.buttonDisabled]:s})},this.messages.add):null,n=e?n$v("span",{key:"file-name",class:v$4.fileName},e.name):null,r=n$v("form",{bind:this,afterCreate:g$g,afterRemoved:p$w,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},n$v("fieldset",{class:v$4.fileFieldset},n,n$v("label",{class:this.classes(v$4.fileLabel,v$4.esriButton,v$4.esriButtonSecondary)},e?this.messages.changeFile:this.messages.selectFile,n$v("input",{class:v$4.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),a,i);return n$v("div",{key:"add-form-container",class:v$4.formNode},r)}renderDetailsForm(t){const{visibleElements:e,viewModel:i,selectedFile:a,submitting:n}=this,{contentType:r,size:o,url:l}=t,{abilities:m}=i,d=n||!a,c=m.editing&&m.operations.delete&&e.deleteButton?n$v("button",{key:"delete-button",type:"button",disabled:n,bind:this,onclick:e=>this._submitDeleteAttachment(e,t),class:this.classes(v$4.esriButton,v$4.esriButtonSmall,v$4.esriButtonTertiary,v$4.deleteButton,{[v$4.buttonDisabled]:n})},this.messages.delete):null,h=m.editing&&m.operations.update&&e.updateButton?n$v("button",{disabled:d,key:"update-button",type:"submit",class:this.classes(v$4.esriButton,v$4.esriButtonSmall,v$4.esriButtonThird,{[v$4.buttonDisabled]:d})},this.messages.update):null,b=this.visibleElements.cancelUpdateButton?n$v("button",{disabled:n,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(v$4.esriButton,v$4.esriButtonSmall,v$4.esriButtonTertiary,v$4.esriButtonThird,{[v$4.buttonDisabled]:n})},this.messages.cancel):null,g=a?n$v("span",{key:"file-name",class:v$4.fileName},a.name):null,f=m.editing&&m.operations.update?n$v("fieldset",{key:"file",class:v$4.fileFieldset},g,n$v("label",{class:this.classes(v$4.fileLabel,v$4.esriButton,v$4.esriButtonSecondary)},this.messages.changeFile,n$v("input",{class:v$4.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,y=n$v("fieldset",{key:"size",class:v$4.metadataFieldset},n$v("label",null,M$2(this.messagesUnits,o))),B=n$v("fieldset",{key:"content-type",class:v$4.metadataFieldset},n$v("label",null,r)),A=n$v("form",{bind:this,afterCreate:g$g,afterRemoved:p$w,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},n$v("div",{class:v$4.metadata},y,B),f,n$v("div",{class:v$4.actions},c,b,h));return n$v("div",{key:"edit-form-container",class:v$4.formNode},n$v("a",{class:v$4.itemLink,href:l,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:t,size:400}),n$v("div",{class:v$4.itemLinkOverlay},n$v("span",{class:v$4.itemLinkOverlayIcon},n$v("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},n$v("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),n$v("path",{fill:"none",d:"M0 0h32v32H0z"}))))),A)}renderImageMask({attachmentInfo:t,size:e}){const{supportsResizeAttachments:s}=this.viewModel,{contentType:i,name:a,url:n}=t,r=s&&e$d(i),o=this._getCSSTransform(t,r),l=o?{transform:o,"image-orientation":"none"}:{},m=-1===n.indexOf("?")?"?":"&",d=r?`${n}${m}w=${e}`:p$n(i),u={[v$4.itemMaskIcon]:!r},p={[v$4.itemImageResizable]:s};return n$v("div",{class:this.classes(u,v$4.itemMask)},n$v("img",{styles:l,alt:a,src:d,class:this.classes(p,v$4.itemImage)}))}renderAttachmentInfo({attachmentInfo:t,displayType:e}){const{viewModel:s}=this,{abilities:i}=s,{name:a,url:n}=t,r=this.renderImageMask({attachmentInfo:t,size:"list"===e?48:400}),o=i.editing?n$v("span",{"aria-hidden":"true",class:this.classes(v$4.itemChevronIcon,d$j(this.container)?v$4.iconLeft:v$4.iconRight)}):null,l=[r,n$v("label",{class:v$4.itemLabel},n$v("span",{class:v$4.itemFilename},a||this.messages.noTitle),o)],m=i.editing?n$v("button",{key:"details-button",bind:this,class:v$4.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":t.id,onclick:()=>this._startEditAttachment(t),type:"button"},l):n$v("a",{key:"details-link",class:v$4.itemButton,href:n,target:"_blank"},l);return n$v("li",{class:v$4.item,key:t},m)}renderAttachmentContainer(){const{effectiveDisplayType:t,viewModel:e,visibleElements:s}=this,{attachmentInfos:i,abilities:a}=e,n=i&&i.length,r={[v$4.containerList]:"preview"!==t,[v$4.containerPreview]:"preview"===t},o=a.editing&&a.operations.add&&s.addButton?n$v("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(v$4.esriButton,v$4.esriButtonTertiary,v$4.addAttachmentButton),type:"button"},n$v("span",{"aria-hidden":"true",class:this.classes(v$4.itemAddIcon,v$4.iconPlus)}),this.messages.add):null,l=n?n$v("ul",{class:v$4.items},i.toArray().map((e=>this.renderAttachmentInfo({attachmentInfo:e,displayType:t})))):n$v("div",{class:v$4.empty},this.messages.noAttachments);return n$v("div",{key:"attachments-container",class:this.classes(v$4.container,r)},l,o)}_modeChanged(){this._set("error",null),this._set("selectedFile",null);}_handleFileInputChange(t){const e=t.target,s=e&&e.files&&e.files.item(0);this._set("selectedFile",s);}_submitDeleteAttachment(t,e){t.preventDefault(),this.deleteAttachment(e);}_submitAddAttachment(t){t.preventDefault(),this.addAttachment();}_submitUpdateAttachment(t){t.preventDefault(),this.updateAttachment();}_startEditAttachment(t){const{viewModel:e}=this;e.activeAttachmentInfo=t,e.mode="edit";}_startAddAttachment(){this.viewModel.mode="add";}_cancelForm(t){t.preventDefault(),this.viewModel.mode="view";}_getCSSTransform(t,e){const{orientationInfo:s}=t;return !this._supportsImageOrientation&&e&&s?[s.rotation?`rotate(${s.rotation}deg)`:"",s.mirrored?"scaleX(-1)":""].join(" "):""}};e$f([o$i("viewModel.abilities")],B$4.prototype,"abilities",void 0),e$f([d$h()],B$4.prototype,"displayType",void 0),e$f([d$h({readOnly:!0})],B$4.prototype,"effectiveDisplayType",null),e$f([o$i("viewModel.graphic")],B$4.prototype,"graphic",void 0),e$f([d$h({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],B$4.prototype,"label",void 0),e$f([d$h(),e$h("esri/widgets/Attachments/t9n/Attachments")],B$4.prototype,"messages",void 0),e$f([d$h(),e$h("esri/core/t9n/Units")],B$4.prototype,"messagesUnits",void 0),e$f([d$h({readOnly:!0})],B$4.prototype,"selectedFile",void 0),e$f([d$h({readOnly:!0})],B$4.prototype,"submitting",void 0),e$f([d$h({readOnly:!0})],B$4.prototype,"error",void 0),e$f([d$h({type:A$2})],B$4.prototype,"viewModel",void 0),e$f([d$h()],B$4.prototype,"visibleElements",void 0),e$f([c$y("visibleElements")],B$4.prototype,"castVisibleElements",null),B$4=e$f([i$j("esri.widgets.Attachments")],B$4);const A$1=B$4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let o$f=class extends A$2{constructor(t){super(t),this.description=null,this.title=null;}};e$f([d$h()],o$f.prototype,"description",void 0),e$f([d$h()],o$f.prototype,"title",void 0),o$f=e$f([i$j("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],o$f);const c$t=o$f;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const p$m={base:"esri-feature-element-info",title:"esri-feature-element-info__title",description:"esri-feature-element-info__description"};let n$o=class extends z$4{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null;}render(){return n$v("div",{class:p$m.base},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?n$v(s$n,{level:this.headingLevel,class:p$m.title},e):null}renderDescription(){const{description:e}=this;return e?n$v("div",{key:"description",class:p$m.description},e):null}};e$f([d$h()],n$o.prototype,"description",void 0),e$f([d$h()],n$o.prototype,"headingLevel",void 0),e$f([d$h()],n$o.prototype,"title",void 0),n$o=e$f([i$j("esri.widgets.Feature.support.FeatureElementInfo")],n$o);const c$s=n$o;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const d$d={base:"esri-feature-attachments"};let c$r=class extends z$4{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new A$1,this.description=null,this.displayType=null,this.graphic=null,this.headingLevel=2,this.title=null,this.viewModel=new c$t;}initialize(){this._featureElementInfo=new c$s,i$l(this,["viewModel.description","viewModel.title","headingLevel"],(()=>this._setupFeatureElementInfo())),i$l(this,"viewModel.graphic",(e=>this.attachmentsWidget.graphic=e));}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy();}render(){var e;const{attachmentsWidget:t}=this;return n$v("div",{class:d$d.base},null==(e=this._featureElementInfo)?void 0:e.render(),null==t?void 0:t.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:o}=this;this._featureElementInfo.set({description:e,title:t,headingLevel:o});}};e$f([d$h({readOnly:!0})],c$r.prototype,"attachmentsWidget",void 0),e$f([o$i("viewModel.description")],c$r.prototype,"description",void 0),e$f([o$i("attachmentsWidget.displayType")],c$r.prototype,"displayType",void 0),e$f([o$i("viewModel.graphic")],c$r.prototype,"graphic",void 0),e$f([d$h()],c$r.prototype,"headingLevel",void 0),e$f([o$i("viewModel.title")],c$r.prototype,"title",void 0),e$f([d$h({type:c$t})],c$r.prototype,"viewModel",void 0),c$r=e$f([i$j("esri.widgets.Feature.FeatureAttachments")],c$r);const m$g=c$r;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let n$n=class extends(a$z(p$u)){constructor(t){super(t),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(i$l(this,"creator",(t=>{this._destroyContent(),this._createContent(t);})));}destroy(){this._destroyContent();}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:t,graphic:r,destroyer:e}=this;t&&(E$4(e,{graphic:r}).catch((()=>null)),this._set("created",null));}async _createContent(t){const{graphic:r}=this,e=E$4(t,{graphic:r}).catch((()=>null));this._loadingPromise=e,this.notifyChange("state");const o=await e;e===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",o));}};e$f([d$h({readOnly:!0})],n$n.prototype,"created",void 0),e$f([d$h()],n$n.prototype,"creator",void 0),e$f([d$h()],n$n.prototype,"destroyer",void 0),e$f([d$h({type:h$j})],n$n.prototype,"graphic",void 0),e$f([d$h({readOnly:!0})],n$n.prototype,"state",null),n$n=e$f([i$j("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],n$n);const p$l=n$n;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$q={base:"esri-feature-content",loaderContainer:"esri-feature-content__loader-container",loader:"esri-feature-content__loader"};let l$g=class extends z$4{constructor(e,r){super(e,r),this.creator=null,this.graphic=null,this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{v$5(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank");}));};}renderLoading(){return n$v("div",{class:c$q.loaderContainer,key:"loader"},n$v("div",{class:c$q.loader}))}renderCreated(){var e;const r=null==(e=this.viewModel)?void 0:e.created;return r?r instanceof HTMLElement?n$v("div",{key:r,bind:r,afterCreate:this._attachToNode}):e$i(r)?n$v("div",{key:r},!r.destroyed&&r.render()):n$v("div",{key:r,innerHTML:r,afterCreate:this._addTargetToAnchors}):null}render(){var e;const r=null==(e=this.viewModel)?void 0:e.state;return n$v("div",{class:c$q.base},"loading"===r?this.renderLoading():this.renderCreated())}_attachToNode(e){const r=this;e.appendChild(r);}};e$f([o$i("viewModel.creator")],l$g.prototype,"creator",void 0),e$f([o$i("viewModel.graphic")],l$g.prototype,"graphic",void 0),e$f([d$h({type:p$l})],l$g.prototype,"viewModel",void 0),l$g=e$f([i$j("esri.widgets.Feature.FeatureContent")],l$g);const p$k=l$g;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let l$f=class extends p$u{constructor(o){super(o),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null;}get formattedFieldInfos(){const{expressionInfos:o,fieldInfos:e}=this,s=[];return null==e||e.forEach((e=>{if(!(!e.hasOwnProperty("visible")||e.visible))return;const t=e.clone();t.label=C$4(t,o),s.push(t);})),s}};e$f([d$h()],l$f.prototype,"attributes",void 0),e$f([d$h({type:[i$n]})],l$f.prototype,"expressionInfos",void 0),e$f([d$h()],l$f.prototype,"description",void 0),e$f([d$h({type:[c$z]})],l$f.prototype,"fieldInfos",void 0),e$f([d$h({readOnly:!0})],l$f.prototype,"formattedFieldInfos",null),e$f([d$h()],l$f.prototype,"title",void 0),l$f=e$f([i$j("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],l$f);const n$m=l$f;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const s$j=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function a$t(e){let a=null;return s$j.some((s=>(s.pattern.test(e)&&(a=s),!!a))),a}function p$j(s,p){if("string"!=typeof p||!p)return p;const r=a$t(p);if(!r)return p;const t=p.match(r.pattern),n=t&&t[2],l=r$f(r$f(r.label,{messages:s,hierPart:n}),{appName:r.appName}),i=r.target?` target="${r.target}"`:"",o="_blank"===r.target?' rel="noreferrer"':"";return p.replace(r.pattern,`<a${i} href="$1"${o}>${l}</a>`)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const f$8={base:"esri-feature-fields",fieldHeader:"esri-feature-fields__field-header",fieldData:"esri-feature-fields__field-data",fieldDataDate:"esri-feature-fields__field-data--date",esriTable:"esri-widget__table"};let u$g=class extends z$4{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attributes=null,this.description=null,this.expressionInfos=null,this.fieldInfos=null,this.title=null,this.viewModel=new n$m,this.messages=null,this.messagesURIUtils=null;}initialize(){this._featureElementInfo=new c$s,i$l(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo()));}destroy(){this._featureElementInfo.destroy();}renderFieldInfo(e,t){const{attributes:s}=this.viewModel,r=e.fieldName,i=e.label||r,o=s?null==s[r]?"":s[r]:"",l=!(!e.format||!e.format.dateFormat),a="number"==typeof o&&!l?this._forceLTR(o):p$j(this.messagesURIUtils,o),n={[f$8.fieldDataDate]:l};return n$v("tr",{key:`fields-element-info-row-${r}-${t}`},n$v("th",{key:`fields-element-info-row-header-${r}-${t}`,class:f$8.fieldHeader,innerHTML:i}),n$v("td",{key:`fields-element-info-row-data-${r}-${t}`,class:this.classes(f$8.fieldData,n),innerHTML:a}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return null!=e&&e.length?n$v("table",{class:f$8.esriTable,summary:this.messages.fieldsSummary},n$v("tbody",null,e.map(((e,t)=>this.renderFieldInfo(e,t))))):null}render(){var e;return n$v("div",{class:f$8.base},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t});}_forceLTR(e){return `&lrm;${e}`}};e$f([o$i("viewModel.attributes")],u$g.prototype,"attributes",void 0),e$f([o$i("viewModel.description")],u$g.prototype,"description",void 0),e$f([o$i("viewModel.expressionInfos")],u$g.prototype,"expressionInfos",void 0),e$f([o$i("viewModel.fieldInfos")],u$g.prototype,"fieldInfos",void 0),e$f([o$i("viewModel.title")],u$g.prototype,"title",void 0),e$f([d$h({type:n$m})],u$g.prototype,"viewModel",void 0),e$f([d$h(),e$h("esri/widgets/Feature/t9n/Feature")],u$g.prototype,"messages",void 0),e$f([d$h(),e$h("esri/widgets/support/t9n/uriUtils")],u$g.prototype,"messagesURIUtils",void 0),u$g=e$f([i$j("esri.widgets.Feature.FeatureFields")],u$g);const m$f=u$g;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$p="esri.widgets.Feature.support.relatedFeatureUtils",d$c=s$k.getLogger(c$p),f$7=new Map;function p$i(e){if(!ae(e))return null;const[t,r]=e.split("/").slice(1);return {layerId:t,fieldName:r}}function m$e(e,t){if(!t.relationships)return null;let r=null;const{relationships:s}=t;return s.some((t=>t.id===parseInt(e,10)&&(r=t,!0))),r}function y$8({originRelationship:e,relationships:t,layerId:r}){let s;return t&&t.some((t=>(`${t.relatedTableId}`===r&&t.id===e.id&&(s=t),!!s))),s}function F(e,t){const r=t.toLowerCase();for(const s in e)if(s.toLowerCase()===r)return e[s];return null}function h$c(e,t){const r=m$e(e,t);if(!r)return;const s=`${t.url}/${r.relatedTableId}`;return {url:s,queryTask:new Q$3({url:s,sourceSpatialReference:t.spatialReference}),relation:r,relatedFields:[],outStatistics:[]}}function I$3(e,t){if(!t)return;if(!e)return;const{features:r,statsFeatures:s}=e,i=r&&r.value;t.relatedFeatures=i?i.features:[];const o=s&&s.value;t.relatedStatsFeatures=o?o.features:[];}function w$4(e,t,r,s){const i=new l$m;return i.outFields=["*"],i.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),i.objectIds=[e.attributes[r.objectIdField]],r.queryRelatedFeatures(i,s)}function b$3(e,t,r){let s=0;const i=[];for(;s<t.length;)i.push(`${e} IN (${t.slice(s,r+s)})`),s+=r;return i.join(" OR ")}async function j(e,t,r,n){const a=r.layerId.toString(),{layerInfo:l,queryTask:u,relation:c,relatedFields:d,outStatistics:f}=t,p=y$8({originRelationship:c,relationships:l.relationships,layerId:a});if(p.relationshipTableId&&p.keyFieldInRelationshipTable){const t=(await w$4(e,p,r,n))[e.attributes[r.objectIdField]];if(!t)return null;const i=t.features.map((e=>e.attributes[l.objectIdField]));if((null==f?void 0:f.length)>0&&l.supportsStatistics){const e=new b$8;e.where=b$3(l.objectIdField,i,1e3),e.outFields=d,e.outStatistics=f;const r={features:Promise.resolve(t),statsFeatures:u.execute(e)};return T$7(r)}}const m=null==p?void 0:p.keyField;if(m){const r=B$6(q$2(l.fields,m)),a=F(e.attributes,c.keyField),d=r?`${m}=${a}`:`${m}='${a}'`,f=u.execute(new b$8({where:d,outFields:t.relatedFields}),n),p=t.outStatistics&&t.outStatistics.length>0&&l.supportsStatistics?u.execute(new b$8({where:d,outFields:t.relatedFields,outStatistics:t.outStatistics}),n):null,y={features:f};return p&&(y.statsFeatures=p),T$7(y)}return null}function g$c(t,r){return E$6(t,{query:{f:"json"},signal:r&&r.signal})}function S$4({relatedInfos:e,layer:r},i){const o={};return e.forEach(((e,s)=>{const{relation:n}=e;if(!n){const e=new s$l("relation-required","A relation is required on a layer to retrieve related records.");throw d$c.error(e),e}const{relatedTableId:a}=n;if("number"!=typeof a){const e=new s$l("A related table ID is required on a layer to retrieve related records.");throw d$c.error(e),e}const l=`${r.url}/${a}`,u=f$7.get(l),c=u||g$c(l,i);u||f$7.set(l,c),o[s]=c;})),T$7(o)}function T$4({graphic:e,relatedInfos:t,layer:r},i){const o={};return t.forEach(((t,s)=>{t.layerInfo&&(o[s]=j(e,t,r,i));})),T$7(o)}function $$1({relatedInfo:e,fieldName:t,fieldInfo:r}){if(e.relatedFields.push(t),r.statisticType){const s=new m$m({statisticType:r.statisticType,onStatisticField:t,outStatisticFieldName:t});e.outStatistics.push(s);}}function q$2(e,t){if(null!=e){t=t.toLowerCase();for(const r of e)if(r&&r.name.toLowerCase()===t)return r}return null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let y$7=class extends p$u{constructor(t){super(t),this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null;}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(t){this._setContentElementMedia(t);}next(){this._pageContentElementMedia(1);}previous(){this._pageContentElementMedia(-1);}_setContentElementMedia(t){const{formattedMediaInfoCount:e}=this,o=(t+e)%e;this.activeMediaInfoIndex=o;}_pageContentElementMedia(t){const{activeMediaInfoIndex:e}=this,o=e+t;this._setContentElementMedia(o);}_formatMediaInfos(){const{attributes:t,mediaInfos:e,formattedAttributes:o,expressionAttributes:i,fieldInfoMap:r,layer:a}=this;return null==e?void 0:e.map((e=>{if(!e)return null;if(e.title=$$2({attributes:t,fieldInfoMap:r,globalAttributes:o,expressionAttributes:i,layer:a,text:e.title}),e.caption=$$2({attributes:t,fieldInfoMap:r,globalAttributes:o,expressionAttributes:i,layer:a,text:e.caption}),e.altText=$$2({attributes:t,fieldInfoMap:r,globalAttributes:o,expressionAttributes:i,layer:a,text:e.altText}),"image"===e.type){const{value:t}=e;return this._setImageValue({value:t,formattedAttributes:o,layer:a}),e.value.sourceURL?e:void 0}if("pie-chart"===e.type||"line-chart"===e.type||"column-chart"===e.type||"bar-chart"===e.type){const{value:i}=e;return this._setChartValue({value:i,chartType:e.type,attributes:t,formattedAttributes:o,layer:a}),e}return null})).filter(Boolean)}_setImageValue(t){const{fieldInfoMap:e}=this,{value:o,formattedAttributes:i,layer:r}=t,{linkURL:a,sourceURL:s}=o;if(s){const t=k$2(s,r);o.sourceURL=A$3({formattedAttributes:i,template:t,fieldInfoMap:e});}if(a){const t=k$2(a,r);o.linkURL=A$3({formattedAttributes:i,template:t,fieldInfoMap:e});}}_setChartValue(t){const{value:e,attributes:o,formattedAttributes:i,chartType:r,layer:a}=t,{popupTemplate:s,relatedInfos:l}=this,{fields:n,normalizeField:f}=e;e.fields=L$4(n,a),f&&(e.normalizeField=R$4(f,a));if(!n.some((t=>!!(null!=i[t]||ae(t)&&l.size))))return;const m=null==s?void 0:s.fieldInfos;n.forEach((t=>{if(ae(t))return void(e.series=[...e.series,...this._getRelatedChartInfos({fieldInfos:m,fieldName:t,formattedAttributes:i,chartType:r,value:e})]);const a=this._getChartOption({value:e,attributes:o,chartType:r,formattedAttributes:i,fieldName:t,fieldInfos:m});e.series.push(a);}));}_getRelatedChartInfos(t){var e;const{fieldInfos:o,fieldName:i,formattedAttributes:r,chartType:a,value:s}=t,l=[],n=p$i(i),{layerId:d,fieldName:p}=n,u=null==(e=this.relatedInfos)?void 0:e.get(d.toString());if(!u)return l;const{relatedFeatures:f,relation:m}=u;if(!m||!f)return l;const{cardinality:c}=m;f.forEach((t=>{const{attributes:e}=t;e&&Object.keys(e).forEach((t=>{t===p&&l.push(this._getChartOption({value:s,attributes:e,formattedAttributes:r,fieldName:i,chartType:a,relatedFieldName:t,fieldInfos:o}));}));}));return "one-to-many"===c||"many-to-many"===c?l:[l[0]]}_getTooltip({label:t,value:e,chartType:o}){return "pie-chart"===o?t:`${t}: ${e}`}_getChartOption(t){var e;const{value:o,attributes:i,formattedAttributes:s,fieldName:l,relatedFieldName:n,fieldInfos:d,chartType:y}=t,{layer:I}=this,{normalizeField:v,tooltipField:b}=o,M=v?ae(v)?i[p$i(v).fieldName]:i[v]:null,g=n&&void 0!==i[n]?i[n]:void 0!==i[l]?i[l]:s[l],A=void 0===g?null:g&&M?g/M:g,_=new c$A({value:A});if(ae(l)){const t=p$i(l),e=p$i(b),o=e?e.fieldName:null,r=Z$1(A,{fieldInfos:d,fieldName:n,layer:I,preventPlacesFormatting:!!M}),a=t?t.label||t.fieldName:n,s=o&&void 0!==i[o]?i[o]:a;return _.tooltip=this._getTooltip({label:s,value:r,chartType:y}),_}const x=B$5(d,l),T=R$4(l,I),C=b&&void 0!==s[b]?s[b]:C$4(x||new c$z({fieldName:T}),null==(e=this.popupTemplate)?void 0:e.expressionInfos),F=s[T];return _.tooltip=this._getTooltip({label:C,value:F,chartType:y}),_}};e$f([d$h()],y$7.prototype,"activeMediaInfoIndex",void 0),e$f([d$h({readOnly:!0})],y$7.prototype,"activeMediaInfo",null),e$f([d$h()],y$7.prototype,"attributes",void 0),e$f([d$h()],y$7.prototype,"description",void 0),e$f([d$h()],y$7.prototype,"fieldInfoMap",void 0),e$f([d$h()],y$7.prototype,"formattedAttributes",void 0),e$f([d$h()],y$7.prototype,"expressionAttributes",void 0),e$f([d$h({readOnly:!0})],y$7.prototype,"formattedMediaInfos",null),e$f([d$h()],y$7.prototype,"layer",void 0),e$f([d$h({readOnly:!0})],y$7.prototype,"formattedMediaInfoCount",null),e$f([d$h()],y$7.prototype,"mediaInfos",void 0),e$f([d$h()],y$7.prototype,"popupTemplate",void 0),e$f([d$h()],y$7.prototype,"relatedInfos",void 0),e$f([d$h()],y$7.prototype,"title",void 0),y$7=e$f([i$j("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],y$7);const I$2=y$7;

var f$6=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],b$2=[].concat(f$6.slice(30,39),f$6.slice(28,30).reverse()),e$c=[{name:"default",colors:b$2},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}],a$s={"h-yy-010":"#fff7cc","h-yy-020":"#fef3ad","h-yy-030":"#fcee8d","h-yy-040":"#fbea6e","h-yy-050":"#f9e54e","h-yy-060":"#edd317","h-yy-070":"#d9bc00","h-yy-080":"#bfa200","h-yy-090":"#8c7500","h-yy-100":"#5c4e00","h-oy-010":"#ffe2bf","h-oy-020":"#fed3a1","h-oy-030":"#fcc582","h-oy-040":"#fbb664","h-oy-050":"#f9a845","h-oy-060":"#f89927","h-oy-070":"#c67718","h-oy-080":"#9a5b10","h-oy-090":"#6d3f08","h-oy-100":"#402300","h-oo-010":"#ffd8bf","h-oo-020":"#fdc39f","h-oo-030":"#faae7f","h-oo-040":"#f89960","h-oo-050":"#f58440","h-oo-060":"#f36f20","h-oo-070":"#c65a18","h-oo-080":"#9a4410","h-oo-090":"#6d2f08","h-oo-100":"#401900","h-ro-010":"#ffc7b3","h-ro-020":"#f8af95","h-ro-030":"#f09677","h-ro-040":"#e97e5a","h-ro-050":"#e1653c","h-ro-060":"#da4d1e","h-ro-070":"#ad3c16","h-ro-080":"#802c0f","h-ro-090":"#531b07","h-ro-100":"#260a00","h-rr-010":"#ffc6bf","h-rr-020":"#ffaaa1","h-rr-030":"#f2877b","h-rr-040":"#f07062","h-rr-050":"#e65240","h-rr-060":"#d83020","h-rr-070":"#a82b1e","h-rr-080":"#7c1d13","h-rr-090":"#4f0e08","h-rr-100":"#210300","h-pk-010":"#ffd1ef","h-pk-020":"#fabee4","h-pk-030":"#f2a5d6","h-pk-040":"#eb8dc9","h-pk-050":"#e673bb","h-pk-060":"#e04ea6","h-pk-070":"#ba2f7e","h-pk-080":"#851b52","h-pk-090":"#590b32","h-pk-100":"#260404","h-vr-010":"#fadbff","h-vr-020":"#e4beeb","h-vr-030":"#cfa1d7","h-vr-040":"#b983c3","h-vr-050":"#a466af","h-vr-060":"#8e499b","h-vr-070":"#73377e","h-vr-080":"#572561","h-vr-090":"#3c1243","h-vr-100":"#200026","h-vv-010":"#e8d9ff","h-vv-020":"#cdb9eb","h-vv-030":"#b39ad7","h-vv-040":"#987ac3","h-vv-050":"#7e5baf","h-vv-060":"#633b9b","h-vv-070":"#4e2c7e","h-vv-080":"#3a1e61","h-vv-090":"#250f43","h-vv-100":"#100026","h-bb-010":"#c7eaff","h-bb-020":"#9fd4f3","h-bb-030":"#77bde7","h-bb-040":"#50a7da","h-bb-050":"#2890ce","h-bb-060":"#007ac2","h-bb-070":"#00619b","h-bb-080":"#004874","h-bb-090":"#00304d","h-bb-100":"#001726","h-gb-010":"#cef5f4","h-gb-020":"#afedec","h-gb-030":"#8fe6e5","h-gb-040":"#5ae0de","h-gb-050":"#28cecb","h-gb-060":"#00bab5","h-gb-070":"#009b98","h-gb-080":"#007472","h-gb-090":"#004d4c","h-gb-100":"#002625","h-gg-010":"#bdf2c4","h-gg-020":"#a2e4ab","h-gg-030":"#87d692","h-gg-040":"#6bc878","h-gg-050":"#50ba5f","h-gg-060":"#35ac46","h-gg-070":"#288835","h-gg-080":"#1a6324","h-gg-090":"#0d3f14","h-gg-100":"#001a03","h-yg-010":"#e5f7b4","h-yg-020":"#d9ef9f","h-yg-030":"#cde78a","h-yg-040":"#c2e075","h-yg-050":"#b6d860","h-yg-060":"#aad04b","h-yg-070":"#84a338","h-yg-080":"#5e7526","h-yg-090":"#384813","h-yg-100":"#121a00","h-br-010":"#f7e4cb","h-br-020":"#dec6a8","h-br-030":"#c5a885","h-br-040":"#ad8b62","h-br-050":"#946d3f","h-br-060":"#7b4f1c","h-br-070":"#664015","h-br-080":"#51310e","h-br-090":"#3b2307","h-br-100":"#261400","m-yy-010":"#faf7dc","m-yy-020":"#f6f0c1","m-yy-030":"#f2e8a6","m-yy-040":"#ede18b","m-yy-050":"#e9d970","m-yy-060":"#e5d255","m-yy-070":"#bcaa45","m-yy-080":"#8a7d31","m-yy-090":"#584f1c","m-yy-100":"#262107","m-oy-010":"#ffedd6","m-oy-020":"#fce0bd","m-oy-030":"#f8d2a4","m-oy-040":"#f5c58c","m-oy-050":"#f1b773","m-oy-060":"#eeaa5a","m-oy-070":"#bc8645","m-oy-080":"#8a6130","m-oy-090":"#583d1c","m-oy-100":"#261807","m-oo-010":"#ffece0","m-oo-020":"#fcdac5","m-oo-030":"#f8c7aa","m-oo-040":"#f5b590","m-oo-050":"#f1a275","m-oo-060":"#ee905a","m-oo-070":"#bc7145","m-oo-080":"#8a5131","m-oo-090":"#58321c","m-oo-100":"#261207","m-ro-010":"#f7e4dc","m-ro-020":"#f5d0c2","m-ro-030":"#f3bba7","m-ro-040":"#f1a78d","m-ro-050":"#ef9272","m-ro-060":"#ed7e58","m-ro-070":"#bc6345","m-ro-080":"#8a4731","m-ro-090":"#582b1c","m-ro-100":"#582b1c","m-rr-010":"#fadfdc","m-rr-020":"#fccac5","m-rr-030":"#ffb9b0","m-rr-040":"#f79e94","m-rr-050":"#f5867a","m-rr-060":"#eb6c5e","m-rr-070":"#c25347","m-rr-080":"#913d34","m-rr-090":"#5e241e","m-rr-100":"#260a07","m-pk-010":"#fadef0","m-pk-020":"#facdea","m-pk-030":"#f2b1da","m-pk-040":"#eb9dcf","m-pk-050":"#e688c2","m-pk-060":"#e070b4","m-pk-070":"#b8588f","m-pk-080":"#8c4267","m-pk-090":"#592440","m-pk-100":"#260b0b","m-vr-010":"#f6e1fa","m-vr-020":"#e9ceee","m-vr-030":"#dbbbe2","m-vr-040":"#cea8d5","m-vr-050":"#c095c9","m-vr-060":"#b382bd","m-vr-070":"#8e6397","m-vr-080":"#6a4572","m-vr-090":"#46264c","m-vr-100":"#210726","m-vv-010":"#ece6ff","m-vv-020":"#dcd2f2","m-vv-030":"#ccbee5","m-vv-040":"#bbaad7","m-vv-050":"#ab96ca","m-vv-060":"#9b82bd","m-vv-070":"#796397","m-vv-080":"#584572","m-vv-090":"#36264c","m-vv-100":"#140726","m-bb-010":"#dfeffa","m-bb-020":"#c8e3f5","m-bb-030":"#b1d8f1","m-bb-040":"#9bccec","m-bb-050":"#84c1e8","m-bb-060":"#6db5e3","m-bb-070":"#548eb4","m-bb-080":"#3a6884","m-bb-090":"#214155","m-bb-100":"#071a26","m-gb-010":"#dbf2f1","m-gb-020":"#beedec","m-gb-030":"#9fe6e5","m-gb-040":"#8be0df","m-gb-050":"#70d9d7","m-gb-060":"#5cbfbc","m-gb-070":"#53a6a4","m-gb-080":"#40807e","m-gb-090":"#2a5958","m-gb-100":"#102928","m-gg-010":"#e4f0e4","m-gg-020":"#cbe2cb","m-gg-030":"#b2d4b2","m-gg-040":"#9ac699","m-gg-050":"#81b880","m-gg-060":"#68aa67","m-gg-070":"#548953","m-gg-080":"#3f683f","m-gg-090":"#2b472a","m-gg-100":"#172616","m-yg-010":"#f0f7da","m-yg-020":"#e5efc6","m-yg-030":"#dae7b1","m-yg-040":"#cede9d","m-yg-050":"#c3d688","m-yg-060":"#b8ce74","m-yg-070":"#90a15b","m-yg-080":"#687442","m-yg-090":"#3f4728","m-yg-100":"#171a0f","m-br-010":"#faeddf","m-br-020":"#edd9c3","m-br-030":"#e0c6a8","m-br-040":"#d2b28c","m-br-050":"#c59f71","m-br-060":"#b88b55","m-br-070":"#926d41","m-br-080":"#6c4f2d","m-br-090":"#45311a","m-br-100":"#1f1306","l-yy-010":"#f7f5e6","l-yy-020":"#e7e4d1","l-yy-030":"#d7d3bc","l-yy-040":"#c6c1a6","l-yy-050":"#b6b091","l-yy-060":"#a69f7c","l-yy-070":"#837e61","l-yy-080":"#605c47","l-yy-090":"#3d3b2c","l-yy-100":"#1a1911","l-oy-010":"#faf3eb","l-oy-020":"#e9e0d5","l-oy-030":"#d8cdbf","l-oy-040":"#c8b9a8","l-oy-050":"#b7a692","l-oy-060":"#a6937c","l-oy-070":"#837461","l-oy-080":"#605547","l-oy-090":"#3d352c","l-oy-100":"#1a1611","l-oo-010":"#faf1eb","l-oo-020":"#e9ddd5","l-oo-030":"#d8c9bf","l-oo-040":"#c8b4a8","l-oo-050":"#b7a092","l-oo-060":"#a68c7c","l-oo-070":"#836e61","l-oo-080":"#605047","l-oo-090":"#3d322c","l-oo-100":"#1a1411","l-ro-010":"#faf3f0","l-ro-020":"#e9ddd9","l-ro-030":"#d8c8c1","l-ro-040":"#c8b2aa","l-ro-050":"#b79d92","l-ro-060":"#a6877b","l-ro-070":"#836b61","l-ro-080":"#604e47","l-ro-090":"#3d302c","l-ro-100":"#1a1311","l-rr-010":"#faf1f0","l-rr-020":"#eddfdd","l-rr-030":"#dbc6c4","l-rr-040":"#c8adaa","l-rr-050":"#ba9995","l-rr-060":"#ab837e","l-rr-070":"#876764","l-rr-080":"#604a47","l-rr-090":"#3d2e2c","l-rr-100":"#1a1211","l-pk-010":"#faf0f6","l-pk-020":"#e8d7e2","l-pk-030":"#dbc2d2","l-pk-040":"#c9abbe","l-pk-050":"#b897ab","l-pk-060":"#a68097","l-pk-070":"#856376","l-pk-080":"#614755","l-pk-090":"#3d2c35","l-pk-100":"#1a1111","l-vr-010":"#f5edf7","l-vr-020":"#e1d6e4","l-vr-030":"#cebcd1","l-vr-040":"#baa8bf","l-vr-050":"#a791ac","l-vr-060":"#937a99","l-vr-070":"#746079","l-vr-080":"#56465a","l-vr-090":"#372b3a","l-vr-100":"#18111a","l-vv-010":"#f0edf7","l-vv-020":"#dcd8e7","l-vv-030":"#c8c3d7","l-vv-040":"#b5aec6","l-vv-050":"#a199b6","l-vv-060":"#8d84a6","l-vv-070":"#6f6783","l-vv-080":"#504b60","l-vv-090":"#322e3d","l-vv-100":"#13111a","l-bb-010":"#edf3f7","l-bb-020":"#d7e1e7","l-bb-030":"#c1cfd7","l-bb-040":"#acbcc6","l-bb-050":"#96aab6","l-bb-060":"#8098a6","l-bb-070":"#647883","l-bb-080":"#495860","l-bb-090":"#2d373d","l-bb-100":"#11171a","l-gb-010":"#e8f2f2","l-gb-020":"#d7e8e8","l-gb-030":"#c2d7d7","l-gb-040":"#b1c9c9","l-gb-050":"#98b3b2","l-gb-060":"#88a6a5","l-gb-070":"#658584","l-gb-080":"#4b6160","l-gb-090":"#2f3d3d","l-gb-100":"#121a1a","l-gg-010":"#f0f7f0","l-gg-020":"#dde7dd","l-gg-030":"#cad7ca","l-gg-040":"#b7c6b6","l-gg-050":"#a4b6a3","l-gg-060":"#91a690","l-gg-070":"#728371","l-gg-080":"#536053","l-gg-090":"#343d34","l-gg-100":"#151a15","l-yg-010":"#f4f7eb","l-yg-020":"#e3e7d8","l-yg-030":"#d2d7c5","l-yg-040":"#c2c6b3","l-yg-050":"#b1b6a0","l-yg-060":"#a0a68d","l-yg-070":"#7e836f","l-yg-080":"#5d6051","l-yg-090":"#3b3d33","l-yg-100":"#191a15","l-br-010":"#f7f1eb","l-br-020":"#e4ddd4","l-br-030":"#d1c8be","l-br-040":"#bfb4a7","l-br-050":"#ac9f91","l-br-060":"#998b7a","l-br-070":"#796e60","l-br-080":"#5a5146","l-br-090":"#3a332b","l-br-100":"#1a1611","v-yy-120":"#fff766","v-yy-140":"#ffee33","v-yy-160":"#f5d000","v-yy-180":"#ebba17","v-oy-120":"#ffb54d","v-oy-140":"#ff9500","v-oy-160":"#e68600","v-oy-180":"#d17300","v-oo-120":"#ff974d","v-oo-140":"#ff6a00","v-oo-160":"#e05d00","v-oo-180":"#c95100","v-ro-120":"#ff824d","v-ro-140":"#ff4d00","v-ro-160":"#de4300","v-ro-180":"#c93b00","v-rr-120":"#ff624d","v-rr-140":"#ff0015","v-rr-160":"#d90012","v-rr-180":"#b3000f","v-pk-120":"#ff66c2","v-pk-140":"#ff19a4","v-pk-160":"#d11486","v-pk-180":"#c00073","v-vr-120":"#ea80ff","v-vr-140":"#dd33ff","v-vr-160":"#ac08cc","v-vr-180":"#83009e","v-vv-120":"#b580ff","v-vv-140":"#974dff","v-vv-160":"#8129ff","v-vv-180":"#6a0be6","v-bb-120":"#59d6ff","v-bb-140":"#3db8ff","v-bb-160":"#009af2","v-bb-180":"#0089de","v-gb-120":"#59fffc","v-gb-140":"#00f7f3","v-gb-160":"#00e6e2","v-gb-180":"#00cfca","v-gg-120":"#73ff84","v-gg-140":"#3bed52","v-gg-160":"#00b81b","v-gg-180":"#00a118","v-yg-120":"#d7ff73","v-yg-140":"#bbed3b","v-yg-160":"#96cc00","v-yg-180":"#7fab00","d-bb-410":"#47BBFF","d-bb-420":"#00A0FF","d-bb-430":"#0087D7","d-gg-410":"#44ED51","d-gg-420":"#36DA43","d-gg-430":"#11AD1D","d-yy-410":"#FFE24D","d-yy-420":"#FFC900","d-yy-430":"#F4B000","d-rr-410":"#FF7465","d-rr-420":"#FE583E","d-rr-430":"#F3381B","blk-000":"#ffffff","blk-005":"#f8f8f8","blk-010":"#f3f3f3","blk-020":"#eaeaea","blk-030":"#dfdfdf","blk-040":"#d4d4d4","blk-050":"#cacaca","blk-060":"#bfbfbf","blk-070":"#b5b5b5","blk-080":"#aaaaaa","blk-090":"#9f9f9f","blk-100":"#949494","blk-110":"#8a8a8a","blk-120":"#808080","blk-130":"#757575","blk-140":"#6a6a6a","blk-150":"#606060","blk-160":"#555555","blk-170":"#4a4a4a","blk-180":"#404040","blk-190":"#353535","blk-200":"#2b2b2b","blk-210":"#202020","blk-220":"#151515","blk-230":"#0b0b0b","blk-235":"#060606","blk-240":"#000000"},c$o=[{name:"light",variables:{brand:"#007ac2","brand-hover":"#00619B","brand-press":"#004874",background:"#f8f8f8","foreground-1":"#ffffff","foreground-2":"#f3f3f3","foreground-3":"#eaeaea","text-1":"#151515","text-2":"#4a4a4a","text-3":"#6a6a6a","text-inverse":"#FFFFFF","text-link":"#00619b","border-1":"#cacaca","border-2":"#d4d4d4","border-3":"#dfdfdf","border-input":"#949494",info:"#00619b",success:"#35ac46",warning:"#edd317",danger:"#D83020","danger-hover":"#A82B1E","danger-press":"#7C1D13"}},{name:"dark",variables:{brand:"#009AF2","brand-hover":"#007AC2","brand-press":"#00619B",background:"#353535","foreground-1":"#2b2b2b","foreground-2":"#202020","foreground-3":"#151515","text-1":"#ffffff","text-2":"#bfbfbf","text-3":"#9f9f9f","text-inverse":"#151515","text-link":"#00A0FF","border-1":"#555555","border-2":"#4a4a4a","border-3":"#404040","border-input":"#757575",info:"#00A0FF",success:"#36DA43",warning:"#FFC900",danger:"#FE583E","danger-hover":"#FF0015","danger-press":"#D90012"}}];

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const n$l="en-us",h$b=new Map([["ar",()=>import('./ar-09ade3f3.js').then((t=>t.a))],["bs-ba",()=>import('./bs_BA-e1b3b712.js').then((t=>t.b))],["ca-es",()=>import('./ca_ES-7fc3e26d.js').then((t=>t.c))],["cs-cz",()=>import('./cs_CZ-f7c9bb82.js').then((t=>t.c))],["da-dk",()=>import('./da_DK-c70c3579.js').then((t=>t.d))],["de-de",()=>import('./de_DE-2baae74c.js').then((t=>t.d))],["de-ch",()=>import('./de_CH-f55524be.js').then((t=>t.d))],["el-gr",()=>import('./el_GR-7427b5ba.js').then((t=>t.e))],["en-us",()=>import('./en_US-17186018.js').then((t=>t.e))],["en-ca",()=>import('./en_CA-49e78a0d.js').then((t=>t.e))],["es-es",()=>import('./es_ES-2a827a95.js').then((t=>t.e))],["et-ee",()=>import('./et_EE-c3602704.js').then((t=>t.e))],["fi-fi",()=>import('./fi_FI-b95b5668.js').then((t=>t.f))],["fr-fr",()=>import('./fr_FR-b5a3011e.js').then((t=>t.f))],["he-il",()=>import('./he_IL-5cd73c8f.js').then((t=>t.h))],["hr-hr",()=>import('./hr_HR-33dd6479.js').then((t=>t.h))],["hu-hu",()=>import('./hu_HU-1cedab24.js').then((t=>t.h))],["id-id",()=>import('./id_ID-df9865ba.js').then((t=>t.i))],["it-it",()=>import('./it_IT-41ee37e5.js').then((t=>t.i))],["ja-jp",()=>import('./ja_JP-e3c9a292.js').then((t=>t.j))],["ko-kr",()=>import('./ko_KR-fee2a8af.js').then((t=>t.k))],["lt-lt",()=>import('./lt_LT-3dd0d517.js').then((t=>t.l))],["lv-lv",()=>import('./lv_LV-fe30fa5a.js').then((t=>t.l))],["nb-no",()=>import('./nb_NO-765b950c.js').then((t=>t.n))],["nl-nl",()=>import('./nl_NL-12108b4c.js').then((t=>t.n))],["pl-pl",()=>import('./pl_PL-32b6ff4d.js').then((t=>t.p))],["pt-br",()=>import('./pt_BR-5f15286c.js').then((t=>t.p))],["pt-pt",()=>import('./pt_PT-0ccf9176.js').then((t=>t.p))],["ro-ro",()=>import('./ro_RO-0f563b1c.js').then((t=>t.r))],["ru-ru",()=>import('./ru_RU-b03a9eee.js').then((t=>t.r))],["sk-sk",()=>import('./sk_SK-9dc17903.js').then((t=>t.s))],["sl-sl",()=>import('./sl_SL-3de08fb4.js').then((t=>t.s))],["sr-rs",()=>import('./sr_RS-75109587.js').then((t=>t.s))],["sv-se",()=>import('./sv_SE-8b202f60.js').then((t=>t.s))],["th-th",()=>import('./th_TH-066579a5.js').then((t=>t.t))],["tr-tr",()=>import('./tr_TR-edf617e8.js').then((t=>t.t))],["uk-ua",()=>import('./uk_UA-5f9550ad.js').then((t=>t.u))],["vi-vn",()=>import('./vi_VN-04c57500.js').then((t=>t.v))],["zh-cn",()=>import('./zh_Hans-8d1d03f6.js').then((t=>t.z))],["zh-hk",()=>import('./zh_Hant-b9438548.js').then((t=>t.z))],["zh-tw",()=>import('./zh_Hant-b9438548.js').then((t=>t.z))]]);function e$b(t){const s=t.split("-")[0].toLowerCase();let n=null;for(const e of h$b.keys())if(e.startsWith(s)){n=e;break}return n}function r$b(t){return t?h$b.has(t.toLowerCase())?t.toLowerCase():e$b(t)||n$l:n$l}let o$e,i$g;async function c$n(t=i$o()){if(t=r$b(t),o$e&&t===i$g)return o$e;o$e=import('./index-030de4fc.js').then((t=>t.i)),i$g=t;try{const[s,n]=await Promise.all([o$e,h$b.get(i$g)()]);i$g===t&&(s.am4core.options.defaultLocale=n.default),s.am4core.options.suppressWarnings=!0,s.am4core.options.autoDispose=!0;}catch{return o$e=null,i$g=null,null}return o$e}function u$f(s,n="default"){const h=e$c.find((t=>t.name===n));return h?h.colors.map((t=>s.color(t))):null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const v$3={base:"esri-feature-media",mediaContainer:"esri-feature-media__container",mediaItemContainer:"esri-feature-media__item-container",mediaItem:"esri-feature-media__item",mediaItemTitle:"esri-feature-media__item-title",mediaItemCaption:"esri-feature-media__item-caption",mediaPrevious:"esri-feature-media__previous",mediaPreviousIconLTR:"esri-feature-media__previous-icon",mediaPreviousIconRTL:"esri-feature-media__previous-icon--rtl",mediaNext:"esri-feature-media__next",mediaNextIconLTR:"esri-feature-media__next-icon",mediaNextIconRTL:"esri-feature-media__next-icon--rtl",mediaChart:"esri-feature-media__chart",mediaButton:"esri-feature-media__button",mediaIcon:"esri-feature-media__icon",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},_$7=.05,I$1=.95,M=15;let w$3=class extends z$4{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.attributes=null,this.activeMediaInfoIndex=null,this.description=null,this.fieldInfoMap=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null,this.viewModel=new I$2,this.messages=null;}initialize(){this._featureElementInfo=new c$s,this.own(i$l(this,["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],(()=>this._setupMediaRefreshTimer())),i$l(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo())));}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy();}render(){var e;return n$v("div",{bind:this,class:v$3.base,onkeyup:this._handleMediaKeyup},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?n$v("div",{key:"media-element-container",class:v$3.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:i,formattedMediaInfoCount:r}=this.viewModel,{value:a,refreshInterval:o,altText:s,title:n,type:l}=e,{sourceURL:c,linkURL:m}=a,u=v$5(m)?"_blank":"_self",h="_blank"===u?"noreferrer":"",p=o?t:null,v=p?p.timestamp:0,_=p?p.sourceURL:c,I=n$v("img",{alt:s||n,key:`media-${l}-${i}-${r}-${v}`,src:_}),M=m?n$v("a",{title:n,href:m,rel:h,target:u},I):null;return M||I}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:i}=this.viewModel;return n$v("div",{key:`media-${e.type}-${t}-${i}`,bind:this,class:v$3.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this.renderImageMediaInfo(e):-1!==e.type.indexOf("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?n$v("div",{key:"media-title",class:v$3.mediaItemTitle,innerHTML:e.title}):null,i=e.caption?n$v("div",{key:"media-caption",class:v$3.mediaItemCaption,innerHTML:e.caption}):null;return n$v("div",{key:"media-container",class:v$3.mediaItemContainer},n$v("div",{key:"media-item-container",class:v$3.mediaItem},this.renderMediaInfoType()),t,i)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t="previous"===e,i=t?this.messages.previous:this.messages.next,r=t?this.classes(v$3.mediaButton,v$3.mediaPrevious):this.classes(v$3.mediaButton,v$3.mediaNext),a=t?this.classes(v$3.mediaIcon,v$3.mediaPreviousIconLTR,v$3.iconLeftTriangleArrow):this.classes(v$3.mediaIcon,v$3.mediaNextIconLTR,v$3.iconRightTriangleArrow),o=t?this.classes(v$3.mediaIcon,v$3.mediaPreviousIconRTL,v$3.iconRightTriangleArrow):this.classes(v$3.mediaIcon,v$3.mediaNextIconRTL,v$3.iconLeftTriangleArrow),s=t?"media-previous":"media-next",n=t?this._previous:this._next;return n$v("button",{type:"button",key:s,title:i,"aria-label":i,tabIndex:0,class:r,bind:this,onclick:n},n$v("span",{"aria-hidden":"true",class:a}),n$v("span",{"aria-hidden":"true",class:o}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t});}_next(){this.viewModel.next();}_previous(){this.viewModel.previous();}async _getChartDependencies(e){const t=await c$n(),{activeMediaInfo:i}=this.viewModel;this._renderChart({chartDiv:e,mediaInfo:i,chartsModule:t});}_handleMediaKeyup(e){const i=i$p(e);"ArrowLeft"===i&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===i&&(e.stopPropagation(),this.viewModel.next());}_renderChart(e){const{chartsModule:t,chartDiv:i,mediaInfo:r}=e,{value:a,type:o}=r,{am4core:s}=t,n=u$f(s);function l(e){e instanceof s.ColorSet&&n&&(e.list=n);}E$7()&&s.useTheme(t.am4themes_dark),s.useTheme(t.am4themes_animated),s.useTheme(l);const d="pie-chart"===o?this._createPieChart(e):this._createXYChart(e);i.setAttribute("aria-label",r.altText||r.title),d.data=a.series.map((e=>({tooltip:e.tooltip,value:e.value}))).filter((e=>"pie-chart"!==o||e.value>0));}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7});}_createPieChart(e){const{chartDiv:t,chartsModule:i}=e,{am4core:r,am4charts:a}=i,o=r.create(t,a.PieChart);o.rtl=d$j(this.container);const s=o.series.push(new a.PieSeries);return s.labels.template.disabled=!0,s.ticks.template.disabled=!0,s.dataFields.value="value",s.dataFields.category="tooltip",this._customizeChartTooltip(s.tooltip,r),o}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}_createColumnChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.xAxes.push(new s.CategoryAxis);n.dataFields.category="tooltip",n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dy=-n.tooltip.contentHeight;}));const l=e.yAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_$7,l.renderer.maxLabelPosition=I$1,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.ColumnSeries);c.dataFields.valueY="value",c.dataFields.categoryX="tooltip",e.cursor=new s.XYCursor,a.series.length>M&&(e.scrollbarX=new o.Scrollbar);}_createBarChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.yAxes.push(new s.CategoryAxis);n.dataFields.category="tooltip",n.renderer.inversed=!0,n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dx=n.tooltip.contentWidth;}));const l=e.xAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_$7,l.renderer.maxLabelPosition=I$1,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.ColumnSeries);c.dataFields.valueX="value",c.dataFields.categoryY="tooltip",e.cursor=new s.XYCursor,a.series.length>M&&(e.scrollbarY=new o.Scrollbar);}_createLineChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.xAxes.push(new s.CategoryAxis);n.dataFields.category="tooltip",n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dy=-n.tooltip.contentHeight;}));const l=e.yAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_$7,l.renderer.maxLabelPosition=I$1,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.LineSeries);c.dataFields.categoryX="tooltip",c.dataFields.valueY="value",e.cursor=new s.XYCursor,a.series.length>M&&(e.scrollbarX=new o.Scrollbar);}_createXYChart(e){const{chartDiv:t,chartsModule:i,mediaInfo:r}=e,{type:a}=r,{am4core:o,am4charts:s}=i,n=o.create(t,s.XYChart);return n.rtl=d$j(this.container),"column-chart"===a&&this._createColumnChart(n,e),"bar-chart"===a&&this._createBarChart(n,e),"line-chart"===a&&this._createLineChart(n,e),n}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null);}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender();}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e);}_setRefreshTimeout(e){const{refreshInterval:t,value:i}=e;if(!t)return;const r=6e4*t;this._updateMediaInfoTimestamp(i.sourceURL);const a=setInterval((()=>{this._updateMediaInfoTimestamp(i.sourceURL);}),r);this._refreshTimer=a;}_getImageSource(e,t){const i=-1!==e.indexOf("?")?"&":"?",[r,a=""]=e.split("#");return `${r}${i}timestamp=${t}${a?"#":""}${a}`}};e$f([o$i("viewModel.attributes")],w$3.prototype,"attributes",void 0),e$f([o$i("viewModel.activeMediaInfoIndex")],w$3.prototype,"activeMediaInfoIndex",void 0),e$f([o$i("viewModel.description")],w$3.prototype,"description",void 0),e$f([o$i("viewModel.fieldInfoMap")],w$3.prototype,"fieldInfoMap",void 0),e$f([o$i("viewModel.layer")],w$3.prototype,"layer",void 0),e$f([o$i("viewModel.mediaInfos")],w$3.prototype,"mediaInfos",void 0),e$f([o$i("viewModel.popupTemplate")],w$3.prototype,"popupTemplate",void 0),e$f([o$i("viewModel.relatedInfos")],w$3.prototype,"relatedInfos",void 0),e$f([o$i("viewModel.title")],w$3.prototype,"title",void 0),e$f([d$h({type:I$2})],w$3.prototype,"viewModel",void 0),e$f([d$h(),e$h("esri/widgets/Feature/t9n/Feature")],w$3.prototype,"messages",void 0),w$3=e$f([i$j("esri.widgets.Feature.FeatureMedia")],w$3);const g$b=w$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class e$a{constructor(e,a){this.preLayerQueryCallback=e,this.preRequestCallback=a,this.preLayerQueryCallback||(this.preLayerQueryCallback=e=>{}),this.preRequestCallback||(this.preLayerQueryCallback=e=>{});}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const o$d=["$datastore","$map","$layer","$aggregatedfeatures"],n$k="esri.widgets.Feature.support.arcadeFeatureUtils",c$m=s$k.getLogger(n$k);function p$h(e){return `<ul class="esri-widget__list">${e.map((e=>`<li>${"string"==typeof e?ee(Y$1(e)):e}</li>`)).join("")}</ul>`}function l$e(e){return `<table class="esri-widget__table">${e.keys().map((r=>{const t=e.field(r);return `<tr><th>${r}</th><td>${"string"==typeof t?ee(Y$1(t)):t}</td></tr>`})).join("")}</table>`}function u$e({aggregatedFeatures:e,arcadeUtils:r,featureSetVars:t,context:i,viewInfo:s,map:o,graphic:n,interceptor:c}){t.forEach((t=>{const p=t.toLowerCase(),l={map:o,spatialReference:s.sr,interceptor:c};if("$map"===p&&(i.vars[p]=r.convertMapToFeatureSetCollection(l)),"$layer"===p&&(i.vars[p]=r.convertFeatureLayerToFeatureSet({layer:n.sourceLayer,spatialReference:s.sr,interceptor:c})),"$datastore"===p&&(i.vars[p]=r.convertServiceUrlToWorkspace({url:n.sourceLayer.url,spatialReference:s.sr,interceptor:c})),"$aggregatedfeatures"===p){const t=n.layer,{fields:o,objectIdField:l,geometryType:u,spatialReference:f,displayField:d}=t,g=new Ge({fields:o,objectIdField:l,geometryType:u,spatialReference:f,displayField:d,..."feature"===t.type?{templates:t.templates,typeIdField:t.typeIdField,types:t.types}:null,source:e});i.vars[p]=r.convertFeatureLayerToFeatureSet({layer:g,spatialReference:s.sr,interceptor:c});}}));}function f$5(){return import('./arcadeUtils-ebc53175.js').then(function (n) { return n.as; })}async function d$b({graphic:e,view:r}){const{isAggregate:t,layer:a}=e;if(!t||!a||"2d"!==(null==r?void 0:r.type))return [];const i=await r.whenLayerView(a);if(!i.createQuery||!i.queryFeatures)return [];const s=i.createQuery();s.aggregateIds=[e.getObjectId()];const{features:o}=await i.queryFeatures(s);return o}async function g$a({expressionAttributes:e,info:r,arcadeUtils:a,interceptor:n,spatialReference:f,map:g,graphic:y,view:m}){const w=`expression/${r.name}`,F=a.createSyntaxTree(r.expression),v=o$d.filter((e=>a.hasVariable(F,e))),[h]=await s$o([d$b({graphic:y,view:m}),a.loadScriptDependencies(F,!0,v)]),x=a.getViewInfo({spatialReference:f}),$=a.createExecContext(y,x);$.interceptor=n,$.useAsync=!0,u$e({aggregatedFeatures:h,arcadeUtils:a,featureSetVars:v,context:$,viewInfo:x,map:g,graphic:y,interceptor:n});const I=a.createFunction(F,$),j=await a.executeAsyncFunction(I,$).catch((e=>c$m.error("arcade-execution-error",{error:e,graphic:y,expressionInfo:r})));e[w]="string"==typeof j?ee(Y$1(j)):Array.isArray(j)?p$h(j):j&&"esri.arcade.Dictionary"===j.declaredClass?l$e(j):j;}async function y$6({popupTemplate:e,spatialReference:t,graphic:a,interceptor:i,map:s,view:o}){const n=e.expressionInfos,c=[],p={};if(!n||!n.length)return p;const l=await f$5();for(const r of n)c.push(g$a({expressionAttributes:p,info:r,arcadeUtils:l,interceptor:i,spatialReference:t,map:s,graphic:a,view:o}));return await T$7(c),p}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var U$5;const N$3=1,q$1="esri.widgets.FeatureViewModel",D$2=s$k.getLogger(q$1),Q$1={attachmentsContent:!0,customContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0};let B$3=U$5=class extends p$u{constructor(e){super(e),this._handles=new u$j,this._error=null,this._featureAbortController=null,this.graphicChangedThrottled=e$e(this.graphicChanged,N$3,this),this._expressionAttributes=null,this.abilities={...Q$1},this.content=null,this.contentViewModels=[],this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return "attachments"===e.type&&t.attachmentsContent||"custom"===e.type&&t.customContent||"fields"===e.type&&t.fieldsContent||"media"===e.type&&t.mediaContent||"text"===e.type&&t.textContent},this._handles.add(i$l(this,["graphic","_effectivePopupTemplate","abilities"],(()=>this.graphicChangedThrottled())));}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear();}get _effectivePopupTemplate(){return r$g(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return W$3(X$1(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return x$1(this.graphic)}castAbilities(e){return {...Q$1,...e}}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(e){this._set("graphic",e?e.clone():null);}get spatialReference(){return this.get("view.spatialReference")||null}set spatialReference(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference");}get map(){return this.get("view.map")||null}set map(e){void 0!==e?this._override("map",e):this._clearOverride("map");}get waitingForContent(){return !!this._featureAbortController}setActiveMedia(e,t){const r=this.contentViewModels[e];r instanceof I$2&&r.setActiveMedia(t);}nextMedia(e){const t=this.contentViewModels[e];t instanceof I$2&&t.next();}previousMedia(e){const t=this.contentViewModels[e];t instanceof I$2&&t.previous();}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null);}async graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:e}=this;if(!e)return;const t=new AbortController;this._featureAbortController=t;try{await this._queryFeature({signal:t.signal});}catch(r){d$k(r)||(this._error=r,D$2.error("error","The popupTemplate could not be displayed for this feature.",{error:r,graphic:e,popupTemplate:this._effectivePopupTemplate}));}this._featureAbortController===t&&(this._featureAbortController=null);}_cancelFeatureQuery(){const{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null;}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.filter(this._isAllowedContentType).map(((e,t)=>"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):void 0)):"string"==typeof e?this._compileText(new c$B({text:e}),0).text:e}_destroyContentViewModels(){this.contentViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("contentViewModels",[]);}_compileAttachments(e,t){const{graphic:r}=this,{description:i,title:o}=e;return this.contentViewModels[t]=new c$t({graphic:r,...this._compileTitleAndDesc({title:o,description:i})}),e}_compileCustom(e,t){const{graphic:r}=this,{creator:i,destroyer:o}=e;return this.contentViewModels[t]=new p$l({graphic:r,creator:i,destroyer:o}),e}_compileTitleAndDesc({title:e,description:t}){const{_fieldInfoMap:r,_sourceLayer:i,graphic:o,formattedAttributes:s,_expressionAttributes:a}=this,{attributes:n}=o,l=s.global;return {title:$$2({attributes:n,fieldInfoMap:r,globalAttributes:l,expressionAttributes:a,layer:i,text:e}),description:$$2({attributes:n,fieldInfoMap:r,globalAttributes:l,expressionAttributes:a,layer:i,text:t})}}_compileFields(e,t){const{_effectivePopupTemplate:r,formattedAttributes:i}=this,o=e.clone(),s={...i.global,...i.content[t]},a=(null==e?void 0:e.fieldInfos)||(null==r?void 0:r.fieldInfos),n=null==a?void 0:a.filter((({fieldName:e})=>j$1(e)||ae(e)||s.hasOwnProperty(e))),l=null==r?void 0:r.expressionInfos,{description:p,title:c}=o,d=new n$m({attributes:s,expressionInfos:l,fieldInfos:n,...this._compileTitleAndDesc({title:c,description:p})});return this.contentViewModels[t]=d,o.fieldInfos=d.formattedFieldInfos.slice(0),o}_compileMedia(e,t){const{graphic:r,_fieldInfoMap:i,_effectivePopupTemplate:o,relatedInfos:s,_sourceLayer:a,_expressionAttributes:n}=this,{attributes:l}=r,p=this.formattedAttributes.global,c=e.clone(),{description:d,mediaInfos:u,title:f}=c,h=new I$2({activeMediaInfoIndex:c.activeMediaInfoIndex||0,attributes:l,layer:a,fieldInfoMap:i,formattedAttributes:p,expressionAttributes:n,mediaInfos:u,popupTemplate:o,relatedInfos:s,...this._compileTitleAndDesc({title:f,description:d})});return c.mediaInfos=h.formattedMediaInfos.slice(0),this.contentViewModels[t]=h,c}_compileText(e,t){const r=e.clone(),{graphic:i,_fieldInfoMap:o,_sourceLayer:s,_expressionAttributes:a}=this;if(r&&r.text){const{attributes:e}=i,t=this.formattedAttributes.global;r.text=$$2({attributes:e,fieldInfoMap:o,globalAttributes:t,expressionAttributes:a,layer:s,text:r.text});}return this.contentViewModels[t]=new p$l({graphic:i,creator:r.text}),r}_compileLastEditInfo(){const{_effectivePopupTemplate:e,_sourceLayer:t,graphic:r}=this;if(!e)return;const{lastEditInfoEnabled:i}=e,o=null==t?void 0:t.editFieldsInfo;return i&&o?V$3(o,r.attributes):void 0}_compileTitle(e){const{_fieldInfoMap:t,_sourceLayer:r,graphic:i,_expressionAttributes:o}=this,{attributes:s}=i,a=this.formattedAttributes.global;return $$2({attributes:s,fieldInfoMap:t,globalAttributes:a,expressionAttributes:o,layer:r,text:e})}async _getTitle(){const{_effectivePopupTemplate:e,graphic:t}=this,r=null==e?void 0:e.title;return E$4(r,{graphic:t})}async _getContent(){const{_effectivePopupTemplate:e,graphic:t}=this,r=null==e?void 0:e.content;return E$4(r,{graphic:t})}async _queryFeature(e){const{_featureAbortController:t,_sourceLayer:r,graphic:i,_effectivePopupTemplate:o,spatialReference:s,map:a,view:n}=this,{content:{value:p},title:{value:c}}=await T$7({content:this._getContent(),title:this._getTitle()});if(t!==this._featureAbortController||!i)return;await oe({graphic:i,popupTemplate:o,layer:r,spatialReference:s},e);const{expressionAttributes:{value:d}}=await T$7({checkForRelatedFeatures:this._checkForRelatedFeatures(e),expressionAttributes:y$6({popupTemplate:this._effectivePopupTemplate,spatialReference:s,graphic:i,map:a,interceptor:U$5.interceptor,view:n})});t===this._featureAbortController&&i&&(this._expressionAttributes=d,this._set("formattedAttributes",this._createFormattedAttributes(p,d)),this._set("title",this._compileTitle(c)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(p)||null));}_createFormattedAttributes(e,t){const{_effectivePopupTemplate:r,graphic:i,relatedInfos:o,_sourceLayer:s,_fieldInfoMap:a}=this,n=null==r?void 0:r.fieldInfos,l={...i.attributes,...t},p={global:re({fieldInfos:n,graphic:i,attributes:l,layer:s,fieldInfoMap:a,relatedInfos:o}),content:[]};return Array.isArray(e)&&e.forEach(((e,t)=>{"fields"===e.type&&e.fieldInfos&&(p.content[t]=re({fieldInfos:e.fieldInfos,graphic:i,attributes:l,layer:s,fieldInfoMap:a,relatedInfos:o}));})),p}_checkForRelatedFeatures(e){const{graphic:t,_effectivePopupTemplate:r}=this;return this._queryRelatedInfos(t,X$1(r),e)}async _queryRelatedInfos(e,t,r){const{relatedInfos:i,_sourceLayer:o}=this;i.clear();const s=r$g(o.associatedLayer)?await o.associatedLayer.load(r):o;if(!s)return;const n=t.filter((e=>e&&ae(e.fieldName)));if(!n||!n.length)return;t.forEach((e=>this._configureRelatedInfo(e,s)));const l=await S$4({relatedInfos:i,layer:s},r);Object.keys(l).forEach((e=>{var t;const r=i.get(e.toString()),o=null==(t=l[e])?void 0:t.value;r&&o&&(r.layerInfo=o.data);}));const p=await T$4({graphic:e,relatedInfos:i,layer:s},r);Object.keys(p).forEach((e=>{var t;I$3(null==(t=p[e])?void 0:t.value,i.get(e.toString()));}));}_configureRelatedInfo(e,t){const{relatedInfos:r}=this,i=p$i(e.fieldName);if(!i)return;const{layerId:o,fieldName:s}=i;if(!o)return;const a=r.get(o.toString())||h$c(o,t);a&&($$1({relatedInfo:a,fieldName:s,fieldInfo:e}),this.relatedInfos.set(o,a));}};B$3.interceptor=new e$a(de,pe),e$f([d$h()],B$3.prototype,"_error",void 0),e$f([d$h()],B$3.prototype,"_featureAbortController",void 0),e$f([d$h({readOnly:!0})],B$3.prototype,"_effectivePopupTemplate",null),e$f([d$h({readOnly:!0})],B$3.prototype,"_fieldInfoMap",null),e$f([d$h({readOnly:!0})],B$3.prototype,"_sourceLayer",null),e$f([d$h()],B$3.prototype,"abilities",void 0),e$f([c$y("abilities")],B$3.prototype,"castAbilities",null),e$f([d$h({readOnly:!0})],B$3.prototype,"content",void 0),e$f([d$h({readOnly:!0})],B$3.prototype,"contentViewModels",void 0),e$f([d$h({type:Boolean})],B$3.prototype,"defaultPopupTemplateEnabled",void 0),e$f([d$h({readOnly:!0})],B$3.prototype,"state",null),e$f([d$h({readOnly:!0})],B$3.prototype,"formattedAttributes",void 0),e$f([d$h({type:h$j,value:null})],B$3.prototype,"graphic",null),e$f([d$h({readOnly:!0})],B$3.prototype,"lastEditInfo",void 0),e$f([d$h()],B$3.prototype,"relatedInfos",void 0),e$f([d$h()],B$3.prototype,"spatialReference",null),e$f([d$h({readOnly:!0})],B$3.prototype,"title",void 0),e$f([d$h()],B$3.prototype,"map",null),e$f([d$h({readOnly:!0})],B$3.prototype,"waitingForContent",null),e$f([d$h()],B$3.prototype,"view",void 0),B$3=U$5=e$f([i$j(q$1)],B$3);const G$3=B$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const i$f=i=>{let c=class extends i{constructor(){super(...arguments),this.renderNodeContent=e=>e$i(e)&&!e.destroyed?n$v("div",{key:e},e.render()):e instanceof HTMLElement?n$v("div",{key:e,bind:e,afterCreate:this._attachToNode}):t$l(e)?n$v("div",{key:e,bind:e.domNode,afterCreate:this._attachToNode}):null;}_attachToNode(e){const r=this;e.appendChild(r);}};return c=e$f([i$j("esri.widgets.Feature.ContentMixin")],c),c};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const g$9={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"},y$5={title:!0,content:!0,lastEditedInfo:!0};let _$6=class extends(i$f(z$4)){constructor(e,t){super(e,t),this._contentWidgets=[],this.graphic=null,this.defaultPopupTemplateEnabled=!1,this.headingLevel=2,this.label=void 0,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.spatialReference=null,this.title=null,this.visibleElements={...y$5},this.map=null,this.view=null,this.viewModel=new G$3;}initialize(){this.own(i$l(this,"viewModel.contentViewModels",(()=>this._setupContentWidgets())));}loadDependencies(){return import('./calcite-notice-091ca71e.js')}destroy(){this._destroyContentWidgets();}castVisibleElements(e){return {...y$5,...e}}render(){const{state:e}=this.viewModel,t=n$v("div",{class:g$9.container,key:"container"},this.renderTitle(),"error"===e?this.renderError():"loading"===e?this.renderLoading():this.renderContentContainer());return n$v("div",{class:this.classes(g$9.base,g$9.esriWidget)},t)}setActiveMedia(e,t){this.viewModel.setActiveMedia(e,t);}nextMedia(e){this.viewModel.nextMedia(e);}previousMedia(e){this.viewModel.previousMedia(e);}renderError(){const{messagesCommon:e,messages:t,visibleElements:i}=this;return n$v("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},i.title?n$v("div",{key:"error-title",slot:"title"},e.errorMessage):null,n$v("div",{key:"error-message",slot:"message"},t.loadingError))}renderLoading(){return n$v("div",{key:"loading-container",class:g$9.loadingSpinnerContainer},n$v("span",{class:this.classes(g$9.iconLoading,g$9.spinner)}))}renderContentContainer(){const{visibleElements:e}=this;return e.content?n$v("div",{class:g$9.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:e,title:t}=this;return e.title?n$v(s$n,{level:this.headingLevel,class:g$9.title,innerHTML:t}):null}renderContent(){const e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?n$v("div",{key:`${t}-content-elements`},e.map(this.renderContentElement,this)):null;if("string"==typeof e){const e=this._contentWidgets[0];return !e||e.destroyed?null:n$v("div",{key:`${t}-content`},e.render())}return this.renderNodeContent(e)}renderContentElement(e,t){const{visibleElements:i}=this;if("boolean"!=typeof i.content&&!i.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);default:return null}}renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:i,attachmentInfos:s}=t.viewModel;return "loading"===i||s.length>0?n$v("div",{key:this._buildKey("attachments-element",e),class:this.classes(g$9.contentElement)},t.render()):null}renderCustom(e,t){const{creator:i}=e,s=this._contentWidgets[t];return !s||s.destroyed?null:i?n$v("div",{key:this._buildKey("custom-element",t),class:g$9.contentElement},s.render()):null}renderFields(e){const t=this._contentWidgets[e];return !t||t.destroyed?null:n$v("div",{key:this._buildKey("fields-element",e),class:g$9.contentElement},t.render())}renderMedia(e){const t=this._contentWidgets[e];return !t||t.destroyed?null:n$v("div",{key:this._buildKey("media-element",e),class:g$9.contentElement},t.render())}renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:i}=this.viewModel;if(!i||!e.lastEditedInfo)return null;const{date:s,user:n}=i,r="edit"===i.type?n?t.lastEditedByUser:t.lastEdited:n?t.lastCreatedByUser:t.lastCreated,o=s$p(r,{date:s,user:n});return n$v("div",{key:"edit-info-element",class:this.classes(g$9.lastEditedInfo,g$9.contentElement)},o)}renderText(e,t){const i=e.text,s=this._contentWidgets[t];return !s||s.destroyed?null:i?n$v("div",{key:this._buildKey("text-element",t),class:this.classes(g$9.contentElement,g$9.text)},s.render()):null}_buildKey(e,...t){return `${e}__${this.get("viewModel.graphic.uid")||"0"}-${t.join("-")}`}_destroyContentWidgets(){this._contentWidgets.forEach((e=>{e.viewModel=null,e&&!e.destroyed&&e.destroy();})),this._contentWidgets=[];}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:e,visibleElements:t}=this,i=this.get("viewModel.content"),{contentViewModels:s}=this.viewModel;if(Array.isArray(i))i.forEach(((i,n)=>{"attachments"===i.type&&(this._contentWidgets[n]=new m$g({displayType:i.displayType,headingLevel:t.title?e+1:e,viewModel:s[n]})),"fields"===i.type&&(this._contentWidgets[n]=new m$f({viewModel:s[n]})),"media"===i.type&&(this._contentWidgets[n]=new g$b({viewModel:s[n]})),"text"===i.type&&(this._contentWidgets[n]=new p$k({viewModel:s[n]})),"custom"===i.type&&(this._contentWidgets[n]=new p$k({viewModel:s[n]}));}),this);else {const e=s[0];e&&!e.destroyed&&(this._contentWidgets[0]=new p$k({viewModel:e}));}this.scheduleRender();}};e$f([o$i("viewModel.graphic")],_$6.prototype,"graphic",void 0),e$f([o$i("viewModel.defaultPopupTemplateEnabled")],_$6.prototype,"defaultPopupTemplateEnabled",void 0),e$f([d$h()],_$6.prototype,"headingLevel",void 0),e$f([d$h({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],_$6.prototype,"label",void 0),e$f([d$h(),e$h("esri/widgets/Feature/t9n/Feature")],_$6.prototype,"messages",void 0),e$f([d$h(),e$h("esri/t9n/common")],_$6.prototype,"messagesCommon",void 0),e$f([d$h(),e$h("esri/widgets/support/t9n/uriUtils")],_$6.prototype,"messagesURIUtils",void 0),e$f([o$i("viewModel.spatialReference")],_$6.prototype,"spatialReference",void 0),e$f([o$i("viewModel.title")],_$6.prototype,"title",void 0),e$f([d$h()],_$6.prototype,"visibleElements",void 0),e$f([c$y("visibleElements")],_$6.prototype,"castVisibleElements",null),e$f([o$i("viewModel.map")],_$6.prototype,"map",void 0),e$f([o$i("viewModel.view")],_$6.prototype,"view",void 0),e$f([d$h({type:G$3})],_$6.prototype,"viewModel",void 0),_$6=e$f([i$j("esri.widgets.Feature")],_$6);const w$2=_$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let c$l=class extends n$u.EventedAccessor{constructor(e){super(e),this._anchorHandles=new u$j,this.location=null,this.screenLocation=null,this.screenLocationEnabled=!1,this.view=null,this._anchorHandles.add([f$e(this,["screenLocationEnabled","location","view.size","view.stationary"],(()=>this._updateScreenPointAndHandle())),f$e(this,["view","view.ready"],(()=>this._wireUpView()))]);}destroy(){this.view=null,this._anchorHandles&&this._anchorHandles.destroy(),this._anchorHandles=null,this._viewpointHandle=null;}_wireUpView(){const e="view";this._anchorHandles.remove(e),this._viewpointHandle=null;if(!this.get("view.ready"))return;this._setScreenLocation();const{view:t}=this,o="3d"===t.type?"camera":"viewpoint",i=O$5(t,o,(()=>this._viewpointChange()));this._anchorHandles.add(i,e),this._viewpointHandle=i,this._toggleWatchingViewpoint();}_viewpointChange(){this._setScreenLocation(),this.emit("view-change");}_updateScreenPointAndHandle(){this._setScreenLocation(),this._toggleWatchingViewpoint();}_toggleWatchingViewpoint(){const{_viewpointHandle:e,location:t,screenLocationEnabled:o}=this;if(!e)return;t&&o?e.resume():e.pause();}_setScreenLocation(){const{location:e,view:t,screenLocationEnabled:o}=this,n=this.get("view.ready"),s=o&&n&&r$g(e)?t.toScreen(e):null;this._set("screenLocation",s);}};e$f([d$h()],c$l.prototype,"location",void 0),e$f([d$h({readOnly:!0})],c$l.prototype,"screenLocation",void 0),e$f([d$h()],c$l.prototype,"screenLocationEnabled",void 0),e$f([d$h()],c$l.prototype,"view",void 0),c$l=e$f([i$j("esri.widgets.support.AnchorElementViewModel")],c$l);const l$d=c$l;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const t$f="esri.widgets.CompassViewModel";let p$g=class extends l$d{constructor(s){super(s),this.visible=!1;}};e$f([d$h()],p$g.prototype,"visible",void 0),p$g=e$f([i$j(t$f)],p$g);const c$k=p$g;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$j={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let h$a=class extends z$4{constructor(i,s){super(i,s),this._animationDelay=500,this._animationPromise=null,this.location=null,this.view=null,this.viewModel=new c$k,this.visible=!1;}initialize(){this.own([f$e(this,"visible",(i=>this._visibleChange(i)))]);}destroy(){this._animationPromise=null;}show(i){const{location:s,promise:e}=i;s&&(this.viewModel.location=s),this.visible=!0;const o=()=>this.hide();e&&e.catch((()=>{})).then(o);}hide(){this.visible=!1;}render(){const{visible:i}=this,{screenLocation:s}=this.viewModel,e=!!s,o=i&&e,t=!i&&e,r={[c$j.spinnerStart]:o,[c$j.spinnerFinish]:t},n=this._getPositionStyles();return n$v("div",{class:this.classes(c$j.base,r),styles:n})}_visibleChange(i){if(i)return void(this.viewModel.screenLocationEnabled=!0);const s=L$8(this._animationDelay);this._animationPromise=s,s.catch((()=>{})).then((()=>{this._animationPromise===s&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null);}));}_getPositionStyles(){const{screenLocation:i,view:e}=this.viewModel;if(!e||t$j(i))return {};const{padding:o}=e;return {left:i.x-o.left+"px",top:i.y-o.top+"px"}}};e$f([o$i("viewModel.location")],h$a.prototype,"location",void 0),e$f([o$i("viewModel.view")],h$a.prototype,"view",void 0),e$f([d$h({type:c$k})],h$a.prototype,"viewModel",void 0),e$f([o$i("viewModel.visible")],h$a.prototype,"visible",void 0),h$a=e$f([i$j("esri.widgets.Spinner")],h$a);const m$d=h$a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const t$e=s$q("mac")?"Meta":"Ctrl",o$c={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let s=48;s<58;s++)o$c[s]=String.fromCharCode(s);for(let s=1;s<25;s++)o$c[111+s]=`F${s}`;for(let s=65;s<91;s++)o$c[s]=[String.fromCharCode(s+32),String.fromCharCode(s)];function a$r(e){if(void 0!==e.key)return i$p(e);const t=o$c[e.keyCode];return Array.isArray(t)?e.shiftKey?t[1]:t[0]:t}function n$j(r){switch(r){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return !0}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class e$9{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t;}matches(e){if(e.type!==this.eventType)return !1;if(0===this.keyModifiers.length)return !0;const t=e.modifiers;for(const i of this.keyModifiers)if(!t.has(i))return !1;return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const n$i=s$k.getLogger("esri.views.input.InputHandler");class i$e{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e;}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const e of t)this._incomingEventMatches.push(e.match);}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((e=>e.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return !1}onInstall(e){this._manager?n$i.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback((e=>this._handleEvent(e))),e.setUninstallCallback((()=>this._onUninstall())),this._manager=e);}onUninstall(){}registerIncoming(e,n,i){let a;"function"==typeof n?(i=n,a=[]):a=n||[];const o="string"==typeof e?new e$9(e,a):e,h=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null;},r=e=>{const t=this._incoming[e.match.eventType];if(t){const n=t.indexOf(e);t.splice(n,1),h(),this._manager&&this._manager.updateDependencies();}},g=new s$i(o,i,{onPause:r,onRemove:r,onResume:e=>{const t=this._incoming[e.match.eventType];t&&-1===t.indexOf(e)&&(t.push(e),h(),this._manager&&this._manager.updateDependencies());}});let c=this._incoming[o.eventType];return c||(c=[],this._incoming[o.eventType]=c),c.push(g),h(),this._manager&&this._manager.updateDependencies(),g}registerOutgoing(e){if(this._outgoing[e])throw Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new a$q(e,{onEmit:(e,t,n,i)=>{this._manager.emit(e.eventType,t,n,i);},onRemove:e=>{delete this._outgoing[e.eventType],this._manager.updateDependencies();}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){this._manager.setPointerCapture(e,!0);}stopCapturingPointer(e){this._manager.setPointerCapture(e,!1);}refreshHasPendingInputs(){this._manager.refreshHasPendingInputs();}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):n$i.error("This InputHandler is not registered with an InputManager");}_handleEvent(e){const t=this._incoming[e.type];if(t)for(const n of t)if(n.match.matches(e)&&(n.callback(e),e.shouldStopPropagation()))break}}class s$i{constructor(e,t,n){this.match=e,this._callback=t,this._handler=n;}pause(){this._handler.onPause(this);}resume(){this._handler.onResume(this);}remove(){this._handler.onRemove(this);}get callback(){return this._callback}}class a$q{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t;}emit(e,t,n){this._removed||this._handler.onEmit(this,e,t,n);}remove(){this._removed=!0,this._handler.onRemove(this);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class t$d extends i$e{constructor(e){super(!0),this._onChange=e,this._value="mouse",this.registerIncoming("pointer-down",(e=>{const t="touch"===e.data.native.pointerType;this._setValue(t?"touch":"mouse");})),this._moveHandler=this.registerIncoming("pointer-move",(e=>{const t="touch"===e.data.native.pointerType;this._setValue(t?"touch":"mouse");})),this._moveHandler.pause();}_setValue(e){e!==this._value&&("touch"===e?this._moveHandler.resume():this._moveHandler.pause(),this._value=e,this._onChange(e));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const h$9=s$k.getLogger("esri.views.input.InputManager");let d$a=class extends p$u{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=t$e,this.latestPointerType="mouse",this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation};}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers();}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource=null,this._currentPropagation=null;}get hasPendingInputs(){return this._handlers.some((e=>e.handler.hasPendingInputs))}installHandlers(e,t,r=u$d.INTERNAL){if(this._nameToGroup[e])return void h$9.error("There is already an InputHandler group registered under the name `"+e+"`");if(0===t.length)return void h$9.error("Can't register a group of zero handlers");const i={name:e,handlers:t.map((e=>({handler:e,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[e]=i;for(let n=i.handlers.length-1;n>=0;n--){const e=i.handlers[n];this._handlers.push(e),e.handler.onInstall({updateDependencies:()=>{this.updateDependencies();},emit:(t,r,i,n,s)=>{this._emitInputEvent(e.priorityIndex+1,t,r,i,s,n);},setPointerCapture:(t,r)=>{this._setPointerCapture(i,e,t,r);},setEventCallback:t=>{e.eventCallback=t;},setUninstallCallback:t=>{e.uninstallCallback=t;},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs");}});}this.updateDependencies();}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach((e=>{e.removed=!0,e.uninstallCallback();})),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):h$9.error("There is no InputHandler group registered under the name `"+e+"`");}hasHandlers(e){return void 0!==this._nameToGroup[e]}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const e=this._handlers[r];e.priorityIndex=r,this._handlersPriority.push(e);}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const i=this._handlersPriority[r];i.priorityIndex=r;let n=i.handler.hasSideEffects;if(!n)for(const t of i.handler.outgoingEventTypes)if(e.has(t)){n=!0;break}if(n)for(const r of i.handler.incomingEventMatches){e.add(r.eventType);for(const e of r.keyModifiers)n$j(e)||t.add(e);}i.active=n;}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents);}_setLatestPointerType(e){this._set("latestPointerType",e);}_onEventReceived(e,t){if("pointer-capture-lost"===e){const e=t;this._pointerCaptures.delete(e.native.pointerId);}this._updateKeyModifiers(e,t);const r=null!=this.test.timestamp?this.test.timestamp:t.native?t.native.timestamp:void 0,i=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,r,i);}_updateKeyModifiers(e,t){if(!t)return;let r=!1;const i=()=>{if(!r){const e=new Set;this._activeKeyModifiers.forEach((t=>{e.add(t);})),this._activeKeyModifiers=e,r=!0;}},n=(e,t)=>{t&&!this._activeKeyModifiers.has(e)?(i(),this._activeKeyModifiers.add(e)):!t&&this._activeKeyModifiers.has(e)&&(i(),this._activeKeyModifiers.delete(e));};if("key-down"===e||"key-up"===e){const r=t.key;this._keyModifiers.has(r)&&n(r,"key-down"===e);}const s=t.native;n("Alt",!(!s||!s.altKey)),n("Ctrl",!(!s||!s.ctrlKey)),n("Shift",!(!s||!s.shiftKey)),n("Meta",!(!s||!s.metaKey)),n("Primary",this._activeKeyModifiers.has(this.primaryKey));}_installRecognizers(){this._latestPointerTypeHandler=new t$d((e=>this._setLatestPointerType(e))),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,u$d.INTERNAL),this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler],u$d.INTERNAL);}_setPointerCapture(e,t,r,i){const n=e.name+"-"+t.priorityIndex,s=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,s),i?(s.add(n),1===s.size&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):s.has(n)&&(s.delete(n),0===s.size&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)));}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((e=>!e.removed)),this.updateDependencies();}_emitInputEventFromSource(e,t,r,i){this._emitInputEvent(0,e,t,r,i);}_emitInputEvent(e,t,r,i,n,s){const o=void 0!==i?i:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),a=void 0!==n&&n,p={event:new l$c(t,r,o,s||this._activeKeyModifiers,a),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(p):this._doNewPropagation(p);}_doNewPropagation(e){this._currentPropagation={events:new e$j,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation();}_continuePropagation(){const e=this._currentPropagation;if(e){for(;this._currentPropagation.events.length>0;){const{event:t,priorityIndex:r}=this._currentPropagation.events.pop(),i=t.data&&t.data.eventId;if(!(null!=i&&this._stoppedPropagationEventIds.has(i)))for(e.currentHandler=this._handlersPriority[r];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else {if(e.currentHandler.active&&!t.shouldStopPropagation()&&e.currentHandler.eventCallback(t),t.shouldStopPropagation()){null!=i&&this._stoppedPropagationEventIds.add(i);break}if(t.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:t,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1];}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies();}}_pausePropagation(e){const t=new e$j;for(t.push(e);this._currentPropagation.events.length;)t.push(this._currentPropagation.events.pop());this._currentPropagation.events=t,this._currentPropagation.currentHandler=null;}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const e of t.handler.incomingEventMatches){if(r.eventType!==e.eventType)continue;const t=r.keyModifiers.filter((t=>-1!==e.keyModifiers.indexOf(t)));if(t.length===r.keyModifiers.length!==(t.length===e.keyModifiers.length))return r.keyModifiers.length>e.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const r of e){let e=0;for(;e<t.length&&this._compareHandlerPriority(r,t[e])>=0;)e++;t.splice(e,0,r);}return t}get debug(){const e=e=>{const t=this._setPointerCapture;this._setPointerCapture=()=>{},e(),this._setPointerCapture=t;};return {injectEvent:(t,r)=>{e((()=>{this._onEventReceived(t,r);}));},disablePointerCapture:e}}};e$f([d$h({readOnly:!0})],d$a.prototype,"hasPendingInputs",null),e$f([d$h()],d$a.prototype,"eventSource",void 0),e$f([d$h()],d$a.prototype,"recognizers",void 0),e$f([d$h({readOnly:!0})],d$a.prototype,"latestPointerType",void 0),d$a=e$f([i$j("esri.views.input.InputManager")],d$a);class l$c{constructor(e,t,r,i,n){this.type=e,this.data=t,this.timestamp=r,this.modifiers=i,this.cancelable=n,this._propagationState=0,this._resumeCallback=null;}stopPropagation(){this._propagationState|=1;}shouldStopPropagation(){return 0!=(1&this._propagationState)}async(e){this._propagationState|=2;const t=(e,t)=>{this._propagationState&=-3;const r=this._resumeCallback;if(this._resumeCallback=null,r&&r(),t)throw e;return e};return ("function"==typeof e?e():e).then((e=>t(e,!1)),(e=>t(e,!0)))}shouldPausePropagation(e){return !!(2&this._propagationState)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault();}}const u$d={DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const s$h={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},o$b=new a$A({id:"zoom-to-feature",title:"{messages.zoom}",className:s$h.iconZoom}),t$c=new a$A({id:"remove-selected-feature",title:"{messages.remove}",className:s$h.iconTrash}),r$a=new a$A({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:s$h.iconZoom}),i$d=new a$A({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:s$h.iconBrowseClusteredFeatures}),a$p=[o$b,t$c,i$d,r$a];

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const a$o="esri.widgets.Popup.PopupViewModel",s$g=s$k.getLogger(a$o),c$i=function(t){const{event:a,view:s}=t,{action:c}=a,u=s&&s.popup;if(!c)return Promise.reject(new s$l("trigger-action:missing-arguments","Event has no action"));if(!u)return Promise.reject(new s$l("trigger-action:missing-arguments","view.popup is missing"));const{disabled:d,id:w}=c;if(!w)return Promise.reject(new s$l("trigger-action:invalid-action","action.id is missing"));if(d)return Promise.reject(new s$l("trigger-action:invalid-action","Action is disabled"));if(w===o$b.id)return l$b(u.viewModel);if(w===r$a.id)return g$8(u.viewModel);if(w===i$d.id)return u.featureMenuOpen=!u.featureMenuOpen,u.viewModel.browseClusterEnabled=!u.viewModel.browseClusterEnabled,Promise.resolve();if(u.viewModel.browseClusterEnabled=!1,w===t$c.id){u.close();const{selectedFeature:t}=u;if(!t)return Promise.reject(new s$l(`trigger-action:${t$c.id}`,"selectedFeature is required",{selectedFeature:t}));const{sourceLayer:r}=t;return r?r.remove(t):s.graphics.remove(t),Promise.resolve()}return Promise.resolve()};function u$c(e){const{selectedFeature:t,location:r,view:i}=e;if(!i)return null;if("3d"===i.type)return t||r;return e.get("selectedFeature.geometry")||r}function d$9(t,r){if("3d"!==(null==r?void 0:r.type)||!t||"esri.Graphic"!==t.declaredClass)return !0;const i=r.getViewForGraphic(t);if(i&&"whenGraphicBounds"in i){let r=!1;return i.whenGraphicBounds(t,{useViewElevation:!0}).then((e=>{r=!e||!e.boundingBox||e.boundingBox[0]===e.boundingBox[3]&&e.boundingBox[1]===e.boundingBox[4]&&e.boundingBox[2]===e.boundingBox[5];})).catch((()=>{const r=new s$l("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});s$g.error(r);})),r}return !0}async function l$b(t){const{location:i,selectedFeature:o,view:n,zoomFactor:a}=t,c=u$c(t);if(!c){const t=new s$l("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:c,view:n});return s$g.error(t),Promise.reject(t)}const l=n.scale/a,g=t.get("selectedFeature.geometry")||i,w=g&&"point"===g.type&&d$9(o,n);o$b.active=!0,o$b.disabled=!0,await t.view.goTo({target:c,scale:w?l:void 0}),o$b.active=!1,o$b.disabled=!1,t.zoomToLocation=null,w&&(t.location=g);}async function g$8(t){const{selectedFeature:r,view:o}=t;if("2d"!==(null==o?void 0:o.type)){const t=new s$l("zoomToCluster:invalid-view","View must be 2d MapView.",{view:o});throw s$g.error(t),t}if(!r.isAggregate){const t=new s$l("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r});throw s$g.error(t),t}const n=r.sourceLayer,a=await o.whenLayerView(n),c=a.createQuery();c.aggregateIds=[r.getObjectId()],r$a.active=!0,r$a.disabled=!0;const{extent:u}=await a.queryExtent(c);await o.goTo({target:u}),r$a.active=!1,r$a.disabled=!1;}async function w$1(t){const{selectedFeature:r,view:i}=t;if("2d"!==(null==i?void 0:i.type)){const t=new s$l("displayClusterExtent:invalid-view","View must be 2d MapView.",{view:i});throw s$g.error(t),t}if(!r.isAggregate){const t=new s$l("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r});throw s$g.error(t),t}const o=r.sourceLayer,n=await i.whenLayerView(o),a=n.createQuery();a.aggregateIds=[r.getObjectId()];const{extent:c}=await n.queryExtent(a);t.selectedClusterBoundaryFeature.geometry=c,i.graphics.add(t.selectedClusterBoundaryFeature);}async function v$2(t){const{selectedFeature:r,view:i}=t;if("2d"!==(null==i?void 0:i.type)){const t=new s$l("browseAggregateFeatures:invalid-view","View must be 2d MapView.",{view:i});throw s$g.error(t),t}if(!r.isAggregate){const t=new s$l("browseAggregateFeatures:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r});throw s$g.error(t),t}const n=r.sourceLayer,a=await i.whenLayerView(n),c=a.createQuery();c.aggregateIds=[r.getObjectId()],i$d.active=!0,i$d.disabled=!0;const{features:u}=await a.queryFeatures(c);i$d.active=!1,i$d.disabled=!1,i.popup.open({features:[r].concat(u),featureMenuOpen:!0});}function p$f(e){e.features=e.features.filter((e=>e.isAggregate));}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const T$3=S$8.ofType({key:"type",defaultKeyValue:"button",base:c$C,typeMap:{button:a$A,toggle:a$B}}),S$3=()=>[o$b.clone()],B$2=()=>[r$a.clone(),i$d.clone()],R$3="esri.widgets.Popup.PopupViewModel",G$2=s$k.getLogger(R$3);let z$1=class extends(e$k(l$d)){constructor(e){super(e),this._handles=new u$j,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new T$3,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new h$j({symbol:new S$b({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null;}get isLoadingFeature(){return this.featureViewModels.some((e=>e.waitingForContent))}initialize(){this._handles.add([i$l(this,["autoOpenEnabled","view"],(()=>this._autoOpenEnabledChange())),this.on("view-change",(()=>this._autoClose())),f$e(this,["highlightEnabled","selectedFeature","visible","view"],(()=>this._highlightFeature())),f$e(this,"view.animation.state",(e=>this._animationStateChange(e))),f$e(this,"location",(e=>this._locationChange(e))),f$e(this,"selectedFeature",(e=>this._selectedFeatureChange(e))),f$e(this,["selectedFeatureIndex","featureCount","featuresPerPage"],(()=>this._selectedFeatureIndexChange())),f$e(this,["featurePage","selectedFeatureIndex","featureCount","featuresPerPage, featureViewModels"],(()=>this._setGraphicOnFeatureViewModels())),f$e(this,"featureViewModels",(()=>this._featureViewModelsChange())),this.on("trigger-action",(e=>c$i({event:e,view:this.view}))),h$k(this,"waitingForResult",(()=>this._waitingForResultChange()),!0),f$e(this,["features","view","view.map","view.spatialReference"],(()=>this._updateFeatureVMs())),f$e(this,["view.scale"],this._viewScaleChange),h$k(this,"visible",(()=>this.browseClusterEnabled=!1)),f$e(this,"browseClusterEnabled",(e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing()))]);}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null;}get active(){return !(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new T$3;e.removeAll();const{actions:t,defaultActions:s,defaultPopupTemplateEnabled:i,includeDefaultActions:o,selectedFeature:r}=this,n=o?s.concat(t):t,a=r&&("function"==typeof r.getEffectivePopupTemplate&&r.getEffectivePopupTemplate(i)||r.popupTemplate),l=a&&a.actions,u=a&&a.overwriteActions?l:l?l.concat(n):n;return u&&u.filter(Boolean).forEach((t=>e.add(t))),e}get defaultActions(){var e;const t=this._get("defaultActions")||new T$3;return t.removeAll(),t.addMany(null!=(e=this.selectedFeature)&&e.isAggregate?B$2():S$3()),t}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:s,promiseCount:i,selectedFeatureIndex:o}=this,r=i&&t.length;r&&s&&-1===o?this.selectedFeatureIndex=0:r&&-1!==o||(this.selectedFeatureIndex=t.length?0:-1);}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=R$6(e)),this._set("location",e);}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return !(!(!!this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach((e=>{this._pendingPromises.add(e);const t=t=>{this._pendingPromises.has(e)&&this._updateFeatures(t),this._updatePendingPromises(e);},s=()=>this._updatePendingPromises(e);e.then(t,s);})),this.notifyChange("pendingPromisesCount");}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;if(-1===t)return null;return e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return "number"==typeof e?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this._set("selectedFeatureIndex",e);}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=u$c(this);if(!t){const s=new s$l("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e});return G$2.error(s),Promise.reject(s)}return this.callGoTo({target:{target:t,scale:e.scale}})}clear(){this.set({promises:[],features:[],content:null,title:null,location:null});}fetchFeatures(e,t){const{view:s}=this;if(!s||!e){const t=new s$l("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:s});return G$2.error(t),Promise.reject(t)}return s.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:s}=t;delete t.fetchFeatures,s&&this._setFetchFeaturesPromises(t.location),this.set(t);}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t});}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){p$f(this),this._clearBrowsedClusterGraphics();}async enableClusterBrowsing(){await w$1(this),await v$2(this);}_animationStateChange(e){this.zoomToLocation||(o$b.disabled="waiting-for-target"===e);}_clearBrowsedClusterGraphics(){var e;const t=null==(e=this.view)?void 0:e.graphics;t&&(t.remove(this.selectedClusterBoundaryFeature),t.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null;}_viewScaleChange(){var e;(null!=(e=this.selectedFeature)&&e.isAggregate||this.browseClusterEnabled)&&(this.browseClusterEnabled=!1,this.visible=!1);}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:s}=this;s&&e&&(!t||t.geometry)&&this.centerAtLocation();}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null;}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null;}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:s,featuresPerPage:i,featureViewModels:o}=this;if(null===s)return;const r=((s-1)*i+t)%t,n=r+i;o.slice(r,n).forEach(((t,s)=>{t&&!t.graphic&&(t.graphic=e[r+s]);}));}async _selectedFeatureChange(e){if(!e)return;const{location:t,updateLocationEnabled:s,view:i}=this;if(this.browseClusterEnabled){if(this._selectedClusterFeature&&(i.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),e.isAggregate)return;return e.symbol=await f$f(e),this._selectedClusterFeature=e,void i.graphics.add(this._selectedClusterFeature)}!s&&t||!e.geometry?s&&!e.geometry&&this.centerAtLocation().then((()=>{this.location=i.center.clone();})):this.location=e$l(this._getPointFromGeometry(e.geometry));}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1);}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:s}=e,i=Promise.resolve(t),o=s.map((e=>e.promise));this.promises=[i,...o];}))}_destroyFeatureVMs(){this.featureViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",[]);}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:s}=this;if(null!=e&&e.isAggregate||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const i=s.slice(0),o=[];t.forEach(((t,s)=>{if(!t)return;let r=null;if(i.some(((e,s)=>(e&&e.graphic===t&&(r=e,i.splice(s,1)),!!r))),r)o[s]=r;else {var n,a;const i=new G$3({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:null==(n=this.view)?void 0:n.spatialReference,graphic:t===e?t:null,map:null==(a=this.view)?void 0:a.map,view:this.view});o[s]=i;}})),i.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",o);}_getScreenPoint(e){const{view:t}=this;return t&&e&&"function"==typeof t.toScreen?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:s}=this;if(t.remove(e),s&&this.view){const s=this.view.on("click",(e=>{"mouse"===e.pointerType&&0!==e.button||this._fetchFeaturesAndOpen(e);}),u$d.WIDGET);t.add(s,e);}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult");}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const s=new AbortController,{signal:i}=s;this._fetchFeaturesController=s,this.notifyChange("waitingForResult");const o=this.fetchFeatures(e,{signal:i,event:t});return o.catch((()=>{})).then((()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult");})),o}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:s}=e,{view:i}=this;this._fetchFeaturesWithController(t,e).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:o,location:r}=e,n=[Promise.resolve(t),...o.map((e=>e.promise))];return i.popup.open({location:r||s,promises:n}),e}));}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"));}_autoClose(){this.autoCloseEnabled&&(this.visible=!1);}_getPointFromGeometry(e){return t$j(e)?null:"point"===e.type?e:"extent"===e.type?e.center:"polygon"===e.type?e.centroid:"multipoint"===e.type||"polyline"===e.type?e.extent.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}async _highlightFeature(){const e="highlight";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:s,view:i,visible:o}=this;if(!(t&&i&&s&&o))return;let{layer:r,sourceLayer:n}=t;if("map-notes"!==(null==n?void 0:n.type)&&"subtype-group"!==(null==n?void 0:n.type)||(r=n),!(r&&r instanceof b$9))return;const a=this._getLayerView(i,r);this._highlightPromise=a;const l=await a;if(!(l&&e$m(l)&&this._highlightPromise===a&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const u="objectIdField"in r&&r.objectIdField,h=t.attributes,c=h&&u&&h[u],p=l.highlight(c||t);this._handles.add(p,e);}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const s=e.filter((e=>-1===t.indexOf(e)));this.features=t.concat(s);}};e$f([d$h()],z$1.prototype,"featurePage",void 0),e$f([d$h()],z$1.prototype,"isLoadingFeature",null),e$f([d$h({type:T$3})],z$1.prototype,"actions",void 0),e$f([d$h({readOnly:!0})],z$1.prototype,"active",null),e$f([d$h({readOnly:!0})],z$1.prototype,"allActions",null),e$f([d$h({type:Boolean})],z$1.prototype,"defaultPopupTemplateEnabled",void 0),e$f([d$h()],z$1.prototype,"autoCloseEnabled",void 0),e$f([d$h()],z$1.prototype,"autoOpenEnabled",void 0),e$f([d$h()],z$1.prototype,"browseClusterEnabled",void 0),e$f([d$h()],z$1.prototype,"content",void 0),e$f([d$h({type:T$3,readOnly:!0})],z$1.prototype,"defaultActions",null),e$f([d$h({readOnly:!0})],z$1.prototype,"featureCount",null),e$f([d$h()],z$1.prototype,"features",null),e$f([d$h()],z$1.prototype,"featuresPerPage",void 0),e$f([d$h()],z$1.prototype,"featureViewModelAbilities",void 0),e$f([d$h({readOnly:!0})],z$1.prototype,"featureViewModels",void 0),e$f([d$h()],z$1.prototype,"highlightEnabled",void 0),e$f([d$h()],z$1.prototype,"includeDefaultActions",void 0),e$f([d$h({type:b$a})],z$1.prototype,"location",null),e$f([d$h({readOnly:!0})],z$1.prototype,"pendingPromisesCount",null),e$f([d$h({readOnly:!0})],z$1.prototype,"selectedClusterBoundaryFeature",void 0),e$f([d$h({readOnly:!0})],z$1.prototype,"waitingForResult",null),e$f([d$h({readOnly:!0})],z$1.prototype,"promiseCount",null),e$f([d$h()],z$1.prototype,"promises",null),e$f([d$h({value:null,readOnly:!0})],z$1.prototype,"selectedFeature",null),e$f([d$h({value:-1})],z$1.prototype,"selectedFeatureIndex",null),e$f([d$h({readOnly:!0})],z$1.prototype,"selectedFeatureViewModel",null),e$f([d$h({readOnly:!0})],z$1.prototype,"state",null),e$f([d$h()],z$1.prototype,"title",void 0),e$f([d$h()],z$1.prototype,"updateLocationEnabled",void 0),e$f([d$h()],z$1.prototype,"view",void 0),e$f([d$h()],z$1.prototype,"visible",void 0),e$f([d$h()],z$1.prototype,"zoomFactor",void 0),e$f([d$h()],z$1.prototype,"zoomToLocation",void 0),e$f([d$h()],z$1.prototype,"centerAtLocation",null),z$1=e$f([i$j(R$3)],z$1);const U$4=z$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const O$2="selected-index",N$2=0,B$1="popup-spinner",T$2={iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:"esri-popup",widget:"esri-widget",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",isCollapsible:"esri-popup--is-collapsible",isCollapsed:"esri-popup--is-collapsed",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",isFeatureMenuOpen:"esri-popup--feature-menu-open",isActionsMenuOpen:"esri-popup--actions-menu-open",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerContainer:"esri-popup__header-container",headerContainerButton:"esri-popup__header-container--button",headerTitle:"esri-popup__header-title",content:"esri-popup__content",footer:"esri-popup__footer",footerHasPagination:"esri-popup__footer--has-pagination",footerHasActions:"esri-popup__footer--has-actions",footerHasActionsMenu:"esri-popup__footer--has-actions-menu",button:"esri-popup__button",buttonDisabled:"esri-popup__button--disabled",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",inlineActionsContainer:"esri-popup__inline-actions-container",actionsMenuButton:"esri-popup__actions-menu-button",actions:"esri-popup__actions",action:"esri-popup__action",actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",actionToggle:"esri-popup__action-toggle",actionToggleOn:"esri-popup__action-toggle--on",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",navigation:"esri-popup__navigation",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title",featureMenuObserver:"esri-popup__feature-menu-observer",featureMenuLoader:"esri-popup__feature-menu-loader",collapseButton:"esri-popup__collapse-button"},D$1={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},E$3="esri-popup";function P$2(e,t){return void 0===t?`${E$3}__${e}`:`${E$3}__${e}-${t}`}const L$3="esri.widgets.Popup",S$2=s$k.getLogger(L$3),V$2={closeButton:!0,featureNavigation:!0};let R$2=class extends(i$f(z$4)){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new u$j,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([e])=>{null!=e&&e.isIntersecting&&this.viewModel.featurePage++;},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback),this._displaySpinnerThrottled=e$e((()=>this._displaySpinner()),N$2),this.actions=null,this.alignment="auto",this.autoCloseEnabled=null,this.autoOpenEnabled=null,this.defaultPopupTemplateEnabled=null,this.content=null,this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureCount=null,this.featureMenuOpen=!1,this.features=null,this.goToOverride=null,this.headingLevel=2,this.highlightEnabled=null,this.location=null,this.label=void 0,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.promises=null,this.selectedFeature=null,this.selectedFeatureIndex=null,this.spinnerEnabled=!0,this.title=null,this.updateLocationEnabled=null,this.view=null,this.viewModel=new U$4,this.visible=null,this.visibleElements={...V$2},this._addSelectedFeatureIndexHandle(),this.own([f$e(this,"viewModel.screenLocation",(()=>this._positionContainer())),f$e(this,["viewModel.active","dockEnabled"],(()=>this._toggleScreenLocationEnabled())),f$e(this,"viewModel.screenLocation",((e,t)=>{!!e!=!!t&&this.reposition();})),f$e(this,["viewModel.view.padding","viewModel.view.size","viewModel.active","viewModel.location","alignment"],(()=>this.reposition())),f$e(this,"spinnerEnabled",(e=>this._spinnerEnabledChange(e))),f$e(this,"viewModel.view.size",((e,t)=>this._updateDockEnabledForViewSize(e,t))),f$e(this,"viewModel.view",((e,t)=>this._viewChange(e,t))),f$e(this,"viewModel.view.ready",((e,t)=>this._viewReadyChange(e,t))),f$e(this,["viewModel.waitingForResult","viewModel.location"],(()=>{this._hideSpinner(),this._displaySpinnerThrottled();})),f$e(this,["selectedFeatureWidget.viewModel.title","selectedFeatureWidget.viewModel.state"],(()=>this._setTitleFromFeatureWidget())),f$e(this,["selectedFeatureWidget.viewModel.content","selectedFeatureWidget.viewModel.state"],(()=>this._setContentFromFeatureWidget())),h$k(this,"collapsed",(()=>{var e,t;"xsmall"===(null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint)&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation();})),$$4(this,"viewModel.allActions","change",(()=>this._watchActions())),i$l(this,"viewModel.allActions",(()=>this._watchActions())),f$e(this,"viewModel.featureViewModels",(()=>this._featureMenuViewportScrollTop()))]);}destroy(){var e,t;this._destroySelectedFeatureWidget(),this._destroySpinner(),null==(e=this._handles)||e.destroy(),this._unobserveFeatureMenuObserver(),null==(t=this._featureMenuIntersectionObserver)||t.disconnect(),this._handles=null;}get actionsMenuId(){return `${this.id}-actions-menu`}get actionsMenuButtonId(){return `${this.id}-actions-menu-button`}get featureMenuId(){return `${this.id}-feature-menu`}get titleId(){return `${this.id}-popup-title`}get contentId(){return `${this.id}-popup-content`}get hasContent(){var e,t,i,o,n,s,r;return !!(this.selectedFeatureWidget?(null==(e=this.selectedFeatureWidget)||null==(t=e.viewModel)?void 0:t.waitingForContent)||"error"===(null==(i=this.selectedFeatureWidget)||null==(o=i.viewModel)?void 0:o.state)||(null==(n=this.selectedFeatureWidget)||null==(s=n.viewModel)?void 0:s.content):null==(r=this.viewModel)?void 0:r.content)}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return !!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e);}get actionsMenuOpen(){return !!this.viewModel.active&&this._get("actionsMenuOpen")}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||D$1}set dockOptions(e){const t={...D$1},i=this.get("viewModel.view.breakpoints"),o={};i&&(o.width=i.xsmall,o.height=i.xsmall);const n={...t,...e},s={...t.breakpoint,...o},{breakpoint:r}=n;!0===r?n.breakpoint=s:"object"==typeof r&&(n.breakpoint={...s,...r}),this._set("dockOptions",n),this._setCurrentDockPosition(),this.reposition();}get selectedFeatureWidget(){const{_feature:e,visibleElements:t,headingLevel:i}=this,{selectedFeatureViewModel:o}=this.viewModel,n={...t,title:!1};return o?(e?(e.viewModel=o,e.visibleElements=n):this._feature=new w$2({headingLevel:i+1,viewModel:o,visibleElements:n}),this._feature):null}castVisibleElements(e){return {...V$2,...e}}blur(){const{active:e}=this.viewModel;e||S$2.warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender();}clear(){this.viewModel.clear();}close(){this.visible=!1;}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||S$2.warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender();}next(){return this.viewModel.next()}open(e){var t,i;this._handles.remove(O$2);const o=!!e&&!!e.featureMenuOpen,n=!!e&&!!e.actionsMenuOpen,s={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:n,featureMenuOpen:o};"xsmall"===(null==(t=this.viewModel)||null==(i=t.view)?void 0:i.widthBreakpoint)&&(s.collapsed=!0),this.set(s),this.viewModel.open(e),this._addSelectedFeatureIndexHandle();}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment();}triggerAction(e){this.viewModel.triggerAction(e);}render(){var e,t,i,o;const{actionsMenuOpen:n,dockEnabled:s,featureMenuVisible:r,dividedActions:a,currentAlignment:l,currentDockPosition:u}=this,{active:c}=this.viewModel,{menuActions:d}=a,p=c&&d.length>1&&n,h=c&&s,g=c&&!s,_=null==(e=this.selectedFeature)||null==(t=e.layer)?void 0:t.title,f=null==(i=this.selectedFeature)||null==(o=i.layer)?void 0:o.id,v={[T$2.alignTopCenter]:"top-center"===l,[T$2.alignBottomCenter]:"bottom-center"===l,[T$2.alignTopLeft]:"top-left"===l,[T$2.alignBottomLeft]:"bottom-left"===l,[T$2.alignTopRight]:"top-right"===l,[T$2.alignBottomRight]:"bottom-right"===l,[T$2.isDocked]:h,[T$2.shadow]:g,[T$2.isDockedTopLeft]:"top-left"===u,[T$2.isDockedTopCenter]:"top-center"===u,[T$2.isDockedTopRight]:"top-right"===u,[T$2.isDockedBottomLeft]:"bottom-left"===u,[T$2.isDockedBottomCenter]:"bottom-center"===u,[T$2.isDockedBottomRight]:"bottom-right"===u,[T$2.isFeatureMenuOpen]:r,[T$2.isActionsMenuOpen]:p};return n$v("div",{class:this.classes(T$2.base,v),role:"presentation","data-layer-title":_,"data-layer-id":f,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},c?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return n$v("span",{"aria-hidden":"true",class:this.classes(T$2.icon,T$2.iconLoading,T$2.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?n$v("div",{key:P$2("loading-container"),role:"presentation",class:T$2.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=d$j(this.container),t={[T$2.iconRightTriangleArrow]:e,[T$2.paginationPreviousIconRTL]:e,[T$2.iconLeftTriangleArrow]:!e,[T$2.paginationPreviousIconLTR]:!e};return n$v("span",{"aria-hidden":"true",class:this.classes(T$2.icon,t)})}renderPreviousButton(){const{messages:e}=this;return n$v("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(T$2.button,T$2.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=d$j(this.container),t={[T$2.iconLeftTriangleArrow]:e,[T$2.paginationNextIconRTL]:e,[T$2.iconRightTriangleArrow]:!e,[T$2.paginationNextIconLTR]:!e};return n$v("span",{"aria-hidden":"true",class:this.classes(T$2.icon,t)})}renderNextButton(){const{messages:e}=this;return n$v("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(T$2.button,T$2.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:i}=this,{featureCount:o,selectedFeatureIndex:n}=this.viewModel;return n$v("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(T$2.button,T$2.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":i.menu,title:i.menu},this._getPageText(o,n))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),i={[T$2.iconUndock]:e,[T$2.iconDock]:!e,[T$2.iconDockToRight]:!e&&("top-right"===t||"bottom-right"===t),[T$2.iconDockToLeft]:!e&&("top-left"===t||"bottom-left"===t),[T$2.iconDockToTop]:!e&&"top-center"===t,[T$2.iconDockToBottom]:!e&&"bottom-center"===t};return n$v("span",{"aria-hidden":"true",class:this.classes(i,T$2.icon)})}renderDockButton(){var e,t,i;const{dockEnabled:o,messages:n}=this,s=null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint,r=o?n.undock:n.dock;return "xsmall"!==s&&null!=(i=this.dockOptions)&&i.buttonEnabled?n$v("div",{role:"button","aria-label":r,title:r,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(T$2.button,T$2.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:i,contentCollapsed:o,messagesCommon:n}=this,s={[T$2.headerContainerButton]:i},r=n$v(s$n,{level:this.headingLevel,class:T$2.headerTitle,innerHTML:e}),a=i?n$v("button",{key:`${e}--collapsible`,id:t,title:o?n.expand:n.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(T$2.headerContainer,s),"aria-expanded":o?"false":"true",onclick:this._toggleCollapsed},r):n$v("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(T$2.headerContainer,s)},r);return e?a:null}renderCloseIcon(){return n$v("span",{"aria-hidden":"true",class:this.classes(T$2.icon,T$2.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?n$v("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:T$2.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return n$v("header",{class:T$2.header},this.renderTitle(),n$v("div",{class:T$2.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:i}=this,{content:o}=this.viewModel;return t&&!i?n$v("article",{key:o,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:T$2.content},this.renderContent()):null}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:o,messagesCommon:n}=this,s=i?n.close:n.open,{menuActions:r}=o;return r.length?n$v("div",{key:P$2("actions-menu-button"),class:this.classes(T$2.button,T$2.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":i?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":s,title:s},n$v("span",{"aria-hidden":"true",class:T$2.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:o}=this,{menuActions:n,inlineActions:s}=o;return n.length&&i?n$v("ul",{id:e,role:"menu","aria-labelledby":t,key:P$2("actions"),class:T$2.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},n.toArray().map(((e,t)=>this.renderAction({action:e,index:t+s.length,type:"menu-item"})))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return !!e.length&&e.toArray().map(((e,t)=>this.renderAction({action:e,index:t,type:"inline"})))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,i=!!e.length,o=!!t.length;return i||o?n$v("div",{key:"inline-actions-container","data-inline-actions":i.toString(),"data-menu-actions":o.toString(),class:T$2.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?n$v("section",{key:P$2("navigation"),class:this.classes(T$2.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:i,menuActions:o}=t,n=!!i.length,s=!!o.length,r={[T$2.footerHasPagination]:e,[T$2.footerHasActions]:n,[T$2.footerHasActionsMenu]:s};return e||n?n$v("div",{key:P$2("feature-buttons"),class:this.classes(T$2.footer,r)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:i}=this.viewModel,o=s$p(e.selectedFeatures,{total:t.length});return n$v("section",{key:P$2("menu"),class:T$2.featureMenu},n$v("strong",{class:T$2.featureMenuHeader},o),n$v("nav",{bind:this,class:T$2.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:g$g},this.renderFeatureMenu(),n$v("div",{class:T$2.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),i?n$v("div",{class:T$2.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:n$v("div",{key:P$2("pointer"),class:T$2.pointer,role:"presentation"},n$v("div",{class:this.classes(T$2.pointerDirection,T$2.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:i,titleId:o,contentId:n,collapsible:s,hasContent:r,contentCollapsed:a,visibleElements:l}=this,{title:u}=this.viewModel,c="bottom-left"===t||"bottom-center"===t||"bottom-right"===t||"top-left"===i||"top-center"===i||"top-right"===i,d="top-left"===t||"top-center"===t||"top-right"===t||"bottom-left"===i||"bottom-center"===i||"bottom-right"===i,p={[T$2.shadow]:e,[T$2.isCollapsible]:s,[T$2.isCollapsed]:a};return n$v("div",{class:this.classes(T$2.main,T$2.widget,p),tabIndex:l.closeButton?null:-1,role:"dialog","aria-labelledby":u?o:"","aria-describedby":r&&!a?n:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},c?this.renderFooter():null,c?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),d?this.renderFooter():null,d?this.renderFeatureMenuContainer():null)}renderContent(){var e;const t=null==(e=this.viewModel)?void 0:e.content;return t?"string"==typeof t?n$v("div",{key:t,innerHTML:t}):this.renderNodeContent(t):null}renderActionText(e){return n$v("span",{key:"text",class:T$2.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),i=this._getActionImage(e),o={[T$2.iconLoading]:e.active,[T$2.rotating]:e.active,[T$2.icon]:!!t,[T$2.actionImage]:!e.active&&!!i};return t&&(o[t]=!e.active),n$v("span",{key:"icon","aria-hidden":"true",class:this.classes(T$2.icon,o),styles:this._getIconStyles(i)})}renderAction(e){const{action:t,index:i,type:o}=e,n=this._getActionTitle(t),s={[T$2.action]:"toggle"!==t.type,[T$2.actionToggle]:"toggle"===t.type,[T$2.actionToggleOn]:"toggle"===t.type&&t.value,[T$2.buttonDisabled]:t.disabled},r=[this.renderActionIcon(t),this.renderActionText(n)],a="menu-item"===o?n$v("li",{key:t.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(T$2.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},r):n$v("div",{key:t.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(T$2.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},r);return t.visible?a:null}renderFeatureMenuItem(e,t){const{messages:i,messagesCommon:o}=this,{selectedFeatureIndex:n,selectedFeatureViewModel:s}=this.viewModel,r=e===s,a={[T$2.featureMenuSelected]:r},l=r?n$v("span",{key:P$2(`feature-menu-selected-feature-${n}`),title:i.selectedFeature,"aria-label":i.selectedFeature,class:T$2.iconCheckMark}):null,u=n$v("span",{innerHTML:e.title||o.untitled});return n$v("li",{role:"menuitem",tabIndex:-1,key:P$2(`feature-menu-feature-${n}`),class:this.classes(a,T$2.featureMenuItem),bind:this,"data-feature-index":t,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature},n$v("span",{class:T$2.featureMenuTitle},u,l))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?n$v("ol",{class:T$2.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter((e=>!!e.graphic)).map(((e,t)=>this.renderFeatureMenuItem(e,t)))):null}_getActionTitle(e){const{messages:t,selectedFeature:i,messagesCommon:o}=this,{id:n}=e,s=null==i?void 0:i.attributes,r="zoom-to-feature"===n?s$p(e.title,{messages:t}):"remove-selected-feature"===n?s$p(e.title,{messages:o}):"zoom-to-clustered-features"===n||"browse-clustered-features"===n?s$p(e.title,{messages:t}):e.title;return r&&s?s$p(r,s):r}_getActionClass(e){const{selectedFeature:t}=this,i=null==t?void 0:t.attributes,{className:o,image:n}=e,s=n||o?o:T$2.iconDefaultAction;return s&&i?s$p(s,i):s}_getActionImage(e){const{selectedFeature:t}=this,i=null==t?void 0:t.attributes,{image:o}=e;return o&&i?s$p(o,i):o}_createFeatureUpdatedAnimation(){return f$g("enter",T$2.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if("number"!=typeof e)return null;const i=Math.round(e);return Math.max(t?i-1:i,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach((e=>{this._handles.add(f$e(e,["active","className","disabled","id","title","image","visible"],(()=>this.scheduleRender())),t);}));}_divideActions(){const{allActions:e}=this.viewModel,i=this._getInlineActionCount(),o=null===i,n=0===i;return {inlineActions:o?e.slice(0):n?new S$8:e.slice(0,i),menuActions:o?new S$8:n?e.slice(0):e.slice(i)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0;}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0;}_setTitleFromFeatureWidget(){const{selectedFeatureWidget:e,messagesCommon:t}=this;var i,o;e&&(this.viewModel.title="error"===(null==(i=e.viewModel)?void 0:i.state)?t.errorMessage:(null==(o=e.viewModel)?void 0:o.title)||"");}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e);}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode);}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e;}_handleFeatureMenuKeyup(e){"Escape"===i$p(e)&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender());}_handleActionMenuKeyup(e){"Escape"===i$p(e)&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender());}_handleFeatureMenuItemKeyup(e){const t=i$p(e),{_featureMenuNode:o}=this,n=e.currentTarget["data-feature-index"];if(!o)return;const s=o.querySelectorAll("li"),r=s.length;if("ArrowUp"!==t)if("ArrowDown"!==t)if("Home"!==t)if("End"!==t);else {e.stopPropagation();s[s.length-1].focus();}else {e.stopPropagation();s[0].focus();}else {e.stopPropagation();s[(n+1+r)%r].focus();}else {e.stopPropagation();s[(n-1+r)%r].focus();}}_handleActionMenuItemKeyup(e){const t=i$p(e),{_actionsMenuNode:o}=this,n=e.currentTarget["data-action-index"];if(!o)return;const s=o.querySelectorAll("li"),r=s.length;if("ArrowUp"!==t)if("ArrowDown"!==t)if("Home"!==t)if("End"!==t);else {e.stopPropagation();s[s.length-1].focus();}else {e.stopPropagation();s[0].focus();}else {e.stopPropagation();s[(n+1+r)%r].focus();}else {e.stopPropagation();s[(n-1+r)%r].focus();}}_handleMainKeyup(e){const t=i$p(e);"ArrowLeft"===t&&(e.stopPropagation(),this.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.next());}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t);}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide());}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:i}=this.viewModel;i?e.show({location:t}):e.hide();}_getIconStyles(e){return {"background-image":e?`url(${e})`:""}}_addSelectedFeatureIndexHandle(){const e=f$e(this,"viewModel.selectedFeatureIndex",((e,t)=>this._selectedFeatureIndexUpdated(e,t)));this._handles.add(e,O$2);}_selectedFeatureIndexUpdated(e,t){const{featureCount:i}=this;i&&e!==t&&-1!==e&&(this.actionsMenuOpen=!1,this.featureMenuOpen=!1);}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null;}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:i,screenLocation:o,side:n,view:s}=e;if(isNaN(i)||isNaN(t)||!s||!o)return !1;const r=s.padding;return "right"===n&&o.x+i/2>s.width-r.right||("left"===n&&o.x-i/2<r.left||("top"===n&&o.y-t<r.top||"bottom"===n&&o.y+t>s.height-r.bottom))}_calculateAutoAlignment(e){if("auto"!==e)return e;const{_pointerOffsetInPx:t,_containerNode:i,_mainContainerNode:o,viewModel:n}=this,{screenLocation:r,view:a}=n;if(t$j(r)||!a||!i)return "top-center";if(!this._isScreenLocationWithinView(r,a))return this._get("currentAlignment")||"top-center";function l(e){return parseInt(e.replace(/[^-\d\.]/g,""),10)}const u=o?window.getComputedStyle(o,null):null,c=u?l(u.getPropertyValue("max-height")):0,d=u?l(u.getPropertyValue("height")):0,{height:p,width:h}=i.getBoundingClientRect(),g=h+t,_=Math.max(p,c,d)+t,f=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"right",view:a}),v=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"left",view:a}),m=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"top",view:a}),b=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"bottom",view:a});return v?m?"bottom-right":"top-right":f?m?"bottom-left":"top-left":m?b?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return "function"==typeof e?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment());}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition());}_calculatePositionResult(e){const t=["left","right"];return d$j(this.container)&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return "function"==typeof e?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null==(e=this.dockOptions)?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var t;if("auto"!==e)return e;const i=null==(t=this.viewModel)?void 0:t.view,o=d$j(this.container)?"top-left":"top-right";if(!i)return o;const n=i.padding||{left:0,right:0,top:0,bottom:0},s=i.width-n.left-n.right,{breakpoints:r}=i;return r&&s<=r.xsmall?"bottom-center":o}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:i}=e.getBoundingClientRect(),o=this._calculatePositionStyle(t,i);o&&(e.style.top=o.top,e.style.left=o.left,e.style.bottom=o.bottom,e.style.right=o.right);}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:i}=this;return "top-left"===t||"bottom-left"===t||"top-right"===t||"bottom-right"===t?e+i:e}_calculateAlignmentPosition(e,t,i,o){const{currentAlignment:n,_pointerOffsetInPx:s}=this,r=o/2,a=i.height-t,l=i.width-e,{padding:u}=this.view;return "bottom-center"===n?{top:t+s-u.top,left:e-r-u.left}:"top-left"===n?{bottom:a+s-u.bottom,right:l+s-u.right}:"bottom-left"===n?{top:t+s-u.top,right:l+s-u.right}:"top-right"===n?{bottom:a+s-u.bottom,left:e+s-u.left}:"bottom-right"===n?{top:t+s-u.top,left:e+s-u.left}:"top-center"===n?{bottom:a+s-u.bottom,left:e-r-u.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:i,view:o}=this;if(!o)return;if(i)return {left:"",top:"",right:"",bottom:""};if(t$j(e)||!t)return;const n=this._calculateFullWidth(t),r=this._calculateAlignmentPosition(e.x,e.y,o,n);return r?{top:void 0!==r.top?`${r.top}px`:"auto",left:void 0!==r.left?`${r.left}px`:"auto",bottom:void 0!==r.bottom?`${r.bottom}px`:"auto",right:void 0!==r.right?`${r.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear());}_viewReadyChange(e,t){if(e){const e=this.get("viewModel.view");this._wireUpView(e);}else t&&(this.close(),this.clear());}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions);}_dockingThresholdCrossed(e,t,i){const[o,n]=e,[s,r]=t,{width:a,height:l}=i;return o<=a&&s>a||o>a&&s<=a||n<=l&&r>l||n>l&&r<=l}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const i=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},o=i.left+i.right,n=i.top+i.bottom,s=[],r=[];s[0]=e[0]-o,s[1]=e[1]-n,r[0]=t[0]-o,r[1]=t[1]-n;const{dockOptions:a}=this,l=a.breakpoint;this._dockingThresholdCrossed(s,r,l)&&this._setDockEnabledForViewSize(a),this._setCurrentDockPosition();}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus());}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");if(t.length){t[0].focus();}}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");if(t.length){t[0].focus();}}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus());}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus());}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0);}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const i=t.active&&!e;t.screenLocationEnabled=i;}_shouldDockAtCurrentViewSize(e){var t,i;const o=e.breakpoint,n=null==(t=this.viewModel)||null==(i=t.view)?void 0:i.ui;if(!n)return !1;const{width:s,height:r}=n;if(isNaN(s)||isNaN(r))return !1;const a=o.hasOwnProperty("width")&&s<=o.width,l=o.hasOwnProperty("height")&&r<=o.height;return a||l}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e));}_getPageText(e,t){return this.featureNavigationVisible?s$p(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,B$1),e.destroy(),this._spinner=null);}_createSpinner(e){e&&(this._spinner=new m$d({view:e}),e.ui.add(this._spinner,{key:B$1,position:"manual"}));}_toggleCollapsed(){this.collapsed=!this.collapsed;}_close(){this.close(),this.view&&this.view.focus();}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender();}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e;}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e;}_triggerAction(e){const t=e.currentTarget["data-action-index"],i=this.viewModel.allActions.getItemAt(t);i&&"toggle"===i.type&&(i.value=!i.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(t);}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender();}_next(){this.next();}_previous(){this.previous();}};e$f([d$h({readOnly:!0})],R$2.prototype,"actionsMenuId",null),e$f([d$h({readOnly:!0})],R$2.prototype,"actionsMenuButtonId",null),e$f([d$h({readOnly:!0})],R$2.prototype,"featureMenuId",null),e$f([d$h({readOnly:!0})],R$2.prototype,"titleId",null),e$f([d$h({readOnly:!0})],R$2.prototype,"contentId",null),e$f([d$h({readOnly:!0})],R$2.prototype,"hasContent",null),e$f([d$h({readOnly:!0})],R$2.prototype,"featureNavigationVisible",null),e$f([d$h({readOnly:!0})],R$2.prototype,"collapsible",null),e$f([d$h({readOnly:!0})],R$2.prototype,"featureMenuVisible",null),e$f([d$h({readOnly:!0})],R$2.prototype,"contentCollapsed",null),e$f([d$h({readOnly:!0})],R$2.prototype,"dividedActions",null),e$f([o$i("viewModel.actions")],R$2.prototype,"actions",void 0),e$f([d$h()],R$2.prototype,"actionsMenuOpen",null),e$f([d$h()],R$2.prototype,"alignment",void 0),e$f([o$i("viewModel.autoCloseEnabled")],R$2.prototype,"autoCloseEnabled",void 0),e$f([o$i("viewModel.autoOpenEnabled")],R$2.prototype,"autoOpenEnabled",void 0),e$f([o$i("viewModel.defaultPopupTemplateEnabled")],R$2.prototype,"defaultPopupTemplateEnabled",void 0),e$f([o$i("viewModel.content")],R$2.prototype,"content",void 0),e$f([d$h()],R$2.prototype,"collapsed",void 0),e$f([d$h()],R$2.prototype,"collapseEnabled",void 0),e$f([d$h({readOnly:!0})],R$2.prototype,"currentAlignment",null),e$f([d$h({readOnly:!0})],R$2.prototype,"currentDockPosition",null),e$f([d$h()],R$2.prototype,"dockOptions",null),e$f([d$h()],R$2.prototype,"dockEnabled",void 0),e$f([o$i("viewModel.featureCount")],R$2.prototype,"featureCount",void 0),e$f([d$h()],R$2.prototype,"featureMenuOpen",void 0),e$f([o$i("viewModel.features")],R$2.prototype,"features",void 0),e$f([o$i("viewModel.goToOverride")],R$2.prototype,"goToOverride",void 0),e$f([d$h()],R$2.prototype,"headingLevel",void 0),e$f([o$i("viewModel.highlightEnabled")],R$2.prototype,"highlightEnabled",void 0),e$f([o$i("viewModel.location")],R$2.prototype,"location",void 0),e$f([d$h({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],R$2.prototype,"label",void 0),e$f([d$h()],R$2.prototype,"maxInlineActions",void 0),e$f([d$h(),e$h("esri/widgets/Popup/t9n/Popup")],R$2.prototype,"messages",void 0),e$f([d$h(),e$h("esri/t9n/common")],R$2.prototype,"messagesCommon",void 0),e$f([o$i("viewModel.promises")],R$2.prototype,"promises",void 0),e$f([o$i("viewModel.selectedFeature")],R$2.prototype,"selectedFeature",void 0),e$f([o$i("viewModel.selectedFeatureIndex")],R$2.prototype,"selectedFeatureIndex",void 0),e$f([d$h({readOnly:!0})],R$2.prototype,"selectedFeatureWidget",null),e$f([d$h()],R$2.prototype,"spinnerEnabled",void 0),e$f([o$i("viewModel.title")],R$2.prototype,"title",void 0),e$f([o$i("viewModel.updateLocationEnabled")],R$2.prototype,"updateLocationEnabled",void 0),e$f([o$i("viewModel.view")],R$2.prototype,"view",void 0),e$f([d$h({type:U$4}),t$m(["triggerAction","trigger-action"])],R$2.prototype,"viewModel",void 0),e$f([o$i("viewModel.visible")],R$2.prototype,"visible",void 0),e$f([d$h()],R$2.prototype,"visibleElements",void 0),e$f([c$y("visibleElements")],R$2.prototype,"castVisibleElements",null),e$f([t$n()],R$2.prototype,"_close",null),e$f([t$n()],R$2.prototype,"_toggleDockEnabled",null),e$f([t$n()],R$2.prototype,"_toggleFeatureMenu",null),e$f([t$n()],R$2.prototype,"_toggleActionsMenu",null),e$f([t$n()],R$2.prototype,"_triggerAction",null),e$f([t$n()],R$2.prototype,"_selectFeature",null),e$f([t$n()],R$2.prototype,"_next",null),e$f([t$n()],R$2.prototype,"_previous",null),R$2=e$f([i$j(L$3)],R$2);const U$3=R$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const u$b=[0,0];function l$a(e){const t=(e.ownerDocument||window.document).defaultView,s=e.getBoundingClientRect();return u$b[0]=s.left+t.pageXOffset,u$b[1]=s.top+t.pageYOffset,u$b}function p$e(e){e&&(t$o(e),e.parentNode&&e.parentNode.removeChild(e));}function c$h(e){const t=document.createElement("div");return e.appendChild(t),t}const m$c=16,f$4=750,y$4=512,v$1=2,_$5=i=>{let u=class extends i{constructor(...e){super(...e),this._freqInfo={freq:m$c,time:f$4},this._overlayRenderTaskHandle=null,this.height=0,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.handles.add([this.watch("cursor",(e=>{const t=this.surface;t&&t.setAttribute("data-cursor",e);})),this.watch("interacting",(e=>{const t=this.surface;t&&t.setAttribute("data-interacting",e.toString());}))]);}initialize(){this.handles.add(this.watch("ui",((e,t)=>this._handleUIChange(e,t)))),this._wireUI(this.ui),this.handles.add([this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))]);}destroy(){this.destroyed||(this.ui&&(this.ui.destroy(),this.ui=null),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null);}set container(e){const s=this._get("container");if(s===e)return;const i="dom-size";if(this.handles.remove(i),this._stopMeasuring(),s&&(s.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),p$e(this.root),this._set("root",null),r$h(this.userContent,s),p$e(this.userContent),this._set("userContent",null)),e){e.classList.add("esri-view");const s=document.createElement("div");s.className="esri-view-user-storage",r$h(e,s),e.appendChild(s),this._set("userContent",s);const n=document.createElement("div");n.className="esri-view-root",e.insertBefore(n,e.firstChild),this._set("root",n);const h=document.createElement("div");h.className="esri-view-surface",h.setAttribute("role","application"),h.tabIndex=0,n.appendChild(h),this._set("surface",h);const d=new n$p;n.appendChild(d.surface),this._set("overlay",d),d.watch("needsRender",(e=>{e&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=A$5({render:()=>{this.overlay.render();}}):this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null);})),this.forceDOMReadyCycle(),this.handles.add(i$l(this,"size",(e=>{const[t,s]=e,i="esri-view-surface--inset-outline";t>=document.body.clientWidth||s>=document.body.clientHeight?h.classList.add(i):h.classList.remove(i);})),i),this._set("container",e),this._startMeasuring();}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null);}get focused(){const e=document.activeElement===this.surface;return document.hasFocus()&&e}get popup(){return this._get("popup")||new U$3({view:this})}set popup(e){const t=this._get("popup");t&&t!==e&&t.destroy(),this._set("popup",e);}get size(){return [this.width,this.height]}blur(){this.surface&&this.surface.blur();}focus(){this.surface&&this.surface.focus();}pageToContainer(e,t,s){const i=this.position;return e-=i[0],t-=i[1],s?(s[0]=e,s[1]=t):s=[e,t],s}containerToPage(e,t,s){const i=this.position;return e+=i[0],t+=i[1],s?(s[0]=e,s[1]=t):s=[e,t],s}_handleUIChange(e,t){t&&(this.handles.remove("ui"),t.destroy()),e&&this._wireUI(e),this._set("ui",e);}_wireUI(e){this.handles.remove("ui"),e&&(e.view=this,this.handles.add([i$l(this,"root",(t=>{e.container=t?c$h(t):null;})),i$l(this,"popup",((t,s)=>{const i="popup",o="manual";s&&e.remove(s,i),t&&(t.view=e.view,e.add(t,{key:i,position:o}));}))],"ui"));}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1);}_startMeasuring(){const e=this._freqInfo;e.freq=m$c,e.time=f$4,this.handles.add([(()=>{const t=()=>{e.freq=m$c,e.time=f$4;};return window.addEventListener("resize",t),{remove(){window.removeEventListener("resize",t);}}})(),A$5({prepare:e=>{const t=this._measure(),s=this._freqInfo;if(s.time+=e.deltaTime,t&&(s.freq=m$c,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const i=this._position();s.freq=i||t?m$c:Math.min(f$4,s.freq*v$1),!t&&s.freq>=y$4&&this._get("resizing")&&this._set("resizing",!1);}})],"measuring"),this._measure(),this._position();}_measure(){const e=this.container,t=e?e.clientWidth:0,s=e?e.clientHeight:0;if(0===t||0===s)return this.suspended||this._set("suspended",!0),!1;const i=this.width,o=this.height;return t===i&&s===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",t),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:i,oldHeight:o,width:t,height:s}),!0)}_position(){const e=this.container,t=this.position,s=l$a(e);return (!t||s[0]!==t[0]||s[1]!==t[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return e$f([d$h({value:null,cast:e=>e$n(e)})],u.prototype,"container",null),e$f([d$h({readOnly:!0})],u.prototype,"focused",null),e$f([d$h({readOnly:!0})],u.prototype,"height",void 0),e$f([d$h({type:U$3})],u.prototype,"popup",null),e$f([d$h({type:n$p})],u.prototype,"overlay",void 0),e$f([d$h({readOnly:!0})],u.prototype,"position",void 0),e$f([d$h({readOnly:!0})],u.prototype,"resizing",void 0),e$f([d$h({readOnly:!0})],u.prototype,"root",void 0),e$f([d$h({value:null,readOnly:!0})],u.prototype,"size",null),e$f([d$h({readOnly:!0})],u.prototype,"surface",void 0),e$f([d$h({readOnly:!0})],u.prototype,"suspended",void 0),e$f([d$h()],u.prototype,"ui",void 0),e$f([d$h({readOnly:!0})],u.prototype,"userContent",void 0),e$f([d$h({readOnly:!0})],u.prototype,"width",void 0),e$f([d$h()],u.prototype,"widthBreakpoint",void 0),u=e$f([i$j("esri.views.DOMContainer")],u),u};function g$7(e){return e&&"focus"in e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var u$a;let m$b=u$a=class extends a$w{constructor(...o){super(...o),this.position=new b$a([0,0,0]),this.heading=0,this.tilt=0,this.fov=55;}normalizeCtorArgs(o,t,r,e){if(o&&"object"==typeof o&&("x"in o||Array.isArray(o))){const i={position:o};return null!=t&&(i.heading=t),null!=r&&(i.tilt=r),null!=e&&(i.fov=e),i}return o}writePosition(o,t,r,e){const i=o.clone();i.x=a$C(o.x||0),i.y=a$C(o.y||0),i.z=o.hasZ?a$C(o.z||0):o.z,t[r]=i.write({},e);}readPosition(o,t){const r=new b$a;return r.read(o,t),r.x=a$C(r.x||0),r.y=a$C(r.y||0),r.z=r.hasZ?a$C(r.z||0):r.z,r}equals(o){return !!o&&(this.tilt===o.tilt&&this.heading===o.heading&&this.fov===o.fov&&this.position.equals(o.position))}clone(){return new u$a({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})}};e$f([d$h({type:b$a,json:{write:{isRequired:!0}}})],m$b.prototype,"position",void 0),e$f([r$d("position")],m$b.prototype,"writePosition",null),e$f([o$j("position")],m$b.prototype,"readPosition",null),e$f([d$h({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),c$y((o=>U$8.normalize(a$C(o))))],m$b.prototype,"heading",void 0),e$f([d$h({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),c$y((o=>e$g(a$C(o),-180,180)))],m$b.prototype,"tilt",void 0),e$f([d$h({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],m$b.prototype,"fov",void 0),m$b=u$a=e$f([i$j("esri.Camera")],m$b);const d$8=m$b;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var m$a;let n$h=m$a=class extends a$w{constructor(r){super(r),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null;}castRotation(r){return (r%=360)<0&&(r+=360),r}clone(){return new m$a({rotation:this.rotation,scale:this.scale,targetGeometry:r$g(this.targetGeometry)?this.targetGeometry.clone():null,camera:r$g(this.camera)?this.camera.clone():null})}};function l$9(){return {enabled:!this.camera}}e$f([d$h({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:l$9}}}}})],n$h.prototype,"rotation",void 0),e$f([c$y("rotation")],n$h.prototype,"castRotation",null),e$f([d$h({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:l$9}}}}})],n$h.prototype,"scale",void 0),e$f([d$h({types:i$q,json:{read:d$l,write:!0,origins:{"web-scene":{read:d$l,write:{overridePolicy:l$9}}}}})],n$h.prototype,"targetGeometry",void 0),e$f([d$h({type:d$8,json:{write:!0}})],n$h.prototype,"camera",void 0),n$h=m$a=e$f([i$j("esri.Viewpoint")],n$h);const u$9=n$h;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const a$n=a=>{let t=class extends a{async fetchPopupFeatures(e,s){await this.when();const{location:p,queryArea:a,layerViewsAndGraphics:t,clientOnlyGraphics:o}=await this._prepareFetchPopupFeatures(e,s),c=Promise.resolve(o),n=this._queryLayerPopupFeatures(a,t,s),l=n.map((e=>e.promise));return {location:p,clientOnlyGraphics:o,allGraphicsPromise:E$8([c,...l]).then(M$4),promisesPerLayerView:n}}_queryLayerPopupFeatures(e,r,i){return r.map((({layerView:r,graphics:p})=>{const a={clientGraphics:p,event:r$g(i)?i.event:null,signal:r$g(i)?i.signal:null,defaultPopupTemplateEnabled:!!r$g(i)&&!!i.defaultPopupTemplateEnabled},t=r.fetchPopupFeatures(e,a);return {layerView:r,promise:t}}))}_isValidPopupGraphic(e,r){return e&&!!e.getEffectivePopupTemplate(r$g(r)&&r.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(e,r){const{clientGraphics:s,queryArea:i,location:p}=await this._popupHitTestGraphics(e,r),a=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:t,clientOnlyGraphics:o}=this._graphicsPerFetchPopupLayerView(s,a);return {clientOnlyGraphics:o,layerViewsAndGraphics:t,queryArea:i,location:p}}async _popupHitTestGraphics(e,r){const{results:s,mapPoint:i}=await this.popupHitTest(e),p=s.filter((e=>this._isValidPopupGraphic(e.graphic,r))),a=p.length?p[0].mapPoint:null;return {clientGraphics:p.map((e=>e.graphic)),queryArea:i,location:i||a}}_getFetchPopupLayerViews(){const e=[];return this.allLayerViews.forEach((r=>{this._isValidPopupLayerView(r)&&e.push(r);})),r$g(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&e.push(this.graphicsView),e.reverse()}_isValidPopupLayerView(e){return r$g(e)&&(!("layer"in e)||!e.suspended)&&"fetchPopupFeatures"in e}_graphicsPerFetchPopupLayerView(e,r){const s=[],i=new Map,p=r.map((e=>{const r=[];return "layer"in e?i.set(e.layer,r):i.set(e.graphics,r),{layerView:e,graphics:r}}));for(const a of e){const e=i.get(a.layer)||i.get(a.sourceLayer)||null;e?e.push(a):s.push(a);}return {layerViewsAndGraphics:p,clientOnlyGraphics:s}}};return t=e$f([i$j("esri.views.PopupView")],t),t};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let a$m=class extends p$u{constructor(e){super(e),this.view=null,this.baseLayerViews=new S$8,this.referenceLayerViews=new S$8,this._loadingHandle=i$l(this,"view.map.basemap",(e=>{e&&e.load().catch((()=>{}));}));}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);}get suspended(){return !this.view||this.view.suspended}get updating(){return (!this.view||!this.view.suspended)&&!(!(this.view&&this.view.map&&this.view.map.basemap)||this.view.map.basemap.loaded)}};e$f([d$h({constructOnly:!0})],a$m.prototype,"view",void 0),e$f([d$h({readOnly:!0})],a$m.prototype,"baseLayerViews",void 0),e$f([d$h({readOnly:!0})],a$m.prototype,"referenceLayerViews",void 0),e$f([d$h({readOnly:!0})],a$m.prototype,"suspended",null),e$f([d$h({type:Boolean,readOnly:!0})],a$m.prototype,"updating",null),a$m=e$f([i$j("esri.views.BasemapView")],a$m);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const _$4=s$k.getLogger("esri.views.LayerViewManager");class g$6{constructor(e,r,t){this.layer=e,this.view=r,this.layerViewImporter=t,this._controller=new AbortController,this._deferred=A$6(),this._started=!1,this.done=!1,j$4(this._controller.signal,(()=>{const r=new s$l("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(r);}));}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:r,view:i}=this;r.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{layer:r,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null;}async start(){if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:r,view:t}=this;this._map=t.map;try{var a,s;let l,y;if(await r.load({signal:e}),"prefetchResources"in r&&await r.prefetchResources({signal:e}),r.createLayerView)l=await r.createLayerView(t,{signal:e});else {if(!this.layerViewImporter.hasLayerViewModule(r))throw new s$l("layer:view-not-supported","No layerview implementation was found");const a=await this.layerViewImporter.importLayerView(r);h$h(e),l="default"in a?new a.default({layer:r,view:t}):new a({layer:r,view:t});}const h=()=>{y=s$r(y),l.destroyed||l.destroy(),l.layer=null,l.parent=null,l.view=null,this.done=!0;};y=j$4(e,h),h$h(e);try{await l.when();}catch(o){throw h(),o}if(!(null==(a=this._map)||null==(s=a.allLayers)?void 0:s.includes(r)))return h(),void this._deferred.reject(new s$l("view:no-layerview-for-layer","The layer has been removed from the map",{layer:r}));this.layerView=l,r.emit("layerview-create",{view:t,layerView:l}),t.emit("layerview-create",{layer:r,layerView:l}),this.done=!0,this._deferred.resolve(l);}catch(o){r.emit("layerview-create-error",{view:t,error:o}),t.emit("layerview-create-error",{layer:r,error:o}),this.done=!0,this._deferred.reject(new s$l("layerview:create-error","layerview creation failed",{layer:r,error:o}));}}}let V$1=class extends d$i{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new l$k,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var e;const r=null==(e=this.view.map)?void 0:e.allLayers;if(r)for(const i of r)this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i);},this._reschedule=()=>(t$j(this._workPromise)&&(this._workPromise=A$6()),this.handles.remove("reschedule"),this.handles.add(v$7(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var e,i,t;const a=this.view.map;if(this._map!==a&&(this.clear(),this._map=a),t$j(this._workPromise))return void this.notifyChange("updating");this.handles.remove("reschedule"),this.handles.remove("collection-change");const s=new p$v({getCollections:()=>this._rootCollectionNames.map((e=>this.get(e))),getChildrenFunction:e=>e&&"layers"in e?e.layers:null});if(!s)return this._workPromise.resolve(),void(this._workPromise=null);for(const r of s)this._createLayerView(r);this._refreshCollections();for(const[r,o]of this._layerLayerViewInfoMap)s.includes(r)||(this._layerLayerViewInfoMap.delete(o.layer),o.destroy());const l=s.filter((e=>"group"===e.type)).map((e=>e.layers)),n=[null==a||null==(e=a.ground)?void 0:e.layers,null==a||null==(i=a.basemap)?void 0:i.baseLayers,null==a||null==(t=a.basemap)?void 0:t.referenceLayers,null==a?void 0:a.layers,...l].filter((e=>!!e));this.handles.add(n.map((e=>this._watchUpdatingTracking.addOnCollectionChange(e,this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null;};}initialize(){this.handles.add([$$4(this,"view.map.allLayers","change",this._preloadLayerViewModules,this._preloadLayerViewModules),i$l(this.view,["map.basemap","map.ground","map.layers","ready"],this._reschedule,!0)]),this._preloadLayerViewModules(),this._reschedule();}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null;}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return r$g(this._workPromise)||this._watchUpdatingTracking.updating||n$w(this._layerLayerViewInfoMap,(e=>!e.done))}get updatingRemaining(){let e=0;for(const r of this._layerLayerViewInfoMap.values())r.done||++e;return e}clear(){if(!this.destroyed){for(const e of this._layerLayerViewInfoMap.values())e.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections();}}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e))throw new s$l("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,r]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(r),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining");}_populateLayerViewsOwners(e,r,i){if(!e||!r)return void(r&&r.removeAll());let t=0;for(const a of e){const e=this._layerLayerViewInfoMap.get(a);if(!e||!e.layerView)continue;const s=e.layerView;s.layer=a,s.parent=i,r.getItemAt(t)!==s&&r.splice(t,0,s),a.layers&&this._populateLayerViewsOwners(a.layers,s.layerViews,s),t+=1;}t<r.length&&r.splice(t,r.length);}_createLayerView(e){if(this._layerLayerViewInfoMap.has(e))return this.view.ready&&this._layerLayerViewInfoMap.get(e).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");e.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const r=new g$6(e,this.view,this.layerViewImporter);r.promise.then((()=>this._refreshCollections()),(r=>{var i,t;r&&(d$k(r)||"cancelled:layerview-create"===r.name)||_$4.error(`Failed to create layerview for layer title:'${null!=(i=e.title)?i:"no title"}', id:'${null!=(t=e.id)?t:"no id"}' of type '${e.type}'.`,{layer:e,error:r});this._refreshCollections();})),this._layerLayerViewInfoMap.set(e,r),this.view.ready&&r.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining");}};e$f([d$h()],V$1.prototype,"_workPromise",void 0),e$f([d$h({readOnly:!0})],V$1.prototype,"_watchUpdatingTracking",void 0),e$f([d$h({readOnly:!0})],V$1.prototype,"_layersToLayerViews",null),e$f([d$h({readOnly:!0})],V$1.prototype,"_rootCollectionNames",null),e$f([d$h()],V$1.prototype,"layerViewImporter",void 0),e$f([d$h()],V$1.prototype,"supportsGround",void 0),e$f([d$h({readOnly:!0})],V$1.prototype,"updating",null),e$f([d$h({readOnly:!0})],V$1.prototype,"updatingRemaining",null),e$f([d$h({constructOnly:!0})],V$1.prototype,"view",void 0),V$1=e$f([i$j("esri.views.LayerViewManager")],V$1);const L$2=V$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let i$c=class extends p$u{constructor(o){super(o),this.factor=1.5,this.offset=c$D(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0;}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};e$f([d$h({type:Number})],i$c.prototype,"factor",void 0),e$f([d$h({nonNullable:!0})],i$c.prototype,"offset",void 0),e$f([d$h()],i$c.prototype,"position",void 0),e$f([d$h({type:Number,range:{min:0}})],i$c.prototype,"size",void 0),e$f([d$h()],i$c.prototype,"maskUrl",void 0),e$f([d$h()],i$c.prototype,"maskEnabled",void 0),e$f([d$h()],i$c.prototype,"overlayUrl",void 0),e$f([d$h()],i$c.prototype,"overlayEnabled",void 0),e$f([d$h({readOnly:!0})],i$c.prototype,"version",null),e$f([d$h({type:Boolean})],i$c.prototype,"visible",void 0),i$c=e$f([i$j("esri.views.Magnifier")],i$c);const p$d=i$c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class s$f{constructor(s,u){this._stage=s,this._textureRequests=new Map,this._frameTask=r$g(u)?u.registerTask(f$h.TEXTURE_UNLOAD):D$6;}destroy(){this._frameTask.remove(),this._textureRequests.forEach((e=>this._releaseTextureRequest(e))),this._textureRequests.clear();}fromData(e,t){const r=this.makeUid(e);let s=this._textureRequests.get(r);return s||(s={referenceCount:0,texture:t(),textureAsync:null,abortController:null},this._stage&&(this._stage.add(s.texture),this._stage.loadSynchronous(s.texture)),this._textureRequests.set(r,s)),s.referenceCount++,{uid:r,texture:s.texture,release:()=>this._release(r)}}_release(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);t?(t.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),t.referenceCount--,t.referenceCount<1&&this._frameTask.schedule((()=>this._releaseNow(e)))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`);}get test(){return {textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e));}_releaseTextureRequest(e){var t;e.texture?null==(t=this._stage)||t.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null);}makeUid(t,r=null){return r$g(r)?`${t}.${r}px`:t}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const r$9=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],i$b={};function o$a(t){return !!i$b[t]}function s$e(t){for(const e of t)if(!o$a(e))return !1;return !0}r$9.forEach((t=>{i$b[t]=!0;}));class p$c{constructor(t){this.handlers=new Map,this.counter=0,this.handlerCounts=new Map,this.view=t,this.inputManager=null;}connect(t){t&&this.disconnect(),this.inputManager=t,this.handlers.forEach((({handler:t,priority:e},a)=>this.inputManager.installHandlers(a,[t],e)));}disconnect(){this.inputManager&&this.handlers.forEach(((t,e)=>this.inputManager.uninstallHandlers(e))),this.inputManager=null;}destroy(){this.disconnect(),this.handlers.clear(),this.view=null;}on(t,e,a,r){const i=Array.isArray(t)?t:t.split(",");if(!s$e(i))return i.some(o$a)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let p,l;Array.isArray(e)?l=e:(p=e,l=[]),"function"==typeof a?p=a:r=a,r=null!=r?r:u$d.DEFAULT;const u=this.createUniqueGroupName(),m=new c$g(this.view,i,l,p);this.handlers.set(u,{handler:m,priority:r});for(const n of i){const t=this.handlerCounts.get(n)||0;this.handlerCounts.set(n,t+1);}return this.inputManager&&this.inputManager.installHandlers(u,[m],r),{remove:()=>this.removeHandler(u,i)}}hasHandler(t){return !!this.handlerCounts.get(t)}removeHandler(t,e){if(this.handlers.has(t)){this.handlers.delete(t);for(const t of e){const e=this.handlerCounts.get(t);void 0===e?console.error("Trying to remove handler for event that has no handlers registered: ",t):1===e?this.handlerCounts.delete(t):this.handlerCounts.set(t,e-1);}}this.inputManager&&this.inputManager.uninstallHandlers(t);}createUniqueGroupName(){return this.counter+=1,`viewEvents_${this.counter}`}}class c$g extends i$e{constructor(t,e,a,n){super(!0),this.view=t;for(const r of e)switch(r){case"click":this.registerIncoming("click",a,(t=>n(this.wrapClick(t))));break;case"double-click":this.registerIncoming("double-click",a,(t=>n(this.wrapDoubleClick(t))));break;case"immediate-click":this.registerIncoming("immediate-click",a,(t=>n(this.wrapImmediateClick(t))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",a,(t=>n(this.wrapImmediateDoubleClick(t))));break;case"hold":this.registerIncoming("hold",a,(t=>n(this.wrapHold(t))));break;case"drag":this.registerIncoming("drag",a,(t=>{const e=this.wrapDrag(t);e&&n(e);}));break;case"key-down":this.registerIncoming("key-down",a,(t=>n(this.wrapKeyDown(t))));break;case"key-up":this.registerIncoming("key-up",a,(t=>n(this.wrapKeyUp(t))));break;case"pointer-down":this.registerIncoming("pointer-down",a,(t=>n(this.wrapPointer(t,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",a,(t=>n(this.wrapPointer(t,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",a,(t=>n(this.wrapPointer(t,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",a,(t=>n(this.wrapPointerDrag(t))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",a,(t=>n(this.wrapMouseWheel(t))));break;case"pointer-enter":this.registerIncoming("pointer-enter",a,(t=>n(this.wrapPointer(t,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",a,(t=>n(this.wrapPointer(t,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",a,(t=>{n(this.wrapGamepad(t));}));break;case"focus":this.registerIncoming("focus",a,(t=>{n(this.wrapFocus(t));}));break;case"blur":this.registerIncoming("blur",a,(t=>{n(this.wrapBlur(t));}));}}wrapFocus(t){return {type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapBlur(t){return {type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapClick(t){const{pointerType:a,button:n,buttons:r,x:i,y:o,native:s,eventId:p}=t.data,{cancelable:c,timestamp:l}=t;return {type:"click",pointerType:a,button:n,buttons:r,x:i,y:o,native:s,timestamp:l,screenPoint:c$D(i,o),mapPoint:this.getMapPoint(i,o),eventId:p,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapDoubleClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,{cancelable:p,timestamp:c}=t;return {type:"double-click",pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:c,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:p,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,p=o.pointerId,{cancelable:c,timestamp:l}=t;return {type:"immediate-click",pointerId:p,pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:l,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateDoubleClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,p=o.pointerId,{cancelable:c,timestamp:l}=t;return {type:"immediate-double-click",pointerId:p,pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:l,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapHold(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o}=t.data,{cancelable:s,timestamp:p}=t;return {type:"hold",pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:p,mapPoint:this.getMapPoint(r,i),cancelable:s,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}getMapPoint(t,a){return this.view.toMap(c$D(t,a),{exclude:[]})}wrapDrag(e){const a=e.data,{x:n,y:r}=a.center,{action:i,pointerType:o,button:s}=a;if("start"===i&&(this.latestDragStart=a),!this.latestDragStart)return;const p=a.pointer.native,c=a.buttons,{cancelable:l,timestamp:u}=e,m={x:this.latestDragStart.center.x,y:this.latestDragStart.center.y};return "end"===i&&(this.latestDragStart=void 0),{type:"drag",action:i,x:n,y:r,origin:m,pointerType:o,button:s,buttons:c,radius:a.radius,angle:m$n(a.angle),native:p,timestamp:u,cancelable:l,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}wrapKeyDown(t){const{key:e,repeat:a,native:n}=t.data,{cancelable:r,timestamp:i}=t;return {type:"key-down",key:e,repeat:a,native:n,timestamp:i,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapKeyUp(t){const{key:e,native:a}=t.data,{cancelable:n,timestamp:r}=t;return {type:"key-up",key:e,native:a,timestamp:r,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointer(t,e){const{x:a,y:n,button:r,buttons:i,native:o,eventId:s}=t.data,p=o.pointerId,c=o.pointerType,{cancelable:l,timestamp:u}=t;return {type:e,x:a,y:n,pointerId:p,pointerType:c,button:r,buttons:i,native:o,timestamp:u,eventId:s,cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointerDrag(t){const{x:e,y:a,buttons:n,native:r,eventId:i}=t.data.currentEvent,{button:o}=t.data.startEvent,s=t.data.startEvent.native.pointerId,p=t.data.startEvent.native.pointerType,c=t.data.action,l={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:u,timestamp:m}=t;return {type:"pointer-drag",x:e,y:a,pointerId:s,pointerType:p,button:o,buttons:n,action:c,origin:l,native:r,timestamp:m,eventId:i,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapMouseWheel(t){const{cancelable:e,data:a,timestamp:n}=t,{x:r,y:i,deltaY:o,native:s}=a;return {type:"mouse-wheel",x:r,y:i,deltaY:o,native:s,timestamp:n,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapGamepad(t){const{action:e,state:a,device:n}=t.data,{cancelable:r,timestamp:i}=t,{buttons:o,axes:s}=a;return {type:"gamepad",device:n,timestamp:i,action:e,buttons:o,axes:s,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function e$8(t){return [t.on("after-add",(t=>{const e=t.item;e.view&&e.view.ready&&!e.attached&&e.attach();})),t.on("after-remove",(t=>{const e=t.item;e.active&&(e.view.activeTool=null),e.attached&&e.detach();}))]}function a$l(t){return t.visible&&t.getEditableFlag(0)&&t.getEditableFlag(1)}function i$a(e){return t$j(e)?{}:"function"==typeof e?e():e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function t$b(t){return c$D(t.x,t.y)}function n$g(t,n){const c=(t instanceof HTMLElement?t:t.surface).getBoundingClientRect();return c$D(n.clientX-c.left,n.clientY-c.top)}function c$f(e,c){return c instanceof Event?n$g(e,c):t$b(c)}function i$9(e){if(e instanceof Event)return !0;if("object"==typeof e&&"type"in e){switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return !0;default:return !1}}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class p$b{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._currentlyActiveTool=null,this._revertToActiveTool=!1,this._cursor=null;}get cursor(){return this._cursor}handleInputEvent(t,a){const s=()=>t.stopPropagation();switch(t.type){case"pointer-move":c$e(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(s(),"end"===t.action&&(this._stopDrag=!1));break;case"pointer-down":{if(!u$8(t))break;const e=t$b(t),n=this._intersect(e,t.pointerType,a.forEachTool);if(t$j(n))break;const p=this._findToolAndManipulatorByKey(n,a.forEachTool,h$8),c=o$k(p,(t=>t.manipulator)),d=o$k(p,(t=>t.tool));!(r$g(c)&&r$g(d)&&c.interactive)||c.grabbable&&c.grabbableForEvent(t)||!c.grabbing||c.dragging||this._ungrabManipulatorBeforeDragging(c,d,t),r$g(c)&&c.interactive&&c.grabbable&&c.grabbableForEvent(t)&&!c.grabbing&&(this._grabbedManipulators.set(t.pointerId,{key:n,start:e,pointerType:t.pointerType}),1===this._grabbedManipulators.size&&a.activeTool!==n.tool&&(this._currentlyActiveTool=a.activeTool,this._revertToActiveTool=!0,a.setActiveTool(n.tool)),c.grabbing=!0,c.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:e}),s());break}case"pointer-up":this._handlePointerEnd(t,a);break;case"pointer-drag":{if(!u$8(t))break;const o=this._grabbedManipulators.get(t.pointerId),p=this._draggedManipulators.get(t.pointerId),c=o$k(o||p,(({key:t})=>t)),d=this._findManipulatorByKey(c,a.forEachTool);if(t$j(d))break;const h=t$b(t);h.x=e$g(h.x,0,a.view.width),h.y=e$g(h.y,0,a.view.height);const g=e$l(o||p).start;switch(t.action){case"start":case"update":"update"!==t.action&&1!==this._grabbedManipulators.size||(d.dragging=!0,p?d.events.emit("drag",{action:"update",start:g,screenPoint:h}):d.events.emit("drag",{action:"start",start:g,screenPoint:h,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{key:e$l(c),start:g}));break;case"end":d.dragging=!1,p&&d.events.emit("drag",{action:"end",start:g,screenPoint:h}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,a);}s();break}case"immediate-click":{const e=t$b(t),r=this._intersect(e,t.pointerType,a.forEachTool),n=this._findToolAndManipulatorByKey(r,a.forEachTool,h$8);if(d$7(t)||a.forEachTool((t=>{if((!r$g(n)||n.tool!==t||t.automaticManipulatorSelection)&&t.manipulators){let e=!1;t.manipulators.forEach((({manipulator:t})=>{t.selected&&(t.selected=!1,e=!0);})),e&&t.manipulatorSelectionChanged&&t.manipulatorSelectionChanged();}})),t$j(n))break;const{manipulator:p,tool:c}=n;if(!p.interactive)break;p.selectable&&c.automaticManipulatorSelection&&(p.selected=!p.selected,c.manipulatorSelectionChanged&&c.manipulatorSelectionChanged());const u=t.native.shiftKey;p.events.emit("immediate-click",{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:u,stopPropagation:s});break}case"click":{const e=t$b(t),o=this._intersect(e,t.pointerType,a.forEachTool),r=this._findManipulatorByKey(o,a.forEachTool);if(t$j(r)||!r.interactive)break;const n=t.native.shiftKey;r.events.emit(t.type,{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:n}),s();break}case"double-click":{const e=t$b(t),o=this._intersect(e,t.pointerType,a.forEachTool),r=this._findManipulatorByKey(o,a.forEachTool);if(t$j(r)||!r.interactive)break;const n=t.native.shiftKey;r.events.emit("double-click",{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:n,stopPropagation:s});break}case"immediate-double-click":{const e=t$b(t),o=this._intersect(e,t.pointerType,a.forEachTool),r=this._findManipulatorByKey(o,a.forEachTool);if(t$j(r)||!r.interactive)break;const n=t.native.shiftKey;r.events.emit("immediate-double-click",{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:n,stopPropagation:s});break}}this._updateCursor(a.forEachTool);}_ungrabManipulatorBeforeDragging(t,e,i){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:t$b(i)}),this._grabbedManipulators.forEach((({key:i},o)=>{i.tool===e&&e.manipulators.findById(i.manipulatorId)===t&&this._grabbedManipulators.delete(o);}));}_handlePointerEnd(t,e){const i=o$k(this._grabbedManipulators.get(t.pointerId),(({key:t})=>t)),n=this._findManipulatorByKey(i,e.forEachTool);r$g(n)&&!n.dragging&&(1===this._grabbedManipulators.size&&0===this._draggedManipulators.size&&this._revertToActiveTool&&(e.setActiveTool(this._currentlyActiveTool),this._revertToActiveTool=!1,this._currentlyActiveTool=null),n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:t$b(t)})),this._grabbedManipulators.delete(t.pointerId));}_cursorFromMap(e,i){let r=null;return n$w(e,(({key:t})=>{const e=this._findManipulatorByKey(t,i);return !!(r$g(e)&&e.interactive&&"cursor"in e&&e.cursor)&&(r=e.cursor,!0)})),r}_updateCursor(t){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators,t)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators,t)||"pointer":this._cursor=null;}clearPointers(t,e,r=!0,n){const a=e=>e.tool===t&&(t$j(n)||e.manipulatorId===n);this._grabbedManipulators.forEach((({key:t,pointerType:i},r)=>{if(a(t)){this._grabbedManipulators.delete(r);const n=this._findManipulatorByKey(t,e);r$g(n)&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:i}));}})),this._draggedManipulators.forEach((({key:t},i)=>{if(a(t)){this._draggedManipulators.delete(i);const r=this._findManipulatorByKey(t,e);r$g(r)&&(r.dragging=!1,r.events.emit("drag",{action:"cancel"}));}})),r&&this._hoveredManipulators.forEach((({key:t},i)=>{if(a(t)){this._hoveredManipulators.delete(i);const r=this._findManipulatorByKey(t,e);r$g(r)&&(r.hovering=!1);}})),this._updateCursor(e);}_intersect(t,e,o){let r=null;return o((o=>{if(null==o.manipulators||!a$l(o))return !1;const n=o.manipulators.intersect(t,e);return !t$j(n)&&(r={manipulatorId:n.id,tool:o},!0)})),r}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach(((e,i)=>{this._updateHoveredStateForPointerAtScreenPosition(c$D(e.x,e.y),i,e.pointerType,t);}));}handleHoverEvent(t,e){"pointer-up"!==t.type&&"immediate-click"!==t.type&&"pointer-move"!==t.type||!c$e(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(t$b(t),t.pointerId,t.pointerType,e);}_updateHoveredStateForPointerAtScreenPosition(t,e,i,a){const s=this._intersect(t,i,a);let l=this._findManipulatorByKey(s,a);const p=o$k(this._hoveredManipulators.get(e),(({key:t})=>t)),c=this._findManipulatorByKey(p,a);r$g(l)&&!l.interactive&&(l=null),c!==l&&(r$g(c)&&(c.hovering=!1),r$g(l)?(l.hovering=!0,this._hoveredManipulators.set(e,{key:e$l(s)})):this._hoveredManipulators.delete(e),this._updateCursor(a));}_findManipulatorByKey(t,e){return this._findToolAndManipulatorByKey(t,e,h$8)?h$8.manipulator:null}_findToolAndManipulatorByKey(t,e,r){return t$j(t)?null:(r.tool=null,r.manipulator=null,e((e=>{if(e!==t.tool||null==e.manipulators||!a$l(e))return !1;const i=e.manipulators.findById(t.manipulatorId);return !!r$g(i)&&(r.manipulator=i,r.tool=e,!0)})),r.manipulator?r:null)}}function c$e(t){return "mouse"===t}function u$8(t){return "mouse"!==t.pointerType||0===t.button}function d$7(t){return !!t.native.shiftKey}const h$8={manipulator:null,tool:null};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const f$3=s$k.getLogger("esri.views.ToolViewManager"),T$1="manipulators",_$3="tools";let E$2=class extends d$i{constructor(t){super(t),this._manipulatorState=new p$b,this.tools=new S$8,this.cursor=null,this._forEachTool=t=>{for(const o of this.tools.items)if(t(o))return};}initialize(){this.handles.add([this.view.on(r$9,(t=>{this._handleInputEvent(t);}),u$d.TOOL),...e$8(this.tools),this.tools.on("before-add",(t=>{const o=t.item;if(null==o||this.tools.includes(o))return f$3.warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault()})),this.tools.on("before-remove",(({item:t})=>{this._manipulatorState.clearPointers(t,this._forEachTool);})),this.tools.on("change",(()=>{this._refreshToolWatchers();}))]);}destroy(){this._forEachTool((t=>t.destroy()));}set activeTool(t){if(r$g(t)&&!this.view.ready)return void f$3.error("Cannot set active tool while view is not ready.");if(t===this.activeTool)return void(r$g(t)&&f$3.warn("Tool is already active - ignoring activation request."));r$g(this.activeTool)&&this.activeTool.deactivate(),r$g(t)&&t.activate(),this._set("activeTool",t),this._removeIncompleteTools(t);const o=t$j(this.activeTool);for(const e of this.tools){e.setEditableFlag(1,o||e===this.activeTool);const t=a$l(e);!o&&t||this._manipulatorState.clearPointers(e,this._forEachTool,!t);}this._updateCursor();}get updating(){return this.updatingHandles.updating||this.tools.some((t=>t.updating))}attach(){this._forEachTool((t=>t.attach())),"3d"===this.view.type?(this._set("textures",new s$f(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([this.view.state.watch("camera",(()=>{this._forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange();}));})),this.view.elevationProvider.on("elevation-change",(t=>{this._forEachManipulator((o=>{null!=o.onElevationChange&&o.onElevationChange(t);}));}))],T$1)):this.handles.add(this.view.watch("extent",(()=>{this._forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange();}));})));}detach(){r$g(this.activeTool)&&(this.activeTool=null),this._forEachTool((t=>{t.detach(),t.destroy();})),this.tools.removeAll(),this.handles.remove(T$1);}_forEachManipulator(t){this._forEachTool((o=>{o.manipulators&&o.manipulators.forEach((({manipulator:e})=>t(e,o)));}));}_handleInputEvent(t){let o=!1;const e={...t,stopPropagation:()=>{o=!0,t.stopPropagation();}};r$g(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(e):this._forEachTool((t=>{!o&&t.attached&&t.visible&&t.handleInputEvent(e);})),!o&&"key-down"===t.type&&"Escape"===t.key&&this.activeTool&&(t.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(e,{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t;},view:this.view}),!o&&r$g(this.activeTool)&&this.activeTool.handleInputEventAfter(e),this._manipulatorState.handleHoverEvent(e,this._forEachTool),this._updateCursor();}_refreshToolWatchers(){this.handles.remove(_$3),this._forEachTool((t=>{if(t instanceof p$u){const o=f$e(t,["cursor","visible","editable"],(()=>{a$l(t)||this._manipulatorState.clearPointers(t,this._forEachTool),this._updateCursor();}));this.handles.add(o,_$3);}t.manipulators&&this.handles.add(t.manipulators.on("change",(o=>{o.removed.forEach((({id:o})=>{this._manipulatorState.clearPointers(t,this._forEachTool,!0,o);})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor();})),_$3);})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor();}_updateCursor(){let t=this._manipulatorState.cursor;this._forEachTool((o=>!(!r$g(o.cursor)||!o.visible)&&(t=o.cursor,!0))),this._get("cursor")!==t&&this._set("cursor",t);}_removeIncompleteTools(t){this.tools.filter((o=>(t$j(t)||o!==t)&&!o.completed)).forEach((t=>{this.tools.remove(t),t.destroy();}));}};e$f([d$h({constructOnly:!0,nonNullable:!0})],E$2.prototype,"view",void 0),e$f([d$h({readOnly:!0,nonNullable:!0})],E$2.prototype,"textures",void 0),e$f([d$h({value:null})],E$2.prototype,"activeTool",null),e$f([d$h({readOnly:!0,type:S$8})],E$2.prototype,"tools",void 0),e$f([d$h({readOnly:!0})],E$2.prototype,"cursor",void 0),e$f([d$h({readOnly:!0})],E$2.prototype,"updating",null),E$2=e$f([i$j("esri.views.ToolViewManager")],E$2);const w=E$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let o$9=class extends p$u{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown","standard"===e.mapping?this._detectedDeviceType="standard":n$f.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index;}get native(){return (navigator.getGamepads?navigator.getGamepads():[])[this.nativeIndex]}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return a$k[this.deviceType]}};e$f([d$h({nonNullable:!0,readOnly:!0})],o$9.prototype,"nativeIndex",void 0),e$f([d$h({type:String,readOnly:!0})],o$9.prototype,"deviceType",null),e$f([d$h({type:Number,readOnly:!0})],o$9.prototype,"axisThreshold",null),o$9=e$f([i$j("esri.views.input.gamepad.GamepadInputDevice")],o$9);const n$f=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),a$k={standard:.15,spacemouse:.025,unknown:0},i$8=o$9;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let c$d=class extends p$u{constructor(...e){super(...e),this.devices=new S$8,this.enabledFocusMode="document";}};e$f([d$h({type:S$8.ofType(i$8),readOnly:!0})],c$d.prototype,"devices",void 0),e$f([d$h({type:["document","view","none"]})],c$d.prototype,"enabledFocusMode",void 0),c$d=e$f([i$j("esri.views.input.gamepad.GamepadSettings")],c$d);const i$7=c$d;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let p$a=class extends p$u{constructor(){super(...arguments),this.gamepad=new i$7;}};e$f([d$h({readOnly:!0})],p$a.prototype,"gamepad",void 0),p$a=e$f([i$j("esri.views.input.Input")],p$a);const a$j=p$a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let s$d=class extends p$u{constructor(o){super(o),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1;}};e$f([d$h({type:Boolean,nonNullable:!0})],s$d.prototype,"enabled",void 0),e$f([d$h({type:i$8})],s$d.prototype,"device",void 0),e$f([d$h({type:["pan","zoom"],nonNullable:!0})],s$d.prototype,"mode",void 0),e$f([d$h({type:["forward-down","forward-up"],nonNullable:!0})],s$d.prototype,"tiltDirection",void 0),e$f([d$h({type:Number,nonNullable:!0})],s$d.prototype,"velocityFactor",void 0),s$d=e$f([i$j("esri.views.navigation.gamepad.GamepadSettings")],s$d);const a$i=s$d;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let a$h=class extends p$u{constructor(o){super(o),this.browserTouchPanEnabled=!0,this.gamepad=new a$i,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0;}};e$f([d$h({type:Boolean})],a$h.prototype,"browserTouchPanEnabled",void 0),e$f([d$h({type:a$i,nonNullable:!0})],a$h.prototype,"gamepad",void 0),e$f([d$h({type:Boolean})],a$h.prototype,"momentumEnabled",void 0),e$f([d$h({type:Boolean})],a$h.prototype,"mouseWheelZoomEnabled",void 0),a$h=e$f([i$j("esri.views.navigation.Navigation")],a$h);const p$9=a$h;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function r$8(t,i){if(!t)return null;if(!o$8(t))return new s$l("webscene:unsupported-height-model-info","The vertical coordinate system of the scene is not supported",{heightModelInfo:t});const r=t.heightUnit,a=v$8.deriveUnitFromSR(t,i).heightUnit;return r!==a?new s$l("webscene:incompatible-height-unit",`The vertical units of the scene (${r}) must match the horizontal units of the scene (${a})`,{verticalUnit:r,horizontalUnit:a}):null}function a$g(t,i,r){const a=l$8(t),o=i,h=s$c(a,o,r);{let i=null;if(a){const s=v$8.deriveUnitFromSR(a,t.spatialReference).heightUnit;r||s===a.heightUnit||(i=new s$l("layerview:unmatched-height-unit",`The vertical units of the layer must match the horizontal units (${s})`,{horizontalUnit:s}));}if(!c$c(t)||4===h||i)return new s$l("layerview:unsupported-height-model-info","The vertical coordinate system of the layer is not supported",{heightModelInfo:a,error:i})}{let t=null;switch(h){case 1:{const n=a.heightUnit||"unknown",i=o.heightUnit||"unknown";t=new s$l("layerview:incompatible-height-unit",`The vertical units of the layer (${n}) must match the vertical units of the scene (${i})`,{layerUnit:n,sceneUnit:i});break}case 2:{const n=a.heightModel||"unknown",i=o.heightModel||"unknown";t=new s$l("layerview:incompatible-height-model",`The height model of the layer (${n}) must match the height model of the scene (${i})`,{layerHeightModel:n,sceneHeightModel:i});break}case 3:{const n=a.vertCRS||"unknown",i=o.vertCRS||"unknown";t=new s$l("layerview:incompatible-vertical-datum",`The vertical datum of the layer (${n}) must match the vertical datum of the scene (${i})`,{layerDatum:n,sceneDatum:i});break}}if(t)return new s$l("layerview:incompatible-height-model-info","The vertical coordinate system of the layer is incompatible with the scene",{layerHeightModelInfo:a,sceneHeightModelInfo:o,error:t})}return null}function s$c(e,t,n){if(!o$8(e)||!o$8(t))return 4;if(null==e||null==t)return 0;if(!n&&e.heightUnit!==t.heightUnit)return 1;if(e.heightModel!==t.heightModel)return 2;switch(e.heightModel){case"gravity-related-height":return 0;case"ellipsoidal":return e.vertCRS===t.vertCRS?0:3;default:return 4}}function o$8(e){return null==e||null!=e.heightModel&&null!=e.heightUnit}function c$c(e){return "heightModelInfo"in e&&null!=e.heightModelInfo||null!=e.spatialReference||!f$2(e)}function l$8(e){const r=e.url&&d$m(e.url);return !(null==(e.spatialReference&&e.spatialReference.vcsWkid)&&r$g(r)&&"ImageServer"===r.serverType)&&h$7(e)&&e.heightModelInfo?e.heightModelInfo:f$2(e)?v$8.deriveUnitFromSR(d$6,e.spatialReference):null}function h$7(e){return "heightModelInfo"in e}function u$7(e){if("unknown"===e.type||!("capabilities"in e))return !1;switch(e.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"wfs":return !0;default:return !1}}function f$2(e){return u$7(e)?!!(e.capabilities&&e.capabilities.data&&e.capabilities.data.supportsZ):m$9(e)}function g$5(e){return null!=e.layers||m$9(e)||u$7(e)||h$7(e)}function m$9(e){switch(e.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return !0;case"analysis":case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"map-image":case"map-notes":case"ogc-feature":case"open-street-map":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return !1}return !1}const d$6=new v$8({heightModel:"gravity-related-height"});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var _$2;const m$8=s$k.getLogger("esri.views.support.DefaultsFromMap"),S$1=10;let y$3=_$2=class extends p$u{constructor(){super(...arguments),this._handles=new u$j,this._waitTask=null,this._extentProjectController=null,this._spatialReferenceCandidates=null,this._extentCandidates=null,this.logDebugInformation=!1,this.isSpatialReferenceDone=!1,this.isTileInfoDone=!1,this.isHeightModelInfoSearching=!1,this.spatialReference=null,this.extent=null,this.heightModelInfo=null,this.vcsWkid=null,this.latestVcsWkid=null,this.mapCollectionPaths=_$2.DefaultMapCollectionPaths.slice(),this.tileInfo=null;}initialize(){this.watch("mapCollectionPaths",(()=>{this._running&&(this.reset(),this.start());}));}destroy(){this._set("view",null),this._handles=l$n(this._handles),this._cancelLoading();}get _running(){return !!(this._handles&&this._handles.size>0)}reset(){this._handles.removeAll(),this._set("isSpatialReferenceDone",!1),this._set("isTileInfoDone",!1),this._set("isHeightModelInfoSearching",!1),this._set("spatialReference",null),this._set("extent",null),this._set("heightModelInfo",null),this._set("vcsWkid",null),this._set("latestVcsWkid",null),this._set("tileInfo",null),this._spatialReferenceCandidates=null,this._extentCandidates=null;}start(){this._handles.removeAll();const e=this._updateLayerChange.bind(this);for(const t of this.mapCollectionPaths)this._handles.add($$4(this.view,`map.${t}`,"change",e,e,e,!0));this._handles.add(s$s(this,"isSpatialReferenceDone",(()=>this._updateTileInfo()),!0));}_ownerNameFromCollectionName(e){const t=e.lastIndexOf(".");return -1===t?"view":"view."+e.slice(0,t)}_ensureLoadedOwnersFromCollectionName(e){const t=this._ownerNameFromCollectionName(e).split(".");let i;for(let s=0;s<t.length&&(i=this.get(t.slice(0,s+1).join(".")),i);s++)if(i.load&&!i.isFulfilled())return {collectionName:e,owner:null,loading:i.load().catch((()=>{}))};return {collectionName:e,owner:i}}_cancelLoading(){this._waitTask=null,this._extentProjectController&&(this._extentProjectController.abort(),this._extentProjectController=null);}_updateWhen(e){let t=!0,i=!1;const s=e.catch((()=>{})).then((()=>{t?i=!0:s===this._waitTask&&this._update();}));return t=!1,i||(this._waitTask=s),i}_updateLayerChange(){this.isSpatialReferenceDone&&!this.spatialReference&&this._set("isSpatialReferenceDone",!1),this._update();}_update(){if(this._cancelLoading(),this.view){if(!this.isSpatialReferenceDone){this._debugLog("Starting search for spatial reference...");const e=this._processMapCollections((e=>this._processSpatialReferenceSource(e)));if(this._debugLog(`Search ended with status '${b$1(e)}'`),0!==e){let e=null,t=this._spatialReferenceCandidates;if(!t||t.length<1?(e=this.defaultSpatialReference,this._debugLog(`No spatial reference found, locking to default (${I(e)})`)):(this.defaultSpatialReference&&t.length>1&&t.findIndex((e=>e.equals(this.defaultSpatialReference)))>-1&&(t=[this.defaultSpatialReference]),e=t[0],this._debugLog(`Locking to ${I(e)}`)),this._set("spatialReference",e),e)if(this.extent)this._set("isSpatialReferenceDone",!0);else {const t=this.logDebugInformation;this.logDebugInformation=!1,this._processMapCollections((t=>this._findExtent(t,e))),this.logDebugInformation=t,this._projectExtentCandidate().catch((()=>{})).then((()=>this._set("isSpatialReferenceDone",!0)));}else this._set("isSpatialReferenceDone",!0);}}if(null==this.heightModelInfo&&this.view.isHeightModelInfoRequired){this._debugLog("Starting search for height model info...");const e=this._processMapCollections((e=>this._processHeightModelInfoSource(e)),(e=>g$5(e)));this._debugLog(`Search ended with status ${b$1(e)}`),this._set("isHeightModelInfoSearching",0===e);}this._updateTileInfo();}}_processMapCollections(e,t){this._preloadMapCollections(t);let i=2;return this._forAllMapCollectionSources((e=>{if(2!==i)return !1;const{collectionName:t}=e;return this._debugLog(`Processing collection ${t}...`),!(e.loading&&!this._updateWhen(e.loading))||(this._debugLog(`Collection ${e.collectionName} owner is loading -> wait`),i=0,!1)}),(s=>{if(2!==i)return !1;return null!=t&&!t(s)?(this._debugLog(`Source ${s.id} is skipped due to predicate`),!1):!s.load||s.isFulfilled()||this._updateWhen(s.load())?!((!s.load||s.isResolved())&&e(s))||(i=1,!1):(this._debugLog(`Source ${s.id} is loading -> wait`),i=0,!1)})),i}_preloadMapCollections(e){let t=S$1;const i=this.logDebugInformation;this.logDebugInformation=!1,this._forAllMapCollectionSources((()=>!0),(s=>{if(0===t)return !1;return !(null!=e&&!e(s))&&(s.load&&!s.isFulfilled()&&(this.logDebugInformation=i,this._debugLog(`Pre-loading source ${s.id}`),this.logDebugInformation=!1,s.load().catch((()=>{})),t--),!0)})),this.logDebugInformation=i;}_forAllMapCollectionSources(e,t){for(const i of this.mapCollectionPaths){const s=`map.${i}`,o=this._ensureLoadedOwnersFromCollectionName(s);if(!1===e(o))continue;const n=o.owner;if(!n||n.isRejected&&n.isRejected()){this._debugLog(`Collection ${s} owner is invalid or rejected -> skip`);continue}const a=this.view.get(s);a?this._forEachSource(a,t):this._debugLog(`Collection ${s} does not exist -> skip`);}}_forEachSource(e,t){for(const i of e.items)!1!==t(i)&&"layers"in i&&i.layers&&this._forEachSource(i.layers,t);}_processSpatialReferenceSource(e){let t=this._getSupportedSpatialReferences(e);return 0!==t.length&&(this._spatialReferenceCandidates?(t=s$t(t,this._spatialReferenceCandidates,((e,t)=>e.equals(t))),t.length>0?this._spatialReferenceCandidates=t:this._debugLog(`Layer ${e.id} is ignored because its supported spatial\n          references are not compatible with the previous candidates`)):this._spatialReferenceCandidates=t,1===this._spatialReferenceCandidates.length)}_findExtent(e,t){const i="fullExtents"in e&&e.fullExtents||(r$g(e.fullExtent)?[e.fullExtent]:[]),s=i.find((e=>e.spatialReference.equals(t)));if(s)return this._set("extent",s),!0;if(this._getSupportedSpatialReferences(e).length>0){const t=i.map((t=>({extent:t,layer:e}))),s=this._extentCandidates||[];this._extentCandidates=s.concat(t);}return !1}async _projectExtentCandidate(){if(!this._extentCandidates||!this._extentCandidates.length)return;const e=this.spatialReference,t=this._extentCandidates.find((t=>g$h(t.extent.spatialReference,e)));if(r$g(t))this._set("extent",e$l(M$5(t.extent,e)));else {const t=this._extentCandidates[0];this._extentProjectController=new AbortController;const i=await import('./geometryServiceUtils-d83b6ded.js');try{const s=await i.projectGeometry(t.extent,e,t.layer.portalItem,this._extentProjectController.signal);this._set("extent",s);}catch{}this._extentProjectController=null;}}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(0===t.length)return this._debugLog(`Layer ${e.id} is ignored because it does not have any spatial references`),[];const i=t.filter((t=>this.view.isSpatialReferenceSupported(t,e,(e=>this._debugLog(e)))));return 0===i.length?this._debugLog(`Layer ${e.id} has spatial references but none of them are supported (or layer doesn't require locking)`):this._debugLog(`Layer ${e.id} has spatial references. Resulting candidate set: ${i.map(I).join(", ")}`),i}_processHeightModelInfoSource(e){const t=l$8(e);return !!t&&(this._set("heightModelInfo",t),this._set("isHeightModelInfoSearching",!1),e.spatialReference&&(this._set("vcsWkid",e.spatialReference.vcsWkid),this._set("latestVcsWkid",e.spatialReference.latestVcsWkid)),!0)}_updateTileInfo(){if(null!=this.tileInfo)return;if(!this.view.isTileInfoRequired())return void this._set("isTileInfoDone",!0);if(!this.isSpatialReferenceDone)return;const e=this.get("view.map");if(!e)return void this._debugLog("updateTileInfo: no map");const t=e.basemap,i=e.get("layers.0");let s=null;if(t&&"failed"!==t.loadStatus){if(!t.loaded)return this._updateWhen(t.load()),void this._debugLog("updateTileInfo: basemap still loading");const e=t&&t.get("baseLayers.0");if(e&&"failed"!==e.loadStatus){if(!e.loaded)return this._updateWhen(e.load()),void this._debugLog("updateTileInfo: first basemap layer still loading");s="tileInfo"in e&&e.tileInfo;}else {if(!i||"failed"===i.loadStatus)return this._debugLog("updateTileInfo: no tileInfo"),void this._set("isTileInfoDone",!0);if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo;}}else if(i&&"failed"!==i.loadStatus){if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo;}s&&!s.spatialReference.equals(this.spatialReference)&&(s=null),this._debugLog(`updateTileInfo: setting ${s}`),this._set("tileInfo",s),this._set("isTileInfoDone",!0);}_debugLog(e){this.logDebugInformation&&m$8.info(e);}};function I(e){return e?JSON.stringify(e.toJSON()):"undefined"}function b$1(e){switch(e){case 0:return "Waiting";case 1:return "Found";case 2:return "Exhausted"}}y$3.DefaultMapCollectionPaths=["basemap.baseLayers","layers","ground.layers","basemap.referenceLayers"],e$f([d$h()],y$3.prototype,"logDebugInformation",void 0),e$f([d$h({readOnly:!0})],y$3.prototype,"isSpatialReferenceDone",void 0),e$f([d$h({readOnly:!0})],y$3.prototype,"isTileInfoDone",void 0),e$f([d$h({readOnly:!0})],y$3.prototype,"isHeightModelInfoSearching",void 0),e$f([d$h({constructOnly:!0})],y$3.prototype,"view",void 0),e$f([d$h({readOnly:!0})],y$3.prototype,"spatialReference",void 0),e$f([d$h({readOnly:!0})],y$3.prototype,"extent",void 0),e$f([d$h({readOnly:!0})],y$3.prototype,"heightModelInfo",void 0),e$f([d$h({readOnly:!0})],y$3.prototype,"vcsWkid",void 0),e$f([d$h({readOnly:!0})],y$3.prototype,"latestVcsWkid",void 0),e$f([d$h()],y$3.prototype,"mapCollectionPaths",void 0),e$f([d$h()],y$3.prototype,"defaultSpatialReference",void 0),e$f([d$h({readOnly:!0})],y$3.prototype,"tileInfo",void 0),y$3=_$2=e$f([i$j("esri.views.support.DefaultsFromMap")],y$3);const R$1=y$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var z;const H$1=s$k.getLogger("esri.views.View");let W$2=z=class extends(a$z(n$u.EventedMixin(n$x(p$u)))){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new p$v({getCollections:()=>{var e,t,i;return [null==(e=this.basemapView)?void 0:e.baseLayerViews,null==(t=this.groundView)?void 0:t.layerViews,this.layerViews,null==(i=this.basemapView)?void 0:i.referenceLayerViews]},getChildrenFunction:e=>e.layerViews}),this.groundView=null,this.animation=null,this.basemapView=null,this.defaultsFromMap=new R$1({view:this}),this.fatalError=null,this.extent=null,this.graphics=new c$E,this.navigating=!1,this.layerViews=new S$8,this.magnifier=new p$d,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new a$j,this.navigation=new p$9,this.layerViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new p$c(this),this.persistableViewModels=new S$8,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(this.watch("preconditionsReady",(e=>{e?(this._currentSpatialReference=this.spatialReference,z.views.add(this)):(this._currentSpatialReference=null,z.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?(this.layerViewManager.clear(),this.toolViewManager.detach(),this._teardown()):e&&!this.ready&&(this._startup(),this.toolViewManager.attach());}),!0));}initialize(){let e;this.addResolvingPromise(this.validate().then((()=>(this._isValid=!0,a$D(this,"ready"))))),this.basemapView=new a$m({view:this}),this.layerViewManager=new L$2({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.toolViewManager=new w({view:this}),this._resetInitialViewPropertiesFromContent(),i$l(this.defaultsFromMap,"isSpatialReferenceDone",(t=>{const i=!!(this.map&&this.map.allLayers.length>0);if(t&&!this.spatialReference&&i||!e){if(t&&!this.spatialReference&&i&&!e){const t=e=L$8(this.spatialReferenceWarningDelay);e.then((()=>{t===e&&H$1.warn("#spatialReference","no spatial reference could be derived from the currently added map layers");})).catch((()=>{}));}}else e=null;}),!0);}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=l$n(this.graphics),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.toolViewManager=l$n(this.toolViewManager),this.layerViewManager=l$n(this.layerViewManager),this.basemapView=l$n(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const e=this.map;this.map=null,null==e||e.destroy();}_startup(){this._set("ready",!0);}_teardown(){this._set("ready",!1);}whenReady(){return Promise.resolve(this)}toMap(){return H$1.error("#toMap()","Not implemented on this instance of View"),null}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get preconditionsReady(){return !!(!this.fatalError&&this._isValid&&!this._readyCycleForced&&this.map&&(!m$k.isLoadable(this.map)||this.map.loaded)&&0!==this.width&&0!==this.height&&this.spatialReference&&this.isSpatialReferenceSupported(this.spatialReference)&&(this._currentSpatialReference||!this.initialExtentRequired||this.initialExtent||this.defaultsFromMap&&this.defaultsFromMap.isSpatialReferenceDone)&&this.defaultsFromMap&&this.defaultsFromMap.isTileInfoDone)}set map(e){var t;e!==this._get("map")&&(null!=(t=e)&&t.destroyed&&(H$1.warn("#map","The provided map is already destroyed",{map:e}),e=null),m$k.isLoadable(e)&&e.load().catch((()=>{})),this.initialized&&(this.forceReadyCycle(),this._resetInitialViewPropertiesFromContent()),this._set("map",e));}get spatialReference(){let e=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return e&&this.isHeightModelInfoRequired&&this.defaultsFromMap&&(e=e.clone(),e.vcsWkid=this.defaultsFromMap.vcsWkid,e.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),e}set spatialReference(e){this._userSpatialReference=e,this._set("spatialReference",e);}get stationary(){return !this.animation&&!this.navigating&&!this.resizing}get initialExtent(){return this.defaultsFromMap&&this.defaultsFromMap.extent}get cursor(){const e=this.toolViewManager?this.toolViewManager.cursor:null;return r$g(e)?e:this._cursor||"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor");}get size(){return [this.width,this.height]}whenLayerView(e){return this.layerViewManager.whenLayerView(e)}getDefaultSpatialReference(){return this.get("defaultsFromMap.spatialReference")}getDefaultHeightModelInfo(){return this.get("map.supportsHeightModelInfo")&&this.get("map.heightModelInfo")||this.get("defaultsFromMap.heightModelInfo")||null}importLayerView(e){throw new s$l("importLayerView() not implemented")}hasLayerViewModule(e){return !1}async validate(){}invalidate(){this._isValid=!1;}isSpatialReferenceSupported(e,t,i){return !0}isTileInfoRequired(){return !1}when(e,t){return this.isResolved()&&!this.ready&&H$1.warn("#when()",'Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use watchUtils.whenOnce(view, "ready").then(...) instead.'),super.when(e,t)}forceReadyCycle(){this.ready&&(this._readyCycleForced=!0,g$i(this,"preconditionsReady",(()=>this._readyCycleForced=!1)));}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e;}tryFatalErrorRecovery(){this.fatalError=null;}_resetInitialViewPropertiesFromContent(){if(!this.defaultsFromMap)return;const e=()=>this.defaultsFromMap&&this.defaultsFromMap.start();this.defaultsFromMap.reset(),this._currentSpatialReference=null,this.notifyChange("spatialReference"),this.handles.remove("defaultsFromMap"),this.handles.add([f$e(this,"spatialReference",((t,i)=>{E$9(t,i)||e();})),f$e(this,"initialExtentRequired",e),v$7(e)],"defaultsFromMap");}};W$2.views=new S$8,e$f([o$i("toolViewManager.activeTool")],W$2.prototype,"activeTool",void 0),e$f([d$h({readOnly:!0})],W$2.prototype,"allLayerViews",void 0),e$f([d$h()],W$2.prototype,"groundView",void 0),e$f([d$h()],W$2.prototype,"animation",void 0),e$f([d$h()],W$2.prototype,"basemapView",void 0),e$f([d$h()],W$2.prototype,"defaultsFromMap",void 0),e$f([d$h()],W$2.prototype,"fatalError",void 0),e$f([d$h({type:M$6})],W$2.prototype,"extent",void 0),e$f([d$h(a$E(c$E,"graphics"))],W$2.prototype,"graphics",void 0),e$f([d$h({readOnly:!0,type:v$8,dependsOn:["map.heightModelInfo?","defaultsFromMap.heightModelInfo"]})],W$2.prototype,"heightModelInfo",null),e$f([d$h({readOnly:!0})],W$2.prototype,"interacting",null),e$f([d$h({readOnly:!0})],W$2.prototype,"navigating",void 0),e$f([d$h({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","initialExtentRequired","initialExtent","defaultsFromMap.isSpatialReferenceDone","defaultsFromMap.isTileInfoDone"]})],W$2.prototype,"preconditionsReady",null),e$f([d$h({type:S$8,readOnly:!0})],W$2.prototype,"layerViews",void 0),e$f([d$h({type:p$d})],W$2.prototype,"magnifier",void 0),e$f([d$h({value:null,type:j$2})],W$2.prototype,"map",null),e$f([d$h()],W$2.prototype,"padding",void 0),e$f([d$h({readOnly:!0})],W$2.prototype,"ready",void 0),e$f([d$h({type:k$3})],W$2.prototype,"spatialReference",null),e$f([d$h()],W$2.prototype,"spatialReferenceWarningDelay",void 0),e$f([d$h()],W$2.prototype,"stationary",null),e$f([d$h({readOnly:!0})],W$2.prototype,"supportsGround",void 0),e$f([d$h({type:y$d})],W$2.prototype,"timeExtent",void 0),e$f([o$i("toolViewManager.tools")],W$2.prototype,"tools",void 0),e$f([d$h()],W$2.prototype,"toolViewManager",void 0),e$f([d$h({readOnly:!0})],W$2.prototype,"type",void 0),e$f([d$h({type:Number})],W$2.prototype,"scale",void 0),e$f([d$h({readOnly:!0})],W$2.prototype,"updating",void 0),e$f([d$h({readOnly:!0})],W$2.prototype,"initialExtentRequired",void 0),e$f([d$h({readOnly:!0,type:M$6})],W$2.prototype,"initialExtent",null),e$f([d$h()],W$2.prototype,"cursor",null),e$f([d$h({readOnly:!0})],W$2.prototype,"input",void 0),e$f([d$h({type:p$9,nonNullable:!0})],W$2.prototype,"navigation",void 0),e$f([d$h()],W$2.prototype,"layerViewManager",void 0),e$f([d$h()],W$2.prototype,"width",void 0),e$f([d$h()],W$2.prototype,"height",void 0),e$f([d$h({readOnly:!0})],W$2.prototype,"resizing",void 0),e$f([d$h({value:null,readOnly:!0})],W$2.prototype,"size",null),e$f([d$h({readOnly:!0})],W$2.prototype,"suspended",void 0),e$f([d$h({readOnly:!0})],W$2.prototype,"viewEvents",void 0),e$f([d$h({readOnly:!0})],W$2.prototype,"persistableViewModels",void 0),e$f([d$h()],W$2.prototype,"_isValid",void 0),e$f([d$h()],W$2.prototype,"_readyCycleForced",void 0),e$f([d$h()],W$2.prototype,"_currentSpatialReference",void 0),W$2=z=e$f([i$j("esri.views.View")],W$2);const P$1=W$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let p$8=class extends m$o{constructor(t){super(t),this.state="running",this.target=null;}initialize(){this.addResolvingPromise(new Promise(((t,s)=>this._dfd={resolve:t,reject:s})));}get done(){return "finished"===this.state||"stopped"===this.state}stop(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._dfd.reject(new s$l("ViewAnimation stopped")));}finish(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._dfd.resolve());}update(t,s){s||(s=O$6(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",s);}};e$f([d$h({readOnly:!0})],p$8.prototype,"done",null),e$f([d$h({readOnly:!0,type:String})],p$8.prototype,"state",void 0),e$f([d$h()],p$8.prototype,"target",void 0),p$8=e$f([i$j("esri.views.ViewAnimation")],p$8),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"};}(p$8||(p$8={}));const n$e=p$8;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function e$7(){return [1,0,0,1,0,0]}function n$d(e){return [e[0],e[1],e[2],e[3],e[4],e[5]]}function r$7(e,n,r,t,a,o){return [e,n,r,t,a,o]}function t$a(e,n){return new Float64Array(e,n,6)}const a$f=Object.freeze({__proto__:null,create:e$7,clone:n$d,fromValues:r$7,createView:t$a});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const W$1=39.37,C$3=180/Math.PI;function U$2(t,e,n){const r=o$l(e[0]/s$u.radius);return r$i(t,n?r:r-360*Math.floor((r+180)/360),o$l(.5*Math.PI-2*Math.atan(Math.exp(-e[1]/s$u.radius))))}function Q(t,e){let n=e[1];return n>89.99999?n=89.99999:n<-89.99999&&(n=-89.99999),n=Math.sin(s$v(n)),r$i(t,s$v(e[0])*s$u.radius,.5*s$u.radius*Math.log((1+n)/(1-n)))}function B(t,e,n,r){return r&&n&&!r.equals(n)&&g$h(r,n)&&r.isWebMercator?r.isWebMercator?Q(t,e):U$2(t,e):a$F(t,e)}function D(t){return t.wkid?t:t.spatialReference||k$3.WGS84}function T(t,e){return e.type?r$i(t,e.x,e.y):a$F(t,e)}function H(t){return H$3(t)}function J(t,e){return Math.max(t.width/e[0],t.height/e[1])*ct(t.spatialReference)}async function K(t,a,i,s){let c,u;if(!t)return null;if(Array.isArray(t)&&!t.length)return null;if(S$8.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&"object"==typeof t[0]){const e=t.every((t=>"attributes"in t)),r=t.some((t=>!t.geometry));let o=t;if(e&&r&&a&&a.allLayerViews){const e=new Map;for(const n of t){const t=n.layer,r=e.get(t)||[],o=n.attributes[t.objectIdField];null!=o&&r.push(o),e.set(t,r);}const r=[];e.forEach(((t,e)=>{const n=a.allLayerViews.find((t=>t.layer.id===e.id));if("queryFeatures"in n){const o=e.createQuery();o.objectIds=t,o.returnGeometry=!0,r.push(n.queryFeatures(o));}}));const i=await Promise.all(r),s=[];for(const t of i)if(t&&t.features&&t.features.length)for(const e of t.features)r$g(e.geometry)&&s.push(e.geometry);o=s;}for(const t of o)s=await K(t,a,i,s);return s}if(Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1])c=new b$a(t);else if(t instanceof p$x)c=t;else if("geometry"in t)if(t.geometry)c=t.geometry;else if(t.layer){const e=t.layer,n=a.allLayerViews.find((t=>t.layer.id===e.id));if("queryFeatures"in n){const o=e.createQuery();o.objectIds=[t.attributes[e.objectIdField]],o.returnGeometry=!0;const a=await n.queryFeatures(o);c=m$p(a,"features",0,"geometry");}}if(t$j(c))return null;if(u="point"===c.type?new M$6({xmin:c.x,ymin:c.y,xmax:c.x,ymax:c.y,spatialReference:c.spatialReference}):c.extent,!u)return null;const f=M$5(u,i);return t$j(f)?null:s=s?s.union(f):f}function X(t){if(t&&(!Array.isArray(t)||"number"!=typeof t[0])&&("object"==typeof t||Array.isArray(t)&&"object"==typeof t[0])){if("layer"in t&&t.layer&&t.layer.minScale&&t.layer.maxScale){const e=t.layer;return {min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every((t=>"layer"in t))){let e=0,n=0;for(const r of t){const t=r.layer;t&&t.minScale&&t.maxScale&&(e=t.minScale<e?t.minScale:e,n=t.maxScale>n?t.maxScale:n);}return e&&n?{min:e,max:n}:null}}}async function Y(e,r){if(!e||!r)return new u$9({targetGeometry:new b$a,scale:0,rotation:0});let o=r.spatialReference;const{constraints:a,padding:i,viewpoint:s,size:c}=r,u=[i?c[0]-i.left-i.right:c[0],i?c[1]-i.top-i.bottom:c[1]];let f=null;e instanceof u$9?f=e:e.viewpoint?f=e.viewpoint:e.target&&"esri.Viewpoint"===e.target.declaredClass&&(f=e.target);let l=null;f&&f.targetGeometry?l=f.targetGeometry:e instanceof M$6?l=e:(e||e&&("center"in e||"extent"in e||"target"in e))&&(l=await K(e.center,r,o)||await K(e.extent,r,o)||await K(e.target,r,o)||await K(e,r,o)),!l&&s&&s.targetGeometry?l=s.targetGeometry:!l&&r.extent&&(l=r.extent);const m=D(l);if(o||(o=D(r.spatialReference||r.extent||l)),!g$h(l,o)&&m&&!m.equals(o))return null;const y=T(n$y(),l.center?l.center:l),p=new b$a(B(y,y,m,o),o);let g=null;if(f&&r$g(f.targetGeometry)&&"point"===f.targetGeometry.type)g=f.scale;else if(e.hasOwnProperty("scale")&&e.scale)g=e.scale;else if(e.hasOwnProperty("zoom")&&-1!==e.zoom&&a&&a.effectiveLODs)g=a.zoomToScale(e.zoom);else if(Array.isArray(l)||"point"===l.type||"extent"===l.type&&0===l.width&&0===l.height){const t=M$5(r.extent,o);g=r$g(t)?J(t,u):r.extent?J(r.extent,u):s.scale;}else g=g$h(l.extent,o)?J(M$5(l.extent,o),u):J(l.extent,u);const h=X(e);h&&(h.min&&h.min>g?g=h.min:h.max&&h.max<g&&(g=h.max));let x=0;f?x=f.rotation:e.hasOwnProperty("rotation")?x=e.rotation:s&&(x=s.rotation);let b=new u$9({targetGeometry:p,scale:g,rotation:x});return a&&(b=a.fit(b),a.constrainByGeometry(b),a.rotationEnabled||(b.rotation=x)),b}function Z(t,e){const n=t.targetGeometry,r=e.targetGeometry;return n.x=r.x,n.y=r.y,n.spatialReference=r.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function $(t,e,n){return n?r$i(t,.5*(e[0]-n.right+n.left),.5*(e[1]-n.bottom+n.top)):l$o(t,e,.5)}const _$1=function(){const t=n$y();return function(e,n,r){const o=n.targetGeometry;T(t,o);const a=.5*at(n);return e.xmin=t[0]-a*r[0],e.ymin=t[1]-a*r[1],e.xmax=t[0]+a*r[0],e.ymax=t[1]+a*r[1],e.spatialReference=o.spatialReference,e}}();function tt(t,e,n,r,o){return wt(t,e,n.center),t.scale=J(n,r),o&&o.constraints&&o.constraints.constrain(t),t}function et(t,e,n,r){return mt(t,e,n,r),r$j(t,t)}function nt(t,e,n){const r=st(e),o=Math.abs(Math.cos(r)),a=Math.abs(Math.sin(r));return r$i(t,Math.round(n[1]*a+n[0]*o),Math.round(n[1]*o+n[0]*a))}const rt=function(){const t=n$y();return function(e,n,r){return F$4(e,ut(e,n),$(t,n,r))}}(),ot=function(){const t=e$7(),e=n$y();return function(n,r,o,a){const i=at(r),s=st(r);return r$i(e,i,i),M$7(t,e),c$F(t,t,s),i$r(t,t,rt(e,o,a)),i$r(t,t,[0,a.top-a.bottom]),r$i(n,t[4],t[5])}}();function at(t){return t.scale*it(t.targetGeometry)}function it(t){return r$g(t)&&I$7(t.spatialReference)?1/(H(t.spatialReference)*W$1*ft()):1}function st(t){return s$v(t.rotation)||0}function ct(t){return I$7(t)?H(t)*W$1*ft():1}function ut(t,e){return l$o(t,e,.5)}function ft(){return 96}const lt=function(){const t=n$y(),e=n$y(),n=n$y();return function(r,o,a,i,s,c){return x$5(t,o),l$o(e,a,.5*c),r$i(n,1/i*c,-1/i*c),n$z(r),i$r(r,r,e),s&&c$F(r,r,s),e$o(r,r,n),i$r(r,r,t),r}}(),mt=function(){const t=n$y();return function(e,n,r,o){const a=at(n),i=st(n);return T(t,n.targetGeometry),lt(e,t,r,a,i,o)}}(),yt=function(){const t=n$y();return function(e,n,r,o){const a=at(n);return T(t,n.targetGeometry),lt(e,t,r,a,0,o)}}();function pt(t){if(t.isWrappable){const e=S$c(t);return e.valid[1]-e.valid[0]}return 0}function gt(t,e){return Math.round(pt(t)/e)}function ht(t,e){return Y(t,e)}const xt=function(){const t=n$y(),e=n$y(),n=[0,0,0];return function(r,o,a){o$m(t,r,o),v$9(t,t),o$m(e,r,a),v$9(e,e),A$7(n,t,e);let i=Math.acos(j$5(t,e)/(b$b(t)*b$b(e)))*C$3;return n[2]<0&&(i=-i),isNaN(i)&&(i=0),i}}(),bt=function(){const t=n$y();return function(e,n,r,o){const a=e.targetGeometry;return Z(e,n),ot(t,n,r,o),a.x+=t[0],a.y+=t[1],e}}(),dt=function(){const t=n$y();return function(e,n,r,o){const a=e.targetGeometry;return Z(e,n),ot(t,n,r,o),a.x-=t[0],a.y-=t[1],e}}(),wt=function(){const t=n$y();return function(e,n,r){Z(e,n);const o=e.targetGeometry,a=D(r),i=D(o);return T(t,r),B(t,t,a,i),o.x=t[0],o.y=t[1],e}}();function jt(t){return at(t)}const Gt=function(){const t=n$y();return function(e,n,r,o,a){a||(a="center"),F$4(t,r,o),l$o(t,t,.5);const i=t[0],s=t[1];switch(a){case"center":r$i(t,0,0);break;case"left":r$i(t,-i,0);break;case"top":r$i(t,0,s);break;case"right":r$i(t,i,0);break;case"bottom":r$i(t,0,-s);break;case"top-left":r$i(t,-i,s);break;case"bottom-left":r$i(t,-i,-s);break;case"top-right":r$i(t,i,s);break;case"bottom-right":r$i(t,i,-s);}return Ft(e,n,t),e}}();function Mt(t,e,n){return Z(t,e),t.rotation+=n,t}function kt(t,e,n){return Z(t,e),t.rotation=n,t}const At=function(){const t=n$y();return function(e,n,r,o,a){return Z(e,n),isNaN(r)||0===r||(Pt(t,o,n,a),e.scale=n.scale*r,qt(t,t,e,a),Ft(e,e,r$i(t,t[0]-o[0],o[1]-t[1]))),e}}();function Rt(t,e,n){return Z(t,e),t.scale=n,t}const St=function(){const t=n$y();return function(e,n,r,o,a,i){return Z(e,n),isNaN(r)||0===r||(Pt(t,a,n,i),e.scale=n.scale*r,e.rotation+=o,qt(t,t,e,i),Ft(e,e,r$i(t,t[0]-a[0],a[1]-t[1]))),e}}(),vt=function(){const t=n$y(),e=n$y();return function(n,r,o,a,i,s,c){return rt(e,s,c),s$w(t,i,e),a?St(n,r,o,a,t,s):At(n,r,o,t,s)}}(),Pt=function(){const t=e$7();return function(e,n,r,o){return D$7(e,n,et(t,r,o,1))}}(),qt=function(){const t=e$7();return function(e,n,r,o){return D$7(e,n,mt(t,r,o,1))}}(),Ft=function(){const t=n$y(),e=e$7();return function(n,r,o){Z(n,r);const a=at(r),i=n.targetGeometry;return h$l(e,st(r)),e$o(e,e,t$p(a,a)),D$7(t,o,e),i.x+=t[0],i.y+=t[1],n}}();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class m$7{constructor(t,i,s,e){const o=t.targetGeometry,n=i.targetGeometry;e?"string"==typeof e&&(e=r$k(e)||t$q.ease):e=t$q.ease,this.easing=e,this.duration=s,this.sCenterX=o.x,this.sCenterY=o.y,this.sScale=t.scale,this.sRotation=t.rotation,this.tCenterX=n.x,this.tCenterY=n.y,this.tScale=i.scale,this.tRotation=i.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360);}applyRatio(t,i){const s=this.easing(i);let e,o,n,a;i>=1?(e=this.tCenterX,o=this.tCenterY,n=this.tRotation,a=this.tScale):(e=this.sCenterX+s*this.dCenterX,o=this.sCenterY+s*this.dCenterY,n=this.sRotation+s*this.dRotation,a=this.sScale+s*this.dScale),t.targetGeometry.x=e,t.targetGeometry.y=o,t.scale=a,t.rotation=n;}}let u$6=class extends p$u{constructor(t){super(t),this.duration=200,this.transition=null,this.easing=t$q.ease,this.view=null,this.viewpoint=null,this.viewpoint=new u$9({targetGeometry:new b$a,scale:0,rotation:0}),this._updateTask=A$5({postRender:this._postRender.bind(this)}),this._updateTask.pause();}destroy(){this._updateTask.remove(),this._updateTask=null;}animate(t,i,s){this.stop();const e=this.viewpoint;Z(e,i),this.transition=new m$7(this.viewpoint,t.target,s&&s.duration||this.duration,s&&s.easing||this.easing);const o=()=>{this.animation===t&&this._updateTask&&("finished"===t.state&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null);};return t.when(o,o),this._startTime=performance.now(),this._updateTask.resume(),this.animation=t,t}animateContinous(t,i){this.stop(),this.updateFunction=i,this.viewpoint=t;const s=new n$e({target:t.clone()}),e=()=>{this.animation===s&&this._updateTask&&(this.animation=null,this.updateFunction=null);};return s.when(e,e),this._startTime=performance.now(),this._updateTask.resume(),this.animation=s,s}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null);}_postRender(t){const i=this.animation;if(i&&i.state!==n$e.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,t.deltaTime);else {const t=(performance.now()-this._startTime)/this.transition.duration,i=t>=1;this.transition.applyRatio(this.viewpoint,t),i&&this.animation.finish();}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone());}else this._updateTask.pause();}};e$f([d$h()],u$6.prototype,"animation",void 0),e$f([d$h()],u$6.prototype,"duration",void 0),e$f([d$h()],u$6.prototype,"transition",void 0),e$f([d$h()],u$6.prototype,"easing",void 0),e$f([d$h()],u$6.prototype,"view",void 0),e$f([d$h()],u$6.prototype,"viewpoint",void 0),u$6=e$f([i$j("esri.views.2d.AnimationManager")],u$6);const d$5=u$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class a$e{constructor(t){this.view=t,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.updateEnabled=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions;},this.update=()=>{if(this._updateRequested=!1,!this.updateEnabled)return;const{basemapView:t,graphicsView:a,labelManager:s,layerViews:i,state:{id:r}}=this.view;t.baseLayerViews.forEach(this._updateLayerView,this),i.forEach(this._updateLayerView,this),t.referenceLayerViews.forEach(this._updateLayerView,this),r$g(s)&&(s.lastUpdateId!==r&&(s.viewChange(),s.lastUpdateId=r),s.updateRequested&&s.processUpdate(this._updateParameters)),r$g(a)&&(a.lastUpdateId!==r&&(a.viewChange(),a.lastUpdateId=r),a.updateRequested&&a.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause();};}destroy(){this.stop();}start(){this.stationary=this.view.stationary,this._updateParameters={state:this.view.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:this.view.renderingOptions},this._stationaryHandle=this.view.watch("stationary",(e=>{this.stationary=e,this.requestFrame();})),this._frameTaskHandle=A$5(this);}stop(){this._frameTaskHandle&&(this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1);}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame());}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume();}_updateLayerView(e){const t=this.view.state,a=e.lastUpdateId;null!=a&&(this.stationary||e.moving)||(e.moving=!0,e.moveStart()),a!==t.id&&e.viewChange(),this.stationary&&e.moving&&(e.moving=!1,e.moveEnd()),e.lastUpdateId=t.id,e.updateRequested&&e.processUpdate(this._updateParameters),"layerViews"in e&&e.layerViews.forEach(this._updateLayerView,this);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function t$9(){return Promise.all([import('./webgl-09c18771.js'),import('./mapViewDeps-6b8a8771.js')])}const s$b=()=>t$9().then((()=>import('./TileLayerView2D-16756da4.js'))),a$d=()=>t$9().then((()=>import('./FeatureLayerView2D-c585ad52.js'))),i$6={"base-dynamic":()=>t$9().then((()=>import('./BaseDynamicLayerView2D-a4f7d3fc.js'))),"base-tile":s$b,"bing-maps":s$b,csv:a$d,"geo-rss":()=>t$9().then((()=>import('./GeoRSSLayerView2D-06beaeef.js'))),feature:a$d,geojson:a$d,graphics:()=>t$9().then((()=>import('./GraphicsLayerView2D-c70192f3.js'))),group:()=>t$9().then((()=>import('./GroupLayerView2D-5c54539f.js'))),imagery:()=>t$9().then((()=>import('./ImageryLayerView2D-49abd554.js'))),"imagery-tile":()=>t$9().then((()=>import('./ImageryTileLayerView2D-c7e33ba0.js'))),kml:()=>t$9().then((()=>import('./KMLLayerView2D-9a1b41d0.js'))),"map-image":()=>t$9().then((()=>import('./MapImageLayerView2D-a7448d5a.js'))),"map-notes":()=>t$9().then((()=>import('./MapNotesLayerView2D-8b4813df.js'))),"ogc-feature":()=>t$9().then((()=>import('./OGCFeatureLayerView2D-d9b13f1e.js'))),"open-street-map":s$b,route:()=>t$9().then((()=>import('./RouteLayerView2D-c6c743a6.js'))),stream:()=>t$9().then((()=>import('./StreamLayerView2D-1eb40054.js'))),"subtype-group":()=>t$9().then((()=>import('./SubtypeGroupLayerView2D-6f591af5.js'))),tile:s$b,"vector-tile":()=>t$9().then((()=>import('./VectorTileLayerView2D-873ae487.js'))),wcs:()=>t$9().then((()=>import('./ImageryTileLayerView2D-c7e33ba0.js'))),"web-tile":s$b,wfs:a$d,wms:()=>t$9().then((()=>import('./WMSLayerView2D-20d064db.js'))),wmts:()=>t$9().then((()=>import('./WMTSLayerView2D-d8fdd280.js'))),analysis:null,"base-elevation":null,"building-scene":null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};function o$7(r){const t=r.declaredClass?r.declaredClass.slice(r.declaredClass.lastIndexOf(".")+1):"Unknown",s=t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new s$l(`${s}:view-not-supported`,`${t} is not supported in 2D`)}const l$7={hasLayerViewModule:e=>r$g(i$6[e.type]),importLayerView:e=>{const t=i$6[e.type];if(!r$g(t))throw o$7(e);return t(e)}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function o$6(o,m){const{spatialReference:r}=m,i=[m.x,m.y];let s=Number.POSITIVE_INFINITY,x=0,c=0;const a=[0,0],f="extent"===o.type?[[[o.xmin,o.ymin],[o.xmin,o.ymax],[o.xmax,o.ymax],[o.xmax,o.ymin],[o.xmin,o.ymin]]]:o.rings;for(const n of f)for(let o=0;o<n.length-1;o++){o$n(a,i,n,o);const m=d$n(i,a);m<s&&(s=m,x=a[0],c=a[1]);}return {coordinate:new b$a({x,y:c,spatialReference:r}),distance:s}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var u$5;const g$4=s$k.getLogger("esri.views.MapView");let h$6=u$5=class extends p$u{constructor(e){super(e),this.geometry=null,this.spatialReference=null;}get normalizedGeometry(){return t$j(this.geometry)||!this.spatialReference?null:this.spatialReference.equals(this.geometry.spatialReference)?this.geometry:g$h(this.geometry,this.spatialReference)?M$5(this.geometry,this.spatialReference):H$4()?O$7(this.geometry,this.spatialReference):(g$4.error("#constraints.geometry","unsupported coordinate system. The source geometry cannot be projected to the view's coordinate system. The projection engine cannot be loaded.",{geometry:this.geometry}),null)}constrain(e,r){if(t$j(this.normalizedGeometry))return e;const t=e.targetGeometry;if("extent"===this.normalizedGeometry.type?r$l(this.normalizedGeometry,t):c$G(this.normalizedGeometry,t))return e;const{coordinate:s}=o$6(this.normalizedGeometry,t);return s?(e.targetGeometry=s,e):e}clone(){var e,r;return new u$5({geometry:null==(e=this.geometry)?void 0:e.clone(),spatialReference:null==(r=this.spatialReference)?void 0:r.clone()})}};e$f([d$h({constructOnly:!0})],h$6.prototype,"geometry",void 0),e$f([d$h({readOnly:!0})],h$6.prototype,"normalizedGeometry",null),e$f([d$h({constructOnly:!0})],h$6.prototype,"spatialReference",void 0),h$6=u$5=e$f([i$j("esri.views.2d.constraints.GeometryConstraint")],h$6);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var s$a;let a$c=s$a=class extends p$u{constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0;}constrain(o,r){return this.enabled&&r?(this.rotationEnabled||(o.rotation=r.rotation),o):o}clone(){return new s$a({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};e$f([d$h()],a$c.prototype,"enabled",void 0),e$f([d$h()],a$c.prototype,"rotationEnabled",void 0),a$c=s$a=e$f([i$j("esri.views.2d.constraints.RotationConstraint")],a$c);const n$c=a$c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var a$b;let c$b=a$b=class extends p$u{constructor(e){super(e),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0;}initialize(){let e,{lods:t,minScale:o,maxScale:s,minZoom:i,maxZoom:a}=this,c=-1,r=-1,l=!1,n=!1;if(0!==o&&0!==s&&o<s&&([o,s]=[s,o]),!t||!t.length)return this._set("effectiveMinScale",o),void this._set("effectiveMaxScale",s);t=t.map((e=>e.clone())),t.sort(((e,t)=>t.scale-e.scale)),t.forEach(((e,t)=>e.level=t));for(const f of t)!l&&o>0&&o>=f.scale&&(c=f.level,l=!0),!n&&s>0&&s>=f.scale&&(r=e?e.level:-1,n=!0),e=f;-1===i&&(i=0===o?0:c),-1===a&&(a=0===s?t.length-1:r),i=Math.max(i,0),i=Math.min(i,t.length-1),a=Math.max(a,0),a=Math.min(a,t.length-1),i>a&&([i,a]=[a,i]),o=t[i].scale,s=t[a].scale,t.splice(0,i),t.splice(a-i+1,t.length),t.forEach(((e,t)=>{this._lodByScale[e.scale]=e,this._scales[t]=e.scale;})),this._set("effectiveLODs",t),this._set("effectiveMinZoom",i),this._set("effectiveMaxZoom",a),this._set("effectiveMinScale",o),this._set("effectiveMaxScale",s);}constrain(e,t){if(t&&e.scale===t.scale)return e;const o=this.effectiveMinScale,s=this.effectiveMaxScale,i=e.targetGeometry,a=t&&t.targetGeometry,c=0!==s&&e.scale<s,r=0!==o&&e.scale>o;if(c||r){const c=r?o:s;if(a){const o=(c-t.scale)/(e.scale-t.scale);i.x=a.x+(i.x-a.x)*o,i.y=a.y+(i.y-a.y)*o;}e.scale=c;}return this.snapToZoom&&this.effectiveLODs&&(e.scale=this._getClosestScale(e.scale)),e}fit(e){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(e,null);const t=this.scaleToZoom(e.scale),o=Math.abs(t-Math.floor(t));return e.scale=this.zoomToScale(o>.99?Math.round(t):Math.floor(t)),e}zoomToScale(e){if(!this.effectiveLODs)return 0;e-=this.effectiveMinZoom,e=Math.max(0,e);const t=this._scales;if(e<=0)return t[0];if(e>=t.length)return t[t.length-1];const o=Math.round(e-.5),s=Math.round(e);return t[s]+(s-e)*(t[o]-t[s])}scaleToZoom(e){if(!this.effectiveLODs)return -1;const t=this._scales;let o,s;if(e>=t[0])return this.effectiveMinZoom;if(e<=t[t.length-1])return this.effectiveMaxZoom;for(let i=0;i<t.length-1;i++){if(o=t[i],s=t[i+1],s===e){return i+this.effectiveMinZoom+1}if(o>e&&s<e){return i+this.effectiveMinZoom+1-(e-s)/(o-s)}}}snapToClosestScale(e){if(!this.effectiveLODs)return e;const t=this.scaleToZoom(e);return this.zoomToScale(Math.round(t))}snapToNextScale(e,t=.5){if(!this.effectiveLODs)return e*t;const o=Math.round(this.scaleToZoom(e));return this.zoomToScale(o+1)}snapToPreviousScale(e,t=2){if(!this.effectiveLODs)return e*t;const o=Math.round(this.scaleToZoom(e));return this.zoomToScale(o-1)}clone(){return new a$b({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(e){return this._lodByScale[e]||(e=this._scales.reduce(((t,o)=>Math.abs(o-e)<=Math.abs(t-e)?o:t),this._scales[0])),this._lodByScale[e].scale}};e$f([d$h({readOnly:!0})],c$b.prototype,"effectiveLODs",void 0),e$f([d$h({readOnly:!0})],c$b.prototype,"effectiveMinZoom",void 0),e$f([d$h({readOnly:!0})],c$b.prototype,"effectiveMaxZoom",void 0),e$f([d$h({readOnly:!0})],c$b.prototype,"effectiveMinScale",void 0),e$f([d$h({readOnly:!0})],c$b.prototype,"effectiveMaxScale",void 0),e$f([d$h({type:[p$y]})],c$b.prototype,"lods",void 0),e$f([d$h()],c$b.prototype,"minZoom",void 0),e$f([d$h()],c$b.prototype,"maxZoom",void 0),e$f([d$h()],c$b.prototype,"minScale",void 0),e$f([d$h()],c$b.prototype,"maxScale",void 0),e$f([d$h()],c$b.prototype,"snapToZoom",void 0),c$b=a$b=e$f([i$j("esri.views.2d.constraints.ZoomConstraint")],c$b);const r$6=c$b;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const p$7={base:null,key:"type",typeMap:{extent:M$6,polygon:v$a}};let c$a=class extends n$u.EventedAccessor{constructor(){super(...arguments),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0;}initialize(){this.watch(["_zoom","_rotation"],this.emit.bind(this,"update"),!0);}destroy(){this.view=null,this._set("_zoom",null),this._set("_rotation",null);}set geometry(o){o?this._set("geometry",o):this._set("geometry",null);}get _defaultLODs(){const o=this.get("view.defaultsFromMap.tileInfo"),t=this.get("view.spatialReference");return o&&t&&o.spatialReference.equals(t)?o.lods:null}get _geometry(){return new h$6({geometry:this.geometry,spatialReference:this.view.spatialReference})}get _rotation(){return new n$c({rotationEnabled:this.rotationEnabled})}get _zoom(){return new r$6({lods:this.lods||this._defaultLODs,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})}canZoomInTo(o){const t=this.effectiveMaxScale;return 0===t||o>=t}canZoomOutTo(o){const t=this.effectiveMinScale;return 0===t||o<=t}constrain(o,t){return this._zoom.constrain(o,t),this._rotation.constrain(o,t),this._geometry.constrain(o,t),o}constrainByGeometry(o){return this._geometry.constrain(o)}fit(o){return this._zoom.fit(o)}zoomToScale(o){return this._zoom.zoomToScale(o)}scaleToZoom(o){return this._zoom.scaleToZoom(o)}snapScale(o){return this._zoom.snapToClosestScale(o)}snapToNextScale(o){return this._zoom.snapToNextScale(o)}snapToPreviousScale(o){return this._zoom.snapToPreviousScale(o)}};e$f([d$h({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],c$a.prototype,"effectiveLODs",void 0),e$f([d$h({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],c$a.prototype,"effectiveMinScale",void 0),e$f([d$h({readOnly:!0,aliasOf:"_zoom.effectiveMaxScale"})],c$a.prototype,"effectiveMaxScale",void 0),e$f([d$h({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],c$a.prototype,"effectiveMinZoom",void 0),e$f([d$h({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],c$a.prototype,"effectiveMaxZoom",void 0),e$f([d$h({types:p$7,value:null})],c$a.prototype,"geometry",null),e$f([d$h({type:[p$y]})],c$a.prototype,"lods",void 0),e$f([d$h()],c$a.prototype,"minScale",void 0),e$f([d$h()],c$a.prototype,"maxScale",void 0),e$f([d$h()],c$a.prototype,"minZoom",void 0),e$f([d$h()],c$a.prototype,"maxZoom",void 0),e$f([d$h()],c$a.prototype,"rotationEnabled",void 0),e$f([d$h()],c$a.prototype,"snapToZoom",void 0),e$f([d$h()],c$a.prototype,"view",void 0),e$f([d$h()],c$a.prototype,"_defaultLODs",null),e$f([d$h({type:h$6})],c$a.prototype,"_geometry",null),e$f([d$h({type:n$c})],c$a.prototype,"_rotation",null),e$f([d$h({readOnly:!0,type:r$6})],c$a.prototype,"_zoom",null),c$a=e$f([i$j("esri.views.2d.MapViewConstraints")],c$a);const y$2=c$a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function n$b(){const n=new Float32Array(9);return n[0]=1,n[4]=1,n[8]=1,n}function r$5(n){const r=new Float32Array(9);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r}function t$8(n,r,t,e,a,o,c,s,u){const l=new Float32Array(9);return l[0]=n,l[1]=r,l[2]=t,l[3]=e,l[4]=a,l[5]=o,l[6]=c,l[7]=s,l[8]=u,l}function e$6(n,r){return new Float32Array(n,r,9)}const a$a=Object.freeze({__proto__:null,create:n$b,clone:r$5,fromValues:t$8,createView:e$6});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function n$a(n){return n instanceof Float32Array&&n.length>=2}function r$4(n){return Array.isArray(n)&&n.length>=2}function t$7(t){return n$a(t)||r$4(t)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var V;const G$1=[0,0];let O$1=V=class extends a$w{constructor(t){super(t),this._viewpoint2D={center:n$y(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new M$6,this.id=0,this.inverseTransform=e$7(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=e$7(),this.transformNoRotation=e$7(),this.displayMat3=n$b(),this.displayViewMat3=n$b(),this.viewMat3=n$b(),this.viewMat2d=n$A(),this.worldScreenWidth=0,this.size=[0,0];}set pixelRatio(t){this._set("pixelRatio",t),this._update();}set size(t){this._set("size",t),this._update();}set viewpoint(t){if(t){const s=this._viewpoint2D,i=t.targetGeometry;s.center[0]=i.x,s.center[1]=i.y,s.rotation=t.rotation,s.scale=t.scale,s.spatialReference=i.spatialReference;}this._update();}copy(t){const s=this.size,i=this.viewpoint;return i&&s?(this.viewpoint=Z(i,t.viewpoint),this._set("size",a$F(s,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new V({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,s,i){return t$7(s)?D$7(t,s,this.inverseTransform):(G$1[0]=s,G$1[1]=i,D$7(t,G$1,this.inverseTransform))}toScreen(t,s,i){return t$7(s)?D$7(t,s,this.transform):(G$1[0]=s,G$1[1]=i,D$7(t,G$1,this.transform))}toScreenNoRotation(t,s,i){return t$7(s)?D$7(t,s,this.transformNoRotation):(G$1[0]=s,G$1[1]=i,D$7(t,G$1,this.transformNoRotation))}getScreenTransform(t,s){const{center:i}=this._viewpoint2D,e=this._get("pixelRatio")||1,o=this._get("size");return lt(t,i,o,s,0,e),t}_update(){const{center:t,spatialReference:i,scale:e,rotation:o}=this._viewpoint2D,c=this._get("pixelRatio")||1,m=this._get("size"),d=new u$9({targetGeometry:new b$a(t[0],t[1],i),scale:e,rotation:o});if(this._set("viewpoint",d),!m||!i||!e)return;this.resolution=at(d),this.rotation=o,this.scale=e,this.spatialReference=i,a$F(this.center,t);const y=0!==m[0]?2/m[0]:0,_=0!==m[1]?-2/m[1]:0;s$x(this.displayMat3,y,0,0,0,_,0,-1,1,1);const x=r$m(this.viewMat3),z=t$r(m[0]/2,m[1]/2),g=t$r(-m[0]/2,-m[1]/2),b=s$v(o);M$8(x,x,z),h$m(x,x,b),M$8(x,x,g),i$s(this.displayViewMat3,this.displayMat3,x);const V=n$z(this.viewMat2d);return i$r(V,V,z),c$F(V,V,b),i$r(V,V,g),_$1(this.extent,d,m),mt(this.transform,d,m,c),r$j(this.inverseTransform,this.transform),yt(this.transformNoRotation,d,m,c),this.worldScreenWidth=gt(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};e$f([d$h({readOnly:!0})],O$1.prototype,"id",void 0),e$f([d$h({value:1,json:{write:!0}})],O$1.prototype,"pixelRatio",null),e$f([d$h({json:{write:!0}})],O$1.prototype,"size",null),e$f([d$h({type:u$9,json:{write:!0}})],O$1.prototype,"viewpoint",null),O$1=V=e$f([i$j("esri.views.2d.ViewState")],O$1);const U$1=O$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let c$9=class extends p$u{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0;}};e$f([d$h()],c$9.prototype,"left",void 0),e$f([d$h()],c$9.prototype,"top",void 0),e$f([d$h()],c$9.prototype,"right",void 0),e$f([d$h()],c$9.prototype,"bottom",void 0),c$9=e$f([i$j("esri.views.2d.PaddedViewState.Padding")],c$9);let h$5=class extends U$1{constructor(...t){super(...t),this.paddedViewState=new U$1,this._updateContent=(()=>{const t=n$y();return ()=>{const e=this._get("size"),s=this._get("padding");if(!e||!s)return;const o=this.paddedViewState;r$i(t,s.left+s.right,s.top+s.bottom),o$m(t,e,t),a$F(o.size,t);const a=o.viewpoint;a&&(this.viewpoint=a);}})(),this.watch(["size","padding"],this._updateContent,!0),this.padding=new c$9,this.size=[0,0];}set padding(t){this._set("padding",t||new c$9);}set viewpoint(t){if(t){const e=t.clone();this.paddedViewState.viewpoint=t,bt(e,t,this._get("size"),this._get("padding"));const s=this._viewpoint2D,o=e.targetGeometry;s.center[0]=o.x,s.center[1]=o.y,s.rotation=e.rotation,s.scale=e.scale,s.spatialReference=o.spatialReference,this._update();}}};e$f([d$h()],h$5.prototype,"paddedViewState",void 0),e$f([d$h({type:c$9})],h$5.prototype,"padding",null),e$f([d$h()],h$5.prototype,"viewpoint",null),h$5=e$f([i$j("esri.views.2d.PaddedViewState")],h$5);const m$6=h$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const s$9=s=>-1!==s.indexOf("Brush");class e$5{constructor(){this._names=new Map;}begin(e){this._names.has(e)||(this._names.set(e,!1),s$9(e)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${e}.Start`));}end(s){this._names.has(s)&&!this._names.get(s)&&(this._names.set(s,!0),performance.mark(`Esri.${s}.End`));}record(s){this._names.has(s)||(this._names.set(s,!0),performance.mark(`Esri.${s}`));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const N$1=s$k.getLogger("esri.views.MapView");function q(t){return t&&"esri.Viewpoint"===t.declaredClass}const L$1=160;let A=class extends(a$n(P$1)){constructor(t){super(t),this._stationaryTimer=null,this.frameTask=new a$e(this),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.initialExtent=null,this.labelManager=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.resizeAlign="center",this.supportsGround=!1,this.timeline=new e$5,this.type="2d",this.constraints=new y$2,this.padding={top:0,right:0,bottom:0,left:0};const e=this.handles,i=()=>this.notifyChange("updating");e.add([this.watch("viewpoint",(()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(L$1);}),!0),this.on("resize",(t=>this._resizeHandler(t))),this.watch("animationManager.animation",(t=>{this.animation=t;})),this.allLayerViews.on("change",(()=>{i(),e.remove("map-view-base-layerViewsUpdating"),e.add(this.allLayerViews.map((t=>t.watch("updating",i))),"map-view-base-layerViewsUpdating");}))],"map-view-base");}destroy(){this.destroyed||(this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null);}set animation(t){const e=this._get("animation");if(t===e)return;if(e&&e.stop(),!t||t.isFulfilled())return void this._set("animation",null);this._set("animation",t),this.frameTask.animationInProgress=!0;const i=()=>{t===this._get("animation")&&(this._set("animation",null),this.frameTask.requestFrame()),this.frameTask.animationInProgress=!1;};t.when(i,i);}get center(){if(!this.ready)return this._get("center");const{center:t,spatialReference:e}=this.state.paddedViewState;return new b$a({x:t[0],y:t[1],spatialReference:e})}set center(t){if(null==t)return;if(!this._normalizeInput(t))return void N$1.error("#center",`incompatible spatialReference ${JSON.stringify(t.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`);if(!this.ready)return this._set("center",t),void this.notifyChange("initialExtentRequired");const e=this.viewpoint;wt(e,e,t),this.viewpoint=e;}set constraints(t){const e=this._get("constraints");e&&(this.handles.remove("map-view-base-constraints"),e.destroy()),this._set("constraints",t),t&&(t.view=this,this.ready&&(this.state.viewpoint=t.fit(this.state.paddedViewState.viewpoint)),this.handles.add(t.on("update",(()=>{this.ready&&this.state&&(this.state.viewpoint=t.fit(this.state.paddedViewState.viewpoint));})),"map-view-base-constraints"));}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(t){if(null==t)return;const e=this._normalizeInput(t);if(!e)return void N$1.error("#center",`incompatible spatialReference ${JSON.stringify(t.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`);if(!e.width||!e.height)return void N$1.error("#extent","invalid extent size");if(!this.ready)return this._set("extent",e),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");const i=this.viewpoint;tt(i,i,e,this.size,{constraints:this.constraints}),this.viewpoint=i;}get graphicsTileStore(){return new l$p(this.featuresTilingScheme)}get initialExtentRequired(){const{extent:t,center:e,scale:i,viewpoint:s,zoom:n}=this;return !this.get("map.initialViewProperties.viewpoint")&&(!t&&((!e||0===i&&-1===n)&&!s))}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(t){this.ready?(this.state.padding=t,this._set("padding",this.state.padding)):this._set("padding",t);}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(t){if(isNaN(t))return;if(!this.ready)return void this._set("rotation",t);const e=this.viewpoint;kt(e,e,t),this.viewpoint=e;}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(t){if(!t||isNaN(t))return;if(!this.ready){this._set("scale",t),this._set("zoom",-1);const e=this._get("extent");return e&&(this._set("extent",null),this._set("center",e.center)),void this.notifyChange("initialExtentRequired")}const e=this.viewpoint;Rt(e,e,t),this.viewpoint=e;}get stationary(){return !(this.animation||this.navigating||this._get("resizing")||this._stationaryTimer)}get updating(){return !this.destroyed&&(!0===this.get("layerViewManager.updating")||!0===this.get("labelManager.updating")||!0===this.get("graphicsView.updating")||this.allLayerViews.some((t=>!t.destroyed&&!("layerViews"in t)&&!0===t.updating)))}get viewpoint(){if(!this.ready)return this._get("viewpoint");const t=this.state.paddedViewState;return t&&t.viewpoint.clone()}set viewpoint(t){if(null==t)return;const i=this._normalizeInput(t);if(!i)return void(!t.scale||isNaN(t.scale)?N$1.error("#viewpoint",`invalid scale value of ${t.scale}`):t$j(t.targetGeometry)?N$1.error("#viewpoint","geometry not defined"):N$1.error("#viewpoint",`incompatible spatialReference ${JSON.stringify(t.targetGeometry.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`));if(!this.ready)return this._set("viewpoint",i),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");const s=new u$9({targetGeometry:new b$a,scale:0,rotation:0});Z(s,i),this.constraints.constrain(s,this.state.paddedViewState.viewpoint),this.state.viewpoint=s,this.frameTask.requestFrame(),this._set("viewpoint",s);}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(t){if(null==t)return;if(!this.ready){this.notifyChange("initialExtentRequired"),this._set("zoom",t),this._set("scale",0);const e=this._get("extent");e&&(this._set("extent",null),this._set("center",e.center));}if(!this.constraints.effectiveLODs)return;const e=this.viewpoint;Rt(e,e,this.constraints.zoomToScale(t)),this.viewpoint=e,this._set("zoom",this.constraints.scaleToZoom(this.scale));}goTo(t,e){if(t)return this.animation&&(this.animation=null),this._createAnimation(),d$o(this,"ready",e&&e.signal).then((()=>{const i={animate:!0,...e},s=ht(t,this);return this.animation.update(s),this._gotoTask={},i.animate?this._gotoAnimated(s,i):this._gotoImmediate(s,i)}));N$1.error("#goTo()","target cannot be null or undefined");}hitTest(t){return Promise.reject("Should be implemented by subclasses")}popupHitTest(t){return this.hitTest(t).then((e=>({...e,mapPoint:this.toMap(t)})))}toMap(t){if(!this.ready)return null;const e=[0,0],[i,s]=this.state.toMap(e,[t.x,t.y]),n=this.spatialReference;return new b$a({x:i,y:s,spatialReference:n})}isTileInfoRequired(){return !0}toScreen(t){if(!this.ready)return null;const e=this._normalizeInput(t),i=[e.x,e.y];return this.state.toScreen(i,i),c$D(i[0],i[1])}pixelSizeAt(){return this.ready?this.state.resolution:(N$1.error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}requestUpdate(){this.ready&&this.frameTask.requestUpdate();}getDefaultSpatialReference(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||null}isSpatialReferenceSupported(t,e){return !(!e&&!this._get("ready"))||null!==this._getDefaultViewpoint()}importLayerView(t){return l$7.importLayerView(t)}hasLayerViewModule(t){return l$7.hasLayerViewModule(t)}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new n$e),this.animation}_cancellableGoTo(t,e,i){const s=()=>t===this._gotoTask,n=i.then((()=>{s()&&(this.animation=null);})).catch((t=>{throw s()&&(this.animation=null,e.done||(e.stop(),this.frameTask.animationInProgress=!1)),t})),a=new Promise((t=>t(n)));return e.when().catch((()=>{s()&&a.cancel&&a.cancel();})),a}_gotoImmediate(t,e){const s=this._gotoTask,n=this.animation,a=t.then((t=>{if(h$h(e),s!==this._gotoTask)throw new s$l("view:goto-interrupted","Goto was interrupted");this.viewpoint=n.target=t,n.finish();}));return this._cancellableGoTo(s,n,a)}_gotoAnimated(t,e){const s=this._gotoTask,n=this.animation,a=t.then((t=>{if(h$h(e),s!==this._gotoTask)throw new s$l("view:goto-interrupted","Goto was interrupted");return n.update(t),this.animationManager.animate(n,this.viewpoint,e),n.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(s,n,a)}_resizeHandler(t){const e=this.state;if(!e)return;let i=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();e.size=[t.width,t.height],Gt(i,i,s,this.state.paddedViewState.size,this.resizeAlign),i=this.constraints.constrain(i,null),this.state.viewpoint=i;}_startup(){const t=this._getDefaultViewpoint();this.constraints.view=this,this.constraints.fit(t),this._set("animationManager",new d$5({view:this})),this._set("state",new m$6({padding:this._get("padding"),size:this.size,viewpoint:t})),this._set("featuresTilingScheme",new h$n(j$6.create({spatialReference:this.spatialReference,size:512,numLODs:36}))),this._set("ready",!0),this.frameTask&&this.frameTask.start();}_teardown(){this.frameTask&&this.frameTask.stop(),this._set("ready",!1),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null);const{center:[t,e],spatialReference:i,rotation:s,scale:n}=this.state.paddedViewState,a=new b$a({x:t,y:e,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",a),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("spatialReference",i),this.constraints.view=null,this.animationManager.destroy(),this._set("animationManager",null),this._set("state",null),this.animation=null;}_flipStationary(t){return null!==this._stationaryTimer||(this._stationaryTimer=setTimeout((()=>{this._stationaryTimer=null;const t=performance.now()-this._lastStationaryEventTimestamp;t<L$1&&(this._stationaryTimer=this._flipStationary(t));}),t)),this._stationaryTimer}_normalizeInput(t,e=this.spatialReference){const i=t&&t.targetGeometry||t;return e?i?e.equals(i.spatialReference)?t:g$h(i,e)?q(t)?(t.targetGeometry=M$5(i,e),t):M$5(i,e):null:null:t}_getDefaultViewpoint(){const t=this.constraints,i={zoom:this._get("zoom"),scale:this._get("scale"),center:this._normalizeInput(this._get("center")),extent:this._normalizeInput(this._get("extent")),rotation:this._get("rotation"),viewpoint:this._normalizeInput(this._get("viewpoint")),spatialReference:this._userSpatialReference};t.effectiveLODs?-1!==i.zoom&&(i.scale=t.zoomToScale(i.zoom)):i.zoom=-1;let s=null,n=null,r=0;const o=i.viewpoint&&i.viewpoint.rotation,l=i.viewpoint&&i.viewpoint.targetGeometry;r$g(l)&&("extent"===l.type?s=l:"point"===l.type&&(n=l,r=i.viewpoint.scale));const p=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent")),h=this._normalizeInput(this.initialExtent),d=i.extent||s||p||h,m=i.center||n||d&&d.center,c=this.get("map.initialViewProperties.viewpoint.scale"),u=i.scale||r||c||d&&J(d,this.size),g=this.get("map.initialViewProperties.viewpoint.rotation"),y=i.rotation||o||g||0;return m&&u?new u$9({targetGeometry:m,scale:u,rotation:y}):null}};e$f([d$h()],A.prototype,"_stationaryTimer",void 0),e$f([d$h()],A.prototype,"animation",null),e$f([d$h({readOnly:!0})],A.prototype,"animationManager",void 0),e$f([d$h({value:null,type:b$a,dependsOn:["state.id","ready"]})],A.prototype,"center",null),e$f([d$h({type:y$2})],A.prototype,"constraints",null),e$f([d$h({value:null,type:M$6,dependsOn:["state.id","ready"]})],A.prototype,"extent",null),e$f([d$h({readOnly:!0})],A.prototype,"featuresTilingScheme",void 0),e$f([d$h()],A.prototype,"fullOpacity",void 0),e$f([d$h({readOnly:!0})],A.prototype,"graphicsTileStore",null),e$f([d$h()],A.prototype,"graphicsView",void 0),e$f([d$h({type:M$6})],A.prototype,"initialExtent",void 0),e$f([d$h({dependsOn:["map.initialViewProperties?.viewpoint"]})],A.prototype,"initialExtentRequired",null),e$f([d$h()],A.prototype,"labelManager",void 0),e$f([d$h({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],A.prototype,"padding",null),e$f([d$h({type:Object})],A.prototype,"renderingOptions",void 0),e$f([d$h()],A.prototype,"resizeAlign",void 0),e$f([d$h({readOnly:!0,dependsOn:["state.id"]})],A.prototype,"resolution",null),e$f([d$h({value:0,type:Number,dependsOn:["state.id","ready"]})],A.prototype,"rotation",null),e$f([d$h({value:0,type:Number,dependsOn:["state.id","ready"]})],A.prototype,"scale",null),e$f([d$h({type:k$3,dependsOn:["map.initialViewProperties?.spatialReference","defaultsFromMap.isSpatialReferenceDone"]})],A.prototype,"spatialReference",void 0),e$f([d$h({readOnly:!0})],A.prototype,"state",void 0),e$f([d$h({dependsOn:["animation","navigating","resizing","_stationaryTimer"]})],A.prototype,"stationary",null),e$f([d$h({readOnly:!0})],A.prototype,"supportsGround",void 0),e$f([d$h({type:e$5,readOnly:!0})],A.prototype,"timeline",void 0),e$f([d$h({readOnly:!0})],A.prototype,"type",void 0),e$f([d$h({readOnly:!0,dependsOn:["layerViewManager.updating","labelManager.updating","graphicsView?.updating"]})],A.prototype,"updating",null),e$f([d$h({value:null,type:u$9,dependsOn:["state.id","ready"]})],A.prototype,"viewpoint",null),e$f([d$h({value:-1,dependsOn:["state.id"]})],A.prototype,"zoom",null),A=e$f([i$j("esri.views.MapViewBase")],A);const U=A;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function t$6(t,r){switch(r){case"primary":return "touch"===t.pointerType||0===t.button;case"secondary":return "touch"!==t.pointerType&&2===t.button;case"tertiary":return "touch"!==t.pointerType&&1===t.button}}function r$3(t,r){if("touch"===t.pointerType)return !1;switch(r){case"primary":return 0===t.button;case"secondary":return 2===t.button;case"tertiary":return 1===t.button}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class a$9 extends i$e{constructor(t,i){super(!0),this.view=t,this.registerIncoming("double-click",i,(t=>this._handleDoubleClick(t,i)));}_handleDoubleClick(t,a){t$6(t.data,"primary")&&(t.stopPropagation(),a?this.view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this.view.mapViewNavigation.zoomIn([t.data.x,t.data.y]));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class e$4 extends i$e{constructor(t,e,a){super(!0),this.view=t,this.pointerType=e,this.registerIncoming("double-tap-drag",a,(t=>this._handleDoubleTapDrag(t)));}_handleDoubleTapDrag(t){const{data:e}=t,{pointerType:a}=e;if(a!==this.pointerType)return;t.stopPropagation();const{action:s,delta:i}=e,{view:r}=this,{mapViewNavigation:n}=r;switch(s){case"begin":{const{scale:t}=r;this._startScale=t,this._currentScale=t,this._previousDelta=i,n.begin();break}case"update":{if(this._previousDelta.y===i.y)return;this._previousDelta=i;const t=1.015**i.y,e=this._startScale*t,a=e/this._currentScale;n.setViewpointImmediate(a),this._currentScale=e;break}case"end":{const{constraints:t}=r,{effectiveLODs:e,snapToZoom:a}=t;if(!a||!e)return void n.end();const s=t.snapScale(this._currentScale),o=(i.y>0?Math.max(s,t.snapToPreviousScale(this._startScale)):Math.min(s,t.snapToNextScale(this._startScale)))/this._currentScale;n.zoom(o);break}}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class t$5{constructor(t){this.callbacks=t,this.currentCount=0,this.callbacks.condition||(this.callbacks.condition=()=>!0);}handle(t){const s=t.data,i=s.pointers.size;switch(s.action){case"start":this.currentCount=i,this.emitStart(t);break;case"added":this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"update":this.emitUpdate(t);break;case"removed":this.startEvent&&this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"end":this.emitEnd(t),this.currentCount=0;}this.previousEvent=t;}emitStart(t){this.startEvent=t,this.callbacks.condition(this.currentCount,t)&&this.callbacks.start(this.currentCount,t,this.startEvent);}emitUpdate(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.update(this.currentCount,t,this.startEvent);}emitEnd(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.end(this.currentCount,t,this.startEvent),this.startEvent=null;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class n$9 extends i$e{constructor(i,n,o){super(!0),this.view=i,this.pointerAction=n,this.registerIncoming("drag",o,(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()));const e=this.view.mapViewNavigation;this.dragEventSeparator=new t$5({start:(t,i)=>{e.pan.begin(this.view,i.data),i.stopPropagation();},update:(t,i)=>{e.pan.update(this.view,i.data),i.stopPropagation();},end:(t,i)=>{e.pan.end(this.view,i.data),i.stopPropagation();},condition:(t,i)=>1===t&&t$6(i.data,this.pointerAction)});}_handleDrag(t){const i=this.view.mapViewNavigation;i.pinch.zoomMomentum||i.pinch.rotateMomentum?this.stopMomentumNavigation():this.dragEventSeparator.handle(t);}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class o$5 extends i$e{constructor(a,o,r){super(!0),this.view=a,this.pointerAction=o;const e=this.view.mapViewNavigation;this.dragEventSeparator=new t$5({start:(t,a)=>{e.rotate.begin(this.view,a.data),a.stopPropagation();},update:(t,a)=>{e.rotate.update(this.view,a.data),a.stopPropagation();},end:(t,a)=>{e.rotate.end(),a.stopPropagation();},condition:(t,a)=>1===t&&t$6(a.data,this.pointerAction)}),this.registerIncoming("drag",r,(t=>this.dragEventSeparator.handle(t)));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function n$8(t){let n=t*t;return t<0&&(n*=-1),n}function a$8(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function i$5(a,i,o){const s=o,e=a.state,r=a.device,l="forward-down"===i.tiltDirection?1:-1,c=1;return "standard"===r.deviceType?(s.translation[0]=n$8(e.axes[0]),s.translation[1]=n$8(e.axes[1]),s.translation[2]=n$8(e.buttons[7])-n$8(e.buttons[6]),s.heading=n$8(e.axes[2]),s.tilt=n$8(e.axes[3])):"spacemouse"===r.deviceType&&(s.translation[0]=1.2*n$8(e.axes[0]),s.translation[1]=1.2*n$8(e.axes[1]),s.translation[2]=2*-n$8(e.axes[2]),s.heading=1.2*n$8(e.axes[5]),s.tilt=1.2*n$8(e.axes[3])),s.tilt*=l,d$p(s.translation,s.translation,c),s}function o$4(t,n){const a=n;return a.translation[0]=t[1]-t[0],a.translation[1]=t[3]-t[2],a.translation[2]=t[4]-t[5],a.heading=t[7]-t[6],a.tilt=t[8]-t[9],a.zoom=t[10]-t[11],a}function s$8(t){return 0===t.translation[0]&&0===t.translation[1]&&0===t.translation[2]&&0===t.heading&&0===t.tilt&&0===t.zoom}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class l$6 extends i$e{constructor(i){super(!0),this.view=i,this.frameTask=null,this.watchHandles=new u$j,this.currentDevice=null,this.transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this.handle=this.registerIncoming("gamepad",(t=>this.handleEvent(t))),this.handle.pause();}onInstall(t){super.onInstall(t),this.watchHandles.add([i$l(this.view.navigation.gamepad,"enabled",(t=>{t?(this.handle.resume(),this.frameTask||(this.frameTask=A$5({update:t=>this.frameUpdate(t.deltaTime)}))):(this.handle.pause(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null));}))]);}onUninstall(){this.watchHandles.removeAll(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null),super.onUninstall();}handleEvent(t){const i=this.view.navigation.gamepad.device;i&&t.data.device!==i||this.currentDevice&&this.currentDevice!==t.data.device||("end"===t.data.action?(this.currentDevice=null,a$8(this.transformation)):(this.currentDevice=t.data.device,i$5(t.data,this.view.navigation.gamepad,this.transformation)));}frameUpdate(t){const i=this.transformation;if(s$8(i))return;const e=this.view.viewpoint.clone(),n=this.view.navigation.gamepad.velocityFactor,r=m$5*n*t;Ft(e,e,[i.translation[0]*r,-i.translation[1]*r]);const o=1+i.translation[2]*c$8*t,l=this.view.constraints.rotationEnabled?-i.heading*d$4*t:0,v=this.view.size,p=[v[0]/2,v[1]];St(e,e,o,l,p,v);const f=this.view.constraints.constrain(e,this.view.viewpoint);this.view.viewpoint=f;}}const d$4=.06,m$5=.7,c$8=6e-4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class i$4 extends i$e{constructor(e,i,t){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyMap={[i.left]:"left",[i.right]:"right",[i.up]:"up",[i.down]:"down"},this.registerIncoming("key-down",t,(e=>this._handleKeyDown(e))),this.registerIncoming("key-up",t,(e=>this._handleKeyUp(e))),this.registerIncoming("blur",t,(()=>this._handleBlur()));}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0);}_handleKeyUp(e){this._handleKey(e,!1);}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop());}_handleKey(e,i){const t=this._keyMap[e.data.key];if(this._pressed=null!=t,this._pressed){if(i)switch(this.view.mapViewNavigation.begin(),t){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown();}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class i$3 extends i$e{constructor(e,i,t){super(!0),this.view=e,this.keys=i,this._pressed=!1,this._keyToDirection={[i.clockwiseOption1]:"clockwise",[i.clockwiseOption2]:"clockwise",[i.counterClockwiseOption1]:"counterClockwise",[i.counterClockwiseOption2]:"counterClockwise",[i.resetOption1]:"reset",[i.resetOption2]:"reset"},this.registerIncoming("key-down",t,(e=>this._handleKeyDown(e))),this.registerIncoming("key-up",t,(e=>this._handleKeyUp(e))),this.registerIncoming("blur",t,(()=>this._handleBlur()));}_handleKeyDown(e){e.data.repeat||this._handleKey(e,!0);}_handleKeyUp(e){this._handleKey(e,!1);}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop());}_handleKey(e,i){const t=e.modifiers;if(t.size>0&&!t.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection[e.data.key];if(this._pressed=null!=s,this._pressed){if(i)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation();}else this._pressed=!1,this.view.mapViewNavigation.stop();e.stopPropagation();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class t$4 extends i$e{constructor(o,t,e){super(!0),this.view=o,this.keys=t,this._keysToZoomAction={},this.registerIncoming("key-down",e,(o=>this._handleKeyDown(o))),t.zoomIn.forEach((o=>this._keysToZoomAction[o]=0)),t.zoomOut.forEach((o=>this._keysToZoomAction[o]=1));}_handleKeyDown(o){this._handleKey(o);}_handleKey(o){const t=o.modifiers;if(t.size>0&&!t.has("Shift"))return;const{key:e}=o.data;if(!(e in this._keysToZoomAction))return;const i=this._keysToZoomAction[e],{mapViewNavigation:s}=this.view;let n=null;switch(i){case 0:n=s.zoomIn();break;case 1:n=s.zoomOut();break;default:return}s.begin(),n.then((()=>s.end())),o.stopPropagation();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const t$3=.6;class o$3 extends i$e{constructor(e,t){super(!0),this.view=e,this._canZoom=!0,this.registerIncoming("mouse-wheel",t,(e=>this._handleMouseWheel(e)));}_handleMouseWheel(e){if(!this.view.navigation.mouseWheelZoomEnabled)return;if(e.preventDefault(),e.stopPropagation(),!this._canZoom)return;const o=this.view.mapViewNavigation,{x:n,y:i,deltaY:s}=e.data,a=1/t$3**(1/60*s),h=o.zoom(a,[n,i]);h&&(this._canZoom=!1,h.catch((()=>{})).then((()=>{this._canZoom=!0,o.end();})));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class a$7 extends i$e{constructor(i){super(!0),this.view=i,this.registerIncoming("drag",(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()));const a=this.view.mapViewNavigation;this.dragEventSeparator=new t$5({start:(t,i)=>{a.pinch.begin(this.view,i.data),i.stopPropagation();},update:(t,i)=>{a.pinch.update(this.view,i.data),i.stopPropagation();},end:(t,i)=>{a.pinch.end(this.view),i.stopPropagation();},condition:t=>t>=2});}_handleDrag(t){this.dragEventSeparator.handle(t);}stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function t$2(t){const n=t.native;return n?{buttons:n.buttons.map((t=>t.pressed?t.value?t.value:1:0)),axes:n.axes.map((n=>s$7(n,t.axisThreshold)))}:{buttons:[],axes:[]}}function n$7(t,n){if(t.axes.length!==n.axes.length)return !1;if(t.buttons.length!==n.buttons.length)return !1;for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==n.axes[e])return !1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==n.buttons[e])return !1;return !0}function e$3(t){for(let n=0;n<t.axes.length;n++)if(0!==t.axes[n])return !1;for(let n=0;n<t.buttons.length;n++)if(0!==t.buttons[n])return !1;return !0}function s$7(t,n){const e=Math.abs(t);return e<n?0:Math.sign(t)*(e-n)/(1-n)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class a$6{constructor(e,t){this.element=e,this.input=t,this._hasEventListeners=!1,this.onConnectGamepad=e=>{this.connectGamepad(e.gamepad);},this.onDisconnectGamepad=e=>{const t=e.gamepad,i=t.index,n=this.inputDevices[i];n&&(this.emitGamepadEvent(t,t$2(n),!1),this.inputDevices.splice(i,1),this.latestUpdate.splice(i,1),this.input.gamepad.devices.remove(n),this.ensurePollingState());},this.frameTask=null,this.latestUpdate=new Array,this.inputDevices=new Array,this.callback=null;const i="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=i&&n,this.supported&&(this.forEachGamepad((e=>this.connectGamepad(e))),window.addEventListener("gamepadconnected",this.onConnectGamepad),window.addEventListener("gamepaddisconnected",this.onDisconnectGamepad),this.ensurePollingState());}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this.onConnectGamepad),window.removeEventListener("gamepaddisconnected",this.onDisconnectGamepad));}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState());}get eventsEnabled(){return this.supported&&this.inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this.callback=e;}connectGamepad(e){const s=new i$8(e);"unknown"!==s.deviceType&&(this.inputDevices[e.index]=s,this.input.gamepad.devices.add(s)),this.ensurePollingState();}ensurePollingState(){this.eventsEnabled?this.startPolling():this.stopPolling();}startPolling(){null==this.frameTask&&(this.frameTask=A$5({update:()=>this.readGamepadState()}));}stopPolling(){null!=this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=new Array);}readGamepadState(){const e=document.hasFocus(),t=this.element.contains(document.activeElement),a="document"===this.input.gamepad.enabledFocusMode&&!e||"view"===this.input.gamepad.enabledFocusMode&&!t;this.forEachGamepad((e=>{const t=this.inputDevices[e.index];if(!t)return;const d=this.latestUpdate[e.index],o=t$2(t),r=a||e$3(o);if(d){if(d.timestamp===e.timestamp)return;if(!d.active&&r)return;if(n$7(d.state,o))return}this.emitGamepadEvent(e,o,!r);}));}forEachGamepad(e){const t=window.navigator.getGamepads();for(let s=0;s<t.length;s++){const i=t[s];this.validate(i)&&e(i);}}emitGamepadEvent(e,t,s){const i=this.latestUpdate[e.index],n=i&&i.active;if(!n&&!s)return;const a=!n&&s?"start":n&&s?"update":"end";this.latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:s},this.callback&&this.callback({device:this.inputDevices[e.index],state:t,action:a});}validate(e){if(!e)return !1;if(!e.connected)return !1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return !1;return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const o$2=s$q("trident"),a$5=s$q("edge"),s$6=s$q("chrome"),r$2=s$q("ff"),h$4=s$q("safari"),l$5={touchNone:"esri-view-surface--touch-none",touchPan:"esri-view-surface--touch-pan"};class u$4{constructor(e,t){this.input=t,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new a$6(e,this.input),this._gamepadSource.onEvent=e=>this._callback("gamepad",e);}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach((e=>{this._releasePointerCaptureSafe(e);})),this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=null),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault);}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling();}set onEventReceived(e){this._callback=e;}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const e=this._active[t];this._element.removeEventListener(c$7[t],e),delete this._active[t];}e&&e.forEach((e=>{if(!this._active[e]&&c$7[e]){const t=(this._eventHandlers[e]||this._handleDefault).bind(this,e);this._element.addEventListener(c$7[e],t),this._active[e]=t;}})),this._gamepadSource.hasEventListeners=e&&e.has("gamepad");}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId));}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?l$5.touchNone:l$5.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?l$5.touchPan:l$5.touchNone);}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning);}_removeTouchAction(){this._element.classList.remove(l$5.touchNone),this._element.classList.remove(l$5.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning);}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e);}catch(t){}}_updateNormalizedPointerLikeEvent(e,t){const n=n$g(this._element,e);return u$4.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),t.x=n.x,t.y=n.y,t}_handleKey(e,n){const i=a$r(n);i&&"key-up"===e&&this._keyDownState.delete(i);const o={native:n,key:i,repeat:i&&this._keyDownState.has(i)};i&&"key-down"===e&&this._keyDownState.add(o.key),this._callback(e,o);}_handlePointer(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,n);}_handlePointerPreventDefault(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,n);}_handleMouseWheel(e,t){let n=t.deltaY;switch(t.deltaMode){case 0:(o$2||a$5)&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900;}o$2||a$5?n*=.7:s$6||h$4?n*=.6:r$2&&(n*=1.375);const i=100,l=Math.abs(n);if(l>i){const e=.02;n=n/l*200/(1+Math.exp(-e*(l-i)));}const u=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:n});this._callback(e,u);}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t);}_handleDefault(e,t){const n={native:t};t.preventDefault(),this._callback(e,n);}_preventAltKeyDefault(e){"Alt"===e.key&&e.preventDefault();}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault();}}u$4.test={disableSubpixelCoordinates:!1};const c$7={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class e$2 extends i$e{constructor(){super(!0),this.registerIncoming("context-menu",(t=>{t.data.native.preventDefault();}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function e$1(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function n$6(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function r$1(e,n){if(n?(n.radius=0,n.center.x=0,n.center.y=0):n={radius:0,center:c$D()},0===e.length)return n;if(1===e.length)return n.center.x=e[0].x,n.center.y=e[0].y,n;if(2===e.length){const[t,r]=e,[c,s]=[r.x-t.x,r.y-t.y];return n.radius=Math.sqrt(c*c+s*s)/2,n.center.x=(t.x+r.x)/2,n.center.y=(t.y+r.y)/2,n}let r=0,c=0;for(let t=0;t<e.length;t++)r+=e[t].x,c+=e[t].y;r/=e.length,c/=e.length;const s=e.map((t=>t.x-r)),x=e.map((t=>t.y-c));let o=0,y=0,a=0,h=0,l=0,u=0,i=0;for(let t=0;t<s.length;t++){const e=s[t],n=x[t],r=e*e,c=n*n;o+=r,y+=c,a+=e*n,h+=r*e,l+=c*n,u+=e*c,i+=n*r;}const f=.5*(h+u),g=.5*(l+i),M=o*y-a*a,d=(f*y-g*a)/M,m=(o*g-a*f)/M,p=c$D(d+r,m+c);return {radius:Math.sqrt(d*d+m*m+(o+y)/e.length),center:p}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const l$4={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};class s$5 extends i$e{constructor(t=l$4.maximumDoubleClickDelay,i=l$4.maximumDoubleClickDistance,o=l$4.maximumDoubleTouchDelay,s=l$4.maximumDoubleTouchDistance,u=o$o){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=i,this.maximumDoubleTouchDelay=o,this.maximumDoubleTouchDistance=s,this._clock=u,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("drag",this._handleDrag.bind(this));}onUninstall(){this._pointerState.forEach((e=>{null!=e.doubleClickTimeout&&(e.doubleClickTimeout.remove(),e.doubleClickTimeout=null);}));}get hasPendingInputs(){return n$w(this._pointerState,(e=>null!=e.doubleClickTimeout))}_pointerId(e){const t=e.native;return "mouse"===t.pointerType?`${t.pointerId}:${t.button}`:`${t.pointerType}`}_handleImmediateClick(e){const t=e.data,i=this._pointerId(t),l=this._pointerState.get(i);if(l){const s="touch"===t.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;e$1(l.event.data,t)>s?(this._clearDoubleClickTimeout(i,!0),this._startClick(e)):(this._clearDoubleClickTimeout(i,!1),this._doubleClick.emit(l.event.data,void 0,l.event.modifiers));}else this._startClick(e);}_startClick(e){const t=this._pointerId(e.data),i="touch"===e.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;this._pointerState.set(t,{event:e,doubleClickTimeout:this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(t)),i)}),this.refreshHasPendingInputs();}_handlePointerDrag(e){const t=this._pointerId(e.data.currentEvent);this._clearDoubleClickTimeout(t,!0);}_handleDrag(e){const t=this._pointerId(e.data.pointer);this._clearDoubleClickTimeout(t,!0);}_clearDoubleClickTimeout(e,t){const i=this._pointerState.get(e);i&&(i.doubleClickTimeout.remove(),i.doubleClickTimeout=null,t&&this._doubleClickTimeoutExceeded(e),this._pointerState.delete(e),this.refreshHasPendingInputs());}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimeout=null,this._pointerState.delete(e),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class s$4 extends i$e{constructor(e=l$4.maximumDoubleClickDelay,o=l$4.maximumDoubleClickDistance,n=l$4.maximumDoubleTouchDelay,s=l$4.maximumDoubleTouchDistance,u=o$o){super(!1),this.maximumDoubleClickDelay=e,this.maximumDoubleClickDistance=o,this.maximumDoubleTouchDelay=n,this.maximumDoubleTouchDistance=s,this._clock=u,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=c$D(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new t$5({start:(t,e)=>this._dragStart(t,e),update:(t,e)=>this._dragUpdate(e),end:(t,e)=>this._dragEnd(e)}),this.registerIncoming("drag",(t=>this._dragEventSeparator.handle(t))),this.registerIncoming("pointer-down",(t=>this._handlePointerDown(t))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()));}onUninstall(){this._pointerState.forEach((t=>{null!=t.doubleTapTimeout&&(t.doubleTapTimeout.remove(),t.doubleTapTimeout=null);}));}get hasPendingInputs(){return n$w(this._pointerState,(t=>null!=t.doubleTapTimeout))}_clearPointerDown(t){const e=this._pointerState.get(t);e&&(e.doubleTapTimeout.remove(),e.doubleTapTimeout=null,this._pointerState.delete(t),this.refreshHasPendingInputs());}_createDoubleTapDragData(t,e,i){const{button:a,buttons:o,pointer:r,pointers:n,pointerType:s,timestamp:u}=i;return {action:t,delta:e,button:a,buttons:o,pointer:r,pointers:n,pointerType:s,timestamp:u}}_dragStart(t,e){if(!this._doubleTapDragReady||1!==t)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:a,modifiers:o}=e,{center:r}=a;this._dragStartCenter=r;const n=this._createDoubleTapDragData("begin",c$D(0,0),a);this._doubleTapDrag.emit(n,void 0,o),e.stopPropagation();}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:a}=t,{center:o}=e,r=c$D(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),n=this._createDoubleTapDragData("update",r,e);this._doubleTapDrag.emit(n,void 0,a),t.stopPropagation();}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:a}=t,{center:o}=e,r=c$D(o.x-this._dragStartCenter.x,o.y-this._dragStartCenter.y),n=this._createDoubleTapDragData("end",r,e);this._doubleTapDrag.emit(n,void 0,a),this._doubleTapDragActive=!1,t.stopPropagation();}_handlePointerDown(t){const{data:e}=t,i=this._pointerId(e),a=this._pointerState.get(i),{pointerType:o}=e.native;if(a){const r="touch"===o?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;this._clearPointerDown(i),e$1(a.event.data,e)>r?this._storePointerDown(t):this._doubleTapDragReady=!0;}else this._storePointerDown(t);}_handlePointerUp(){this._doubleTapDragReady=!1;}_pointerId(t){const{native:e}=t,{pointerId:i,button:a,pointerType:o}=e;return "mouse"===o?`${i}:${a}`:`${o}`}_storePointerDown(t){const{data:e}=t,{pointerType:i}=e.native,a=this._pointerId(e),o="touch"===i?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay,r=this._clock.setTimeout((()=>this._clearPointerDown(a)),o);this._pointerState.set(a,{event:t,doubleTapTimeout:r}),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class s$3 extends i$e{constructor(t){super(!1),this.navigationTouch=t,this.startStateModifiers=new Set,this.activePointerMap=new Map,this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this.handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this.handlePointerUpAndPointerLost.bind(this));}createPayload(t,e,i,n){return {action:t,pointerType:this.pointerType,button:this.mouseButton,buttons:e.buttons,timestamp:n,pointers:o$1(this.activePointerMap),pointer:e,angle:i.angle,radius:i.radius,center:i.center}}addPointer(t){const e=t.native.pointerId,i=a$4(this.activePointerMap).angle,n={event:t,initialAngle:0,lastAngle:0};this.activePointerMap.set(e,n);const s=h$3(n,r(this.activePointerMap));n.initialAngle=s,n.lastAngle=s,this.updatePointerAngles(i);}updatePointer(t){if(t&&null==t.x&&null==t.y)return;const e=t.native.pointerId,i=this.activePointerMap.get(e);i?i.event=t:this.addPointer(t);}removePointer(t){const e=a$4(this.activePointerMap).angle;this.activePointerMap.delete(t),this.updatePointerAngles(e);}updatePointerAngles(t){const e=a$4(this.activePointerMap);this.activePointerMap.forEach((i=>{i.initialAngle=h$3(i,e)-t,i.lastAngle=h$3(i,e)-t;}));}emitEvent(t,e,i){const n=a$4(this.activePointerMap);this.drag.emit(this.createPayload(t,e,n,i),void 0,this.startStateModifiers);}handlePointerUpAndPointerLost(t){const i=t.data.native.pointerId,n=n$B(t.timestamp);this.activePointerMap.get(i)&&(1===this.activePointerMap.size?(this.updatePointer(t.data),!this.isCurrentDragSuppressed&&this.emitEvent("end",t.data,n),this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.removePointer(i)):(this.removePointer(i),this.emitEvent("removed",t.data,n$B(t.timestamp))));}handlePointerDrag(t){const i=t.data,n=i.currentEvent,s=n$B(t.timestamp);switch(i.action){case"start":case"update":this.isDragging?this.activePointerMap.has(n.native.pointerId)?(this.updatePointer(n),!this.isCurrentDragSuppressed&&this.emitEvent("update",n,s)):(this.addPointer(n),this.emitEvent("added",n,s),this.isCurrentDragSuppressed=this.isSuppressed):(this.updatePointer(n),this.pointerType=t.data.startEvent.pointerType,this.mouseButton=t.data.startEvent.button,this.startStateModifiers=t.modifiers,this.isDragging=!0,this.isCurrentDragSuppressed=this.isSuppressed,!this.isCurrentDragSuppressed&&this.emitEvent("start",n,s));}}get isSuppressed(){return this.navigationTouch&&!this.navigationTouch.browserTouchPanEnabled&&"touch"===this.pointerType&&1===this.activePointerMap.size}}function r(e){const i=[];return e.forEach((e=>{i.push(c$D(e.event.x,e.event.y));})),r$1(i)}function a$4(t){const e=r(t);let i=0;return t.forEach((t=>{let n=h$3(t,e),s=n-t.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=t.lastAngle+s,t.lastAngle=n;const r=n-t.initialAngle;i+=r;})),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function o$1(t){const e=new Map;return t.forEach(((t,i)=>e.set(i,t.event))),e}function h$3(t,e){const i=t.event,n=i.x-e.center.x,s=i.y-e.center.y;return Math.atan2(s,n)}var p$6;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined";}(p$6||(p$6={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class n$5 extends i$e{constructor(e=l$4.maximumDoubleClickDelay,o=l$4.maximumDoubleClickDistance,n=l$4.maximumDoubleTouchDelay,a=l$4.maximumDoubleTouchDistance,s=o$o){super(!1),this.maximumDoubleClickDelay=e,this.maximumDoubleClickDistance=o,this.maximumDoubleTouchDelay=n,this.maximumDoubleTouchDistance=a,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up");})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost");})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel");}));}onUninstall(){this._pointerState.forEach((t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove();})),super.onUninstall();}_handlePointerDown(t){const e=t.data,i=this._pointerId(e);if(!this._pointerState.has(i)){const t={downButton:e.native.button,immediateDoubleClick:null};this._pointerState.set(i,t),this.startCapturingPointer(e.native);}}_handlePointerLoss(t,e){const i=t.data,n=this._pointerId(i),a=this._pointerState.get(n);if(a&&"pointer-up"===e&&a.downButton===i.native.button){const e=a.immediateDoubleClick;if(e){e.timeoutHandle.remove();const n="touch"===t.data.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;e$1(e,t.data)>n?this._startImmediateDoubleClick(t,a):(this._immediateDoubleClick.emit(t.data,void 0,e.modifiers),this._removeState(i));}else this._startImmediateDoubleClick(t,a);}}_startImmediateDoubleClick(t,e){const i="touch"===t.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;e.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(t.data)),i)};}_pointerId(t){const e=t.native;return "mouse"===e.pointerType?`${e.pointerId}:${e.button}`:`${e.pointerType}`}_removeState(t){const e=this._pointerId(t);this._pointerState.delete(e),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const n$4={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};class o extends i$e{constructor(e=n$4.maximumClickDelay,i=n$4.movementUntilMouseDrag,o=n$4.movementUntilPenDrag,r=n$4.movementUntilTouchDrag,s=n$4.holdDelay,a=o$o){super(!1),this.maximumClickDelay=e,this.movementUntilMouseDrag=i,this.movementUntilPenDrag=o,this.movementUntilTouchDrag=r,this.holdDelay=s,this._clock=a,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up");})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost");})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel");})),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause();}onUninstall(){this._pointerState.forEach((t=>{null!=t.holdTimeout&&(t.holdTimeout.remove(),t.holdTimeout=null);})),super.onUninstall();}_handlePointerDown(t){const e=t.data,i=e.native.pointerId;let n=null;0===this._pointerState.size&&(n=this._clock.setTimeout((()=>{const e=this._pointerState.get(i);if(e){if(!e.isDragging){const i=e.previousEvent;this._pointerHold.emit(i,void 0,t.modifiers),e.holdEmitted=!0;}e.holdTimeout=null;}}),this.holdDelay));const o={startEvent:e,previousEvent:e,startTimestamp:t.timestamp,isDragging:!1,downButton:e.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(i,o),this.startCapturingPointer(e.native),this._moveHandle.resume(),this._pointerState.size>1&&this.startDragging(t);}_createPointerDragData(t,e,i){return {action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}_handlePointerMove(t){const e=t.data,n=e.native.pointerId,o=this._pointerState.get(n);if(o){if(o.isDragging)this._pointerDrag.emit(this._createPointerDragData("update",o,e),void 0,o.modifiers);else {n$6(e,o.startEvent)>this._getDragThreshold(e.native.pointerType)&&this.startDragging(t);}o.previousEvent=e;}}_getDragThreshold(t){switch(t){case"touch":return this.movementUntilTouchDrag;case"pen":return this.movementUntilPenDrag;default:return this.movementUntilMouseDrag}}startDragging(t){const e=t.data,i=e.native.pointerId;this._pointerState.forEach((n=>{null!=n.holdTimeout&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=t.modifiers,n.isDragging=!0,i===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,e)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),t.timestamp));}));}_handlePointerLoss(t,e){const i=t.data,n=i.native.pointerId,o=this._pointerState.get(n);if(o){if(null!=o.holdTimeout&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging)this._pointerDrag.emit(this._createPointerDragData("end",o,"pointer-up"===e?i:o.previousEvent),void 0,o.modifiers);else if("pointer-up"===e&&o.downButton===i.native.button){t.timestamp-o.startTimestamp<=this.maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(i);}this._pointerState.delete(n),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const k$1={counter:"Ctrl",pan:{left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},zoom:{zoomIn:["=","+"],zoomOut:["-","_"]},rotate:{clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"}};let C$2=class extends p$u{constructor(){super(...arguments),this._handles=new u$j;}initialize(){this._handles.add([m$q(this.view,"ready",(()=>this._disconnect())),s$s(this.view,"ready",(()=>this._connect()))]);}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect();}_disconnect(){this._inputManager&&(this.view.viewEvents.disconnect(),this._inputManager.destroy(),this._inputManager=null,this._source.destroy(),this._source=null);}_connect(){const e=this.view.surface,o$1=new u$4(e,this.view.input),r=[new n$5,new o,new s$5,new s$3(this.view.navigation),new s$4],t=new d$a({eventSource:o$1,recognizers:r});t.installHandlers("prevent-context-menu",[new e$2],u$d.INTERNAL),t.installHandlers("navigation",[new a$7(this.view),new l$6(this.view),new o$3(this.view),new a$9(this.view),new a$9(this.view,[k$1.counter]),new n$9(this.view,"primary"),new i$4(this.view,k$1.pan),new t$4(this.view,k$1.zoom),new i$3(this.view,k$1.rotate),new o$5(this.view,"secondary"),new e$4(this.view,"touch")],u$d.INTERNAL),this.view.viewEvents.connect(t),this._source=o$1,this._inputManager=t,i$l(this.view.navigation,"browserTouchPanEnabled",(e=>{this._source.browserTouchPanningEnabled=!e;}));}get test(){return {inputManager:this._inputManager}}};e$f([d$h()],C$2.prototype,"view",void 0),C$2=e$f([i$j("esri.views.2d.input.MapViewInputManager")],C$2);const E$1=C$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let p$5=0,i$2=class extends p$u{constructor(){super(...arguments),this.color=new h$i([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25;}get version(){return p$5++}};e$f([d$h({readOnly:!0})],i$2.prototype,"version",null),e$f([d$h({type:h$i})],i$2.prototype,"color",void 0),e$f([d$h({type:h$i})],i$2.prototype,"haloColor",void 0),e$f([d$h()],i$2.prototype,"haloOpacity",void 0),e$f([d$h()],i$2.prototype,"fillOpacity",void 0),i$2=e$f([i$j("esri.views.2d.support.HighlightOptions")],i$2);const c$6=i$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function t$1(t,h,i,e,d,l,n,o){let u;t.ignorePadding&&(e={left:0,right:0,top:0,bottom:0}),null!=t.width&&null!=t.height?u=[t.width,t.height]:null==t.width&&null!=t.height?u=[t.height,t.height]:null!=t.width&&null==t.height?u=[t.width,t.width]:null==t.width&&null==t.height&&(u=null);const r=i[0]-(e.left+e.right),a=i[1]-(e.top+e.bottom);let g,w,c=t.area||{x:0,y:0,width:r,height:a};if(u){const t=r/a,h=u[0]/u[1];if(h>t){const t=c.width/h;c={x:c.x,y:Math.round(c.y+(c.height-t)/2),width:c.width,height:Math.round(t)};}else {const t=c.height*h;c={x:Math.round(c.x+(c.width-t)/2),y:c.y,width:Math.round(t),height:c.height};}}else u=[c.width,c.height];u[0]>c.width?(g=Math.min(u[0]/c.width,h),w=u[0]/c.width/g):(g=1,w=u[0]/c.width);return {resolutionScale:g,cropArea:{x:Math.round((c.x+e.left)*g),y:Math.round((c.y+e.top)*g),width:Math.round(c.width*g),height:Math.round(c.height*g)},outputScale:w,format:d,quality:l,children:n,rotation:o}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const t={checkMajorWebPerformanceCaveat:!0};function s$2(s){s={...t,...s};const o=o$p();return o.available?s.checkMajorWebPerformanceCaveat&&o.majorPerformanceCaveat?new s$l("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):o.supportsHighPrecisionFragment?o.supportsVertexShaderSamplers?o.supportsElementIndexUint?o.supportsStandardDerivatives?o.supportsInstancedArrays?null:new s$l("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported."):new s$l("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported."):new s$l("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported."):new s$l("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new s$l("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new s$l("webgl:required","WebGL is required but not supported.")}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function i$1(t){return t&&"nodeType"in t}function d$3(t){return t&&"function"==typeof t.render}const c$5={component:"esri-component"};let p$4=class extends p$u{constructor(){super(...arguments),this.widget=null;}destroy(){this.widget&&this.widget.destroy(),this.node=null;}get id(){return this.get("widget.id")||this.get("node.id")}set node(t){const o=this._get("node");t!==o&&(t&&t.classList.add(c$5.component),o&&o.classList.remove(c$5.component),this._set("node",t));}castNode(t){return t?"string"==typeof t||i$1(t)?(this._set("widget",null),e$n(t)):(d$3(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};e$f([d$h({dependsOn:[]})],p$4.prototype,"id",null),e$f([d$h()],p$4.prototype,"node",null),e$f([c$y("node")],p$4.prototype,"castNode",null),e$f([d$h({readOnly:!0})],p$4.prototype,"widget",void 0),p$4=e$f([i$j("esri.views.ui.Component")],p$4);const l$3=p$4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const h$2={left:0,top:0,bottom:0,right:0},m$4={bottom:30,top:15,right:15,left:15},u$3="manual",f$1={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function _(t){return t&&!t._started&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}function g$3(t){const o=t,i="object"==typeof o&&null!==o&&Object.getPrototypeOf(o);return (null===i||i===Object.prototype)&&("component"in o||"index"in o||"position"in o)?t:null}function y$1(t,{top:o,bottom:i,left:e,right:n}){t.style.top=o,t.style.bottom=i,t.style.left=e,t.style.right=n;}let C$1=class extends n$u.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new u$j,this.view=null,this._initContainers();}initialize(){this._handles.add([i$l(this,"view.padding, container",this._applyViewPadding.bind(this)),i$l(this,"padding",this._applyUIPadding.bind(this))]);}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear();}set container(t){const i=this._get("container");t!==i&&(t&&(t.classList.add(f$1.ui),t.classList.add(k$4()),this._attachContainers(t)),i&&(i.classList.remove(f$1.ui),y$1(i,{top:"",bottom:"",left:"",right:""}),t$o(i)),this._set("container",t));}get height(){const t=this.get("view.height")||0;if(0===t)return t;const o=this._getViewPadding(),i=o.top+o.bottom;return Math.max(t-i,0)}get padding(){return this._get("padding")}set padding(t){t?this._override("padding",t):this._clearOverride("padding");}castPadding(t){return "number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...m$4,...t}}get width(){const t=this.get("view.width")||0;if(0===t)return t;const o=this._getViewPadding(),i=o.left+o.right;return Math.max(t-i,0)}add(t,o){let i,e;if(Array.isArray(t))return void t.forEach((t=>this.add(t,o)));const n=g$3(t);n&&({index:i,position:o,component:t,key:e}=n),o&&"object"==typeof o&&({index:i,key:e,position:o}=o),!t||o&&!this._isValidPosition(o)||this._add(t,o,i,e);}remove(t,o){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,o)));const i=this._find(t);if(i){const e=this._componentToKey;if(e.has(t)&&e.get(t)!==o)return;const n=this._components.indexOf(i);return i.node.parentNode&&i.node.parentNode.removeChild(i.node),this._componentToKey.delete(t),this._components.splice(n,1)[0]}}empty(t){if(Array.isArray(t))return t.map((t=>this.empty(t))).reduce(((t,o)=>t.concat(o)));if((t=t||u$3)===u$3){return Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(f$1.corner))).map((t=>this.remove(t)))}return this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null}move(t,o){if(Array.isArray(t)&&t.forEach((t=>this.move(t,o))),!t)return;let i;const e=g$3(t)||g$3(o);if(e&&(i=e.index,o=e.position,t=e.component||t),o&&!this._isValidPosition(o))return;const n=this.remove(t);n&&this.add(n,{position:o,index:i});}find(t){if(!t)return null;const o=this._findById(t);return o&&(o.widget||o.node)}getPosition(t){for(const o in this._positionNameToContainerLookup){if(this._positionNameToContainerLookup[o].contains(t))return o}return null}_add(t,o,i,e){t instanceof l$3||(t=new l$3({node:t})),this._place({component:t,position:o,index:i}),this._components.push(t),e&&this._componentToKey.set(t,e);}_find(t){return t?t instanceof l$3?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.get("view.padding")||h$2}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer);}_initContainers(){const t=document.createElement("div");t.classList.add(f$1.innerContainer),t.classList.add(f$1.cornerContainer);const o=document.createElement("div");o.classList.add(f$1.innerContainer),o.classList.add(f$1.manualContainer);const i=document.createElement("div");i.classList.add(f$1.topLeft),i.classList.add(f$1.corner),t.appendChild(i);const e=document.createElement("div");e.classList.add(f$1.topRight),e.classList.add(f$1.corner),t.appendChild(e);const n=document.createElement("div");n.classList.add(f$1.bottomLeft),n.classList.add(f$1.corner),t.appendChild(n);const r=document.createElement("div");r.classList.add(f$1.bottomRight),r.classList.add(f$1.corner),t.appendChild(r),this._innerContainer=t,this._manualContainer=o;const s=d$j();this._cornerNameToContainerLookup={"top-left":i,"top-right":e,"bottom-left":n,"bottom-right":r,"top-leading":s?e:i,"top-trailing":s?i:e,"bottom-leading":s?r:n,"bottom-trailing":s?n:r},this._positionNameToContainerLookup={manual:o,...this._cornerNameToContainerLookup};}_isValidPosition(t){return !!this._positionNameToContainerLookup[t]}_place(t){const o=t.component,e=t.position||u$3,n=t.index,r=this._positionNameToContainerLookup[e],s=n>-1;if(_(o.widget)&&o.widget.startup(),!s)return void r.appendChild(o.node);const a=Array.prototype.slice.call(r.children);if(0===n)return void(r.firstChild?o$q(o.node,r.firstChild):r.appendChild(o.node));n>=a.length?r.appendChild(o.node):o$q(o.node,a[n]);}_applyViewPadding(){const t=this.container;t&&y$1(t,this._toPxPosition(this._getViewPadding()));}_applyUIPadding(){const t=this._innerContainer;t&&y$1(t,this._toPxPosition(this.padding));}_toPxPosition(t){return {top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}}_toPxUnit(t){return 0===t?"0":t+"px"}_findByComponent(t){let o,i=null;return this._components.some((e=>(o=e===t,o&&(i=e),o))),i}_findById(t){let o,i=null;return this._components.some((e=>(o=e.id===t,o&&(i=e),o))),i}_findByNode(t){let o,i=null;return this._components.some((e=>(o=e.node===t,o&&(i=e),o))),i}};e$f([d$h()],C$1.prototype,"container",null),e$f([d$h()],C$1.prototype,"height",null),e$f([d$h({value:m$4})],C$1.prototype,"padding",null),e$f([c$y("padding")],C$1.prototype,"castPadding",null),e$f([d$h()],C$1.prototype,"view",void 0),e$f([d$h()],C$1.prototype,"width",null),C$1=e$f([i$j("esri.views.ui.UI")],C$1);const v=C$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function p$3(t,e){return t&&"copyright"in t&&(!e||"function"==typeof t.originOf&&"user"===t.originOf("copyright"))}function d$2(t,e){return t.length!==e.length||t.some(((t,i)=>t.text!==e[i].text))}function m$3(t,e,i){if(!i||!e)return;t.find((t=>t.layerView===e&&t.text===i))||t.push({text:i,layerView:e});}function f(t){return "bing-maps"===t.type}const b=[];let y=class extends d$i{constructor(t){super(t),this.clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state");},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new S$8,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const e=this.get("view.allLayerViews");e&&this.handles.add(e.map((t=>t.watch(["suspended","attributionVisible"],this._updateAttributionItems))),"suspension"),t&&t.removed&&t.removed.forEach((t=>{this._pendingAttributions.delete(t),this._fetchedAttributionData.delete(t);})),this._updateAttributionItems();},this._updateAttributionItems=()=>{const t=this.get("view.allLayerViews");b.length=0,t?(t.forEach((t=>{if(t.suspended||!t.get("layer.attributionVisible"))return;const e=t.layer;if(p$3(e,"user"))return void m$3(b,t,e.copyright);if(e.hasAttributionData){if(this._fetchedAttributionData.has(t)){const i=this._fetchedAttributionData.get(t);return void(i?m$3(b,t,this._getDynamicAttribution(i,this.view,e)):p$3(e)&&m$3(b,t,e.copyright))}return void this._fetchAttributionData(t)}const i=e.get("portalItem.accessInformation");m$3(b,t,i||e.copyright);})),d$2(this.items,b)&&(this.items.removeAll(),this.items.addMany(b)),b.length=0,this.notifyChange("state")):this.clear();},this.handles.add([$$4(this,"view.allLayerViews","change",this._allLayerViewsChange,this._allLayerViewsChange,this.clear),v$b(this,"view.stationary",(()=>this._updateAttributionItems()))]);}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll();}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const i=await a$G(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const e=i.ok?this._createContributionIndex(i.value,f(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,e);}this._updateAttributionItems();}_createContributionIndex(t,e){const i=t.contributors,r={};if(!i)return r;for(let s=0;s<i.length;s++){const t=i[s],o=t.coverageAreas;if(!o)return;for(const i of o){const o=i.bbox,n=i.zoomMin-(e&&i.zoomMin?1:0),a=i.zoomMax-(e&&i.zoomMax?1:0),c={xmin:o[1],ymin:o[0],xmax:o[3],ymax:o[2],spatialReference:k$3.WGS84},u={extent:R$6(c),attribution:t.attribution||"",score:null!=i.score?i.score:100,id:s};for(let t=n;t<=a;t++)r[t]=r[t]||[],r[t].push(u);}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(t,e,i){const{extent:r,scale:s}=e;let o=i.tileInfo.scaleToZoom(s);if(o=Math.min(t.maxKey,Math.round(o)),!r||null==o||o<=-1)return "";const n=t[o],a=M$5(r.center.clone().normalize(),e.spatialReference),h={};return n?n.filter((t=>{const e=!h[t.id]&&a&&r$l(t.extent,a);return e&&(h[t.id]=!0),e})).sort(((t,e)=>e.score-t.score||t.objectId-e.objectId)).map((t=>t.attribution)).join(", "):""}};e$f([d$h({readOnly:!0,type:S$8})],y.prototype,"items",void 0),e$f([d$h({readOnly:!0})],y.prototype,"state",null),e$f([d$h()],y.prototype,"view",void 0),y=e$f([i$j("esri.widgets.Attribution.AttributionViewModel")],y);const g$2=y;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$4={base:"esri-attribution esri-widget",poweredBy:"esri-attribution__powered-by",sources:"esri-attribution__sources",open:"esri-attribution--open",sourcesOpen:"esri-attribution__sources--open",link:"esri-attribution__link",widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let l$2=class extends z$4{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this.iconClass=c$4.widgetIcon,this.itemDelimiter=" | ",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new g$2;}initialize(){this.own($$4(this,"viewModel.items","change",(()=>this.scheduleRender())));}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((e,t)=>(-1===e.indexOf(t.text)&&e.push(t.text),e)),[]).join(this.itemDelimiter)}render(){const e={[c$4.open]:this._isOpen};return n$v("div",{bind:this,class:this.classes(c$4.base,e),onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return n$v("div",{class:c$4.poweredBy},"Powered by"," ",n$v("a",{class:c$4.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,i=t?0:-1,{attributionText:r}=this,o=t?"button":void 0,s={[c$4.sourcesOpen]:e,[c$4.interactive]:t};return n$v("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes(c$4.sources,s),innerHTML:r,role:o,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth;}_afterSourcesNodeUpdate(e){let t=!1;const{clientHeight:i,clientWidth:r,scrollWidth:o}=e,s=o>=r,n=this._attributionTextOverflowed!==s;if(this._attributionTextOverflowed=s,n&&(t=!0),this._isOpen){const e=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,e&&(this._isOpen=!1,t=!0);}t&&this.scheduleRender();}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen);}};e$f([d$h()],l$2.prototype,"_isOpen",void 0),e$f([d$h()],l$2.prototype,"_isInteractive",null),e$f([d$h()],l$2.prototype,"_attributionTextOverflowed",void 0),e$f([d$h()],l$2.prototype,"_prevSourceNodeHeight",void 0),e$f([d$h({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],l$2.prototype,"attributionText",null),e$f([d$h()],l$2.prototype,"iconClass",void 0),e$f([d$h()],l$2.prototype,"itemDelimiter",void 0),e$f([d$h({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],l$2.prototype,"label",void 0),e$f([d$h(),e$h("esri/widgets/Attribution/t9n/Attribution")],l$2.prototype,"messages",void 0),e$f([o$i("viewModel.view")],l$2.prototype,"view",void 0),e$f([d$h({type:g$2})],l$2.prototype,"viewModel",void 0),e$f([t$n()],l$2.prototype,"_toggleState",null),l$2=e$f([i$j("esri.widgets.Attribution")],l$2);const u$2=l$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const n$3="esri.widgets.CompassViewModel";let h$1=class extends(e$k(p$u)){constructor(t){super(t),this._handles=new u$j,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this);}initialize(){this._handles.add(i$l(this,"view",this._updateRotationWatcher));}destroy(){this._handles.destroy(),this._handles=null,this.view=null;}get canShowNorth(){const t=this.get("view.spatialReference");return !(!t||!t.isWebMercator&&!t.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const t={};"2d"===this.view.type?t.rotation=0:t.heading=0,this.callGoTo({target:t});}_updateForRotation(t){null!=t&&(this.orientation={z:t});}_updateForCamera(t){if(!t)return;const e=-t.heading;this.orientation={x:0,y:0,z:e};}_updateRotationWatcher(t){this._handles.removeAll(),t&&("2d"===t.type?this._handles.add(i$l(this,"view.rotation",this._updateForRotation)):this._handles.add(i$l(this,"view.camera",this._updateForCamera)));}};e$f([d$h({readOnly:!0})],h$1.prototype,"canShowNorth",null),e$f([d$h()],h$1.prototype,"orientation",void 0),e$f([d$h({readOnly:!0})],h$1.prototype,"state",null),e$f([d$h()],h$1.prototype,"view",void 0),h$1=e$f([i$j(n$3)],h$1);const d$1=h$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const n$2={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let l$1=class extends z$4{constructor(s,e){super(s,e),this.goToOverride=null,this.iconClass=n$2.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new d$1;}reset(){return this.viewModel.reset()}render(){const{orientation:s,state:e}=this.viewModel,o="disabled"===e,t="compass"===("rotation"===e?"rotation":"compass"),r=o?-1:0,i={[n$2.disabled]:o,[n$2.interactive]:!o},a={[n$2.northIcon]:t,[n$2.rotationIcon]:!t},{messages:c}=this;return n$v("div",{bind:this,class:this.classes(n$2.base,i),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:r,"aria-label":c.reset,title:c.reset},n$v("span",{"aria-hidden":"true",class:this.classes(n$2.icon,a),styles:this._toRotationTransform(s)}),n$v("span",{class:n$2.text},c.reset))}_reset(){this.viewModel.reset();}_toRotationTransform(s){return {transform:`rotateZ(${s.z}deg)`}}};e$f([o$i("viewModel.goToOverride")],l$1.prototype,"goToOverride",void 0),e$f([d$h()],l$1.prototype,"iconClass",void 0),e$f([d$h({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],l$1.prototype,"label",void 0),e$f([d$h(),e$h("esri/widgets/Compass/t9n/Compass")],l$1.prototype,"messages",void 0),e$f([o$i("viewModel.view")],l$1.prototype,"view",void 0),e$f([d$h({type:d$1})],l$1.prototype,"viewModel",void 0),e$f([t$n()],l$1.prototype,"_reset",null),l$1=e$f([i$j("esri.widgets.Compass")],l$1);const d=l$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let a$3=class extends p$u{constructor(t){super(t),this._handles=new u$j,this.navigationMode="pan",this.view=null;}initialize(){this._handles.add(s$s(this,"view.inputManager",this._setNavigationMode.bind(this)));}destroy(){this._handles.destroy(),this._handles=null,this.view=null;}get state(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode());}_setNavigationMode(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate";}};e$f([d$h({readOnly:!0})],a$3.prototype,"state",null),e$f([d$h()],a$3.prototype,"navigationMode",void 0),e$f([d$h()],a$3.prototype,"view",void 0),a$3=e$f([i$j("esri.widgets.NavigationToggleViewModel")],a$3);const n$1=a$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const g$1={base:"esri-navigation-toggle esri-widget",button:"esri-navigation-toggle__button esri-widget--button",activeButton:"esri-navigation-toggle__button--active",panButton:"esri-navigation-toggle__button--pan",rotateButton:"esri-navigation-toggle__button--rotate",isLayoutHorizontal:"esri-navigation-toggle--horizontal",rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let p$2=class extends z$4{constructor(t,o){super(t,o),this.iconClass=g$1.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new n$1;}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t);}toggle(){return this.viewModel.toggle()}render(){const t="disabled"===this.get("viewModel.state"),o="pan"===this.get("viewModel.navigationMode"),e={[g$1.disabled]:t,[g$1.isLayoutHorizontal]:"horizontal"===this.layout},s={[g$1.activeButton]:o},i={[g$1.activeButton]:!o},a=t?-1:0,r=this.messages.toggle;return n$v("div",{bind:this,class:this.classes(g$1.base,e),onclick:this._toggle,onkeydown:this._toggle,tabIndex:a,"aria-label":r,title:r},n$v("div",{class:this.classes(g$1.button,g$1.panButton,s)},n$v("span",{class:g$1.panIcon})),n$v("div",{class:this.classes(g$1.button,g$1.rotateButton,i)},n$v("span",{class:g$1.rotationIcon})))}_toggle(){this.toggle();}};e$f([d$h()],p$2.prototype,"iconClass",void 0),e$f([d$h({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],p$2.prototype,"label",void 0),e$f([d$h({value:"vertical"})],p$2.prototype,"layout",null),e$f([d$h(),e$h("esri/widgets/NavigationToggle/t9n/NavigationToggle")],p$2.prototype,"messages",void 0),e$f([o$i("viewModel.view")],p$2.prototype,"view",void 0),e$f([d$h({type:n$1})],p$2.prototype,"viewModel",void 0),e$f([t$n()],p$2.prototype,"_toggle",null),p$2=e$f([i$j("esri.widgets.NavigationToggle")],p$2);const c$3=p$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$2={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let n=class extends z$4{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title="";}render(){const t=this.enabled?0:-1,s={[c$2.disabled]:!this.enabled,[c$2.interactive]:this.enabled},o={[this.iconClass]:!!this.iconClass};return n$v("div",{bind:this,class:this.classes(c$2.button,s),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:t,title:this.title},n$v("span",{"aria-hidden":"true",role:"presentation",class:this.classes(c$2.icon,o)}),n$v("span",{class:c$2.iconText},this.title))}_triggerAction(){this.action.call(this);}};e$f([d$h()],n.prototype,"action",void 0),e$f([d$h()],n.prototype,"enabled",void 0),e$f([d$h()],n.prototype,"iconClass",void 0),e$f([d$h()],n.prototype,"title",void 0),e$f([t$n()],n.prototype,"_triggerAction",null),n=e$f([i$j("esri.widgets.IconButton")],n);const a$2=n;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let s$1=class extends p$u{get canZoomIn(){if(!this.get("view.ready"))return !1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMaxScale");return 0===t||e>t}get canZoomOut(){if(!this.get("view.ready"))return !1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMinScale");return 0===t||e<t}};e$f([d$h({readOnly:!0})],s$1.prototype,"canZoomIn",null),e$f([d$h({readOnly:!0})],s$1.prototype,"canZoomOut",null),e$f([d$h()],s$1.prototype,"view",void 0),s$1=e$f([i$j("esri.widgets.Zoom.ZoomConditions2D")],s$1);const i=s$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let s=class extends p$u{get canZoomIn(){return !!this.get("view.ready")}get canZoomOut(){return !!this.get("view.ready")}};e$f([d$h({readOnly:!0})],s.prototype,"canZoomIn",null),e$f([d$h({readOnly:!0})],s.prototype,"canZoomOut",null),e$f([d$h()],s.prototype,"view",void 0),s=e$f([i$j("esri.widgets.Zoom.ZoomConditions3D")],s);const c$1=s;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let m$2=class extends p$u{constructor(o){super(o),this.canZoomIn=!1,this.canZoomOut=!1;}destroy(){this.view=null;}get state(){return this.get("view.ready")?"ready":"disabled"}set view(o){o?"2d"===o.type?this._zoomConditions=new i({view:o}):"3d"===o.type&&(this._zoomConditions=new c$1({view:o})):this._zoomConditions=null,this._set("view",o);}zoomIn(){if(!this.canZoomIn)return;const o=this.view;"2d"===o.type?o.mapViewNavigation.zoomIn():g$j(o.goTo({zoomFactor:2}));}zoomOut(){if(!this.canZoomOut)return;const o=this.view;"2d"===o.type?o.mapViewNavigation.zoomOut():g$j(o.goTo({zoomFactor:.5}));}};e$f([d$h()],m$2.prototype,"_zoomConditions",void 0),e$f([d$h({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],m$2.prototype,"canZoomIn",void 0),e$f([d$h({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],m$2.prototype,"canZoomOut",void 0),e$f([d$h({readOnly:!0})],m$2.prototype,"state",null),e$f([d$h()],m$2.prototype,"view",null),m$2=e$f([i$j("esri.widgets.Zoom.ZoomViewModel")],m$2);const a$1=m$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const l={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let u$1=class extends z$4{constructor(o,t){super(o,t),this.iconClass=l.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new a$1;}initialize(){this._zoomInButton=new a$2({action:this.zoomIn.bind(this),iconClass:l.zoomInIcon}),this._zoomOutButton=new a$2({action:this.zoomOut.bind(this),iconClass:l.zoomOutIcon});}destroy(){this._zoomInButton.destroy(),this._zoomOutButton.destroy(),this._zoomInButton=null,this._zoomOutButton=null;}set layout(o){"horizontal"!==o&&(o="vertical"),this._set("layout",o);}render(){const o=this.viewModel,t={[l.horizontalLayout]:"horizontal"===this.layout};return this._zoomInButton.enabled="ready"===o.state&&o.canZoomIn,this._zoomOutButton.enabled="ready"===o.state&&o.canZoomOut,this._zoomInButton.title=this.messages.zoomIn,this._zoomOutButton.title=this.messages.zoomOut,n$v("div",{class:this.classes(l.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};e$f([d$h()],u$1.prototype,"iconClass",void 0),e$f([d$h({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],u$1.prototype,"label",void 0),e$f([d$h({value:"vertical"})],u$1.prototype,"layout",null),e$f([d$h(),e$h("esri/widgets/Zoom/t9n/Zoom")],u$1.prototype,"messages",void 0),e$f([o$i("viewModel.view")],u$1.prototype,"view",void 0),e$f([d$h({type:a$1})],u$1.prototype,"viewModel",void 0),u$1=e$f([i$j("esri.widgets.Zoom")],u$1);const c=u$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const m$1="esri.views.ui.DefaultUI";function h(t){return t&&void 0!==t.view}s$k.getLogger(m$1);let g=class extends v{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-leading","navigation-toggle":"top-leading",zoom:"top-leading"},this.components=[];}initialize(){this._handles.add([i$l(this,"components",this._componentsWatcher.bind(this)),i$l(this,"view",this._updateViewAwareWidgets.bind(this))]);}_add(t,o,i,e){if("string"==typeof t&&this._defaultPositionLookup[t]){if(this._find(t))return;t=this._createComponent(t);}super._add(t,o,i,e);}_removeComponents(t){t.forEach((t=>{const o=this._find(t);o&&(this.remove(o),o.destroy());}));}_updateViewAwareWidgets(t){this.components.forEach((o=>{const i=this._find(o),e=i&&i.widget;h(e)&&(e.view=t);}));}_componentsWatcher(t,o){this._removeComponents(o),this._addComponents(t),this._adjustPadding(t);}_adjustPadding(t){if(-1===t.indexOf("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t;}}_addComponents(t){this.initialized&&t.forEach((t=>this.add(this._createComponent(t),this._defaultPositionLookup[t])));}_createComponent(t){const o=this._createWidget(t);if(o)return new l$3({id:t,node:o})}_createWidget(t){return "attribution"===t?this._createAttribution():"compass"===t?this._createCompass():"navigation-toggle"===t?this._createNavigationToggle():"zoom"===t?this._createZoom():void 0}_createAttribution(){return new u$2({view:this.view})}_createCompass(){return new d({view:this.view})}_createNavigationToggle(){return new c$3({view:this.view})}_createZoom(){return new c({view:this.view})}};e$f([d$h()],g.prototype,"components",void 0),g=e$f([i$j(m$1)],g);const u=g;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let e=class extends u{constructor(o){super(o),this.components=["attribution","zoom"];}};e$f([d$h()],e.prototype,"components",void 0),e=e$f([i$j("esri.views.ui.2d.DefaultUI2D")],e);const p$1=e;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var p;let a=p=class extends a$w{constructor(o){super(o),this.color=new h$i([0,0,0,1]);}clone(){return new p(l$j({color:this.color}))}};e$f([d$h({type:h$i,json:{write:!0}})],a.prototype,"color",void 0),a=p=e$f([i$j("esri.webmap.background.ColorBackground")],a);const m=a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const S=s$k.getLogger("esri.views.MapView");let O,C,L,k,E,x;async function N(){const[,{GraphicsView2D:e,GraphicContainer:t,LabelManager:i,MapViewNavigation:r,MagnifierView2D:s,Stage:a}]=await Promise.all([import('./webgl-09c18771.js'),import('./mapViewDeps-6b8a8771.js')]);C=e,L=t,k=i,E=r,x=s,O=a;}function P(e){return e instanceof h$j}function W(e,t,r){if(e)if(Array.isArray(e)||S$8.isCollection(e)){if(0===e.length)return;e.forEach((e=>W(e,t,r)));}else P(e)?t.add(e):r.add(e);}let R=class extends(m$i(_$5(U))){constructor(e){super(e),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new p$v({getCollections:()=>{var e,t;return [null==(e=this.basemapView)?void 0:e.baseLayerViews,this.layerViews,null==(t=this.basemapView)?void 0:t.referenceLayerViews]},getChildrenFunction:()=>null}),this.floors=new S$8,this.graphicsView=null,this.highlightOptions=new c$6,this.inputManager=new E$1({view:this}),this.mapViewNavigation=null,this.supersampleScreenshotsEnabled=!1,this.ui=new p$1,this.rendering=!1,c$H();}destroy(){this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null);}get background(){return this.get("map.initialViewProperties.background")||null}set background(e){void 0===e?this._clearOverride("background"):this._override("background",e);}get textureManager(){return this._stage.painter.textureManager}get navigating(){return !(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}toMap(e){if(i$9(e)){const t=c$f(this,e);return super.toMap(t)}return super.toMap(e)}hitTest(e,t){const i=i$9(e)?c$f(this,e):e;if(!this.ready||isNaN(i.x)||isNaN(i.y))return Promise.resolve({screenPoint:i,results:[]});const r=this.toMap(i),s=[this.graphicsView];s.push.apply(s,this.allLayerViews.toArray().reverse());const a=new Set,n=new Set,o=new Set,h=new Set;return t&&(W(t&&t.include,a,o),W(t&&t.exclude,n,h)),Promise.all(s.map((e=>!e||!e.hitTest||o.size>0&&!e.layer||o.size>0&&e.layer&&!o.has(e.layer)||h.size>0&&e.layer&&h.has(e.layer)?null:e.hitTest(i.x,i.y)))).then((e=>({screenPoint:i,results:e.filter((e=>null!=e&&(!(a.size>0)||a.has(e))&&(!(n.size>0)||!n.has(e)))).map((e=>({mapPoint:r,graphic:e})))})))}takeScreenshot(e){if(e=e||{},!this.ready)return Promise.reject("Map view cannot be used before it is ready");const t=this.supersampleScreenshotsEnabled?Math.min(4,g$k(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let i;e.layers?(i=[],e.layers.forEach((e=>{const t=this.allLayerViews.find((t=>t.layer.id===e.id));t&&"container"in t&&t.container&&i.push(t.container);}))):i=this._stage.children;const{format:r,quality:s}=l$q(e.format,e.quality),a=t$1(e,t,this.size,this.padding,r,s,i,e.rotation);return this._stage.takeScreenshot(a)}on(e,t,i,r){const s=this.inputManager&&this.viewEvents.on(e,t,i,r);return s||super.on(e,t)}hasEventListener(e){return super.hasEventListener(e)||this.viewEvents.hasHandler(e)}whenLayerView(e){return super.whenLayerView(e)}graphicChanged(e){if(this.graphicsView){this.graphicsView.graphicUpdateHandler(e);}}whenReady(){return new Promise((e=>{this.ready?e(this):this._resolveWhenReady.push(e);}))}forceDOMReadyCycle(){this.forceReadyCycle();}validate(){let e=s$2({checkMajorWebPerformanceCaveat:!1});return s$q("safari")&&s$q("safari")<9&&(e=new s$l("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:s$q("safari")})),r$g(e)?(S.warn("#validate()",e.message),Promise.reject(e)):N()}_startup(){this.timeline.begin("MapView Startup"),super._startup(),this.graphics.owner=this;const e={disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},t=new O(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:e,renderingOptions:this.renderingOptions,timeline:this.timeline}),i=new C({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new L(this.featuresTilingScheme)}),r=new E({view:this,animationManager:this.animationManager}),s=new k({view:this});this._magnifierView=new x,this._magnifierView.magnifier=this.magnifier,this._stage=t,this.frameTask.graphicsView=i,this._set("graphicsView",i),this._set("mapViewNavigation",r),this._set("labelManager",s),this.handles.add([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),t.on("post-render",(()=>this._set("rendering",t.renderRequested))),t.on("will-render",(()=>this._set("rendering",t.renderRequested))),t.on("webgl-error",(e=>this.fatalError=e.error)),i$l(this,"stationary",(e=>t.stationary=e),!0),i$l(this,"state.id",(()=>t.state=this.state),!0),i$l(this,"background",(e=>{t.background=e,this._magnifierView.background=e;}),!0),i$l(this,"magnifier",(e=>this._magnifierView.magnifier=e),!0),i$l(this,"renderingOptions",(e=>t.renderingOptions=e),!0),i$l(this,"highlightOptions",(()=>t.highlightOptions=this.highlightOptions),!0)],"map-view"),t.state=this.state,this._updateStageChildren();const a=this._resolveWhenReady;this._resolveWhenReady=[],a.forEach((e=>e(this))),this.timeline.end("MapView Startup");}_teardown(){this.handles.remove("map-view"),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy();this.graphicsView.destroy(),this.mapViewNavigation.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,super._teardown();}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach((e=>{this._stage.addChild(e.container);}));const e=this.graphicsView;this._stage.addChild(e.container),this._stage.addChild(this._magnifierView);}};e$f([d$h({type:m})],R.prototype,"background",null),e$f([d$h()],R.prototype,"floors",void 0),e$f([d$h()],R.prototype,"graphicsView",void 0),e$f([d$h({type:c$6})],R.prototype,"highlightOptions",void 0),e$f([d$h({readOnly:!0})],R.prototype,"inputManager",void 0),e$f([d$h({readOnly:!0})],R.prototype,"textureManager",null),e$f([d$h({readOnly:!0})],R.prototype,"mapViewNavigation",void 0),e$f([d$h({type:Boolean})],R.prototype,"navigating",null),e$f([d$h({type:Boolean,constructOnly:!0})],R.prototype,"supersampleScreenshotsEnabled",void 0),e$f([d$h({type:p$1})],R.prototype,"ui",void 0),e$f([d$h({readOnly:!0})],R.prototype,"rendering",void 0),e$f([d$h({constructOnly:!0})],R.prototype,"renderCanvas",void 0),e$f([d$h({constructOnly:!0})],R.prototype,"deactivatedWebGLExtensions",void 0),e$f([d$h({constructOnly:!0})],R.prototype,"debugWebGLExtensions",void 0),R=e$f([i$j("esri.views.MapView")],R);const G=R;

export { $, Ft as F, G, Mt as M, S$6 as S, e$5 as a, e$e as b, u$d as c, d$g as d, e$7 as e, St as f, r$5 as g, j$2 as j, lt as l, m, n$b as n, pt as p, rt as r, u$9 as u, vt as v, xt as x };
