import { r as registerInstance, e as createEvent, g as getElement } from './index-6f774db5.js';
import { p as p$2, s as s$5, B, r as r$4, j as j$5, v as v$4, m as m$3, h as h$2, d as d$4, a as s$6, l as l$3, E as E$2, e as e$3, b as d$5, i as i$4, c as e$4, t as t$3, f as c$8, g as s$7, n as n$3, k as c$9 } from './cast-e5ea2533.js';
import { a as a$5 } from './assets-1ab0ccbe.js';
import { u as u$4 } from './Handles-24a27aa9.js';
import { i as i$5, f as f$5, $, a as a$4 } from './watchUtils-08cf9d08.js';
import { o as o$4 } from './aliasOf-e543e228.js';
import { z as z$1, n as n$4, e as e$5, t as t$4 } from './messageBundle-335e3604.js';
import { S as S$2 } from './Collection-ac20f1a1.js';
import { G, C as C$1, f as f$4, c as c$5, M as M$4, k, m as m$4, B as B$1 } from './Portal-f1457cb4.js';
import { b as b$5 } from './basemapUtils-6ed30a8c.js';
import { i as i$3 } from './Util-88dd499c.js';
import { f as f$3 } from './Scheduler-a964a3e2.js';
import { M as M$3, p as p$3, x as x$2, j as j$7, w as w$4, r as r$5, c as c$6, z, u as u$3, d as d$6 } from './mathUtils-cc1689ad.js';
import { n as n$2 } from './common-e2a70efa.js';
import { $ as $n } from './projection-cca7ffa7.js';
import { u as u$2, b as b$4, w as w$5, c as c$7 } from './aaBoundingRect-2a187de3.js';
import { H as H$1 } from './unitUtils-5dcccb3c.js';
import { j as j$6 } from './TileInfo-a7d4b50d.js';
import { x as x$3 } from './Basemap-bec40c12.js';
import { s as s$8 } from './Heading-818ed1a8.js';
import './intl-0d87e9f4.js';
import './number-2da43364.js';
import './messages-1d31e380.js';
import './uuid-d0cd90dd.js';
import './JSONSupport-8dda8bae.js';
import './mat4-0196b8fc.js';
import './vec2-a8a62c12.js';
import './vec2f64-503345b4.js';
import './vec4f64-42a71444.js';
import './reactiveUtils-ab0efcb1.js';
import './Polyline-56152656.js';
import './collectionUtils-b35b097b.js';
import './loadAll-a2448ab4.js';
import './asyncUtils-847ae6e6.js';
import './PortalItem-85b3bb14.js';
import './writeUtils-f98d31f7.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function e$2(e){return e&&"base-tile"===e.type||"tile"===e.type||"elevation"===e.type||"imagery-tile"===e.type||"base-elevation"===e.type||"open-street-map"===e.type||"wcs"===e.type||"web-tile"===e.type||"wmts"===e.type||"vector-tile"===e.type}function t$2(e){return e.parent&&"esri.Basemap"===e.parent.declaredClass&&e.parent.baseLayers.indexOf(e)>-1}function n$1(e){const t=/[:;]/,n=[];let r=!1;if(e&&(e.forEach((function(e,i){n.push([i,e]),!r&&t.test(e)&&(r=!0);})),n.length>0)){let e;if(r){const t={};n.forEach((e=>{t[e[0]]=e[1];})),e=JSON.stringify(t);}else {const t=[];n.forEach((e=>{t.push(e[0]+":"+e[1]);})),e=t.join(";");}return e}return null}function r$3(e){if(!e)return;const t=[];return e.forEach((function(e,n){t.push('"'+n+'":'+JSON.stringify(e));})),t.length?"{"+t.join(",")+"}":void 0}function i$2(e,t){const n=[];if(e>0&&t)for(let r=0;r<t.length;r++)if(!(t[r].parentLayerId>=0&&-1===n.indexOf(t[r].parentLayerId)&&t.some((function(e){return e.id===t[r].parentLayerId})))&&t[r].id>=0){let i=!0;const a=t[r].maxScale,l=t[r].minScale;(a>0||l>0)&&(a>0&&l>0?i=a<=e&&e<=l:a>0?i=a<=e:l>0&&(i=e<=l)),i&&n.push(t[r].id);}return n}function a$3(e){return !0===e.labelsVisible&&null!=e.labelingInfo&&e.labelingInfo.length>0}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class s$4{constructor(t){this.client=t,this._cancelled=!1,this.size=0,this.duration=0;}}class e$1{constructor(t){this.typeWorkerQuota=t,this.tasks=new Array,this.numWorkers=0,this.statistics=new r$2;}}class r$2{constructor(){this.requests=0,this.size=0,this.duration=0,this.speed=0;}}class i$1{constructor(t,s,r,i){this._workerFunc=t,this._callbackFunc=s,this._maxTotalNumWorkers=r,this._totalNumWorkers=0,this._clients=i.map((t=>new e$1(t)));}hasQuota(t){const s=this._clients[t];return !!s&&(this._totalNumWorkers<this._maxTotalNumWorkers||s.numWorkers+s.tasks.length<s.typeWorkerQuota)}push(t){const s=this._clients[t.client];s&&(this._totalNumWorkers<this._maxTotalNumWorkers?(s.numWorkers++,this._totalNumWorkers++,this._workerFunc(t,((t,s)=>this._taskCallback(t,s)))):s.tasks.push(t));}cancel(t){this._taskFinished(t),t._cancelled=!0;}destroy(){this._clients.length=0;}_taskFinished(s){const e=this._clients[s.client];this._totalNumWorkers--,e.numWorkers--,e.statistics.requests++,e.statistics.size+=s.size||0,e.statistics.duration+=s.duration||0,e.statistics.speed=e.statistics.duration>0?e.statistics.size/e.statistics.duration:0,i$3(e.numWorkers>=0),this._next();}_next(){for(const t of this._clients)if(t&&t.numWorkers<t.typeWorkerQuota&&this._processQueue(t))return;for(const t of this._clients)if(t&&this._processQueue(t))return}_processQueue(t){for(;t.tasks.length>0;)if(this._workerFunc(t.tasks.shift(),((t,s)=>this._taskCallback(t,s))))return t.numWorkers++,this._totalNumWorkers++,!0;return !1}_taskCallback(t,s){t._cancelled||(this._callbackFunc(t,s),this._taskFinished(t));}getStatsForType(t){const s=this._clients[t];return s?{quota:s.typeWorkerQuota,workers:s.numWorkers,queueSize:s.tasks.length,requestStats:s.statistics}:null}get test(){const t=this;return {set workerFunc(s){t._workerFunc=s;}}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class t$1 extends s$4{constructor(s,t,r,e,i){super(e),this.url=s,this.options=t,this.docType=r,this.key=i,this.result=null,this.status=1,this.request=null,this.abortController=null,this.resolvers=new Array,this.startTime=0;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let y$5=class extends p$2{constructor(){super(...arguments),this.tasks=new Map,this.onLoadQueue=new Array,this.doneQueue=new Array,this.updating=!1;}setup(e,t,s){this.loadQueue=new i$1(((e,t)=>this.startLoading(e,t)),((e,t)=>this.doneLoadingCallback(e,t)),e,t),s&&(this.taskHandle=s.registerTask(f$3.STREAM_DATA_LOADER,this));}destroy(){this.taskHandle=s$5(this.taskHandle),this.tasks.forEach((e=>{e.abortController&&e.abortController.abort();})),this.loadQueue.destroy(),this.loadQueue=null,this.onLoadQueue=null,this.doneQueue=null,this.tasks=null;}hasDownloadSlots(e){return this.loadQueue.hasQuota(e)}request(e,t,s,r={}){const o=B();o.__signal=r$4(r)?r.signal:null;const a=this.createOrUpdateTask(e,t,s,r,o);return j$5(r,(()=>this.cancelRequest(a,o))),o.promise}createTask(e,t,s,r,o,a){const n=new t$1(e,t,s,r,o);return this.updateTask(n,a),this.tasks.set(o,n),1===this.tasks.size&&this._set("updating",!0),this.loadQueue.push(n),n}cancelRequest(e,t){v$4(e.resolvers,t),t.reject(m$3()),0===e.resolvers.length&&(2===e.status&&(e.status=4,this.loadQueue.cancel(e),e.abortController.abort(),e.request=null,e.abortController=null),e.status=4,this.tasks.delete(e.key),0===this.tasks.size&&this._set("updating",!1));}taskKey(e,t,s){return `${e}:${t}:${s}`}updateTask(e,t){e.resolvers.push(t);}createOrUpdateTask(e,t,s,r,o){const a=r$4(r)&&r.uid||e,n=this.taskKey(a,t,s),u=this.tasks.get(n);return u?(this.updateTask(u,o),u):this.createTask(e,r,t,s,n,o)}doneLoadingCallback(e,t){this.loadQueue&&(i$3(2===e.status),e.status=3,this.taskHandle?this.doneQueue.push({task:e,err:t}):this.doneLoading(e,t));}get running(){return this.doneQueue.length>0||this.onLoadQueue.length>0}runTask(e){for(;!e.done&&this.onLoadQueue.length>0;){const t=this.onLoadQueue.shift();h$2(t.task.abortController),t.task.abortController=null,t.callback(t.task),e.madeProgress();}for(;!e.done&&this.doneQueue.length>0;){const t=this.doneQueue.shift();3!==t.task.status&&(t.err=t.err||m$3()),this.doneLoading(t.task,t.err),e.madeProgress();}}doneLoading(e,t){let s=e.result instanceof HTMLImageElement?0:e.resolvers.length;for(const r of e.resolvers)if(t)d$4(t)?r.reject(t):r.reject(new s$6("stream-data-loader:request-error",`Failed to request resource at '${e.url}'. ${t}`,{url:e.url,error:t}));else {--s;const t=s<=0?e.result:l$3(e.result);r.resolve(t);}this.tasks.delete(e.key),0===this.tasks.size&&this._set("updating",!1);}startLoading(e,s){if(4===e.status)return !1;let r,o;switch(e.startTime=performance.now(),e.status=2,e.docType){case"binary":o="array-buffer",r=0;break;case"image":o="image";break;case"image+type":o="array-buffer";break;default:o="json";}e.abortController=new AbortController;const a=e.abortController.signal;e.request=E$2(e.url,{...e.options,responseType:o,timeout:r,signal:a});let n=()=>{};const i=t=>{e.duration=performance.now()-e.startTime,e.size=t instanceof ArrayBuffer?t.byteLength:e.size||0,e.result=t,this.taskHandle?this.onLoadQueue.push({callback:s,task:e}):(e.abortController=null,s(e));},u=t=>{2===e.status&&s(e,t),n();};return "image+type"!==e.docType?(e.request.then((e=>i(e.data)),u),!0):(e.request.then((s=>{const l=s.data,d=L$1(l);if(o="image",e.size=l.byteLength,"unknown"===d)return e.request=E$2(e.url,{responseType:o,timeout:r,signal:a}),void e.request.then((e=>i(e.data)),u);const h=new Blob([l],{type:d}),c=window.URL.createObjectURL(h);n=()=>window.URL.revokeObjectURL(c),e.request=E$2(c,{responseType:o,timeout:r,signal:a}),e.request.then((e=>i(new j$4(e.data,d,n))),u);}),u),!0)}get test(){return {loadQueue:this.loadQueue}}};function L$1(e){if(e.byteLength<2)return "unknown";const t=new Uint8Array(e,0,e.byteLength);return 137===t[0]&&80===t[1]?"image/png":71===t[0]&&73===t[1]?"image/gif":66===t[0]&&77===t[1]?"image/bmp":255===t[0]&&216===t[1]?"image/jpeg":"unknown"}e$3([d$5({readOnly:!0})],y$5.prototype,"updating",void 0),y$5=e$3([i$4("esri.views.3d.support.StreamDataLoader")],y$5);class j$4{constructor(e,t,s){this.image=e,this.type=t,this.release=s;}get isOpaque(){return "image/jpeg"===this.type}}const w$3=y$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const v$3=12;class M$2{constructor(e){const t=M$2.checkUnsupported(e);if(r$4(t))throw t;const i=e$4(e);this.spatialReference=i.spatialReference,this._isWebMercator=this.spatialReference.isWebMercator,this._isGCS=$n(this.spatialReference)||G(this.spatialReference)||C$1(this.spatialReference),this.origin=[i.origin.x,i.origin.y],this.pixelSize=i.size[0],this.dpi=i.dpi;const s=i.lods.reduce((function(e,t,i){return t.level<e.min&&(e.min=t.level,e.minIndex=i),e.max=Math.max(e.max,t.level),e}),{min:1/0,minIndex:0,max:-1/0}),l=i.lods[s.minIndex],n=2**l.level;let a=l.resolution*n,h=l.scale*n;this.levels=new Array(s.max+1);for(let r=0;r<this.levels.length;r++)this.levels[r]={resolution:a,scale:h,tileSize:[a*i.size[0],a*i.size[1]]},a/=2,h/=2;}clone(){return new M$2(this.toTileInfo())}toTileInfo(){return new j$6({dpi:this.dpi,origin:{x:this.origin[0],y:this.origin[1],spatialReference:this.spatialReference},size:[this.pixelSize,this.pixelSize],spatialReference:this.spatialReference,lods:this.levels.map(((e,t)=>({level:t,scale:e.scale,resolution:e.resolution})))})}getExtent(e,t,i,s){const r=this.levels[e],l=r.tileSize[0],o=r.tileSize[1];s[0]=this.origin[0]+i*l,s[2]=s[0]+l,s[3]=this.origin[1]-t*o,s[1]=s[3]-o;}convertExtentToRadians(e,i){this._isWebMercator?(i[0]=f$4(e[0]),i[1]=c$5(e[1]),i[2]=f$4(e[2]),i[3]=c$5(e[3])):this._isGCS&&(i[0]=M$3(e[0]),i[1]=M$3(e[1]),i[2]=M$3(e[2]),i[3]=M$3(e[3]));}getExtentGeometry(e,t,i,s=new M$4){return this.getExtent(e,t,i,d$3),s.spatialReference=this.spatialReference,s.xmin=d$3[0],s.ymin=d$3[1],s.xmax=d$3[2],s.ymax=d$3[3],s.zmin=void 0,s.zmax=void 0,s}ensureMaxLod(e){if(null==e)return !1;let t=!1;for(;this.levels.length<=e;){const e=this.levels[this.levels.length-1],i=e.resolution/2;this.levels.push({resolution:i,scale:e.scale/2,tileSize:[i*this.pixelSize,i*this.pixelSize]}),t=!0;}return t}capMaxLod(e){this.levels.length>e+1&&(this.levels.length=e+1);}getMaxLod(){return this.levels.length-1}scaleAtLevel(e){return this.levels[0].scale/2**e}levelAtScale(e){const t=this.levels[0].scale;return e>=t?0:Math.log(t/e)*Math.LOG2E}resolutionAtLevel(e){return this.levels[0].resolution/2**e}compatibleWith(e){if(!(e instanceof M$2)){if(M$2.checkUnsupported(e))return !1;e=new M$2(e);}if(!e.spatialReference.equals(this.spatialReference))return !1;if(e.pixelSize!==this.pixelSize)return !1;const t=Math.min(this.levels.length,e.levels.length)-1,s=this.levels[t].resolution;let r=.5*s;if(!p$3(e.origin[0],this.origin[0],r)||!p$3(e.origin[1],this.origin[1],r))return !1;return r=.5*s/2**t/this.pixelSize*v$3,p$3(s,e.levels[t].resolution,r)}rootTilesInExtent(e,t=null,i=1/0){const s=new Array,o=this.levels[0].tileSize;if(t$3(e)||0===o[0]||0===o[1])return s;M$2.computeRowColExtent(e,o,this.origin,d$3);let n=d$3[1],a=d$3[3],c=d$3[0],h=d$3[2];const u=h-c,m=a-n;if(u*m>i){const e=Math.floor(Math.sqrt(i));m>e&&(n=n+Math.floor(.5*m)-Math.floor(.5*e),a=n+e),u>e&&(c=c+Math.floor(.5*u)-Math.floor(.5*e),h=c+e);}for(let r=n;r<a;r++)for(let e=c;e<h;e++)s.push([0,r,e]);return r$4(t)&&(t[0]=this.origin[0]+c*o[0],t[1]=this.origin[1]-a*o[1],t[2]=this.origin[0]+h*o[0],t[3]=this.origin[1]-n*o[1]),s}static computeRowColExtent(e,t,i,s){const r=.001*(e[2]-e[0]+(e[3]-e[1]));s[0]=Math.max(0,Math.floor((e[0]+r-i[0])/t[0])),s[2]=Math.max(0,Math.ceil((e[2]-r-i[0])/t[0])),s[1]=Math.max(0,Math.floor((i[1]-e[3]+r)/t[1])),s[3]=Math.max(0,Math.ceil((i[1]-e[1]-r)/t[1]));}static isPowerOfTwo(e){const t=e.lods,i=t[0].resolution*2**t[0].level;return !t.some((function(e){return !x$2(e.resolution,i/2**e.level)}))}static hasGapInLevels(e){const t=e.lods.map((function(e){return e.level}));t.sort((function(e,t){return e-t}));for(let i=1;i<t.length;i++)if(t[i]!==t[0]+i)return !0;return !1}static tileSizeSupported(e){const t=e.size[1];return t===e.size[0]&&0==(t&t-1)&&t>=128&&t<=512}static checkUnsupported(t){return t$3(t)?new s$6("tilingscheme:tile-info-missing","Tiling scheme must have tiling information"):t.lods.length<1?new s$6("tilingscheme:generic","Tiling scheme must have at least one level"):M$2.isPowerOfTwo(t)?M$2.hasGapInLevels(t)?new s$6("tilingscheme:gaps","Tiling scheme levels must not have gaps between min and max level"):M$2.tileSizeSupported(t)?null:new s$6("tilingscheme:tile-size","Tiles must be square and size must be one of [128, 256, 512]"):new s$6("tilingscheme:power-of-two","Tiling scheme must be power of two")}static fromExtent(e,t){const i=e[2]-e[0],s=e[3]-e[1],r=H$1(t),l=1.2*Math.max(i,s),o=256,a=96,c=.0254,h=new M$2(new j$6({size:[o,o],origin:{x:e[0]-.5*(l-i),y:e[3]+.5*(l-s)},lods:[{level:0,resolution:l/o,scale:1/(o/a*c/(l*r))}],spatialReference:t}));return h.ensureMaxLod(20),h}static makeWebMercatorAuxiliarySphere(e){const t=new M$2(M$2.WebMercatorAuxiliarySphereTileInfo);return t.ensureMaxLod(e),t}static makeGCSWithTileSize(e,t=256,i=16){const s=256/t,r=new M$2(new j$6({size:[t,t],origin:{x:-180,y:90,spatialReference:e},spatialReference:e,lods:[{level:0,resolution:.703125*s,scale:295497598.570834*s}]}));return r.ensureMaxLod(i),r}get test(){return {isWebMercator:this._isWebMercator,isGCS:this._isGCS}}}M$2.WebMercatorAuxiliarySphereTileInfo=new j$6({size:[256,256],origin:{x:-20037508.342787,y:20037508.342787,spatialReference:k.WebMercator},spatialReference:k.WebMercator,lods:[{level:0,resolution:156543.03392800014,scale:591657527.591555}]}),M$2.WebMercatorAuxiliarySphere=M$2.makeWebMercatorAuxiliarySphere(19);const d$3=u$2();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const o$3=[0,1],t=!1,I$1=64,e=512,C=2.5,n=j$7(w$4/10),r$1=4,E$1=4,s$3=u$2();M$2.WebMercatorAuxiliarySphere.getExtent(0,0,0,s$3);const T$2=u$2([-180,-90,180,90]),a$2="Cannot extend surface to encompass all layers because it would result in too many root tiles.",u$1="Surface extent is too large for tile resolution at level 0.",H="data:image/png;base64,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",V=5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const d$2=n$2(),M$1=n$2(),j$3=n$2(),v$2=n$2();function x$1(e,o,r=0){const n=e.extent;if(t$3(n))return !1;if(0===r)return b$4(n,o);const s=Math.min(n[2]-n[0],n[3]-n[1]);return w$5(n,o,r*s)}function S$1(e,t,o,l){r$5(d$2,o),d$2[l]=t[l];const c=c$6(d$2,d$2,t),f=c$6(M$1,e,t),m=z(f,c),u=z(c,c);let p;p=m<=0?t:u<=m?o:u$3(d$2,t,d$6(c,c,m/u));const h=c$6(d$2,e,p);return Math.PI/2-Math.atan(h[2]/Math.sqrt(h[0]*h[0]+h[1]*h[1]))}function w$2(e,o,r){const n=e.extent;if(t$3(n))return 0;j$3[0]=n[0],j$3[1]=n[1],j$3[2]=r,v$2[0]=n[2],v$2[1]=n[3],v$2[2]=r;let s=1/0,i=1/0;return o[0]<j$3[0]?s=S$1(o,j$3,v$2,0):o[0]>v$2[0]&&(s=S$1(o,v$2,j$3,0)),o[1]<j$3[1]?i=S$1(o,j$3,v$2,1):o[1]>v$2[1]&&(i=S$1(o,v$2,j$3,1)),Math.min(s,i)}function R(t,r,n){if(t.spatialReference.isGeographic&&!$n(t.spatialReference))return new s$6("tilingscheme:local-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in local scenes");const s=M$2.checkUnsupported(t);if(r$4(s))return s;const i=T$1(t,n);return i||(r&&!t.spatialReference.equals(r)?new s$6("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the local scene"):null)}function T$1(t,o){const r=t.lods,n=r[0].resolution*2**r[0].level,s=[n*t.size[0],n*t.size[1]],i=[t.origin.x,t.origin.y],a=c$7(o),l=u$2();M$2.computeRowColExtent(a,s,i,l);const c=(l[2]-l[0])*(l[3]-l[1]);if(c>I$1){const o=r[0].scale*2**r[0].level;let s=Math.max((a[3]-a[1])/t.size[1],(a[2]-a[0])/t.size[0])*o/n;const i=Math.floor(Math.log(s)/Math.log(10));return s=Math.ceil(s/10**i)*10**i,new s$6("tilingscheme:too-many-root-tiles","Scale of level 0 of the tiling scheme (1:"+Math.floor(o).toLocaleString()+") is too large for the layer's extent. Suggested scale: 1:"+s.toLocaleString()+".",{level0Scale:o,suggestedLevel0Scale:s,requiredNumRootTiles:c,allowedNumRootTiles:I$1})}return null}const y$4=Object.freeze({__proto__:null,isInsideExtent:x$1,tiltToExtentEdge:w$2,checkIfTileInfoSupportedForViewSR:R});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function l$2(){return !0}function o$2(){return 0}function s$2(l,o){const s=l.lods.length-1,c=l.spatialReference,a=$n(c)||G(c)||C$1(c);if(c.isWebMercator){if(!M$2.makeWebMercatorAuxiliarySphere(s).compatibleWith(l))return new s$6("tilingscheme:incompatible-global-web-mercator","The tiling scheme is not compatible with the ArcGIS Online Web Mercator tiling scheme")}else {if(!a)return new s$6("tilingscheme:global-unsupported-spatial-reference","The tiling scheme spatial reference is not supported in global scenes");if(!M$2.makeGCSWithTileSize(l.spatialReference,l.size[0],s).compatibleWith(l))return l.spatialReference.isWGS84?new s$6("tilingscheme:incompatible-global-wgs84","The tiling scheme is not compatible with the ArcGIS Online WGS84 tiling scheme"):new s$6("tilingscheme:incompatible-global","The tiling scheme is not compatible with the ArcGIS Online tiling scheme")}if(o&&!l.spatialReference.equals(o))return new s$6("tilingscheme:spatial-reference-mismatch","The tiling scheme does not match the spatial reference of the global scene")}const c$4=Object.freeze({__proto__:null,isInsideExtent:l$2,tiltToExtentEdge:o$2,checkIfTileInfoSupportedForViewSR:s$2});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const o$1={1:c$4,2:y$4};function r(t,e){t||console.warn("Terrain: "+e);}const u=1.2,a$1=80/180*Math.PI,c$3=110/180*Math.PI;function f$2(n,l,i){const r=o$1[n.viewingMode];let f;if(r.isInsideExtent(n,l))f=c$8(n.getElevation(l[0],l[1],l[1],n.spatialReference),0);else {if(!r.isInsideExtent(n,l,u))return 0;const t=n.getTileWithElevation(l[0],l[1],l[1],n.spatialReference);f=.5*((r$4(t)?t.elevationBounds[0]:n.elevationBounds.min)+(r$4(t)?t.elevationBounds[1]:n.elevationBounds.max));const i=r.tiltToExtentEdge(n,l,f);if(i>a$1&&i<c$3)return 0}const s=l[2]-f;return Math.abs(s)<i?0:s<0?-1:1}function s$1(t){return v$1(t)?{fullExtent:t.fullExtent,minScale:t.layer.minScale,maxScale:t.layer.maxScale,tilemapCache:null}:t.layer}function d$1(t){return "vector-tile"===(null==t?void 0:t.type)}function p$1(t){return "imagery-tile"===(null==t?void 0:t.type)||"wcs"===(null==t?void 0:t.type)}function v$1(t){return "imagery-tile-3d"===(null==t?void 0:t.type)}function m$2(t){return "tile-3d"===(null==t?void 0:t.type)}function y$3(t){return "vector-tile-3d"===(null==t?void 0:t.type)}function I(t){return "wmts-3d"===(null==t?void 0:t.type)}function x(t){return "elevation-3d"===(null==t?void 0:t.type)}function E(t){return t&&(m$2(t)||v$1(t)||x(t)||y$3(t)||I(t))}function h$1(t){var n;const l=null==t||null==(n=t.sourceLayerInfo)?void 0:n.data;return r$4(l)&&"type"in l&&"raster-tile"===l.type}function T(t){var n;const l=null==t||null==(n=t.sourceLayerInfo)?void 0:n.data;return r$4(l)&&"type"in l&&"vector-tile"===l.type}function g(t){var n;const l=null==t||null==(n=t.sourceLayerInfo)?void 0:n.data;return r$4(l)&&"type"in l&&"tile-texture"===l.type}function L(t){var e;const l=null==t||null==(e=t.sourceLayerInfo)?void 0:e.data;return l instanceof HTMLImageElement||l instanceof j$4||l instanceof HTMLCanvasElement||l instanceof ImageData}function S(t){return r$4(t)&&"release"in t&&t.release(),null}function M(t){return t.fetchTile&&!1!==t.hasOverriddenFetchTile}function w$1(t,e,n,l){return o$1[l].checkIfTileInfoSupportedForViewSR(t,n,e)}function b$3(t,n,l){let i=null,o=null;if("wmts"===t.type){const e=t.activeLayer;if(e){const t=e.tileMatrixSet;if(t)i=t.tileInfo,o=t.fullExtent;else {const t=e.tileMatrixSets;if(t){const e=t.find((t=>null==w$1(t.tileInfo,t.fullExtent,n,l)));if(e)return {tileInfo:e.tileInfo,fullExtent:e.fullExtent}}}}}else o=p$1(t)?t.getCompatibleFullExtent(n):t.fullExtent,i=d$1(t)&&!j$2.force512VTL?t.compatibleTileInfo256:p$1(t)?t.getCompatibleTileInfo(n,o,2===l):t.tileInfo;return r$4(i)&&r$4(o)&&null==w$1(i,o,n,l)?{tileInfo:i,fullExtent:o}:{tileInfo:null,fullExtent:null}}const j$2={force512VTL:!1};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function i(i,d){return null!=i&&("2d"===d||("local"===d?!i.isGeographic||(i.isWGS84||4490===i.wkid):i.isWebMercator||i.isWGS84||4490===i.wkid||104971===i.wkid||104905===i.wkid||104903===i.wkid))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
async function o(e,t={}){await p(e,t),h$2(t);}async function s(e,i={}){const{basemap:r,view:n}=e;if(await r.load(i),h$2(i),0===r.baseLayers.length)return;const o=r.baseLayers.getItemAt(0);if(!e$2(o))return;if(r.spatialReference){if(n.spatialReference.equals(r.spatialReference))return;l$1();}await o.load(i),h$2(i);const s=(o.get("supportedSpatialReferences")||[o.get("tileInfo.spatialReference")]).filter(Boolean);0!==s.length&&s.every((e=>!n.spatialReference.equals(e)))&&l$1();}function l$1(){throw new s$6("basemap-compatibility:incompatible-spatial-reference","Basemap spatial reference is not compatible with the view")}async function p(a,t){const{basemap:i,view:r}=a;if(await i.load(t),0===i.baseLayers.length)return;const n=c$2(i.baseLayers.concat(i.referenceLayers));if(n.length)throw n[0];const o=i.baseLayers.getItemAt(0);try{await o.load(t);}catch(s){const a="basemap-compatibility:unknown-error",t="Unknown basemap compatibility error",{name:i=a,message:r=t,details:n}=s;throw new s$6(i,r,n)}m$1(o,r);}function c$2(a){const t=["ArcGISTiledImageServiceLayer","ArcGISTiledMapServiceLayer","OpenStreetMap","VectorTileLayer","WebTiledLayer"];return a.toArray().filter((e=>-1===t.indexOf(e.operationalLayerType))).map((a=>new s$6("basemap-compatibility:unsupported-basemap-layer-type","Unsupported basemap layer type ${operationalLayerType}",{layer:a,operationalLayerType:a.operationalLayerType||"unknown"})))}function m$1(a,t){const o=a.tileInfo;if(!o)return;const s=t.viewingMode;if(!s)return;if(!i(o.spatialReference,s))throw new s$6(`basemapgalleryitem:spatial-reference-unsupported-${s}`,`Basemap spatial reference is unsupported in ${s} mode`);if("global"===s){let t=w$1(o,a.fullExtent,null,1);if(t&&a.compatibleTileInfo256&&!w$1(a.compatibleTileInfo256,a.fullExtent,null,1)&&(t=null),t){const a=o.spatialReference.isWebMercator?"web-mercator":"wgs84";throw new s$6(`basemapgalleryitem:tiling-scheme-unsupported-${a}-global`,"Basemap tiling scheme is unsupported in global mode",{error:t})}}else if(M$2.checkUnsupported(o))throw new s$6("basemapgalleryitem:tiling-scheme-unsupported-local","Basemap tiling scheme is unsupported in local mode");const l=t.get("basemapTerrain.tilingScheme");if(l&&!l.compatibleWith(o)&&(!a.compatibleTileInfo256||!l.compatibleWith(a.compatibleTileInfo256)))throw new s$6("basemapgalleryitem:tiling-scheme-incompatible","Basemap tiling scheme is incompatible with the view")}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let l=class extends p$2{constructor(t){super(t),this._handles=new u$4,this.compatibilityFunction=null,this.error=null,this.state="loading",this.view=null;}initialize(){this._handles.add(i$5(this,["basemap.loadStatus","compatibilityFunction","view.basemapTerrain?.tilingScheme","view.ready","view.spatialReference"],(()=>this.refresh())));}destroy(){this._cancelCompatibilityCheck(),this._handles.destroy(),this._handles=null,this.basemap=null,this.compatibilityFunction=null,this.view=null;}set basemap(t){const e=this._get("basemap");e&&e.cancelLoad(),t&&t.load().catch((()=>{})),this._set("basemap",t);}refresh(){this._cancelCompatibilityCheck(),this._set("state","loading");const t=this.get("basemap.loadStatus");if("loaded"!==t&&"failed"!==t)return;if(!this.compatibilityFunction)return void("loaded"===t?(this._set("state","ready"),this._set("error",null)):(this._set("state","error"),this._set("error",this.basemap.loadError)));const e=new AbortController,{signal:s}=e;this.compatibilityFunction(this,{signal:s}).then((()=>{this._set("state","ready"),this._set("error",null);})).catch((t=>{d$4(t)||(this._set("state","error"),this._set("error",t));})),this._lastCompatibilityCheckController=e;}_cancelCompatibilityCheck(){this._lastCompatibilityCheckController&&(this._lastCompatibilityCheckController.abort(),this._lastCompatibilityCheckController=null);}};e$3([d$5()],l.prototype,"basemap",null),e$3([d$5()],l.prototype,"compatibilityFunction",void 0),e$3([d$5({readOnly:!0})],l.prototype,"error",void 0),e$3([d$5({readOnly:!0})],l.prototype,"state",void 0),e$3([d$5()],l.prototype,"view",void 0),l=e$3([i$4("esri.widgets.BasemapGallery.support.BasemapGalleryItem")],l);const c$1=l;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const a=S$2.ofType(x$3);let c=class extends p$2{constructor(r){super(r),this.basemaps=new a;}get state(){return "ready"}refresh(){}};e$3([d$5({type:a})],c.prototype,"basemaps",void 0),e$3([d$5({readOnly:!0})],c.prototype,"state",null),c=e$3([i$4("esri.widgets.BasemapGallery.support.LocalBasemapsSource")],c);const m=c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const d=S$2.ofType(x$3),f$1="esri.widgets.BasemapGallery.support.PortalBasemapsSource",y$2=s$7.getLogger(f$1);let b$2=class extends(m$4.LoadableMixin(n$3(m))){constructor(t){super(t),this._handles=new u$4,this.basemaps=new d,this.filterFunction=null,this.portal=B$1.getDefault(),this.query=null,this.updateBasemapsCallback=null;}initialize(){this._handles.add([i$5(this,["filterFunction","loadStatus","portal.basemapGalleryGroupQuery","portal.user","query","updateBasemapsCallback"],(()=>this.refresh()))]);}destroy(){this._handles.destroy(),this._handles=null,this.filterFunction=null,this.portal=null;}get state(){return "not-loaded"===this.loadStatus?"not-loaded":"loading"===this.loadStatus||this._lastPortalBasemapFetchController?"loading":"ready"}load(t){return this.addResolvingPromise(this.portal.load(t)),this.notifyChange("state"),Promise.resolve(this)}async refresh(){if("ready"!==this.state)return;this._lastPortalBasemapFetchController&&(this._lastPortalBasemapFetchController.abort(),this._lastPortalBasemapFetchController=null);const t=this.portal,e=new AbortController;this._lastPortalBasemapFetchController=e,this.notifyChange("state");try{const s=await t.fetchBasemaps(this._toQueryString(this.query),e);this._updateBasemaps(s);}catch(s){if(d$4(s))throw s;y$2.warn(new s$6("basemap-source:fetch-basemaps-error","Could not fetch basemaps from portal.",{error:s})),this._updateBasemaps();}this._lastPortalBasemapFetchController=null,this.notifyChange("state");}_toQueryString(t){return t&&"string"!=typeof t?Object.keys(t).map((e=>`${e}:${t[e]}`)).join(" AND "):t}_updateBasemaps(t=[]){let e=this.filterFunction?t.filter(this.filterFunction):t;e=this.updateBasemapsCallback?this.updateBasemapsCallback(e):e,this.basemaps.removeAll(),this.basemaps.addMany(e);}};e$3([d$5({readOnly:!0,type:d})],b$2.prototype,"basemaps",void 0),e$3([d$5()],b$2.prototype,"filterFunction",void 0),e$3([d$5({type:B$1})],b$2.prototype,"portal",void 0),e$3([d$5()],b$2.prototype,"query",void 0),e$3([d$5({readOnly:!0})],b$2.prototype,"state",null),e$3([d$5()],b$2.prototype,"updateBasemapsCallback",void 0),b$2=e$3([i$4(f$1)],b$2);const j$1=b$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const y$1=S$2.ofType(c$1);function b$1(t){return t&&"esri.portal.Portal"===t.declaredClass}function f(t){return t&&!(t instanceof j$1)&&(!!t.portal||!!t.query)}function v(t){return t&&"basemaps"in t&&"state"in t&&"refresh"in t}let w=class extends m$4{constructor(t){super(t),this._handles=new u$4,this.activeBasemap=null,this.items=new y$1,this.source=new j$1,this.view=null;}initialize(){const t=()=>this._recreateItems();this._handles.add([f$5(this,["compatibilityFunction","state"],(()=>this._updateItems())),$(this,"source.basemaps","change",t,t)]);}destroy(){this._handles.destroy(),this._handles=null;}get compatibilityFunction(){if(void 0===this._get("compatibilityFunction")){return "3d"===this.get("view.type")?o:s}return this._get("compatibilityFunction")}set compatibilityFunction(t){this._set("compatibilityFunction",t);}castSource(t){return Array.isArray(t)||S$2.isCollection(t)?new m({basemaps:t}):b$1(t)?new j$1({portal:t}):f(t)?new j$1(t):v(t)?t:null}get state(){return this.get("view.ready")&&this.source?"ready":"disabled"}basemapEquals(t,e){return b$5(t,e)}refresh(){this._recreateItems();}load(t){return this.addResolvingPromise(m$4.isLoadable(this.source)?this.source.load(t):Promise.resolve()),Promise.resolve(this)}_recreateItems(){const t=this.get("source.basemaps"),{view:e,compatibilityFunction:s}=this;this.items.removeAll().forEach((t=>t.destroy())),this.items.addMany(t.map((t=>new c$1({basemap:t,compatibilityFunction:s,view:e}))));}_updateItems(){this.items.forEach((t=>{t.compatibilityFunction=this.compatibilityFunction,t.view=this.view;}));}};e$3([d$5({aliasOf:"view.map.basemap"})],w.prototype,"activeBasemap",void 0),e$3([d$5()],w.prototype,"compatibilityFunction",null),e$3([d$5({readOnly:!0,type:y$1})],w.prototype,"items",void 0),e$3([d$5()],w.prototype,"source",void 0),e$3([c$9("source")],w.prototype,"castSource",null),e$3([d$5({readOnly:!0})],w.prototype,"state",null),e$3([d$5()],w.prototype,"view",void 0),w=e$3([i$4("esri.widgets.BasemapGallery.BasemapGalleryViewModel")],w);const j=w;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const h={base:"esri-basemap-gallery esri-widget esri-widget--panel-height-only",sourceLoading:"esri-basemap-gallery--source-loading",loader:"esri-basemap-gallery__loader",item:"esri-basemap-gallery__item",itemContainer:"esri-basemap-gallery__item-container",itemTitle:"esri-basemap-gallery__item-title",itemThumbnail:"esri-basemap-gallery__item-thumbnail",selectedItem:"esri-basemap-gallery__item--selected",itemLoading:"esri-basemap-gallery__item--loading",itemError:"esri-basemap-gallery__item--error",emptyMessage:"esri-widget__content--empty",widgetIcon:"esri-icon-basemap",disabled:"esri-disabled"};let y=class extends z$1{constructor(e,s){super(e,s),this._handles=new u$4,this.activeBasemap=null,this.disabled=!1,this.headingLevel=2,this.iconClass=h.widgetIcon,this.label=void 0,this.messages=null,this.source=null,this.view=null,this.viewModel=new j;}initialize(){const e=this._handles;this.own([$(this,"viewModel.items","change",(s=>{const a="basemap-gallery-item-changes",{added:t,moved:i}=s;e.remove(a),e.add([...t,...i].map((e=>e.watch("state",(()=>this.scheduleRender())))),a),this.scheduleRender();})),e,a$4(this,"source",(()=>this.viewModel.load()))]);}render(){const e="loading"===this.get("source.state"),s=this.disabled||"disabled"===this.get("viewModel.state"),a=this.get("viewModel.items").toArray().map(this._renderBasemapGalleryItem,this),t={[h.sourceLoading]:e,[h.disabled]:s},i=e?n$4("div",{class:h.loader,key:"esri-basemap-gallery__loader"}):null,r=e?null:a.length>0?n$4("ul",{class:h.itemContainer,key:"esri-basemap-gallery__item-container",role:"menu"},a):n$4("div",{class:h.emptyMessage,key:"esri-basemap-gallery__empty-message"},n$4(s$8,{level:this.headingLevel},this.messages.noBasemaps));return n$4("div",{class:this.classes(h.base,t)},i,r)}_handleClick(e){const s=e.currentTarget["data-item"];"ready"===s.state&&(this.activeBasemap=s.basemap);}_renderBasemapGalleryItem(e){const a=e.get("basemap.thumbnailUrl")||a$5("esri/themes/base/images/basemap-toggle-64.svg"),t=e.get("basemap.title"),i=e.get("basemap.portalItem.snippet"),r=e.get("error.message")||i||t,{viewModel:o}=this,l=!this.disabled&&"ready"===o.state&&"ready"===e.state?0:-1,m=o.basemapEquals(e.basemap,this.activeBasemap),d={[h.selectedItem]:m,[h.itemLoading]:"loading"===e.state,[h.itemError]:"error"===e.state};return n$4("li",{"aria-selected":m.toString(),bind:this,class:this.classes(h.item,d),"data-item":e,onkeydown:this._handleClick,onclick:this._handleClick,role:"menuitem",tabIndex:l,title:r},n$4("img",{alt:"",class:h.itemThumbnail,src:a}),n$4("div",{class:h.itemTitle},t))}};e$3([o$4("viewModel.activeBasemap")],y.prototype,"activeBasemap",void 0),e$3([d$5()],y.prototype,"disabled",void 0),e$3([d$5()],y.prototype,"headingLevel",void 0),e$3([d$5()],y.prototype,"iconClass",void 0),e$3([d$5({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],y.prototype,"label",void 0),e$3([d$5(),e$5("esri/widgets/BasemapGallery/t9n/BasemapGallery")],y.prototype,"messages",void 0),e$3([o$4("viewModel.source")],y.prototype,"source",void 0),e$3([o$4("viewModel.view")],y.prototype,"view",void 0),e$3([d$5()],y.prototype,"viewModel",void 0),e$3([t$4()],y.prototype,"_handleClick",null),y=e$3([i$4("esri.widgets.BasemapGallery")],y);const b=y;

const arcgisBasemapGalleryCss = "@import url('https://js.arcgis.com/next/esri/themes/light/main.css');arcgis-basemap-gallery{min-width:300px;min-height:240px}";

let ArcGISBasemapGallery = class {
  constructor(hostRef) {
    registerInstance(this, hostRef);
    this.loaded = createEvent(this, "loaded", 7);
    this.position = 'bottom-left';
  }
  validateView(value) {
    if (value) {
      this.widget.view = value;
      if (this.el.parentElement.tagName.toLowerCase() !== 'arcgis-expand') {
        this.widget.view.ui.add(this.widget, this.position);
      }
    }
  }
  componentWillLoad() {
    const bmg = new b({
      container: this.el,
    });
    this.widget = bmg;
    if (this.view) {
      bmg.view = this.view;
    }
    this.loaded.emit(true);
  }
  get el() { return getElement(this); }
  static get watchers() { return {
    "view": ["validateView"]
  }; }
};
ArcGISBasemapGallery.style = arcgisBasemapGalleryCss;

export { ArcGISBasemapGallery as arcgis_basemap_gallery };
