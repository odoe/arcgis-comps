import{s as e,A as n,D as t,bJ as r,bi as i}from"./p-e58503d5.js";const o=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),a=new Set(["csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","map-image","map-notes","ogc-feature","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function s(e){return!("feature"!==e.type||e.url||!e.source||"memory"!==e.source.type)}function l(e,t){if(t.restrictedWebMapWriting){const r=function(e){return"basemap"===e.layerContainerType?o:"operational-layers"===e.layerContainerType?a:null}(t);return!n(r)||r.has(e.type)&&!s(e)}return!0}function u(e,n){if(s(e)){const t=i("featureCollection.layers",n),r=t&&t[0]&&t[0].layerDefinition;r&&m(e,r)}else"stream"===e.type?m(e,n.layerDefinition=n.layerDefinition||{}):"group"!==e.type&&m(e,n)}function m(e,n){"maxScale"in e&&(n.maxScale=r(e.maxScale)),"minScale"in e&&(n.minScale=r(e.minScale))}function p(i,o,a){if(!("write"in i)||!i.write)return a&&a.messages&&a.messages.push(new e("layer:unsupported",`Layers (${i.title}, ${i.id}) of type '${i.declaredClass}' cannot be persisted`,{layer:i})),null;if(l(i,a)){const e={};return i.write(e,a)?e:null}return n(o)&&function(e,n){if(u(e,n),"blendMode"in e&&(n.blendMode=e.blendMode,"normal"===n.blendMode&&delete n.blendMode),n.opacity=r(e.opacity),n.title=e.title||"Layer",n.visibility=e.visible,"legendEnabled"in e&&"wmts"!==e.type)if(s(e)){const t=n.featureCollection;t&&(t.showLegend=e.legendEnabled)}else n.showLegend=e.legendEnabled}(i,o=t(o)),o}export{p as y}