import{bO as t}from"./p-e58503d5.js";import{e as n}from"./p-2f398ed1.js";const r=(()=>{if(!("document"in t))return()=>null;const n=document.createElement("canvas"),r=n.getContext("2d");return n.height=512,n.width=1,t=>{r.clearRect(0,0,1,n.height);const o=r.createLinearGradient(0,0,0,n.height);for(const{ratio:n,color:r}of t.colorStops)o.addColorStop(Math.max(n,.001),`rgba(${r[0]}, ${r[1]}, ${r[2]}, ${r[3]})`);return r.fillStyle=o,r.fillRect(0,0,1,n.height),r.getImageData(0,0,1,n.height).data}})();function o(t,n,r,o){const{blurRadius:e,fieldOffset:a,field:f}=n,c=new Float64Array(r*o),i=function(t){const n=Math.round(3*t),r=2*t*t,o=new Float64Array(2*n+1);for(let e=0;e<=o.length;e++)o[e]=Math.exp(-((e-n)**2)/r)/Math.sqrt(2*Math.PI)*(t/2);return o}(e),s=Math.round(3*e);let u,l=Number.NEGATIVE_INFINITY;const h=function(t,n){return null!=t?"string"==typeof n?n=>-1*+n.readAttribute(t):r=>+r.readAttribute(t)+n:()=>1}(f,a),M=new Set;for(const n of t){const t=n.getCursor();for(;t.next();){const n=t.getObjectId();if(M.has(n))continue;M.add(n);const e=t.readLegacyPointGeometry(),a=128;if(e.x<-a||e.x>=r+a||e.y<-a||e.y>o+a)continue;const f=+h(t),m=Math.round(e.x)-s,d=Math.round(e.y)-s,w=Math.max(0,m),y=Math.max(0,d),A=Math.min(o,Math.round(e.y)+s),p=Math.min(r,Math.round(e.x)+s);for(let t=y;t<A;t++){const n=i[t-d];for(let o=w;o<p;o++)u=c[t*r+o]+=n*i[o-m]*f,u>l&&(l=u)}}}return{matrix:c.buffer,max:l}}function e(t,r,o,e,a,f){t.canvas.width=t.canvas.height=r,t.clearRect(0,0,r,r);const c=t.getImageData(0,0,r,r);o&&e&&c.data.set(new Uint8ClampedArray(function(t,r,o,e,a){const f=new Uint32Array(t*t),c="buffer"in r?r:new Float64Array(r),i="buffer"in o?new Uint32Array(o.buffer):new Uint32Array(new Uint8Array(o).buffer),s=i.length/(a-e);for(let t=0;t<c.length;t++){const r=Math.floor((c[t]-e)*s);f[t]=i[n(r,0,i.length-1)]}return f.buffer}(r,o,e,a,f))),t.putImageData(c,0,0)}export{e as a,r as n,o}