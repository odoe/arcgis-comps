import{ey as n,ez as t,eA as s,eB as e,eC as i,e2 as r,eD as o,r as u,eE as a}from"./p-5420851c.js";import{t as c}from"./p-50ff864e.js";const l=[0,0];function f(n,t){if(!t)return null;if("x"in t){const s={x:0,y:0};return[s.x,s.y]=n(t.x,t.y,l),null!=t.z&&(s.z=t.z),null!=t.m&&(s.m=t.m),s}if("xmin"in t){const s={xmin:0,ymin:0,xmax:0,ymax:0};return[s.xmin,s.ymin]=n(t.xmin,t.ymin,l),[s.xmax,s.ymax]=n(t.xmax,t.ymax,l),t.hasZ&&(s.zmin=t.zmin,s.zmax=t.zmax,s.hasZ=!0),t.hasM&&(s.mmin=t.mmin,s.mmax=t.mmax,s.hasM=!0),s}return"rings"in t?{rings:h(t.rings,n),hasM:t.hasM,hasZ:t.hasZ}:"paths"in t?{paths:h(t.paths,n),hasM:t.hasM,hasZ:t.hasZ}:"points"in t?{points:p(t.points,n),hasM:t.hasM,hasZ:t.hasZ}:void 0}function h(n,t){const s=[];for(const e of n)s.push(p(e,t));return s}function p(n,t){const s=[];for(const e of n){const n=t(e[0],e[1],[0,0]);s.push(n),e.length>2&&n.push(e[2]),e.length>3&&n.push(e[3])}return s}async function m(n,t){if(!t)return;const s=Array.isArray(n)?n.map((n=>u(n.geometry)&&n.geometry.spatialReference)):[n];await a(s.map((n=>({source:n,dest:t}))))}const x=f.bind(null,n),y=f.bind(null,t);function g(n,t,u){return n?(u||(u=t,t=n.spatialReference),s(t)&&s(u)&&!e(t,u)?i(t,u)?r(u)?x(n):y(n):o(c,[n],t,u,null)[0]:n):n}const R=new class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}async push(n,t,s){if(!n||!n.length||!t||!s||e(t,s))return n;const i={geometries:n,inSpatialReference:t,outSpatialReference:s,resolve:null};return this._jobs.push(i),new Promise((n=>{i.resolve=n,null===this._timer&&(this._timer=setTimeout(this._process,10))}))}_process(){this._timer=null;const n=this._jobs.shift();if(!n)return;const{geometries:t,inSpatialReference:s,outSpatialReference:e,resolve:u}=n;i(s,e)?r(e)?u(t.map(x)):u(t.map(y)):u(o(c,t,s,e,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}};function S(n,t,s){return R.push(n,t,s)}export{S as M,m as f,g}