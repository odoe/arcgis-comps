import{e,d as t,i,a1 as s,D as n,N as r,f as l,a2 as a,aT as o,c as u,aV as h,a3 as p,s as c,p as d,an as y}from"./p-e58503d5.js";import{m as v,p as m}from"./p-e0d9ff4c.js";import{r as w,c as b,F as f,b as g}from"./p-765e6c28.js";import{c as V,a as S}from"./p-08e5f531.js";import{o as x}from"./p-fb38a9d0.js";import{n as j,i as z,l as T}from"./p-dfc6337f.js";import{viewScaleRE as E}from"./p-9f1c2d50.js";var I;let D=I=class extends s{constructor(e){super(e),this.minValue=0,this.maxValue=0}clone(){return new I({minValue:this.minValue,maxValue:this.maxValue})}};e([t({type:Number,json:{write:!0}})],D.prototype,"minValue",void 0),e([t({type:Number,json:{write:!0}})],D.prototype,"maxValue",void 0),D=I=e([i("esri.renderer.support.AuthoringInfoClassBreakInfo")],D);const O=D;var k;let N=k=class extends s{constructor(e){super(e),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[]}clone(){return new k({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:n(this.classBreakInfos)})}};e([t({type:String,json:{write:!0}})],N.prototype,"field",void 0),e([t({type:String,json:{write:!0}})],N.prototype,"normalizationField",void 0),e([t({type:String,json:{write:!0}})],N.prototype,"label",void 0),e([t({type:[O],json:{write:!0}})],N.prototype,"classBreakInfos",void 0),N=k=e([i("esri.renderers.support.AuthoringInfoFieldInfo")],N);const F=N;var $;const M=new r({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),C=new r({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),R={key:e=>"number"==typeof e?"number":"string",typeMap:{number:Number,string:String},base:null},A=["high-to-low","above-and-below","centered-on","extremes"],q=[...new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below","high-to-low","above-and-below","90-10","above","below"])],H=["seconds","minutes","hours","days","months","years"];let U=$=class extends s{constructor(e){super(e),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(e){return"string"==typeof e||"number"==typeof e?e:null}castStartTime(e){return"string"==typeof e||"number"==typeof e?e:null}get style(){return"color"===this.type?this._get("style"):null}set style(e){this._set("style",e)}get theme(){return"color"===this.type||"size"===this.type?this._get("theme")||"high-to-low":null}set theme(e){this._set("theme",e)}clone(){return new $({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};e([t({types:R,json:{write:!0}})],U.prototype,"endTime",void 0),e([l("endTime")],U.prototype,"castEndTime",null),e([t({type:String,json:{write:!0}})],U.prototype,"field",void 0),e([t({type:Number,json:{write:!0}})],U.prototype,"maxSliderValue",void 0),e([t({type:Number,json:{write:!0}})],U.prototype,"minSliderValue",void 0),e([t({types:R,json:{write:!0}})],U.prototype,"startTime",void 0),e([l("startTime")],U.prototype,"castStartTime",null),e([t({type:M.apiValues,value:null,json:{type:M.jsonValues,read:M.read,write:M.write}})],U.prototype,"style",null),e([t({type:q,value:null,json:{type:q,origins:{"web-scene":{type:A,write:{writer:(e,t)=>{A.indexOf(e)>-1&&(t.theme=e)}}}},write:!0}})],U.prototype,"theme",null),e([t({type:C.apiValues,json:{type:C.jsonValues,read:C.read,write:C.write}})],U.prototype,"type",void 0),e([t({type:H,json:{type:H,write:!0}})],U.prototype,"units",void 0),U=$=e([i("esri.renderers.support.AuthoringInfoVisualVariable")],U);const L=U;var B;const W=new r({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),_=new r({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),J=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"];let P=B=class extends s{constructor(e){super(e),this.colorRamp=null,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const e=this._get("classificationMethod"),t=this.type;return t&&"relationship"!==t?"class-breaks-size"===t||"class-breaks-color"===t?e||"manual":null:e}set classificationMethod(e){this._set("classificationMethod",e)}readColorRamp(e){if(e)return m(e)}get fields(){return this.type&&"predominance"!==this.type?null:this._get("fields")}set fields(e){this._set("fields",e)}get field1(){return this.type&&"relationship"!==this.type?null:this._get("field1")}set field1(e){this._set("field1",e)}get field2(){return this.type&&"relationship"!==this.type?null:this._get("field2")}set field2(e){this._set("field2",e)}get focus(){return this.type&&"relationship"!==this.type?null:this._get("focus")}set focus(e){this._set("focus",e)}get numClasses(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")}set numClasses(e){this._set("numClasses",e)}get statistics(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("statistics"):null}set statistics(e){this._set("statistics",e)}get standardDeviationInterval(){const e=this.type;return e&&"relationship"!==e&&"class-breaks-size"!==e&&"class-breaks-color"!==e||this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")}set standardDeviationInterval(e){this._set("standardDeviationInterval",e)}get type(){return this._get("type")}set type(e){let t=e;"classed-size"===e?t="class-breaks-size":"classed-color"===e&&(t="class-breaks-color"),this._set("type",t)}get univariateSymbolStyle(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(e){this._set("univariateSymbolStyle",e)}get univariateTheme(){return"univariate-color-size"===this.type?this._get("univariateTheme"):null}set univariateTheme(e){this._set("univariateTheme",e)}clone(){return new B({classificationMethod:this.classificationMethod,colorRamp:n(this.colorRamp),fields:this.fields&&this.fields.slice(0),field1:n(this.field1),field2:n(this.field2),focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((e=>e.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme})}};e([t({type:W.apiValues,value:null,json:{type:W.jsonValues,read:W.read,write:W.write,origins:{"web-document":{default:"manual",type:W.jsonValues,read:W.read,write:W.write}}}})],P.prototype,"classificationMethod",null),e([t({types:v,json:{write:!0}})],P.prototype,"colorRamp",void 0),e([a("colorRamp")],P.prototype,"readColorRamp",null),e([t({type:[String],value:null,json:{write:!0}})],P.prototype,"fields",null),e([t({type:F,value:null,json:{write:!0}})],P.prototype,"field1",null),e([t({type:F,value:null,json:{write:!0}})],P.prototype,"field2",null),e([t({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],P.prototype,"focus",null),e([t({type:Number,value:null,json:{type:o,write:!0}})],P.prototype,"numClasses",null),e([t({type:J,json:{type:J,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],P.prototype,"lengthUnit",void 0),e([t({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],P.prototype,"maxSliderValue",void 0),e([t({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],P.prototype,"minSliderValue",void 0),e([t({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],P.prototype,"statistics",null),e([t({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],P.prototype,"standardDeviationInterval",null),e([t({type:_.apiValues,value:null,json:{type:_.jsonValues,read:_.read,write:_.write}})],P.prototype,"type",null),e([t({type:[L],json:{write:!0}})],P.prototype,"visualVariables",void 0),e([t({type:["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P.prototype,"univariateSymbolStyle",null),e([t({type:["high-to-low","above-and-below","above","below","90-10"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],P.prototype,"univariateTheme",null),P=B=e([i("esri.renderers.support.AuthoringInfo")],P);const Q=P,G=new r({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary"},{ignoreUnknown:!0});let K=class extends s{constructor(e){super(e),this.authoringInfo=null,this.type=null}async getRequiredFields(e){if(!this.collectRequiredFields)return[];const t=new Set;return await this.collectRequiredFields(t,e),Array.from(t).sort()}getSymbol(e,t){}async getSymbolAsync(e,t){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};e([t({type:Q,json:{write:!0}})],K.prototype,"authoringInfo",void 0),e([t({type:G.apiValues,readOnly:!0,json:{type:G.jsonValues,read:!1,write:{writer:G.write,ignoreOrigin:!0}}})],K.prototype,"type",void 0),K=e([i("esri.renderers.Renderer")],K);const X=K;var Y;let Z=Y=class extends V{constructor(){super(...arguments),this.showLegend=null}clone(){return new Y({title:this.title,showLegend:this.showLegend})}};e([t({type:Boolean,json:{write:!0}})],Z.prototype,"showLegend",void 0),Z=Y=e([i("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],Z);const ee=Z,te=u.getLogger("esri.renderers.visualVariables.VisualVariable"),ie=new r({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let se=class extends s{constructor(e){super(e),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(e){return null==e?e:"function"==typeof e?(te.error(".field: field must be a string value"),null):h(e)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};e([t()],se.prototype,"index",void 0),e([t({type:ie.apiValues,readOnly:!0,json:{read:ie.read,write:ie.write}})],se.prototype,"type",void 0),e([t({type:String,json:{write:!0}})],se.prototype,"field",void 0),e([l("field")],se.prototype,"castField",null),e([t({type:String,json:{write:!0}})],se.prototype,"valueExpression",void 0),e([t({type:String,json:{write:!0}})],se.prototype,"valueExpressionTitle",void 0),e([t({readOnly:!0})],se.prototype,"arcadeRequired",null),e([t({type:ee,json:{write:!0}})],se.prototype,"legendOptions",void 0),se=e([i("esri.renderers.visualVariables.VisualVariable")],se);const ne=se;var re;let le=re=class extends ne{constructor(e){super(e),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)),this._set("stops",e)}clone(){return new re({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((e=>e.clone())),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};e([t({readOnly:!0})],le.prototype,"cache",null),e([t({type:["color"],json:{type:["colorInfo"]}})],le.prototype,"type",void 0),e([t({type:String,json:{write:!0}})],le.prototype,"normalizationField",void 0),e([t({type:[S],json:{write:!0}})],le.prototype,"stops",null),le=re=e([i("esri.renderers.visualVariables.ColorVariable")],le);const ae=le;var oe;let ue=oe=class extends s{constructor(e){super(e),this.label=null,this.opacity=null,this.value=null}readOpacity(e,t){return w(t.transparency)}writeOpacity(e,t,i){t[i]=b(e)}clone(){return new oe({label:this.label,opacity:this.opacity,value:this.value})}};e([t({type:String,json:{write:!0}})],ue.prototype,"label",void 0),e([t({type:Number,json:{type:o,write:{target:"transparency"}}})],ue.prototype,"opacity",void 0),e([a("opacity",["transparency"])],ue.prototype,"readOpacity",null),e([p("opacity")],ue.prototype,"writeOpacity",null),e([t({type:Number,json:{write:!0}})],ue.prototype,"value",void 0),ue=oe=e([i("esri.renderers.visualVariables.support.OpacityStop")],ue);const he=ue;var pe;let ce=pe=class extends ne{constructor(e){super(e),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(e){e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)),this._set("stops",e)}clone(){return new pe({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((e=>e.clone())),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};e([t({readOnly:!0})],ce.prototype,"cache",null),e([t({type:["opacity"],json:{type:["transparencyInfo"]}})],ce.prototype,"type",void 0),e([t({type:String,json:{write:!0}})],ce.prototype,"normalizationField",void 0),e([t({type:[he],json:{write:!0}})],ce.prototype,"stops",null),ce=pe=e([i("esri.renderers.visualVariables.OpacityVariable")],ce);const de=ce;var ye;let ve=ye=class extends ne{constructor(e){super(e),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(e,t,i,s){s&&s.messages&&s.messages.push(new c("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:`visualVariables[${this.index}].valueExpressionTitle`,context:s}))}clone(){return new ye({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})}};e([t({readOnly:!0})],ve.prototype,"cache",null),e([t({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],ve.prototype,"axis",void 0),e([t({type:["rotation"],json:{type:["rotationInfo"]}})],ve.prototype,"type",void 0),e([t({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],ve.prototype,"rotationType",void 0),e([t({type:String,json:{write:!0}})],ve.prototype,"valueExpressionTitle",void 0),e([p("web-scene","valueExpressionTitle")],ve.prototype,"writeValueExpressionTitleWebScene",null),ve=ye=e([i("esri.renderers.visualVariables.RotationVariable")],ve);const me=ve;var we;let be=we=class extends s{constructor(e){super(e),this.label=null,this.size=null,this.value=null}clone(){return new we({label:this.label,size:this.size,value:this.value})}};e([t({type:String,json:{write:!0}})],be.prototype,"label",void 0),e([t({type:Number,cast:x,json:{write:!0}})],be.prototype,"size",void 0),e([t({type:Number,json:{write:!0}})],be.prototype,"value",void 0),be=we=e([i("esri.renderers.visualVariables.support.SizeStop")],be);const fe=be;var ge;let Ve=ge=class extends ee{constructor(){super(...arguments),this.customValues=null}clone(){return new ge({title:this.title,showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})}};e([t({type:[Number],json:{write:!0}})],Ve.prototype,"customValues",void 0),Ve=ge=e([i("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],Ve);const Se=Ve;var xe;const je=u.getLogger("esri.renderers.visualVariables.SizeVariable"),ze=new r({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),Te=new r({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function Ee(e){if(null!=e)return"string"==typeof e||"number"==typeof e?x(e):"size"===e.type?j(e)?e:(delete(e={...e}).type,new De(e)):void 0}function Ie(e,t,i){if("object"!=typeof e)return e;const s=new De;return s.read(e,i),s}let De=xe=class extends ne{constructor(e){super(e),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:E.test(this.valueExpression)}}set expression(e){je.warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),"view.scale"===e?(this.valueExpression="$view.scale",this._set("expression",e)):this._set("expression",null)}set index(e){j(this.maxSize)&&(this.maxSize.index=`visualVariables[${e}].maxSize`),j(this.minSize)&&(this.minSize.index=`visualVariables[${e}].minSize`),this._set("index",e)}get inputValueType(){return z(this)}set maxDataValue(e){e&&this.stops&&(je.warn("cannot set maxDataValue when stops is not null."),e=null),this._set("maxDataValue",e)}set maxSize(e){e&&this.stops&&(je.warn("cannot set maxSize when stops is not null."),e=null),this._set("maxSize",e)}castMaxSize(e){return Ee(e)}readMaxSize(e,t,i){return Ie(e,0,i)}set minDataValue(e){e&&this.stops&&(je.warn("cannot set minDataValue when stops is not null."),e=null),this._set("minDataValue",e)}set minSize(e){e&&this.stops&&(je.warn("cannot set minSize when stops is not null."),e=null),this._set("minSize",e)}castMinSize(e){return Ee(e)}readMinSize(e,t,i){return Ie(e,0,i)}get arcadeRequired(){return!!this.valueExpression||this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired}set stops(e){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?e&&Array.isArray(e)&&(e=e.filter((e=>!!e))).sort(((e,t)=>e.value-t.value)):e&&(je.warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),e=null),this._set("stops",e)}get transformationType(){return T(this,this.inputValueType)}readValueExpression(e,t){return e||t.expression&&"$view.scale"}writeValueExpressionWebScene(e,t,i,s){if("$view.scale"===e){if(s&&s.messages){const e=this.index;s.messages.push(new c("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:("string"==typeof e?e:`visualVariables[${e}]`)+".valueExpression",context:s}))}}else t[i]=e}readValueUnit(e){return e?Te.read(e):null}clone(){return new xe({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:j(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:j(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map((e=>e.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})}flipSizes(){if("clamped-linear"===this.transformationType){const{minSize:e,maxSize:t}=this;return this.minSize=t,this.maxSize=e,this}if("stops"===this.transformationType){const e=this.stops,t=e.map((e=>e.size)).reverse(),i=e.length;for(let s=0;s<i;s++)e[s].size=t[s];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((e=>e.value||0))}};e([t({readOnly:!0})],De.prototype,"cache",null),e([t({type:ze.apiValues,json:{type:ze.jsonValues,origins:{"web-map":{read:!1}},read:ze.read,write:ze.write}})],De.prototype,"axis",void 0),e([t({type:String,value:null,json:{read:!1}})],De.prototype,"expression",null),e([t()],De.prototype,"index",null),e([t({type:String,readOnly:!0})],De.prototype,"inputValueType",null),e([t({type:Se,json:{write:!0}})],De.prototype,"legendOptions",void 0),e([t({type:Number,value:null,json:{write:!0}})],De.prototype,"maxDataValue",null),e([t({type:Number,value:null,json:{write:!0}})],De.prototype,"maxSize",null),e([l("maxSize")],De.prototype,"castMaxSize",null),e([a("maxSize")],De.prototype,"readMaxSize",null),e([t({type:Number,value:null,json:{write:!0}})],De.prototype,"minDataValue",null),e([t({type:Number,value:null,json:{write:!0}})],De.prototype,"minSize",null),e([l("minSize")],De.prototype,"castMinSize",null),e([a("minSize")],De.prototype,"readMinSize",null),e([t({type:String,json:{write:!0}})],De.prototype,"normalizationField",void 0),e([t({readOnly:!0})],De.prototype,"arcadeRequired",null),e([t({type:String})],De.prototype,"scaleBy",void 0),e([t({type:[fe],value:null,json:{write:!0}})],De.prototype,"stops",null),e([t({type:["outline"],json:{write:!0}})],De.prototype,"target",void 0),e([t({type:String,readOnly:!0})],De.prototype,"transformationType",null),e([t({type:["size"],json:{type:["sizeInfo"]}})],De.prototype,"type",void 0),e([t({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],De.prototype,"useSymbolValue",void 0),e([t({type:String,json:{write:!0}})],De.prototype,"valueExpression",void 0),e([a("valueExpression",["valueExpression","expression"])],De.prototype,"readValueExpression",null),e([p("web-scene","valueExpression")],De.prototype,"writeValueExpressionWebScene",null),e([t({type:["radius","diameter","area","width","distance"],json:{write:!0}})],De.prototype,"valueRepresentation",void 0),e([t({type:Te.apiValues,json:{write:Te.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],De.prototype,"valueUnit",void 0),e([a("valueUnit")],De.prototype,"readValueUnit",null),De=xe=e([i("esri.renderers.visualVariables.SizeVariable")],De);const Oe=De,ke=u.getLogger("esri.renderers.visualVariables.VisualVariableFactory"),Ne={color:ae,size:Oe,opacity:de,rotation:me},Fe=new r({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),$e=/^\[([^\]]+)\]$/i;let Me=class extends d{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(e){if(this._resetVariables(),(e=e&&e.filter((e=>!!e)))&&e.length){for(const t of e)switch(t.type){case"color":this.colorVariables.push(t);break;case"opacity":this.opacityVariables.push(t);break;case"rotation":this.rotationVariables.push(t);break;case"size":this.sizeVariables.push(t)}this.sizeVariables.length&&this.sizeVariables.some((e=>!!e.target))&&e.sort(((e,t)=>{let i=null;return i=e.target===t.target?0:e.target?1:-1,i}));for(let t=0;t<e.length;t++)e[t].index=t;this._set("visualVariables",e)}else this._set("visualVariables",e)}readVariables(e,t,i){const{rotationExpression:s,rotationType:n}=t,r=s&&s.match($e),l=r&&r[1];if(l&&(e||(e=[]),e.push({type:"rotationInfo",rotationType:n,field:l})),e)return e.map((e=>{const t=Fe.read(e.type),s=Ne[t];s||(ke.warn(`Unknown variable type: ${t}`),i&&i.messages&&i.messages.push(new y("visual-variable:unsupported",`visualVariable of type '${t}' is not supported`,{definition:e,context:i})));const n=new s;return n.read(e,i),n}))}writeVariables(e,t){const i=[];for(const s of e){const e=s.toJSON(t);e&&i.push(e)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};e([t()],Me.prototype,"visualVariables",null),Me=e([i("esri.renderers.visualVariables.VisualVariableFactory")],Me);const Ce=Me,Re={base:ne,key:"type",typeMap:{opacity:de,color:ae,rotation:me,size:Oe}},Ae=s=>{let n=class extends s{constructor(){super(...arguments),this._vvFactory=new Ce}set visualVariables(e){this._vvFactory.visualVariables=e,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(e,t,i){return this._vvFactory.readVariables(e,t,i)}writeVisualVariables(e,t,i,s){t[i]=this._vvFactory.writeVariables(e,s)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const e of this.visualVariables)if(e.arcadeRequired)return!0;return!1}hasVisualVariables(e,t){return e?this.getVisualVariablesForType(e,t).length>0:this.getVisualVariablesForType("size",t).length>0||this.getVisualVariablesForType("color",t).length>0||this.getVisualVariablesForType("opacity",t).length>0||this.getVisualVariablesForType("rotation",t).length>0}getVisualVariablesForType(e,t){const i=this.visualVariables;return i?i.filter((i=>i.type===e&&("string"==typeof t?i.target===t:!1!==t||!i.target))):[]}async collectVVRequiredFields(e,t){let i=[];this.visualVariables&&(i=i.concat(this.visualVariables));for(const s of i)s&&(s.field&&f(e,t,s.field),s.normalizationField&&f(e,t,s.normalizationField),s.valueExpression&&await g(e,t,s.valueExpression))}};return e([t({types:[Re],value:null,json:{write:!0}})],n.prototype,"visualVariables",null),e([a("visualVariables",["visualVariables","rotationType","rotationExpression"])],n.prototype,"readVisualVariables",null),e([p("visualVariables")],n.prototype,"writeVisualVariables",null),n=e([i("esri.renderers.mixins.VisualVariablesMixin")],n),n};export{Se as a,Oe as b,fe as l,me as n,X as p,Ae as v,Q as w}