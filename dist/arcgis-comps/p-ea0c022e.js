import{c as n}from"./p-e58503d5.js";import{r as t,d as o,u as r,o as s,q as i,s as e,H as c,c as a,F as u,I as f,a as l,i as p,z as d,l as m}from"./p-2f398ed1.js";import{s as b,c as h}from"./p-3c70d22f.js";import{h as g,o as j,f as P,r as M}from"./p-ccdb8e80.js";import{e as w}from"./p-2c84c65f.js";import{n as y,b as A,r as v}from"./p-d3105731.js";import{v as _,A as x,b as N}from"./p-1c99992b.js";import{p as B,M as C,b as R,B as S,W as U,j as V,D as k,E as z,F as O,I as W,O as q,z as D}from"./p-dcdb33cf.js";import{e as E,h as F}from"./p-95909347.js";const H=n.getLogger("esri.views.3d.support.geometryUtils.boundedPlane");class I{constructor(){this.plane=B(),this.origin=y(),this.basis1=y(),this.basis2=y()}}function L(n=mn){return{plane:B(n.plane),origin:A(n.origin),basis1:A(n.basis1),basis2:A(n.basis2)}}function T(n,t=L()){return J(n.origin,n.basis1,n.basis2,t)}function G(n,o){t(o.origin,n.origin),t(o.basis1,n.basis1),t(o.basis2,n.basis2),R(n.plane,o.plane)}function J(n,o,r,s=L()){return t(s.origin,n),t(s.basis1,o),t(s.basis2,r),K(s),function(n,t){Math.abs(d(n.basis1,n.basis2)/(e(n.basis1)*e(n.basis2)))>1e-6&&H.warn(t,"Provided basis vectors are not perpendicular"),Math.abs(d(n.basis1,un(n)))>1e-6&&H.warn(t,"Basis vectors and plane normal are not perpendicular"),Math.abs(-d(un(n),n.origin)-n.plane[3])>1e-6&&H.warn(t,"Plane offset is not consistent with plane origin")}(s,"fromValues()"),s}function K(n){S(n.basis2,n.basis1,n.origin,n.plane)}function Q(n,t,s){n!==s&&T(n,s);const i=o(h.get(),un(n),t);return r(s.origin,s.origin,i),s.plane[3]-=t,s}function X(n,t=L()){const o=(n[2]-n[0])/2,r=(n[3]-n[1])/2;return s(t.origin,n[0]+o,n[1]+r,0),s(t.basis1,o,0,0),s(t.basis2,0,r,0),V(0,0,1,0,t.plane),t}function Y(n,t,o){return!!k(n.plane,t,o)&&fn(n,o)}function Z(n,o,r){const s=bn.get();dn(n,o,s,bn.get());let i=Number.POSITIVE_INFINITY;for(const e of Pn){const a=pn(n,e,hn.get()),u=h.get();if(z(s,a,u)){const n=c(h.get(),o.origin,u),s=Math.abs(m(d(o.direction,n)));s<i&&(i=s,t(r,u))}}return i===Number.POSITIVE_INFINITY?$(n,o,r):r}function $(n,o,r){if(Y(n,o,r))return r;const s=bn.get(),i=bn.get();dn(n,o,s,i);let e=Number.POSITIVE_INFINITY;for(const c of Pn){const a=pn(n,c,hn.get()),u=h.get();if(O(s,a,u)){const n=F(o,u);if(!W(i,u))continue;n<e&&(e=n,t(r,u))}}return on(n,o.origin)<e&&nn(n,o.origin,r),r}function nn(n,t,o){const s=q(n.plane,t,h.get()),i=x(ln(n,n.basis1),s,-1,1,h.get()),e=x(ln(n,n.basis2),s,-1,1,h.get());return a(o,r(h.get(),i,e),n.origin),o}function tn(n,t,o){const{origin:r,basis1:i,basis2:e}=n,c=a(h.get(),t,r),u=E(i,c),f=E(e,c),l=E(un(n),c);return s(o,u,f,l)}function on(n,t){const o=tn(n,t,h.get()),{basis1:r,basis2:s}=n,i=e(r),c=e(s),a=Math.max(Math.abs(o[0])-i,0),u=Math.max(Math.abs(o[1])-c,0),f=o[2];return a*a+u*u+f*f}function rn(n,t){return Math.sqrt(on(n,t))}function sn(n,t){return W(n.plane,t)&&fn(n,t)}function en(n,t){const o=-n.plane[3];return E(un(n),t)-o}function cn(n,t,o){return n!==o&&T(n,o),g(Mn,t),j(Mn,Mn),f(o.basis1,n.basis1,Mn),f(o.basis2,n.basis2,Mn),f(U(o.plane),U(n.plane),Mn),f(o.origin,n.origin,t),D(o.plane,o.origin,o.plane),o}function an(n,t,o,r){return n!==r&&T(n,r),P(wn,M(wn),t,o),f(r.basis1,n.basis1,wn),f(r.basis2,n.basis2,wn),K(r),r}function un(n){return U(n.plane)}function fn(n,t){const o=a(h.get(),t,n.origin),r=p(n.basis1),s=p(n.basis2),i=d(n.basis1,o),e=d(n.basis2,o);return-i-r<0&&i-r<0&&-e-s<0&&e-s<0}function ln(n,o){const r=hn.get();return t(r.origin,n.origin),t(r.vector,o),r}function pn(n,t,s){const{basis1:i,basis2:e,origin:c}=n,a=o(h.get(),i,t.origin[0]),u=o(h.get(),e,t.origin[1]);r(s.origin,a,u),r(s.origin,s.origin,c);const f=o(h.get(),i,t.direction[0]),l=o(h.get(),e,t.direction[1]);return o(s.vector,r(f,f,l),2),s}function dn(n,t,o,r){const s=un(n);S(s,t.direction,t.origin,o),S(U(o),s,t.origin,r)}const mn={plane:B(),origin:v(0,0,0),basis1:v(1,0,0),basis2:v(0,1,0)},bn=new b(B),hn=new b(_),gn=y(),jn=new b((()=>({origin:null,basis1:null,basis2:null,plane:null}))),Pn=[{origin:[-1,-1],direction:[1,0]},{origin:[1,-1],direction:[0,1]},{origin:[1,1],direction:[-1,0]},{origin:[-1,1],direction:[0,-1]}],Mn=w(),wn=w(),yn=Object.freeze({__proto__:null,BoundedPlaneClass:I,create:L,wrap:function(n,t,o){const r=jn.get();return r.origin=n,r.basis1=t,r.basis2=o,r.plane=C(0,0,0,0),K(r),r},copy:T,copyWithoutVerify:G,fromValues:J,updateUnboundedPlane:K,elevate:Q,setExtent:function(n,t,o){return X(t,o),Q(o,en(n,n.origin),o),o},fromAABoundingRect:X,intersectRay:Y,intersectRayClosestSilhouette:function(n,t,s){if(Y(n,t,s))return s;const c=Z(n,t,h.get());return r(s,t.origin,o(h.get(),t.direction,i(t.origin,c)/e(t.direction))),s},closestPointOnSilhouette:Z,closestPoint:$,projectPoint:nn,projectPointLocal:tn,distance2:on,distance:rn,distanceToSilhouette:function(n,t){let o=Number.NEGATIVE_INFINITY;for(const r of Pn){const s=pn(n,r,hn.get()),i=N(s,t);i>o&&(o=i)}return Math.sqrt(o)},extrusionContainsPoint:sn,axisAt:function(n,o,r,s){return function(n,o,r){switch(o){case 0:t(r,n.basis1),l(r,r);break;case 1:t(r,n.basis2),l(r,r);break;case 2:t(r,un(n))}return r}(n,r,s)},altitudeAt:en,setAltitudeAt:function(n,t,s,i){const e=en(n,t),c=o(gn,un(n),s-e);return r(i,t,c),i},equals:function(n,t){return u(n.basis1,t.basis1)&&u(n.basis2,t.basis2)&&u(n.origin,t.origin)},transform:cn,rotate:an,normal:un,UP:mn});export{T as D,L as G,G as H,J,K,X as Z,yn as _,sn as c,cn as l,un as m,an as p,rn as r,I as z}