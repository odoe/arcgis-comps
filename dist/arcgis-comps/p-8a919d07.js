import{bh as n,bC as r,a_ as t,bZ as o,a$ as e,aa as s,A as u,b_ as c,b$ as i}from"./p-e58503d5.js";function a(t,o){const e=o&&o.url&&o.url.path;if(t&&e&&(t=n(t,e,{preserveProtocolRelative:!0}),o.portalItem&&o.readResourcePaths)){const n=r(t,o.portalItem.itemUrl);m.test(n)&&o.readResourcePaths.push(o.portalItem.resourceFromPath(n).path)}return p(t,o&&o.portal)}function f(u,c,i=0){if(!u)return u;!t(u)&&c&&c.blockedRelativeUrls&&c.blockedRelativeUrls.push(u);let a=n(u);if(c){const n=c.verifyItemRelativeUrls&&c.verifyItemRelativeUrls.rootPath||c.url&&c.url.path;if(n){const t=p(n,c.portal);a=r(p(a,c.portal),t,t),a!==u&&c.verifyItemRelativeUrls&&c.verifyItemRelativeUrls.writtenUrls.push(a)}}return a=function(n,r){return r&&!r.isPortal&&r.urlKey&&r.customBaseUrl?o(n,`${r.urlKey}.${r.customBaseUrl}`,r.portalHostname):n}(a,c&&c.portal),t(a)&&(a=e(a)),null!=c&&c.resources&&null!=c&&c.portalItem&&!t(a)&&!s(a)&&0===i&&c.resources.toKeep.push({resource:c.portalItem.resourceFromPath(a)}),a}function l(n,r,t){return a(n,t)}function $(n,r,t,o){const e=f(n,o);void 0!==e&&(r[t]=e)}const b=/\/items\/([^\/]+)\/resources\//,m=/^\.\/resources\//;function _(n){const r=u(n)?n.match(b):null;return u(r)?r[1]:null}function p(n,r){if(!r||r.isPortal||!r.urlKey||!r.customBaseUrl)return n;const t=`${r.urlKey}.${r.customBaseUrl}`;return c(i,`${i.scheme}://${t}`)?o(n,r.portalHostname,t):o(n,t,r.portalHostname)}const d=Object.freeze({__proto__:null,fromJSON:a,toJSON:f,read:l,write:$,itemIdFromResourceUrl:_});export{d as R,_ as U,a as c,f as i,l as m,$ as p}