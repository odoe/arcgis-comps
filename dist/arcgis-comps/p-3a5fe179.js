import{m as t,Q as n}from"./p-9ae46e68.js";import{aK as e,aL as r,aM as u,aN as i,aO as o,aP as c}from"./p-566b0715.js";import{o as s,s as a}from"./p-138c2b2c.js";function f(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}const l=f();Object.freeze({__proto__:null,create:f,clone:function(t){const n=new Float32Array(16);return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n},fromValues:function(t,n,e,r,u,i,o,c,s,a,f,l,h,p,w,g){const d=new Float32Array(16);return d[0]=t,d[1]=n,d[2]=e,d[3]=r,d[4]=u,d[5]=i,d[6]=o,d[7]=c,d[8]=s,d[9]=a,d[10]=f,d[11]=l,d[12]=h,d[13]=p,d[14]=w,d[15]=g,d},createView:function(t,n){return new Float32Array(t,n,16)},IDENTITY:l});class h{constructor(t,n,e){this.strength=t,this.radius=n,this.threshold=e,this.type="bloom"}interpolate(t,n,e){this.strength=y(t.strength,n.strength,e),this.radius=y(t.radius,n.radius,e),this.threshold=y(t.threshold,n.threshold,e)}clone(){return new h(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:m(this.radius),strength:this.strength,threshold:this.threshold}}}class p{constructor(t){this.radius=t,this.type="blur"}interpolate(t,n,e){this.radius=Math.round(y(t.radius,n.radius,e))}clone(){return new p(this.radius)}toJSON(){return{type:"blur",radius:m(this.radius)}}}class w{constructor(t,n){this.type=t,this.amount=n,"invert"!==this.type&&"grayscale"!==this.type&&"sepia"!==this.type||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,n,e){this.amount=y(t.amount,n.amount,e),this._updateMatrix()}clone(){return new w(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||f();switch(this.type){case"brightness":this._colorMatrix=((t,n)=>{const e=a(t,n,0,0,0,0,n,0,0,0,0,n,0,0,0,0,1);return s(e,e)})(t,this.amount);break;case"contrast":this._colorMatrix=((t,n)=>{const e=a(t,n,0,0,.5-.5*n,0,n,0,.5-.5*n,0,0,n,.5-.5*n,0,0,0,1);return s(e,e)})(t,this.amount);break;case"grayscale":this._colorMatrix=(t=>{const n=1-this.amount,e=a(t,.2126+.7874*n,.7152-.7152*n,.0722-.0722*n,0,.2126-.2126*n,.7152+.2848*n,.0722-.0722*n,0,.2126-.2126*n,.7152-.7152*n,.0722+.9278*n,0,0,0,0,1);return s(e,e)})(t);break;case"invert":this._colorMatrix=((t,n)=>{const e=1-2*n,r=a(t,e,0,0,n,0,e,0,n,0,0,e,n,0,0,0,1);return s(r,r)})(t,this.amount);break;case"saturate":this._colorMatrix=((t,n)=>{const e=a(t,.213+.787*n,.715-.715*n,.072-.072*n,0,.213-.213*n,.715+.285*n,.072-.072*n,0,.213-.213*n,.715-.715*n,.072+.928*n,0,0,0,0,1);return s(e,e)})(t,this.amount);break;case"sepia":this._colorMatrix=(t=>{const n=1-this.amount,e=a(t,.393+.607*n,.769-.769*n,.189-.189*n,0,.349-.349*n,.686+.314*n,.168-.168*n,0,.272-.272*n,.534-.534*n,.131+.869*n,0,0,0,0,1);return s(e,e)})(t)}}}class g{constructor(t,n,e,r){this.offsetX=t,this.offsetY=n,this.blurRadius=e,this.color=r,this.type="drop-shadow"}interpolate(t,n,e){this.offsetX=y(t.offsetX,n.offsetX,e),this.offsetY=y(t.offsetY,n.offsetY,e),this.blurRadius=y(t.blurRadius,n.blurRadius,e),this.color[0]=Math.round(y(t.color[0],n.color[0],e)),this.color[1]=Math.round(y(t.color[1],n.color[1],e)),this.color[2]=Math.round(y(t.color[2],n.color[2],e)),this.color[3]=y(t.color[3],n.color[3],e)}clone(){return new g(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];return t[3]*=255,{type:"drop-shadow",xoffset:m(this.offsetX),yoffset:m(this.offsetY),blurRadius:m(this.blurRadius),color:t}}}class d{constructor(t){this.angle=t,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,n,e){this.angle=y(t.angle,n.angle,e),this._updateMatrix()}clone(){return new d(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||f();this._colorMatrix=((t,n)=>{const e=Math.sin(n*Math.PI/180),r=Math.cos(n*Math.PI/180),u=a(t,.213+.787*r-.213*e,.715-.715*r-.715*e,.072-.072*r+.928*e,0,.213-.213*r+.143*e,.715+.285*r+.14*e,.072-.072*r-.283*e,0,.213-.213*r-.787*e,.715-.715*r+.715*e,.072+.928*r+.072*e,0,0,0,0,1);return s(u,u)})(t,this.angle)}}class v{constructor(t){this.amount=t,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(t,n,e){this.amount=y(t.amount,n.amount,e)}clone(){return new v(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}function y(t,n,e){return t+(n-t)*e}function m(t){return Math.round(1e3*e(t))/1e3}function b(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new w(t.type,0);case"saturate":case"brightness":case"contrast":return new w(t.type,1);case"opacity":return new v(1);case"hue-rotate":return new d(0);case"blur":return new p(0);case"drop-shadow":return new g(0,0,0,[...r("transparent")]);case"bloom":return new h(0,0,0)}}function x(t,n){const e=t.length>n.length?t:n;return(t.length>n.length?n:t).every(((t,n)=>t.type===e[n].type))}function $(t,n){const e=t.length>n.length?t:n,r=t.length>n.length?n:t;for(let t=r.length;t<e.length;t++)r.push(b(e[t]))}var M,F={exports:{}};function A(n){if(!n||0===n.length)return null;if("string"==typeof n){const t=E(n);return t&&0!==t.length?t:null}const e=n.map((n=>{if(!Number.isFinite(n.scale)||n.scale<=0)throw new t("effect:invalid-scale","scale must be finite and greater than 0",{stop:n});return{scale:n.scale,effects:E(n.value)}}));e.sort(((t,n)=>n.effects.length-t.effects.length));for(let n=0;n<e.length-1;n++){if(!x(e[n].effects,e[n+1].effects))throw new t("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[n].effects,b:e[n+1].effects});$(e[n].effects,e[n+1].effects)}return e.sort(((t,n)=>n.scale-t.scale)),e}function E(n){let e;if(!n)return[];try{e=F.exports.parse(n)}catch(e){throw new t("effect:invalid-syntax","Invalid effect syntax",{value:n,error:e})}return e.map((n=>function(n){try{switch(n.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return function(t){let n=1;return k(t.parameters,1),1===t.parameters.length&&(n=J(t.parameters[0])),new w(t.name,n)}(n);case"opacity":return function(t){let n=1;return k(t.parameters,1),1===t.parameters.length&&(n=J(t.parameters[0])),new v(n)}(n);case"hue-rotate":return function(n){let e=0;return k(n.parameters,1),1===n.parameters.length&&(e=function(n){return function(n){if("quantity"!==n.type||!(0===n.value&&null===n.unit||n.unit&&null!=j[n.unit]))throw new t("effect:type-error",`Expected <angle>, Actual: ${O(n)}`,{term:n})}(n),n.value*j[n.unit]||0}(n.parameters[0])),new d(e)}(n);case"blur":return function(t){let n=0;return k(t.parameters,1),1===t.parameters.length&&(n=_(t.parameters[0]),N(n,t.parameters[0])),new p(n)}(n);case"drop-shadow":return function(n){const e=[];let r=null;for(const u of n.parameters)if("color"===u.type){if(e.length&&Object.freeze(e),r)throw new t("effect:type-error","Accepts only one color",{});r=q(u)}else{const n=_(u);if(Object.isFrozen(e))throw new t("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(n),3===e.length&&N(n,u)}if(e.length<2||e.length>3)throw new t("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new g(e[0],e[1],e[2]||0,r||C("black"))}(n);case"bloom":return function(t){let n=1,e=0,r=0;return k(t.parameters,3),t.parameters[0]&&(n=J(t.parameters[0])),t.parameters[1]&&(e=_(t.parameters[1]),N(e,t.parameters[1])),t.parameters[2]&&(r=J(t.parameters[2])),new h(n,e,r)}(n)}}catch(t){throw t.details.filter=n,t}throw new t("effect:unknown-effect",`Effect '${n.name}' is not supported`,{effect:n})}(n)))}function k(n,e){if(n.length>e)throw new t("effect:type-error",`Function supports up to ${e} parameters, Actual: ${n.length}`,{parameters:n})}function O(t){if("color"===t.type)return"<color>";if(t.unit){if(S[t.unit])return"<length>";if(j[t.unit])return"<angle>";if("%"===t.unit)return"<percentage>"}return"<double>"}function N(n,e){if(n<0)throw new t("effect:type-error",`Negative values are not allowed, Actual: ${n}`,{term:e})}(M=F).exports&&(M.exports=function(){function t(n,e,r,u){var i=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(i,t.prototype),i.expected=e,i.found=r,i.location=u,i.name="SyntaxError",i}function n(t,n,e){return e=e||" ",t.length>n?t:t+(e+=e.repeat(n-=t.length)).slice(0,n)}return function(t,n){function e(){this.constructor=t}e.prototype=n.prototype,t.prototype=new e}(t,Error),t.prototype.format=function(t){var e="Error: "+this.message;if(this.location){var r,u=null;for(r=0;r<t.length;r++)if(t[r].source===this.location.source){u=t[r].text.split(/\r\n|\n|\r/g);break}var i=this.location.start,o=this.location.source+":"+i.line+":"+i.column;if(u){var c=this.location.end,s=n("",i.line.toString().length),a=u[i.line-1],f=i.line===c.line?c.column:a.length+1;e+="\n --\x3e "+o+"\n"+s+" |\n"+i.line+" | "+a+"\n"+s+" | "+n("",i.column-1)+n("",f-i.column,"^")}else e+="\n at "+o}return e},t.buildMessage=function(t,n){var e={literal:function(t){return'"'+u(t.text)+'"'},class:function(t){var n=t.parts.map((function(t){return Array.isArray(t)?i(t[0])+"-"+i(t[1]):i(t)}));return"["+(t.inverted?"^":"")+n+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function r(t){return t.charCodeAt(0).toString(16).toUpperCase()}function u(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function i(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+r(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+r(t)}))}function o(t){return e[t.type](t)}return"Expected "+function(t){var n,e,r=t.map(o);if(r.sort(),r.length>0){for(n=1,e=1;n<r.length;n++)r[n-1]!==r[n]&&(r[e]=r[n],e++);r.length=e}switch(r.length){case 1:return r[0];case 2:return r[0]+" or "+r[1];default:return r.slice(0,-1).join(", ")+", or "+r[r.length-1]}}(t)+" but "+function(t){return t?'"'+u(t)+'"':"end of input"}(n)+" found."},{SyntaxError:t,parse:function(n,e){var r,u={},i=(e=void 0!==e?e:{}).grammarSource,o={start:ot},c=ot,s="none",a="grad",f="turn",l=/^[ \t\n\r]/,h=/^[a-z\-]/,p=/^[0-9a-fA-F]/,w=/^[+\-]/,g=/^[0-9]/,d=rt("none"),v=nt("none",!1),y=nt(")",!1),m=nt(",",!1),b=rt("whitespace"),x=et([" ","\t","\n","\r"],!1,!1),$=rt("function"),M=nt("(",!1),F=rt("identifier"),A=et([["a","z"],"-"],!1,!1),E=rt("percentage"),k=nt("%",!1),O=rt("length"),N=nt("px",!1),j=nt("cm",!1),S=nt("mm",!1),J=nt("in",!1),_=nt("pt",!1),q=nt("pc",!1),C=rt("angle"),I=nt("deg",!1),R=nt("rad",!1),T=nt("grad",!1),z=nt("turn",!1),V=rt("number"),B=rt("color"),D=nt("#",!1),K=et([["0","9"],["a","f"],["A","F"]],!1,!1),L=et(["+","-"],!1,!1),P=et([["0","9"]],!1,!1),Q=nt(".",!1),Y=nt("e",!1),G=0,H=0,U=[{line:1,column:1}],W=0,X=[],Z=0;if("startRule"in e){if(!(e.startRule in o))throw new Error("Can't start parsing from rule \""+e.startRule+'".');c=o[e.startRule]}function tt(){return n.substring(H,G)}function nt(t,n){return{type:"literal",text:t,ignoreCase:n}}function et(t,n,e){return{type:"class",parts:t,inverted:n,ignoreCase:e}}function rt(t){return{type:"other",description:t}}function ut(t){var e,r=U[t];if(r)return r;for(e=t-1;!U[e];)e--;for(r={line:(r=U[e]).line,column:r.column};e<t;)10===n.charCodeAt(e)?(r.line++,r.column=1):r.column++,e++;return U[t]=r,r}function it(t){G<W||(G>W&&(W=G,X=[]),X.push(t))}function ot(){var t;return(t=ct())===u&&(t=function(){var t,n;if(t=[],(n=st())!==u)for(;n!==u;)t.push(n),n=st();else t=u;return t}()),t}function ct(){var t,e;return Z++,t=G,ft(),n.substr(G,4)===s?(e=s,G+=4):(e=u,0===Z&&it(v)),e!==u?(ft(),H=t,t=[]):(G=t,t=u),Z--,t===u&&0===Z&&it(d),t}function st(){var t,e,r,i;return t=G,ft(),(e=function(){var t,e,r;return Z++,t=G,(e=lt())!==u?(40===n.charCodeAt(G)?(r="(",G++):(r=u,0===Z&&it(M)),r!==u?(H=t,t=e):(G=t,t=u)):(G=t,t=u),Z--,t===u&&(e=u,0===Z&&it($)),t}())!==u?(ft(),(r=function(){var t,e,r,i,o,c,s,a;if(t=G,(e=at())!==u){for(r=[],i=G,o=ft(),44===n.charCodeAt(G)?(c=",",G++):(c=u,0===Z&&it(m)),c===u&&(c=null),s=ft(),(a=at())!==u?i=o=[o,c,s,a]:(G=i,i=u);i!==u;)r.push(i),i=G,o=ft(),44===n.charCodeAt(G)?(c=",",G++):(c=u,0===Z&&it(m)),c===u&&(c=null),s=ft(),(a=at())!==u?i=o=[o,c,s,a]:(G=i,i=u);H=t,t=function(t,n){return n.length>0?function(t,n){return[t].concat(function(t){return t.map((function(t){return t[3]}))}(n))}(t,n):[t]}(e,r)}else G=t,t=u;return t}())===u&&(r=null),ft(),41===n.charCodeAt(G)?(i=")",G++):(i=u,0===Z&&it(y)),i!==u?(ft(),H=t,t=function(t,n){return{type:"function",name:t,parameters:n||[]}}(e,r)):(G=t,t=u)):(G=t,t=u),t}function at(){var t,n;return t=G,(n=ht())===u&&(n=pt())===u&&(n=wt())===u&&(n=function(){var t,n;return Z++,t=G,ft(),(n=dt())!==u?(H=t,t=function(t){return{value:t,unit:null}}(n)):(G=t,t=u),Z--,t===u&&0===Z&&it(V),t}()),n!==u&&(H=t,n=function(t){return{type:"quantity",value:t.value,unit:t.unit}}(n)),(t=n)===u&&(t=G,(n=gt())!==u&&(H=t,n=function(t){return{type:"color",colorType:t.type,value:t.value}}(n)),t=n),t}function ft(){var t,e;for(Z++,t=[],l.test(n.charAt(G))?(e=n.charAt(G),G++):(e=u,0===Z&&it(x));e!==u;)t.push(e),l.test(n.charAt(G))?(e=n.charAt(G),G++):(e=u,0===Z&&it(x));return Z--,e=u,0===Z&&it(b),t}function lt(){var t,e,r;if(Z++,t=G,e=[],h.test(n.charAt(G))?(r=n.charAt(G),G++):(r=u,0===Z&&it(A)),r!==u)for(;r!==u;)e.push(r),h.test(n.charAt(G))?(r=n.charAt(G),G++):(r=u,0===Z&&it(A));else e=u;return e!==u&&(H=t,e=tt()),Z--,(t=e)===u&&(e=u,0===Z&&it(F)),t}function ht(){var t,e,r;return Z++,t=G,ft(),(e=dt())!==u?(37===n.charCodeAt(G)?(r="%",G++):(r=u,0===Z&&it(k)),r!==u?(H=t,t=function(t){return{value:t,unit:"%"}}(e)):(G=t,t=u)):(G=t,t=u),Z--,t===u&&0===Z&&it(E),t}function pt(){var t,e,r;return Z++,t=G,ft(),(e=dt())!==u?("px"===n.substr(G,2)?(r="px",G+=2):(r=u,0===Z&&it(N)),r!==u?(H=t,t=function(t){return{value:t,unit:"px"}}(e)):(G=t,t=u)):(G=t,t=u),t===u&&(t=G,ft(),(e=dt())!==u?("cm"===n.substr(G,2)?(r="cm",G+=2):(r=u,0===Z&&it(j)),r!==u?(H=t,t=function(t){return{value:t,unit:"cm"}}(e)):(G=t,t=u)):(G=t,t=u),t===u&&(t=G,ft(),(e=dt())!==u?("mm"===n.substr(G,2)?(r="mm",G+=2):(r=u,0===Z&&it(S)),r!==u?(H=t,t=function(t){return{value:t,unit:"mm"}}(e)):(G=t,t=u)):(G=t,t=u),t===u&&(t=G,ft(),(e=dt())!==u?("in"===n.substr(G,2)?(r="in",G+=2):(r=u,0===Z&&it(J)),r!==u?(H=t,t=function(t){return{value:t,unit:"in"}}(e)):(G=t,t=u)):(G=t,t=u),t===u&&(t=G,ft(),(e=dt())!==u?("pt"===n.substr(G,2)?(r="pt",G+=2):(r=u,0===Z&&it(_)),r!==u?(H=t,t=function(t){return{value:t,unit:"pt"}}(e)):(G=t,t=u)):(G=t,t=u),t===u&&(t=G,ft(),(e=dt())!==u?("pc"===n.substr(G,2)?(r="pc",G+=2):(r=u,0===Z&&it(q)),r!==u?(H=t,t=function(t){return{value:t,unit:"pc"}}(e)):(G=t,t=u)):(G=t,t=u)))))),Z--,t===u&&0===Z&&it(O),t}function wt(){var t,e,r;return Z++,t=G,(e=dt())!==u?("deg"===n.substr(G,3)?(r="deg",G+=3):(r=u,0===Z&&it(I)),r!==u?(H=t,t=function(t){return{value:t,unit:"deg"}}(e)):(G=t,t=u)):(G=t,t=u),t===u&&(t=G,(e=dt())!==u?("rad"===n.substr(G,3)?(r="rad",G+=3):(r=u,0===Z&&it(R)),r!==u?(H=t,t=function(t){return{value:t,unit:"rad"}}(e)):(G=t,t=u)):(G=t,t=u),t===u&&(t=G,(e=dt())!==u?(n.substr(G,4)===a?(r=a,G+=4):(r=u,0===Z&&it(T)),r!==u?(H=t,t=function(t){return{value:t,unit:"grad"}}(e)):(G=t,t=u)):(G=t,t=u),t===u&&(t=G,(e=dt())!==u?(n.substr(G,4)===f?(r=f,G+=4):(r=u,0===Z&&it(z)),r!==u?(H=t,t=function(t){return{value:t,unit:"turn"}}(e)):(G=t,t=u)):(G=t,t=u)))),Z--,t===u&&(e=u,0===Z&&it(C)),t}function gt(){var t,e,r,i;if(Z++,t=G,35===n.charCodeAt(G)?(e="#",G++):(e=u,0===Z&&it(D)),e!==u){if(r=[],p.test(n.charAt(G))?(i=n.charAt(G),G++):(i=u,0===Z&&it(K)),i!==u)for(;i!==u;)r.push(i),p.test(n.charAt(G))?(i=n.charAt(G),G++):(i=u,0===Z&&it(K));else r=u;r!==u?(H=t,t={type:"hex",value:tt()}):(G=t,t=u)}else G=t,t=u;return t===u&&(t=G,(e=st())!==u&&(H=t,e=function(t){return{type:"function",value:t}}(e)),(t=e)===u&&(t=G,(e=lt())!==u&&(H=t,e={type:"named",value:tt()}),t=e)),Z--,t===u&&(e=u,0===Z&&it(B)),t}function dt(){var t,e,r,i,o,c,s;for(t=G,w.test(n.charAt(G))?(n.charAt(G),G++):0===Z&&it(L),e=G,r=[],g.test(n.charAt(G))?(i=n.charAt(G),G++):(i=u,0===Z&&it(P));i!==u;)r.push(i),g.test(n.charAt(G))?(i=n.charAt(G),G++):(i=u,0===Z&&it(P));if(46===n.charCodeAt(G)?(i=".",G++):(i=u,0===Z&&it(Q)),i!==u){if(o=[],g.test(n.charAt(G))?(c=n.charAt(G),G++):(c=u,0===Z&&it(P)),c!==u)for(;c!==u;)o.push(c),g.test(n.charAt(G))?(c=n.charAt(G),G++):(c=u,0===Z&&it(P));else o=u;o!==u?e=r=[r,i,o]:(G=e,e=u)}else G=e,e=u;if(e===u)if(e=[],g.test(n.charAt(G))?(r=n.charAt(G),G++):(r=u,0===Z&&it(P)),r!==u)for(;r!==u;)e.push(r),g.test(n.charAt(G))?(r=n.charAt(G),G++):(r=u,0===Z&&it(P));else e=u;if(e!==u){if(r=G,101===n.charCodeAt(G)?(i="e",G++):(i=u,0===Z&&it(Y)),i!==u){if(w.test(n.charAt(G))?(o=n.charAt(G),G++):(o=u,0===Z&&it(L)),o===u&&(o=null),c=[],g.test(n.charAt(G))?(s=n.charAt(G),G++):(s=u,0===Z&&it(P)),s!==u)for(;s!==u;)c.push(s),g.test(n.charAt(G))?(s=n.charAt(G),G++):(s=u,0===Z&&it(P));else c=u;c!==u?r=i=[i,o,c]:(G=r,r=u)}else G=r,r=u;r===u&&(r=null),H=t,t=parseFloat(tt())}else G=t,t=u;return t}if((r=c())!==u&&G===n.length)return r;throw r!==u&&G<n.length&&it({type:"end"}),function(n,e,r){return new t(t.buildMessage(n,e),n,e,r)}(X,W<n.length?n.charAt(W):null,function(t,n){var e=ut(t),r=ut(n);return{source:i,start:{offset:t,line:e.line,column:e.column},end:{offset:n,line:r.line,column:r.column}}}(W,W<n.length?W+1:W))}}}());const j={deg:1,grad:.9,rad:180/Math.PI,turn:360},S={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function J(n){!function(n){if("quantity"!==n.type||null!==n.unit&&"%"!==n.unit)throw new t("effect:type-error",`Expected <double> or <percentage>, Actual: ${O(n)}`,{term:n})}(n);const e=n.value;return N(e,n),"%"===n.unit?.01*e:e}function _(n){return function(n){if("quantity"!==n.type||!(0===n.value&&null===n.unit||n.unit&&null!=S[n.unit]))throw new t("effect:type-error",`Expected <length>, Actual: ${O(n)}`,{term:n})}(n),n.value*S[n.unit]||0}function q(n){switch(n.colorType){case"hex":return i(n.value);case"named":return C(n.value);case"function":return function(n){if(k(n.parameters,4),I.test(n.name))return[J(n.parameters[0]),J(n.parameters[1]),J(n.parameters[2]),n.parameters[3]?J(n.parameters[3]):1];if(R.test(n.name))return c(function(n){return function(n){if("quantity"!==n.type||null!==n.unit)throw new t("effect:type-error",`Expected <double>, Actual: ${O(n)}`,{term:n})}(n),N(n.value,n),n.value}(n.parameters[0]),J(n.parameters[1]),J(n.parameters[2]),n.parameters[3]?J(n.parameters[3]):1);throw new t("effect:syntax-error",`Invalid color function '${n.name}'`,{colorFunction:n})}(n.value)}}function C(n){if(!o(n))throw new t("effect:unknown-color",`color '${n}' isn't valid`,{namedColor:n});return u(n)}const I=/^rgba?/i,R=/^hsla?/i;function T(t,n,e){try{return function(t){if(!t||0===t.length)return null;if(function(t){const n=t[0];return!!n&&"scale"in n}(t)){const n=[];for(const e of t)n.push({scale:e.scale,value:V(e.value)});return n}return V(t)}(t)}catch(t){var r;null==e||null==(r=e.messages)||r.push(t)}return null}function z(t,e,r,u){try{const u=function(t){const n=A(t);return n?function(t){const n=t[0];return!!n&&"type"in n}(n)?n.map((t=>t.toJSON())):n.map((({scale:t,effects:n})=>({scale:t,value:n.map((t=>t.toJSON()))}))):null}(t);n(r,u,e)}catch(t){u.messages&&u.messages.push(t)}}function V(t){if(!t||!t.length)return"";const n=[];for(const e of t){let t=[];switch(e.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":t=[B(e,"amount")];break;case"blur":t=[B(e,"radius","pt")];break;case"hue-rotate":t=[B(e,"angle","deg")];break;case"drop-shadow":t=[B(e,"xoffset","pt"),B(e,"yoffset","pt"),B(e,"blurRadius","pt"),D(e,"color")];break;case"bloom":t=[B(e,"strength"),B(e,"radius","pt"),B(e,"threshold")]}const r=`${e.type}(${t.filter(Boolean).join(" ")})`;A(r),n.push(r)}return n.join(" ")}function B(n,e,r){if(null==n[e])throw new t("effect:missing-parameter",`Missing parameter '${e}' in ${n.type} effect`,{effect:n});return r?n[e]+r:""+n[e]}function D(n,e){if(null==n[e])throw new t("effect:missing-parameter",`Missing parameter '${e}' in ${n.type} effect`,{effect:n});const r=n[e];return`rgba(${r[0]||0}, ${r[1]||0}, ${r[2]||0}, ${r[3]/255||0})`}export{z as a,x as b,f as c,A as d,$ as e,V as f,T as n}