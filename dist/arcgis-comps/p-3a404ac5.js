import{c as t,a as i,ai as s,A as e,af as r,dQ as p,e as o,d as a,i as n,V as d}from"./p-e58503d5.js";import{h as m}from"./p-54330161.js";import{u as h}from"./p-2f398ed1.js";import{n as c,r as j}from"./p-d3105731.js";import{x as u,b as f,d as l}from"./p-c93d2280.js";import{u as b}from"./p-ea916a39.js";import{A as y,v as g}from"./p-3bcc4805.js";import{I as v,d as w}from"./p-340cd100.js";import{s as x,f as E,K as N}from"./p-b709baea.js";import{y as F}from"./p-6a92ecb9.js";import{p as I,t as O,u as D}from"./p-cbbdb7db.js";import{t as _}from"./p-bba8b671.js";import{b as A}from"./p-5e833dfc.js";import{n as S}from"./p-e9596294.js";import{v as C,p as V}from"./p-62b5bdb3.js";import{o as P,c as M,s as G,i as L,a as R}from"./p-805392f6.js";import{S as q,X as U,i as B,c as T}from"./p-85e8677e.js";import{p as z}from"./p-3da0a909.js";import{c as Q}from"./p-20f761a5.js";import{H as k,t as H}from"./p-7de54cd0.js";import{f as K}from"./p-ca295674.js";import"./p-53bb6ab4.js";import"./p-b79fcce3.js";import"./p-93765525.js";import"./p-765e6c28.js";import"./p-a9a30646.js";import"./p-8747982c.js";import"./p-8bc9b36a.js";import"./p-7a658388.js";import"./p-e273719b.js";import"./p-74de0937.js";import"./p-fb38a9d0.js";import"./p-f94762ac.js";import"./p-8a919d07.js";import"./p-efbca0ca.js";import"./p-c048b814.js";import"./p-01e5a461.js";import"./p-ccdb8e80.js";import"./p-fea9512d.js";import"./p-3721667d.js";import"./p-4019eec3.js";import"./p-a131049b.js";import"./p-a2324023.js";import"./p-2c84c65f.js";import"./p-95909347.js";import"./p-4d38e149.js";import"./p-3c70d22f.js";import"./p-8f986f60.js";import"./p-746a9d8f.js";import"./p-728dcbb0.js";import"./p-ea0c022e.js";import"./p-1c99992b.js";import"./p-dcdb33cf.js";import"./p-6ded4c02.js";import"./p-0d1e969a.js";import"./p-7f47b970.js";import"./p-e6fe5d89.js";import"./p-5763113b.js";import"./p-eb48bb01.js";import"./p-b9aa4901.js";import"./p-a3955219.js";import"./p-c2152437.js";import"./p-0bb84768.js";import"./p-19bc1e3d.js";import"./p-a24f7752.js";import"./p-37f005a2.js";import"./p-f06611ed.js";import"./p-bdf9e611.js";import"./p-a72732f2.js";import"./p-a8d1cf30.js";import"./p-a6c8fb32.js";import"./p-6b2eb7a7.js";import"./p-025c0c8e.js";import"./p-e72a43d7.js";import"./p-97ec6ae5.js";import"./p-382f7028.js";import"./p-56ed1c7a.js";import"./p-04a0cfca.js";import"./p-b0565d49.js";import"./p-e654504b.js";import"./p-c45aa9e8.js";import"./p-d87e82bf.js";import"./p-b05e75b2.js";import"./p-2f5c7e83.js";import"./p-58c16730.js";import"./p-b5b00e38.js";import"./p-a4587ab0.js";import"./p-ca657fcf.js";import"./p-7a5bfd29.js";import"./p-1ab449fc.js";import"./p-0edb3309.js";import"./p-e8160b60.js";import"./p-2e8ad983.js";import"./p-1f81b35d.js";import"./p-5032dfbd.js";import"./p-182bb5be.js";import"./p-db87794e.js";import"./p-9f1c2d50.js";import"./p-dfc6337f.js";import"./p-2ae44317.js";import"./p-9f58a277.js";import"./p-9e860e7b.js";import"./p-0923eebd.js";import"./p-568eb6e8.js";import"./p-de5b11d6.js";import"./p-c7a58085.js";import"./p-76f37e40.js";import"./p-afac6fb2.js";import"./p-da33e926.js";import"./p-480e5606.js";import"./p-889f7a78.js";import"./p-e31c89bd.js";import"./p-0e784e4d.js";import"./p-dbdf15fc.js";import"./p-e0d9ff4c.js";import"./p-08e5f531.js";import"./p-81b9df84.js";import"./p-5ce39624.js";import"./p-e9bae5e9.js";import"./p-51a17e75.js";import"./p-3e39c093.js";import"./p-cc2794db.js";import"./p-f8414adc.js";import"./p-8925cd73.js";import"./p-58386239.js";import"./p-285c6a34.js";import"./p-7392987e.js";import"./p-bfea9714.js";import"./p-c1cd5521.js";import"./p-61f47d2b.js";import"./p-e49308c6.js";import"./p-50ff864e.js";import"./p-06d309e6.js";import"./p-292d2320.js";import"./p-8bcb4bb3.js";import"./p-85a6d41b.js";import"./p-612de336.js";import"./p-dc852195.js";import"./p-03d6250d.js";import"./p-0b395493.js";import"./p-8fa44ebc.js";import"./p-7731c620.js";import"./p-5d962998.js";import"./p-a63f7978.js";import"./p-f6a340f9.js";import"./p-e285e8f3.js";import"./p-6484267b.js";import"./p-400ca3dc.js";import"./p-9b7a2176.js";import"./p-0eb619a6.js";import"./p-4d17d2cd.js";import"./p-e94b450b.js";import"./p-1189fa83.js";import"./p-37058f88.js";import"./p-7d081d01.js";import"./p-612a2c14.js";import"./p-d443df87.js";import"./p-7ca40eac.js";import"./p-9087b4d3.js";import"./p-ca4492df.js";import"./p-9d34911e.js";import"./p-2db4840f.js";import"./p-ff2962f5.js";import"./p-da9e7ba9.js";import"./p-a8f0aa27.js";import"./p-4a96de15.js";import"./p-a87cccba.js";import"./p-dae095dd.js";import"./p-d208934e.js";import"./p-22c9f19c.js";import"./p-c096b5df.js";import"./p-4a6dc5e4.js";import"./p-e3270d48.js";import"./p-e44bd0a6.js";import"./p-fe68aab5.js";import"./p-c6970847.js";import"./p-de86b3c9.js";import"./p-37d3434c.js";import"./p-120b7410.js";import"./p-b1eff69d.js";import"./p-91fe06d4.js";import"./p-ab0e9273.js";import"./p-15a9486c.js";import"./p-f3659a34.js";import"./p-b312c1fd.js";import"./p-b8beb0d3.js";import"./p-2a99994a.js";import"./p-eee9ef50.js";import"./p-1e473dab.js";import"./p-d1d9dbe4.js";import"./p-d57f9971.js";import"./p-db4d63dc.js";import"./p-389c5380.js";import"./p-5f8e8f6c.js";import"./p-d2d87566.js";import"./p-db63fa0e.js";import"./p-21bd46cc.js";import"./p-4f86c37f.js";import"./p-fd584619.js";import"./p-31225789.js";import"./p-954786fa.js";import"./p-70787875.js";import"./p-1f1360f9.js";import"./p-1a2ab148.js";import"./p-09dd2137.js";import"./p-42bb6c1e.js";import"./p-2e37d910.js";import"./p-24d8fcee.js";import"./p-fbb06b4d.js";import"./p-4414d64f.js";import"./p-1ccb0bf6.js";import"./p-1c2ff3a7.js";import"./p-77b9a0fc.js";import"./p-6fe4db61.js";import"./p-9fe35ea1.js";import"./p-f70b836b.js";import"./p-41f2b2dd.js";class W extends S{constructor(t){super("SceneLayerWorker","dracoDecompressPointCloudData",t,{hasInitialize:!0})}getTransferList(t){return[t.geometryBuffer]}}const Z=t.getLogger("esri.views.3d.layers.SceneLayerGraphicsView3D"),J=R();let X=class extends(z(Q(I(P)))){constructor(){super(...arguments),this.type="scene-layer-graphics-3d",this._nodesAddedToStage=new Map,this.drapeSourceType=1,this._queryEngine=null,this._memCache=null,this._interactiveEditingSessions=new Map,this.loadedGraphics=new x,this.holeFilling="always",this.progressiveLoadFactor=1,this.supportsHeightUnitConversion=!0,this._coordinatesOutsideExtentErrors=0,this._maxCoordinatesOutsideExtentErrors=20}initialize(){var t,s;const e=this.layer;this.addResolvingPromise(e.indexInfo),this._attributeOverrides=new E(this.layer,null==(t=this.view.resourceController)?void 0:t.memoryController),q(e,this.view.spatialReference,this.view.viewingMode),this.fieldsHelper=new M({layerView:this}),this.updatingHandles.add(e,"rangeInfos",(t=>this._rangeInfosChanged(t)),2),this.updatingHandles.add(e,"renderer",((t,i)=>this._rendererChange(t,i))),this.updatingHandles.add(this,"parsedDefinitionExpression",(()=>this._filterChange())),this.updatingHandles.add(this,"view.floors",(()=>this.graphics3d.filterVisibility.filterChanged())),this.handles.add(i(v,"I3S_TREE_SHOW_TILES",(t=>{if(t&&!this._treeDebugger){const t=this._controller.crsIndex;import("./p-261f8f20.js").then((({I3STreeDebugger:i})=>{!this._treeDebugger&&v.I3S_TREE_SHOW_TILES&&(this._treeDebugger=new i({lv:this,view:this.view,nodeSR:t}))}))}else t||!this._treeDebugger||v.I3S_TREE_SHOW_TILES||(this._treeDebugger.destroy(),this._treeDebugger=null)}))),this._set("graphics3d",new C({owner:this,layer:e,preferredUpdatePolicy:0,scaleVisibilityEnabled:!0,filterVisibilityEnabled:!0,timeExtentVisibilityEnabled:!1,frustumVisibilityEnabled:!1,elevationAlignmentEnabled:!0,elevationFeatureExpressionEnabled:!1,suspendResumeExtentMode:"data",dataExtent:e.fullExtent,updateClippingExtent:t=>this._updateClippingExtent(t)})),null==(s=this.graphics3d.elevationAlignment)||s.events.on("invalidate-elevation",(t=>this._invalidateElevation(t))),this.supportsHeightUnitConversion&&(this._verticalScale=_("point",e.spatialReference,this.view.spatialReference)),this.addResolvingPromise(this.graphics3d.setup()),this._memCache=this.view.resourceController.memoryController.newCache(e.uid),this._controller=new N({layerView:this,scaleVisibilityEnabled:!1}),U(this.layer.geometryDefinitions)&&(this._worker=new W((t=>this.view.resourceController.schedule(t)))),this.handles.add(this.layer.on("apply-edits",(t=>this.updatingHandles.addPromise(t.result)))),this.handles.add(this.layer.on("edits",(t=>this._handleEdits(t)))),this.when((()=>{this._queryEngine=new V({layerView:this,priority:K.FEATURE_QUERY_ENGINE}),this.updatingHandles.add(this,"maximumNumberOfFeatures",(t=>this._controller.featureTarget=t),2),this.updatingHandles.add(this,"suspended",(t=>{t&&this._removeAllNodeData()}))}))}destroy(){this._treeDebugger=s(this._treeDebugger),this._attributeOverrides=s(this._attributeOverrides),this._set("graphics3d",s(this.graphics3d)),this._controller=s(this._controller),this._queryEngine=s(this._queryEngine),this._worker=s(this._worker),this._memCache=s(this._memCache),this._nodesAddedToStage.clear(),this.fieldsHelper=s(this.fieldsHelper)}get requiredFields(){var t,i;return null!=(t=null==(i=this.fieldsHelper)?void 0:i.requiredFields)?t:[]}get maximumNumberOfFeatures(){const t=this.graphics3d&&this.graphics3d.graphicsCore&&this.graphics3d.graphicsCore.displayFeatureLimit;return t?t.maximumNumberOfFeatures:0}set maximumNumberOfFeatures(t){null!=t?(this._override("maximumNumberOfFeatures",t),this._controller.fixedFeatureTarget=!0):(this._clearOverride("maximumNumberOfFeatures"),this._controller.fixedFeatureTarget=!1)}get maximumNumberOfFeaturesExceeded(){return!this.suspended&&!!this._controller&&!this._controller.leavesReached}get hasM(){return!1}get hasZ(){return!0}notifyGraphicGeometryChanged(t){this.graphics3d.graphicsCore.notifyGraphicGeometryChanged(t)}notifyGraphicVisibilityChanged(t){this.graphics3d.graphicsCore.notifyGraphicVisibilityChanged(t)}async whenGraphicAttributes(t,i){return B(this.layer,t,this._getObjectIdField(),i,(()=>[...this._nodesAddedToStage.values()]))}getGraphicFromGraphicUid(t){if(!this.loadedGraphics)return null;const i=w(this.loadedGraphics.find((i=>i.uid===t)),this.layer),s=this._getObjectIdField();return i&&i.attributes&&i.attributes[s]?(i.layer=this.layer,i.sourceLayer=this.layer,i):null}whenGraphicBounds(t,i){return this.graphics3d.graphicsCore.whenGraphicBounds(t,i)}computeAttachmentOrigin(t,i){return this.graphics3d.graphicsCore.computeAttachmentOrigin(t,i)}canResume(){return super.canResume()&&(!this._controller||this._controller.rootNodeVisible)}isUpdating(){var t,i,s;return!!(null!=(t=this._controller)&&t.updating||null!=(i=this.graphics3d)&&i.updating||null!=(s=this.fieldsHelper)&&s.updating)}getRenderingInfo(t,i,s){const r=O(t,{renderer:i,arcade:s});if(e(r)&&r.color){const t=r.color;t[0]=t[0]/255,t[1]=t[1]/255,t[2]=t[2]/255}return r}async getRenderingInfoAsync(t,i,s,e){return D(t,{renderer:i,arcade:s,...e})}get symbolUpdateType(){return this.graphics3d.graphicsCore.symbolUpdateType}highlight(t){return this.graphics3d.highlight(t,this.layer.objectIdField)}get updatePolicy(){return this.graphics3d.graphicsCore.effectiveUpdatePolicy}createInteractiveEditSession(t){return G(this.attributeEditingContext,t)}async extractBinaryPointData(t,i){const s={geometryBuffer:t.geometryBuffer};return r(this._worker)&&(this._worker=new W((t=>this.view.resourceController.schedule(t)))),this._worker.invoke(s,i).then((t=>{if(e(t))return{positionData:t.positions,featureIds:t.featureIds};throw new Error("Failed to decompress Draco point data")}))}checkExtent(t,i){t&&!p(t,i)&&(this._coordinatesOutsideExtentErrors<this._maxCoordinatesOutsideExtentErrors&&Z.error("Service Error: Coordinates outside of layer extent"),this._coordinatesOutsideExtentErrors+1===this._maxCoordinatesOutsideExtentErrors&&Z.error("Maximum number of errors reached. Further errors are ignored."),this._coordinatesOutsideExtentErrors++)}async addNode(t,i,s){if(!tt(i)&&!Y(i))return Promise.reject();if(this._nodesAddedToStage.has(t.index))return void Z.error("I3S node "+t.id+" already added");const r=e(this.layer.fullExtent)?function(t,i){return t.xmin-=i,t.ymin-=i,t.xmax+=i,t.ymax+=i,t.hasZ&&(t.zmin-=i,t.zmax+=i),t.hasM&&(t.mmin-=i,t.mmax+=i),t}(this.layer.fullExtent.clone(),.5):null,p=this._controller.crsVertex,o=[],a={graphics:null,featureIds:null,attributeInfo:i.attributeDataInfo,node:t};if(tt(i)?await this._addNodeBinaryPointData(t,a,i,r,o,s):Y(i)&&this._addNodeLegacyPointData(t,a,i,r,o),await this._attributeOverrides.apply(a.featureIds,i.attributeDataInfo,s),t.numFeatures=a.graphics.length,this._updateNodeMemory(t),it(a),o.length>0&&(this.computeObb(t,o,p),this._controller.updateVisibility(t.index)),!this._controller.isGeometryVisible(t))return this._cacheNodeData(a),Promise.resolve();if(e(this._verticalScale))for(const t of a.graphics)this._verticalScale(t.geometry);return this._nodesAddedToStage.set(t.index,a),this.loadedGraphics.addMany(a.graphics),this._filterNode(a),this._treeDebugger&&this._treeDebugger.update(),Promise.resolve()}computeObb(t,i,s){const e=this._controller.crsIndex,r=e.isGeographic?this.view.renderSpatialReference:e;u(i,s,0,i,r,0,i.length/3),t.serviceObb=k({data:i,size:3}),e.isGeographic&&f(t.serviceObb.center,r,t.serviceObb.center,e)}isNodeLoaded(t){return this._nodesAddedToStage.has(t)}isNodeReloading(){return!1}updateNodeState(){}async _addNodeBinaryPointData(t,i,s,r,p,o){const a=await this.extractBinaryPointData(s,o);if(null==a)return Promise.reject();const n=this._getObjectIdField(),c=this._controller.crsVertex,f=this.view.spatialReference,l=this.graphics3d.graphicsCore,{positionData:b,featureIds:y}=a,v=b.length/3,w=new Array;for(let i=0;i<v;i++){const s=e(t.serviceObb)?t.serviceObb.center:[0,0,0],o=3*i,a=j(b[o+0],b[o+1],b[o+2]);h(a,a,s),t.serviceObb||p.push(a[0],a[1],a[2]),e(r)&&this.checkExtent(r,a);const v=y[i],x={};null!=v&&(x[n]=v);const E=null==v?m.generateUID():v;u(a,c,0,et,f,0,1);const N=g(et[0],et[1],et[2],f),F=this.loadedGraphics.get(E);if(e(F))F.level<t.level&&(rt.property="geometry",rt.graphic=F,rt.oldValue=d(F.geometry),rt.newValue=N,F.geometry=N,l.graphicUpdateHandler(rt)),w.push(F);else{const i=m.generateUID();w.push({objectId:E,uid:i,geometry:N,attributes:x,visible:!0,level:t.level})}}i.graphics=w,i.featureIds=y}_addNodeLegacyPointData(t,i,s,r,p){const o=this._getObjectIdField(),a=this._controller.crsVertex,n=this.view.spatialReference,d=[0,0,0],h=new Array,c=new Array;for(const i of s.pointData){const s=i.featureDataPosition,j=s.length,f=i.geometries&&i.geometries[0]||st[j],l=i.featureIds[0];if("points"!==f.params.type)continue;e(r)&&this.checkExtent(r,s);const b={};null!=l&&(b[o]=l);const y=null==l?m.generateUID():l;let v;"Embedded"===f.type&&(v=f.params.vertexAttributes.position);for(let i=0;i<v.length;i+=j){for(let t=0;t<j;t++)d[t]=s[t]+v[i+t];const r=3===j;t.serviceObb||p.push(d[0],d[1],r?d[2]:0),u(d,a,0,et,n,0,1);const o=g(et[0],et[1],r?et[2]:void 0,n),h=this.loadedGraphics.get(y);e(h)?c.push(h):c.push({objectId:y,uid:m.generateUID(),geometry:o,attributes:b,visible:!0})}h.push(l)}i.graphics=c,i.featureIds=h}_updateNodeMemory(t){t.memory=4096+(e(t.numFeatures)?t.numFeatures*this.graphics3d.graphicsCore.usedMemoryPerGraphic:0)}_cacheNodeData(t){const i=t.graphics.reduce(((t,i)=>y(i)+t),512+8*t.featureIds.length+1024);this._memCache.put(this._getMemCacheKey(t.node),t,i)}_getMemCacheKey(t){return`${t.index}`}_removeAllNodeData(){this._nodesAddedToStage.forEach((t=>{t&&(this._updateNodeMemory(t.node),this._cacheNodeData(t))})),this._nodesAddedToStage.clear(),this._treeDebugger&&this._treeDebugger.update(),this.loadedGraphics.clear()}removeNode(t){const i=this._removeNodeStageData(t);i&&(this._updateNodeMemory(i.node),this._cacheNodeData(i))}_removeNodeStageData(t){const i=this._nodesAddedToStage.get(t);return i?(this.loadedGraphics.removeMany(i.graphics),this._nodesAddedToStage.delete(t),this._treeDebugger&&this._treeDebugger.update(),i):null}async loadCachedNodeData(t){return this._memCache.pop(this._getMemCacheKey(t))}async addCachedNodeData(t,i,s,e){if(!this._nodesAddedToStage.has(t.index))return this.loadedGraphics.addMany(i.graphics),this._nodesAddedToStage.set(t.index,i),this._updateNodeMemory(t),await this.updateAttributes(t.index,s,e),this._filterNode(i),this._treeDebugger&&this._treeDebugger.update(),Promise.resolve();Z.error("I3S node "+t.id+" already added")}getLoadedNodeIds(){const t=[];return this._nodesAddedToStage.forEach((i=>t.push(i.node.id))),t.sort()}getVisibleNodes(){const t=new Array;return this._nodesAddedToStage.forEach((i=>t.push(i.node))),t}getLoadedNodeIndices(t){this._nodesAddedToStage.forEach(((i,s)=>t.push(s)))}getLoadedAttributes(t){const i=this._nodesAddedToStage.get(t);if(i&&e(i.attributeInfo))return i.attributeInfo.loadedAttributes}getAttributeData(t){const i=this._nodesAddedToStage.get(t);if(i&&e(i.attributeInfo))return i.attributeInfo.attributeData}setAttributeData(t,i){const s=this._nodesAddedToStage.get(t);s&&!r(s.attributeInfo)&&(s.attributeInfo.attributeData=i,this._attributeValuesChanged(s))}async updateAttributes(t,i,s){const e=this._nodesAddedToStage.get(t);e&&(await this._attributeOverrides.apply(e.featureIds,i,s),e.attributeInfo=i,this._attributeValuesChanged(e))}_attributeValuesChanged(t){if(it(t),this._filterNode(t),this.graphics3d.graphicsCore.labelsEnabled){const i=t.graphics.map((t=>t.uid));this.graphics3d.graphicsCore.updateLabelingInfo(i)}}_updateClippingExtent(t){return this._controller&&this._controller.updateClippingArea(t),!1}_getObjectIdField(){return this.layer.objectIdField||"OBJECTID"}async _rendererChange(t,i){const{layer:{fieldsIndex:s}}=this,e=new Set;let r,p;t?(await t.collectRequiredFields(e,s),r=Array.from(e).sort()):r=[],e.clear(),i?(await i.collectRequiredFields(e,s),p=Array.from(e).sort()):p=[],r.length===p.length&&r.every(((t,i)=>r[i]===p[i]))||this._reloadAllNodes()}_rangeInfosChanged(t){null!=t&&t.length>0&&Z.warn("Unsupported property: rangeInfos are currently only serialized to and from web scenes but do not affect rendering.")}_filterChange(){this._nodesAddedToStage.forEach((t=>this._filterNode(t)))}_reloadAllNodes(){this._removeAllNodeData(),this._controller&&this._controller.restartNodeLoading()}_filterNode(t){const i=this.parsedDefinitionExpression;for(const s of t.graphics){const t=s.visible;s.visible=!i||this._evaluateClause(i,s),t!==s.visible&&(rt.graphic=s,rt.property="visible",rt.oldValue=t,rt.newValue=s.visible,this.graphics3d.graphicsCore.graphicUpdateHandler(rt))}}_invalidateElevation(t){const i=this._controller.crsIndex;l(t.extent,t.spatialReference,pt,i),this._controller.updateElevationChanged(pt,i)}createQuery(){const t={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference};return e(this.filter)?this.filter.createQuery(t):new A(t)}queryFeatures(t,i){return this._queryEngine.executeQuery(this._ensureQuery(t),null==i?void 0:i.signal)}queryObjectIds(t,i){return this._queryEngine.executeQueryForIds(this._ensureQuery(t),null==i?void 0:i.signal)}queryFeatureCount(t,i){return this._queryEngine.executeQueryForCount(this._ensureQuery(t),null==i?void 0:i.signal)}queryExtent(t,i){return this._queryEngine.executeQueryForExtent(this._ensureQuery(t),null==i?void 0:i.signal)}_ensureQuery(t){return this._addDefinitionExpressionToQuery(r(t)?this.createQuery():A.from(t))}getUsedMemory(){const t=this.graphics3d&&this.graphics3d.graphicsCore;return t?t.usedMemory:0}getUnloadedMemory(){const t=this.graphics3d&&this.graphics3d.graphicsCore;return.8*((this._controller?this._controller.unloadedMemoryEstimate:0)+(t?t.unprocessedMemoryEstimate:0))}ignoresMemoryFactor(){return this._controller&&this._controller.fixedFeatureTarget}_handleEdits(t){L(this.attributeEditingContext,t)}get attributeEditingContext(){const t=this._getObjectIdField();return{sessions:this._interactiveEditingSessions,fieldsIndex:this.layer.fieldsIndex,objectIdField:t,forEachNode:t=>this._nodesAddedToStage.forEach((i=>t(i.node,i.featureIds))),attributeStorageInfo:this.i3slayer.attributeStorageInfo,attributeOverrides:this._attributeOverrides,getAttributeData:t=>this.getAttributeData(t),setAttributeData:(i,s,r)=>{this.setAttributeData(i,s);const p=this._nodesAddedToStage.get(i);if(e(r)){const i=this.loadedGraphics.get(r.attributes[t]);e(i)&&this.graphics3d.graphicsCore.recreateGraphics([i])}else e(p)&&this.graphics3d.graphicsCore.recreateGraphics(p.graphics)},clearMemCache:()=>{}}}get performanceInfo(){const t={displayedNumberOfFeatures:this.loadedGraphics.length,maximumNumberOfFeatures:this.maximumNumberOfFeatures,totalNumberOfFeatures:-1,nodes:this._nodesAddedToStage.size,core:this.graphics3d.graphicsCore.performanceInfo};return this._controller&&this._controller.updateStats(t),t}get test(){return{controller:this._controller,numNodes:this._nodesAddedToStage.size,numFeatures:this.loadedGraphics.length}}};o([a()],X.prototype,"graphics3d",void 0),o([a({type:F})],X.prototype,"filter",void 0),o([a()],X.prototype,"loadedGraphics",void 0),o([a({aliasOf:"layer"})],X.prototype,"i3slayer",void 0),o([a()],X.prototype,"_controller",void 0),o([a()],X.prototype,"updating",void 0),o([a()],X.prototype,"suspended",void 0),o([a()],X.prototype,"holeFilling",void 0),o([a(H)],X.prototype,"updatingProgress",void 0),o([a({aliasOf:"_controller.updatingProgress"})],X.prototype,"updatingProgressValue",void 0),o([a(J.requiredFields)],X.prototype,"requiredFields",null),o([a(J.availableFields)],X.prototype,"availableFields",void 0),o([a()],X.prototype,"fieldsHelper",void 0),o([a({type:Number})],X.prototype,"maximumNumberOfFeatures",null),o([a({readOnly:!0})],X.prototype,"maximumNumberOfFeaturesExceeded",null),o([a({readOnly:!0,aliasOf:"view.qualitySettings.sceneService.point.lodFactor"})],X.prototype,"lodFactor",void 0),o([a({readOnly:!0})],X.prototype,"hasM",null),o([a({readOnly:!0})],X.prototype,"hasZ",null),X=o([n("esri.views.3d.layers.SceneLayerGraphicsView3D")],X);const $=X;function Y(t){return"pointData"in t}function tt(t){return"geometryBuffer"in t&&null!==t.geometryBuffer}function it(t){const i=t.attributeInfo;for(let s=0;s<t.graphics.length;s++){const r=t.graphics[s];if(r.attributes||(r.attributes={}),e(i)&&e(i.loadedAttributes))for(const{name:t}of i.loadedAttributes)i.attributeData[t]&&(r.attributes[t]=T(i.attributeData[t],s))}}const st={2:{type:"Embedded",params:{type:"points",vertexAttributes:{position:[0,0]}}},3:{type:"Embedded",params:{type:"points",vertexAttributes:{position:[0,0,0]}}}},et=c(),rt={graphic:null,property:null,oldValue:null,newValue:null},pt=b();export default $;