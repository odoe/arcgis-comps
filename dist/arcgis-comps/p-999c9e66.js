import{bO as e,s as t,V as s}from"./p-e58503d5.js";import"./p-53bb6ab4.js";let r;function n(n,a){let o=a.responseType;o?"array-buffer"!==o&&"blob"!==o&&"json"!==o&&"native"!==o&&"native-request-init"!==o&&"text"!==o&&(o="text"):o="json",a.responseType=o;const i=s(a.signal);return delete a.signal,e.invokeStaticMessage("request",{url:n,options:a},{signal:i}).then((async e=>{let s,l,u,b,c;if(e.data)if(e.data instanceof ArrayBuffer){if(!("json"!==o&&"text"!==o&&"blob"!==o||(s=new Blob([e.data]),"json"!==o&&"text"!==o||(r||(r=new FileReaderSync),b=r.readAsText(s),"json"!==o)))){try{l=JSON.parse(b||null)}catch(e){const s={...e,url:n,requestOptions:a};throw new t("request:server",e.message,s)}if(l.error){const e={...l.error,url:n,requestOptions:a};throw new t("request:server",l.error.message,e)}}}else"native"===o&&(e.data.signal=i,u=await fetch(e.data.url,e.data));switch(o){case"blob":c=s;break;case"json":c=l;break;case"native":c=u;break;case"text":c=b;break;default:c=e.data}return{data:c,requestOptions:a,ssl:e.ssl,url:n}}))}export{n as execute}