import{z as r,A as n,a as t,Z as u,J as e,al as i,V as f}from"./p-082c34d3.js";import{fw as o,fy as c,fv as a}from"./p-5420851c.js";import{WhereClause as s}from"./p-c0f8009d.js";import"./p-a184d75f.js";import"./p-a96c61aa.js";import"./p-dcac8868.js";import"./p-c3fd4463.js";import"./p-53bb6ab4.js";function m(r,u,c,a,m,j){if(1===a.length){if(t(a[0]))return o(i(r,a[0],f(a[1],-1)));if(e(a[0]))return o(i(r,a[0].toArray(),f(a[1],-1)))}else if(2===a.length){if(t(a[0]))return o(i(r,a[0],f(a[1],-1)));if(e(a[0]))return o(i(r,a[0].toArray(),f(a[1],-1)));if(n(a[0]))return a[0].load().then((n=>p(s.create(a[1],n.getFieldsIndex()),j,m).then((n=>a[0].calculateStatistic(r,n,f(a[2],1e3),u.abortSignal)))))}else if(3===a.length&&n(a[0]))return a[0].load().then((n=>p(s.create(a[1],n.getFieldsIndex()),j,m).then((n=>a[0].calculateStatistic(r,n,f(a[2],1e3),u.abortSignal)))));return o(i(r,a,-1))}function p(r,n,t){try{const u=r.getVariables();if(u.length>0){const e=[];for(let r=0;r<u.length;r++)e.push(n.evaluateIdentifier(t,{name:u[r]}));return c(e).then((n=>{const t={};for(let r=0;r<u.length;r++)t[u[r]]=n[r];return r.parameters=t,r}))}return o(r)}catch(r){return a(r)}}function j(i){"async"===i.mode&&(i.functions.stdev=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,u){return m("stdev",n,0,u,r,i)}))},i.functions.variance=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,u){return m("variance",n,0,u,r,i)}))},i.functions.average=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,u){return m("mean",n,0,u,r,i)}))},i.functions.mean=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,u){return m("mean",n,0,u,r,i)}))},i.functions.sum=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,u){return m("sum",n,0,u,r,i)}))},i.functions.min=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,u){return m("min",n,0,u,r,i)}))},i.functions.max=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,u){return m("max",n,0,u,r,i)}))},i.functions.count=function(f,o){return i.standardFunctionAsync(f,o,(function(i,f,o){if(r(o,1,1),n(o[0]))return o[0].count(i.abortSignal);if(t(o[0])||u(o[0]))return o[0].length;if(e(o[0]))return o[0].length();throw new Error("Invalid Parameters for Count")}))})}export{j as registerFunctions}