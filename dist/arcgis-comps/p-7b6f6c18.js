import{N as t}from"./p-227a5838.js";function e(t,e,i,s){var n,r=arguments.length,o=r<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,e,i,s);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(o=(r<3?n(o):r>3?n(e,i,o):n(e,i))||o);return r>3&&o&&Object.defineProperty(e,i,o),o}const i="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:void 0;var s,n;let r;var o,a;function l(t){return"function"==typeof r[t]?r[t]=r[t](i):r[t]}function u(t){return null!=t}function c(t){return null==t}function h(t){return void 0===t}function d(t,e){return u(t)?e(t):null}function p(t){return t}function f(t,e){if(c(t))throw Error(e);return t}function y(t,e){return u(t)?t:"function"==typeof e?e():e}function m(t){return u(t)&&t.destroy(),null}function g(t){return u(t)&&t.dispose(),null}function v(t){return u(t)&&t.remove(),null}function w(t){return u(t)&&t.release(),null}function b(t,e){const i=[];for(const s of t)i.push(S(s,null,e));return i}function M(t,e){for(const i of t)S(i,null,e)}function S(t,e,i){return u(t)?i(t):e}function x(t,e){return u(t)?e(t):null}function k(t){return t.filter((t=>u(t)))}function I(t,...e){let i=t;for(let t=0;t<e.length&&i;++t)i=i[e[t]];return i}function j(t){return t}r=null!=(s=i.dojoConfig)&&s.has||null!=(n=i.esriConfig)&&n.has?{...null==(o=i.dojoConfig)?void 0:o.has,...null==(a=i.esriConfig)?void 0:a.has}:{},l.add=(t,e,i,s)=>((s||void 0===r[t])&&(r[t]=e),i&&l(t)),l.cache=r,l.add("esri-deprecation-warnings",!0),(()=>{l.add("host-webworker",void 0!==i.WorkerGlobalScope&&self instanceof i.WorkerGlobalScope);const t="undefined"!=typeof window&&"undefined"!=typeof location&&"undefined"!=typeof document&&window.location===location&&window.document===document;if(l.add("host-browser",t),l.add("host-node","object"==typeof i.process&&i.process.versions&&i.process.versions.node&&i.process.versions.v8),l.add("dom",t),l("host-browser")){const t=navigator,e=t.userAgent,i=t.appVersion,s=parseFloat(i);if(l.add("wp",parseFloat(e.split("Windows Phone")[1])||void 0),l.add("msapp",parseFloat(e.split("MSAppHost/")[1])||void 0),l.add("khtml",i.includes("Konqueror")?s:void 0),l.add("edge",parseFloat(e.split("Edge/")[1])||void 0),l.add("opr",parseFloat(e.split("OPR/")[1])||void 0),l.add("webkit",!l("wp")&&!l("edge")&&parseFloat(e.split("WebKit/")[1])||void 0),l.add("chrome",!l("edge")&&!l("opr")&&parseFloat(e.split("Chrome/")[1])||void 0),l.add("android",!l("wp")&&parseFloat(e.split("Android ")[1])||void 0),l.add("safari",!i.includes("Safari")||l("wp")||l("chrome")||l("android")||l("edge")||l("opr")?void 0:parseFloat(i.split("Version/")[1])),l.add("mac",i.includes("Macintosh")),!l("wp")&&e.match(/(iPhone|iPod|iPad)/)){const t=RegExp.$1.replace(/P/,"p"),i=e.match(/OS ([\d_]+)/)?RegExp.$1:"1",s=parseFloat(i.replace(/_/,".").replace(/_/g,""));l.add(t,s),l.add("ios",s)}l.add("trident",parseFloat(i.split("Trident/")[1])||void 0),l("webkit")||(!e.includes("Gecko")||l("wp")||l("khtml")||l("trident")||l("edge")||l.add("mozilla",s),l("mozilla")&&l.add("ff",parseFloat(e.split("Firefox/")[1]||e.split("Minefield/")[1])||void 0))}})(),(()=>{if(i.navigator){const t=navigator.userAgent,e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini|IEMobile/i.test(t),i=/iPhone/i.test(t);e&&l.add("esri-mobile",e),i&&l.add("esri-iPhone",i),l.add("esri-geolocation",!!navigator.geolocation)}l.add("esri-canvas-svg-support",!l("trident")),l.add("esri-wasm","WebAssembly"in i),l.add("esri-shared-array-buffer",(()=>"SharedArrayBuffer"in i&&!(!1===i.crossOriginIsolated))),l.add("esri-atomics","Atomics"in i),l.add("esri-workers","Worker"in i),l.add("esri-text-decoder","TextDecoder"in i),l.add("esri-text-encoder","TextEncoder"in i),l.add("web-feat:cache","caches"in i),l.add("esri-workers-arraybuffer-transfer",!l("safari")||Number(l("safari"))>=12),l.add("featurelayer-simplify-thresholds",[.5,.5,.5,.5]),l.add("featurelayer-simplify-payload-size-factors",[1,1,4]),l.add("featurelayer-snapshot-enabled",!0),l.add("featurelayer-snapshot-point-min-threshold",8e4),l.add("featurelayer-snapshot-point-max-threshold",4e5),l.add("featurelayer-snapshot-point-coverage",.1),l.add("featurelayer-advanced-symbols",!1),l.add("featurelayer-pbf",!0),l.add("featurelayer-pbf-statistics",!1),l.add("feature-layers-workers",!0),l.add("mapview-transitions-duration",200),l.add("mapserver-pbf-enabled",!1),l("host-webworker")||l("host-browser")&&(l.add("esri-csp-restrictions",(()=>{try{Function()}catch{return!0}return!1})),l.add("esri-image-decode",(()=>{if("decode"in new Image){const t=new Image;return t.src='data:image/svg+xml;charset=UTF-8,<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>',void t.decode().then((()=>{l.add("esri-image-decode",!0,!0,!0)})).catch((()=>{l.add("esri-image-decode",!1,!0,!0)}))}return!1})),l.add("esri-url-encodes-apostrophe",(()=>{const t=i.document.createElement("a");return t.href="?'",t.href.includes("?%27")})),l.add("vectortilelayer-max-buffers",l("ff")?160:1/0))})();class _{constructor(t=1){this._seed=t}set seed(t){this._seed=null==t?Math.random()*_._m:t}getInt(){return this._seed=(_._a*this._seed+_._c)%_._m,this._seed}getFloat(){return this.getInt()/(_._m-1)}getIntRange(t,e){return Math.round(this.getFloatRange(t,e))}getFloatRange(t,e){const i=e-t;return t+this.getInt()/_._m*i}}function T(t,e,i){if(c(t)&&c(e))return!0;if(c(t)||c(e)||t.length!==e.length)return!1;if(i){for(let s=0;s<t.length;s++)if(!i(t[s],e[s]))return!1}else for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}function O(t){return t&&"number"==typeof t.length}_._m=2147483647,_._a=48271,_._c=0;const A=!!Array.prototype.fill;function F(t,e){if(A)return Array(t).fill(e);const i=Array(t);for(let s=0;s<t;s++)i[s]=e;return i}function C(t,e){void 0===e&&(e=t,t=0);const i=Array(e-t);for(let s=t;s<e;s++)i[s-t]=s;return i}function P(t){return t.reduce(((t,e)=>t.concat(e||[])),[])}class E{constructor(){this.last=0}}const R=new E;function L(t,e,i,s){const n=Math.max(0,(s=s||R).last-10);for(let r=n;r<i;++r)if(t[r]===e)return s.last=r,r;const r=Math.min(n,i);for(let i=0;i<r;++i)if(t[i]===e)return s.last=i,i;return-1}function N(t,e,i,s){const n=null==i?t.length:i,r=L(t,e,n,s);if(-1!==r)return t[r]=t[n-1],null==i&&t.pop(),e}const D=new Set;function V(t,e){const i=t.indexOf(e);return-1!==i?(t.splice(i,1),e):null}function $(t,e){if(t.forEach)t.forEach(e);else for(let i=0;i<t.length;i++)e(t[i],i,t)}function z(t,e,i){if(t.slice)return t.slice(e,i);void 0===e?e=0:(e<0&&(e+=t.length),e=Math.min(t.length,Math.max(0,e))),void 0===i?i=t.length:(i<0&&(i+=t.length),i=Math.min(t.length,Math.max(0,i)));const s=Math.max(0,i-e),n=new t.constructor(s);for(let i=0;i<s;i++)n[i]=t[e+i];return n}function G(t){return t instanceof ArrayBuffer||t&&t.constructor&&"ArrayBuffer"===t.constructor.name}function U(t){return t instanceof Uint8Array||t&&t.constructor&&"Uint8Array"===t.constructor.name}function q(t){return t instanceof Uint16Array||t&&t.constructor&&"Uint16Array"===t.constructor.name}function B(t){return t instanceof Uint32Array||t&&t.constructor&&"Uint32Array"===t.constructor.name}function W(t,e){let i;if(e)for(i in t)t.hasOwnProperty(i)&&(void 0===t[i]?delete t[i]:t[i]instanceof Object&&W(t[i],!0));else for(i in t)t.hasOwnProperty(i)&&void 0===t[i]&&delete t[i];return t}function H(t){if(!t||"object"!=typeof t||"function"==typeof t)return t;if(function(t){return t instanceof Int8Array||t&&t.constructor&&"Int8Array"===t.constructor.name}(t)||U(t)||function(t){return t instanceof Uint8ClampedArray||t&&t.constructor&&"Uint8ClampedArray"===t.constructor.name}(t)||function(t){return t instanceof Int16Array||t&&t.constructor&&"Int16Array"===t.constructor.name}(t)||q(t)||function(t){return t instanceof Int32Array||t&&t.constructor&&"Int32Array"===t.constructor.name}(t)||B(t)||function(t){return t instanceof Float32Array||t&&t.constructor&&"Float32Array"===t.constructor.name}(t)||function(t){return t instanceof Float64Array||t&&t.constructor&&"Float64Array"===t.constructor.name}(t))return z(t);if(t instanceof Date)return new Date(t.getTime());if(t instanceof ArrayBuffer)return t.slice(0,t.byteLength);if(t instanceof Map){const e=new Map;return t.forEach(((t,i)=>{e.set(i,H(t))})),e}if(t instanceof Set){const e=new Set;return t.forEach((t=>{e.add(H(t))})),e}let e;const i=t;if("function"==typeof i.clone)e=i.clone();else if("function"==typeof i.map&&"function"==typeof i.forEach)e=i.map(H);else if("function"==typeof i.notifyChange&&"function"==typeof i.watch)e=i.clone();else{e={};for(const i of Object.getOwnPropertyNames(t))e[i]=H(t[i])}return e}function J(t,e){return t===e||"number"==typeof t&&isNaN(t)&&"number"==typeof e&&isNaN(e)||"function"==typeof(t||{}).getTime&&"function"==typeof(e||{}).getTime&&t.getTime()===e.getTime()||!1}function Z(t,e,i=!1){return X(t,e,i)}function Q(t,e){if(null!=e)return e[t]||Y(t.split("."),!1,e)}function K(t,e,i){const s=t.split("."),n=s.pop(),r=Y(s,!0,i);r&&n&&(r[n]=e)}function Y(t,e,i){let s=i;for(const i of t){if(null==s)return;if(!(i in s)){if(!e)return;s[i]={}}s=s[i]}return s}function X(t,e,i){return e?Object.keys(e).reduce((function(t,s){let n=t[s],r=e[s];return n===r?t:void 0===n?(t[s]=H(r),t):(Array.isArray(r)||Array.isArray(t)?(n=t[s]=n?Array.isArray(n)?n.concat():[n]:[],r&&(Array.isArray(r)||(r=[r]),i?r.forEach((t=>{-1===n.indexOf(t)&&n.push(t)})):t[s]=r.concat())):r&&"object"==typeof r?t[s]=X(n,r,i):t.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(t[s]=r),t)}),t||{}):t}const tt="20211104",et="f56ab3008fdaea1ce910515531b6ddb258d83e4f",it={apiKey:void 0,applicationUrl:i.location&&i.location.href,assetsPath:"",fontsUrl:"https://static.arcgis.com/fonts",geometryService:null,geometryServiceUrl:"https://utility.arcgisonline.com/arcgis/rest/services/Geometry/GeometryServer",geoRSSServiceUrl:"https://utility.arcgis.com/sharing/rss",kmlServiceUrl:"https://utility.arcgis.com/sharing/kml",portalUrl:"https://www.arcgis.com",workers:{loaderConfig:{has:{},paths:{},map:{},packages:[]}},request:{httpsDomains:["arcgis.com","arcgisonline.com","esrikr.com","premiumservices.blackbridge.com","esripremium.accuweather.com","gbm.digitalglobe.com","firstlook.digitalglobe.com","msi.digitalglobe.com"],interceptors:[],maxUrlLength:2e3,proxyRules:[],proxyUrl:null,timeout:6e4,trustedServers:[],useIdentity:!0},log:{interceptors:[],level:null}};i.esriConfig&&(Z(it,i.esriConfig,!0),delete it.has),it.assetsPath||(it.assetsPath=`https://cdn.jsdelivr.net/npm/@arcgis/core@4.22.0-next.${tt}/assets`),it.baseUrl&&console.warn("[esri.config]","baseUrl has been replaced by assetsPath"),Object.defineProperty(it,"baseUrl",{set(){console.warn("[esri.config]","baseUrl has been replaced by assetsPath")}}),it.request.corsEnabledServers=[],it.request.corsEnabledServers.push=function(){return console.warn("[esri.config]","request.corsEnabledServers is not supported and will be removed in a future release. See http://esriurl.com/cors8664"),0};const st=/\{([^\}]+)\}/g;function nt(t){return null==t?"":t}function rt(t,e){return t.replace(st,"object"==typeof e?(t,i)=>nt(Q(i,e)):(t,i)=>nt(e(i)))}function ot(t,e){return t.replace(/([\.$?*|{}\(\)\[\]\\\/\+\-^])/g,(t=>e&&-1!==e.indexOf(t)?t:"\\"+t))}function at(t){let e=0;for(let i=0;i<t.length;i++)e=(e<<5)-e+t.charCodeAt(i),e|=0;return e}function lt(t){return(new DOMParser).parseFromString(t||"","text/html").body.innerText||""}const ut={info:0,warn:1,error:2,none:3};class ct{constructor(t){this.level=null,this._module="",this._parent=null,this.writer=null,this._loggedMessages={error:new Map,warn:new Map,info:new Map},null!=t.level&&(this.level=t.level),null!=t.writer&&(this.writer=t.writer),this._module=t.module,ct._loggers[this.module]=this;const e=this.module.lastIndexOf(".");-1!==e&&(this._parent=ct.getLogger(this.module.slice(0,e)))}get module(){return this._module}get parent(){return this._parent}error(...t){this._log("error","always",...t)}warn(...t){this._log("warn","always",...t)}info(...t){this._log("info","always",...t)}errorOnce(...t){this._log("error","once",...t)}warnOnce(...t){this._log("warn","once",...t)}infoOnce(...t){this._log("info","once",...t)}errorOncePerTick(...t){this._log("error","oncePerTick",...t)}warnOncePerTick(...t){this._log("warn","oncePerTick",...t)}infoOncePerTick(...t){this._log("info","oncePerTick",...t)}get test(){const t=this;return{loggedMessages:t._loggedMessages,clearLoggedWarnings:()=>t._loggedMessages.warn.clear()}}static get testSingleton(){return{resetLoggers(t={}){const e=ct._loggers;return ct._loggers=t,e},set throttlingDisabled(t){ct._throttlingDisabled=t}}}static getLogger(t){let e=ct._loggers[t];return e||(e=new ct({module:t})),e}_log(t,e,...i){if(this._matchLevel(t)){if("always"!==e&&!ct._throttlingDisabled){const s=this._argsToKey(i),n=this._loggedMessages[t].get(s);if("once"===e&&null!=n||"oncePerTick"===e&&n&&n>=ct._tickCounter)return;this._loggedMessages[t].set(s,ct._tickCounter),ct._scheduleTickCounterIncrement()}for(const e of it.log.interceptors)if(e(t,this.module,...i))return;this._inheritedWriter()(t,this.module,...i)}}_parentWithMember(t,e){let i=this;for(;u(i);){const e=i[t];if(u(e))return e;i=i.parent}return e}_inheritedWriter(){return this._parentWithMember("writer",this._consoleWriter)}_consoleWriter(t,e,...i){console[t](`[${e}]`,...i)}_matchLevel(t){return ut[this._parentWithMember("level",it.log.level?it.log.level:"warn")]<=ut[t]}_argsToKey(...t){return at(JSON.stringify(t,((t,e)=>"object"!=typeof e||Array.isArray(e)?e:"[Object]")))}static _scheduleTickCounterIncrement(){ct._tickCounterScheduled||(ct._tickCounterScheduled=!0,Promise.resolve().then((()=>{ct._tickCounter++,ct._tickCounterScheduled=!1})))}}function ht(t,e){for(const[i,s]of t)if(e(s,i))return!0;return!1}function dt(t,e,i){const s=t.get(e);if(void 0!==s)return s;const n=i();return t.set(e,n),n}ct._loggers={},ct._tickCounter=0,ct._tickCounterScheduled=!1,ct._throttlingDisabled=!1;const pt=ct.getLogger("esri.core.Accessor");function ft(t){return null==t?t:new Date(t)}function yt(t){return null==t?t:!!t}function mt(t){return null==t?t:""+t}function gt(t){return null==t?t:isNaN(t=parseFloat(t))?0:t}function vt(t){return null==t?t:Math.round(parseFloat(t))}function wt(t){return t&&t.constructor&&void 0!==t.constructor.__accessorMetadata__}function bt(t,e){return null!=e&&t&&!(e instanceof t)}function Mt(t){return t&&"isCollection"in t}function St(t){return t&&t.Type?"function"==typeof t.Type?t.Type:t.Type.base:null}function xt(t,e){return!!wt(e)&&(pt.error("Accessor#set","Assigning an instance of '"+(e.declaredClass||"unknown")+"' which is not a subclass of '"+It(t)+"'"),!0)}function kt(t,e){return null==e?e:Mt(t)?function(t,e){if(!e||!e.constructor||!Mt(e.constructor))return xt(t,e)?e:new t(e);const i=St(t.prototype.itemType),s=St(e.constructor.prototype.itemType);return i?s?i===s?e:i.prototype.isPrototypeOf(s.prototype)?new t(e):(xt(t,e),e):new t(e):e}(t,e):bt(t,e)?xt(t,e)?e:new t(e):e}function It(t){return t&&t.prototype&&t.prototype.declaredClass||"unknown"}const jt=new WeakMap;function _t(t){switch(t){case Number:return gt;case Rt:return vt;case Boolean:return yt;case String:return mt;case Date:return ft;default:return dt(jt,t,(()=>kt.bind(null,t)))}}function Tt(t,e){const i=_t(t);return 1===arguments.length?i:i(e)}function Ot(t,e,i){return 1===arguments.length?Ot.bind(null,t):e?Array.isArray(e)?e.map((e=>t(e,i))):[t(e,i)]:e}function At(t,e,i){return 0!==e&&Array.isArray(i)?i.map((i=>At(t,e-1,i))):t(i)}function Ft(t,e,i){if(2===arguments.length)return Ft.bind(null,t,e);if(!i)return i;let s=e,n=i=At(t,e,i);for(;s>0&&Array.isArray(n);)s--,n=n[0];if(void 0!==n)for(let t=0;t<s;t++)i=[i];return i}function Ct(t){return!!Array.isArray(t)&&!t.some((e=>{const i=typeof e;return!("string"===i||"number"===i||"function"===i&&t.length>1)}))}function Pt(t,e){if(2===arguments.length)return Pt(t).call(null,e);const i=new Set,s=t.filter((t=>"function"!=typeof t)),n=t.filter((t=>"function"==typeof t));for(const e of t)"string"!=typeof e&&"number"!=typeof e||i.add(e);let r=null,o=null;return(t,e)=>{if(null==t)return t;const a=typeof t,l="string"===a||"number"===a;return l&&(i.has(t)||n.some((t=>"string"===a&&t===String||"number"===a&&t===Number)))||"object"===a&&n.some((e=>!bt(t,e)))?t:(l&&s.length?(r||(r=s.map((t=>"string"==typeof t?`'${t}'`:""+t)).join(", ")),pt.error("Accessor#set",`'${t}' is not a valid value for this property, only the following values are valid: ${r}`)):"object"==typeof t&&n.length?(o||(o=n.map((t=>It(t))).join(", ")),pt.error("Accessor#set",`'${t}' is not a valid value for this property, value must be one of ${o}`)):pt.error("Accessor#set",`'${t}' is not a valid value for this property`),e&&(e.valid=!1),null)}}function Et(t,e){if(2===arguments.length)return Et(t).call(null,e);const i={},s=[],n=[];for(const e in t.typeMap){const r=t.typeMap[e];i[e]=Tt(r),s.push(It(r)),n.push(e)}const r=()=>`'${s.join("', '")}'`,o=()=>`'${n.join("', '")}'`,a="string"==typeof t.key?e=>e[t.key]:t.key;return e=>{if(t.base&&!bt(t.base,e))return e;if(null==e)return e;const s=a(e)||t.defaultKeyValue,n=i[s];if(!n)return pt.error("Accessor#set",`Invalid property value, value needs to be one of ${r()}, or a plain object that can autocast (having .type = ${o()})`),null;if(!bt(t.typeMap[s],e))return e;if("string"==typeof t.key&&!wt(e)){const i={};for(const s in e)s!==t.key&&(i[s]=e[s]);return n(i)}return n(e)}}class Rt{}const Lt={native:t=>({type:"native",value:t}),array:t=>({type:"array",value:t}),oneOf:t=>({type:"one-of",values:t})};function Nt(t){switch(t.type){case"native":return Tt(t.value);case"array":return Ot(Nt(t.value));case"one-of":return function(t){let e=null;return(i,s)=>Vt(i,t)?i:(null==e&&(e=Dt(t)),pt.error("Accessor#set","Invalid property value, value needs to be of type "+e),s&&(s.valid=!1),null)}(t);default:return null}}function Dt(t){switch(t.type){case"native":switch(t.value){case Number:return"number";case String:return"string";case Boolean:return"boolean";case Rt:return"integer";case Date:return"date";default:return It(t.value)}case"array":return"array of "+Dt(t.value);case"one-of":{const e=t.values.map((t=>Dt(t)));return`one of ${e.slice(0,e.length-1)} or ${e[e.length-1]}`}}return"unknown"}function Vt(t,e){if(null==t)return!0;switch(e.type){case"native":switch(e.value){case Number:case Rt:return"number"==typeof t;case Boolean:return"boolean"==typeof t;case String:return"string"==typeof t}return t instanceof e.value;case"array":return!!Array.isArray(t)&&!t.some((t=>!Vt(t,e.value)));case"one-of":return e.values.some((e=>Vt(t,e)))}}function $t(t){return zt((()=>t.forEach((t=>u(t)&&t.remove()))))}function zt(t){return{remove:()=>{t&&(t(),t=void 0)}}}function Gt(t){return t?t.__accessor__?t.__accessor__:t.propertyInvalidated?t:null:null}function Ut(t,e,i){return qt(t,e,i?{policy:i,path:""}:null)}function qt(t,e,i){return e?Object.keys(e).reduce((function(t,s){let n=null,r="merge";if(i&&(n=i.path?`${i.path}.${s}`:s,r=i.policy(n)),"replace"===r)return t[s]=e[s],t;if(void 0===t[s])return t[s]=H(e[s]),t;let o=t[s],a=e[s];if(o===a)return t;if(Array.isArray(a)||Array.isArray(t))o=t[s]=o?Array.isArray(o)?o.concat():[o]:[],a&&(Array.isArray(a)||(a=[a]),a.forEach((t=>{-1===o.indexOf(t)&&o.push(t)})));else if(a&&"object"==typeof a)if(i){const e=i.path;i.path=n,t[s]=qt(o,a,i),i.path=e}else t[s]=qt(o,a,null);else t.hasOwnProperty(s)&&!e.hasOwnProperty(s)||(t[s]=a);return t}),t||{}):t}function Bt(t){return Array.isArray(t)?t:t.split(".")}function Wt(t){return t.indexOf(",")>-1?t.split(",").map((t=>t.trim())):[t.trim()]}function Ht(t,e,i,s){const n=function(t){if(Array.isArray(t)){const e=[];for(const i of t)e.push(...Wt(i));return e}return Wt(t)}(e);return 1!==n.length?$t(n.map((e=>s(t,e,i)))):s(t,n[0],i)}function Jt(t){let e=!1;return()=>{e||(e=!0,t())}}function Zt(t,e){const i="?"===t[t.length-1]?t.slice(0,-1):t;if(null!=e.getItemAt||Array.isArray(e)){const t=parseInt(i,10);if(!isNaN(t))return Array.isArray(e)?e[t]:e.getItemAt(t)}const s=Gt(e);return function(t,e){return null!=t&&t.metadatas&&null!=t.metadatas[e]}(s,i)?s.get(i):e[i]}function Qt(t,e,i){if(null==t)return t;const s=Zt(e[i],t);return!s&&i<e.length-1?void 0:i===e.length-1?s:Qt(s,e,i+1)}function Kt(t,e,i=0){return"string"==typeof e&&-1===e.indexOf(".")?Zt(e,t):Qt(t,Bt(e),i)}function Yt(t,e){return Kt(t,e)}function Xt(t,e){return void 0!==Kt(e,t)}class te{constructor(t){this.autoDestroy=!1,this.properties=t}}function ee(t){let e=t.constructor.__accessorMetadata__;const i=Object.prototype.hasOwnProperty.call(t.constructor,"__accessorMetadata__");if(e){if(!i){const i=Object.create(e.properties),s=e.autoDestroy;for(const t in i)i[t]=H(i[t]);e=new te(i),e.autoDestroy=s,Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0})}}else e=new te({}),Object.defineProperty(t.constructor,"__accessorMetadata__",{value:e,enumerable:!1,configurable:!0,writable:!0});return t.constructor.__accessorMetadata__}function ie(t,e){const i=function(t){return ee(t).properties}(t);let s=i[e];return s||(s=i[e]={}),s}const se=/^(?:[^.]+\.)?(?:value|type|(?:json\.type|json\.origins\.[^.]\.type))$/;function ne(t){return se.test(t)?"replace":"merge"}function re(t,e,i){if(t&&e)if("object"==typeof e)for(const i of Object.getOwnPropertyNames(e))re(t,i,e[i]);else{if(-1!==e.indexOf(".")){const s=e.split("."),n=s.splice(s.length-1,1)[0];return void re(Yt(t,s),n,i)}t[e]=i}}function oe(t={}){return(e,i)=>{if(e===Function.prototype)throw Error(`Inappropriate use of @property() on a static field: ${e.name}.${i}. Accessor does not support static properties.`);const s=Object.getOwnPropertyDescriptor(e,i),n=ie(e,i);s&&(s.get||s.set?(n.get=s.get||n.get,n.set=s.set||n.set):"value"in s&&("value"in t&&ct.getLogger("esri.core.accessorSupport.decorators.property").warn(`@property() will redefine the value of "${i}" on "${e.constructor.name}" already defined in the metadata`,t),n.value=t.value=s.value)),null!=t.readOnly&&(n.readOnly=t.readOnly);const r=t.aliasOf;if(r){const t="string"==typeof r?r:r.source,e="string"==typeof r?null:!0===r.overridable;let s;n.dependsOn=[t],n.get=function(){let e=Yt(this,t);if("function"==typeof e){s||(s=t.split(".").slice(0,-1).join("."));const i=Yt(this,s);i&&(e=e.bind(i))}return e},n.readOnly||(n.set=e?function(t){void 0!==t?this._override(i,t):this._clearOverride(i)}:function(e){re(this,t,e)})}const o=t.type,a=t.types;n.cast||(o?n.cast=function(t){let e=0,i=t;if(function(t){if(!t||!("type"in t))return!1;switch(t.type){case"native":case"array":case"one-of":return!0}return!1}(t))return Nt(t);for(;Array.isArray(i)&&1===i.length&&"string"!=typeof i[0]&&"number"!=typeof i[0];)i=i[0],e++;const s=i;if(Ct(s))return 0===e?Pt(s):Ft(Pt(s),e);if(1===e)return function(t,e){return 1===arguments.length?Ot(Tt.bind(null,t)):Ot(Tt.bind(null,t),e)}(s);if(e>1)return function(t,e,i){return 2===arguments.length?Ft(Tt.bind(null,t),e):Ft(Tt.bind(null,t),e,i)}(s,e);return t.from?t.from:Tt(t)}(o):a&&(n.cast=Array.isArray(a)?Ot(Et(a[0])):Et(a))),t.range&&(n.cast=le(n.cast,t.range)),function(t,e){Ut(t,e,ne)}(n,t)}}function ae(t,e,i){const s=ie(t,i);s.json||(s.json={});let n=s.json;return void 0!==e&&(n.origins||(n.origins={}),n.origins[e]||(n.origins[e]={}),n=n.origins[e]),n}function le(t,e){return i=>{let s=+t(i);return null!=e.step&&(s=Math.round(s/e.step)*e.step),null!=e.min&&(s=Math.max(e.min,s)),null!=e.max&&(s=Math.min(e.max,s)),s}}function ue(t,e){return oe({aliasOf:e?{...e,source:t}:t})}ct.getLogger("esri.core.accessorSupport.set");let ce,he=[];const de=ct.getLogger("esri.core.Accessor");function pe(t){void 0!==ce&&ce.onObservableAccessed(t)}let fe=!1,ye=!1;function me(t,e,i){if(fe)return ge(t,e,i);ve(t);const s=e.call(i);return we(),s}function ge(t,e,i){const s=fe;fe=!0,ve(t);let n=null;try{n=e.call(i)}catch(t){ye&&de.error(t)}return we(),fe=s,n}function ve(t){ce=t,he.push(t)}function we(){const t=he.pop();ce=he.length>0?he[he.length-1]:void 0,void 0!==t&&t.onTrackingEnd()}function be(t,e){if(32&e.flags)return;const i=ye;ye=!1,64&e.flags?ge(e,e.metadata.get,t):Se(t,e),ye=i}const Me=[];function Se(t,e){128&e.flags||(e.flags|=128,ge(e,(()=>{const i=e.metadata.dependsOn||Me;for(const e of i)if("string"==typeof e&&-1===e.indexOf("."))xe(t,e,!1);else{const i=Bt(e);for(let e=0,s=t;e<i.length&&null!=s&&"object"==typeof s;++e)s=xe(s,i[e],e!==i.length-1)}})),e.flags&=-129)}function xe(t,e,i){const s="?"===e[e.length-1]?e.slice(0,-1):e;if(null!=t.getItemAt||Array.isArray(t)){const e=parseInt(s,10);if(!isNaN(e))return Array.isArray(t)?t[e]:t.getItemAt(e)}const n=Gt(t),r=null==n?void 0:n.properties.get(s);return r&&(pe(r),be(t,r)),i?t[s]:void 0}class ke{constructor(t,e,i){this.name=t,this.details=i,this.message=void 0,this instanceof ke&&(this.message=e&&function(t,e){return t.replace(/\$\{([^\s\:\}]*)(?:\:([^\s\:\}]+))?\}/g,(function(t,i){if(""===i)return"$";const s=Q(i,e),n=null==s?"":s;if(void 0===n)throw Error(`could not find key "${i}" in template`);return""+n}))}(e,i)||"")}toString(){return"["+this.name+"]: "+this.message}}class Ie extends ke{constructor(t,e,i){if(super(t,e,i),!(this instanceof Ie))return new Ie(t,e,i)}}function je(t){return!!t&&t.prototype&&t.prototype.declaredClass&&0===t.prototype.declaredClass.indexOf("esri.core.Collection")}Ie.prototype.type="warning";const _e=ct.getLogger("esri.core.accessorSupport.extensions.serializableProperty.reader");function Te(t,e,i){var s,n;t&&(!i&&!e.read||null!=(s=e.read)&&s.reader||!1===(null==(n=e.read)?void 0:n.enabled)||function(t){return"types"in t?Re(t.types):Ee(t.type)}(t)&&K("read.reader",Oe(t),e))}function Oe(t){var e;const i=null!=(e=t.ndimArray)?e:0;if(i>1)return function(t){var e;const i=Ae(t),s=Fe.bind(null,i),n=null!=(e=t.ndimArray)?e:0;return(t,e,i)=>{if(null==t)return t;t=s(t,i,n);let r=n,o=t;for(;r>0&&Array.isArray(o);)r--,o=o[0];if(void 0!==o)for(let e=0;e<r;e++)t=[t];return t}}(t);if(1===i)return Ce(t);if("type"in t&&Pe(t.type)){var s,n;const e=null==(s=t.type.prototype)||null==(n=s.itemType)?void 0:n.Type,i=Ce("function"==typeof e?{type:e}:{types:e});return(e,s,n)=>{const r=i(e,s,n);return r?new t.type(r):r}}return Ae(t)}function Ae(t){return"type"in t?function(t){return t.prototype.read?(e,i,s)=>{if(null==e)return e;const n=typeof e;if("object"!==n)return void _e.error(`Expected JSON value of type 'object' to deserialize type '${t.prototype.declaredClass}', but got '${n}'`);const r=new t;return r.read(e,s),r}:t.fromJSON}(t.type):function(t){var e;let i=null;const s=null!=(e=t.errorContext)?e:"type";return(e,n,r)=>{if(null==e)return e;const o=typeof e;if("object"!==o)return void _e.error(`Expected JSON value of type 'object' to deserialize, but got '${o}'`);i||(i=function(t){const e={};for(const n in t.typeMap){var i,s;const r=t.typeMap[n],o=ee(r.prototype);if("function"==typeof t.key)continue;const a=o.properties[t.key];if(!a)continue;null!=(i=a.json)&&i.type&&Array.isArray(a.json.type)&&1===a.json.type.length&&"string"==typeof a.json.type[0]&&(e[a.json.type[0]]=r);const l=null==(s=a.json)?void 0:s.write;if(!l||!l.writer){e[n]=r;continue}const u=l.target,c="string"==typeof u?u:t.key,h={};l.writer(n,h,c),h[c]&&(e[h[c]]=r)}return e}(t));const a=t.key;if("string"!=typeof a)return;const l=e[a],u=l?i[l]:t.defaultKeyValue?t.typeMap[t.defaultKeyValue]:void 0;if(!u){const t=`Type '${l||"unknown"}' is not supported`;return r&&r.messages&&e&&r.messages.push(new Ie(s+":unsupported",t,{definition:e,context:r})),void _e.error(t)}const c=new u;return c.read(e,r),c}}(t.types)}function Fe(t,e,i,s){return 0!==s&&Array.isArray(e)?e.map((e=>Fe(t,e,i,s-1))):t(e,void 0,i)}function Ce(t){const e=Ae(t);return(t,i,s)=>{if(null==t)return t;if(Array.isArray(t)){const i=[];for(const n of t){const t=e(n,void 0,s);void 0!==t&&i.push(t)}return i}const n=e(t,void 0,s);return void 0!==n?[n]:void 0}}function Pe(t){if(!je(t))return!1;const e=t.prototype.itemType;return!(!e||!e.Type)&&("function"==typeof e.Type?Ee(e.Type):Re(e.Type))}function Ee(t){return!Array.isArray(t)&&!!t&&t.prototype&&("read"in t.prototype||"fromJSON"in t||Pe(t))}function Re(t){for(const e in t.typeMap)if(!Ee(t.typeMap[e]))return!1;return!0}function Le(t){t.name&&(t.read&&"object"==typeof t.read?void 0===t.read.source&&(t.read.source=t.name):t.read={source:t.name},t.write&&"object"==typeof t.write?void 0===t.write.target&&(t.write.target=t.name):t.write={target:t.name})}function Ne(t){"boolean"==typeof t.read?t.read={enabled:t.read}:"function"==typeof t.read?t.read={enabled:!0,reader:t.read}:t.read&&"object"==typeof t.read&&void 0===t.read.enabled&&(t.read.enabled=!0)}function De(t){"boolean"==typeof t.write?t.write={enabled:t.write}:"function"==typeof t.write?t.write={enabled:!0,writer:t.write}:t.write&&"object"==typeof t.write&&void 0===t.write.enabled&&(t.write.enabled=!0)}class Ve extends ke{constructor(t,e,i){if(super(t,e,i),!(this instanceof Ve))return new Ve(t,e,i)}toJSON(){if(null!=this.details)try{return{name:this.name,message:this.message,details:JSON.parse(JSON.stringify(this.details,((t,e)=>{if(e&&"object"==typeof e&&"function"==typeof e.toJSON)return e;try{return H(e)}catch(t){return"[object]"}})))}}catch(t){throw ct.getLogger("esri.core.Error").error(t),t}return{name:this.name,message:this.message,details:this.details}}static fromJSON(t){return new Ve(t.name,t.message,t.details)}}Ve.prototype.type="error";const $e=ct.getLogger("esri.core.accessorSupport.extensions.serializableProperty.writer");function ze(t,e){var i;if(!e.write||e.write.writer||!1===e.write.enabled&&!e.write.overridePolicy)return;const s=null!=(i=null==t?void 0:t.ndimArray)?i:0;e.write.writer=t&&(1===s||"type"in t&&je(t.type))?We:s>1?function(t){return function(e,i,s,n){let r;if(null===e)r=null;else{r=He(e,n,t);let i=t,s=r;for(;i>0&&Array.isArray(s);)i--,s=s[0];if(void 0!==s)for(let t=0;t<i;t++)r=[r]}K(s,r,i)}}(s):e.types?Array.isArray(e.types)?function(t){return(e,i,s,n)=>Ue(e&&Array.isArray(e)?e.filter((e=>Ge(e,t,n))):e,i,s,n)}(e.types[0]):function(t){return(e,i,s,n)=>e?Ge(e,t,n)?Ue(e,i,s,n):void 0:Ue(e,i,s,n)}(e.types):Ue}function Ge(t,e,i){for(const i in e.typeMap)if(t instanceof e.typeMap[i])return!0;if(null!=i&&i.messages){var s,n;const r=null!=(s=e.errorContext)?s:"type",o=`Values of type '${null!=(n="function"!=typeof e.key?t[e.key]:t.declaredClass)?n:"Unknown"}' cannot be written`;i&&i.messages&&t&&i.messages.push(new Ve(r+":unsupported",o,{definition:t,context:i})),$e.error(o)}return!1}function Ue(t,e,i,s){K(i,qe(t,s),e)}function qe(t,e){return t&&"function"==typeof t.write?t.write({},e):t&&"function"==typeof t.toJSON?t.toJSON():"number"==typeof t?Be(t):t}function Be(t){return t===-1/0?-Number.MAX_VALUE:t===1/0?Number.MAX_VALUE:isNaN(t)?null:t}function We(t,e,i,s){let n;null===t?n=null:t&&"function"==typeof t.map?(n=t.map((t=>qe(t,s))),"function"==typeof n.toArray&&(n=n.toArray())):n=[qe(t,s)],K(i,n,e)}function He(t,e,i){return 0!==i&&Array.isArray(t)?t.map((t=>He(t,e,i-1))):qe(t,e)}function Je(t,e){return Qe(t,"read",e)}function Ze(t,e){return Qe(t,"write",e)}function Qe(t,e,i){let s=t&&t.json;if(t&&t.json&&t.json.origins&&i){const n=t.json.origins[i.origin];n&&("any"===e||e in n)&&(s=n)}return s}function Ke(t){return t.type?Ye(t):Xe(t)}function Ye(t){if(!t.type)return;let e=0,i=t.type;for(;Array.isArray(i)&&!Ct(i);)i=i[0],e++;return{type:i,ndimArray:e}}function Xe(t){if(!t.types)return;let e=0,i=t.types;for(;Array.isArray(i);)i=i[0],e++;return{types:i,ndimArray:e}}function ti(t){(function(t){if(t.json||(t.json={}),Ne(t.json),De(t.json),Le(t.json),t.json.origins)for(const e in t.json.origins)Ne(t.json.origins[e]),De(t.json.origins[e]),Le(t.json.origins[e]);return!0})(t)&&(function(t){if(t.json&&t.json.origins){const e=t.json.origins,i={"web-document":["web-scene","web-map"]};for(const t in i)if(e[t]){const s=e[t];i[t].forEach((t=>{e[t]=s})),delete e[t]}}}(t),function(t){const e=function(t){return t.json.types?Xe(t.json):t.type?Ye(t):Xe(t)}(t);if(t.json.origins)for(const i in t.json.origins){const s=t.json.origins[i],n=s.types?Ke(s):e;Te(n,s,!1),s.types&&!s.write&&t.json.write&&t.json.write.enabled&&(s.write={...t.json.write}),ze(n,s)}Te(e,t.json,!0),ze(e,t.json)}(t))}const ei=new Set,ii=new Set;function si(t){return e=>{e.prototype.declaredClass=t,function(t){const e=ee(t.prototype).properties,i={};for(const t of Object.getOwnPropertyNames(e)){const s=e[t];ti(s),i[t]={enumerable:!0,configurable:!0,get:ni(t,s),set(e){const i=this.__accessor__;if(void 0!==i){if(!Object.isFrozen(this)){if(i.initialized&&s.readOnly)throw new TypeError(`[accessor] cannot assign to read-only property '${t}' of ${this.declaredClass}`);if(2===i.lifecycle&&s.constructOnly)throw new TypeError(`[accessor] cannot assign to construct-only property '${t}' of ${this.declaredClass}`);i.set(t,e)}}else Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}}}Object.defineProperties(t.prototype,i)}(e);const i=[],s=[];let n=e.prototype;for(;n;)n.hasOwnProperty("initialize")&&!ei.has(n.initialize)&&(ei.add(n.initialize),i.push(n.initialize)),n.hasOwnProperty("destroy")&&!ii.has(n.destroy)&&(ii.add(n.destroy),s.push(n.destroy)),n=Object.getPrototypeOf(n);ei.clear(),ii.clear();class r extends e{constructor(...t){if(super(...t),this.constructor===r&&"function"==typeof this.postscript){if(i.length&&Object.defineProperty(this,"initialize",{enumerable:!1,configurable:!0,value(){for(let t=i.length-1;t>=0;t--)i[t].call(this)}}),s.length){let t=!1;Object.defineProperty(this,"destroy",{enumerable:!1,configurable:!0,value(){if(!t){t=!0;for(let t=0;t<s.length;t++)s[t].call(this)}}})}this.postscript(...t)}}}return r.__accessorMetadata__=ee(e.prototype),r.prototype.declaredClass=t,r}}function ni(t,e){return null==e.get?function(){const e=this.__accessor__.properties.get(t);if(void 0===e)return;pe(e);const i=this.__accessor__.store;return i.has(t)?i.get(t):e.metadata.value}:function(){const e=this.__accessor__.properties.get(t);if(void 0!==e)return e.getComputed()}}class ri{constructor(t,e={ignoreUnknown:!1}){this.jsonToAPI=t,this.options=e,this.apiValues=[],this.jsonValues=[],this.apiToJSON=this.invertMap(t),this.apiValues=this.getKeysSorted(this.apiToJSON),this.jsonValues=this.getKeysSorted(this.jsonToAPI),this.read=t=>this.fromJSON(t),this.write=(t,e,i)=>{const s=this.toJSON(t);void 0!==s&&K(i,s,e)},this.write.isJSONMapWriter=!0}toJSON(t){return this.apiToJSON.hasOwnProperty(t)?this.apiToJSON[t]:this.options.ignoreUnknown?void 0:t}fromJSON(t){return this.jsonToAPI.hasOwnProperty(t)?this.jsonToAPI[t]:this.options.ignoreUnknown?void 0:t}invertMap(t){const e={};for(const i in t)e[t[i]]=i;return e}getKeysSorted(t){const e=[];for(const i in t)e.push(i);return e.sort(),e}}function oi(){return function(t){return new ri(t,{ignoreUnknown:!0})}}var ai,li,ui;let ci;const hi=null!=(ai=null==(li=i.esriConfig)?void 0:li.locale)?ai:null==(ui=i.dojoConfig)?void 0:ui.locale;function di(){var t,e;return null!=(t=null!=hi?hi:null==(e=i.navigator)?void 0:e.language)?t:"en"}function pi(){return void 0===ci&&(ci=di()),ci}const fi=[];function yi(t){return fi.push(t),{remove(){fi.splice(fi.indexOf(t),1)}}}const mi=[];function gi(t){return mi.push(t),{remove(){fi.splice(mi.indexOf(t),1)}}}null==i.addEventListener||i.addEventListener("languagechange",(function(){const t=di();ci!==t&&(ci=t,[...mi].forEach((e=>{e.call(null,t)})),[...fi].forEach((e=>{e.call(null,t)})))}));const vi={year:"numeric",month:"numeric",day:"numeric"},wi={year:"numeric",month:"long",day:"numeric"},bi={year:"numeric",month:"short",day:"numeric"},Mi={year:"numeric",month:"long",weekday:"long",day:"numeric"},Si={hour:"numeric",minute:"numeric"},xi={...Si,second:"numeric"},ki={"short-date":vi,"short-date-short-time":{...vi,...Si},"short-date-short-time-24":{...vi,...Si,hour12:!1},"short-date-long-time":{...vi,...xi},"short-date-long-time-24":{...vi,...xi,hour12:!1},"short-date-le":vi,"short-date-le-short-time":{...vi,...Si},"short-date-le-short-time-24":{...vi,...Si,hour12:!1},"short-date-le-long-time":{...vi,...xi},"short-date-le-long-time-24":{...vi,...xi,hour12:!1},"long-month-day-year":wi,"long-month-day-year-short-time":{...wi,...Si},"long-month-day-year-short-time-24":{...wi,...Si,hour12:!1},"long-month-day-year-long-time":{...wi,...xi},"long-month-day-year-long-time-24":{...wi,...xi,hour12:!1},"day-short-month-year":bi,"day-short-month-year-short-time":{...bi,...Si},"day-short-month-year-short-time-24":{...bi,...Si,hour12:!1},"day-short-month-year-long-time":{...bi,...xi},"day-short-month-year-long-time-24":{...bi,...xi,hour12:!1},"long-date":Mi,"long-date-short-time":{...Mi,...Si},"long-date-short-time-24":{...Mi,...Si,hour12:!1},"long-date-long-time":{...Mi,...xi},"long-date-long-time-24":{...Mi,...xi,hour12:!1},"long-month-year":{month:"long",year:"numeric"},"short-month-year":{month:"short",year:"numeric"},year:{year:"numeric"},"short-time":Si,"long-time":xi},Ii=oi()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});Ii.toJSON.bind(Ii),Ii.fromJSON.bind(Ii);const ji={ar:"ar-u-nu-latn-ca-gregory"};let _i=new WeakMap,Ti=ki["short-date-short-time"];function Oi(t){return ki[t]||null}function Ai(t,e){return function(t){const e=t||Ti;if(!_i.has(e)){const t=pi(),i=ji[pi()]||t;_i.set(e,new Intl.DateTimeFormat(i,e))}return _i.get(e)}(e).format(t)}gi((()=>{_i=new WeakMap,Ti=ki["short-date-short-time"]}));const Fi={ar:"ar-u-nu-latn"};let Ci=new WeakMap,Pi={};function Ei(t={}){const e={};return null!=t.digitSeparator&&(e.useGrouping=t.digitSeparator),null!=t.places&&(e.minimumFractionDigits=e.maximumFractionDigits=t.places),e}function Ri(t,e){return function(t){const e=t||Pi;if(!Ci.has(e)){const i=pi(),s=Fi[pi()]||i;Ci.set(e,new Intl.NumberFormat(s,t))}return Ci.get(e)}(e).format(t)}gi((()=>{Ci=new WeakMap,Pi={}}));const Li=ct.getLogger("esri.intl");function Ni(t,e,i={}){const{format:s={}}=i;return rt(t,(t=>function(t,e,i){let s,n;const r=t.indexOf(":");if(-1===r?s=t.trim():(s=t.slice(0,r).trim(),n=t.slice(r+1).trim()),!s)return"";const o=Q(s,e);if(null==o)return"";const a=i[n]||i[s];return a?function(t,e){switch(e.type){case"date":return Ai(t,e.intlOptions);case"number":return Ri(t,e.intlOptions);default:return Li.warn("missing format descriptor for key {key}"),Di(t)}}(o,a):n?function(t,e){switch(e.toLowerCase()){case"dateformat":return Ai(t);case"numberformat":return Ri(t);default:return Li.warn("inline format is unsupported since 4.12: "+e),/^(dateformat|datestring)/i.test(e)?Ai(t):/^numberformat/i.test(e)?Ri(t):Di(t)}}(o,n):Di(o)}(t,e,s)))}function Di(t){switch(typeof t){case"string":return t;case"number":return Ri(t);case"boolean":return""+t;default:return t instanceof Date?Ai(t):""}}const Vi=function(t){return{setTimeout:(e,i)=>{const s=t.setTimeout(e,i);return{remove:()=>t.clearTimeout(s)}}}}(i);function $i(t){return t&&("function"==typeof t.on||"function"==typeof t.addEventListener)}function zi(t,e,i){if(!$i(t))throw new TypeError("target is not a Evented or EventTarget object");if("on"in t)return t.on(e,i);if(Array.isArray(e)){const s=e.slice();for(const e of s)t.addEventListener(e,i);return{remove(){for(const e of s)t.removeEventListener(e,i)}}}return t.addEventListener(e,i),{remove(){t.removeEventListener(e,i)}}}function Gi(t,e,i){if(!$i(t))throw new TypeError("target is not a Evented or EventTarget object");if("once"in t)return t.once(e,i);const s=zi(t,e,(e=>{s.remove(),i.call(t,e)}));return{remove(){s.remove()}}}const Ui={Win:"Meta",Scroll:"ScrollLock",Spacebar:" ",Down:"ArrowDown",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Del:"Delete",Apps:"ContextMenu",Esc:"Escape",Multiply:"*",Add:"+",Subtract:"-",Decimal:".",Divide:"/"};function qi({key:t}){return Ui[t]||t}function Bi(t){return Promise.all(t)}function Wi(t){return new Promise(((e,i)=>{try{t(e,i)}catch(t){Promise.resolve().then((()=>i(t)))}}))}function Hi(t="Aborted"){return new Ve("AbortError",t)}function Ji(t,e="Aborted"){if(Qi(t))throw Hi(e)}function Zi(t){return u(t)?"aborted"in t?t:t.signal:t}function Qi(t){const e=Zi(t);return u(e)&&e.aborted}function Ki(t){if(is(t))throw t}function Yi(t){if(!is(t))throw t}function Xi(t,e){const i=Zi(t);if(!c(i)){if(!i.aborted)return Gi(i,"abort",(()=>e()));e()}}function ts(t,e){const i=Zi(t);if(!c(i))return Ji(i),Gi(i,"abort",(()=>e(Hi())))}function es(t,e){return c(Zi(e))?t:new Promise(((i,s)=>{let n=Xi(e,(()=>s(Hi())));const r=()=>n=v(n);t.then(r,r),t.then(i,s)}))}function is(t){return t&&"AbortError"===t.name}function ss(t){return t.catch((t=>{if(!is(t))throw t}))}function ns(){let t=null;const e=new Promise(((e,i)=>{t={promise:void 0,resolve:e,reject:i}}));return t.promise=e,t}function rs(t){if(!t)return;if("function"!=typeof t.forEach){const e=Object.keys(t);return rs(e.map((e=>t[e]))).then((t=>{const i={};return e.forEach(((e,s)=>i[e]=t[s])),i}))}const e=t;return Wi((t=>{const i=[];let s=e.length;0===s&&t(i),e.forEach((e=>{const n={promise:e||Promise.resolve(e)};i.push(n),n.promise.then((t=>{n.value=t})).catch((t=>{n.error=t})).then((()=>{--s,0===s&&t(i)}))}))}))}function os(t){return rs(t).then((t=>t.filter((t=>!!t.value)).map((t=>t.value))))}function as(t){return Promise.reject(t)}function ls(t){return Promise.resolve(t)}function us(t,e,i){const s=new AbortController;return Xi(i,(()=>s.abort())),new Promise(((i,n)=>{let r=setTimeout((()=>{r=0,i(e)}),t);Xi(s,(()=>{r&&(clearTimeout(r),n(Hi()))}))}))}function cs(t){return t&&"function"==typeof t.then}function hs(t){return ds(t)?t:Promise.resolve(t)}function ds(t){return t&&"object"==typeof t&&"then"in t&&"function"==typeof t.then}function ps(t,e=-1){let i,s,n,r,o=null;const a=(...l)=>{if(i){s=l,r&&r.reject(Hi()),r=ns();const t=r.promise;if(o){const t=o;o=null,t.abort()}return t}if(n=r||ns(),r=null,e>0){const s=new AbortController;i=hs(t(...l,s.signal));const n=i;us(e).then((()=>{i===n&&(r?s.abort():o=s)}))}else i=1,i=hs(t(...l));const u=()=>{const t=s;s=n=i=o=null,null!=t&&a(...t)},c=i,h=n;return c.then(u,u),c.then(h.resolve,h.reject),h.promise};return a}function fs(){let t,e;const i=new Promise(((i,s)=>{t=i,e=s})),s=e=>{t(e)};return s.resolve=e=>t(e),s.reject=t=>e(t),s.timeout=(t,e)=>Vi.setTimeout((()=>s.reject(e)),t),s.promise=i,s}function ys(t){let e=new AbortController;const i=t(e.signal);let s={promise:i,finished:!1,abort:()=>{e&&(e.abort(),e=null)}};const n=()=>{s&&(s.finished=!0,s=null),e=null};return i.then(n,n),s}const ms=/^([a-z]{2})(?:[-_]([A-Za-z]{2}))?$/,gs={ar:!0,bg:!0,bs:!0,ca:!0,cs:!0,da:!0,de:!0,el:!0,en:!0,es:!0,et:!0,fi:!0,fr:!0,he:!0,hr:!0,hu:!0,id:!0,it:!0,ja:!0,ko:!0,lt:!0,lv:!0,nb:!0,nl:!0,pl:!0,"pt-BR":!0,"pt-PT":!0,ro:!0,ru:!0,sk:!0,sl:!0,sr:!0,sv:!0,th:!0,tr:!0,uk:!0,vi:!0,"zh-CN":!0,"zh-HK":!0,"zh-TW":!0};function vs(t){var e;return null!=(e=gs[t])&&e}const ws=[],bs=new Map;async function Ms(t){const e=pi();bs.has(t)||bs.set(t,async function(t,e){const i=[];for(const s of ws)if(Ss(s.pattern,t))try{return await s.fetchMessageBundle(t,e)}catch(t){i.push(t)}if(i.length)throw new Ve("intl:message-bundle-error",`Errors occurred while loading "${t}"`,{errors:i});throw new Ve("intl:no-message-bundle-loader",`No loader found for message bundle "${t}"`)}(t,e));const i=bs.get(t);return await xs.add(i),i}function Ss(t,e){return"string"==typeof t?e.startsWith(t):t.test(e)}gi((()=>{bs.clear()}));const xs=new class{constructor(){this._numLoading=0}async waitForAll(){this._dfd&&await this._dfd.promise}add(t){return this._increase(),t.then((()=>this._decrease()),(()=>this._decrease())),this.waitForAll()}_increase(){this._numLoading++,this._dfd||(this._dfd=ns())}_decrease(){this._numLoading=Math.max(this._numLoading-1,0),this._dfd&&0===this._numLoading&&(this._dfd.resolve(),this._dfd=null)}},ks=ct.getLogger("esri.core.urlUtils"),Is=it.request,js="esri/config: esriConfig.request.proxyUrl is not set.",_s=/^\s*[a-z][a-z0-9-+.]*:(?![0-9])/i,Ts=/^\s*http:/i,Os=/^\s*https:/i,As=/^\s*file:/i,Fs=/:\d+$/,Cs=/^https?:\/\/[^/]+\.arcgis.com\/sharing(\/|$)/i,Ps=/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/,Es=/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/;class Rs{constructor(t=""){this.uri=t,this.scheme=null,this.authority=null,this.path=null,this.query=null,this.fragment=null,this.user=null,this.password=null,this.host=null,this.port=null;let e=this.uri.match(Ps);this.scheme=e[2]||(e[1]?"":null),this.authority=e[4]||(e[3]?"":null),this.path=e[5],this.query=e[7]||(e[6]?"":null),this.fragment=e[9]||(e[8]?"":null),null!=this.authority&&(e=this.authority.match(Es),this.user=e[3]||null,this.password=e[4]||null,this.host=e[6]||e[7],this.port=e[9]||null)}toString(){return this.uri}}const Ls=new Rs(it.applicationUrl),Ns={},Ds=(()=>{const t=Ls.path,e=t.substring(0,t.lastIndexOf(t.split("/")[t.split("/").length-1]));return`${Ls.scheme}://${Ls.host}${null!=Ls.port?":"+Ls.port:""}${e}`})();function Vs(t){const e={path:null,query:null},i=new Rs(t),s=t.indexOf("?");return null===i.query?e.path=t:(e.path=t.substring(0,s),e.query=$s(i.query)),i.fragment&&(e.hash=i.fragment,null===i.query&&(e.path=e.path.substring(0,e.path.length-(i.fragment.length+1)))),e}function $s(t){const e=t.split("&"),i={};for(const t of e){if(!t)continue;const e=t.indexOf("=");let s,n;e<0?(s=decodeURIComponent(t),n=""):(s=decodeURIComponent(t.slice(0,e)),n=decodeURIComponent(t.slice(e+1)));let r=i[s];"string"==typeof r&&(r=i[s]=[r]),Array.isArray(r)?r.push(n):i[s]=n}return i}function zs(t){return t&&"object"==typeof t&&"toJSON"in t&&"function"==typeof t.toJSON}function Gs(t,e){return t?e&&"function"==typeof e?Object.keys(t).map((i=>encodeURIComponent(i)+"="+encodeURIComponent(e(i,t[i])))).join("&"):Object.keys(t).map((i=>{const s=t[i];if(null==s)return"";const n=encodeURIComponent(i)+"=",r=e&&e[i];return r?n+encodeURIComponent(r(s)):Array.isArray(s)?s.map((t=>zs(t)?n+encodeURIComponent(JSON.stringify(t)):n+encodeURIComponent(t))).join("&"):zs(s)?n+encodeURIComponent(JSON.stringify(s)):n+encodeURIComponent(s)})).filter((t=>t)).join("&"):""}function Us(t){const e=Hs(t);let i,s;if(e){const t=Bs(e.proxyUrl);i=t.path,s=t.query?$s(t.query):null}if(i){const e=Vs(t);t=i+"?"+e.path;const n=Gs({...s,...e.query});n&&(t=`${t}?${n}`)}return t}const qs={path:"",query:""};function Bs(t){const e=t.indexOf("?");return-1!==e?(qs.path=t.slice(0,e),qs.query=t.slice(e+1)):(qs.path=t,qs.query=null),qs}function Ws(t){return(t=vn(t=function(t){return t&&"/"===t[t.length-1]?t:t+"/"}(t=Bs(t).path),!0)).toLowerCase()}function Hs(t){const e=Is.proxyRules,i=Ws(t);for(let t=0;t<e.length;t++)if(0===i.indexOf(e[t].urlPrefix))return e[t]}function Js(t,e){return t=Zs(t),e=Zs(e),vn(t)===vn(e)}function Zs(t){const e=(t=sn(t)).indexOf("/sharing");return e>0?t.substring(0,e):t.replace(/\/+$/,"")}function Qs(t){const e=e=>null==e||e instanceof RegExp&&e.test(t)||"string"==typeof e&&t.startsWith(e),i=Is.interceptors;if(i)for(const t of i)if(Array.isArray(t.urls)){if(t.urls.some(e))return t}else if(e(t.urls))return t;return null}function Ks(t,e,i=!1){const s=xn(t),n=xn(e);return!(!i&&s.scheme!==n.scheme)&&null!=s.host&&null!=n.host&&s.host.toLowerCase()===n.host.toLowerCase()&&s.port===n.port}function Ys(t){if("string"==typeof t){if(!on(t))return!0;t=xn(t)}if(Ks(t,Ls))return!0;const e=Is.trustedServers||[];for(let i=0;i<e.length;i++){const s=Xs(e[i]);for(let e=0;e<s.length;e++)if(Ks(t,s[e]))return!0}return!1}function Xs(t){return Ns[t]||(Ns[t]=fn(t)||pn(t)?[new Rs(tn(t))]:[new Rs("http://"+t),new Rs("https://"+t)]),Ns[t]}function tn(t,e=Ds,i){return pn(t)?i&&i.preserveProtocolRelative?t:"http"===Ls.scheme&&Ls.authority===rn(t).slice(2)?"http:"+t:"https:"+t:fn(t)?t:nn("/"===t[0]?function(t){const e=t.indexOf("//"),i=t.indexOf("/",e+2);return-1===i?t:t.slice(0,i)}(e):e,t)}function en(t,e=Ds,i){if(!on(t))return t;const s=sn(t),n=s.toLowerCase(),r=sn(e).toLowerCase().replace(/\/+$/,""),o=i?sn(i).toLowerCase().replace(/\/+$/,""):null;if(o&&0!==r.indexOf(o))return t;const a=(t,e,i)=>-1===(i=t.indexOf(e,i))?t.length:i;let l=a(n,"/",n.indexOf("//")+2),u=-1;for(;n.slice(0,l+1)===r.slice(0,l)+"/"&&(u=l+1,l!==n.length);)l=a(n,"/",l+1);if(-1===u)return t;if(o&&u<o.length)return t;t=s.slice(u);const c=r.slice(u-1).replace(/[^/]+/g,"").length;if(c>0)for(let e=0;e<c;e++)t="../"+t;else t="./"+t;return t}function sn(t){return function(t){const e=Is.httpsDomains;if(!function(t){return Ts.test(t)||"http"===Ls.scheme&&pn(t)}(t))return t;const i=t.indexOf("/",7);let s;if(s=-1===i?t:t.slice(0,i),s=s.toLowerCase().slice(7),Fs.test(s)){if(!s.endsWith(":80"))return t;s=s.slice(0,-3),t=t.replace(":80","")}return"http"===Ls.scheme&&s===Ls.authority&&!Cs.test(t)||(gn()&&s===Ls.authority||e&&e.some((t=>s===t||s.endsWith("."+t)))||gn()&&!Hs(t))&&(t=mn(t)),t}(t=function(t){return t.replace(/^(https?:\/\/)(arcgis\.com)/i,"$1www.$2")}(t=function(t){if(/^https?:\/\//i.test(t)){const e=Bs(t);t=(t=e.path.replace(/\/{2,}/g,"/")).replace("/","//"),e.query&&(t+="?"+e.query)}return t}(t=tn(t=t.trim()))))}function nn(...t){const e=t.filter(u);if(!e||!e.length)return;const i=[];if(on(e[0])){const t=e[0],s=t.indexOf("//");-1!==s&&(i.push(t.slice(0,s+1)),function(t){return As.test(t)}(e[0])&&(i[0]+="/"),e[0]=t.slice(s+2))}else"/"===e[0][0]&&i.push("");const s=e.reduce(((t,e)=>e?t.concat(e.split("/")):t),[]);for(let t=0;t<s.length;t++){const e=s[t];".."===e&&i.length>0&&".."!==i[i.length-1]?i.pop():(!e&&t===s.length-1||e&&("."!==e||0===i.length))&&i.push(e)}return i.join("/")}function rn(t,e=!1){if(an(t)||ln(t))return null;let i=t.indexOf("://");if(-1===i&&pn(t))i=2;else{if(-1===i)return null;i+=3}const s=t.indexOf("/",i);return-1!==s&&(t=t.slice(0,s)),e&&(t=vn(t,!0)),t}function on(t){return pn(t)||fn(t)}function an(t){return null!=t&&"blob:"===t.slice(0,5)}function ln(t){return"data:"===t.slice(0,5)}function un(t){const e=hn(t);if(!e||!e.isBase64)return null;const i=atob(e.data),s=new Uint8Array(i.length);for(let t=0;t<i.length;t++)s[t]=i.charCodeAt(t);return s.buffer}const cn=/^data:(.*?)(;base64)?,(.*)$/;function hn(t){const e=t.match(cn);if(!e)return null;const[,i,s,n]=e;return{mediaType:i,isBase64:!!s,data:n}}function dn(t){return t.isBase64?`data:${t.mediaType};base64,${t.data}`:`data:${t.mediaType},${t.data}`}function pn(t){return null!=t&&void 0!==t&&"/"===t[0]&&"/"===t[1]}function fn(t){return _s.test(t)}function yn(t){return Os.test(t)||"https"===Ls.scheme&&pn(t)}function mn(t){return pn(t)?"https:"+t:t.replace(Ts,"https:")}function gn(){return"https"===Ls.scheme}function vn(t,e=!1){return pn(t)?t.slice(2):(t=t.replace(_s,""),e&&t.length>1&&"/"===t[0]&&"/"===t[1]&&(t=t.slice(2)),t)}function wn(t){let e=0;if(on(t)){const i=t.indexOf("//");-1!==i&&(e=i+2)}const i=t.lastIndexOf("/");return i<e?t:t.slice(0,i+1)}function bn(t,e){if(!t)return"";const i=Vs(t).path.replace(/\/+$/,""),s=i.substring(i.lastIndexOf("/")+1);if(null==e||!e.length)return s;const n=RegExp(`.(${e.join("|")})$`,"ig");return s.replace(n,"")}function Mn(t){return t.replace(/\/+$/,"")}function Sn(t,e,i){if(!(e&&i&&t&&on(t)))return t;const s=t.indexOf("//"),n=t.indexOf("/",s+2),r=t.indexOf(":",s+2),o=Math.min(n<0?t.length:n,r<0?t.length:r);return t.slice(s+2,o).toLowerCase()!==e.toLowerCase()?t:`${t.slice(0,s+2)}${i}${t.slice(o)}`}function xn(t){return"string"==typeof t?new Rs(tn(t)):(t.scheme||(t.scheme=Ls.scheme),t)}function kn(t){return An.test(t)}function In(t,e){const i=Vs(t),s=Object.keys(i.query||{});return s.length>0&&e&&e.warn("removeQueryParameters()",`Url query parameters are not supported, the following parameters have been removed: ${s.join(", ")}.`),i.path}function jn(t,e,i){const s=Vs(t),n=s.query||{};return n[e]=i+"",`${s.path}?${Gs(n)}`}function _n(t,e){const i=Vs(t),s=i.query||{};for(const t in e)s[t]=e[t];const n=Gs(s);return n?`${i.path}?${n}`:i.path}function Tn(t){if(c(t))return null;const e=t.match(On);return e?e[1]:null}const On=/.*?\.([^\/]*)$/,An=/(^data:image\/svg|\.svg$)/i,Fn="4.22",Cn={async request(t,e){var i;const{default:s}=await Promise.resolve().then((function(){return sr})),n=t.options,r=n.responseType;n.signal=null==e?void 0:e.signal,n.responseType="native"===r||"native-request-init"===r?"native-request-init":["blob","json","text"].includes(r)&&null!=(i=Qs(t.url))&&i.after?r:"array-buffer";const o=await s(t.url,n),a={data:o.data,ssl:o.ssl};switch(o.requestOptions.responseType){case"native-request-init":return delete a.data.signal,a;case"blob":a.data=await a.data.arrayBuffer();break;case"json":a.data=(new TextEncoder).encode(JSON.stringify(a.data)).buffer;break;case"text":a.data=(new TextEncoder).encode(a.data).buffer}return{result:a,transferList:[a.data]}}};let Pn;function En(t){Pn=t}function Rn(t){const e=Pn&&Pn.findCredential(t);return e&&e.token?jn(t,"token",e.token):t}l("host-webworker")||(l("edge")||l("trident"))&&console.warn("Deprecated browser - see http://esriurl.com/oldbrowser");const Ln=["elevation3d.arcgis.com","js.arcgis.com","jsdev.arcgis.com","jsqa.arcgis.com","static.arcgis.com"];function Nn(t){const e=rn(t,!0);return e&&e.endsWith(".arcgis.com")&&!Ln.includes(e)&&!t.endsWith("/sharing/rest/generateToken")}function Dn(t,e,i=!1,s){return new Promise(((n,r)=>{if(Qi(s))return void r(Vn());let o=()=>{h(),r(Error("Unable to load "+e))},a=()=>{const e=t;h(),n(e)},c=()=>{if(!t)return;const e=t;h(),e.src="",r(Vn())};const h=()=>{l("esri-image-decode")||(t.removeEventListener("error",o),t.removeEventListener("load",a)),o=null,a=null,t=null,u(s)&&s.removeEventListener("abort",c),c=null,i&&URL.revokeObjectURL(e)};u(s)&&s.addEventListener("abort",c),l("esri-image-decode")?t.decode().then(a,o):(t.addEventListener("error",o),t.addEventListener("load",a))}))}function Vn(){try{return new DOMException("Aborted","AbortError")}catch{const t=Error();return t.name="AbortError",t}}async function $n(t,e){var s;const n=ln(t),r=an(t);r||n||(t=sn(t));const o={url:t,requestOptions:{...e}};let a=Qs(t);if(a){const t=await async function(t,e){if(null!=t.responseData)return t.responseData;if(t.headers&&(e.requestOptions.headers={...e.requestOptions.headers,...t.headers}),t.query&&(e.requestOptions.query={...e.requestOptions.query,...t.query}),t.before){let i,s;try{s=await t.before(e)}catch(t){i=Qn("request:interceptor",t,e)}if((s instanceof Error||s instanceof Ve)&&(i=Qn("request:interceptor",s,e)),i)throw t.error&&t.error(i),i;return s}}(a,o);if(null!=t)return{data:t,getHeader:Hn,requestOptions:o.requestOptions,url:o.url};a.after||a.error||(a=null)}if(t=o.url,"image"===(e=o.requestOptions).responseType){if(l("host-webworker")||l("host-node"))throw Qn("request:invalid-parameters",Error("responseType 'image' is not supported in Web Workers or Node environment"),o)}else if(n)throw Qn("request:invalid-parameters",Error("Data URLs are not supported for responseType = "+e.responseType),o);if("head"===e.method){if(e.body)throw Qn("request:invalid-parameters",Error("body parameter cannot be set when method is 'head'"),o);if(n||r)throw Qn("request:invalid-parameters",Error("data and blob URLs are not supported for method 'head'"),o)}if(await async function(){l("host-webworker")?zn||(zn=await import("./p-a78650cc.js")):$n._abortableFetch||($n._abortableFetch=i.fetch.bind(i))}(),zn)return zn.execute(t,e);const u=new AbortController;Xi(e,(()=>u.abort()));const c={controller:u,credential:null,credentialToken:null,fetchOptions:null,hasToken:!1,interceptor:a,params:o,redoRequest:!1,useIdentity:Gn.useIdentity,useProxy:!1,useSSL:!1,withCredentials:!1},h=await async function(t){var e,s;let n,r;await async function(t){const e=t.params.url,s=t.params.requestOptions,n=t.controller.signal,r=s.body;let o=null,a=null,l=null;if(Un&&"HTMLFormElement"in i&&(r instanceof FormData?o=r:r instanceof HTMLFormElement&&(a=r,o=new FormData(a))),"string"==typeof r&&(l=r),t.fetchOptions={cache:s.cacheBust&&!$n._abortableFetch.polyfill?"no-cache":"default",credentials:"same-origin",headers:s.headers||{},method:"head"===s.method?"HEAD":"GET",mode:"cors",redirect:"follow",signal:n},(o||l)&&(t.fetchOptions.body=o||l),"anonymous"===s.authMode&&(t.useIdentity=!1),t.hasToken=!!(/token=/i.test(e)||s.query&&s.query.token||o&&o.get&&o.get("token")||a&&a.elements.token),!t.hasToken&&it.apiKey&&Nn(e)&&(s.query||(s.query={}),s.query.token=it.apiKey,t.hasToken=!0),t.useIdentity&&!t.hasToken&&!t.credentialToken&&!Yn(e)&&!Qi(n)){let i;"immediate"===s.authMode?(await Kn(),i=await Pn.getCredential(e,{signal:n}),t.credential=i):"no-prompt"===s.authMode?(await Kn(),i=await Pn.getCredential(e,{prompt:!1,signal:n}).catch((()=>{})),t.credential=i):Pn&&(i=Pn.findCredential(e)),i&&(t.credentialToken=i.token,t.useSSL=!!i.ssl)}}(t);try{do{[n,r]=await Xn(t)}while(!await er(t,n,r))}catch(e){const i=Qn("request:server",e,t.params,n);throw i.details.ssl=t.useSSL,t.interceptor&&t.interceptor.error&&t.interceptor.error(i),i}const o=t.params.url;if(/\/sharing\/rest\/(accounts|portals)\/self/i.test(o)&&!t.hasToken&&!t.credentialToken&&null!=(e=r)&&null!=(s=e.user)&&s.username&&!Ys(o)){const t=rn(o,!0);t&&Gn.trustedServers.push(t)}const a=t.credential;if(a&&Pn){const t=Pn.findServerInfo(a.server);let e=t&&t.owningSystemUrl;if(e){e=e.replace(/\/?$/,"/sharing");const t=Pn.findCredential(e,a.userId);t&&-1===Pn._getIdenticalSvcIdx(e,t)&&t.resources.unshift(e)}}return{data:r,getHeader:n?t=>n.headers.get(t):Hn,requestOptions:t.params.requestOptions,ssl:t.useSSL,url:t.params.url}}(c);return null==(s=a)||null==s.after||s.after(h),h}let zn;const Gn=it.request,Un="FormData"in i,qn=[499,498,403,401],Bn=["COM_0056","COM_0057","SB_0008"],Wn=[/\/arcgis\/tokens/i,/\/sharing(\/rest)?\/generatetoken/i,/\/rest\/info/i],Hn=()=>null,Jn=Symbol();function Zn(t){const e=rn(t);return!e||e.endsWith(".arcgis.com")||$n._corsServers.includes(e)||Ys(e)}function Qn(t,e,i,s){let n="Error";const r={url:i.url,requestOptions:i.requestOptions,getHeader:Hn,ssl:!1};if(e instanceof Ve)return e.details?(e.details=H(e.details),e.details.url=i.url,e.details.requestOptions=i.requestOptions):e.details=r,e;if(e){const t=s&&(t=>s.headers.get(t)),i=s&&s.status,o=e.message;o&&(n=o),t&&(r.getHeader=t),r.httpStatus=(null!=e.httpCode?e.httpCode:e.code)||i||0,r.subCode=e.subcode,r.messageCode=e.messageCode,r.messages="string"==typeof e.details?[e.details]:e.details,r.raw=Jn in e?e[Jn]:e}return is(e)?Hi():new Ve(t,n,r)}async function Kn(){Pn||await import("./p-58650cdd.js")}function Yn(t){return Wn.some((e=>e.test(t)))}async function Xn(t){let e=t.params.url;const i=t.params.requestOptions,s=t.fetchOptions,n=an(e)||ln(e),r=i.responseType||"json",o=n?0:null!=i.timeout?i.timeout:Gn.timeout;let a=!1;if(!n){t.useSSL&&(e=mn(e)),i.cacheBust&&"default"===s.cache&&(e=jn(e,"request.preventCache",Date.now()));let n={...i.query};t.credentialToken&&(n.token=t.credentialToken);let r=Gs(n);l("esri-url-encodes-apostrophe")&&(r=r.replace(/'/g,"%27"));const o=e.length+1+r.length;let u;a="delete"===i.method||"post"===i.method||"put"===i.method||!!i.body||o>Gn.maxUrlLength;const c=i.useProxy||!!Hs(e);if(c){const t=function(t=!1){let e,i=Is.proxyUrl;if("string"==typeof t){e=yn(t);const s=Hs(t);s&&(i=s.proxyUrl)}else e=!!t;if(!i)throw ks.warn(js),new Ve("urlutils:proxy-not-set",js);return e&&gn()&&(i=mn(i)),Vs(i)}(e);u=t.path,!a&&u.length+1+o>Gn.maxUrlLength&&(a=!0),t.query&&(n={...t.query,...n})}if("HEAD"===s.method&&(a||c)){if(a){if(o>Gn.maxUrlLength)throw Qn("request:invalid-parameters",Error("URL exceeds maximum length"),t.params);throw Qn("request:invalid-parameters",Error("cannot use POST request when method is 'head'"),t.params)}if(c)throw Qn("request:invalid-parameters",Error("cannot use proxy when method is 'head'"),t.params)}if(a?(s.method="delete"===i.method?"DELETE":"put"===i.method?"PUT":"POST",i.body?e=_n(e,n):(s.body=Gs(n),s.headers["Content-Type"]="application/x-www-form-urlencoded")):e=_n(e,n),c&&(t.useProxy=!0,e=`${u}?${e}`),n.token&&Un&&s.body instanceof FormData){const t=s.body;t.set?t.set("token",n.token):t.append("token",n.token)}if(i.hasOwnProperty("withCredentials"))t.withCredentials=i.withCredentials;else if(!Ks(e,Ls))if(Ys(e))t.withCredentials=!0;else if(Pn){const i=Pn.findServerInfo(e);i&&i.webTierAuth&&(t.withCredentials=!0)}t.withCredentials&&(s.credentials="include")}let u,c,h=0,d=!1;o>0&&(h=setTimeout((()=>{d=!0,t.controller.abort()}),o));try{if("native-request-init"===i.responseType)c=s,c.url=e;else if("image"!==i.responseType||"default"!==s.cache||"GET"!==s.method||a||function(t){if(t)for(const e of Object.getOwnPropertyNames(t))if(t[e])return!0;return!1}(i.headers)||!n&&!t.useProxy&&Gn.proxyUrl&&!Zn(e)){if(u=await $n._abortableFetch(e,s),t.useProxy||function(t){const e=rn(t);e&&!$n._corsServers.includes(e)&&$n._corsServers.push(e)}(e),"native"===i.responseType)c=u;else if("HEAD"!==s.method)if(u.ok){switch(r){case"array-buffer":c=await u.arrayBuffer();break;case"blob":case"image":c=await u.blob();break;default:c=await u.text()}if(h&&(clearTimeout(h),h=0),"json"===r||"xml"===r||"document"===r)if(c)switch(r){case"json":c=JSON.parse(c);break;case"xml":c=tr(c,"application/xml");break;case"document":c=tr(c,"text/html")}else c=null;if(c){if("array-buffer"===r||"blob"===r){const t=u.headers.get("Content-Type");if(/application\/json|text\/plain/i.test(t)&&c["blob"===r?"size":"byteLength"]<=750)try{const t=await new Response(c).json();t.error&&(c=t)}catch{}}"image"===r&&c instanceof Blob&&(c=await ir(URL.createObjectURL(c),t,!0))}}else c=await u.text()}else c=await ir(e,t)}catch(s){if("AbortError"===s.name){if(d)throw Error("Timeout exceeded");throw Hi("Request canceled")}if(!(!u&&s instanceof TypeError&&Gn.proxyUrl)||i.body||"delete"===i.method||"head"===i.method||"post"===i.method||"put"===i.method||t.useProxy||Zn(e))throw s;t.redoRequest=!0,function(t){const e={proxyUrl:t.proxyUrl,urlPrefix:Ws(t.urlPrefix)},i=Is.proxyRules,s=e.urlPrefix;let n=i.length;for(let t=0;t<i.length;t++){const e=i[t].urlPrefix;if(0===s.indexOf(e)){if(s.length===e.length)return-1;n=t;break}0===e.indexOf(s)&&(n=t+1)}i.splice(n,0,e)}({proxyUrl:Gn.proxyUrl,urlPrefix:rn(e)})}finally{h&&clearTimeout(h)}return[u,c]}function tr(t,e){let i;try{i=(new DOMParser).parseFromString(t,e)}catch{}if(!i||i.getElementsByTagName("parsererror").length)throw new SyntaxError("XML Parse error");return i}async function er(t,e,i){if(t.redoRequest)return t.redoRequest=!1,!1;const s=t.params.requestOptions;if(!e||"native"===s.responseType||"native-request-init"===s.responseType)return!0;let n,r,o,a;if(!e.ok)throw n=Error(`Unable to load ${e.url} status: ${e.status}`),n[Jn]=i,n;null!=i&&i.error&&(n=i.error),n&&(r=Number(n.code),o=n.hasOwnProperty("subcode")?Number(n.subcode):null,a=n.messageCode,a=a&&a.toUpperCase());const l=s.authMode;if(403===r&&(4===o||n.message&&n.message.toLowerCase().indexOf("ssl")>-1&&-1===n.message.toLowerCase().indexOf("permission"))){if(!t.useSSL)return t.useSSL=!0,!1}else if(!t.hasToken&&t.useIdentity&&("no-prompt"!==l||498===r)&&-1!==qn.indexOf(r)&&!Yn(t.params.url)&&(403!==r||-1===Bn.indexOf(a)&&(null==o||2===o&&t.credentialToken))){await Kn();try{const e=await Pn.getCredential(t.params.url,{error:Qn("request:server",n,t.params),prompt:"no-prompt"!==l,signal:t.controller.signal,token:t.credentialToken});return t.credential=e,t.credentialToken=e.token,t.useSSL=t.useSSL||e.ssl,!1}catch(e){if("no-prompt"===l)return t.credential=null,t.credentialToken=null,!1;n=e}}if(n)throw n;return!0}function ir(t,e,i=!1){const s=e.controller.signal,n=new Image;return n.crossOrigin=e.withCredentials?"use-credentials":"anonymous",n.alt="",n.src=t,Dn(n,t,i,s)}$n._abortableFetch=null,$n._corsServers=["https://server.arcgisonline.com","https://services.arcgisonline.com"];const sr=Object.freeze({__proto__:null,default:$n});async function nr(t){if(u(or.fetchBundleAsset))return or.fetchBundleAsset(t);const e=await $n(t,{responseType:"text"});return JSON.parse(e.data)}class rr{constructor({base:t="",pattern:e,location:s=new URL(window.location.href)}){let n;n="string"==typeof s?t=>new URL(t,new URL(s,i.location)).href:s instanceof URL?t=>new URL(t,s).href:s,this.pattern="string"==typeof e?RegExp("^"+e):e,this.getAssetUrl=n,t=t?t.endsWith("/")?t:t+"/":"",this.matcher=RegExp(`^${t}(?:(.*)/)?(.*)$`)}fetchMessageBundle(t,e){return async function(t,e,i,s){const n=e.exec(i);if(!n)throw new Ve("esri-intl:invalid-bundle",`Bundle id "${i}" is not compatible with the pattern "${e}"`);const r=n[1]?n[1]+"/":"",o=n[2],a=function(t){if(!ms.test(t))return null;const[,e,i]=ms.exec(t),s=e+(i?"-"+i.toUpperCase():"");return vs(s)?s:vs(e)?e:null}(s),l=`${r}${o}.json`,u=a?`${r}${o}_${a}.json`:l;let c;try{c=await nr(t(u))}catch(e){if(u===l)throw new Ve("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:e});try{c=await nr(t(l))}catch(t){throw new Ve("intl:unknown-bundle",`Bundle "${i}" cannot be loaded`,{error:t})}}return c}(this.getAssetUrl,this.matcher,t,e)}}const or={},ar=ct.getLogger("esri.assets");function lr(t){if(!it.assetsPath)throw ar.errorOnce("The API assets location needs to be set using config.assetsPath. More information: https://arcg.is/1OzLe50"),new Ve("assets:path-not-set","config.assetsPath is not set");return nn(it.assetsPath,t)}!function(t){ws.includes(t)||(function(t){for(const e of bs.keys())Ss(t.pattern,e)&&bs.delete(e)}(t),ws.unshift(t))}(new rr({pattern:"esri/",location:lr}));const ur=new Set;function cr(t,e,i={}){if(l("esri-deprecation-warnings")){const{moduleName:s}=i;dr(t,"Function: "+(s?s+"::":"")+e+"()",i)}}function hr(t,e,i={}){if(l("esri-deprecation-warnings")){const{moduleName:s}=i;dr(t,"Property: "+(s?s+"::":"")+e,i)}}function dr(t,e,i={}){if(l("esri-deprecation-warnings")){const{replacement:s,version:n,see:r,warnOnce:o}=i;let a=e;s&&(a+="\n\t🛠️ Replacement: "+s),n&&(a+="\n\t⚙️ Version: "+n),r&&(a+=`\n\t🔗 See ${r} for more details.`),function(t,e,i=!1){i&&ur.has(e)||(i&&ur.add(e),t.warn("🛑 DEPRECATED - "+e))}(t,a,o)}}function pr(t){return"string"==typeof t?document.getElementById(t):t}function fr(t){for(;t.hasChildNodes();)t.removeChild(t.firstChild)}function yr(t,e){const i=e.parentNode;i&&i.insertBefore(t,e)}function mr(t,e){for(;;){const i=t.firstChild;if(!i)break;e.appendChild(i)}}class gr{constructor(t,e,i,s=1,n=0){if(this.ctor=t,this.acquireFunction=e,this.releaseFunction=i,this.allocationSize=s,this._pool=Array(n),this._initialSize=n,this.ctor)for(let t=0;t<n;t++)this._pool[t]=new this.ctor;this.allocationSize=Math.max(s,1)}destroy(){this.prune(0)}acquire(...t){let e;if(gr.test.disabled)e=new this.ctor;else{if(0===this._pool.length){const t=this.allocationSize;for(let e=0;e<t;e++)this._pool[e]=new this.ctor}e=this._pool.pop()}return this.acquireFunction?this.acquireFunction(e,...t):function(t){return t&&t.acquire&&"function"==typeof t.acquire}(e)&&e.acquire(...t),e}release(t){t&&!gr.test.disabled&&(this.releaseFunction?this.releaseFunction(t):function(t){return t&&t.release&&"function"==typeof t.release}(t)&&t.release(),this._pool.push(t))}prune(t=this._initialSize){if(!(t>=this._pool.length)){for(let e=t;e<this._pool.length;++e)this._dispose(this._pool[e]);this._pool.length=t}}_dispose(t){t.dispose&&"function"==typeof t.dispose&&t.dispose()}}gr.test={disabled:!1};class vr{constructor(t,e){this._observers=t,this._observer=e}remove(){V(this._observers,this._observer)}}class wr{constructor(t,e,i){this.properties=t,this.propertyName=e,this.metadata=i,this._observers=null,this._accessed=null,this._handles=null,this.flags=1|(i.nonNullable?8:0)|(i.hasOwnProperty("value")?16:0)|(void 0===i.get?32:0)|(void 0===i.dependsOn?64:0)}destroy(){this._accessed=null,this._observers=null,this._clearObservationHandles()}getComputed(){pe(this);const t=this.properties.store,e=this.propertyName,i=this.flags,s=t.get(e);if(4&i)return s;if(1&~i&&t.has(e))return s;this.flags|=4;const n=this.properties.host;let r;64&i?r=me(this,this.metadata.get,n):(Se(n,this),r=this.metadata.get.call(n)),t.set(e,r,1);const o=t.get(e);return o===s?this.flags&=-2:this.commit(),this.flags&=-5,o}onObservableAccessed(t){t!==this&&(null===this._accessed&&(this._accessed=[]),this._accessed.includes(t)||this._accessed.push(t))}onTrackingEnd(){this._clearObservationHandles(),this.flags|=32;const t=this._accessed;if(null===t)return;let e=this._handles;null===e&&(e=this._handles=[]);for(let i=0;i<t.length;++i)e.push(t[i].observe(this));t.length=0}observe(t){return null===this._observers&&(this._observers=[]),this._observers.includes(t)||this._observers.push(t),new vr(this._observers,t)}notifyChange(){this.onInvalidated(),this.onCommitted()}invalidate(){this.onInvalidated()}onInvalidated(){2&~this.flags&&(this.flags|=1);const t=this._observers;if(null!==t)for(let e=0;e<t.length;++e)t[e].onInvalidated()}commit(){this.flags&=-2,this.onCommitted()}onCommitted(){if(null===this._observers)return;const t=this._observers.slice();for(let e=0;e<t.length;++e)t[e].onCommitted()}_clearObservationHandles(){const t=this._handles;if(null!==t){for(let e=0;e<t.length;++e)t[e].remove();t.length=0}}}function br(t){switch(t){case"defaults":return 0;case"service":return 2;case"portal-item":return 3;case"web-scene":return 4;case"web-map":return 5;case"user":return 6}}function Mr(t){switch(t){case 0:return"defaults";case 2:return"service";case 3:return"portal-item";case 4:return"web-scene";case 5:return"web-map";case 6:return"user"}}function Sr(t){return Mr(t)}class xr{constructor(){this._values=new Map}clone(t){const e=new xr;return this._values.forEach(((i,s)=>{t&&t.has(s)||e.set(s,H(i))})),e}get(t){return this._values.get(t)}originOf(){return 6}keys(){return[...this._values.keys()]}set(t,e){this._values.set(t,e)}delete(t){this._values.delete(t)}has(t){return this._values.has(t)}forEach(t){this._values.forEach(t)}}function kr(t){return void 0!==t}function Ir(t,e,i){return!(void 0===t||null==i&&8&t.flags)}function jr(t){return t&&"function"==typeof t.destroy}ct.getLogger("esri.core.accessorSupport.Properties");class _r{constructor(t){this.host=t,this.properties=new Map,this.ctorArgs=null,this.destroyed=!1,this.lifecycle=0,this.store=new xr,this._origin=6;const e=this.host.constructor.__accessorMetadata__,i=e.properties;for(const t in i){const e=new wr(this,t,i[t]);this.properties.set(t,e)}this.metadatas=i,this._autoDestroy=e.autoDestroy}initialize(){this.lifecycle=1}constructed(){this.lifecycle=2}destroy(){if(this.destroyed=!0,this._autoDestroy)for(const[t,e]of this.properties){const i=this.internalGet(t);i&&jr(i)&&(i.destroy(),8&~e.flags&&this._internalSet(e,null)),e.destroy()}else for(const[t,e]of this.properties)e.destroy()}get initialized(){return 0!==this.lifecycle}get(t){const e=this.properties.get(t);if(e.metadata.get)return e.getComputed();pe(e);const i=this.store;return i.has(t)?i.get(t):e.metadata.value}originOf(t){const e=this.store.originOf(t);if(void 0===e){const e=this.properties.get(t);if(void 0!==e&&16&e.flags)return"defaults"}return Mr(e)}has(t){return!!this.properties.has(t)&&this.store.has(t)}keys(){return[...this.properties.keys()]}internalGet(t){const e=this.properties.get(t);if(kr(e))return this.store.has(t)?this.store.get(t):e.metadata.value}internalSet(t,e){const i=this.properties.get(t);kr(i)&&this._internalSet(i,e)}getDependsInfo(t,e,i){const s=this.properties.get(e);if(!kr(s))return"";const n=new Set,r=me({onObservableAccessed:t=>n.add(t),onTrackingEnd:()=>{}},(()=>{var e;return null==(e=s.metadata.get)?void 0:e.call(t)}));let o=`${i}${t.declaredClass.split(".").pop()}.${e}: ${r}\n`;if(0===n.size)return o;i+="  ";for(const t of n){if(!(t instanceof wr))continue;const e=t.properties.host,s=t.propertyName,n=Gt(e);o+=n?n.getDependsInfo(e,s,i):`${i}${s}: undefined\n`}return o}setAtOrigin(t,e,i){const s=this.properties.get(t);if(kr(s))return this._setAtOrigin(s,e,i)}isOverridden(t){const e=this.properties.get(t);return void 0!==e&&!!(2&e.flags)}clearOverride(t){const e=this.properties.get(t);void 0!==e&&2&e.flags&&(e.flags&=-3,e.notifyChange())}override(t,e){const i=this.properties.get(t);if(!Ir(i,0,e))return;const s=i.metadata.cast;if(s){const t=this._cast(s,e),{valid:i,value:n}=t;if(Tr.release(t),!i)return;e=n}i.flags|=2,this._internalSet(i,e)}set(t,e){const i=this.properties.get(t);if(!Ir(i,0,e))return;const s=i.metadata.cast;if(s){const t=this._cast(s,e),{valid:i,value:n}=t;if(Tr.release(t),!i)return;e=n}const n=i.metadata.set;n?n.call(this.host,e):this._internalSet(i,e)}setDefaultOrigin(t){this._origin=br(t)}getDefaultOrigin(){return Mr(this._origin)}notifyChange(t){const e=this.properties.get(t);void 0!==e&&e.notifyChange()}invalidate(t){const e=this.properties.get(t);void 0!==e&&e.invalidate()}commit(t){const e=this.properties.get(t);void 0!==e&&e.commit()}_internalSet(t,e){this._setAtOrigin(t,e,0!==this.lifecycle?this._origin:0)}_setAtOrigin(t,e,i){const s=this.store,n=t.propertyName;s.has(n,i)&&J(e,s.get(n))&&2&~t.flags&&i===s.originOf(n)||(t.invalidate(),s.set(n,e,i),t.commit(),be(this.host,t))}_cast(t,e){const i=Tr.acquire();return i.valid=!0,i.value=e,t&&(i.value=t.call(this.host,e,i)),i}}const Tr=new gr(class{constructor(){this.value=null,this.valid=!0}acquire(){this.valid=!0}release(){this.value=null}});function Or(t){t.length=0}class Ar{constructor(t=50,e=50){this._pool=new gr(Array,void 0,Or,e,t)}acquire(){return this._pool.acquire()}release(t){this._pool.release(t)}prune(){this._pool.prune(0)}static acquire(){return Fr.acquire()}static release(t){return Fr.release(t)}static prune(){Fr.prune()}}const Fr=new Ar(100),Cr=i.queueMicrotask?i.queueMicrotask:t=>{i.Promise.resolve().then(t)},Pr=[];function Er(t){Pr.push(t),1===Pr.length&&Cr((()=>{const t=Pr.slice();Pr.length=0;for(const e of t)e()}))}class Rr{constructor(t,e=29){this.name=t,this._counter=0,this._items=Array(e)}record(t){this._items[++this._counter%this._items.length]=t}get median(){return this._items.slice().sort(((t,e)=>t-e))[Math.floor(this._items.length/2)]}get average(){return this._items.reduce(((t,e)=>t+e),0)/this._items.length}get last(){return this._items[this._counter%this._items.length]}}var Lr;!function(t){const e=(t,e,i,s)=>{let n=e,r=e;const o=i>>>1,a=t[n-1];for(;r<=o;){r=n<<1,r<i&&s(t[r-1],t[r])<0&&++r;const e=t[r-1];if(s(e,a)<=0)break;t[n-1]=e,n=r}t[n-1]=a},i=(t,e)=>t<e?-1:t>e?1:0;t.sort=function(t,s,n,r){void 0===s&&(s=0),void 0===n&&(n=t.length),void 0===r&&(r=i);for(let i=n>>>1;i>s;i--)e(t,i,n,r);const o=s+1;for(let i=n-1;i>s;i--){const n=t[s];t[s]=t[i],t[i]=n,e(t,o,i,r)}},t.iterableSort=function*(t,s,n,r){void 0===s&&(s=0),void 0===n&&(n=t.length),void 0===r&&(r=i);for(let i=n>>>1;i>s;i--)e(t,i,n,r),yield;const o=s+1;for(let i=n-1;i>s;i--){const n=t[s];t[s]=t[i],t[i]=n,e(t,o,i,r),yield}}}(Lr||(Lr={}));const Nr=Lr;class Dr{constructor(t){this.data=[],this._length=0,this._allocator=void 0,this._deallocator=()=>null,this._shrink=()=>{},this._hint=new E,t&&(t.initialSize&&(this.data=Array(t.initialSize)),t.allocator&&(this._allocator=t.allocator),void 0!==t.deallocator&&(this._deallocator=t.deallocator),t.shrink&&(this._shrink=()=>Vr(this)))}toArray(){return this.data.slice(0,this.length)}getItemAt(t){if(!(t<0||t>=this._length))return this.data[t]}get length(){return this._length}set length(t){if(t>this._length){if(this._allocator){for(;this._length<t;)this.data[this._length++]=this._allocator(this.data[this._length]);return}this._length=t}else{if(this._deallocator)for(let e=t;e<this._length;++e)this.data[e]=this._deallocator(this.data[e]);this._length=t,this._shrink()}}clear(){this.length=0}prune(){this.clear(),this.data=[]}push(t){this.data[this._length++]=t}pushArray(t,e=t.length){for(let i=0;i<e;i++)this.data[this._length++]=t[i]}fill(t,e){for(let i=0;i<e;i++)this.data[this._length++]=t}pushNew(){this._allocator&&(this.data[this.length]=this._allocator(this.data[this.length]));const t=this.data[this._length];return++this._length,t}unshift(t){this.data.unshift(t),this._length++,Vr(this)}pop(){if(0===this.length)return;const t=this.data[this.length-1];return this.length=this.length-1,this._shrink(),t}remove(t){const e=L(this.data,t,this.length,this._hint);if(-1!==e)return this.data.splice(e,1),this.length=this.length-1,t}removeUnordered(t){const e=N(this.data,t,this.length,this._hint);return void 0!==e&&(this.length=this.length-1),this._shrink(),e}removeUnorderedIndex(t){if(!(t>=this.length||t<0))return this.swapElements(t,this.length-1),this.pop()}removeUnorderedMany(t,e=t.length,i){this.length=function(t,e,i=t.length,s=e.length,n,r){if(0===s||0===i)return i;D.clear();for(let t=0;t<s;++t)D.add(e[t]);const o=Math.max(0,(n=n||R).last-10);for(let e=o;e<i;++e)if(D.has(t[e])&&(r&&r.push(t[e]),D.delete(t[e]),t[e]=t[i-1],--i,--e,0===D.size||0===i))return D.clear(),i;for(let e=0;e<o;++e)if(D.has(t[e])&&(r&&r.push(t[e]),D.delete(t[e]),t[e]=t[i-1],--i,--e,0===D.size||0===i))return D.clear(),i;return D.clear(),i}(this.data,t,this.length,e,this._hint,i),this._shrink()}front(){if(0!==this.length)return this.data[0]}back(){if(0!==this.length)return this.data[this.length-1]}swapElements(t,e){t>=this.length||e>=this.length||t===e||([this.data[t],this.data[e]]=[this.data[e],this.data[t]])}sort(t){Nr.sort(this.data,0,this.length,t)}iterableSort(t){return Nr.iterableSort(this.data,0,this.length,t)}some(t,e){for(let i=0;i<this.length;++i)if(t.call(e,this.data[i],i,this.data))return!0;return!1}filterInPlace(t,e){let i=0;for(let s=0;s<this._length;++s){const n=this.data[s];t.call(e,n,s,this.data)&&(this.data[s]=this.data[i],this.data[i]=n,i++)}if(this._deallocator)for(let t=i;t<this._length;t++)this.data[t]=this._deallocator(this.data[t]);return this._length=i,this._shrink(),this}forAll(t,e){const i=this.length,s=this.data;for(let n=0;n<i;++n)t.call(e,s[n],n,s)}forEach(t,e){for(let i=0;i<this.length;++i)t.call(e,this.data[i],i,this.data)}map(t,e){const i=Array(this.length);for(let s=0;s<this.length;++s)i[s]=t.call(e,this.data[s],s,this.data);return i}reduce(t,e){let i=e;for(let e=0;e<this.length;++e)i=t(i,this.data[e],e,this.data);return i}has(t){const e=this.length,i=this.data;for(let s=0;s<e;++s)if(i[s]===t)return!0;return!1}}function Vr(t){t.data.length>1.5*t.length&&(t.data.length=Math.floor(1.1*t.length))}class $r{constructor(t){this.phases=t,this.paused=!1,this.ticks=-1,this.removed=!1}}class zr{constructor(t){this.callback=t,this.isActive=!0}remove(){this.isActive=!1}}let Gr=0;const Ur={time:0,deltaTime:0,elapsedFrameTime:0,frameDuration:0},qr=["prepare","preRender","render","postRender","update"],Br=[],Wr=new Dr;class Hr{constructor(t){this._task=t}remove(){this._task.removed=!0}pause(){this._task.paused=!0}resume(){this._task.paused=!1}}const Jr={frameTasks:Wr,willDispatch:!1,clearFrameTasks:function(t=!1){Wr.forAll((t=>{t.removed=!0})),t&&to()},dispatch:eo,executeFrameTasks:function(t){const e=t-Gr;Gr=t;const i=1e3/60,s=Math.max(0,e-i);for(let n=0;n<qr.length;n++){const r=performance.now(),o=qr[n];Wr.forAll((r=>{var a;r.paused||r.removed||(0===n&&r.ticks++,r.phases[o]&&(Ur.time=t,Ur.deltaTime=0===r.ticks?0:e,Ur.elapsedFrameTime=performance.now()-t,Ur.frameDuration=i-s,null==(a=r.phases[o])||a.call(r,Ur)))})),so[n].record(performance.now()-r)}to(),no.record(performance.now()-t)}};function Zr(t){const e=new zr(t);return Br.push(e),Jr.willDispatch||(Jr.willDispatch=!0,Er(eo)),e}function Qr(t){const e=new $r(t);return Wr.push(e),null==Kr&&(Gr=performance.now(),Kr=requestAnimationFrame(Yr)),new Hr(e)}let Kr=null;function Yr(){const t=performance.now();Kr=null,Kr=Wr.length>0?requestAnimationFrame(Yr):null,Jr.executeFrameTasks(t)}const Xr=new Dr;function to(){Wr.forAll((t=>{t.removed&&Xr.push(t)})),Wr.removeUnorderedMany(Xr.data,Xr.length),Xr.clear()}function eo(){for(;Br.length;){const t=Br.shift();t.isActive&&t.callback()}Jr.willDispatch=!1}function io(t=1,e){const i=fs(),s=()=>{Qi(e)?i.reject(Hi()):0===t?i():(--t,Er((()=>s())))};return s(),i.promise}const so=qr.map((t=>new Rr(t))),no=new Rr("total");let ro=0;function oo(){return++ro}class ao{constructor(t){this._notify=t,this._accessed=[],this._handles=[],this._invalidCount=0}destroy(){this._accessed.length=0,this.clear()}onInvalidated(){this._invalidCount++}onCommitted(){const t=this._invalidCount;if(1===t)return this._invalidCount=0,void this._notify();this._invalidCount=t>0?t-1:0}onObservableAccessed(t){this._accessed.includes(t)||this._accessed.push(t)}onTrackingEnd(){const t=this._handles,e=this._accessed;for(let i=0;i<e.length;++i)t.push(e[i].observe(this));e.length=0}clear(){const t=this._handles;for(let e=0;e<t.length;++e)t[e].remove();t.length=0}}let lo=!1;const uo=[];function co(t,e){let i=new ao((function r(){if(!i||n)return;if(lo)return void fo(r);const o=s;i.clear(),lo=!0,n=!0,s=me(i,t),n=!1,lo=!1,e(s,o),yo()})),s=null,n=!1;return n=!0,s=me(i,t),n=!1,{remove:function(){i&&(i.destroy(),i=null,s=null)}}}function ho(t,e){let i=new ao((function(){e(s,n)})),s=null;function n(){return i?(i.clear(),s=me(i,t),s):null}return n(),{remove:function(){i&&(i.destroy(),i=null),s=null}}}function po(t){let e=new ao((function s(){e&&!i&&(lo?fo(s):(e.clear(),lo=!0,i=!0,me(e,t),i=!1,lo=!1,yo()))})),i=!1;return i=!0,me(e,t),i=!1,{remove:function(){e&&(e.destroy(),e=null)}}}function fo(t){uo.includes(t)||uo.unshift(t)}function yo(){for(;uo.length;)uo.pop()()}class mo{constructor(){this.uid=oo(),this.removed=!1,this.type=null,this.oldValue=null,this.callback=null,this.getValue=null,this.target=null,this.path=null,this.equals=null}static acquireUntracked(t,e,i,s,n){return this.pool.acquire(0,t,e,i,s,n,J)}static acquireTracked(t,e,i,s){return this.pool.acquire(1,t,e,i,null,null,s)}notify(t,e){0===this.type?this.callback.call(this.target,t,e,this.path,this.target):this.callback.call(null,t,e)}acquire(t,e,i,s,n,r,o){this.uid=oo(),this.removed=!1,this.type=t,this.oldValue=e,this.callback=i,this.getValue=s,this.target=n,this.path=r,this.equals=o}release(){this.target=this.path=this.oldValue=this.callback=this.getValue=null,this.uid=oo(),this.removed=!0}}mo.pool=new class extends gr{constructor(){super(...arguments),this._set=new Set}destroy(){super.destroy(),this._set=null}acquire(...t){const e=super.acquire(...t);return this._set.delete(e),e}release(t){t&&!this._set.has(t)&&(super.release(t),this._set.add(t))}_dispose(t){this._set.delete(t),super._dispose(t)}}(mo);const go=new Ar,vo=new Set;let wo;function bo(t){vo.delete(t),vo.add(t),wo||(wo=Zr(So))}function Mo(t){if(t.removed)return;const e=t.oldValue,i=t.getValue();t.equals(e,i)||(t.oldValue=i,t.notify(i,e))}function So(){let t=10;for(;wo&&t--;){wo=null;const t=xo(),e=go.acquire();for(const i of t){const t=i.uid;Mo(i),t===i.uid&&i.removed&&e.push(i)}for(const t of vo)t.removed&&(e.push(t),vo.delete(t));for(const t of e)mo.pool.release(t);go.release(e),go.release(t),ko.forEach((t=>t()))}}function xo(){const t=go.acquire();t.length=vo.size;let e=0;for(const i of vo)t[e]=i,++e;return vo.clear(),t}const ko=new Set;function Io(t){if(null==t)return{value:t};if(Array.isArray(t))return{type:[t[0]],value:null};switch(typeof t){case"object":return t.constructor&&t.constructor.__accessorMetadata__||t instanceof Date?{type:t.constructor,value:t}:t;case"boolean":return{type:Boolean,value:t};case"string":return{type:String,value:t};case"number":return{type:Number,value:t};case"function":return{type:t,value:null};default:return}}class jo{constructor(...t){if(this.constructor===jo)throw Error("[accessor] cannot instantiate Accessor. This can be fixed by creating a subclass of Accessor");Object.defineProperty(this,"__accessor__",{enumerable:!1,value:new _r(this)}),t.length>0&&this.normalizeCtorArgs&&(this.__accessor__.ctorArgs=this.normalizeCtorArgs.apply(this,t))}static createSubclass(t={}){if(Array.isArray(t))throw Error("Multi-inheritance unsupported since 4.16");const{properties:e,declaredClass:i,constructor:s}=t;delete t.declaredClass,delete t.properties,delete t.constructor;const n=this;class r extends n{constructor(...t){super(...t),this.inherited=null,s&&s.apply(this,t)}}ee(r.prototype);for(const e in t){const i=t[e];r.prototype[e]="function"==typeof i?function(...t){const s=this.inherited;let r;this.inherited=function(...t){if(n.prototype[e])return n.prototype[e].apply(this,t)};try{r=i.apply(this,t)}catch(t){throw this.inherited=s,t}return this.inherited=s,r}:t[e]}for(const t in e)oe(Io(e[t]))(r.prototype,t);return si(i)(r)}postscript(t){const e=this.__accessor__,i=e.ctorArgs||t;e.initialize(),i&&(this.set(i),e.ctorArgs=null),e.constructed(),this.initialize()}initialize(){}destroy(){this.destroyed||(function(t){for(const e of vo.values())e.target===t&&(e.removed=!0)}(this),this.__accessor__.destroy())}get initialized(){return this.__accessor__&&this.__accessor__.initialized||!1}get constructed(){return this.__accessor__&&2===this.__accessor__.lifecycle||!1}get destroyed(){return this.__accessor__&&this.__accessor__.destroyed||!1}commitProperty(t){this.get(t)}get(t){return Yt(this,t)}hasOwnProperty(t){return this.__accessor__?this.__accessor__.has(t):Object.prototype.hasOwnProperty.call(this,t)}isInstanceOf(t){return cr(ct.getLogger(this.declaredClass),"isInstanceOf",{replacement:"Use instanceof directly",version:"4.16"}),this instanceof t}keys(){return this.__accessor__?this.__accessor__.keys():[]}set(t,e){return re(this,t,e),this}watch(t,e,i){return function(t,e,i,s=!1){return!t.__accessor__||t.__accessor__.destroyed?{remove(){}}:s?function(t,e,i){const s=Ht(t,e,i,((t,e,i)=>{let n=!1;return co((()=>Kt(t,e)),((r,o)=>{t.__accessor__.destroyed?s.remove():n||(n=!0,J(o,r)||i.call(t,r,o,e,t),n=!1)}))}));return s}(t,e,i):function(t,e,i){let s=Ht(t,e,i,((t,e,i)=>{let n,r,o=ho((()=>Kt(t,e)),((o,a)=>{t.__accessor__.destroyed||n&&n.uid!==r?s.remove():(n||(n=mo.acquireUntracked(o,i,a,t,e),r=n.uid),bo(n))}));return{remove:Jt((()=>{o.remove(),n&&(n.uid!==r||n.removed||(n.removed=!0,bo(n)),n=null),s=o=null}))}}));return s}(t,e,i)}(this,t,e,i)}_clearOverride(t){return this.__accessor__.clearOverride(t)}_override(t,e){return this.__accessor__.override(t,e)}_isOverridden(t){return this.__accessor__.isOverridden(t)}notifyChange(t){this.__accessor__.notifyChange(t)}_get(t){return this.__accessor__.internalGet(t)}_set(t,e){return this.__accessor__.internalSet(t,e),this}}class _o{constructor(){this._emitter=new _o.EventEmitter(this)}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}}!function(t){class i{constructor(t=null){this.target=t,this._listenersMap=null}clear(){this._listenersMap&&this._listenersMap.clear(),this._listenersMap=null}emit(t,e){const i=this._listenersMap&&this._listenersMap.get(t);if(!i)return!1;const s=this.target||this;return[...i].forEach((t=>{t.call(s,e)})),i.length>0}on(t,e){if(Array.isArray(t))return $t(t.map((t=>this.on(t,e))));if(t.indexOf(",")>-1)throw new TypeError("Evented.on() with a comma delimited string of event types is not supported");this._listenersMap||(this._listenersMap=new Map);const i=this._listenersMap.get(t)||[];return i.push(e),this._listenersMap.set(t,i),{remove:()=>{const i=this._listenersMap&&this._listenersMap.get(t)||[],s=i.indexOf(e);s>=0&&i.splice(s,1)}}}once(t,e){const i=this.on(t,(t=>{i.remove(),e.call(null,t)}));return i}hasEventListener(t){const e=this._listenersMap&&this._listenersMap.get(t);return null!=e&&e.length>0}}t.EventEmitter=i,t.EventedMixin=t=>{let s=class extends t{constructor(){super(...arguments),this._emitter=new i}destroy(){this._emitter.clear()}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};return s=e([si("esri.core.Evented")],s),s};let s=class extends jo{constructor(){super(...arguments),this._emitter=new _o.EventEmitter(this)}destroy(){this._emitter.clear()}emit(t,e){return this._emitter.emit(t,e)}on(t,e){return this._emitter.on(t,e)}once(t,e){return this._emitter.once(t,e)}hasEventListener(t){return this._emitter.hasEventListener(t)}};s=e([si("esri.core.Evented")],s),t.EventedAccessor=s}(_o||(_o={}));const To=_o;function Oo(t){return(e,i)=>{e[i]=t}}class Ao{constructor(){this._observers=[]}observe(t){return this._observers.includes(t)||this._observers.push(t),new vr(this._observers,t)}notify(){const t=this._observers.slice();for(let e=0;e<t.length;++e){const i=t[e];i.onInvalidated(),i.onCommitted()}}}var Fo;const Co=new gr(class{constructor(){this.target=null,this.cancellable=!1,this.defaultPrevented=!1,this.item=void 0,this.type=void 0}preventDefault(){this.cancellable&&(this.defaultPrevented=!0)}reset(t){this.defaultPrevented=!1,this.item=t}},void 0,(t=>{t.item=null,t.target=null,t.defaultPrevented=!1,t.cancellable=!1})),Po=()=>{};function Eo(t){return t?t instanceof Uo?t.toArray():t.length?Array.prototype.slice.apply(t):[]:[]}function Ro(t){if(t&&t.length)return t[0]}function Lo(t,e,i,s){const n=Math.min(t.length-i,e.length-s);let r=0;for(;r<n&&t[i+r]===e[s+r];)r++;return r}function No(t,e,i,s){e&&e.forEach(((e,n,r)=>{t.push(e),No(t,i.call(s,e,n,r),i,s)}))}const Do=new Set,Vo=new Set,$o=new Set,zo=new Map;let Go=0,Uo=Fo=class extends To.EventedAccessor{constructor(t){super(t),this._chgListeners=[],this._notifications=null,this._timer=null,this._observable=new Ao,this.length=0,this._items=[],Object.defineProperty(this,"uid",{value:Go++})}static isCollection(t){return null!=t&&t instanceof Fo}normalizeCtorArgs(t){return t?Array.isArray(t)||t instanceof Fo?{items:t}:t:{}}destroy(){this.removeAll()}*[Symbol.iterator](){yield*this.items}get items(){return pe(this._observable),this._items}set items(t){this._emitBeforeChanges(1)||(this._splice(0,this.length,...Eo(t)),this._emitAfterChanges(1))}hasEventListener(t){return"change"===t?this._chgListeners.length>0:this._emitter.hasEventListener(t)}on(t,e){if("change"===t){const t=this._chgListeners,i={removed:!1,callback:e};return t.push(i),this._notifications&&this._notifications.push({listeners:t.slice(),items:this._items.slice(),changes:[]}),{remove(){this.remove=Po,i.removed=!0,t.splice(t.indexOf(i),1)}}}return this._emitter.on(t,e)}once(t,e){const i=this.on(t,e);return{remove(){i.remove()}}}add(t,e){if(pe(this._observable),this._emitBeforeChanges(1))return this;const i=this.getNextIndex(null!=e?e:null);return this._splice(i,0,t),this._emitAfterChanges(1),this}addMany(t,e=this._items.length){if(pe(this._observable),!t||!t.length)return this;if(this._emitBeforeChanges(1))return this;const i=this.getNextIndex(e);return this._splice(i,0,...Eo(t)),this._emitAfterChanges(1),this}removeAll(){if(pe(this._observable),!this.length||this._emitBeforeChanges(2))return[];const t=this._splice(0,this.length)||[];return this._emitAfterChanges(2),t}clone(){return pe(this._observable),this._createNewInstance({items:this._items.map(H)})}concat(...t){pe(this._observable);const e=t.map(Eo);return this._createNewInstance({items:this._items.concat(...e)})}drain(t,e){if(pe(this._observable),!this.length||this._emitBeforeChanges(2))return;const i=this._splice(0,this.length),s=i.length;for(let n=0;n<s;n++)t.call(e,i[n],n,i);this._emitAfterChanges(2)}every(t,e){return pe(this._observable),this._items.every(t,e)}filter(t,e){let i;return pe(this._observable),i=2===arguments.length?this._items.filter(t,e):this._items.filter(t),this._createNewInstance({items:i})}find(t,e){return pe(this._observable),this._items.find(t,e)}findIndex(t,e){return pe(this._observable),this._items.findIndex(t,e)}flatten(t,e){pe(this._observable);const i=[];return No(i,this,t,e),new Fo(i)}forEach(t,e){return pe(this._observable),this._items.forEach(t,e)}getItemAt(t){return pe(this._observable),this._items[t]}getNextIndex(t){pe(this._observable);const e=this.length;return(t=null==t?e:t)<0?t=0:t>e&&(t=e),t}includes(t,e=0){return pe(this._observable),this._items.includes(t,e)}indexOf(t,e=0){return pe(this._observable),this._items.indexOf(t,e)}join(t=","){return pe(this._observable),this._items.join(t)}lastIndexOf(t,e=this.length-1){return pe(this._observable),this._items.lastIndexOf(t,e)}map(t,e){pe(this._observable);const i=this._items.map(t,e);return new Fo({items:i})}reorder(t,e=this.length-1){pe(this._observable);const i=this.indexOf(t);if(-1!==i){if(e<0?e=0:e>=this.length&&(e=this.length-1),i!==e){if(this._emitBeforeChanges(4))return t;this._splice(i,1),this._splice(e,0,t),this._emitAfterChanges(4)}return t}}pop(){if(pe(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Ro(this._splice(this.length-1,1));return this._emitAfterChanges(2),t}push(...t){return pe(this._observable),this._emitBeforeChanges(1)||(this._splice(this.length,0,...t),this._emitAfterChanges(1)),this.length}reduce(t,e){pe(this._observable);const i=this._items;return 2===arguments.length?i.reduce(t,e):i.reduce(t)}reduceRight(t,e){pe(this._observable);const i=this._items;return 2===arguments.length?i.reduceRight(t,e):i.reduceRight(t)}remove(t){return pe(this._observable),this.removeAt(this.indexOf(t))}removeAt(t){if(pe(this._observable),t<0||t>=this.length||this._emitBeforeChanges(2))return;const e=Ro(this._splice(t,1));return this._emitAfterChanges(2),e}removeMany(t){if(pe(this._observable),!t||!t.length||this._emitBeforeChanges(2))return[];const e=t instanceof Fo?t.toArray():t,i=this._items,s=[],n=e.length;for(let t=0;t<n;t++){const n=i.indexOf(e[t]);if(n>-1){const r=1+Lo(e,i,t+1,n+1),o=this._splice(n,r);o&&o.length>0&&s.push.apply(s,o),t+=r-1}}return this._emitAfterChanges(2),s}reverse(){if(pe(this._observable),this._emitBeforeChanges(4))return this;const t=this._splice(0,this.length);return t&&(t.reverse(),this._splice(0,0,...t)),this._emitAfterChanges(4),this}shift(){if(pe(this._observable),!this.length||this._emitBeforeChanges(2))return;const t=Ro(this._splice(0,1));return this._emitAfterChanges(2),t}slice(t=0,e=this.length){return pe(this._observable),this._createNewInstance({items:this._items.slice(t,e)})}some(t,e){return pe(this._observable),this._items.some(t,e)}sort(t){if(pe(this._observable),!this.length||this._emitBeforeChanges(4))return this;const e=this._splice(0,this.length);return arguments.length?e.sort(t):e.sort(),this._splice(0,0,...e),this._emitAfterChanges(4),this}splice(t,e,...i){pe(this._observable);const s=(e?2:0)|(i.length?1:0);if(this._emitBeforeChanges(s))return[];const n=this._splice(t,e,...i)||[];return this._emitAfterChanges(s),n}toArray(){return pe(this._observable),this._items.slice()}toJSON(){return pe(this._observable),this.toArray()}toLocaleString(){return pe(this._observable),this._items.toLocaleString()}toString(){return pe(this._observable),""+this._items}unshift(...t){return pe(this._observable),!t.length||this._emitBeforeChanges(1)||(this._splice(0,0,...t),this._emitAfterChanges(1)),this.length}_createNewInstance(t){return new this.constructor(t)}_splice(t,e,...i){const s=this._items,n=this.itemType;let r,o;if(!this._notifications&&this.hasEventListener("change")&&(this._notifications=[{listeners:this._chgListeners.slice(),items:this._items.slice(),changes:[]}],this._timer&&this._timer.remove(),this._timer=Zr((()=>this._dispatchChange()))),e){if(o=s.splice(t,e),this.hasEventListener("before-remove")){const e=Co.acquire();e.target=this,e.cancellable=!0;for(let i=0,n=o.length;i<n;i++)r=o[i],e.reset(r),this.emit("before-remove",e),e.defaultPrevented&&(o.splice(i,1),s.splice(t,0,r),t+=1,i-=1,n-=1);Co.release(e)}if(this.length=this._items.length,this.hasEventListener("after-remove")){const t=Co.acquire();t.target=this,t.cancellable=!1;const e=o.length;for(let i=0;i<e;i++)t.reset(o[i]),this.emit("after-remove",t);Co.release(t)}}if(i&&i.length){if(n){const t=[];for(const e of i){const i=n.ensureType(e);null==i&&null!=e||t.push(i)}i=t}const e=this.hasEventListener("before-add"),r=this.hasEventListener("after-add"),o=t===this.length;if(e||r){const n=Co.acquire();n.target=this,n.cancellable=!0;const a=Co.acquire();a.target=this,a.cancellable=!1;for(const l of i)e?(n.reset(l),this.emit("before-add",n),n.defaultPrevented||(o?s.push(l):s.splice(t++,0,l),this._set("length",s.length),r&&(a.reset(l),this.emit("after-add",a)))):(o?s.push(l):s.splice(t++,0,l),this._set("length",s.length),a.reset(l),this.emit("after-add",a));Co.release(a),Co.release(n)}else{if(o)for(const t of i)s.push(t);else s.splice(t,0,...i);this._set("length",s.length)}}return(i&&i.length||o&&o.length)&&this._notifyChangeEvent(i,o),o}_emitBeforeChanges(t){let e=!1;if(this.hasEventListener("before-changes")){const i=Co.acquire();i.target=this,i.cancellable=!0,i.type=t,this.emit("before-changes",i),e=i.defaultPrevented,Co.release(i)}return e}_emitAfterChanges(t){if(this.hasEventListener("after-changes")){const e=Co.acquire();e.target=this,e.cancellable=!1,e.type=t,this.emit("after-changes",e),Co.release(e)}this._observable.notify()}_notifyChangeEvent(t,e){this.hasEventListener("change")&&this._notifications&&this._notifications[this._notifications.length-1].changes.push({added:t,removed:e})}_dispatchChange(){if(this._timer&&(this._timer.remove(),this._timer=null),!this._notifications)return;const t=this._notifications;this._notifications=null;for(const e of t){const t=e.changes;Do.clear(),Vo.clear(),$o.clear();for(const{added:e,removed:i}of t){if(e)if(0===$o.size&&0===Vo.size)for(const t of e)Do.add(t);else for(const t of e)Vo.has(t)?($o.add(t),Vo.delete(t)):$o.has(t)||Do.add(t);if(i)if(0===$o.size&&0===Do.size)for(const t of i)Vo.add(t);else for(const t of i)Do.has(t)?Do.delete(t):($o.delete(t),Vo.add(t))}const i=Ar.acquire();Do.forEach((t=>{i.push(t)}));const s=Ar.acquire();Vo.forEach((t=>{s.push(t)}));const n=this._items,r=e.items,o=Ar.acquire();if($o.forEach((t=>{r.indexOf(t)!==n.indexOf(t)&&o.push(t)})),e.listeners&&(i.length||s.length||o.length)){const t={target:this,added:i,removed:s,moved:o},n=e.listeners.length;for(let i=0;i<n;i++){const s=e.listeners[i];s.removed||s.callback.call(this,t)}}Ar.release(i),Ar.release(s),Ar.release(o)}Do.clear(),Vo.clear(),$o.clear()}};Uo.ofType=t=>{if(!t)return Fo;if(zo.has(t))return zo.get(t);let i=null;if("function"==typeof t)i=t.prototype.declaredClass;else if(t.base)i=t.base.prototype.declaredClass;else for(const e in t.typeMap){const s=t.typeMap[e].prototype.declaredClass;i?i+=" | "+s:i=s}let s=class extends Fo{};return e([Oo({Type:t,ensureType:"function"==typeof t?Tt(t):Et(t)})],s.prototype,"itemType",void 0),s=e([si(`esri.core.Collection<${i}>`)],s),zo.set(t,s),s},e([oe()],Uo.prototype,"length",void 0),e([oe()],Uo.prototype,"items",null),Uo=Fo=e([si("esri.core.Collection")],Uo);const qo=Uo;let Bo=class extends jo{constructor(t){super(t),this._groups=new Map}destroy(){this.removeAll()}get size(){let t=0;return this._groups.forEach((e=>{t+=e.length})),t}add(t,e){if(!this._isHandle(t)&&!Array.isArray(t)&&!qo.isCollection(t))return this;const i=this._getOrCreateGroup(e);return Array.isArray(t)||qo.isCollection(t)?t.forEach((t=>this._isHandle(t)&&i.push(t))):i.push(t),this.notifyChange("size"),this}forEach(t,e){if("function"==typeof t)this._groups.forEach((e=>e.forEach(t)));else{const i=this._getGroup(t);i&&e&&i.forEach(e)}}has(t){return this._groups.has(this._ensureGroupKey(t))}remove(t){if(Array.isArray(t)||qo.isCollection(t))return t.forEach(this.remove,this),this;if(!this.has(t))return this;const e=this._getGroup(t);for(let t=0;t<e.length;t++)e[t].remove();return this._deleteGroup(t),this.notifyChange("size"),this}removeAll(){return this._groups.forEach((t=>{for(let e=0;e<t.length;e++)t[e].remove()})),this._groups.clear(),this.notifyChange("size"),this}_isHandle(t){return t&&!!t.remove}_getOrCreateGroup(t){if(this.has(t))return this._getGroup(t);const e=[];return this._groups.set(this._ensureGroupKey(t),e),e}_getGroup(t){return this._groups.get(this._ensureGroupKey(t))}_deleteGroup(t){return this._groups.delete(this._ensureGroupKey(t))}_ensureGroupKey(t){return t||"_default_"}};e([oe({readOnly:!0})],Bo.prototype,"size",null),Bo=e([si("esri.core.Handles")],Bo);const Wo=Bo;class Ho{constructor(t){this.instance=t,this._resolver=ns(),this._status=0,this._resolvingPromises=[],this._resolver.promise.then((()=>{this._status=1,this._cleanUp()}),(()=>{this._status=2,this._cleanUp()}))}addResolvingPromise(t){this._resolvingPromises.push(t),this._tryResolve()}isResolved(){return 1===this._status}isRejected(){return 2===this._status}isFulfilled(){return 0!==this._status}abort(){this._resolver.reject(Hi())}when(t,e){return this._resolver.promise.then(t,e)}_cleanUp(){this._allPromise=this._resolvingPromises=this._allPromise=null}_tryResolve(){if(this.isFulfilled())return;const t=ns(),e=[...this._resolvingPromises,t.promise],i=this._allPromise=Promise.all(e);i.then((()=>{this.isFulfilled()||this._allPromise!==i||this._resolver.resolve(this.instance)}),(t=>{this.isFulfilled()||this._allPromise!==i||is(t)||this._resolver.reject(t)})),t.resolve()}}const Jo=t=>{let i=class extends t{constructor(...t){super(...t),this._promiseProps=new Ho(this),this.addResolvingPromise(Promise.resolve())}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(t,e){return new Promise(((t,e)=>{this._promiseProps.when(t,e)})).then(t,e)}catch(t){return this.when(null,t)}addResolvingPromise(t){t&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in t?t.when():t)}};return i=e([si("esri.core.Promise")],i),i};let Zo=class extends(Jo(jo)){};function Qo(){const t=Ko.getRandomValues(new Uint16Array(8));t[3]=4095&t[3]|16384,t[4]=16383&t[4]|32768;const e=e=>t[e].toString(16);return e(0)+e(1)+"-"+e(2)+"-"+e(3)+"-"+e(4)+"-"+e(5)+e(6)+e(7)}Zo=e([si("esri.core.Promise")],Zo);const Ko=i.crypto||i.msCrypto,Yo=/\?(\.|$)/g;function Xo(t,e,i,s){const n=Array.isArray(e)?e:e.indexOf(",")>-1?e.split(","):[e],r=ta(t,e,i,s);for(const e of n){const s=e.trim().replace(Yo,"$1"),n=t.get(s);i.call(t,n,n,s,t)}return r}function ta(t,e,i,s){return t.watch(e,i,s)}function ea(t,e,i,s){return ha(t,e,pa,i,s)}function ia(t,e,i,s){return da(t,e,pa,i,s)}function sa(t,e,i,s){return ha(t,e,fa,i,s)}function na(t,e,i,s){return da(t,e,fa,i,s)}function ra(t,e,i,s){return ha(t,e,ya,i,s)}function oa(t,e,i,s){return da(t,e,ya,i,s)}function aa(t,e,i,s){return ha(t,e,ma,i,s)}function la(t,e,i,s){return da(t,e,ma,i,s)}function ua(t,e,i,s){let n=!1;const r=t.watch(e,((e,s,r,o)=>{n||i.call(t,e,s,r,o)}),s);return{remove(){r.remove()},pause(){n=!0},resume(){n=!1}}}function ca(t,e,i,s,n,r,o){const a={};function l(e){const s=a[e];s&&(r&&r(s.target,e,t,i),s.handle.remove(),delete a[e])}const u=Xo(t,e,((e,r,o)=>{l(o),$i(e)&&(a[o]={handle:zi(e,i,s),target:e},n&&n(e,o,t,i))}),o);return{remove(){u.remove();for(const t in a)l(t)}}}function ha(t,e,i,s,n){const r=t.watch(e,((e,n,r,o)=>{i&&!i(e)||null==s||s.call(t,e,n,r,o)}),n);if(Array.isArray(e))for(const n of e){const r=t.get(n);i&&i(r)&&(null==s||s.call(t,r,r,e,t))}else{const n=t.get(e);i&&i(n)&&(null==s||s.call(t,n,n,e,t))}return r}function da(t,e,i,s,n){const r="function"==typeof s?s:null,o="object"==typeof s?s:null;"boolean"==typeof s&&(n=s);let a,l=!1;function u(){a&&(a.remove(),a=null)}const c=ns();Xi(o,(()=>{u(),c.reject(Hi())}));const h={then:c.promise.then.bind(c.promise),catch:c.promise.catch.bind(c.promise),remove:u};return Object.freeze(h),a=ha(t,e,i,((e,i,s,n)=>{l=!0,u(),r&&r.call(t,e,i,s,n),c.resolve({value:e,oldValue:i,propertyName:s,target:n})}),n),l&&u(),h}function pa(t){return!!t}function fa(t){return!t}function ya(t){return!0===t}function ma(t){return!1===t}const ga=Object.prototype.toString;function va(t){const e="__accessorMetadata__"in t?Tt(t):t;return function(...t){if(t.push(e),"number"==typeof t[2])throw Error("Using @cast has parameter decorator is not supported since 4.16");return wa.apply(this,t)}}function wa(t,e,i,s){ie(t,e).cast=s}function ba(...t){if(3!==t.length||"string"!=typeof t[1])return 1===t.length&&"[object Function]"===ga.call(t[0])?va(t[0]):1===t.length&&"string"==typeof t[0]?function(t){return function(e,i){ie(e,t).cast=e[i]}}(t[0]):void 0}
/*!
 * @esri/arcgis-html-sanitizer - v2.9.0-next.1 - Tue Oct 19 2021 10:19:42 GMT-0400 (Eastern Daylight Time)
 * Copyright (c) 2021 - Environmental Systems Research Institute, Inc.
 * Apache-2.0
 * 
 * js-xss
 * Copyright (c) 2012-2017 Zongmin Lei(雷宗民) <leizongmin@gmail.com>
 * http://ucdok.com
 * MIT License, see https://github.com/leizongmin/js-xss/blob/master/LICENSE for details
 * 
 * Lodash/isPlainObject
 * Copyright (c) JS Foundation and other contributors <https://js.foundation/>
 * MIT License, see https://raw.githubusercontent.com/lodash/lodash/4.17.10-npm/LICENSE for details
 */var Ma=Object.prototype,Sa=Function.prototype.toString,xa=Ma.hasOwnProperty,ka=Sa.call(Object),Ia=Ma.toString,ja=function(t,e){return function(i){return t(e(i))}}(Object.getPrototypeOf,Object),_a={exports:{}},Ta={},Oa={exports:{}},Aa={};function Fa(){return{"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1}}var Ca=/javascript\s*\:/gim;Aa.whiteList={"align-content":!1,"align-items":!1,"align-self":!1,"alignment-adjust":!1,"alignment-baseline":!1,all:!1,"anchor-point":!1,animation:!1,"animation-delay":!1,"animation-direction":!1,"animation-duration":!1,"animation-fill-mode":!1,"animation-iteration-count":!1,"animation-name":!1,"animation-play-state":!1,"animation-timing-function":!1,azimuth:!1,"backface-visibility":!1,background:!0,"background-attachment":!0,"background-clip":!0,"background-color":!0,"background-image":!0,"background-origin":!0,"background-position":!0,"background-repeat":!0,"background-size":!0,"baseline-shift":!1,binding:!1,bleed:!1,"bookmark-label":!1,"bookmark-level":!1,"bookmark-state":!1,border:!0,"border-bottom":!0,"border-bottom-color":!0,"border-bottom-left-radius":!0,"border-bottom-right-radius":!0,"border-bottom-style":!0,"border-bottom-width":!0,"border-collapse":!0,"border-color":!0,"border-image":!0,"border-image-outset":!0,"border-image-repeat":!0,"border-image-slice":!0,"border-image-source":!0,"border-image-width":!0,"border-left":!0,"border-left-color":!0,"border-left-style":!0,"border-left-width":!0,"border-radius":!0,"border-right":!0,"border-right-color":!0,"border-right-style":!0,"border-right-width":!0,"border-spacing":!0,"border-style":!0,"border-top":!0,"border-top-color":!0,"border-top-left-radius":!0,"border-top-right-radius":!0,"border-top-style":!0,"border-top-width":!0,"border-width":!0,bottom:!1,"box-decoration-break":!0,"box-shadow":!0,"box-sizing":!0,"box-snap":!0,"box-suppress":!0,"break-after":!0,"break-before":!0,"break-inside":!0,"caption-side":!1,chains:!1,clear:!0,clip:!1,"clip-path":!1,"clip-rule":!1,color:!0,"color-interpolation-filters":!0,"column-count":!1,"column-fill":!1,"column-gap":!1,"column-rule":!1,"column-rule-color":!1,"column-rule-style":!1,"column-rule-width":!1,"column-span":!1,"column-width":!1,columns:!1,contain:!1,content:!1,"counter-increment":!1,"counter-reset":!1,"counter-set":!1,crop:!1,cue:!1,"cue-after":!1,"cue-before":!1,cursor:!1,direction:!1,display:!0,"display-inside":!0,"display-list":!0,"display-outside":!0,"dominant-baseline":!1,elevation:!1,"empty-cells":!1,filter:!1,flex:!1,"flex-basis":!1,"flex-direction":!1,"flex-flow":!1,"flex-grow":!1,"flex-shrink":!1,"flex-wrap":!1,float:!1,"float-offset":!1,"flood-color":!1,"flood-opacity":!1,"flow-from":!1,"flow-into":!1,font:!0,"font-family":!0,"font-feature-settings":!0,"font-kerning":!0,"font-language-override":!0,"font-size":!0,"font-size-adjust":!0,"font-stretch":!0,"font-style":!0,"font-synthesis":!0,"font-variant":!0,"font-variant-alternates":!0,"font-variant-caps":!0,"font-variant-east-asian":!0,"font-variant-ligatures":!0,"font-variant-numeric":!0,"font-variant-position":!0,"font-weight":!0,grid:!1,"grid-area":!1,"grid-auto-columns":!1,"grid-auto-flow":!1,"grid-auto-rows":!1,"grid-column":!1,"grid-column-end":!1,"grid-column-start":!1,"grid-row":!1,"grid-row-end":!1,"grid-row-start":!1,"grid-template":!1,"grid-template-areas":!1,"grid-template-columns":!1,"grid-template-rows":!1,"hanging-punctuation":!1,height:!0,hyphens:!1,icon:!1,"image-orientation":!1,"image-resolution":!1,"ime-mode":!1,"initial-letters":!1,"inline-box-align":!1,"justify-content":!1,"justify-items":!1,"justify-self":!1,left:!1,"letter-spacing":!0,"lighting-color":!0,"line-box-contain":!1,"line-break":!1,"line-grid":!1,"line-height":!1,"line-snap":!1,"line-stacking":!1,"line-stacking-ruby":!1,"line-stacking-shift":!1,"line-stacking-strategy":!1,"list-style":!0,"list-style-image":!0,"list-style-position":!0,"list-style-type":!0,margin:!0,"margin-bottom":!0,"margin-left":!0,"margin-right":!0,"margin-top":!0,"marker-offset":!1,"marker-side":!1,marks:!1,mask:!1,"mask-box":!1,"mask-box-outset":!1,"mask-box-repeat":!1,"mask-box-slice":!1,"mask-box-source":!1,"mask-box-width":!1,"mask-clip":!1,"mask-image":!1,"mask-origin":!1,"mask-position":!1,"mask-repeat":!1,"mask-size":!1,"mask-source-type":!1,"mask-type":!1,"max-height":!0,"max-lines":!1,"max-width":!0,"min-height":!0,"min-width":!0,"move-to":!1,"nav-down":!1,"nav-index":!1,"nav-left":!1,"nav-right":!1,"nav-up":!1,"object-fit":!1,"object-position":!1,opacity:!1,order:!1,orphans:!1,outline:!1,"outline-color":!1,"outline-offset":!1,"outline-style":!1,"outline-width":!1,overflow:!1,"overflow-wrap":!1,"overflow-x":!1,"overflow-y":!1,padding:!0,"padding-bottom":!0,"padding-left":!0,"padding-right":!0,"padding-top":!0,page:!1,"page-break-after":!1,"page-break-before":!1,"page-break-inside":!1,"page-policy":!1,pause:!1,"pause-after":!1,"pause-before":!1,perspective:!1,"perspective-origin":!1,pitch:!1,"pitch-range":!1,"play-during":!1,position:!1,"presentation-level":!1,quotes:!1,"region-fragment":!1,resize:!1,rest:!1,"rest-after":!1,"rest-before":!1,richness:!1,right:!1,rotation:!1,"rotation-point":!1,"ruby-align":!1,"ruby-merge":!1,"ruby-position":!1,"shape-image-threshold":!1,"shape-outside":!1,"shape-margin":!1,size:!1,speak:!1,"speak-as":!1,"speak-header":!1,"speak-numeral":!1,"speak-punctuation":!1,"speech-rate":!1,stress:!1,"string-set":!1,"tab-size":!1,"table-layout":!1,"text-align":!0,"text-align-last":!0,"text-combine-upright":!0,"text-decoration":!0,"text-decoration-color":!0,"text-decoration-line":!0,"text-decoration-skip":!0,"text-decoration-style":!0,"text-emphasis":!0,"text-emphasis-color":!0,"text-emphasis-position":!0,"text-emphasis-style":!0,"text-height":!0,"text-indent":!0,"text-justify":!0,"text-orientation":!0,"text-overflow":!0,"text-shadow":!0,"text-space-collapse":!0,"text-transform":!0,"text-underline-position":!0,"text-wrap":!0,top:!1,transform:!1,"transform-origin":!1,"transform-style":!1,transition:!1,"transition-delay":!1,"transition-duration":!1,"transition-property":!1,"transition-timing-function":!1,"unicode-bidi":!1,"vertical-align":!1,visibility:!1,"voice-balance":!1,"voice-duration":!1,"voice-family":!1,"voice-pitch":!1,"voice-range":!1,"voice-rate":!1,"voice-stress":!1,"voice-volume":!1,volume:!1,"white-space":!1,widows:!1,width:!0,"will-change":!1,"word-break":!0,"word-spacing":!0,"word-wrap":!0,"wrap-flow":!1,"wrap-through":!1,"writing-mode":!1,"z-index":!1},Aa.getDefaultWhiteList=Fa,Aa.onAttr=function(){},Aa.onIgnoreAttr=function(){},Aa.safeAttrValue=function(t,e){return Ca.test(e)?"":e};var Pa=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},Ea=function(t){return String.prototype.trimRight?t.trimRight():t.replace(/(\s*$)/g,"")},Ra=Aa;function La(t){return null==t}function Na(t){(t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{})).whiteList=t.whiteList||Ra.whiteList,t.onAttr=t.onAttr||Ra.onAttr,t.onIgnoreAttr=t.onIgnoreAttr||Ra.onIgnoreAttr,t.safeAttrValue=t.safeAttrValue||Ra.safeAttrValue,this.options=t}Na.prototype.process=function(t){if(!(t=""+(t=t||"")))return"";var e=this.options,i=e.whiteList,s=e.onAttr,n=e.onIgnoreAttr,r=e.safeAttrValue;return function(t,e){";"!==(t=Ea(t))[t.length-1]&&(t+=";");var i=t.length,s=!1,n=0,r=0,o="";function a(){if(!s){var i=Pa(t.slice(n,r)),a=i.indexOf(":");if(-1!==a){var l=Pa(i.slice(0,a)),u=Pa(i.slice(a+1));if(l){var c=e(n,o.length,l,u,i);c&&(o+=c+"; ")}}}n=r+1}for(;r<i;r++){var l=t[r];if("/"===l&&"*"===t[r+1]){var u=t.indexOf("*/",r+2);if(-1===u)break;n=(r=u+1)+1,s=!1}else"("===l?s=!0:")"===l?s=!1:";"===l?s||a():"\n"===l&&a()}return Pa(o)}(t,(function(t,e,o,a,l){var u=i[o],c=!1;if(!0===u?c=u:"function"==typeof u?c=u(a):u instanceof RegExp&&(c=u.test(a)),!0!==c&&(c=!1),a=r(o,a)){var h,d={position:e,sourcePosition:t,source:l,isWhite:c};return c?La(h=s(o,a,d))?o+":"+a:h:La(h=n(o,a,d))?void 0:h}}))};var Da=Na;!function(t,e){var i=Aa,s=Da;for(var n in(e=t.exports=function(t,e){return new s(e).process(t)}).FilterCSS=s,i)e[n]=i[n]}(Oa,Oa.exports);var Va={indexOf:function(t,e){var i,s;if(Array.prototype.indexOf)return t.indexOf(e);for(i=0,s=t.length;i<s;i++)if(t[i]===e)return i;return-1},forEach:function(t,e,i){var s,n;if(Array.prototype.forEach)return t.forEach(e,i);for(s=0,n=t.length;s<n;s++)e.call(i,t[s],s,t)},trim:function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},spaceIndex:function(t){var e=/\s|\n|\t/.exec(t);return e?e.index:-1}},$a=Oa.exports.getDefaultWhiteList,za=Va;var Ga=new(0,Oa.exports.FilterCSS);function Ua(t){return t.replace(qa,"&lt;").replace(Ba,"&gt;")}var qa=/</g,Ba=/>/g,Wa=/"/g,Ha=/&quot;/g,Ja=/&#([a-zA-Z0-9]*);?/gim,Za=/&colon;?/gim,Qa=/&newline;?/gim,Ka=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,Ya=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,Xa=/u\s*r\s*l\s*\(.*/gi;function tl(t){return t.replace(Wa,"&quot;")}function el(t){return t.replace(Ha,'"')}function il(t){return t.replace(Ja,(function(t,e){return String.fromCharCode("x"===e[0]||"X"===e[0]?parseInt(e.substr(1),16):parseInt(e,10))}))}function sl(t){return t.replace(Za,":").replace(Qa," ")}function nl(t){for(var e="",i=0,s=t.length;i<s;i++)e+=t.charCodeAt(i)<32?" ":t.charAt(i);return za.trim(e)}function rl(t){return nl(t=sl(t=il(t=el(t))))}function ol(t){return Ua(t=tl(t))}Ta.whiteList={a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]},Ta.getDefaultWhiteList=function(){return{a:["target","href","title"],abbr:["title"],address:[],area:["shape","coords","href","alt"],article:[],aside:[],audio:["autoplay","controls","crossorigin","loop","muted","preload","src"],b:[],bdi:["dir"],bdo:["dir"],big:[],blockquote:["cite"],br:[],caption:[],center:[],cite:[],code:[],col:["align","valign","span","width"],colgroup:["align","valign","span","width"],dd:[],del:["datetime"],details:["open"],div:[],dl:[],dt:[],em:[],figcaption:[],figure:[],font:["color","size","face"],footer:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],header:[],hr:[],i:[],img:["src","alt","title","width","height"],ins:["datetime"],li:[],mark:[],nav:[],ol:[],p:[],pre:[],s:[],section:[],small:[],span:[],sub:[],summary:[],sup:[],strong:[],strike:[],table:["width","border","align","valign"],tbody:["align","valign"],td:["width","rowspan","colspan","align","valign"],tfoot:["align","valign"],th:["width","rowspan","colspan","align","valign"],thead:["align","valign"],tr:["rowspan","align","valign"],tt:[],u:[],ul:[],video:["autoplay","controls","crossorigin","loop","muted","playsinline","poster","preload","src","height","width"]}},Ta.onTag=function(){},Ta.onIgnoreTag=function(){},Ta.onTagAttr=function(){},Ta.onIgnoreTagAttr=function(){},Ta.safeAttrValue=function(t,e,i,s){if(i=rl(i),"href"===e||"src"===e){if("#"===(i=za.trim(i)))return"#";if("http://"!==i.substr(0,7)&&"https://"!==i.substr(0,8)&&"mailto:"!==i.substr(0,7)&&"tel:"!==i.substr(0,4)&&"data:image/"!==i.substr(0,11)&&"ftp://"!==i.substr(0,6)&&"./"!==i.substr(0,2)&&"../"!==i.substr(0,3)&&"#"!==i[0]&&"/"!==i[0])return""}else if("background"===e){if(Ka.lastIndex=0,Ka.test(i))return""}else if("style"===e){if(Ya.lastIndex=0,Ya.test(i))return"";if(Xa.lastIndex=0,Xa.test(i)&&(Ka.lastIndex=0,Ka.test(i)))return"";!1!==s&&(i=(s=s||Ga).process(i))}return ol(i)},Ta.escapeHtml=Ua,Ta.escapeQuote=tl,Ta.unescapeQuote=el,Ta.escapeHtmlEntities=il,Ta.escapeDangerHtml5Entities=sl,Ta.clearNonPrintableCharacter=nl,Ta.friendlyAttrValue=rl,Ta.escapeAttrValue=ol,Ta.onIgnoreTagStripAll=function(){return""},Ta.StripTagBody=function(t,e){"function"!=typeof e&&(e=function(){});var i=!Array.isArray(t),s=[],n=!1;return{onIgnoreTag:function(r,o,a){if(function(e){return!!i||-1!==za.indexOf(t,e)}(r)){if(a.isClosing){return s.push([!1!==n?n:a.position,a.position+10]),n=!1,"[/removed]"}return n||(n=a.position),"[removed]"}return e(r,o,a)},remove:function(t){var e="",i=0;return za.forEach(s,(function(s){e+=t.slice(i,s[0]),i=s[1]})),e+=t.slice(i)}}},Ta.stripCommentTag=function(t){for(var e="",i=0;i<t.length;){var s=t.indexOf("\x3c!--",i);if(-1===s){e+=t.slice(i);break}e+=t.slice(i,s);var n=t.indexOf("--\x3e",s);if(-1===n)break;i=n+3}return e},Ta.stripBlankChar=function(t){var e=t.split("");return(e=e.filter((function(t){var e=t.charCodeAt(0);return!(127===e||e<=31&&10!==e&&13!==e)}))).join("")},Ta.cssFilter=Ga,Ta.getDefaultCSSWhiteList=$a;var al={},ll=Va;function ul(t){var e=ll.spaceIndex(t);if(-1===e)var i=t.slice(1,-1);else i=t.slice(1,e+1);return"/"===(i=ll.trim(i).toLowerCase()).slice(0,1)&&(i=i.slice(1)),"/"===i.slice(-1)&&(i=i.slice(0,-1)),i}function cl(t){return"</"===t.slice(0,2)}var hl=/[^a-zA-Z0-9_:\.\-]/gim;function dl(t,e){for(;e<t.length;e++){var i=t[e];if(" "!==i)return"="===i?e:-1}}function pl(t,e){for(;e>0;e--){var i=t[e];if(" "!==i)return"="===i?e:-1}}function fl(t){return function(t){return'"'===t[0]&&'"'===t[t.length-1]||"'"===t[0]&&"'"===t[t.length-1]}(t)?t.substr(1,t.length-2):t}al.parseTag=function(t,e,i){var s="",n=0,r=!1,o=!1,a=0,l=t.length,u="",c="";t:for(a=0;a<l;a++){var h=t.charAt(a);if(!1===r){if("<"===h){r=a;continue}}else if(!1===o){if("<"===h){s+=i(t.slice(n,a)),r=a,n=a;continue}if(">"===h){s+=i(t.slice(n,r)),u=ul(c=t.slice(r,a+1)),s+=e(r,s.length,u,c,cl(c)),n=a+1,r=!1;continue}if('"'===h||"'"===h)for(var d=1,p=t.charAt(a-d);""===p.trim()||"="===p;){if("="===p){o=h;continue t}p=t.charAt(a-++d)}}else if(h===o){o=!1;continue}}return n<t.length&&(s+=i(t.substr(n))),s},al.parseAttr=function(t,e){var i=0,s=[],n=!1,r=t.length;function o(t,i){if(!((t=(t=ll.trim(t)).replace(hl,"").toLowerCase()).length<1)){var n=e(t,i||"");n&&s.push(n)}}for(var a=0;a<r;a++){var l,u=t.charAt(a);if(!1!==n||"="!==u)if(!1===n||a!==i||'"'!==u&&"'"!==u||"="!==t.charAt(a-1)){if(/\s|\n|\t/.test(u)){if(t=t.replace(/\s|\n|\t/g," "),!1===n){if(-1===(l=dl(t,a))){o(ll.trim(t.slice(i,a))),n=!1,i=a+1;continue}a=l-1;continue}if(-1===(l=pl(t,a-1))){o(n,fl(ll.trim(t.slice(i,a)))),n=!1,i=a+1;continue}}}else{if(-1===(l=t.indexOf(u,a+1)))break;o(n,ll.trim(t.slice(i+1,l))),n=!1,i=(a=l)+1}else n=t.slice(i,a),i=a+1}return i<t.length&&(!1===n?o(t.slice(i)):o(n,fl(ll.trim(t.slice(i))))),ll.trim(s.join(" "))};var yl=Oa.exports.FilterCSS,ml=Ta,gl=al.parseTag,vl=al.parseAttr,wl=Va;function bl(t){return null==t}function Ml(t){(t=function(t){var e={};for(var i in t)e[i]=t[i];return e}(t||{})).stripIgnoreTag&&(t.onIgnoreTag&&console.error('Notes: cannot use these two options "stripIgnoreTag" and "onIgnoreTag" at the same time'),t.onIgnoreTag=ml.onIgnoreTagStripAll),t.whiteList=t.whiteList||ml.whiteList,t.onTag=t.onTag||ml.onTag,t.onTagAttr=t.onTagAttr||ml.onTagAttr,t.onIgnoreTag=t.onIgnoreTag||ml.onIgnoreTag,t.onIgnoreTagAttr=t.onIgnoreTagAttr||ml.onIgnoreTagAttr,t.safeAttrValue=t.safeAttrValue||ml.safeAttrValue,t.escapeHtml=t.escapeHtml||ml.escapeHtml,this.options=t,!1===t.css?this.cssFilter=!1:(t.css=t.css||{},this.cssFilter=new yl(t.css))}Ml.prototype.process=function(t){if(!(t=""+(t=t||"")))return"";var e=this.options,i=e.whiteList,s=e.onTag,n=e.onIgnoreTag,r=e.onTagAttr,o=e.onIgnoreTagAttr,a=e.safeAttrValue,l=e.escapeHtml,u=this.cssFilter;e.stripBlankChar&&(t=ml.stripBlankChar(t)),e.allowCommentTag||(t=ml.stripCommentTag(t));var c=!1;e.stripIgnoreTagBody&&(c=ml.StripTagBody(e.stripIgnoreTagBody,n),n=c.onIgnoreTag);var h=gl(t,(function(t,e,c,h,d){var p,f={sourcePosition:t,position:e,isClosing:d,isWhite:i.hasOwnProperty(c)};if(!bl(p=s(c,h,f)))return p;if(f.isWhite){if(f.isClosing)return"</"+c+">";var y=function(t){var e=wl.spaceIndex(t);if(-1===e)return{html:"",closing:"/"===t[t.length-2]};var i="/"===(t=wl.trim(t.slice(e+1,-1)))[t.length-1];return i&&(t=wl.trim(t.slice(0,-1))),{html:t,closing:i}}(h),m=i[c],g=vl(y.html,(function(t,e){var i,s=-1!==wl.indexOf(m,t);return bl(i=r(c,t,e,s))?s?(e=a(c,t,e,u))?t+'="'+e+'"':t:bl(i=o(c,t,e,s))?void 0:i:i}));return h="<"+c,g&&(h+=" "+g),y.closing&&(h+=" /"),h+">"}return bl(p=n(c,h,f))?l(h):p}),l);return c&&(h=c.remove(h)),h};var Sl=Ml;!function(t,e){var i=Ta,s=al,n=Sl;function r(t,e){return new n(e).process(t)}for(var o in(e=t.exports=r).filterXSS=r,e.FilterXSS=n,i)e[o]=i[o];for(var o in s)e[o]=s[o];"undefined"!=typeof self&&"undefined"!=typeof DedicatedWorkerGlobalScope&&self instanceof DedicatedWorkerGlobalScope&&(self.filterXSS=t.exports)}(_a,_a.exports);var xl,kl,Il=function(){function t(t,e){var i,s=this;this.arcgisWhiteList={a:["href","style","target"],abbr:["title"],audio:["autoplay","controls","loop","muted","preload"],b:[],br:[],dd:["style"],div:["align","style"],dl:["style"],dt:["style"],em:[],figcaption:["style"],figure:["style"],font:["color","face","size","style"],h1:["style"],h2:["style"],h3:["style"],h4:["style"],h5:["style"],h6:["style"],hr:[],i:[],img:["alt","border","height","src","style","width"],li:[],ol:[],p:["style"],source:["media","src","type"],span:["style"],strong:[],sub:["style"],sup:["style"],table:["border","cellpadding","cellspacing","height","style","width"],tbody:[],tr:["align","height","style","valign"],td:["align","colspan","height","nowrap","rowspan","style","valign","width"],th:["align","colspan","height","nowrap","rowspan","style","valign","width"],u:[],ul:[],video:["autoplay","controls","height","loop","muted","poster","preload","width"]},this.allowedProtocols=["http","https","mailto","iform","tel","flow","lfmobile","arcgis-navigator","arcgis-appstudio-player","arcgis-survey123","arcgis-collector","arcgis-workforce","arcgis-explorer","arcgis-trek2there","arcgis-quickcapture","mspbi","comgooglemaps","pdfefile","pdfehttp","pdfehttps","boxapp","boxemm","awb","awbs","gropen","radarscope"],this.arcgisFilterOptions={allowCommentTag:!0,safeAttrValue:function(t,e,i,n){return"a"===t&&"href"===e||("img"===t||"source"===t)&&"src"===e?s.sanitizeUrl(i):_a.exports.safeAttrValue(t,e,i,n)}},t&&!e?i=t:t&&e?(i=Object.create(this.arcgisFilterOptions),Object.keys(t).forEach((function(e){"whiteList"===e?i.whiteList=s._extendObjectOfArrays([s.arcgisWhiteList,t.whiteList||{}]):i[e]=t[e]}))):(i=Object.create(this.arcgisFilterOptions)).whiteList=this.arcgisWhiteList,this.xssFilterOptions=i,this._xssFilter=new _a.exports.FilterXSS(i)}return t.prototype.sanitize=function(t,e){switch(void 0===e&&(e={}),typeof t){case"number":return isNaN(t)||!isFinite(t)?null:t;case"boolean":return t;case"string":return this._xssFilter.process(t);case"object":return this._iterateOverObject(t,e);default:if(e.allowUndefined&&void 0===t)return;return null}},t.prototype.sanitizeUrl=function(t){var e=this._trim(t.substring(0,t.indexOf(":")));return"/"===t||"#"===t||"#"===t[0]||this.allowedProtocols.indexOf(e.toLowerCase())>-1?_a.exports.escapeAttrValue(t):""},t.prototype.sanitizeHTMLAttribute=function(t,e,i,s){return"function"==typeof this.xssFilterOptions.safeAttrValue?this.xssFilterOptions.safeAttrValue(t,e,i,s):_a.exports.safeAttrValue(t,e,i,s)},t.prototype.validate=function(t,e){void 0===e&&(e={});var i=this.sanitize(t,e);return{isValid:t===i,sanitized:i}},t.prototype._extendObjectOfArrays=function(t){var e={};return t.forEach((function(t){Object.keys(t).forEach((function(i){e[i]=Array.isArray(t[i])&&Array.isArray(e[i])?e[i].concat(t[i]):t[i]}))})),e},t.prototype._iterateOverObject=function(t,e){var i=this;void 0===e&&(e={});try{var s=!1,n=void 0;if(Array.isArray(t))n=t.reduce((function(t,n){var r=i.validate(n,e);return r.isValid?t.concat([n]):(s=!0,t.concat([r.sanitized]))}),[]);else{if(!function(t){if(!function(t){return!!t&&"object"==typeof t}(t)||"[object Object]"!=Ia.call(t)||function(t){var e=!1;if(null!=t&&"function"!=typeof t.toString)try{e=!!(t+"")}catch(t){}return e}(t))return!1;var e=ja(t);if(null===e)return!0;var i=xa.call(e,"constructor")&&e.constructor;return"function"==typeof i&&i instanceof i&&Sa.call(i)==ka}(t)){if(e.allowUndefined&&void 0===t)return;return null}n=Object.keys(t).reduce((function(n,r){var o=t[r],a=i.validate(o,e);return a.isValid?n[r]=o:(s=!0,n[r]=a.sanitized),n}),{})}return s?n:t}catch(t){return null}},t.prototype._trim=function(t){return String.prototype.trim?t.trim():t.replace(/(^\s*)|(\s*$)/g,"")},t}(),jl=function(t){xl||function(t){if("WebkitTransition"in t.style)xl="webkitTransitionEnd",kl="webkitAnimationEnd";else{if(!("transition"in t.style))throw Error("Your browser is not supported!");xl="transitionend",kl="animationend"}}(t)},_l=function(t,e){return void 0===e&&(e=t+"-active"),function(i){jl(i);var s=!1,n=function(){s||(s=!0,i.removeEventListener(xl,n),i.removeEventListener(kl,n),i.classList.remove(t),i.classList.remove(e))};i.classList.add(t),i.addEventListener(xl,n),i.addEventListener(kl,n),requestAnimationFrame((function(){i.classList.add(e)}))}},Tl=function(t,e){return void 0===e&&(e=t+"-active"),function(i,s){jl(i);var n=!1,r=function(){n||(n=!0,i.removeEventListener(xl,r),i.removeEventListener(kl,r),s())};i.classList.add(t),i.addEventListener(xl,r),i.addEventListener(kl,r),requestAnimationFrame((function(){i.classList.add(e)}))}};function Ol(t){const e=Ar.acquire();for(let t=0;t<arguments.length;t++){const i=arguments[t],s=typeof i;if("string"===s)e.push(i);else if(Array.isArray(i))e.push.apply(e,i);else if("object"===s)for(const t in i)i[t]&&e.push(t)}const i=e.join(" ");return Ar.release(e),i}function Al(t){const e=null==t?void 0:t.closest("[dir]");return null!==e&&e instanceof HTMLElement&&"rtl"===e.dir||"rtl"===document.dir}function Fl(t){this[t.getAttribute("data-node-ref")]=null}function Cl(t){this[t.getAttribute("data-node-ref")]=t}function Pl(t,e){return("enter"===t?_l:Tl)(e)}ct.getLogger("esri.widgets.support.widgetUtils");const El=["dd","dl","dt","h1","h2","h3","h4","h5","h6","sub","sup","animate","animatetransform","circle","clippath","defs","ellipse","g","image","line","lineargradient","marker","mask","path","pattern","polygon","polyline","radialgradient","rect","stop","svg","switch","symbol","text","textpath","tspan","use"].reduce(((t,e)=>(t[e]=[],t)),{}),Rl=["align","alink","alt","bgcolor","border","cellpadding","cellspacing","class","color","cols","colspan","coords","dir","face","height","hspace","ismap","lang","marginheight","marginwidth","multiple","nohref","noresize","noshade","nowrap","ref","rel","rev","rows","rowspan","scrolling","shape","span","summary","tabindex","title","usemap","valign","value","vlink","vspace","width"],Ll=new Il({whiteList:El,onTagAttr:(t,e,i)=>{const s=`${e}="${i}"`;if(Rl.includes(e))return s},stripIgnoreTag:!0,stripIgnoreTagBody:["script","style"]},!0);function Nl(t,e){const i=t.getBoundingClientRect(),s=e.getBoundingClientRect();(i.top+i.height>s.top+s.height||i.top<s.top)&&t.scrollIntoView({block:"end"})}function Dl(t){return"Enter"===t||" "===t}function Vl(){return getComputedStyle(document.body).getPropertyValue("--esri-calcite-theme-name").replace(/\s|'|"/g,"")}function $l(){return Vl().startsWith("dark")}const zl="http://www.w3.org/",Gl=zl+"2000/svg",Ul=zl+"1999/xlink";let ql,Bl=[],Wl=(t,e)=>{let i={};return Object.keys(t).forEach((e=>{i[e]=t[e]})),e&&Object.keys(e).forEach((t=>{i[t]=e[t]})),i},Hl=(t,e)=>t.vnodeSelector===e.vnodeSelector&&(t.properties&&e.properties?t.properties.key===e.properties.key&&t.properties.bind===e.properties.bind:!t.properties&&!e.properties),Jl=t=>{if("string"!=typeof t)throw Error("Style values must be strings")},Zl=(t,e,i)=>{if(""!==e.vnodeSelector)for(let s=i;s<t.length;s++)if(Hl(t[s],e))return s;return-1},Ql=(t,e,i,s)=>{let n=t[e];if(""===n.vnodeSelector)return;let r=n.properties;if(!(r?void 0===r.key?r.bind:r.key:void 0))for(let r=0;r<t.length;r++)if(r!==e&&Hl(t[r],n))throw Error(`${i.vnodeSelector} had a ${n.vnodeSelector} child ${"added"===s?s:"removed"}, but there is now more than one. You must add unique key properties to make them distinguishable.`)},Kl=t=>{if(t.properties){let e=t.properties.enterAnimation;e&&e(t.domNode,t.properties)}},Yl=[],Xl=!1,tu=t=>{(t.children||[]).forEach(tu),t.properties&&t.properties.afterRemoved&&t.properties.afterRemoved.call(t.properties.bind||t.properties,t.domNode)},eu=()=>{Xl=!1,Yl.forEach(tu),Yl.length=0},iu=t=>{Yl.push(t),Xl||(Xl=!0,"undefined"!=typeof window&&"requestIdleCallback"in window?window.requestIdleCallback(eu,{timeout:16}):setTimeout(eu,16))},su=t=>{let e=t.domNode;if(t.properties){let i=t.properties.exitAnimation;if(i){e.style.pointerEvents="none";let s=()=>{e.parentNode&&(e.parentNode.removeChild(e),iu(t))};return void i(e,s,t.properties)}}e.parentNode&&(e.parentNode.removeChild(e),iu(t))},nu=(t,e,i)=>{if(!e)return;let s=i.eventHandlerInterceptor,n=Object.keys(e),r=n.length;for(let o=0;o<r;o++){let r=n[o],a=e[r];if("className"===r)throw Error('Property "className" is not supported, use "class".');if("class"===r)au(t,a,!0);else if("classes"===r){let e=Object.keys(a),i=e.length;for(let s=0;s<i;s++){let i=e[s];a[i]&&t.classList.add(i)}}else if("styles"===r){let e=Object.keys(a),s=e.length;for(let n=0;n<s;n++){let s=e[n],r=a[s];r&&(Jl(r),i.styleApplyer(t,s,r))}}else if("key"!==r&&null!=a){let n=typeof a;"function"===n?(0===r.lastIndexOf("on",0)&&(s&&(a=s(r,a,t,e)),"oninput"===r&&function(){let t=a;a=function(e){t.call(this,e),e.target["oninput-value"]=e.target.value}}()),t[r]=a):i.namespace===Gl?"href"===r?t.setAttributeNS(Ul,r,a):t.setAttribute(r,a):"string"===n&&"value"!==r?"innerHTML"===r?t[r]=Ll.sanitize(a):t.setAttribute(r,a):t[r]=a}}},ru=(t,e,i)=>{((t,e,i)=>{if(e)for(let s of e)ou(s,t,void 0,i)})(t,e.children,i),e.text&&(t.textContent=e.text),nu(t,e.properties,i),e.properties&&e.properties.afterCreate&&e.properties.afterCreate.call(e.properties.bind||e.properties,t,i,e.vnodeSelector,e.properties,e.children)},ou=(t,e,i,s)=>{let n,r=0,o=t.vnodeSelector,a=e.ownerDocument;if(""===o)n=t.domNode=a.createTextNode(t.text),void 0!==i?e.insertBefore(n,i):e.appendChild(n);else{for(let l=0;l<=o.length;++l){let u=o.charAt(l);if(l===o.length||"."===u||"#"===u){let u=o.charAt(r-1),c=o.slice(r,l);"."===u?n.classList.add(c):"#"===u?n.id=c:("svg"===c&&(s=Wl(s,{namespace:Gl})),void 0!==s.namespace?n=t.domNode=a.createElementNS(s.namespace,c):(n=t.domNode=t.domNode||a.createElement(c),"input"===c&&t.properties&&void 0!==t.properties.type&&n.setAttribute("type",t.properties.type)),void 0!==i?e.insertBefore(n,i):n.parentNode!==e&&e.appendChild(n)),r=l+1}}ru(n,t,s)}},au=(t,e,i)=>{e&&e.split(" ").forEach((e=>{e&&t.classList.toggle(e,i)}))};ql=(t,e,i)=>{let s=t.domNode,n=!1;if(t===e)return!1;let r=!1;if(""===e.vnodeSelector){if(e.text!==t.text){let t=s.ownerDocument.createTextNode(e.text);return s.parentNode.replaceChild(t,s),e.domNode=t,n=!0,n}e.domNode=s}else 0===e.vnodeSelector.lastIndexOf("svg",0)&&(i=Wl(i,{namespace:Gl})),t.text!==e.text&&(r=!0,void 0===e.text?s.removeChild(s.firstChild):s.textContent=e.text),e.domNode=s,r=((t,e,i,s,n)=>{if(i===s)return!1;let r,o=(i=i||Bl).length,a=(s=s||Bl).length,l=0,u=0,c=!1;for(;u<a;){let a=l<o?i[l]:void 0,h=s[u];if(void 0!==a&&Hl(a,h))c=ql(a,h,n)||c,l++;else{let a=Zl(i,h,l+1);if(a>=0){for(r=l;r<a;r++)su(i[r]),Ql(i,r,t,"removed");c=ql(i[a],h,n)||c,l=a+1}else ou(h,e,l<o?i[l].domNode:void 0,n),Kl(h),Ql(s,u,t,"added")}u++}if(o>l)for(r=l;r<o;r++)su(i[r]),Ql(i,r,t,"removed");return c})(e,s,t.children,e.children,i)||r,r=((t,e,i,s)=>{if(!i)return;let n=!1,r=Object.keys(i),o=r.length;for(let a=0;a<o;a++){let o=r[a],l=i[o],u=e[o];if("class"===o)u!==l&&(au(t,u,!1),au(t,l,!0));else if("classes"===o){let e=t.classList,i=Object.keys(l),s=i.length;for(let t=0;t<s;t++){let s=i[t],r=!!l[s];r!==!!u[s]&&(n=!0,r?e.add(s):e.remove(s))}}else if("styles"===o){let e=Object.keys(l),i=e.length;for(let r=0;r<i;r++){let i=e[r],o=l[i];o!==u[i]&&(n=!0,o?(Jl(o),s.styleApplyer(t,i,o)):s.styleApplyer(t,i,""))}}else if(l||"string"!=typeof u||(l=""),"value"===o){let e=t[o];e!==l&&(t["oninput-value"]?e===t["oninput-value"]:l!==u)&&(t[o]=l,t["oninput-value"]=void 0),l!==u&&(n=!0)}else if(l!==u){let e=typeof l;"function"===e&&s.eventHandlerInterceptor||(s.namespace===Gl?"href"===o?t.setAttributeNS(Ul,o,l):t.setAttribute(o,l):"string"===e?"innerHTML"===o?t[o]=Ll.sanitize(l):"role"===o&&""===l?t.removeAttribute(o):t.setAttribute(o,l):t[o]!==l&&(t[o]=l),n=!0)}}return n})(s,t.properties,e.properties,i)||r,e.properties&&e.properties.afterUpdate&&e.properties.afterUpdate.call(e.properties.bind||e.properties,s,i,e.vnodeSelector,e.properties,e.children);return r&&e.properties&&e.properties.updateAnimation&&e.properties.updateAnimation(s,e.properties,t.properties),n};let lu=(t,e)=>({getLastRender:()=>t,update:i=>{if(t.vnodeSelector!==i.vnodeSelector)throw Error("The selector for the root VNode may not be changed. (consider using dom.merge and add one extra level to the virtual DOM)");let s=t;t=i,ql(s,i,e)},domNode:t.domNode});const uu={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{"-"===e.charAt(0)?t.style.setProperty(e,i):t.style[e]=i}};let cu,hu=t=>Wl(uu,t),du=(t,e,i)=>(i=hu(i),ou(e,t,void 0,i),lu(e,i)),pu=(t,e,i)=>(i=hu(i),ou(e,t.parentNode,t,i),lu(e,i)),fu=(t,e,i)=>(i=hu(i),e.domNode=t,ru(t,e,i),lu(e,i)),yu=(t,e,i)=>(i=hu(i),ou(e,t.parentNode,t,i),t.parentNode.removeChild(t),lu(e,i)),mu=(t,e)=>{let i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i};cu=Array.prototype.find?(t,e)=>t.find(e):(t,e)=>t.filter(e)[0];let gu=(t,e)=>{let i=t;return e.forEach((t=>{i=i&&i.children?cu(i.children,(e=>e.domNode===t)):void 0})),i},vu=(t,e,i)=>{let s=function(s){i("domEvent",s);let n=e(),r=mu(s.currentTarget,n.domNode);r.reverse();let o,a=gu(n.getLastRender(),r);return t.scheduleRender(),a&&(o=a.properties["on"+s.type].apply(a.properties.bind||this,arguments)),i("domEventProcessed",s),o};return()=>s},wu=t=>{let e,i,s=hu(t),n=s.performanceLogger,r=!0,o=!1,a=[],l=[],u=(t,i,r)=>{let o;s.eventHandlerInterceptor=vu(e,(()=>o),n),o=t(i,r(),s),a.push(o),l.push(r)},c=()=>{if(i=void 0,r){r=!1,n("renderStart",void 0);for(let t=0;t<a.length;t++){let e=l[t]();n("rendered",void 0),a[t].update(e),n("patched",void 0)}n("renderDone",void 0),r=!0}};return e={renderNow:c,scheduleRender:()=>{i||o||(i=requestAnimationFrame(c))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),o=!0},resume:()=>{o=!1,r=!0,e.scheduleRender()},append:(t,e)=>{u(du,t,e)},insertBefore:(t,e)=>{u(pu,t,e)},merge:(t,e)=>{u(fu,t,e)},replace:(t,e)=>{u(yu,t,e)},detach:t=>{for(let e=0;e<l.length;e++)if(l[e]===t)return l.splice(e,1),a.splice(e,1)[0];throw Error("renderFunction was not found")}},e};const bu={handleInterceptedEvent:(t,e,i,s)=>(t.scheduleRender(),e.properties["on"+s.type].call(e.properties.bind||i,s))},Mu={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(t,e,i)=>{t.style[e]=i}},Su=(t,e,i=!1)=>{let s=t;return e.forEach(((t,n)=>{var r;const o=null!=(r=s)&&r.children?((t,e)=>t.find(e))(s.children,(e=>e.domNode===t)):void 0;i&&!o&&n!==e.length-1||(s=o)})),s};let xu=!1;const ku="undefined"!=typeof window?window:{},Iu=ku.document||{head:{}},ju={o:0,M:"",jmp:t=>t(),raf:t=>requestAnimationFrame(t),ael:(t,e,i,s)=>t.addEventListener(e,i,s),rel:(t,e,i,s)=>t.removeEventListener(e,i,s),ce:(t,e)=>new CustomEvent(t,e)},_u=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replace}catch(t){}return!1})(),Tu=new WeakMap,Ou=t=>"sc-"+t.S,Au={},Fu=t=>"object"==(t=typeof t)||"function"===t,Cu=(t,e,...i)=>{let s=null,n=!1,r=!1,o=[];const a=e=>{for(let i=0;i<e.length;i++)s=e[i],Array.isArray(s)?a(s):null!=s&&"boolean"!=typeof s&&((n="function"!=typeof t&&!Fu(s))&&(s+=""),n&&r?o[o.length-1].I+=s:o.push(n?Pu(null,s):s),r=n)};if(a(i),e){const t=e.className||e.class;t&&(e.class="object"!=typeof t?t:Object.keys(t).filter((e=>t[e])).join(" "))}const l=Pu(t,null);return l._=e,o.length>0&&(l.T=o),l},Pu=(t,e)=>({o:0,O:t,I:e,A:null,T:null,_:null}),Eu={},Ru=(t,e,i,s)=>{if(i!==s&&(e.toLowerCase(),"class"===e)){const e=t.classList,n=Nu(i),r=Nu(s);e.remove(...n.filter((t=>t&&!r.includes(t)))),e.add(...r.filter((t=>t&&!n.includes(t))))}},Lu=/\s/,Nu=t=>t?t.split(Lu):[],Du=(t,e,i,s)=>{const n=11===e.A.nodeType&&e.A.host?e.A.host:e.A,r=t&&t._||Au,o=e._||Au;for(s in r)s in o||Ru(n,s,r[s],void 0);for(s in o)Ru(n,s,r[s],o[s])},Vu=(t,e,i)=>{let s,n,r=e.T[i],o=0;if(s=r.A=Iu.createElement(r.O),Du(null,r),r.T)for(o=0;o<r.T.length;++o)n=Vu(t,r,o),n&&s.appendChild(n);return s},$u=(t,e,i,s,n,r)=>{let o,a=t;for(;n<=r;++n)s[n]&&(o=Vu(null,i,n),o&&(s[n].A=o,a.insertBefore(o,e)))},zu=(t,e,i,s)=>{for(;e<=i;++e)(s=t[e])&&s.A.remove()},Gu=(t,e)=>t.O===e.O,Uu=(t,e)=>{const i=e.A=t.A,s=t.T,n=e.T;Du(t,e),null!==s&&null!==n?((t,e,i,s)=>{let n,r=0,o=0,a=e.length-1,l=e[0],u=e[a],c=s.length-1,h=s[0],d=s[c];for(;r<=a&&o<=c;)null==l?l=e[++r]:null==u?u=e[--a]:null==h?h=s[++o]:null==d?d=s[--c]:Gu(l,h)?(Uu(l,h),l=e[++r],h=s[++o]):Gu(u,d)?(Uu(u,d),u=e[--a],d=s[--c]):Gu(l,d)?(Uu(l,d),t.insertBefore(l.A,u.A.nextSibling),l=e[++r],d=s[--c]):Gu(u,h)?(Uu(u,h),t.insertBefore(u.A,l.A),u=e[--a],h=s[++o]):(n=Vu(e&&e[o],i,o),h=s[++o],n&&l.A.parentNode.insertBefore(n,l.A));r>a?$u(t,null==s[c+1]?null:s[c+1].A,i,s,o,c):o>c&&zu(e,r,a)})(i,s,e,n):null!==n?$u(i,null,e,n,0,n.length-1):null!==s&&zu(s,0,s.length-1)},qu=(t,e,i)=>{const s=(t=>ac(t).F)(t);return{emit:t=>Bu(s,e,{bubbles:!!(4&i),composed:!!(2&i),cancelable:!!(1&i),detail:t})}},Bu=(t,e,i)=>{const s=ju.ce(e,i);return t.dispatchEvent(s),s},Wu=(t,e)=>{e&&!t.C&&e["s-p"]&&e["s-p"].push(new Promise((e=>t.C=e)))},Hu=(t,e)=>{if(t.o|=16,!(4&t.o))return Wu(t,t.P),wc((()=>Ju(t,e)));t.o|=512},Ju=(t,e)=>{const i=t.R;let s;return e&&(s=Xu(i,"componentWillLoad")),tc(s,(()=>Zu(t,i,e)))},Zu=async(t,e,i)=>{const s=t.F,n=s["s-rc"];i&&(t=>{const e=t.L;((t,e)=>{let i=Ou(e),s=dc.get(i);if(t=11===t.nodeType?t:Iu,s)if("string"==typeof s){let e,n=Tu.get(t=t.head||t);n||Tu.set(t,n=new Set),n.has(i)||(e=Iu.createElement("style"),e.innerHTML=s,t.insertBefore(e,t.querySelector("link")),n&&n.add(i))}else t.adoptedStyleSheets.includes(s)||(t.adoptedStyleSheets=[...t.adoptedStyleSheets,s])})(t.F.getRootNode(),e)})(t);Qu(t,e),n&&(n.map((t=>t())),s["s-rc"]=void 0);{const e=s["s-p"],i=()=>Ku(t);0===e.length?i():(Promise.all(e).then(i),t.o|=4,e.length=0)}},Qu=(t,e)=>{try{e=e.render(),t.o&=-17,t.o|=2,((t,e)=>{const i=t.F,s=t.N||Pu(null,null),n=(t=>t&&t.O===Eu)(e)?e:Cu(null,null,e);n.O=null,n.o|=4,t.N=n,n.A=s.A=i,Uu(s,n)})(t,e)}catch(e){uc(e,t.F)}return null},Ku=t=>{const e=t.F,i=t.P;Xu(t.R,"componentDidRender"),64&t.o||(t.o|=64,ec(e),t.D(e),i||Yu()),t.C&&(t.C(),t.C=void 0),512&t.o&&vc((()=>Hu(t,!1))),t.o&=-517},Yu=()=>{ec(Iu.documentElement),vc((()=>Bu(ku,"appload",{detail:{namespace:t}})))},Xu=(t,e,i)=>{if(t&&t[e])try{return t[e](i)}catch(t){uc(t)}},tc=(t,e)=>t&&t.then?t.then(e):e(),ec=t=>t.classList.add("hydrated"),ic=(t,e,i)=>{if(e.V){t.watchers&&(e.$=t.watchers);const s=Object.entries(e.V),n=t.prototype;if(s.map((([t,[s]])=>{(31&s||2&i&&32&s)&&Object.defineProperty(n,t,{get(){return((t,e)=>ac(this).G.get(e))(0,t)},set(i){((t,e,i,s)=>{const n=ac(t),r=n.F,o=n.G.get(e),a=n.o,l=n.R;if(i=((t,e)=>null==t||Fu(t)?t:2&e?parseFloat(t):1&e?t+"":t)(i,s.V[e][0]),!(8&a&&void 0!==o||i===o)&&(n.G.set(e,i),l)){if(s.$&&128&a){const t=s.$[e];t&&t.map((t=>{try{l[t](i,o,e)}catch(t){uc(t,r)}}))}2==(18&a)&&Hu(n,!1)}})(this,t,i,e)},configurable:!0,enumerable:!0})})),1&i){const e=new Map;n.attributeChangedCallback=function(t,i,s){ju.jmp((()=>{const i=e.get(t);this.hasOwnProperty(i)&&(s=this[i],delete this[i]),this[i]=(null!==s||"boolean"!=typeof this[i])&&s}))},t.observedAttributes=s.filter((([t,e])=>15&e[0])).map((([t,i])=>{const s=i[1]||t;return e.set(s,t),s}))}}return t},sc=(t,e)=>{const i={o:e[0],S:e[1]};return i.V=e[2],i.$=t.$,Object.assign(t.prototype,{__registerHost(){lc(this,i)},connectedCallback(){(t=>{if(0==(1&ju.o)){const e=ac(t),i=e.L,s=()=>{};if(!(1&e.o)){e.o|=1;{let i=t;for(;i=i.parentNode||i.host;)if(i["s-p"]){Wu(e,e.P=i);break}}i.V&&Object.entries(i.V).map((([e,[i]])=>{if(31&i&&t.hasOwnProperty(e)){const i=t[e];delete t[e],t[e]=i}})),(async(t,e,i,s,n)=>{if(0==(32&e.o)){{if(e.o|=32,(n=hc(i)).then){const t=()=>{};n=await n,t()}n.isProxied||(i.$=n.watchers,ic(n,i,2),n.isProxied=!0);const t=()=>{};e.o|=8;try{new n(e)}catch(t){uc(t)}e.o&=-9,e.o|=128,t()}if(n.style){let t=n.style;const e=Ou(i);if(!dc.has(e)){const s=()=>{};((t,e,i)=>{let s=dc.get(t);_u&&i?(s=s||new CSSStyleSheet,s.replace(e)):s=e,dc.set(t,s)})(e,t,!!(1&i.o)),s()}}}const r=e.P,o=()=>Hu(e,!0);r&&r["s-rc"]?r["s-rc"].push(o):o()})(0,e,i)}s()}})(this)},disconnectedCallback(){}}),t.is=i.S,ic(t,i,3)},nc=t=>{t.attachShadow({mode:"open"})},rc=t=>{const e=new URL(t,ju.M);return e.origin!==ku.location.origin?e.href:e.pathname},oc=new WeakMap,ac=t=>oc.get(t),lc=(t,e)=>{const i={o:0,F:t,L:e,G:new Map};return i.U=new Promise((t=>i.D=t)),t["s-p"]=[],t["s-rc"]=[],oc.set(t,i)},uc=(t,e)=>(0,console.error)(t,e),cc=new Map,hc=t=>{const e=t.S.replace(/-/g,"_"),i=t.B,s=cc.get(i);return s?s[e]:import(`./${i}.entry.js`).then((t=>(cc.set(i,t),t[e])),uc)},dc=new Map,pc=[],fc=[],yc=(t,e)=>i=>{t.push(i),xu||(xu=!0,e&&4&ju.o?vc(gc):ju.raf(gc))},mc=t=>{for(let e=0;e<t.length;e++)try{t[e](performance.now())}catch(t){uc(t)}t.length=0},gc=()=>{mc(pc),mc(fc),(xu=pc.length>0)&&ju.raf(gc)},vc=t=>Promise.resolve(void 0).then(t),wc=yc(fc,!0);let bc;bc="components/assets";const Mc=Symbol("widget"),Sc=[],xc={},kc=new WeakMap;function Ic(t,e){let i=e.children;if(i&&i.length)for(let e=0;e<i.length;++e)i[e]=Ic(t,i[e]);else i=Sc;const s=e.vnodeSelector;if(Oc(s)){const n=e.properties||xc,r=n.key||s;return{vnodeSelector:"div",properties:{key:r,afterCreate:jc,afterUpdate:_c,afterRemoved:Tc,parentWidget:t,widgetConstructor:s,widgetProperties:{...n,key:r,children:i}},children:void 0,text:void 0,domNode:null}}return e}function jc(t,e,i,{parentWidget:s,widgetConstructor:n,widgetProperties:r}){const o=new n(r);o.container=t,kc.set(t,o),null==o.afterCreate||o.afterCreate(o,t),s._internalHandles.add(zt((()=>Tc(t))))}function _c(t,e,i,{widgetProperties:s}){const n=kc.get(t);n&&(n.set(s),null==n.afterUpdate||n.afterUpdate(n,t))}function Tc(t){const e=kc.get(t);e&&(e.destroy(),kc.delete(t))}function Oc(t){return"function"==typeof t&&t[Mc]}const Ac="esri.widgets.Widget",Fc=ct.getLogger(Ac);let Cc=0;const Pc=new Map;function Ec(t,e){for(const i in e)null!=t[i]&&("object"==typeof t[i]&&"object"==typeof e[i]?Ec(t[i],e[i]):t[i]=e[i]);return t}const Rc=(t=>{let e;const i={...bu,...t},s=(t=>({...Mu,...t}))(i),n=s.performanceLogger;let r,o=!0,a=!1;const l=[],u=[],c=(t,r,o)=>{let a;s.eventHandlerInterceptor=()=>function(t){let s;n("domEvent",t);const r=((t,e)=>{const i=[];for(;t&&t!==e;)i.push(t),t=t.parentNode;return i})(t.currentTarget,a.domNode),o=r.some((t=>{var e;return customElements.get(null==t||null==(e=t.tagName)?void 0:e.toLowerCase())}));if(t.eventPhase!==Event.CAPTURING_PHASE&&o){const e=t.composedPath(),i=e.slice(e.indexOf(t.currentTarget),e.indexOf(a.domNode)).filter((t=>t.getRootNode()===t.ownerDocument)).reverse();s=Su(a.getLastRender(),i,!0)}else r.reverse(),s=Su(a.getLastRender(),r);let l;return s&&(l=i.handleInterceptedEvent(e,s,this,t)),n("domEventProcessed",t),l},null==i.postProcessProjectionOptions||i.postProcessProjectionOptions(s);const c=o();a=t(r,c,s),l.push(a),u.push(o),i.afterFirstVNodeRendered&&i.afterFirstVNodeRendered(a,c)};let h=()=>{if(r=void 0,o){o=!1,n("renderStart",void 0);for(let t=0;t<l.length;t++){const e=u[t]();n("rendered",void 0),l[t].update(e),n("patched",void 0)}n("renderDone",void 0),o=!0}};return i.modifyDoRenderImplementation&&(h=i.modifyDoRenderImplementation(h,l,u)),e={renderNow:h,scheduleRender:()=>{r||a||(r=requestAnimationFrame(h))},stop:()=>{r&&(cancelAnimationFrame(r),r=void 0),a=!0},resume:()=>{a=!1,o=!0,e.scheduleRender()},append:(t,e)=>{c(du,t,e)},insertBefore:(t,e)=>{c(pu,t,e)},merge:(t,e)=>{c(fu,t,e)},replace:(t,e)=>{c(yu,t,e)},detach:t=>{for(let e=0;e<u.length;e++)if(u[e]===t)return u.splice(e,1),l.splice(e,1)[0];throw Error("renderFunction was not found")}},e})({postProcessProjectionOptions(t){const e=t.eventHandlerInterceptor,i=/capture$/i;t.eventHandlerInterceptor=(t,s,n,r)=>{const o=e(t,s,n,r),a=i.test(t);if(!((t=t.replace(i,"")).toLowerCase()in n)||a){const e=t[2].toLowerCase()+t.slice(3),i=t=>o.call(n,t);n.addEventListener(e,i,a);const s=()=>n.removeEventListener(e,i,a),l=r.afterRemoved;r.afterRemoved=t=>{null==l||l(t),s()}}return o}},handleInterceptedEvent(t,e,i,s){const{eventPhase:n,type:r}=s,o=n===Event.CAPTURING_PHASE;let a=`on${r}${o?"capture":""}`;const l=e.properties;(a in l||(a=`on${r[0].toUpperCase()}${r.slice(1)}${o?"Capture":""}`,a in l))&&(Pc.clear(),t.scheduleRender(),l[a].call(l.bind||i,s))}});let Lc=!1,Nc=class extends(Jo(To.EventedAccessor)){constructor(t,e){super(t,e),this._attached=!1,this._internalHandles=new Wo,this._projector=Rc,this._readyForTrueRender=!1,this.domNode=null,this.iconClass="esri-icon-checkbox-unchecked",this.label=this.declaredClass.split(".").pop(),this.visible=!0,this.key=this,this._loadLocale=ps((async()=>{if(this._messageBundleProps&&this._messageBundleProps.length){const t=await rs(this._messageBundleProps.map((async({bundlePath:t,propertyName:e})=>{let i=await Ms(t);this.uiStrings&&Object.keys(this.uiStrings)&&(i=Ec(H(i),this.uiStrings)),this[e]=i})));for(const e of t)e.error&&Fc.error("widget-intl:locale-error",this.declaredClass,e.error)}await this.loadLocale()})),(t=>{ju.M=t})(tn(lr(bc)));const i=Vl()||"light";["light","dark"].includes(i)||dr(Fc,"The following themes are deprecated: light-blue, dark-blue, light-green, dark-green, light-purple, dark-purple, light-red, and dark-red.",{version:"4.19",warnOnce:!0,see:"https://developers.arcgis.com/javascript/latest/styling/"});const s="esri-widget-uid-"+Qo(),n=this.render.bind(this);this._trackingTarget=new ao((()=>this.scheduleRender()));const r=()=>{var t;if(!this._readyForTrueRender||this.destroyed)return null;if(!this.visible)return{vnodeSelector:"div",properties:{key:s,class:"",styles:{display:"none"}},domNode:void 0,children:void 0,text:void 0};const e=n();let{properties:i}=e;i||(e.properties=i={});let{key:r,styles:o}=i;r||(i.key=s),o||(i.styles=o={}),o.display||(o.display="");let a=0;return null==(t=e.children)||t.forEach((t=>{if(Oc(t.vnodeSelector))return;let{properties:e}=t;e||(t.properties=e={}),e.key||(e.key=`${this.id}--${a++}`)})),Ic(this,e)};this.render=()=>{if(Lc)return r();let t=Pc.get(this);if(t)return t;this._trackingTarget.clear(),Lc=!0;try{t=me(this._trackingTarget,r)}finally{Lc=!1}return Pc.set(this,t),t},this.addResolvingPromise(this._resourcesFetch=this.beforeFirstRender().then((()=>{this._readyForTrueRender=!0,this._postInitialize()})))}normalizeCtorArgs(t,e){const i={...t};return e&&(i.container=e),i}postInitialize(){}beforeFirstRender(){return Promise.all([this.loadDependencies(),this._loadLocale()]).then((()=>{})).catch(Yi)}async loadDependencies(){}async loadLocale(){}destroy(){this.destroyed||(this._trackingTarget=m(this._trackingTarget),this.viewModel=m(this.viewModel),this._detach(this.container),this._set("container",null),this._internalHandles.destroy(),this._emitter.clear(),this.render=()=>null,this._projector=null,Pc.delete(this))}set container(t){this._get("container")||this._set("container",t)}castContainer(t){return pr(t)}get id(){return this._get("id")||this.get("container.id")||Date.now().toString(16)+"-widget-"+Cc++}set id(t){t&&this._set("id",t)}get renderable(){return this._resourcesFetch}get test(){return{projector:this._projector,handles:this._internalHandles}}render(){throw Error("not implemented")}scheduleRender(){this.destroyed||(Pc.delete(this),this._projector.scheduleRender())}classes(...t){return Ol.apply(this,t)}own(t){arguments.length>1&&(t=Array.prototype.slice.call(arguments)),this._internalHandles.add(t)}renderNow(){Pc.delete(this),this._projector.renderNow()}_postInitialize(){var t;if(this.destroyed)return;this.scheduleRender(),null!=(t=this._delegatedEventNames)&&t.length&&this._internalHandles.add(Xo(this,"viewModel",((t,e)=>{e&&this._internalHandles.remove("delegated-events"),t&&this._internalHandles.add(this._delegatedEventNames.map((e=>t.on(e,(t=>{this.emit(e,t)})))),"delegated-events")}))),this.postInitialize();const e=async()=>{await this._loadLocale().catch(Yi),this.scheduleRender()};this._internalHandles.add([yi(e),this.watch("uiStrings",e),ia(this,"container",(async t=>{this.destroyed||this._attach(t)}))])}_attach(t){t&&(this._projector.merge(t,this.render),this._attached=!0)}_detach(t){t&&this._attached&&(this._projector.detach(this.render),t.parentNode&&t.parentNode.removeChild(t),this._attached=!1)}};Nc[Mc]=!0,e([oe()],Nc.prototype,"_readyForTrueRender",void 0),e([oe({value:null})],Nc.prototype,"container",null),e([ba("container")],Nc.prototype,"castContainer",null),e([oe({aliasOf:"container"})],Nc.prototype,"domNode",void 0),e([oe()],Nc.prototype,"iconClass",void 0),e([oe()],Nc.prototype,"id",null),e([oe()],Nc.prototype,"label",void 0),e([oe()],Nc.prototype,"renderable",null),e([oe()],Nc.prototype,"uiStrings",void 0),e([oe()],Nc.prototype,"viewModel",void 0),e([oe()],Nc.prototype,"visible",void 0),e([oe()],Nc.prototype,"key",void 0),e([oe()],Nc.prototype,"children",void 0),e([oe()],Nc.prototype,"afterCreate",void 0),e([oe()],Nc.prototype,"afterUpdate",void 0),e([oe()],Nc.prototype,"afterRemoved",void 0),Nc=e([si(Ac)],Nc);const Dc=Nc;function Vc(){return function(t,e){if(!t[e])throw new TypeError(`Cannot auto bind undefined function '${e}'`);return{value:$c(t[e])}}}function $c(t){return function(e,...i){!function(t){const{type:e}=t;return t instanceof KeyboardEvent||"keyup"===e||"keydown"===e||"keypress"===e}(e)?t.call(this,e,...i):Dl(e.key)&&(e.preventDefault(),e.stopPropagation(),e.target.click())}}function zc(t){return function(e,i){e.hasOwnProperty("_messageBundleProps")||(e._messageBundleProps=e._messageBundleProps?e._messageBundleProps.slice():[]),e._messageBundleProps.push({bundlePath:t,propertyName:i})}}function Gc(t){return e=>{e.hasOwnProperty("_delegatedEventNames")||(e._delegatedEventNames=e._delegatedEventNames?e._delegatedEventNames.slice():[]);const i=e._delegatedEventNames,s=Array.isArray(t)?t:function(t){return t.split(",").map((t=>t.trim()))}(t);i.push(...s)}}var Uc=function(t){return{vnodeSelector:"",properties:void 0,children:void 0,text:""+t,domNode:null}},qc=function(t,e){for(var i=0,s=t.length;i<s;i++){var n=t[i];Array.isArray(n)?qc(n,e):null!=n&&!1!==n&&(n.hasOwnProperty("vnodeSelector")||(n=Uc(n)),e.push(n))}};function Bc(t,e,...i){return"function"!=typeof t||Oc(t)?function(t,e){for(var i=[],s=2;s<arguments.length;s++)i[s-2]=arguments[s];if(1===i.length&&"string"==typeof i[0])return{vnodeSelector:t,properties:e||void 0,children:void 0,text:i[0],domNode:null};var n=[];return qc(i,n),{vnodeSelector:t,properties:e||void 0,children:n,text:void 0,domNode:null}}(t,e,...i):t(e,...i)}function Wc(t){return t&&"function"==typeof t.render}function Hc(t){return t&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}const Jc={transparent:[0,0,0,0],black:[0,0,0,1],silver:[192,192,192,1],gray:[128,128,128,1],white:[255,255,255,1],maroon:[128,0,0,1],red:[255,0,0,1],purple:[128,0,128,1],fuchsia:[255,0,255,1],green:[0,128,0,1],lime:[0,255,0,1],olive:[128,128,0,1],yellow:[255,255,0,1],navy:[0,0,128,1],blue:[0,0,255,1],teal:[0,128,128,1],aqua:[0,255,255,1],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],blanchedalmond:[255,235,205,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],oldlace:[253,245,230,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],rebeccapurple:[102,51,153,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],whitesmoke:[245,245,245,1],yellowgreen:[154,205,50,1]};function Zc(t){return Jc[t]||Jc[t.toLowerCase()]}function Qc(t){var e;return null!=(e=Jc[t])?e:Jc[t.toLowerCase()]}function Kc(t,e,i){i<0&&++i,i>1&&--i;const s=6*i;return s<1?t+(e-t)*s:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function Yc(t,e,i,s=1){const n=(t%360+360)%360/360,r=i<=.5?i*(e+1):i+e-i*e,o=2*i-r;return[Math.round(255*Kc(o,r,n+1/3)),Math.round(255*Kc(o,r,n)),Math.round(255*Kc(o,r,n-1/3)),s]}function Xc(){return[0,0,0]}function th(t){return[t[0],t[1],t[2]]}function eh(t,e,i){return[t,e,i]}function ih(t){const e=[0,0,0],i=Math.min(3,t.length);for(let s=0;s<i;++s)e[s]=t[s];return e}function sh(t,e){return new Float64Array(t,e,3)}function nh(){return eh(1,1,1)}function rh(){return eh(1,0,0)}function oh(){return eh(0,1,0)}function ah(){return eh(0,0,1)}const lh=[0,0,0],uh=nh(),ch=rh(),hh=oh(),dh=ah();Object.freeze({__proto__:null,create:Xc,clone:th,fromValues:eh,fromArray:ih,createView:sh,zeros:function(){return[0,0,0]},ones:nh,unitX:rh,unitY:oh,unitZ:ah,ZEROS:lh,ONES:uh,UNIT_X:ch,UNIT_Y:hh,UNIT_Z:dh});const ph=1e-6,fh=Math.random;function yh(t){return.017453292519943295*t}function mh(t){return 57.29577951308232*t}function gh(t){const e=t[0],i=t[1],s=t[2];return Math.sqrt(e*e+i*i+s*s)}function vh(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function wh(t,e,i,s){return t[0]=e,t[1]=i,t[2]=s,t}function bh(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function Mh(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function Sh(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function xh(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t}function kh(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Ih(t,e){const i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(i*i+s*s+n*n)}function jh(t,e){const i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2];return i*i+s*s+n*n}function _h(t){const e=t[0],i=t[1],s=t[2];return e*e+i*i+s*s}function Th(t,e){const i=e[0],s=e[1],n=e[2];let r=i*i+s*s+n*n;return r>0&&(r=1/Math.sqrt(r),t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r),t}function Oh(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ah(t,e,i){const s=e[0],n=e[1],r=e[2],o=i[0],a=i[1],l=i[2];return t[0]=n*l-r*a,t[1]=r*o-s*l,t[2]=s*a-n*o,t}function Fh(t,e,i,s){const n=e[0],r=e[1],o=e[2];return t[0]=n+s*(i[0]-n),t[1]=r+s*(i[1]-r),t[2]=o+s*(i[2]-o),t}function Ch(t,e,i){const s=e[0],n=e[1],r=e[2];return t[0]=i[0]*s+i[4]*n+i[8]*r+i[12],t[1]=i[1]*s+i[5]*n+i[9]*r+i[13],t[2]=i[2]*s+i[6]*n+i[10]*r+i[14],t}function Ph(t,e,i){const s=e[0],n=e[1],r=e[2];return t[0]=s*i[0]+n*i[3]+r*i[6],t[1]=s*i[1]+n*i[4]+r*i[7],t[2]=s*i[2]+n*i[5]+r*i[8],t}function Eh(t,e,i){const s=i[0],n=i[1],r=i[2],o=e[0],a=e[1],l=e[2];let u=n*l-r*a,c=r*o-s*l,h=s*a-n*o,d=n*h-r*c,p=r*u-s*h,f=s*c-n*u;const y=2*i[3];return u*=y,c*=y,h*=y,d*=2,p*=2,f*=2,t[0]=o+u+d,t[1]=a+c+p,t[2]=l+h+f,t}Object.freeze({__proto__:null,EPSILON:ph,RANDOM:fh,toRadian:yh,toDegree:mh,equals:function(t,e){return Math.abs(t-e)<=ph*Math.max(1,Math.abs(t),Math.abs(e))}});const Rh=[0,0,0],Lh=[0,0,0];function Nh(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Dh(t,e,i){const s=i[0]-e[0],n=i[1]-e[1],r=i[2]-e[2];let o=s*s+n*n+r*r;return o>0?(o=1/Math.sqrt(o),t[0]=s*o,t[1]=n*o,t[2]=r*o,t):(t[0]=0,t[1]=0,t[2]=0,t)}const Vh=Mh,$h=gh;function zh(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function Gh(t,e,i,s,n){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t}function Uh(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t}function qh(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t}function Bh(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t[3]=e[3]*i[3],t}function Wh(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t[3]=e[3]/i[3],t}function Hh(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function Jh(t,e){const i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2],r=e[3]-t[3];return Math.sqrt(i*i+s*s+n*n+r*r)}function Zh(t,e){const i=e[0]-t[0],s=e[1]-t[1],n=e[2]-t[2],r=e[3]-t[3];return i*i+s*s+n*n+r*r}function Qh(t){const e=t[0],i=t[1],s=t[2],n=t[3];return Math.sqrt(e*e+i*i+s*s+n*n)}function Kh(t){const e=t[0],i=t[1],s=t[2],n=t[3];return e*e+i*i+s*s+n*n}function Yh(t,e){const i=e[0],s=e[1],n=e[2],r=e[3];let o=i*i+s*s+n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=i*o,t[1]=s*o,t[2]=n*o,t[3]=r*o),t}function Xh(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function td(t,e,i,s){const n=e[0],r=e[1],o=e[2],a=e[3];return t[0]=n+s*(i[0]-n),t[1]=r+s*(i[1]-r),t[2]=o+s*(i[2]-o),t[3]=a+s*(i[3]-a),t}function ed(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3];return t[0]=i[0]*s+i[4]*n+i[8]*r+i[12]*o,t[1]=i[1]*s+i[5]*n+i[9]*r+i[13]*o,t[2]=i[2]*s+i[6]*n+i[10]*r+i[14]*o,t[3]=i[3]*s+i[7]*n+i[11]*r+i[15]*o,t}function id(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function sd(t,e){const i=t[0],s=t[1],n=t[2],r=t[3],o=e[0],a=e[1],l=e[2],u=e[3];return Math.abs(i-o)<=ph*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(s-a)<=ph*Math.max(1,Math.abs(s),Math.abs(a))&&Math.abs(n-l)<=ph*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(r-u)<=ph*Math.max(1,Math.abs(r),Math.abs(u))}Object.freeze({__proto__:null,length:gh,copy:vh,set:wh,add:bh,subtract:Mh,multiply:Sh,divide:xh,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},min:function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t},max:function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},scale:kh,scaleAndAdd:function(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t},distance:Ih,squaredDistance:jh,squaredLength:_h,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},normalize:Th,dot:Oh,cross:Ah,lerp:Fh,hermite:function(t,e,i,s,n,r){const o=r*r,a=o*(2*r-3)+1,l=o*(r-2)+r,u=o*(r-1),c=o*(3-2*r);return t[0]=e[0]*a+i[0]*l+s[0]*u+n[0]*c,t[1]=e[1]*a+i[1]*l+s[1]*u+n[1]*c,t[2]=e[2]*a+i[2]*l+s[2]*u+n[2]*c,t},bezier:function(t,e,i,s,n,r){const o=1-r,a=o*o,l=r*r,u=a*o,c=3*r*a,h=3*l*o,d=l*r;return t[0]=e[0]*u+i[0]*c+s[0]*h+n[0]*d,t[1]=e[1]*u+i[1]*c+s[1]*h+n[1]*d,t[2]=e[2]*u+i[2]*c+s[2]*h+n[2]*d,t},random:function(t,e){e=e||1;const i=2*fh()*Math.PI,s=2*fh()-1,n=Math.sqrt(1-s*s)*e;return t[0]=Math.cos(i)*n,t[1]=Math.sin(i)*n,t[2]=s*e,t},transformMat4:Ch,transformMat3:Ph,transformQuat:Eh,rotateX:function(t,e,i,s){const n=[],r=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],r[0]=n[0],r[1]=n[1]*Math.cos(s)-n[2]*Math.sin(s),r[2]=n[1]*Math.sin(s)+n[2]*Math.cos(s),t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t},rotateY:function(t,e,i,s){const n=[],r=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],r[0]=n[2]*Math.sin(s)+n[0]*Math.cos(s),r[1]=n[1],r[2]=n[2]*Math.cos(s)-n[0]*Math.sin(s),t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t},rotateZ:function(t,e,i,s){const n=[],r=[];return n[0]=e[0]-i[0],n[1]=e[1]-i[1],n[2]=e[2]-i[2],r[0]=n[0]*Math.cos(s)-n[1]*Math.sin(s),r[1]=n[0]*Math.sin(s)+n[1]*Math.cos(s),r[2]=n[2],t[0]=r[0]+i[0],t[1]=r[1]+i[1],t[2]=r[2]+i[2],t},angle:function(t,e){vh(Rh,t),vh(Lh,e),Th(Rh,Rh),Th(Lh,Lh);const i=Oh(Rh,Lh);return i>1?0:i<-1?Math.PI:Math.acos(i)},str:function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},exactEquals:Nh,equals:function(t,e){if(t===e)return!0;const i=t[0],s=t[1],n=t[2],r=e[0],o=e[1],a=e[2];return Math.abs(i-r)<=ph*Math.max(1,Math.abs(i),Math.abs(r))&&Math.abs(s-o)<=ph*Math.max(1,Math.abs(s),Math.abs(o))&&Math.abs(n-a)<=ph*Math.max(1,Math.abs(n),Math.abs(a))},direction:Dh,sub:Vh,mul:Sh,div:xh,dist:Ih,sqrDist:jh,len:$h,sqrLen:_h}),Object.freeze({__proto__:null,copy:zh,set:Gh,add:Uh,subtract:qh,multiply:Bh,divide:Wh,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},min:function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t[3]=Math.min(e[3],i[3]),t},max:function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t[3]=Math.max(e[3],i[3]),t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},scale:Hh,scaleAndAdd:function(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t[3]=e[3]+i[3]*s,t},distance:Jh,squaredDistance:Zh,length:Qh,squaredLength:Kh,negate:function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},normalize:Yh,dot:Xh,lerp:td,random:function(t,e){let i,s,n,r,o,a;e=e||1;do{i=2*fh()-1,s=2*fh()-1,o=i*i+s*s}while(o>=1);do{n=2*fh()-1,r=2*fh()-1,a=n*n+r*r}while(a>=1);const l=Math.sqrt((1-o)/a);return t[0]=e*i,t[1]=e*s,t[2]=e*n*l,t[3]=e*r*l,t},transformMat4:ed,transformQuat:function(t,e,i){const s=e[0],n=e[1],r=e[2],o=i[0],a=i[1],l=i[2],u=i[3],c=u*s+a*r-l*n,h=u*n+l*s-o*r,d=u*r+o*n-a*s,p=-o*s-a*n-l*r;return t[0]=c*u+p*-o+h*-l-d*-a,t[1]=h*u+p*-a+d*-o-c*-l,t[2]=d*u+p*-l+c*-a-h*-o,t[3]=e[3],t},str:function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},exactEquals:id,equals:sd,sub:qh,mul:Bh,div:Wh,dist:Jh,sqrDist:Zh,len:Qh,sqrLen:Kh});const nd=new Float32Array(1);function rd(t){--t;for(let e=1;e<32;e<<=1)t|=t>>e;return t+1}function od(t,e,i){return Math.min(Math.max(t,e),i)}function ad(t){return 0==(t&t-1)}function ld(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}function ud(t,e,i){return t+(e-t)*i}function cd(t){return t*Math.PI/180}function hd(t){return 180*t/Math.PI}function dd(t){return Math.acos(od(t,-1,1))}function pd(t){return Math.asin(od(t,-1,1))}function fd(t){return yd(Math.max(-gd,Math.min(t,gd)))}function yd(t){return nd[0]=t,nd[0]}function md(t,e){const i=gh(t);return wh(e,i,pd(t[2]/i),Math.atan2(t[1]/i,t[0]/i)),e}const gd=yd(34028234663852886e22);function vd(t){return od(vt(t),0,255)}function wd(t,e,i){return isNaN(t=Number(t))?i:t<e?e:t>i?i:t}class bd{constructor(t){this.r=255,this.g=255,this.b=255,this.a=1,t&&this.setColor(t)}static blendColors(t,e,i,s=new bd){return s.r=Math.round(t.r+(e.r-t.r)*i),s.g=Math.round(t.g+(e.g-t.g)*i),s.b=Math.round(t.b+(e.b-t.b)*i),s.a=t.a+(e.a-t.a)*i,s._sanitize()}static fromRgb(t,e){const i=t.toLowerCase().match(/^(rgba?|hsla?)\(([\s\.\-,%0-9]+)\)/);if(i){const t=i[2].split(/\s*,\s*/),s=i[1];if("rgb"===s&&3===t.length||"rgba"===s&&4===t.length){const i=t[0];if("%"===i.charAt(i.length-1)){const i=t.map((t=>2.56*parseFloat(t)));return 4===t.length&&(i[3]=parseFloat(t[3])),bd.fromArray(i,e)}return bd.fromArray(t.map((t=>parseFloat(t))),e)}if("hsl"===s&&3===t.length||"hsla"===s&&4===t.length)return bd.fromArray(Yc(parseFloat(t[0]),parseFloat(t[1])/100,parseFloat(t[2])/100,parseFloat(t[3])),e)}return null}static fromHex(t,e=new bd){if(4!==t.length&&7!==t.length||"#"!==t[0])return null;const i=4===t.length?4:8,s=(1<<i)-1;let n=Number("0x"+t.substr(1));return isNaN(n)?null:(["b","g","r"].forEach((t=>{const r=n&s;n>>=i,e[t]=4===i?17*r:r})),e.a=1,e)}static fromArray(t,e=new bd){return e._set(Number(t[0]),Number(t[1]),Number(t[2]),Number(t[3])),isNaN(e.a)&&(e.a=1),e._sanitize()}static fromString(t,e){const i=Zc(t)?Qc(t):null;return i&&bd.fromArray(i,e)||bd.fromRgb(t,e)||bd.fromHex(t,e)}static fromJSON(t){return t&&new bd([t[0],t[1],t[2],t[3]/255])}static toUnitRGB(t){return u(t)?[t.r/255,t.g/255,t.b/255]:null}static toUnitRGBA(t){return u(t)?[t.r/255,t.g/255,t.b/255,null!=t.a?t.a:1]:null}get isBright(){return.299*this.r+.587*this.g+.114*this.b>=127}setColor(t){if("string"==typeof t)bd.fromString(t,this);else if(Array.isArray(t))bd.fromArray(t,this);else{var e,i,s,n;this._set(null!=(e=t.r)?e:0,null!=(i=t.g)?i:0,null!=(s=t.b)?s:0,null!=(n=t.a)?n:1),t instanceof bd||this._sanitize()}return this}toRgb(){return[this.r,this.g,this.b]}toRgba(){return[this.r,this.g,this.b,this.a]}toHex(){const t=this.r.toString(16),e=this.g.toString(16),i=this.b.toString(16);return`#${t.length<2?"0"+t:t}${e.length<2?"0"+e:e}${i.length<2?"0"+i:i}`}toCss(t=!1){const e=this.r+", "+this.g+", "+this.b;return t?`rgba(${e}, ${this.a})`:`rgb(${e})`}toString(){return this.toCss(!0)}toJSON(){return this.toArray()}toArray(t=0){const e=vd(this.r),i=vd(this.g),s=vd(this.b);return 0===t||1!==this.a?[e,i,s,vd(255*this.a)]:[e,i,s]}clone(){return new bd(this.toRgba())}hash(){return this.r<<24|this.g<<16|this.b<<8|255*this.a}_sanitize(){return this.r=Math.round(wd(this.r,0,255)),this.g=Math.round(wd(this.g,0,255)),this.b=Math.round(wd(this.b,0,255)),this.a=wd(this.a,0,1),this}_set(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=s}}function Md(t,e={}){var i;const s=t instanceof ri?t:new ri(t,e),n={type:null==(i=null==e?void 0:e.ignoreUnknown)||i?s.apiValues:String,readOnly:null==e?void 0:e.readOnly,json:{type:s.jsonValues,read:(null==e||!e.readOnly)&&{reader:s.read},write:{writer:s.write}}};return void 0!==(null==e?void 0:e.default)&&(n.json.default=e.default),void 0!==(null==e?void 0:e.name)&&(n.json.name=e.name),oe(n)}function Sd(t,e,i){let s,n;return void 0===e||Array.isArray(e)?(n=t,i=e,s=[void 0]):(n=e,s=Array.isArray(t)?t:[t]),(t,e)=>{const r=t.constructor.prototype;s.forEach((s=>{const o=ae(t,s,n);o.read&&"object"==typeof o.read||(o.read={}),o.read.reader=r[e],i&&(o.read.source=(o.read.source||[]).concat(i))}))}}function xd(t,e,i){let s,n;return void 0===e?(n=t,s=[void 0]):"string"!=typeof e?(n=t,s=[void 0],i=e):(n=e,s=Array.isArray(t)?t:[t]),(t,e)=>{const r=t.constructor.prototype;for(const o of s){const s=ae(t,o,n);s.write&&"object"==typeof s.write||(s.write={}),i&&(s.write.target=i),s.write.writer=r[e]}}}var kd;function Id(t,e,i){if(!t||!t.read||!1===t.read.enabled||!t.read.source)return!1;const s=t.read.source;if("string"==typeof s){if(s===e)return!0;if(s.indexOf(".")>-1&&0===s.indexOf(e)&&Xt(s,i))return!0}else for(const t of s){if(t===e)return!0;if(t.indexOf(".")>-1&&0===t.indexOf(e)&&Xt(t,i))return!0}return!1}function jd(t,e,i,s,n){let r=Je(e[i],n);(function(t){return t&&(!t.read||!1!==t.read.enabled&&!t.read.source)})(r)&&(t[i]=!0);for(const o of Object.getOwnPropertyNames(e))r=Je(e[o],n),Id(r,i,s)&&(t[o]=!0)}function _d(t,e,i,s){const n=Qe(i.metadatas[e],"any",s),r=n&&n.default;if(void 0===r)return;const o="function"==typeof r?r.call(t,e,s):r;void 0!==o&&i.set(e,o)}bd.prototype.declaredClass="esri.Color",function(t){t.VALUE_OUT_OF_RANGE="domain-validation-error::value-out-of-range",t.INVALID_CODED_VALUE="domain-validation-error::invalid-coded-value"}(kd||(kd={}));const Td={origin:"service"};function Od(t,e,i=Td){if(!e||"object"!=typeof e)return;const s=Gt(t),n=s.metadatas,r={};for(const t of Object.getOwnPropertyNames(e))jd(r,n,t,e,i);s.setDefaultOrigin(i.origin);for(const o of Object.getOwnPropertyNames(r)){const r=Je(n[o],i).read,a=r&&r.source;let l;l=a&&"string"==typeof a?Kt(e,a):e[o],r&&r.reader&&(l=r.reader.call(t,l,e,i)),void 0!==l&&s.set(o,l)}if(!i||!i.ignoreDefaults)for(const e of Object.getOwnPropertyNames(n))r[e]||_d(t,e,s,i);s.setDefaultOrigin("user")}function Ad(t,e,i,s=Td){var n;const r={...s,messages:[]};i(r),null==(n=r.messages)||n.forEach((e=>{"warning"!==e.type||t.loaded?s&&s.messages&&s.messages.push(e):t.loadWarnings.push(e)}))}const Fd=ct.getLogger("esri.core.accessorSupport.write");function Cd(t,e,i,s,n){var r,o;const a={};return null==(r=e.write)||null==(o=r.writer)||o.call(t,s,a,i,n),a}function Pd(t,e,i,s,n,r){if(!s||!s.write)return!1;const o=t.get(i);if(!n&&s.write.overridePolicy){const e=s.write.overridePolicy.call(t,o,i,r);void 0!==e&&(n=e)}if(n||(n=s.write),!n||!1===n.enabled)return!1;if((null===o&&!n.allowNull&&!n.writerEnsuresNonNull||void 0===o)&&n.isRequired){const e=new Ve("web-document-write:property-required",`Missing value for required property '${i}' on '${t.declaredClass}'`,{propertyName:i,target:t});return e&&r&&r.messages?r.messages.push(e):e&&!r&&Fd.error(e.name,e.message),!1}return!(void 0===o||null===o&&!n.allowNull&&!n.writerEnsuresNonNull||function(t,e,i,s,n){const r=s.default;return void 0!==r&&(null!=s.defaultEquals?s.defaultEquals(n):"function"==typeof r?!!Array.isArray(n)&&T(r.call(t,e,i),n):r===n)}(t,i,r,s,o)||void 0===s.default&&!n.ignoreOrigin&&r&&r.origin&&e.store.originOf(i)<br(r.origin))}function Ed(t,e,i,s){const n=Gt(t),r=Ze(n.metadatas[e],s);return!!r&&Pd(t,n,e,r,i,s)}function Rd(t,e,i){if(t&&"function"==typeof t.toJSON&&(!t.toJSON.isDefaultToJSON||!t.write))return Ut(e,t.toJSON());const s=Gt(t),n=s.metadatas;for(const a in n){const l=Ze(n[a],i);if(!Pd(t,s,a,l,void 0,i))continue;const u=t.get(a),c=Cd(t,l,l.write&&"string"==typeof l.write.target?l.write.target:a,u,i);var r,o;Object.keys(c).length>0&&(e=Ut(e,c),null!=i&&null!=(r=i.resources)&&null!=(o=r.pendingOperations)&&o.length&&Promise.all(i.resources.pendingOperations).then((()=>Ut(e,c))),i&&i.writtenProperties&&i.writtenProperties.push({target:t,propName:a,oldOrigin:Sr(s.store.originOf(a)),newOrigin:i.origin}))}return e}const Ld=t=>{let i=class extends t{constructor(...t){super(...t)}read(t,e){Od(this,t,e)}write(t={},e){return Rd(this,t,e)}toJSON(t){return this.write({},t)}static fromJSON(t,e){return Nd.call(this,t,e)}};return i=e([si("esri.core.JSONSupport")],i),i.prototype.toJSON.isDefaultToJSON=!0,i};function Nd(t,e){if(!t)return null;if(t.declaredClass)throw Error("JSON object is already hydrated");const i=new this;return i.read(t,e),i}let Dd,Vd=class extends(Ld(jo)){};Vd=e([si("esri.core.JSONSupport")],Vd);const $d={values:[1,.3048,.3048006096012192,.3047972654,.9143917962,.201166195164,.9143984146160287,.3047994715386762,20.11676512155263,20.11678249437587,.9143985307444408,.91439523,.3047997101815088,20.116756,5e4,15e4],units:["Meter","Foot","Foot_US","Foot_Clarke","Yard_Clarke","Link_Clarke","Yard_Sears","Foot_Sears","Chain_Sears","Chain_Benoit_1895_B","Yard_Indian","Yard_Indian_1937","Foot_Gold_Coast","Chain_Sears_1922_Truncated","50_Kilometers","150_Kilometers"],2066:5,2136:12,2155:2,2157:0,2158:0,2159:12,2160:12,2204:2,2219:0,2220:0,2254:2,2255:2,2256:1,2265:1,2266:1,2267:2,2268:2,2269:1,2270:1,2271:2,2272:2,2273:1,2294:0,2295:0,2314:3,2899:2,2900:2,2901:1,2909:1,2910:1,2911:2,2912:2,2913:1,2914:1,2992:1,2993:0,2994:1,3080:1,3089:2,3090:0,3091:2,3102:2,3141:0,3142:0,3167:13,3359:2,3360:0,3361:1,3362:0,3363:2,3364:0,3365:2,3366:3,3404:2,3405:0,3406:0,3407:3,3439:0,3440:0,3479:1,3480:0,3481:1,3482:0,3483:1,3484:0,3485:2,3486:0,3487:2,3488:0,3489:0,3490:2,3491:0,3492:2,3493:0,3494:2,3495:0,3496:2,3497:0,3498:2,3499:0,3500:2,3501:0,3502:2,3503:0,3504:2,3505:0,3506:2,3507:0,3508:2,3509:0,3510:2,3511:0,3512:2,3513:0,3514:0,3515:2,3516:0,3517:2,3518:0,3519:2,3520:0,3521:2,3522:0,3523:2,3524:0,3525:2,3526:0,3527:2,3528:0,3529:2,3530:0,3531:2,3532:0,3533:2,3534:0,3535:2,3536:0,3537:2,3538:0,3539:2,3540:0,3541:2,3542:0,3543:2,3544:0,3545:2,3546:0,3547:2,3548:0,3549:2,3550:0,3551:2,3552:0,3553:2,3582:2,3583:0,3584:2,3585:0,3586:2,3587:0,3588:1,3589:0,3590:1,3591:0,3592:0,3593:1,3598:2,3599:0,3600:2,3605:1,3606:0,3607:0,3608:2,3609:0,3610:2,3611:0,3612:2,3613:0,3614:2,3615:0,3616:2,3617:0,3618:2,3619:0,3620:2,3621:0,3622:2,3623:0,3624:2,3625:0,3626:2,3627:0,3628:2,3629:0,3630:2,3631:0,3632:2,3633:0,3634:1,3635:0,3636:1,3640:2,3641:0,3642:2,3643:0,3644:1,3645:0,3646:1,3647:0,3648:1,3649:0,3650:2,3651:0,3652:2,3653:0,3654:2,3655:0,3656:1,3657:0,3658:2,3659:0,3660:2,3661:0,3662:2,3663:0,3664:2,3668:2,3669:0,3670:2,3671:0,3672:2,3673:0,3674:2,3675:0,3676:1,3677:2,3678:0,3679:1,3680:2,3681:0,3682:1,3683:2,3684:0,3685:0,3686:2,3687:0,3688:2,3689:0,3690:2,3691:0,3692:2,3696:2,3697:0,3698:2,3699:0,3700:2,3793:0,3794:0,3812:0,3854:0,3857:0,3920:0,3978:0,3979:0,3991:2,3992:2,4026:0,4037:0,4038:0,4071:0,4082:0,4083:0,4087:0,4088:0,4217:2,4414:0,4415:0,4417:0,4434:0,4437:0,4438:2,4439:2,4462:0,4467:0,4471:0,4474:0,4559:0,4647:0,4822:0,4826:0,4839:0,5018:0,5048:0,5167:0,5168:0,5221:0,5223:0,5234:0,5235:0,5243:0,5247:0,5266:0,5316:0,5320:0,5321:0,5325:0,5337:0,5361:0,5362:0,5367:0,5382:0,5383:0,5396:0,5456:0,5457:0,5469:0,5472:4,5490:0,5513:0,5514:0,5523:0,5559:0,5588:1,5589:3,5596:0,5627:0,5629:0,5641:0,5643:0,5644:0,5646:2,5654:2,5655:2,5659:0,5700:0,5825:0,5836:0,5837:0,5839:0,5842:0,5844:0,5858:0,5879:0,5880:0,5887:0,5890:0,6128:1,6129:1,6141:1,6204:0,6210:0,6211:0,6307:0,6312:0,6316:0,6362:0,6391:1,6405:1,6406:0,6407:1,6408:0,6409:1,6410:0,6411:2,6412:0,6413:2,6414:0,6415:0,6416:2,6417:0,6418:2,6419:0,6420:2,6421:0,6422:2,6423:0,6424:2,6425:0,6426:2,6427:0,6428:2,6429:0,6430:2,6431:0,6432:2,6433:0,6434:2,6435:0,6436:2,6437:0,6438:2,6439:0,6440:0,6441:2,6442:0,6443:2,6444:0,6445:2,6446:0,6447:2,6448:0,6449:2,6450:0,6451:2,6452:0,6453:2,6454:0,6455:2,6456:0,6457:2,6458:0,6459:2,6460:0,6461:2,6462:0,6463:2,6464:0,6465:2,6466:0,6467:2,6468:0,6469:2,6470:0,6471:2,6472:0,6473:2,6474:0,6475:2,6476:0,6477:2,6478:0,6479:2,6484:2,6485:0,6486:2,6487:0,6488:2,6489:0,6490:2,6491:0,6492:2,6493:0,6494:1,6495:0,6496:1,6497:0,6498:0,6499:1,6500:0,6501:2,6502:0,6503:2,6504:0,6505:2,6506:0,6507:2,6508:0,6509:0,6510:2,6515:1,6516:0,6518:0,6519:2,6520:0,6521:2,6522:0,6523:2,6524:0,6525:2,6526:0,6527:2,6528:0,6529:2,6530:0,6531:2,6532:0,6533:2,6534:0,6535:2,6536:0,6537:2,6538:0,6539:2,6540:0,6541:2,6542:0,6543:2,6544:0,6545:1,6546:0,6547:1,6548:0,6549:2,6550:0,6551:2,6552:0,6553:2,6554:0,6555:2,6556:0,6557:1,6558:0,6559:1,6560:0,6561:1,6562:0,6563:2,6564:0,6565:2,6566:0,6567:0,6568:2,6569:0,6570:1,6571:0,6572:2,6573:0,6574:2,6575:0,6576:2,6577:0,6578:2,6582:2,6583:0,6584:2,6585:0,6586:2,6587:0,6588:2,6589:0,6590:2,6591:0,6592:0,6593:2,6594:0,6595:2,6596:0,6597:2,6598:0,6599:2,6600:0,6601:2,6602:0,6603:2,6605:2,6606:0,6607:2,6608:0,6609:2,6610:0,6611:0,6612:2,6613:0,6614:2,6615:0,6616:2,6617:0,6618:2,6633:2,6646:0,6703:0,6784:0,6785:1,6786:0,6787:1,6788:0,6789:1,6790:0,6791:1,6792:0,6793:1,6794:0,6795:1,6796:0,6797:1,6798:0,6799:1,6800:0,6801:1,6802:0,6803:1,6804:0,6805:1,6806:0,6807:1,6808:0,6809:1,6810:0,6811:1,6812:0,6813:1,6814:0,6815:1,6816:0,6817:1,6818:0,6819:1,6820:0,6821:1,6822:0,6823:1,6824:0,6825:1,6826:0,6827:1,6828:0,6829:1,6830:0,6831:1,6832:0,6833:1,6834:0,6835:1,6836:0,6837:1,6838:0,6839:1,6840:0,6841:1,6842:0,6843:1,6844:0,6845:1,6846:0,6847:1,6848:0,6849:1,6850:0,6851:1,6852:0,6853:1,6854:0,6855:1,6856:0,6857:1,6858:0,6859:1,6860:0,6861:1,6862:0,6863:1,6867:0,6868:1,6870:0,6875:0,6876:0,6879:0,6880:2,6884:0,6885:1,6886:0,6887:1,6915:0,6922:0,6923:2,6924:0,6925:2,6962:0,6984:0,6991:0,7128:2,7131:0,7132:2,7142:0,7257:0,7258:2,7259:0,7260:2,7261:0,7262:2,7263:0,7264:2,7265:0,7266:2,7267:0,7268:2,7269:0,7270:2,7271:0,7272:2,7273:0,7274:2,7275:0,7276:2,7277:0,7278:2,7279:0,7280:2,7281:0,7282:2,7283:0,7284:2,7285:0,7286:2,7287:0,7288:2,7289:0,7290:2,7291:0,7292:2,7293:0,7294:2,7295:0,7296:2,7297:0,7298:2,7299:0,7300:2,7301:0,7302:2,7303:0,7304:2,7305:0,7306:2,7307:0,7308:2,7309:0,7310:2,7311:0,7312:2,7313:0,7314:2,7315:0,7316:2,7317:0,7318:2,7319:0,7320:2,7321:0,7322:2,7323:0,7324:2,7325:0,7326:2,7327:0,7328:2,7329:0,7330:2,7331:0,7332:2,7333:0,7334:2,7335:0,7336:2,7337:0,7338:2,7339:0,7340:2,7341:0,7342:2,7343:0,7344:2,7345:0,7346:2,7347:0,7348:2,7349:0,7350:2,7351:0,7352:2,7353:0,7354:2,7355:0,7356:2,7357:0,7358:2,7359:0,7360:2,7361:0,7362:2,7363:0,7364:2,7365:0,7366:2,7367:0,7368:2,7369:0,7370:2,7877:0,7878:0,7882:0,7883:0,7887:0,7899:0,7991:0,7992:0,8035:2,8036:2,8058:0,8059:0,8082:0,8083:0,8088:0,8090:0,8091:2,8092:0,8093:2,8095:0,8096:2,8097:0,8098:2,8099:0,8100:2,8101:0,8102:2,8103:0,8104:2,8105:0,8106:2,8107:0,8108:2,8109:0,8110:2,8111:0,8112:2,8113:0,8114:2,8115:0,8116:2,8117:0,8118:2,8119:0,8120:2,8121:0,8122:2,8123:0,8124:2,8125:0,8126:2,8127:0,8128:2,8129:0,8130:2,8131:0,8132:2,8133:0,8134:2,8135:0,8136:2,8137:0,8138:2,8139:0,8140:2,8141:0,8142:2,8143:0,8144:2,8145:0,8146:2,8147:0,8148:2,8149:0,8150:2,8151:0,8152:2,8153:0,8154:2,8155:0,8156:2,8157:0,8158:2,8159:0,8160:2,8161:0,8162:2,8163:0,8164:2,8165:0,8166:2,8167:0,8168:2,8169:0,8170:2,8171:0,8172:2,8173:0,8177:2,8179:0,8180:2,8181:0,8182:2,8184:0,8185:2,8187:0,8189:2,8191:0,8193:2,8196:0,8197:2,8198:0,8200:2,8201:0,8202:2,8203:0,8204:2,8205:0,8206:2,8207:0,8208:2,8209:0,8210:2,8212:0,8213:2,8214:0,8216:2,8218:0,8220:2,8222:0,8224:2,8225:0,8226:2,8311:0,8312:1,8313:0,8314:1,8315:0,8316:1,8317:0,8318:1,8319:0,8320:1,8321:0,8322:1,8323:0,8324:1,8325:0,8326:1,8327:0,8328:1,8329:0,8330:1,8331:0,8332:1,8333:0,8334:1,8335:0,8336:1,8337:0,8338:1,8339:0,8340:1,8341:0,8342:1,8343:0,8344:1,8345:0,8346:1,8347:0,8348:1,8352:0,8353:0,8379:0,8380:2,8381:0,8382:2,8383:0,8384:2,8385:0,8387:2,8391:0,8395:0,8433:0,8441:0,8455:0,8456:0,8531:2,8682:0,8686:0,8687:0,8692:0,8693:0,8826:0,8903:0,8950:0,8951:0,9039:0,9040:0,9141:0,9149:0,9150:0,9191:0,9221:0,9222:0,9249:0,9250:0,9252:0,9254:0,9265:0,9284:0,9285:0,9300:0,9354:0,9367:0,9373:0,9377:0,9387:0,9391:0,9456:0,9473:0,9498:0,9674:0,9678:0,9680:0,20499:0,20538:0,20539:0,20790:0,20791:0,21291:0,21292:0,21500:0,21817:0,21818:0,22032:0,22033:0,22091:0,22092:0,22332:0,22391:0,22392:0,22700:0,22770:0,22780:0,22832:0,23090:0,23095:0,23239:0,23240:0,23433:0,23700:0,24047:0,24048:0,24100:3,24200:0,24305:0,24306:0,24382:10,24383:0,24500:0,24547:0,24548:0,24571:9,24600:0,25e3:0,25231:0,25884:0,25932:0,26237:0,26331:0,26332:0,26432:0,26591:0,26592:0,26632:0,26692:0,27120:0,27200:0,27291:6,27292:6,27429:0,27492:0,27493:0,27500:0,27700:0,28232:0,28600:0,28991:0,28992:0,29100:0,29101:0,29220:0,29221:0,29333:0,29635:0,29636:0,29701:0,29738:0,29739:0,29849:0,29850:0,29871:8,29872:7,29873:0,29874:0,30200:5,30339:0,30340:0,30591:0,30592:0,30791:0,30792:0,30800:0,31028:0,31121:0,31154:0,31170:0,31171:0,31370:0,31528:0,31529:0,31600:0,31700:0,31838:0,31839:0,31900:0,31901:0,32061:0,32062:0,32098:0,32099:2,32100:0,32104:0,32161:0,32766:0,53048:0,53049:0,54090:0,54091:0,65061:2,65062:2,65161:0,65163:0,102041:2,102064:11,102068:14,102069:15,102118:2,102119:1,102120:2,102121:2,102217:2,102218:0,102219:2,102220:2,102378:1,102379:1,102380:0,102381:1,102589:2,102599:2,102600:2,102604:2,102647:0,102704:2,102705:2,102706:0,102761:2,102762:0,102763:2,102764:0,102765:0,102766:2,102962:0,102963:0,102970:1,102974:2,102993:0,102994:0,102995:2,102996:2,103015:0,103016:2,103017:0,103018:2,103025:0,103026:0,103027:2,103028:2,103035:0,103036:0,103037:2,103038:2,103039:0,103040:0,103041:2,103042:2,103043:0,103044:0,103045:2,103046:2,103047:0,103048:0,103049:2,103050:2,103051:0,103052:2,103053:0,103054:2,103055:0,103056:2,103057:0,103058:0,103059:2,103060:2,103061:0,103062:0,103063:2,103064:2,103069:2,103070:0,103071:0,103072:2,103073:2,103086:0,103087:0,103088:2,103089:2,103094:1,103095:0,103096:2,103103:0,103104:2,103105:0,103106:2,103121:0,103122:2,103123:0,103124:0,103125:1,103126:1,103127:0,103128:0,103129:2,103130:2,103131:0,103132:0,103133:2,103134:2,103135:0,103136:0,103137:1,103138:1,103139:0,103140:2,103141:0,103142:2,103143:0,103144:2,103145:0,103146:1,103147:0,103148:0,103149:2,103150:2,103151:0,103152:2,103172:0,103173:2,103174:0,103175:0,103176:2,103177:2,103178:0,103179:0,103180:2,103181:2,103182:0,103183:0,103184:2,103185:2,103228:0,103229:0,103230:2,103231:2,103250:0,103251:2,103252:0,103253:2,103260:0,103261:0,103262:2,103263:2,103270:0,103271:0,103272:2,103273:2,103274:0,103275:0,103276:2,103277:2,103278:0,103279:0,103280:2,103281:2,103282:0,103283:0,103284:2,103285:2,103286:0,103287:2,103288:0,103289:2,103290:0,103291:2,103292:0,103293:0,103294:2,103295:2,103296:0,103297:0,103298:2,103299:2,103376:2,103377:0,103378:0,103379:2,103380:2,103393:0,103394:0,103395:2,103396:2,103472:0,103473:1,103474:0,103475:2,103482:0,103483:2,103484:0,103485:2,103500:0,103501:2,103502:0,103503:0,103504:1,103505:1,103506:0,103507:0,103508:2,103509:2,103510:0,103511:0,103512:2,103513:2,103514:0,103515:2,103516:0,103517:2,103518:0,103519:2,103520:0,103521:1,103522:0,103523:0,103524:2,103525:2,103526:0,103527:2,103561:2,103562:2,103563:0,103564:0,103565:2,103566:2,103567:0,103568:0,103569:2,103570:2,103584:0,103585:2,103586:0,103587:2,103588:1,103589:0,103590:2,103591:1,103592:0,103593:2,103594:1,103695:2};for(Dd=2e3;Dd<=2045;Dd++)$d[Dd]=0;for(Dd=2056;Dd<=2065;Dd++)$d[Dd]=0;for(Dd=2067;Dd<=2135;Dd++)$d[Dd]=0;for(Dd=2137;Dd<=2154;Dd++)$d[Dd]=0;for(Dd=2161;Dd<=2170;Dd++)$d[Dd]=0;for(Dd=2172;Dd<=2193;Dd++)$d[Dd]=0;for(Dd=2195;Dd<=2198;Dd++)$d[Dd]=0;for(Dd=2200;Dd<=2203;Dd++)$d[Dd]=0;for(Dd=2205;Dd<=2217;Dd++)$d[Dd]=0;for(Dd=2222;Dd<=2224;Dd++)$d[Dd]=1;for(Dd=2225;Dd<=2250;Dd++)$d[Dd]=2;for(Dd=2251;Dd<=2253;Dd++)$d[Dd]=1;for(Dd=2257;Dd<=2264;Dd++)$d[Dd]=2;for(Dd=2274;Dd<=2279;Dd++)$d[Dd]=2;for(Dd=2280;Dd<=2282;Dd++)$d[Dd]=1;for(Dd=2283;Dd<=2289;Dd++)$d[Dd]=2;for(Dd=2290;Dd<=2292;Dd++)$d[Dd]=0;for(Dd=2308;Dd<=2313;Dd++)$d[Dd]=0;for(Dd=2315;Dd<=2491;Dd++)$d[Dd]=0;for(Dd=2494;Dd<=2866;Dd++)$d[Dd]=0;for(Dd=2867;Dd<=2869;Dd++)$d[Dd]=1;for(Dd=2870;Dd<=2888;Dd++)$d[Dd]=2;for(Dd=2891;Dd<=2895;Dd++)$d[Dd]=2;for(Dd=2896;Dd<=2898;Dd++)$d[Dd]=1;for(Dd=2902;Dd<=2908;Dd++)$d[Dd]=2;for(Dd=2915;Dd<=2920;Dd++)$d[Dd]=2;for(Dd=2921;Dd<=2923;Dd++)$d[Dd]=1;for(Dd=2924;Dd<=2930;Dd++)$d[Dd]=2;for(Dd=2931;Dd<=2962;Dd++)$d[Dd]=0;for(Dd=2964;Dd<=2968;Dd++)$d[Dd]=2;for(Dd=2969;Dd<=2973;Dd++)$d[Dd]=0;for(Dd=2975;Dd<=2991;Dd++)$d[Dd]=0;for(Dd=2995;Dd<=3051;Dd++)$d[Dd]=0;for(Dd=3054;Dd<=3079;Dd++)$d[Dd]=0;for(Dd=3081;Dd<=3088;Dd++)$d[Dd]=0;for(Dd=3092;Dd<=3101;Dd++)$d[Dd]=0;for(Dd=3106;Dd<=3138;Dd++)$d[Dd]=0;for(Dd=3146;Dd<=3151;Dd++)$d[Dd]=0;for(Dd=3153;Dd<=3166;Dd++)$d[Dd]=0;for(Dd=3168;Dd<=3172;Dd++)$d[Dd]=0;for(Dd=3174;Dd<=3203;Dd++)$d[Dd]=0;for(Dd=3294;Dd<=3358;Dd++)$d[Dd]=0;for(Dd=3367;Dd<=3403;Dd++)$d[Dd]=0;for(Dd=3408;Dd<=3416;Dd++)$d[Dd]=0;for(Dd=3417;Dd<=3438;Dd++)$d[Dd]=2;for(Dd=3441;Dd<=3446;Dd++)$d[Dd]=2;for(Dd=3447;Dd<=3450;Dd++)$d[Dd]=0;for(Dd=3451;Dd<=3459;Dd++)$d[Dd]=2;for(Dd=3460;Dd<=3478;Dd++)$d[Dd]=0;for(Dd=3554;Dd<=3559;Dd++)$d[Dd]=0;for(Dd=3560;Dd<=3570;Dd++)$d[Dd]=2;for(Dd=3571;Dd<=3581;Dd++)$d[Dd]=0;for(Dd=3594;Dd<=3597;Dd++)$d[Dd]=0;for(Dd=3601;Dd<=3604;Dd++)$d[Dd]=0;for(Dd=3637;Dd<=3639;Dd++)$d[Dd]=0;for(Dd=3665;Dd<=3667;Dd++)$d[Dd]=0;for(Dd=3693;Dd<=3695;Dd++)$d[Dd]=0;for(Dd=3701;Dd<=3727;Dd++)$d[Dd]=0;for(Dd=3728;Dd<=3739;Dd++)$d[Dd]=2;for(Dd=3740;Dd<=3751;Dd++)$d[Dd]=0;for(Dd=3753;Dd<=3760;Dd++)$d[Dd]=2;for(Dd=3761;Dd<=3773;Dd++)$d[Dd]=0;for(Dd=3775;Dd<=3777;Dd++)$d[Dd]=0;for(Dd=3779;Dd<=3781;Dd++)$d[Dd]=0;for(Dd=3783;Dd<=3785;Dd++)$d[Dd]=0;for(Dd=3788;Dd<=3791;Dd++)$d[Dd]=0;for(Dd=3797;Dd<=3802;Dd++)$d[Dd]=0;for(Dd=3814;Dd<=3816;Dd++)$d[Dd]=0;for(Dd=3825;Dd<=3829;Dd++)$d[Dd]=0;for(Dd=3832;Dd<=3841;Dd++)$d[Dd]=0;for(Dd=3844;Dd<=3852;Dd++)$d[Dd]=0;for(Dd=3873;Dd<=3885;Dd++)$d[Dd]=0;for(Dd=3890;Dd<=3893;Dd++)$d[Dd]=0;for(Dd=3907;Dd<=3912;Dd++)$d[Dd]=0;for(Dd=3942;Dd<=3950;Dd++)$d[Dd]=0;for(Dd=3968;Dd<=3970;Dd++)$d[Dd]=0;for(Dd=3973;Dd<=3976;Dd++)$d[Dd]=0;for(Dd=3986;Dd<=3989;Dd++)$d[Dd]=0;for(Dd=3994;Dd<=3997;Dd++)$d[Dd]=0;for(Dd=4048;Dd<=4051;Dd++)$d[Dd]=0;for(Dd=4056;Dd<=4063;Dd++)$d[Dd]=0;for(Dd=4093;Dd<=4096;Dd++)$d[Dd]=0;for(Dd=4390;Dd<=4398;Dd++)$d[Dd]=0;for(Dd=4399;Dd<=4413;Dd++)$d[Dd]=2;for(Dd=4418;Dd<=4433;Dd++)$d[Dd]=2;for(Dd=4455;Dd<=4457;Dd++)$d[Dd]=2;for(Dd=4484;Dd<=4489;Dd++)$d[Dd]=0;for(Dd=4491;Dd<=4554;Dd++)$d[Dd]=0;for(Dd=4568;Dd<=4589;Dd++)$d[Dd]=0;for(Dd=4652;Dd<=4656;Dd++)$d[Dd]=0;for(Dd=4766;Dd<=4800;Dd++)$d[Dd]=0;for(Dd=5014;Dd<=5016;Dd++)$d[Dd]=0;for(Dd=5069;Dd<=5072;Dd++)$d[Dd]=0;for(Dd=5105;Dd<=5130;Dd++)$d[Dd]=0;for(Dd=5173;Dd<=5188;Dd++)$d[Dd]=0;for(Dd=5253;Dd<=5259;Dd++)$d[Dd]=0;for(Dd=5269;Dd<=5275;Dd++)$d[Dd]=0;for(Dd=5292;Dd<=5311;Dd++)$d[Dd]=0;for(Dd=5329;Dd<=5331;Dd++)$d[Dd]=0;for(Dd=5343;Dd<=5349;Dd++)$d[Dd]=0;for(Dd=5355;Dd<=5357;Dd++)$d[Dd]=0;for(Dd=5387;Dd<=5389;Dd++)$d[Dd]=0;for(Dd=5459;Dd<=5463;Dd++)$d[Dd]=0;for(Dd=5479;Dd<=5482;Dd++)$d[Dd]=0;for(Dd=5518;Dd<=5520;Dd++)$d[Dd]=0;for(Dd=5530;Dd<=5539;Dd++)$d[Dd]=0;for(Dd=5550;Dd<=5552;Dd++)$d[Dd]=0;for(Dd=5562;Dd<=5583;Dd++)$d[Dd]=0;for(Dd=5623;Dd<=5625;Dd++)$d[Dd]=2;for(Dd=5631;Dd<=5639;Dd++)$d[Dd]=0;for(Dd=5649;Dd<=5653;Dd++)$d[Dd]=0;for(Dd=5663;Dd<=5680;Dd++)$d[Dd]=0;for(Dd=5682;Dd<=5685;Dd++)$d[Dd]=0;for(Dd=5875;Dd<=5877;Dd++)$d[Dd]=0;for(Dd=5896;Dd<=5899;Dd++)$d[Dd]=0;for(Dd=5921;Dd<=5940;Dd++)$d[Dd]=0;for(Dd=6050;Dd<=6125;Dd++)$d[Dd]=0;for(Dd=6244;Dd<=6275;Dd++)$d[Dd]=0;for(Dd=6328;Dd<=6348;Dd++)$d[Dd]=0;for(Dd=6350;Dd<=6356;Dd++)$d[Dd]=0;for(Dd=6366;Dd<=6372;Dd++)$d[Dd]=0;for(Dd=6381;Dd<=6387;Dd++)$d[Dd]=0;for(Dd=6393;Dd<=6404;Dd++)$d[Dd]=0;for(Dd=6480;Dd<=6483;Dd++)$d[Dd]=0;for(Dd=6511;Dd<=6514;Dd++)$d[Dd]=0;for(Dd=6579;Dd<=6581;Dd++)$d[Dd]=0;for(Dd=6619;Dd<=6624;Dd++)$d[Dd]=0;for(Dd=6625;Dd<=6627;Dd++)$d[Dd]=2;for(Dd=6628;Dd<=6632;Dd++)$d[Dd]=0;for(Dd=6634;Dd<=6637;Dd++)$d[Dd]=0;for(Dd=6669;Dd<=6692;Dd++)$d[Dd]=0;for(Dd=6707;Dd<=6709;Dd++)$d[Dd]=0;for(Dd=6720;Dd<=6723;Dd++)$d[Dd]=0;for(Dd=6732;Dd<=6738;Dd++)$d[Dd]=0;for(Dd=6931;Dd<=6933;Dd++)$d[Dd]=0;for(Dd=6956;Dd<=6959;Dd++)$d[Dd]=0;for(Dd=7005;Dd<=7007;Dd++)$d[Dd]=0;for(Dd=7057;Dd<=7070;Dd++)$d[Dd]=2;for(Dd=7074;Dd<=7082;Dd++)$d[Dd]=0;for(Dd=7109;Dd<=7118;Dd++)$d[Dd]=0;for(Dd=7119;Dd<=7127;Dd++)$d[Dd]=1;for(Dd=7374;Dd<=7376;Dd++)$d[Dd]=0;for(Dd=7528;Dd<=7586;Dd++)$d[Dd]=0;for(Dd=7587;Dd<=7645;Dd++)$d[Dd]=2;for(Dd=7692;Dd<=7696;Dd++)$d[Dd]=0;for(Dd=7755;Dd<=7787;Dd++)$d[Dd]=0;for(Dd=7791;Dd<=7795;Dd++)$d[Dd]=0;for(Dd=7799;Dd<=7801;Dd++)$d[Dd]=0;for(Dd=7803;Dd<=7805;Dd++)$d[Dd]=0;for(Dd=7825;Dd<=7831;Dd++)$d[Dd]=0;for(Dd=7845;Dd<=7859;Dd++)$d[Dd]=0;for(Dd=8013;Dd<=8032;Dd++)$d[Dd]=0;for(Dd=8065;Dd<=8068;Dd++)$d[Dd]=1;for(Dd=8518;Dd<=8529;Dd++)$d[Dd]=2;for(Dd=8533;Dd<=8536;Dd++)$d[Dd]=2;for(Dd=8538;Dd<=8540;Dd++)$d[Dd]=2;for(Dd=8677;Dd<=8679;Dd++)$d[Dd]=0;for(Dd=8836;Dd<=8840;Dd++)$d[Dd]=0;for(Dd=8857;Dd<=8859;Dd++)$d[Dd]=0;for(Dd=8908;Dd<=8910;Dd++)$d[Dd]=0;for(Dd=9154;Dd<=9159;Dd++)$d[Dd]=0;for(Dd=9205;Dd<=9218;Dd++)$d[Dd]=0;for(Dd=9271;Dd<=9273;Dd++)$d[Dd]=0;for(Dd=9295;Dd<=9297;Dd++)$d[Dd]=0;for(Dd=9356;Dd<=9360;Dd++)$d[Dd]=0;for(Dd=9404;Dd<=9407;Dd++)$d[Dd]=0;for(Dd=9476;Dd<=9482;Dd++)$d[Dd]=0;for(Dd=9487;Dd<=9494;Dd++)$d[Dd]=0;for(Dd=9697;Dd<=9699;Dd++)$d[Dd]=0;for(Dd=20002;Dd<=20032;Dd++)$d[Dd]=0;for(Dd=20062;Dd<=20092;Dd++)$d[Dd]=0;for(Dd=20135;Dd<=20138;Dd++)$d[Dd]=0;for(Dd=20248;Dd<=20258;Dd++)$d[Dd]=0;for(Dd=20348;Dd<=20358;Dd++)$d[Dd]=0;for(Dd=20436;Dd<=20440;Dd++)$d[Dd]=0;for(Dd=20822;Dd<=20824;Dd++)$d[Dd]=0;for(Dd=20934;Dd<=20936;Dd++)$d[Dd]=0;for(Dd=21035;Dd<=21037;Dd++)$d[Dd]=0;for(Dd=21095;Dd<=21097;Dd++)$d[Dd]=0;for(Dd=21148;Dd<=21150;Dd++)$d[Dd]=0;for(Dd=21413;Dd<=21423;Dd++)$d[Dd]=0;for(Dd=21453;Dd<=21463;Dd++)$d[Dd]=0;for(Dd=21473;Dd<=21483;Dd++)$d[Dd]=0;for(Dd=21780;Dd<=21782;Dd++)$d[Dd]=0;for(Dd=21891;Dd<=21894;Dd++)$d[Dd]=0;for(Dd=21896;Dd<=21899;Dd++)$d[Dd]=0;for(Dd=22171;Dd<=22177;Dd++)$d[Dd]=0;for(Dd=22181;Dd<=22187;Dd++)$d[Dd]=0;for(Dd=22191;Dd<=22197;Dd++)$d[Dd]=0;for(Dd=22234;Dd<=22236;Dd++)$d[Dd]=0;for(Dd=22521;Dd<=22525;Dd++)$d[Dd]=0;for(Dd=22991;Dd<=22994;Dd++)$d[Dd]=0;for(Dd=23028;Dd<=23038;Dd++)$d[Dd]=0;for(Dd=23830;Dd<=23853;Dd++)$d[Dd]=0;for(Dd=23866;Dd<=23872;Dd++)$d[Dd]=0;for(Dd=23877;Dd<=23884;Dd++)$d[Dd]=0;for(Dd=23886;Dd<=23894;Dd++)$d[Dd]=0;for(Dd=23946;Dd<=23948;Dd++)$d[Dd]=0;for(Dd=24311;Dd<=24313;Dd++)$d[Dd]=0;for(Dd=24342;Dd<=24347;Dd++)$d[Dd]=0;for(Dd=24370;Dd<=24374;Dd++)$d[Dd]=10;for(Dd=24375;Dd<=24381;Dd++)$d[Dd]=0;for(Dd=24718;Dd<=24721;Dd++)$d[Dd]=0;for(Dd=24817;Dd<=24821;Dd++)$d[Dd]=0;for(Dd=24877;Dd<=24882;Dd++)$d[Dd]=0;for(Dd=24891;Dd<=24893;Dd++)$d[Dd]=0;for(Dd=25391;Dd<=25395;Dd++)$d[Dd]=0;for(Dd=25828;Dd<=25838;Dd++)$d[Dd]=0;for(Dd=26191;Dd<=26195;Dd++)$d[Dd]=0;for(Dd=26391;Dd<=26393;Dd++)$d[Dd]=0;for(Dd=26701;Dd<=26722;Dd++)$d[Dd]=0;for(Dd=26729;Dd<=26799;Dd++)$d[Dd]=2;for(Dd=26801;Dd<=26803;Dd++)$d[Dd]=2;for(Dd=26811;Dd<=26813;Dd++)$d[Dd]=2;for(Dd=26847;Dd<=26870;Dd++)$d[Dd]=2;for(Dd=26891;Dd<=26899;Dd++)$d[Dd]=0;for(Dd=26901;Dd<=26923;Dd++)$d[Dd]=0;for(Dd=26929;Dd<=26946;Dd++)$d[Dd]=0;for(Dd=26948;Dd<=26998;Dd++)$d[Dd]=0;for(Dd=27037;Dd<=27040;Dd++)$d[Dd]=0;for(Dd=27205;Dd<=27232;Dd++)$d[Dd]=0;for(Dd=27258;Dd<=27260;Dd++)$d[Dd]=0;for(Dd=27391;Dd<=27398;Dd++)$d[Dd]=0;for(Dd=27561;Dd<=27564;Dd++)$d[Dd]=0;for(Dd=27571;Dd<=27574;Dd++)$d[Dd]=0;for(Dd=27581;Dd<=27584;Dd++)$d[Dd]=0;for(Dd=27591;Dd<=27594;Dd++)$d[Dd]=0;for(Dd=28191;Dd<=28193;Dd++)$d[Dd]=0;for(Dd=28348;Dd<=28358;Dd++)$d[Dd]=0;for(Dd=28402;Dd<=28432;Dd++)$d[Dd]=0;for(Dd=28462;Dd<=28492;Dd++)$d[Dd]=0;for(Dd=29118;Dd<=29122;Dd++)$d[Dd]=0;for(Dd=29168;Dd<=29172;Dd++)$d[Dd]=0;for(Dd=29177;Dd<=29185;Dd++)$d[Dd]=0;for(Dd=29187;Dd<=29195;Dd++)$d[Dd]=0;for(Dd=29900;Dd<=29903;Dd++)$d[Dd]=0;for(Dd=30161;Dd<=30179;Dd++)$d[Dd]=0;for(Dd=30491;Dd<=30494;Dd++)$d[Dd]=0;for(Dd=30729;Dd<=30732;Dd++)$d[Dd]=0;for(Dd=31251;Dd<=31259;Dd++)$d[Dd]=0;for(Dd=31265;Dd<=31268;Dd++)$d[Dd]=0;for(Dd=31275;Dd<=31279;Dd++)$d[Dd]=0;for(Dd=31281;Dd<=31297;Dd++)$d[Dd]=0;for(Dd=31461;Dd<=31469;Dd++)$d[Dd]=0;for(Dd=31491;Dd<=31495;Dd++)$d[Dd]=0;for(Dd=31917;Dd<=31922;Dd++)$d[Dd]=0;for(Dd=31965;Dd<=32e3;Dd++)$d[Dd]=0;for(Dd=32001;Dd<=32003;Dd++)$d[Dd]=2;for(Dd=32005;Dd<=32031;Dd++)$d[Dd]=2;for(Dd=32033;Dd<=32060;Dd++)$d[Dd]=2;for(Dd=32064;Dd<=32067;Dd++)$d[Dd]=2;for(Dd=32074;Dd<=32077;Dd++)$d[Dd]=2;for(Dd=32081;Dd<=32086;Dd++)$d[Dd]=0;for(Dd=32107;Dd<=32130;Dd++)$d[Dd]=0;for(Dd=32133;Dd<=32158;Dd++)$d[Dd]=0;for(Dd=32164;Dd<=32167;Dd++)$d[Dd]=2;for(Dd=32180;Dd<=32199;Dd++)$d[Dd]=0;for(Dd=32201;Dd<=32260;Dd++)$d[Dd]=0;for(Dd=32301;Dd<=32360;Dd++)$d[Dd]=0;for(Dd=32601;Dd<=32662;Dd++)$d[Dd]=0;for(Dd=32664;Dd<=32667;Dd++)$d[Dd]=2;for(Dd=32701;Dd<=32761;Dd++)$d[Dd]=0;for(Dd=53001;Dd<=53004;Dd++)$d[Dd]=0;for(Dd=53008;Dd<=53019;Dd++)$d[Dd]=0;for(Dd=53021;Dd<=53032;Dd++)$d[Dd]=0;for(Dd=53034;Dd<=53037;Dd++)$d[Dd]=0;for(Dd=53042;Dd<=53046;Dd++)$d[Dd]=0;for(Dd=53074;Dd<=53080;Dd++)$d[Dd]=0;for(Dd=54001;Dd<=54004;Dd++)$d[Dd]=0;for(Dd=54008;Dd<=54019;Dd++)$d[Dd]=0;for(Dd=54021;Dd<=54032;Dd++)$d[Dd]=0;for(Dd=54034;Dd<=54037;Dd++)$d[Dd]=0;for(Dd=54042;Dd<=54046;Dd++)$d[Dd]=0;for(Dd=54048;Dd<=54053;Dd++)$d[Dd]=0;for(Dd=54074;Dd<=54080;Dd++)$d[Dd]=0;for(Dd=54098;Dd<=54101;Dd++)$d[Dd]=0;for(Dd=102001;Dd<=102040;Dd++)$d[Dd]=0;for(Dd=102042;Dd<=102063;Dd++)$d[Dd]=0;for(Dd=102065;Dd<=102067;Dd++)$d[Dd]=0;for(Dd=102070;Dd<=102117;Dd++)$d[Dd]=0;for(Dd=102122;Dd<=102216;Dd++)$d[Dd]=0;for(Dd=102221;Dd<=102377;Dd++)$d[Dd]=0;for(Dd=102382;Dd<=102388;Dd++)$d[Dd]=0;for(Dd=102389;Dd<=102398;Dd++)$d[Dd]=2;for(Dd=102399;Dd<=102444;Dd++)$d[Dd]=0;for(Dd=102445;Dd<=102447;Dd++)$d[Dd]=2;for(Dd=102448;Dd<=102458;Dd++)$d[Dd]=0;for(Dd=102459;Dd<=102468;Dd++)$d[Dd]=2;for(Dd=102469;Dd<=102499;Dd++)$d[Dd]=0;for(Dd=102500;Dd<=102519;Dd++)$d[Dd]=1;for(Dd=102520;Dd<=102524;Dd++)$d[Dd]=0;for(Dd=102525;Dd<=102529;Dd++)$d[Dd]=2;for(Dd=102530;Dd<=102588;Dd++)$d[Dd]=0;for(Dd=102590;Dd<=102598;Dd++)$d[Dd]=0;for(Dd=102601;Dd<=102603;Dd++)$d[Dd]=0;for(Dd=102605;Dd<=102628;Dd++)$d[Dd]=0;for(Dd=102629;Dd<=102646;Dd++)$d[Dd]=2;for(Dd=102648;Dd<=102700;Dd++)$d[Dd]=2;for(Dd=102701;Dd<=102703;Dd++)$d[Dd]=0;for(Dd=102707;Dd<=102730;Dd++)$d[Dd]=2;for(Dd=102733;Dd<=102758;Dd++)$d[Dd]=2;for(Dd=102767;Dd<=102900;Dd++)$d[Dd]=0;for(Dd=102965;Dd<=102969;Dd++)$d[Dd]=0;for(Dd=102971;Dd<=102973;Dd++)$d[Dd]=0;for(Dd=102975;Dd<=102989;Dd++)$d[Dd]=0;for(Dd=102990;Dd<=102992;Dd++)$d[Dd]=1;for(Dd=102997;Dd<=103002;Dd++)$d[Dd]=0;for(Dd=103003;Dd<=103008;Dd++)$d[Dd]=2;for(Dd=103009;Dd<=103011;Dd++)$d[Dd]=0;for(Dd=103012;Dd<=103014;Dd++)$d[Dd]=2;for(Dd=103019;Dd<=103021;Dd++)$d[Dd]=0;for(Dd=103022;Dd<=103024;Dd++)$d[Dd]=2;for(Dd=103029;Dd<=103031;Dd++)$d[Dd]=0;for(Dd=103032;Dd<=103034;Dd++)$d[Dd]=2;for(Dd=103065;Dd<=103068;Dd++)$d[Dd]=0;for(Dd=103074;Dd<=103076;Dd++)$d[Dd]=0;for(Dd=103077;Dd<=103079;Dd++)$d[Dd]=1;for(Dd=103080;Dd<=103082;Dd++)$d[Dd]=0;for(Dd=103083;Dd<=103085;Dd++)$d[Dd]=2;for(Dd=103090;Dd<=103093;Dd++)$d[Dd]=0;for(Dd=103097;Dd<=103099;Dd++)$d[Dd]=0;for(Dd=103100;Dd<=103102;Dd++)$d[Dd]=2;for(Dd=103107;Dd<=103109;Dd++)$d[Dd]=0;for(Dd=103110;Dd<=103112;Dd++)$d[Dd]=2;for(Dd=103113;Dd<=103116;Dd++)$d[Dd]=0;for(Dd=103117;Dd<=103120;Dd++)$d[Dd]=2;for(Dd=103153;Dd<=103157;Dd++)$d[Dd]=0;for(Dd=103158;Dd<=103162;Dd++)$d[Dd]=2;for(Dd=103163;Dd<=103165;Dd++)$d[Dd]=0;for(Dd=103166;Dd<=103168;Dd++)$d[Dd]=1;for(Dd=103169;Dd<=103171;Dd++)$d[Dd]=2;for(Dd=103186;Dd<=103188;Dd++)$d[Dd]=0;for(Dd=103189;Dd<=103191;Dd++)$d[Dd]=2;for(Dd=103192;Dd<=103195;Dd++)$d[Dd]=0;for(Dd=103196;Dd<=103199;Dd++)$d[Dd]=2;for(Dd=103200;Dd<=103224;Dd++)$d[Dd]=0;for(Dd=103225;Dd<=103227;Dd++)$d[Dd]=1;for(Dd=103232;Dd<=103237;Dd++)$d[Dd]=0;for(Dd=103238;Dd<=103243;Dd++)$d[Dd]=2;for(Dd=103244;Dd<=103246;Dd++)$d[Dd]=0;for(Dd=103247;Dd<=103249;Dd++)$d[Dd]=2;for(Dd=103254;Dd<=103256;Dd++)$d[Dd]=0;for(Dd=103257;Dd<=103259;Dd++)$d[Dd]=2;for(Dd=103264;Dd<=103266;Dd++)$d[Dd]=0;for(Dd=103267;Dd<=103269;Dd++)$d[Dd]=2;for(Dd=103300;Dd<=103375;Dd++)$d[Dd]=0;for(Dd=103381;Dd<=103383;Dd++)$d[Dd]=0;for(Dd=103384;Dd<=103386;Dd++)$d[Dd]=1;for(Dd=103387;Dd<=103389;Dd++)$d[Dd]=0;for(Dd=103390;Dd<=103392;Dd++)$d[Dd]=2;for(Dd=103397;Dd<=103399;Dd++)$d[Dd]=0;for(Dd=103400;Dd<=103471;Dd++)$d[Dd]=2;for(Dd=103476;Dd<=103478;Dd++)$d[Dd]=0;for(Dd=103479;Dd<=103481;Dd++)$d[Dd]=2;for(Dd=103486;Dd<=103488;Dd++)$d[Dd]=0;for(Dd=103489;Dd<=103491;Dd++)$d[Dd]=2;for(Dd=103492;Dd<=103495;Dd++)$d[Dd]=0;for(Dd=103496;Dd<=103499;Dd++)$d[Dd]=2;for(Dd=103528;Dd<=103543;Dd++)$d[Dd]=0;for(Dd=103544;Dd<=103548;Dd++)$d[Dd]=2;for(Dd=103549;Dd<=103551;Dd++)$d[Dd]=0;for(Dd=103552;Dd<=103554;Dd++)$d[Dd]=1;for(Dd=103555;Dd<=103557;Dd++)$d[Dd]=2;for(Dd=103558;Dd<=103560;Dd++)$d[Dd]=0;for(Dd=103571;Dd<=103573;Dd++)$d[Dd]=0;for(Dd=103574;Dd<=103576;Dd++)$d[Dd]=2;for(Dd=103577;Dd<=103580;Dd++)$d[Dd]=0;for(Dd=103581;Dd<=103583;Dd++)$d[Dd]=2;for(Dd=103595;Dd<=103694;Dd++)$d[Dd]=0;for(Dd=103696;Dd<=103699;Dd++)$d[Dd]=0;for(Dd=103700;Dd<=103793;Dd++)$d[Dd]=2;for(Dd=103794;Dd<=103872;Dd++)$d[Dd]=0;for(Dd=103900;Dd<=103971;Dd++)$d[Dd]=2;const zd={102113:!0,102100:!0,3857:!0,3785:!0},Gd={102113:!0,102100:!0,3857:!0,3785:!0,4326:!0},Ud='PROJCS["WGS_1984_Web_Mercator_Auxiliary_Sphere",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator_Auxiliary_Sphere"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],PARAMETER["Auxiliary_Sphere_Type",0.0],UNIT["Meter",1.0]]',qd=[-20037508.342788905,20037508.342788905],Bd=[-20037508.342787,20037508.342787],Wd={102113:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:qd,origin:Bd,dx:1e-5},102100:{wkTemplate:Ud,valid:qd,origin:Bd,dx:1e-5},3785:{wkTemplate:'PROJCS["WGS_1984_Web_Mercator",GEOGCS["GCS_WGS_1984_Major_Auxiliary_Sphere",DATUM["D_WGS_1984_Major_Auxiliary_Sphere",SPHEROID["WGS_1984_Major_Auxiliary_Sphere",6378137.0,0.0]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Mercator"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],PARAMETER["Standard_Parallel_1",0.0],UNIT["Meter",1.0]]',valid:qd,origin:Bd,dx:1e-5},3857:{wkTemplate:Ud,valid:qd,origin:Bd,dx:1e-5},4326:{wkTemplate:'GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",{Central_Meridian}],UNIT["Degree",0.0174532925199433]]',altTemplate:'PROJCS["WGS_1984_Plate_Carree",GEOGCS["GCS_WGS_1984",DATUM["D_WGS_1984",SPHEROID["WGS_1984",6378137.0,298.257223563]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]],PROJECTION["Plate_Carree"],PARAMETER["False_Easting",0.0],PARAMETER["False_Northing",0.0],PARAMETER["Central_Meridian",{Central_Meridian}],UNIT["Degrees",111319.491]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104971:{wkTemplate:'GEOGCS["Mars_2000_(Sphere)",DATUM["Mars_2000_(Sphere)",SPHEROID["Mars_2000_(Sphere)",3396190.0,0.0]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5},104905:{wkTemplate:'GEOGCS["GCS_Mars_2000",DATUM["D_Mars_2000",SPHEROID["Mars_2000_IAU_IAG",3396190.0,169.8944472236118]],PRIMEM["Reference_Meridian",0.0],UNIT["Degree",0.0174532925199433]]',valid:[-180,180],origin:[-180,90],dx:1e-5}};function Hd(t,e){return!c(t)&&!c(e)&&(t===e||(null!=t.wkid||null!=e.wkid?t.wkid===e.wkid||Yd(t)&&Yd(e)||null!=e.latestWkid&&t.wkid===e.latestWkid||null!=t.latestWkid&&e.wkid===t.latestWkid:!(!t.wkt||!e.wkt)&&t.wkt.toUpperCase()===e.wkt.toUpperCase()))}function Jd(t){return sp(t)&&t.wkid?Wd[t.wkid]:null}function Zd(t){return!!sp(t)&&(t.wkid?null==$d[t.wkid]:!!t.wkt&&!!/^\s*GEOGCS/i.test(t.wkt))}function Qd(t){return sp(t)&&4326===t.wkid}function Kd(t){return sp(t)&&4490===t.wkid}function Yd(t){return sp(t)&&null!=t.wkid&&!0===zd[t.wkid]}function Xd(t){return 104971===t||104905===t}function tp(t){return sp(t)&&null!=t.wkid&&Xd(t.wkid)}function ep(t){return 104903===t}function ip(t){return sp(t)&&null!=t.wkid&&ep(t.wkid)}function sp(t){return u(t)&&(null!=t.wkid&&t.wkid>=2e3||null!=t.wkt)}const np={wkid:4326,wkt:rt(Wd[4326].wkTemplate,{Central_Meridian:"0.0"})};var rp;let op=rp=class extends Vd{constructor(t){super(t),this.latestWkid=null,this.wkid=null,this.wkt=null,this.vcsWkid=null,this.latestVcsWkid=null,this.imageCoordinateSystem=null}static fromJSON(t){if(!t)return null;if(t.wkid){if(102100===t.wkid)return rp.WebMercator;if(4326===t.wkid)return rp.WGS84}const e=new rp;return e.read(t),e}normalizeCtorArgs(t){return t&&"object"==typeof t?t:{["string"==typeof t?"wkt":"wkid"]:t}}get isWGS84(){return Qd(this)}get isWebMercator(){return Yd(this)}get isGeographic(){return Zd(this)}get isWrappable(){return function(t){return sp(t)&&null!=t.wkid&&!0===Gd[t.wkid]}(this)}writeWkt(t,e){this.wkid||(e.wkt=t)}clone(){if(this===rp.WGS84)return rp.WGS84;if(this===rp.WebMercator)return rp.WebMercator;const t=new rp;return null!=this.wkid?(t.wkid=this.wkid,null!=this.latestWkid&&(t.latestWkid=this.latestWkid),null!=this.vcsWkid&&(t.vcsWkid=this.vcsWkid),null!=this.latestVcsWkid&&(t.latestVcsWkid=this.latestVcsWkid)):null!=this.wkt&&(t.wkt=this.wkt),this.imageCoordinateSystem&&(t.imageCoordinateSystem=H(this.imageCoordinateSystem)),t}equals(t){if(null==t)return!1;if(this.imageCoordinateSystem||t.imageCoordinateSystem){if(null==this.imageCoordinateSystem||null==t.imageCoordinateSystem)return!1;const{id:e,referenceServiceName:i}=t.imageCoordinateSystem,{geodataXform:s}=t.imageCoordinateSystem,n=this.imageCoordinateSystem;return null==e||s?JSON.stringify(n)===JSON.stringify(t.imageCoordinateSystem):i?n.id===e&&n.referenceServiceName===i:n.id===e}return Hd(this,t)}toJSON(t){return this.write(void 0,t)}};op.GCS_NAD_1927=null,op.WGS84=null,op.WebMercator=null,op.PlateCarree=null,e([oe({readOnly:!0})],op.prototype,"isWGS84",null),e([oe({readOnly:!0})],op.prototype,"isWebMercator",null),e([oe({readOnly:!0})],op.prototype,"isGeographic",null),e([oe({readOnly:!0})],op.prototype,"isWrappable",null),e([oe({type:Rt,json:{write:!0}})],op.prototype,"latestWkid",void 0),e([oe({type:Rt,json:{write:!0,origins:{"web-scene":{write:{overridePolicy(){return{isRequired:null===this.wkt}}}}}}})],op.prototype,"wkid",void 0),e([oe({type:String,json:{origins:{"web-scene":{write:{overridePolicy(){return{isRequired:null===this.wkid}}}}}}})],op.prototype,"wkt",void 0),e([xd("wkt"),xd("web-scene","wkt")],op.prototype,"writeWkt",null),e([oe({type:Rt,json:{write:!0}})],op.prototype,"vcsWkid",void 0),e([oe({type:Rt,json:{write:!0}})],op.prototype,"latestVcsWkid",void 0),e([oe()],op.prototype,"imageCoordinateSystem",void 0),op=rp=e([si("esri.geometry.SpatialReference")],op),op.prototype.toJSON.isDefaultToJSON=!0,op.GCS_NAD_1927=new op({wkid:4267,wkt:'GEOGCS["GCS_North_American_1927",DATUM["D_North_American_1927",SPHEROID["Clarke_1866",6378206.4,294.9786982]],PRIMEM["Greenwich",0.0],UNIT["Degree",0.0174532925199433]]'}),op.WGS84=new op(np),op.WebMercator=new op({wkid:102100,latestWkid:3857}),op.PlateCarree=new op({wkid:32662}),Object.freeze&&(Object.freeze(op.GCS_NAD_1927),Object.freeze(op.WGS84),Object.freeze(op.WebMercator));const ap=op;let lp=class extends Vd{constructor(...t){super(...t),this.type=null,this.hasM=!1,this.hasZ=!1,this.spatialReference=ap.WGS84}get cache(){return this.commitProperty("spatialReference"),{}}get extent(){return null}readSpatialReference(t,e){if(t instanceof ap)return t;if(null!=t){const i=new ap;return i.read(t,e),i}return t}clone(){return console.warn(".clone() is not implemented for "+this.declaredClass),null}clearCache(){this.notifyChange("cache")}getCacheValue(t){return this.cache[t]}setCacheValue(t,e){this.cache[t]=e}};e([oe()],lp.prototype,"type",void 0),e([oe({readOnly:!0})],lp.prototype,"cache",null),e([oe({readOnly:!0})],lp.prototype,"extent",null),e([oe({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],lp.prototype,"hasM",void 0),e([oe({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],lp.prototype,"hasZ",void 0),e([oe({type:ap,json:{write:!0}})],lp.prototype,"spatialReference",void 0),e([Sd("spatialReference")],lp.prototype,"readSpatialReference",null),lp=e([si("esri.geometry.Geometry")],lp);const up=lp;class cp{constructor(t,e,i,s){this.semiMajorAxis=t,this.flattening=e,this.outerAtmosphereRimWidth=i,this.semiMinorAxis=this.semiMajorAxis*(1-this.flattening),this.halfSemiMajorAxis=this.semiMajorAxis/2,this.halfCircumference=Math.PI*this.semiMajorAxis,this.metersPerDegree=this.halfCircumference/180,this.inverseFlattening=1/(1-this.flattening)-1,this.eccentricitySquared=s||2*this.flattening-this.flattening*this.flattening,this.meanRadiusSemiAxes=(2*this.semiMajorAxis+this.semiMinorAxis)/3}get radius(){return this.semiMajorAxis}}const hp=new cp(6378137,1/298.257223563,3e5,.006694379990137799),dp=new cp(3396190,1/169.8944472236118,23e4),pp=new cp(1737400,0,0);function fp(t){return 57.29577951308232*t}function yp(t){return.017453292519943*t}function mp(t){return Math.PI/2-2*Math.atan(Math.exp(-t/hp.radius))}function gp(t){return null!=t.wkid||null!=t.wkt}const vp=[0,0];function wp(t,e,i,s,n){const r=t,o=n;if(o.spatialReference=i,"x"in r&&"x"in o)[o.x,o.y]=e(r.x,r.y,vp,s);else if("xmin"in r&&"xmin"in o)[o.xmin,o.ymin]=e(r.xmin,r.ymin,vp,s),[o.xmax,o.ymax]=e(r.xmax,r.ymax,vp,s);else if("paths"in r&&"paths"in o||"rings"in r&&"rings"in o){const t="paths"in r?r.paths:r.rings,i=[];let n;for(let r=0;r<t.length;r++){const o=t[r];n=[],i.push(n);for(let t=0;t<o.length;t++)n.push(e(o[t][0],o[t][1],[0,0],s)),o[t].length>2&&n[t].push(o[t][2]),o[t].length>3&&n[t].push(o[t][3])}"paths"in o?o.paths=i:o.rings=i}else if("points"in r&&"points"in o){const t=r.points,i=[];for(let n=0;n<t.length;n++)i[n]=e(t[n][0],t[n][1],[0,0],s),t[n].length>2&&i[n].push(t[n][2]),t[n].length>3&&i[n].push(t[n][3]);o.points=i}return n}function bp(t,e){const i=t&&(gp(t)?t:t.spatialReference),s=e&&(gp(e)?e:e.spatialReference);return!(t&&"type"in t&&"mesh"===t.type||e&&"type"in e&&"mesh"===e.type||!i||!s)&&(!!Hd(s,i)||Yd(s)&&Qd(i)||Yd(i)&&Qd(s))}function Mp(t,e){if(c(t))return null;const i=t.spatialReference,s=e&&(gp(e)?e:e.spatialReference);return bp(i,s)?Hd(i,s)?H(t):Yd(s)?wp(t,Sp,ap.WebMercator,!1,H(t)):Qd(s)?wp(t,xp,ap.WGS84,!1,H(t)):null:null}function Sp(t,e,i=[0,0]){e>89.99999?e=89.99999:e<-89.99999&&(e=-89.99999);const s=yp(e);return i[0]=yp(t)*hp.radius,i[1]=hp.halfSemiMajorAxis*Math.log((1+Math.sin(s))/(1-Math.sin(s))),i}function xp(t,e,i=[0,0],s=!1){const n=fp(t/hp.radius);return i[0]=s?n:n-360*Math.floor((n+180)/360),i[1]=fp(Math.PI/2-2*Math.atan(Math.exp(-e/hp.radius))),i}function kp(t,e=!1,i=H(t)){return wp(t,Sp,ap.WebMercator,e,i)}function Ip(t,e=!1,i=H(t)){return wp(t,xp,ap.WGS84,e,i)}var jp;const _p=[0,0];function Tp(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}const Op=ct.getLogger("esri.geometry.Point");let Ap=jp=class extends up{constructor(...t){super(...t),this.x=0,this.y=0,this.z=void 0,this.m=void 0,this.type="point"}static copy(t,e){e._set("x",t._get("x")),e._set("y",t._get("y")),e._set("z",t._get("z")),e._set("m",t._get("m"));const i=t._get("spatialReference");e._set("spatialReference",Object.isFrozen(i)?i:i.clone())}normalizeCtorArgs(t,e,i,s,n){let r;if(Array.isArray(t))r=t,n=e,t=r[0],e=r[1],i=r[2],s=r[3];else if(t&&"object"==typeof t){if(r=t,t=null!=r.x?r.x:r.longitude,e=null!=r.y?r.y:r.latitude,i=r.z,s=r.m,(n=r.spatialReference)&&"esri.geometry.SpatialReference"!==n.declaredClass&&(n=new ap(n)),null!=r.longitude||null!=r.latitude)if(null==r.longitude)Op.warn(".longitude=","Latitude was defined without longitude");else if(null==r.latitude)Op.warn(".latitude=","Longitude was defined without latitude");else if(!r.declaredClass&&n&&n.isWebMercator){const i=Sp(r.longitude,r.latitude,_p);t=i[0],e=i[1]}}else Tp(i)?(n=i,i=null):Tp(s)&&(n=s,s=null);const o={x:t,y:e};return null==o.x&&null!=o.y?Op.warn(".y=","Y coordinate was defined without an X coordinate"):null==o.y&&null!=o.x&&Op.warn(".x=","X coordinate was defined without a Y coordinate"),null!=n&&(o.spatialReference=n),null!=i&&(o.z=i),null!=s&&(o.m=s),o}get cache(){return this.commitProperty("x"),this.commitProperty("y"),this.commitProperty("z"),this.commitProperty("m"),this.commitProperty("spatialReference"),{}}get hasM(){return void 0!==this.m}set hasM(t){t!==(void 0!==this._get("m"))&&(this._set("m",t?0:void 0),this._set("hasM",t))}get hasZ(){return void 0!==this.z}set hasZ(t){t!==(void 0!==this._get("z"))&&(this._set("z",t?0:void 0),this._set("hasZ",t))}get latitude(){const{spatialReference:t,x:e,y:i}=this;if(t){if(t.isWebMercator)return xp(e,i,_p)[1];if(t.isGeographic)return i}return null}set latitude(t){const{spatialReference:e,x:i}=this;e&&(e.isWebMercator?this._set("y",Sp(i,t,_p)[1]):e.isGeographic&&this._set("y",t),this._set("latitude",t))}get longitude(){const{x:t,y:e,spatialReference:i}=this;if(i){if(i.isWebMercator)return xp(t,e,_p)[0];if(i.isGeographic)return t}return null}set longitude(t){const{y:e,spatialReference:i}=this;i&&(i.isWebMercator?this._set("x",Sp(t,e,_p)[0]):i.isGeographic&&this._set("x",t),this._set("longitude",t))}writeX(t,e,i){e[i]=isNaN(t)?"NaN":t}readX(t){return"string"==typeof t?NaN:t}clone(){const t=new jp;return t.x=this.x,t.y=this.y,t.z=this.z,t.m=this.m,t.spatialReference=this.spatialReference,t}copy(t){return jp.copy(t,this),this}equals(t){if(!t)return!1;const{x:e,y:i,z:s,m:n,spatialReference:r}=this,{z:o,m:a}=t;let{x:l,y:u,spatialReference:c}=t;if(!r.equals(c))if(r.isWebMercator&&c.isWGS84)[l,u]=Sp(l,u),c=r;else{if(!r.isWGS84||!c.isWebMercator)return!1;[l,u]=xp(l,u),c=r}return e===l&&i===u&&s===o&&n===a&&r.wkid===c.wkid}offset(t,e,i){return function(t,e,i,s){var n;return t.x=t.x+e,t.y=t.y+i,null!=s&&(t.z=(null!=(n=t.z)?n:0)+s),t}(this,t,e,i)}normalize(){if(!this.spatialReference)return this;const t=Jd(this.spatialReference);if(!t)return this;let e=this.x;const[i,s]=t.valid,n=2*s;let r;return e>s?(r=Math.ceil(Math.abs(e-s)/n),e-=r*n):e<i&&(r=Math.ceil(Math.abs(e-i)/n),e+=r*n),this._set("x",e),this}distance(t){return function(t,e){const i=t.x-e.x,s=t.y-e.y,n=t.hasZ&&e.hasZ?t.z-e.z:0;return Math.sqrt(i*i+s*s+n*n)}(this,t)}toArray(){const t=this.hasZ,e=this.hasM;return t&&e?[this.x,this.y,this.z,this.m]:t?[this.x,this.y,this.z]:e?[this.x,this.y,this.m]:[this.x,this.y]}toJSON(t){return this.write({},t)}};e([oe({readOnly:!0})],Ap.prototype,"cache",null),e([oe({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Ap.prototype,"hasM",null),e([oe({type:Boolean,json:{read:!1,write:{enabled:!1,overridePolicy:null}}})],Ap.prototype,"hasZ",null),e([oe({type:Number})],Ap.prototype,"latitude",null),e([oe({type:Number})],Ap.prototype,"longitude",null),e([oe({type:Number,json:{type:[Number,String],write:{isRequired:!0,allowNull:!0}}}),ba((t=>isNaN(t)?t:gt(t)))],Ap.prototype,"x",void 0),e([xd("x")],Ap.prototype,"writeX",null),e([Sd("x")],Ap.prototype,"readX",null),e([oe({type:Number,json:{write:!0}})],Ap.prototype,"y",void 0),e([oe({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasZ}}}}})],Ap.prototype,"z",void 0),e([oe({type:Number,json:{write:{overridePolicy(){return{enabled:this.hasM}}}}})],Ap.prototype,"m",void 0),Ap=jp=e([si("esri.geometry.Point")],Ap),Ap.prototype.toJSON.isDefaultToJSON=!0;const Fp=Ap,Cp=[0,0];function Pp(t,e){return!!u(e)&&Np(t,e.x,e.y,e.z)}function Ep(t,e){if(!e.points||e.points.length)return!1;for(const i of e.points)if(!Rp(t,i))return!1;return!0}function Rp(t,e){return Np(t,e[0],e[1])}function Lp(t,e){return Np(t,e[0],e[1],e[2])}function Np(t,e,i,s){return e>=t.xmin&&e<=t.xmax&&i>=t.ymin&&i<=t.ymax&&(null==s||!t.hasZ||s>=t.zmin&&s<=t.zmax)}function Dp(t,e){return Cp[1]=e.y,Cp[0]=e.x,Vp(t,Cp)}function Vp(t,e){return function(t,e){if(!t)return!1;if(function(t){return!Array.isArray(t[0][0])}(t))return $p(!1,t,e);let i=!1;for(let s=0,n=t.length;s<n;s++)i=$p(i,t[s],e);return i}(t.rings,e)}function $p(t,e,i){const[s,n]=i;let r=t,o=0;for(let t=0,i=e.length;t<i;t++){o++,o===i&&(o=0);const[a,l]=e[t],[u,c]=e[o];(l<n&&c>=n||c<n&&l>=n)&&a+(n-l)/(c-l)*(u-a)<s&&(r=!r)}return r}function zp(t,e){return Pp(t,e)}function Gp(t,e){let i,s,n;if(t.xmin<=e.xmin){if(i=e.xmin,t.xmax<i)return!1}else if(i=t.xmin,e.xmax<i)return!1;if(t.ymin<=e.ymin){if(s=e.ymin,t.ymax<s)return!1}else if(s=t.ymin,e.ymax<s)return!1;if(t.hasZ&&e.hasZ&&e.hasZ)if(t.zmin<=e.zmin){if(n=e.zmin,t.zmax<n)return!1}else if(n=t.zmin,e.zmax<n)return!1;return!0}function Up(t,e){const{points:i,hasZ:s}=e,n=s?Lp:Rp;for(const e of i)if(n(t,e))return!0;return!1}const qp=[0,0],Bp=[0,0],Wp=[0,0],Hp=[0,0],Jp=[qp,Bp,Wp,Hp],Zp=[[Wp,qp],[qp,Bp],[Bp,Hp],[Hp,Wp]];function Qp(t,e){qp[0]=t.xmin,qp[1]=t.ymax,Bp[0]=t.xmax,Bp[1]=t.ymax,Wp[0]=t.xmin,Wp[1]=t.ymin,Hp[0]=t.xmax,Hp[1]=t.ymin;for(const t of Jp)if(Vp(e,t))return!0;for(const i of e.rings){if(!i.length)continue;let e=i[0];if(Rp(t,e))return!0;for(let s=1;s<i.length;s++){const n=i[s];if(Rp(t,n)||Xp(e,n,Zp))return!0;e=n}}return!1}function Kp(t,e){qp[0]=t.xmin,qp[1]=t.ymax,Bp[0]=t.xmax,Bp[1]=t.ymax,Wp[0]=t.xmin,Wp[1]=t.ymin,Hp[0]=t.xmax,Hp[1]=t.ymin;const i=e.paths;for(const e of i){if(!i.length)continue;let s=e[0];if(Rp(t,s))return!0;for(let i=1;i<e.length;i++){const n=e[i];if(Rp(t,n)||Xp(s,n,Zp))return!0;s=n}}return!1}const Yp=[0,0];function Xp(t,e,i){for(let s=0;s<i.length;s++)if(tf(t,e,i[s][0],i[s][1]))return!0;return!1}function tf(t,e,i,s,n){const[r,o]=t,[a,l]=e,[u,c]=i,[h,d]=s,p=h-u,f=r-u,y=a-r,m=d-c,g=o-c,v=l-o,w=m*y-p*v;if(0===w)return!1;const b=(p*g-m*f)/w,M=(y*g-v*f)/w;return b>=0&&b<=1&&M>=0&&M<=1&&(n&&(n[0]=r+b*(a-r),n[1]=o+b*(l-o)),!0)}function ef(t){switch(t){case"esriGeometryEnvelope":case"extent":return Gp;case"esriGeometryMultipoint":case"multipoint":return Up;case"esriGeometryPoint":case"point":return zp;case"esriGeometryPolygon":case"polygon":return Qp;case"esriGeometryPolyline":case"polyline":return Kp}}var sf;function nf(t,e,i){return null==e?i:null==i?e:t(e,i)}let rf=sf=class extends up{constructor(...t){super(...t),this.type="extent",this.xmin=0,this.ymin=0,this.mmin=void 0,this.zmin=void 0,this.xmax=0,this.ymax=0,this.mmax=void 0,this.zmax=void 0}normalizeCtorArgs(t,e,i,s,n){return function(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}(t)?{spatialReference:t,xmin:0,ymin:0,xmax:0,ymax:0}:"object"==typeof t?(t.spatialReference=null==t.spatialReference?ap.WGS84:t.spatialReference,t):{xmin:t,ymin:e,xmax:i,ymax:s,spatialReference:null==n?ap.WGS84:n}}static fromBounds(t,e){return new sf({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}static fromPoint(t){return new sf({xmin:t.x,ymin:t.y,zmin:t.z,xmax:t.x,ymax:t.y,zmax:t.z,spatialReference:t.spatialReference})}get cache(){return this.commitProperty("xmin"),this.commitProperty("ymin"),this.commitProperty("zmin"),this.commitProperty("mmin"),this.commitProperty("xmax"),this.commitProperty("ymax"),this.commitProperty("zmax"),this.commitProperty("mmax"),this.commitProperty("spatialReference"),{}}get center(){const t=new Fp({x:.5*(this.xmin+this.xmax),y:.5*(this.ymin+this.ymax),spatialReference:this.spatialReference});return this.hasZ&&(t.z=.5*(this.zmin+this.zmax)),this.hasM&&(t.m=.5*(this.mmin+this.mmax)),t}get extent(){return this.clone()}get hasM(){return null!=this.mmin&&null!=this.mmax}get hasZ(){return null!=this.zmin&&null!=this.zmax}get height(){return Math.abs(this.ymax-this.ymin)}get width(){return Math.abs(this.xmax-this.xmin)}centerAt(t){const e=this.center;return null!=t.z&&this.hasZ?this.offset(t.x-e.x,t.y-e.y,t.z-e.z):this.offset(t.x-e.x,t.y-e.y)}clone(){const t=new sf;return t.xmin=this.xmin,t.ymin=this.ymin,t.xmax=this.xmax,t.ymax=this.ymax,t.spatialReference=this.spatialReference,null!=this.zmin&&(t.zmin=this.zmin,t.zmax=this.zmax),null!=this.mmin&&(t.mmin=this.mmin,t.mmax=this.mmax),t}contains(t){if(!t)return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&bp(e,i)&&(t=e.isWebMercator?kp(t):Ip(t,!0)),"point"===t.type?Pp(this,t):"extent"===t.type&&function(t,e){const{xmin:i,ymin:s,zmin:n,xmax:r,ymax:o,zmax:a}=e;return t.hasZ&&e.hasZ?Np(t,i,s,n)&&Np(t,i,o,n)&&Np(t,r,o,n)&&Np(t,r,s,n)&&Np(t,i,s,a)&&Np(t,i,o,a)&&Np(t,r,o,a)&&Np(t,r,s,a):Np(t,i,s)&&Np(t,i,o)&&Np(t,r,o)&&Np(t,r,s)}(this,t)}equals(t){if(this===t)return!0;if(c(t))return!1;const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&bp(e,i)&&(t=e.isWebMercator?kp(t):Ip(t,!0)),this.xmin===t.xmin&&this.ymin===t.ymin&&this.zmin===t.zmin&&this.mmin===t.mmin&&this.xmax===t.xmax&&this.ymax===t.ymax&&this.zmax===t.zmax&&this.mmax===t.mmax}expand(t){const e=.5*(1-t),i=this.width*e,s=this.height*e;if(this.xmin+=i,this.ymin+=s,this.xmax-=i,this.ymax-=s,this.hasZ){const t=(this.zmax-this.zmin)*e;this.zmin+=t,this.zmax-=t}if(this.hasM){const t=(this.mmax-this.mmin)*e;this.mmin+=t,this.mmax-=t}return this}intersects(t){if(c(t))return!1;"mesh"===t.type&&(t=t.extent);const e=this.spatialReference,i=t.spatialReference;return e&&i&&!e.equals(i)&&bp(e,i)&&(t=e.isWebMercator?kp(t):Ip(t,!0)),ef(t.type)(this,t)}normalize(){const t=this._normalize(!1,!0);return Array.isArray(t)?t:[t]}offset(t,e,i){return this.xmin+=t,this.ymin+=e,this.xmax+=t,this.ymax+=e,null!=i&&(this.zmin+=i,this.zmax+=i),this}shiftCentralMeridian(){return this._normalize(!0)}union(t){return this===t||(this.xmin=Math.min(this.xmin,t.xmin),this.ymin=Math.min(this.ymin,t.ymin),this.xmax=Math.max(this.xmax,t.xmax),this.ymax=Math.max(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=nf(Math.min,this.zmin,t.zmin),this.zmax=nf(Math.max,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=nf(Math.min,this.mmin,t.mmin),this.mmax=nf(Math.max,this.mmax,t.mmax))),this}intersection(t){return this===t?this:c(t)||!this.intersects(t)?null:(this.xmin=Math.max(this.xmin,t.xmin),this.ymin=Math.max(this.ymin,t.ymin),this.xmax=Math.min(this.xmax,t.xmax),this.ymax=Math.min(this.ymax,t.ymax),(this.hasZ||t.hasZ)&&(this.zmin=nf(Math.max,this.zmin,t.zmin),this.zmax=nf(Math.min,this.zmax,t.zmax)),(this.hasM||t.hasM)&&(this.mmin=nf(Math.max,this.mmin,t.mmin),this.mmax=nf(Math.min,this.mmax,t.mmax)),this)}toJSON(t){return this.write({},t)}_shiftCM(t=Jd(this.spatialReference)){if(!t||!this.spatialReference)return this;const e=this.spatialReference,i=this._getCM(t);if(i){const s=e.isWebMercator?Ip(i):i;this.xmin-=i.x,this.xmax-=i.x,e.isWebMercator||(s.x=this._normalizeX(s.x,t).x),this.spatialReference=new ap(rt(e.isWGS84?t.altTemplate:t.wkTemplate,{Central_Meridian:s.x}))}return this}_getCM(t){let e=null;const[i,s]=t.valid,n=this.xmin,r=this.xmax;return n>=i&&n<=s&&r>=i&&r<=s||(e=this.center),e}_normalize(t,e,i){const s=this.spatialReference;if(!s)return this;if(!(i=i||Jd(s)))return this;const n=this._getParts(i).map((t=>t.extent));if(n.length<2)return n[0]||this;if(n.length>2)return t?this._shiftCM(i):this.set({xmin:i.valid[0],xmax:i.valid[1]});if(t)return this._shiftCM(i);if(e)return n;let r=!0,o=!0;return n.forEach((t=>{t.hasZ||(r=!1),t.hasM||(o=!1)})),{rings:n.map((t=>{const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];if(r){const i=(t.zmax-t.zmin)/2;for(let t=0;t<e.length;t++)e[t].push(i)}if(o){const i=(t.mmax-t.mmin)/2;for(let t=0;t<e.length;t++)e[t].push(i)}return e})),hasZ:r,hasM:o,spatialReference:s}}_getParts(t){let e=this.cache._parts;if(!e){e=[];const{ymin:i,ymax:s,spatialReference:n}=this,r=this.width,o=this.xmin,a=this.xmax;let l;t=t||Jd(n);const[u,c]=t.valid;l=this._normalizeX(this.xmin,t);const h=l.x,d=l.frameId;l=this._normalizeX(this.xmax,t);const p=l.x,f=l.frameId,y=h===p&&r>0;if(r>2*c){const t=new sf(o<a?h:p,i,c,s,n),r=new sf(u,i,o<a?p:h,s,n),l=new sf(0,i,c,s,n),y=new sf(u,i,0,s,n),m=[],g=[];t.contains(l)&&m.push(d),t.contains(y)&&g.push(d),r.contains(l)&&m.push(f),r.contains(y)&&g.push(f);for(let t=d+1;t<f;t++)m.push(t),g.push(t);e.push({extent:t,frameIds:[d]},{extent:r,frameIds:[f]},{extent:l,frameIds:m},{extent:y,frameIds:g})}else h>p||y?e.push({extent:new sf(h,i,c,s,n),frameIds:[d]},{extent:new sf(u,i,p,s,n),frameIds:[f]}):e.push({extent:new sf(h,i,p,s,n),frameIds:[d]});this.cache._parts=e}const i=this.hasZ,s=this.hasM;if(i||s){const t={};i&&(t.zmin=this.zmin,t.zmax=this.zmax),s&&(t.mmin=this.mmin,t.mmax=this.mmax);for(let i=0;i<e.length;i++)e[i].extent.set(t)}return e}_normalizeX(t,e){const[i,s]=e.valid,n=2*s;let r,o=0;return t>s?(r=Math.ceil(Math.abs(t-s)/n),t-=r*n,o=r):t<i&&(r=Math.ceil(Math.abs(t-i)/n),t+=r*n,o=-r),{x:t,frameId:o}}};e([oe({readOnly:!0})],rf.prototype,"cache",null),e([oe({readOnly:!0})],rf.prototype,"center",null),e([oe({readOnly:!0})],rf.prototype,"extent",null),e([oe({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],rf.prototype,"hasM",null),e([oe({readOnly:!0,json:{write:{enabled:!1,overridePolicy:null}}})],rf.prototype,"hasZ",null),e([oe({readOnly:!0})],rf.prototype,"height",null),e([oe({readOnly:!0})],rf.prototype,"width",null),e([oe({type:Number,json:{type:[Number,String],write:{enabled:!0,allowNull:!0}}})],rf.prototype,"xmin",void 0),e([oe({type:Number,json:{write:!0}})],rf.prototype,"ymin",void 0),e([oe({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],rf.prototype,"mmin",void 0),e([oe({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],rf.prototype,"zmin",void 0),e([oe({type:Number,json:{write:!0}})],rf.prototype,"xmax",void 0),e([oe({type:Number,json:{write:!0}})],rf.prototype,"ymax",void 0),e([oe({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasM}}}}})],rf.prototype,"mmax",void 0),e([oe({type:Number,json:{origins:{"web-scene":{write:!1}},write:{overridePolicy(){return{enabled:this.hasZ}}}}})],rf.prototype,"zmax",void 0),rf=sf=e([si("esri.geometry.Extent")],rf),rf.prototype.toJSON.isDefaultToJSON=!0;const of=rf;function af(t,e,i=!1){let{hasM:s,hasZ:n}=t;Array.isArray(e)?4!==e.length||s||n?3===e.length&&i&&!s?(n=!0,s=!1):3===e.length&&s&&n&&(s=!1,n=!1):(s=!0,n=!0):(n=!n&&e.hasZ&&(!s||e.hasM),s=!s&&e.hasM&&(!n||e.hasZ)),t.hasZ=n,t.hasM=s}var lf;function uf(t){return(e,i)=>null==e?i:null==i?e:t(e,i)}let cf=lf=class extends up{constructor(...t){super(...t),this.points=[],this.type="multipoint"}normalizeCtorArgs(t,e){if(!t&&!e)return null;const i={};Array.isArray(t)?(i.points=t,i.spatialReference=e):function(t){return t&&("esri.geometry.SpatialReference"===t.declaredClass||null!=t.wkid)}(t)?i.spatialReference=t:(t.points&&(i.points=t.points),t.spatialReference&&(i.spatialReference=t.spatialReference),t.hasZ&&(i.hasZ=t.hasZ),t.hasM&&(i.hasM=t.hasM));const s=i.points&&i.points[0];return s&&(void 0===i.hasZ&&void 0===i.hasM?(i.hasZ=s.length>2,i.hasM=!1):void 0===i.hasZ?i.hasZ=s.length>3:void 0===i.hasM&&(i.hasM=s.length>3)),i}get cache(){return this.commitProperty("points"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const t=this.points;if(!t.length)return null;const e=new of,i=this.hasZ,s=this.hasM,n=i?3:2,r=t[0],o=uf(Math.min),a=uf(Math.max);let l,u,c,h,[d,p]=r,[f,y]=r;for(let e=0,r=t.length;e<r;e++){const r=t[e],[m,g]=r;if(d=o(d,m),p=o(p,g),f=a(f,m),y=a(y,g),i&&r.length>2){const t=r[2];l=o(l,t),c=a(c,t)}if(s&&r.length>n){const t=r[n];u=o(u,t),h=a(h,t)}}return e.xmin=d,e.ymin=p,e.xmax=f,e.ymax=y,e.spatialReference=this.spatialReference,i?(e.zmin=l,e.zmax=c):(e.zmin=null,e.zmax=null),s?(e.mmin=u,e.mmax=h):(e.mmin=null,e.mmax=null),e}writePoints(t,e){e.points=H(this.points)}addPoint(t){return af(this,t),this.points.push(Array.isArray(t)?t:t.toArray()),this.notifyChange("points"),this}clone(){const t={points:H(this.points),spatialReference:this.spatialReference};return this.hasZ&&(t.hasZ=!0),this.hasM&&(t.hasM=!0),new lf(t)}getPoint(t){if(!this._validateInputs(t))return null;const e=this.points[t],i={x:e[0],y:e[1],spatialReference:this.spatialReference};let s=2;return this.hasZ&&(i.z=e[2],s=3),this.hasM&&(i.m=e[s]),new Fp(i)}removePoint(t){if(!this._validateInputs(t))return null;const e=new Fp(this.points.splice(t,1)[0],this.spatialReference);return this.notifyChange("points"),e}setPoint(t,e){return this._validateInputs(t)?(af(this,e),Array.isArray(e)||(e=e.toArray()),this.points[t]=e,this.notifyChange("points"),this):this}toJSON(t){return this.write({},t)}_validateInputs(t){return null!=t&&t>=0&&t<this.points.length}};e([oe({readOnly:!0})],cf.prototype,"cache",null),e([oe()],cf.prototype,"extent",null),e([oe({type:[[Number]],json:{write:{isRequired:!0}}})],cf.prototype,"points",void 0),e([xd("points")],cf.prototype,"writePoints",null),cf=lf=e([si("esri.geometry.Multipoint")],cf),cf.prototype.toJSON.isDefaultToJSON=!0;const hf=cf;function df(t,e){const i=e[0]-t[0],s=e[1]-t[1];if(t.length>2&&e.length>2){const n=t[2]-e[2];return Math.sqrt(i*i+s*s+n*n)}return Math.sqrt(i*i+s*s)}function pf(t,e,i,s){const[n,r]=e,[o,a]=i[s],[l,u]=i[s+1],c=l-o,h=u-a,d=Math.min(1,Math.max(0,((n-o)*c+(r-a)*h)/(c*c+h*h)));return t[0]=o+c*d,t[1]=a+h*d,t}function ff(t,e){return function(t,e){const i=t[0]+.5*(e[0]-t[0]),s=t[1]+.5*(e[1]-t[1]);return t.length>2&&e.length>2?[i,s,t[2]+.5*(e[2]-t[2])]:[i,s]}(t,e)}function yf(t,e,i){const s=t.length;let n=0,r=0,o=0;for(let a=0;a<s;a++){const l=t[a],u=t[(a+1)%s];let c=2;n+=l[0]*u[1]-u[0]*l[1],l.length>2&&u.length>2&&i&&(r+=l[0]*u[2]-u[0]*l[2],c=3),l.length>c&&u.length>c&&e&&(o+=l[0]*u[c]-u[0]*l[c])}return n<=0&&r<=0&&o<=0}function mf(t){if("rings"in t){for(const e of t.rings)e.length<3||e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]||e.push([e[0][0],e[0][1]]);if(t.rings.length>0&&!yf(t.rings[0],t.hasM,t.hasZ))for(let e=0;e<t.rings.length;++e)t.rings[e]=t.rings[e].reverse()}}function gf(t){return t?function(t,e){if(!t||!t.length)return null;const i=[],s=[],n=e?[1/0,-1/0,1/0,-1/0,1/0,-1/0]:[1/0,-1/0,1/0,-1/0];for(let i=0,r=t.length;i<r;i++){const r=vf(t[i],e,n);r&&s.push(r)}if(s.sort(((t,i)=>{let s=t[2]-i[2];return 0===s&&e&&(s=t[4]-i[4]),s})),s.length&&(i[0]=s[0][0],i[1]=s[0][1],e&&(i[2]=s[0][3]),(i[0]<n[0]||i[0]>n[1]||i[1]<n[2]||i[1]>n[3]||e&&(i[2]<n[4]||i[2]>n[5]))&&(i.length=0)),!i.length){const s=t[0]&&t[0].length?function(t,e){const i=e?[0,0,0]:[0,0],s=e?[0,0,0]:[0,0];let n=0,r=0,o=0,a=0;for(let l=0,u=t.length;l<u-1;l++){const u=t[l],c=t[l+1];if(u&&c){i[0]=u[0],i[1]=u[1],s[0]=c[0],s[1]=c[1],e&&u.length>2&&c.length>2&&(i[2]=u[2],s[2]=c[2]);const t=df(i,s);if(t){n+=t;const i=ff(u,c);r+=t*i[0],o+=t*i[1],e&&i.length>2&&(a+=t*i[2])}}}return n>0?e?[r/n,o/n,a/n]:[r/n,o/n]:t.length?t[0]:null}(t[0],e):null;if(!s)return null;i[0]=s[0],i[1]=s[1],e&&s.length>2&&(i[2]=s[2])}return i}(t.rings,t.hasZ):null}function vf(t,e,i){let s=0,n=0,r=0,o=0,a=0;const l=t.length?t[0][0]:0,u=t.length?t[0][1]:0,c=t.length&&e?t[0][2]:0;for(let h=0;h<t.length;h++){const d=t[h],p=t[(h+1)%t.length],[f,y,m]=d,g=f-l,v=y-u,w=e?m-c:void 0,[b,M,S]=p,x=b-l,k=M-u,I=e?S-c:void 0,j=g*k-x*v;if(o+=j,s+=(g+x)*j,n+=(v+k)*j,e&&d.length>2&&p.length>2){const t=g*I-x*w;r+=(w+I)*t,a+=t}f<i[0]&&(i[0]=f),f>i[1]&&(i[1]=f),y<i[2]&&(i[2]=y),y>i[3]&&(i[3]=y),e&&(m<i[4]&&(i[4]=m),m>i[5]&&(i[5]=m))}if(o>0&&(o*=-1),a>0&&(a*=-1),!o)return null;o*=.5,a*=.5;const h=[s/(6*o)+l,n/(6*o)+u,o];return e&&(i[4]===i[5]||0===a?(h[3]=(i[4]+i[5])/2,h[4]=0):(h[3]=r/(6*a)+c,h[4]=a)),h}function wf(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}function bf(t){return void 0!==t.points}function Mf(t){return void 0!==t.x&&void 0!==t.y}function Sf(t){return void 0!==t.paths}function xf(t){return void 0!==t.rings}function kf(t){return(e,i)=>null==e?i:null==i?e:t(e,i)}const If=kf(Math.min),jf=kf(Math.max);function _f(t,e){return Sf(e)?Of(t,e.paths,!1,!1):xf(e)?Of(t,e.rings,!1,!1):bf(e)?Ff(t,e.points,!1,!1,!1,!1):wf(e)?Af(t,e):(Mf(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.x,t[3]=e.y),t)}function Tf(t,e){return Sf(e)?Of(t,e.paths,!0,!1):xf(e)?Of(t,e.rings,!0,!1):bf(e)?Ff(t,e.points,!0,!1,!0,!1):wf(e)?Af(t,e,0,0,!0,!1):(Mf(e)&&(t[0]=e.x,t[1]=e.y,t[2]=e.z,t[3]=e.x,t[4]=e.y,t[5]=e.z),t)}function Of(t,e,i,s){const n=i?3:2;if(!e.length||!e[0].length)return null;let r,o,a,l,[u,c]=e[0][0],[h,d]=e[0][0];for(let t=0;t<e.length;t++){const p=e[t];for(let t=0;t<p.length;t++){const e=p[t],[f,y]=e;if(u=If(u,f),c=If(c,y),h=jf(h,f),d=jf(d,y),i&&e.length>2){const t=e[2];r=If(r,t),o=jf(o,t)}if(s&&e.length>n){const t=e[n];a=If(r,t),l=jf(o,t)}}}return i?s?(t[0]=u,t[1]=c,t[2]=r,t[3]=a,t[4]=h,t[5]=d,t[6]=o,t[7]=l,t.length=8,t):(t[0]=u,t[1]=c,t[2]=r,t[3]=h,t[4]=d,t[5]=o,t.length=6,t):s?(t[0]=u,t[1]=c,t[2]=a,t[3]=h,t[4]=d,t[5]=l,t.length=6,t):(t[0]=u,t[1]=c,t[2]=h,t[3]=d,t.length=4,t)}function Af(t,e,i,s,n,r){const o=e.xmin,a=e.xmax,l=e.ymin,u=e.ymax;let c=e.zmin,h=e.zmax,d=e.mmin,p=e.mmax;return n?(c=c||0,h=h||0,r?(d=d||0,p=p||0,t[0]=o,t[1]=l,t[2]=c,t[3]=d,t[4]=a,t[5]=u,t[6]=h,t[7]=p,t):(t[0]=o,t[1]=l,t[2]=c,t[3]=a,t[4]=u,t[5]=h,t)):r?(d=d||0,p=p||0,t[0]=o,t[1]=l,t[2]=d,t[3]=a,t[4]=u,t[5]=p,t):(t[0]=o,t[1]=l,t[2]=a,t[3]=u,t)}function Ff(t,e,i,s,n,r){const o=i?3:2,a=s&&r,l=i&&n;if(!e.length||!e[0].length)return null;let u,c,h,d,[p,f]=e[0],[y,m]=e[0];for(let t=0;t<e.length;t++){const i=e[t],[s,n]=i;if(p=If(p,s),f=If(f,n),y=jf(y,s),m=jf(m,n),l&&i.length>2){const t=i[2];u=If(u,t),c=jf(c,t)}if(a&&i.length>o){const t=i[o];h=If(u,t),d=jf(c,t)}}return n?(u=u||0,c=c||0,r?(h=h||0,d=d||0,t[0]=p,t[1]=f,t[2]=u,t[3]=h,t[4]=y,t[5]=m,t[6]=c,t[7]=d,t):(t[0]=p,t[1]=f,t[2]=u,t[3]=y,t[4]=m,t[5]=c,t)):r?(h=h||0,d=d||0,t[0]=p,t[1]=f,t[2]=h,t[3]=y,t[4]=m,t[5]=d,t):(t[0]=p,t[1]=f,t[2]=y,t[3]=m,t)}const Cf=[];function Pf(t,e,i,s){return{xmin:t,ymin:e,xmax:i,ymax:s}}function Ef(t,e,i,s,n,r){return{xmin:t,ymin:e,zmin:i,xmax:s,ymax:n,zmax:r}}function Rf(t,e,i,s,n,r){return{xmin:t,ymin:e,mmin:i,xmax:s,ymax:n,mmax:r}}function Lf(t,e,i,s,n,r,o,a){return{xmin:t,ymin:e,zmin:i,mmin:s,xmax:n,ymax:r,zmax:o,mmax:a}}function Nf(t,e=!1,i=!1){return e?i?Lf(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]):Ef(t[0],t[1],t[2],t[3],t[4],t[5]):i?Rf(t[0],t[1],t[2],t[3],t[4],t[5]):Pf(t[0],t[1],t[2],t[3])}function Df(t){return t?function(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}(t)?t:function(t){return void 0!==t.x&&void 0!==t.y}(t)?function(t){const{x:e,y:i,z:s,m:n}=t,r=null!=n;return null!=s?r?Lf(e,i,s,n,e,i,s,n):Ef(e,i,s,e,i,s):r?Rf(e,i,n,e,i,n):Pf(e,i,e,i)}(t):function(t){return void 0!==t.rings}(t)?Vf(t):function(t){return void 0!==t.paths}(t)?$f(t):function(t){return void 0!==t.points}(t)?function(t){const{hasZ:e,hasM:i,points:s}=t;return Nf(Ff(Cf,s,e,i),e,i)}(t):null:null}function Vf(t){const{hasZ:e,hasM:i,rings:s}=t,n=Of(Cf,s,e,i);return n?Nf(n,e,i):null}function $f(t){const{hasZ:e,hasM:i,paths:s}=t,n=Of(Cf,s,e,i);return n?Nf(n,e,i):null}var zf;function Gf(t){return!Array.isArray(t[0])}let Uf=zf=class extends up{constructor(...t){super(...t),this.rings=[],this.type="polygon"}static fromExtent(t){const e=t.clone().normalize(),i=t.spatialReference;let s=!1,n=!1;for(const t of e)t.hasZ&&(s=!0),t.hasM&&(n=!0);const r={rings:e.map((function(t){const e=[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]];if(s&&t.hasZ){const i=t.zmin+.5*(t.zmax-t.zmin);for(let t=0;t<e.length;t++)e[t].push(i)}if(n&&t.hasM){const i=t.mmin+.5*(t.mmax-t.mmin);for(let t=0;t<e.length;t++)e[t].push(i)}return e})),spatialReference:i};return s&&(r.hasZ=!0),n&&(r.hasM=!0),new zf(r)}normalizeCtorArgs(t,e){let i,s,n=null,r=null;return t&&!Array.isArray(t)?(n=t.rings?t.rings:null,e||(t.spatialReference?e=t.spatialReference:t.rings||(e=t)),i=t.hasZ,s=t.hasM):n=t,n=n||[],n.length&&n[0]&&null!=n[0][0]&&"number"==typeof n[0][0]&&(n=[n]),r=n[0]&&n[0][0],r&&(void 0===i&&void 0===s?(i=r.length>2,s=r.length>3):void 0===i?i=s?r.length>3:r.length>2:void 0===s&&(s=i?r.length>3:r.length>2)),{rings:n,spatialReference:e=e||ap.WGS84,hasZ:i,hasM:s}}get cache(){return this.commitProperty("rings"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get centroid(){const t=gf(this);if(!t||isNaN(t[0])||isNaN(t[1])||this.hasZ&&isNaN(t[2]))return null;const e=new Fp;return e.x=t[0],e.y=t[1],e.spatialReference=this.spatialReference,this.hasZ&&(e.z=t[2]),e}get extent(){const{spatialReference:t}=this,e=Vf(this);if(!e)return null;const i=new of(e);return i.spatialReference=t,i}get isSelfIntersecting(){return function(t){for(let e=0;e<t.length;e++){const i=t[e];for(let s=0;s<i.length-1;s++){const n=i[s],r=i[s+1];for(let i=e+1;i<t.length;i++)for(let e=0;e<t[i].length-1;e++){const s=t[i][e],o=t[i][e+1];if(tf(n,r,s,o,Yp)&&!(Yp[0]===n[0]&&Yp[1]===n[1]||Yp[0]===s[0]&&Yp[1]===s[1]||Yp[0]===r[0]&&Yp[1]===r[1]||Yp[0]===o[0]&&Yp[1]===o[1]))return!0}}const s=i.length;if(!(s<=4))for(let t=0;t<s-3;t++){let e=s-1;0===t&&(e=s-2);const n=i[t],r=i[t+1];for(let s=t+2;s<e;s++){const t=i[s],e=i[s+1];if(tf(n,r,t,e,Yp)&&!(Yp[0]===n[0]&&Yp[1]===n[1]||Yp[0]===t[0]&&Yp[1]===t[1]||Yp[0]===r[0]&&Yp[1]===r[1]||Yp[0]===e[0]&&Yp[1]===e[1]))return!0}}}return!1}(this.rings)}writeRings(t,e){e.rings=H(this.rings)}addRing(t){if(!t)return;const e=this.rings,i=e.length;if(Gf(t)){const s=[];for(let e=0,i=t.length;e<i;e++)s[e]=t[e].toArray();e[i]=s}else e[i]=t.concat();return this.notifyChange("rings"),this}clone(){const t=new zf;return t.spatialReference=this.spatialReference,t.rings=H(this.rings),t.hasZ=this.hasZ,t.hasM=this.hasM,t}equals(t){if(this===t)return!0;if(c(t))return!1;const e=this.spatialReference,i=t.spatialReference;if(u(e)!==u(i))return!1;if(u(e)&&u(i)&&!e.equals(i))return!1;if(this.rings.length!==t.rings.length)return!1;const s=([t,e,i,s],[n,r,o,a])=>t===n&&e===r&&(null==i&&null==o||i===o)&&(null==s&&null==a||s===a);for(let e=0;e<this.rings.length;e++)if(!T(this.rings[e],t.rings[e],s))return!1;return!0}contains(t){if(!t)return!1;const e=Mp(t,this.spatialReference);return Dp(this,u(e)?e:t)}isClockwise(t){let e;return e=Gf(t)?t.map((t=>this.hasZ?this.hasM?[t.x,t.y,t.z,t.m]:[t.x,t.y,t.z]:[t.x,t.y])):t,yf(e,this.hasM,this.hasZ)}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.rings[t][e],s=this.hasZ,n=this.hasM;return s&&!n?new Fp(i[0],i[1],i[2],void 0,this.spatialReference):n&&!s?new Fp(i[0],i[1],void 0,i[2],this.spatialReference):s&&n?new Fp(i[0],i[1],i[2],i[3],this.spatialReference):new Fp(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(af(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t].splice(e,0,i),this.notifyChange("rings"),this):this}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new Fp(this.rings[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("rings"),i}removeRing(t){if(!this._validateInputs(t,null))return null;const e=this.rings.splice(t,1)[0],i=this.spatialReference,s=e.map((t=>new Fp(t,i)));return this.notifyChange("rings"),s}setPoint(t,e,i){return this._validateInputs(t,e)?(af(this,i),Array.isArray(i)||(i=i.toArray()),this.rings[t][e]=i,this.notifyChange("rings"),this):this}_validateInputs(t,e,i=!1){if(null==t||t<0||t>=this.rings.length)return!1;if(null!=e){const s=this.rings[t];if(i&&(e<0||e>s.length))return!1;if(!i&&(e<0||e>=s.length))return!1}return!0}toJSON(t){return this.write({},t)}};e([oe({readOnly:!0})],Uf.prototype,"cache",null),e([oe({readOnly:!0})],Uf.prototype,"centroid",null),e([oe({readOnly:!0})],Uf.prototype,"extent",null),e([oe({readOnly:!0})],Uf.prototype,"isSelfIntersecting",null),e([oe({type:[[[Number]]],json:{write:{isRequired:!0}}})],Uf.prototype,"rings",void 0),e([xd("rings")],Uf.prototype,"writeRings",null),Uf=zf=e([si("esri.geometry.Polygon")],Uf),Uf.prototype.toJSON.isDefaultToJSON=!0;const qf=Uf;var Bf;let Wf=Bf=class extends up{constructor(...t){super(...t),this.paths=[],this.type="polyline"}normalizeCtorArgs(t,e){let i,s,n=null,r=null;return t&&!Array.isArray(t)?(n=t.paths?t.paths:null,e||(t.spatialReference?e=t.spatialReference:t.paths||(e=t)),i=t.hasZ,s=t.hasM):n=t,n=n||[],n.length&&n[0]&&null!=n[0][0]&&"number"==typeof n[0][0]&&(n=[n]),r=n[0]&&n[0][0],r&&(void 0===i&&void 0===s?(i=r.length>2,s=!1):void 0===i?i=!s&&r.length>3:void 0===s&&(s=!i&&r.length>3)),{paths:n,spatialReference:e=e||ap.WGS84,hasZ:i,hasM:s}}get cache(){return this.commitProperty("paths"),this.commitProperty("hasZ"),this.commitProperty("hasM"),this.commitProperty("spatialReference"),{}}get extent(){const{spatialReference:t}=this,e=$f(this);if(!e)return null;const i=new of(e);return i.spatialReference=t,i}writePaths(t,e){e.paths=H(this.paths)}addPath(t){if(!t)return;const e=this.paths,i=e.length;if(function(t){return!Array.isArray(t[0])}(t)){const s=[];for(let e=0,i=t.length;e<i;e++)s[e]=t[e].toArray();e[i]=s}else e[i]=t.concat();return this.notifyChange("paths"),this}clone(){const t=new Bf;return t.spatialReference=this.spatialReference,t.paths=H(this.paths),t.hasZ=this.hasZ,t.hasM=this.hasM,t}getPoint(t,e){if(!this._validateInputs(t,e))return null;const i=this.paths[t][e],s=this.hasZ,n=this.hasM;return s&&!n?new Fp(i[0],i[1],i[2],void 0,this.spatialReference):n&&!s?new Fp(i[0],i[1],void 0,i[2],this.spatialReference):s&&n?new Fp(i[0],i[1],i[2],i[3],this.spatialReference):new Fp(i[0],i[1],this.spatialReference)}insertPoint(t,e,i){return this._validateInputs(t,e,!0)?(af(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t].splice(e,0,i),this.notifyChange("paths"),this):this}removePath(t){if(!this._validateInputs(t,null))return null;const e=this.paths.splice(t,1)[0],i=this.spatialReference,s=e.map((t=>new Fp(t,i)));return this.notifyChange("paths"),s}removePoint(t,e){if(!this._validateInputs(t,e))return null;const i=new Fp(this.paths[t].splice(e,1)[0],this.spatialReference);return this.notifyChange("paths"),i}setPoint(t,e,i){return this._validateInputs(t,e)?(af(this,i),Array.isArray(i)||(i=i.toArray()),this.paths[t][e]=i,this.notifyChange("paths"),this):this}_validateInputs(t,e,i=!1){if(null==t||t<0||t>=this.paths.length)return!1;if(null!=e){const s=this.paths[t];if(i&&(e<0||e>s.length))return!1;if(!i&&(e<0||e>=s.length))return!1}return!0}toJSON(t){return this.write({},t)}};e([oe({readOnly:!0})],Wf.prototype,"cache",null),e([oe({readOnly:!0})],Wf.prototype,"extent",null),e([oe({type:[[[Number]]],json:{write:{isRequired:!0}}})],Wf.prototype,"paths",void 0),e([xd("paths")],Wf.prototype,"writePaths",null),Wf=Bf=e([si("esri.geometry.Polyline")],Wf),Wf.prototype.toJSON.isDefaultToJSON=!0;const Hf=Wf,Jf=oi()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon"}),Zf=oi()({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh"});function Qf(t){return void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax}function Kf(t){return void 0!==t.points}function Yf(t){return void 0!==t.x&&void 0!==t.y}function Xf(t){return void 0!==t.paths}function ty(t){return void 0!==t.rings}function ey(t){return c(t)?null:t instanceof up?t:Yf(t)?Fp.fromJSON(t):Xf(t)?Hf.fromJSON(t):ty(t)?qf.fromJSON(t):Kf(t)?hf.fromJSON(t):Qf(t)?of.fromJSON(t):null}function iy(t){return t?Yf(t)?"esriGeometryPoint":Xf(t)?"esriGeometryPolyline":ty(t)?"esriGeometryPolygon":Qf(t)?"esriGeometryEnvelope":Kf(t)?"esriGeometryMultipoint":null:null}const sy={esriGeometryPoint:Fp,esriGeometryPolyline:Hf,esriGeometryPolygon:qf,esriGeometryEnvelope:of,esriGeometryMultipoint:hf};function ny(t){return t&&sy[t]||null}const ry={base:up,key:"type",typeMap:{extent:of,multipoint:hf,point:Fp,polyline:Hf,polygon:qf}};let oy;function ay(){return oy||(oy=(async()=>{const t=await import("./p-b7e07897.js").then((function(t){return t.as}));return{arcade:t.arcade,arcadeUtils:t,Dictionary:t.Dictionary,Feature:t.arcadeFeature}})()),oy}Et(ry);const ly=(t,e,i)=>cy.create(t,e,i,null,["$feature"]),uy=(t,e,i)=>cy.create(t,e,i,null,["$feature","$view"]);class cy{constructor(t,e,i,s,n,r,o,a){this.script=t,this.evaluate=n,this.fields=Array.isArray(o)?o:o.fields,this._syntaxTree=s,this._arcade=e,this._arcadeDictionary=i,this._arcadeFeature=r,this._spatialReference=a,this._referencesGeometry=e.scriptTouchesGeometry(this._syntaxTree),this._referencesScale=this._arcade.referencesMember(this._syntaxTree,"scale")}static async create(t,e,i,s,n,r){const{arcade:o,Feature:a,Dictionary:l}=await ay(),c=ap.fromJSON(e),h=o.parseScript(t,r),d=n.reduce(((t,e)=>({...t,[e]:null})),{});let p=null;u(s)&&(p=new l(s),p.immutable=!0,d.$config=null);const f=o.scriptUsesGeometryEngine(h)&&o.enableGeometrySupport(),y=o.scriptUsesFeatureSet(h)&&o.enableFeatureSetSupport(),m=o.scriptIsAsync(h)&&o.enableAsyncSupport(),g={vars:d,spatialReference:c,useAsync:!!m},v=new l;v.immutable=!1,v.setField("scale",0);const w=o.compileScript(h,g);return await Promise.all([f,y,m]),new cy(t,o,l,h,(t=>("$view"in t&&t.$view&&(v.setField("scale",t.$view.scale),t.$view=v),p&&(t.$config=p),w({vars:t,spatialReference:c}))),new a,i,c)}repurposeFeature(t){return t.geometry&&!t.geometry.spatialReference&&(t.geometry.spatialReference=this._spatialReference),this._arcadeFeature.repurposeFromGraphicLikeObject(t.geometry,t.attributes,{fields:this.fields}),this._arcadeFeature}repurposeAdapter(t){return this._arcadeFeature.repurposeFromAdapter(t,{fields:this.fields}),this._arcadeFeature}createDictionary(){return new this._arcadeDictionary}referencesMember(t){return this._arcade.referencesMember(this._syntaxTree,t)}referencesFunction(t){return this._arcade.referencesFunction(this._syntaxTree,t)}referencesGeometry(){return this._referencesGeometry}referencesScale(){return this._referencesScale}extractFieldLiterals(){return this._arcade.extractExpectedFieldLiterals(this._syntaxTree)}}const hy=["field","field2","field3","normalizationField","rotationInfo.field","proportionalSymbolInfo.field","proportionalSymbolInfo.normalizationField","colorInfo.field","colorInfo.normalizationField"],dy=["field","normalizationField"];function py(t,e){if(null!=t&&null!=e)for(const i of Array.isArray(t)?t:[t])if(fy(hy,i,e),"visualVariables"in i&&i.visualVariables)for(const t of i.visualVariables)fy(dy,t,e)}function fy(t,e,i){if(t)for(const s of t){const t=Q(s,e),n=t&&"function"!=typeof t&&i.get(t);n&&K(s,n.name,e)}}function yy(t,e){if(null!=t&&null!=e&&e.fields.length)if("startField"in t){const i=e.get(t.startField),s=e.get(t.endField);t.startField=i&&i.name||null,t.endField=s&&s.name||null}else{const i=e.get(t.startTimeField),s=e.get(t.endTimeField);t.startTimeField=i&&i.name||null,t.endTimeField=s&&s.name||null}}const my=new Set;function gy(t,e){return t&&e?(my.clear(),vy(my,t,e),Array.from(my).sort()):[]}function vy(t,e,i){var s;if(i)if(null!=e&&null!=(s=e.fields)&&s.length)if(i.includes("*"))for(const{name:i}of e.fields)t.add(i);else for(const s of i)wy(t,e,s);else{if(i.includes("*"))return t.clear(),void t.add("*");for(const e of i)t.add(e)}}function wy(t,e,i){if("string"==typeof i)if(e){const s=e.get(i);s&&t.add(s.name)}else t.add(i)}function by(t,e){return c(e)||c(t)?[]:e.includes("*")?t.fields.map((t=>t.name)):e}async function My(t,e,i){var s;if(!i)return;const{arcadeUtils:n}=await ay(),r=n.extractFieldNames(i,null==e||null==(s=e.fields)?void 0:s.map((t=>t.name)));for(const i of r)wy(t,e,i)}async function Sy(t,e,i){if(i&&"1=1"!==i){const s=(await import("./p-8ec48dc4.js")).WhereClause.create(i,e);if(!s.isStandardized)throw new Ve("fieldUtils:collectFilterFields","Where clause is not standardized");vy(t,e,s.fieldNames)}}function xy(t,e){for(const i of t)if(i&&i.valueType&&i.valueType===e)return i.name;return null}async function ky(t,e){if(!e)return;const i=Q("elevationInfo.featureExpressionInfo",e);return i?i.collectRequiredFields(t,e.fieldsIndex):void 0}async function Iy(t,e,i){var s;if(!e||!i||"cluster"!==i.type)return;const n=[];null!=(s=i.popupTemplate)&&s.expressionInfos&&n.push(...i.popupTemplate.expressionInfos.map((i=>My(t,e.fieldsIndex,i.expression)))),i.fields&&n.push(...i.fields.map((i=>async function(t,e,i){i.outStatistic.onStatisticValueExpression?My(t,e,i.outStatistic.onStatisticValueExpression):t.add(i.outStatistic.onStatisticField)}(t,e.fieldsIndex,i)))),await Promise.all(n)}async function jy(t,e,i){e&&(e.timeInfo&&u(i)&&i.timeExtent&&vy(t,e.fieldsIndex,[e.timeInfo.startField,e.timeInfo.endField]),e.floorInfo&&vy(t,e.fieldsIndex,[e.floorInfo.floorField]),u(i)&&u(i.where)&&await Sy(t,e.fieldsIndex,i.where))}async function _y(t,e,i){e&&i&&await Promise.all(i.map((i=>async function(t,e,i){e&&i&&(i.valueExpression?await My(t,e.fieldsIndex,i.valueExpression):i.field&&wy(t,e.fieldsIndex,i.field))}(t,e,i))))}function Ty(t){if(!t)return[];const e="editFieldsInfo"in t&&t.editFieldsInfo;return e?gy(t.fieldsIndex,[e&&e.creatorField,e&&e.creationDateField,e&&e.editorField,e&&e.editDateField]):[]}async function Oy(t,e){const{labelingInfo:i,fieldsIndex:s}=e;i&&i.length&&await Promise.all(i.map((e=>async function(t,e,i){if(!i)return;const s=i.getLabelExpression(),n=i.where;if("arcade"===s.type)await My(t,e,s.expression);else{const i=s.expression.match(/{[^}]*}/g);i&&i.forEach((i=>{wy(t,e,i.slice(1,-1))}))}await Sy(t,e,n)}(t,s,e))))}function Ay(t){const e=t.defaultValue;return void 0!==e&&Dy(t,e)?e:t.nullable?null:void 0}function Fy(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)}function Cy(t){return null===t||Fy(t)}const Py="isInteger"in Number?Number.isInteger:t=>"number"==typeof t&&isFinite(t)&&Math.floor(t)===t;function Ey(t){return null===t||Py(t)}function Ry(t){return null!=t&&"string"==typeof t}function Ly(t){return null===t||Ry(t)}function Ny(){return!0}function Dy(t,e){let i;switch(t.type){case"date":case"integer":case"long":case"small-integer":case"esriFieldTypeDate":case"esriFieldTypeInteger":case"esriFieldTypeLong":case"esriFieldTypeSmallInteger":i=t.nullable?Ey:Py;break;case"double":case"single":case"esriFieldTypeSingle":case"esriFieldTypeDouble":i=t.nullable?Cy:Fy;break;case"string":case"esriFieldTypeString":i=t.nullable?Ly:Ry;break;default:i=Ny}return 1===arguments.length?i:i(e)}const Vy=new Set(["integer","small-integer","single","double","esriFieldTypeInteger","esriFieldTypeSmallInteger","esriFieldTypeSingle","esriFieldTypeDouble"]);function $y(t){return null!=t&&Vy.has(t.type)}function zy(t){return null!=t&&("string"===t.type||"esriFieldTypeString"===t.type)}function Gy(t){return null!=t&&("date"===t.type||"esriFieldTypeDate"===t.type)}var Uy,qy;function By(t){return null==t||"number"==typeof t&&isNaN(t)?null:t}function Wy(t,e){return t.nullable&&null===e?null:$y(t)&&!function(t,e){const i="string"==typeof t?Hy(t):t;return!!i&&(i.isInteger?Py(e)&&e>=i.min&&e<=i.max:e>=i.min&&e<=i.max)}(t.type,Number(e))?Uy.OUT_OF_RANGE:Dy(t,e)?t.domain?function(t,e){switch(t.type){case"range":{const i="range"in t?t.range[1]:t.maxValue;if(+e<("range"in t?t.range[0]:t.minValue)||+e>i)return kd.VALUE_OUT_OF_RANGE;break}case"coded-value":case"codedValue":if(null==t.codedValues||t.codedValues.every((t=>null==t||t.code!==e)))return kd.INVALID_CODED_VALUE}return null}(t.domain,e):null:qy.INVALID_TYPE}function Hy(t){switch(t){case"esriFieldTypeSmallInteger":case"small-integer":return Jy;case"esriFieldTypeInteger":case"integer":return Zy;case"esriFieldTypeSingle":case"single":return Qy;case"esriFieldTypeDouble":case"double":return Ky}}(Uy||(Uy={})).OUT_OF_RANGE="numeric-range-validation-error::out-of-range",(qy||(qy={})).INVALID_TYPE="type-validation-error::invalid-type";const Jy={min:-32768,max:32767,isInteger:!0},Zy={min:-2147483648,max:2147483647,isInteger:!0},Qy={min:-34e37,max:12e37,isInteger:!1},Ky={min:-Number.MAX_VALUE,max:Number.MAX_VALUE,isInteger:!1};function Yy(t,e,i){switch(t){case kd.INVALID_CODED_VALUE:return`Value ${i} is not in the coded domain - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case kd.VALUE_OUT_OF_RANGE:return`Value ${i} is out of the range of valid values - field: ${e.name}, domain: ${JSON.stringify(e.domain)}`;case qy.INVALID_TYPE:return`Value ${i} is not a valid value for the field type - field: ${e.name}, type: ${e.type}, nullable: ${e.nullable}`;case Uy.OUT_OF_RANGE:{const{min:t,max:s}=Hy(e.type);return`Value ${i} is out of range for the number type - field: ${e.name}, type: ${e.type}, value range is ${t} to ${s}`}}}function Xy(t,e){return!function(t,e,i){if(!e||!e.attributes||!t){if(u(i))for(const e of t)i.add(e);return!0}const s=e.attributes;let n=!1;for(const e of t)if(!(e in s)){if(n=!0,!u(i))break;i.add(e)}return n}(t,e,null)}const tm=new ri({esriSMS:"simple-marker",esriPMS:"picture-marker",esriSLS:"simple-line",esriSFS:"simple-fill",esriPFS:"picture-fill",esriTS:"text",esriSHD:"shield-label-symbol",PointSymbol3D:"point-3d",LineSymbol3D:"line-3d",PolygonSymbol3D:"polygon-3d",WebStyleSymbol:"web-style",MeshSymbol3D:"mesh-3d",LabelSymbol3D:"label-3d",CIMSymbolReference:"cim"});let em=0,im=class extends Vd{constructor(t){super(t),this.id="sym"+em++,this.type=null}set color(t){this._set("color",t)}readColor(t){return t&&null!=t[0]?[t[0],t[1],t[2],t[3]/255]:t}async collectRequiredFields(t,e){}hash(){return JSON.stringify(this.toJSON())}clone(){}};e([oe({type:tm.apiValues,readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0,writer:tm.write}}})],im.prototype,"type",void 0),e([oe({type:bd,value:new bd([0,0,0,1]),json:{write:{allowNull:!0}}})],im.prototype,"color",null),e([Sd("color")],im.prototype,"readColor",null),im=e([si("esri.symbols.Symbol")],im);const sm=im;var nm;let rm=nm=class extends sm{constructor(t){super(t),this.data=null,this.type="cim"}readData(t,e){return e}writeData(t,e){if(t)for(const i in t)e[i]=t[i]}async collectRequiredFields(t,e){if("CIMSymbolReference"===this.data.type){const i=this.data.primitiveOverrides;if(i){const s=i.map((i=>My(t,e,i.valueExpressionInfo.expression)));await Promise.all(s)}}}clone(){return new nm({data:H(this.data)})}hash(){return""+at(JSON.stringify(this.data))}};e([oe({json:{write:!1}})],rm.prototype,"color",void 0),e([oe({json:{write:!0}})],rm.prototype,"data",void 0),e([Sd("data",["symbol"])],rm.prototype,"readData",null),e([xd("data",{})],rm.prototype,"writeData",null),e([Md({CIMSymbolReference:"cim"},{readOnly:!0})],rm.prototype,"type",void 0),rm=nm=e([si("esri.symbols.CIMSymbol")],rm);const om=rm;let am=class extends Vd{constructor(t){super(t),this.enabled=!0,this.type=null}writeEnabled(t,e,i){t||(e[i]=t)}};e([oe({type:Boolean,json:{read:{source:"enable"},write:{target:"enable"}}})],am.prototype,"enabled",void 0),e([xd("enabled")],am.prototype,"writeEnabled",null),e([oe({type:["icon","object","line","path","fill","water","extrude","text"],readOnly:!0})],am.prototype,"type",void 0),am=e([si("esri.symbols.Symbol3DLayer")],am);const lm=am,um=/^-?(\d+(\.\d+)?)\s*((px)|(pt))?$/i;function cm(t){return t?t/72*96:0}function hm(t){return t?72*t/96:0}function dm(t){if("string"==typeof t){const e=t.match(um);if(e){const i=Number(e[1]),s=e[3]&&e[3].toLowerCase(),n="-"===t.charAt(0),r="px"===s?hm(i):i;return n?-r:r}return console.warn("screenUtils.toPt: input not recognized!"),null}return t}function pm(t=0,e=0){return{x:t,y:e}}function fm(t=0,e=0){return[t,e]}function ym(t){const e=vt(100*(1-t));return Math.max(0,Math.min(e,100))}function mm(t){return Math.max(0,Math.min(1-t/100,1))}const gm={type:bd,json:{type:[Rt],default:null,read:{source:["color","transparency"],reader:function(t,e){const i=null!=e.transparency?mm(e.transparency):1,s=e.color;return s&&Array.isArray(s)?new bd([s[0]||0,s[1]||0,s[2]||0,i]):null}},write:{target:{color:{type:[Rt]},transparency:{type:Rt}},writer:function(t,e){e.color=t.toJSON().slice(0,3);const i=ym(t.a);0!==i&&(e.transparency=i)}}}},vm={type:Number,cast:dm,json:{write:!0}};let wm=class extends Vd{constructor(t){super(t),this.color=new bd([0,0,0,1]),this.extensionLength=0,this.size=hm(1)}clone(){}cloneProperties(){return{color:H(this.color),size:this.size,extensionLength:this.extensionLength}}};e([oe({type:["solid","sketch"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],wm.prototype,"type",void 0),e([oe(gm)],wm.prototype,"color",void 0),e([oe({...vm,json:{write:{overridePolicy:t=>({enabled:!!t})}}})],wm.prototype,"extensionLength",void 0),e([oe(vm)],wm.prototype,"size",void 0),wm=e([si("esri.symbols.edges.Edges3D")],wm);const bm=wm;var Mm;let Sm=Mm=class extends bm{constructor(t){super(t),this.type="sketch"}clone(){return new Mm(this.cloneProperties())}};e([Md({sketch:"sketch"},{readOnly:!0})],Sm.prototype,"type",void 0),Sm=Mm=e([si("esri.symbols.edges.SketchEdges3D")],Sm);const xm=Sm;var km;let Im=km=class extends bm{constructor(t){super(t),this.type="solid"}clone(){return new km(this.cloneProperties())}};e([Md({solid:"solid"},{readOnly:!0})],Im.prototype,"type",void 0),Im=km=e([si("esri.symbols.support.SolidEdges3D")],Im);const jm={types:{key:"type",base:bm,typeMap:{solid:Im,sketch:xm}},json:{write:!0}};var _m;let Tm=_m=class extends Vd{constructor(t){super(t),this.color=null}clone(){const t={color:u(this.color)?this.color.clone():null};return new _m(t)}};e([oe(gm)],Tm.prototype,"color",void 0),Tm=_m=e([si("esri.symbols.support.Symbol3DMaterial")],Tm);const Om=Tm;var Am;let Fm=Am=class extends lm{constructor(t){super(t),this.type="extrude",this.size=1,this.material=null,this.castShadows=!0,this.edges=null}clone(){return new Am({edges:this.edges&&this.edges.clone(),enabled:this.enabled,material:u(this.material)?this.material.clone():null,castShadows:this.castShadows,size:this.size})}};e([Md({Extrude:"extrude"},{readOnly:!0})],Fm.prototype,"type",void 0),e([oe({type:Number,json:{write:{enabled:!0,isRequired:!0}},nonNullable:!0})],Fm.prototype,"size",void 0),e([oe({type:Om,json:{write:!0}})],Fm.prototype,"material",void 0),e([oe({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Fm.prototype,"castShadows",void 0),e([oe(jm)],Fm.prototype,"edges",void 0),Fm=Am=e([si("esri.symbols.ExtrudeSymbol3DLayer")],Fm);const Cm=Fm;let Pm=class extends sm{constructor(t){super(t),this.type="simple-line",this.width=.75}hash(){return`${this.type}.${this.width}`}};e([Md({esriSLS:"simple-line"},{readOnly:!0})],Pm.prototype,"type",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],Pm.prototype,"width",void 0),Pm=e([si("esri.symbols.LineSymbol")],Pm);const Em=Pm;var Rm;let Lm=Rm=class extends Vd{constructor(t){super(t),this.placement="begin-end",this.type="line-marker",this.style="arrow"}writeStyle(t,e,i,s){e[i]="web-map"===(null==s?void 0:s.origin)?"arrow":t}set color(t){this._set("color",t)}readColor(t){return t&&null!=t[0]?[t[0],t[1],t[2],t[3]/255]:t}writeColor(t,e,i,s){"web-map"===(null==s?void 0:s.origin)||(e[i]=t)}clone(){return new Rm({color:H(this.color),placement:this.placement,style:this.style})}hash(){var t;return`${this.placement}.${null==(t=this.color)?void 0:t.hash()}.${this.style}`}};e([oe({type:["begin","end","begin-end"],json:{write:!0}})],Lm.prototype,"placement",void 0),e([Md({"line-marker":"line-marker"},{readOnly:!0}),oe({json:{origins:{"web-map":{write:!1}}}})],Lm.prototype,"type",void 0),e([oe({type:["arrow","circle","square","diamond","cross","x"]})],Lm.prototype,"style",void 0),e([xd("style")],Lm.prototype,"writeStyle",null),e([oe({type:bd,value:null,json:{write:{allowNull:!0}}})],Lm.prototype,"color",null),e([Sd("color")],Lm.prototype,"readColor",null),e([xd("color")],Lm.prototype,"writeColor",null),Lm=Rm=e([si("esri.symbols.LineSymbolMarker")],Lm);const Nm=Lm;var Dm;const Vm=new ri({esriSLSSolid:"solid",esriSLSDash:"dash",esriSLSDot:"dot",esriSLSDashDot:"dash-dot",esriSLSDashDotDot:"long-dash-dot-dot",esriSLSNull:"none",esriSLSInsideFrame:"inside-frame",esriSLSShortDash:"short-dash",esriSLSShortDot:"short-dot",esriSLSShortDashDot:"short-dash-dot",esriSLSShortDashDotDot:"short-dash-dot-dot",esriSLSLongDash:"long-dash",esriSLSLongDashDot:"long-dash-dot"});let $m=Dm=class extends Em{constructor(...t){super(...t),this.type="simple-line",this.style="solid",this.cap="round",this.join="round",this.marker=null,this.miterLimit=2}normalizeCtorArgs(t,e,i,s,n,r){if(t&&"string"!=typeof t)return t;const o={};return null!=t&&(o.style=t),null!=e&&(o.color=e),null!=i&&(o.width=dm(i)),null!=s&&(o.cap=s),null!=n&&(o.join=n),null!=r&&(o.miterLimit=dm(r)),o}clone(){var t;return new Dm({color:H(this.color),style:this.style,width:this.width,cap:this.cap,join:this.join,miterLimit:this.miterLimit,marker:null==(t=this.marker)?void 0:t.clone()})}hash(){var t,e;return`${super.hash()}.${null==(t=this.color)?void 0:t.hash()}.${this.style}.${this.cap}.${this.join}.${this.miterLimit}.${null==(e=this.marker)?void 0:e.hash()}`}};e([Md({esriSLS:"simple-line"},{readOnly:!0})],$m.prototype,"type",void 0),e([oe({type:Vm.apiValues,json:{read:Vm.read,write:Vm.write}})],$m.prototype,"style",void 0),e([oe({type:["butt","round","square"],json:{write:{overridePolicy:(t,e,i)=>({enabled:"round"!==t&&(null==i||null==i.origin)})}}})],$m.prototype,"cap",void 0),e([oe({type:["miter","round","bevel"],json:{write:{overridePolicy:(t,e,i)=>({enabled:"round"!==t&&(null==i||null==i.origin)})}}})],$m.prototype,"join",void 0),e([oe({types:{key:"type",base:null,defaultKeyValue:"line-marker",typeMap:{"line-marker":Nm}},json:{write:!0,origins:{"web-scene":{write:!1}}}})],$m.prototype,"marker",void 0),e([oe({type:Number,json:{read:!1,write:!1}})],$m.prototype,"miterLimit",void 0),$m=Dm=e([si("esri.symbols.SimpleLineSymbol")],$m);const zm=$m;let Gm=class extends sm{constructor(t){super(t),this.outline=null,this.type=null}hash(){return`${this.type}.${this.outline&&this.outline.hash()}`}};e([oe({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":zm}},json:{default:null,write:!0}})],Gm.prototype,"outline",void 0),e([oe({type:["simple-fill","picture-fill"],readOnly:!0})],Gm.prototype,"type",void 0),Gm=e([si("esri.symbols.FillSymbol")],Gm);const Um=Gm;let qm=class extends Vd{constructor(t){super(t)}clone(){}};e([oe({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],qm.prototype,"type",void 0),qm=e([si("esri.symbols.patterns.LinePattern3D")],qm);const Bm=qm;var Wm;const Hm=oi()({dash:"dash","dash-dot":"dash-dot","dash-dot-dot":"long-dash-dot-dot",dot:"dot","long-dash":"long-dash","long-dash-dot":"long-dash-dot",null:"none","short-dash":"short-dash","short-dash-dot":"short-dash-dot","short-dash-dot-dot":"short-dash-dot-dot","short-dot":"short-dot",solid:"solid"});let Jm=Wm=class extends Bm{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new Wm({style:this.style})}};e([oe({type:["style"]})],Jm.prototype,"type",void 0),e([Md(Hm),oe({type:["dash","dash-dot","dot","long-dash","long-dash-dot","long-dash-dot-dot","none","short-dash","short-dash-dot","short-dash-dot-dot","short-dot","solid"]})],Jm.prototype,"style",void 0),Jm=Wm=e([si("esri.symbols.patterns.LineStylePattern3D")],Jm);const Zm=Jm;let Qm=class extends Vd{constructor(t){super(t)}clone(){}};e([oe({type:["style"],readOnly:!0,json:{read:!0,write:{ignoreOrigin:!0}}})],Qm.prototype,"type",void 0),Qm=e([si("esri.symbols.patterns.Pattern3D")],Qm);const Km=Qm;var Ym;let Xm=Ym=class extends Km{constructor(t){super(t),this.type="style",this.style="solid"}clone(){return new Ym({style:this.style})}};e([oe({type:["style"]})],Xm.prototype,"type",void 0),e([oe({type:["backward-diagonal","cross","diagonal-cross","forward-diagonal","horizontal","none","solid","vertical"],json:{read:!0,write:!0}})],Xm.prototype,"style",void 0),Xm=Ym=e([si("esri.symbols.patterns.StylePattern3D")],Xm);const tg=Xm,eg={types:{key:"type",base:Km,typeMap:{style:tg}},json:{write:!0}},ig={types:{key:"type",base:Bm,typeMap:{style:Zm}},json:{write:!0}},sg=new bd("white");new bd("black");const ng=new bd([255,255,255,0]);var rg;let og=rg=class extends Tm{constructor(t){super(t),this.colorMixMode=null}clone(){const t={color:u(this.color)?this.color.clone():null,colorMixMode:this.colorMixMode};return new rg(t)}};function ag(t=bg){return[t[0],t[1],t[2],t[3]]}function lg(t){return[t[0],t[1],t[2],t[3]]}function ug(t,e,i,s,n=ag()){return n[0]=t,n[1]=e,n[2]=i,n[3]=s,n}function cg(t,e=ag()){return e[0]=t.xmin,e[1]=t.ymin,e[2]=t.xmax,e[3]=t.ymax,e}function hg(t,e){return new of({xmin:t[0],ymin:t[1],xmax:t[2],ymax:t[3],spatialReference:e})}function dg(t,e){e[0]<t[0]&&(t[0]=e[0]),e[0]>t[2]&&(t[2]=e[0]),e[1]<t[1]&&(t[1]=e[1]),e[1]>t[3]&&(t[3]=e[1])}function pg(t){return c(t)||t[0]>=t[2]?0:t[2]-t[0]}function fg(t){return t[1]>=t[3]?0:t[3]-t[1]}function yg(t){return pg(t)*fg(t)}function mg(t,e,i){return e[0]>=t[0]-i&&e[1]>=t[1]-i&&e[0]<=t[2]+i&&e[1]<=t[3]+i}function gg(t,e){return Math.max(e[0],t[0])<=Math.min(e[2],t[2])&&Math.max(e[1],t[1])<=Math.min(e[3],t[3])}function vg(t,e){return e[0]>=t[0]&&e[2]<=t[2]&&e[1]>=t[1]&&e[3]<=t[3]}e([Md({multiply:"multiply",replace:"replace",tint:"tint"})],og.prototype,"colorMixMode",void 0),og=rg=e([si("esri.symbols.support.Symbol3DFillMaterial")],og);const wg=[1/0,1/0,-1/0,-1/0],bg=[0,0,0,0];function Mg(t=Eg){return[t[0],t[1],t[2],t[3],t[4],t[5]]}function Sg(t,e,i,s,n,r,o=Mg()){return o[0]=t,o[1]=e,o[2]=i,o[3]=s,o[4]=n,o[5]=r,o}function xg(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t[4]=Math.max(t[4],e[4]),t[5]=Math.max(t[5],e[5])}function kg(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.min(t[2],e[2]),t[3]=Math.max(t[3],e[0]),t[4]=Math.max(t[4],e[1]),t[5]=Math.max(t[5],e[2])}function Ig(t,e=[0,0,0]){return e[0]=function(t){return t[0]>=t[3]?0:t[3]-t[0]}(t),e[1]=function(t){return t[1]>=t[4]?0:t[4]-t[1]}(t),e[2]=function(t){return t[2]>=t[5]?0:t[5]-t[2]}(t),e}function jg(t,e,i=t){return i[0]=e[0],i[1]=e[1],i[2]=e[2],i!==t&&(i[3]=t[3],i[4]=t[4],i[5]=t[5]),i}function _g(t,e,i=t){return i[3]=e[0],i[4]=e[1],i[5]=e[2],i!==t&&(i[0]=t[0],i[1]=t[1],i[2]=t[2]),t}function Tg(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function Og(t){return t?Tg(t,Pg):Mg(Pg)}function Ag(t,e){return t[0]=e[0],t[1]=e[1],t[2]=-1/0,t[3]=e[2],t[4]=e[3],t[5]=1/0,t}function Fg(t){return 6===t.length}function Cg(t,e,i){if(c(t)||c(e))return t===e;if(!Fg(t)||!Fg(e))return!1;if(i){for(let s=0;s<t.length;s++)if(!i(t[s],e[s]))return!1}else for(let i=0;i<t.length;i++)if(t[i]!==e[i])return!1;return!0}const Pg=[1/0,1/0,1/0,-1/0,-1/0,-1/0],Eg=[0,0,0,0,0,0];function Rg(t,{isPrimitive:e,width:i,depth:s,height:n}){const r=e?10:1;if(null==i&&null==n&&null==s)return[r*t[0],r*t[1],r*t[2]];const o=eh(i,s,n);let a;for(let e=0;e<3;e++){const i=o[e];if(null!=i){a=i/t[e];break}}for(let e=0;e<3;e++)null==o[e]&&(o[e]=t[e]*a);return o}const Lg=Sg(-.5,-.5,-.5,.5,.5,.5),Ng=Sg(-.5,-.5,0,.5,.5,1),Dg=Sg(-.5,-.5,0,.5,.5,.5);function Vg(t){switch(t){case"sphere":case"cube":case"diamond":return Lg;case"cylinder":case"cone":case"inverted-cone":return Ng;case"tetrahedron":return Dg;default:return}}const $g=["butt","square","round"],zg=[...$g,"none"],Gg=["miter","bevel","round"];var Ug;let qg=Ug=class extends Vd{constructor(t){super(t),this.color=new bd([0,0,0,1]),this.size=hm(1),this.pattern=null,this.patternCap="butt"}clone(){const t={color:u(this.color)?this.color.clone():null,size:this.size,pattern:u(this.pattern)?this.pattern.clone():null,patternCap:this.patternCap};return new Ug(t)}};e([oe(gm)],qg.prototype,"color",void 0),e([oe(vm)],qg.prototype,"size",void 0),e([oe(ig)],qg.prototype,"pattern",void 0),e([oe({type:$g,json:{default:"butt",write:{overridePolicy(){return{enabled:u(this.pattern)}}}}})],qg.prototype,"patternCap",void 0),qg=Ug=e([si("esri.symbols.support.Symbol3DOutline")],qg);const Bg=qg;var Wg;let Hg=Wg=class extends lm{constructor(t){super(t),this.type="fill",this.material=null,this.pattern=null,this.castShadows=!0,this.outline=null,this.edges=null}clone(){const t={edges:u(this.edges)?this.edges.clone():null,enabled:this.enabled,material:u(this.material)?this.material.clone():null,pattern:u(this.pattern)?this.pattern.clone():null,castShadows:this.castShadows,outline:u(this.outline)?this.outline.clone():null};return new Wg(t)}static fromSimpleFillSymbol(t){var e,i,s,n,r,o;const a=t.outline&&t.outline.style&&"inside-frame"!==t.outline.style&&"solid"!==t.outline.style?new Zm({style:t.outline.style}):null,l={size:null!=(e=null==(i=t.outline)?void 0:i.width)?e:0,color:(null!=(s=null==(n=t.outline)?void 0:n.color)?s:sg).clone(),pattern:a};return a&&null!=(r=t.outline)&&r.cap&&(l.patternCap=t.outline.cap),new Wg({material:new og({color:(null!=(o=t.color)?o:ng).clone()}),pattern:t.style&&"solid"!==t.style?new tg({style:t.style}):null,outline:l})}};e([Md({Fill:"fill"},{readOnly:!0})],Hg.prototype,"type",void 0),e([oe({type:og,json:{write:!0}})],Hg.prototype,"material",void 0),e([oe(eg)],Hg.prototype,"pattern",void 0),e([oe({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],Hg.prototype,"castShadows",void 0),e([oe({type:Bg,json:{write:!0}})],Hg.prototype,"outline",void 0),e([oe(jm)],Hg.prototype,"edges",void 0),Hg=Wg=e([si("esri.symbols.FillSymbol3DLayer")],Hg);const Jg=Hg;var Zg;let Qg=Zg=class extends Vd{constructor(t){super(t),this.decoration="none",this.family="sans-serif",this.size=9,this.style="normal",this.weight="normal"}castSize(t){return dm(t)}clone(){return new Zg({decoration:this.decoration,family:this.family,size:this.size,style:this.style,weight:this.weight})}hash(){return`${this.decoration}.${this.family}.${this.size}.${this.style}.${this.weight}`}};e([oe({type:["underline","line-through","none"],json:{default:"none",write:!0}})],Qg.prototype,"decoration",void 0),e([oe({type:String,json:{write:!0}})],Qg.prototype,"family",void 0),e([oe({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:!i||!i.textSymbol3D})}}})],Qg.prototype,"size",void 0),e([ba("size")],Qg.prototype,"castSize",null),e([oe({type:["normal","italic","oblique"],json:{default:"normal",write:!0}})],Qg.prototype,"style",void 0),e([oe({type:["normal","bold","bolder","lighter"],json:{default:"normal",write:!0}})],Qg.prototype,"weight",void 0),Qg=Zg=e([si("esri.symbols.Font")],Qg);const Kg=Qg;function Yg(t,e){const i=e&&e.url&&e.url.path;if(t&&i&&(t=tn(t,i,{preserveProtocolRelative:!0}),e.portalItem&&e.readResourcePaths)){const i=en(t,e.portalItem.itemUrl);sv.test(i)&&e.readResourcePaths.push(e.portalItem.resourceFromPath(i).path)}return rv(t,e&&e.portal)}function Xg(t,e,i=0){if(!t)return t;!on(t)&&e&&e.blockedRelativeUrls&&e.blockedRelativeUrls.push(t);let s=tn(t);if(e){const i=e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.rootPath||e.url&&e.url.path;if(i){const n=rv(i,e.portal);s=en(rv(s,e.portal),n,n),s!==t&&e.verifyItemRelativeUrls&&e.verifyItemRelativeUrls.writtenUrls.push(s)}}return s=function(t,e){return e&&!e.isPortal&&e.urlKey&&e.customBaseUrl?Sn(t,`${e.urlKey}.${e.customBaseUrl}`,e.portalHostname):t}(s,e&&e.portal),on(s)&&(s=sn(s)),null!=e&&e.resources&&null!=e&&e.portalItem&&!on(s)&&!ln(s)&&0===i&&e.resources.toKeep.push({resource:e.portalItem.resourceFromPath(s)}),s}function tv(t,e,i){return Yg(t,i)}function ev(t,e,i,s){const n=Xg(t,s);void 0!==n&&(e[i]=n)}const iv=/\/items\/([^\/]+)\/resources\//,sv=/^\.\/resources\//;function nv(t){const e=u(t)?t.match(iv):null;return u(e)?e[1]:null}function rv(t,e){if(!e||e.isPortal||!e.urlKey||!e.customBaseUrl)return t;const i=`${e.urlKey}.${e.customBaseUrl}`;return Ks(Ls,`${Ls.scheme}://${i}`)?Sn(t,e.portalHostname,i):Sn(t,i,e.portalHostname)}const ov=Object.freeze({__proto__:null,fromJSON:Yg,toJSON:Xg,read:tv,write:ev,itemIdFromResourceUrl:nv});var av;const lv=oi()({circle:"circle",square:"square",cross:"cross",x:"x",kite:"kite",triangle:"triangle"});let uv=av=class extends Vd{constructor(t){super(t)}readHref(t,e,i){return t?Yg(t,i):e.dataURI}writeHref(t,e,i,s){t&&(ln(t)?e.dataURI=t:(e.href=Xg(t,s),on(e.href)&&(e.href=sn(e.href))))}clone(){return new av({href:this.href,primitive:this.primitive})}};e([oe({type:String,json:{write:!0,read:{source:["href","dataURI"]}}})],uv.prototype,"href",void 0),e([Sd("href")],uv.prototype,"readHref",null),e([xd("href",{href:{type:String},dataURI:{type:String}})],uv.prototype,"writeHref",null),e([Md(lv)],uv.prototype,"primitive",void 0),uv=av=e([si("esri.symbols.support.IconSymbol3DLayerResource")],uv);const cv="circle",hv=uv;var dv;let pv=dv=class extends jo{constructor(){super(...arguments),this.x=0,this.y=0}clone(){return new dv({x:this.x,y:this.y})}};e([oe({type:Number})],pv.prototype,"x",void 0),e([oe({type:Number})],pv.prototype,"y",void 0),pv=dv=e([si("esri.symbols.support.Symbol3DAnchorPosition2D")],pv);const fv=pv;var yv;let mv=yv=class extends Vd{constructor(t){super(t),this.color=new bd([0,0,0,1]),this.size=hm(1)}clone(){const t={color:u(this.color)?this.color.clone():null,size:this.size};return new yv(t)}};e([oe(gm)],mv.prototype,"color",void 0),e([oe(vm)],mv.prototype,"size",void 0),mv=yv=e([si("esri.symbols.support.Symbol3DIconOutline")],mv);const gv=mv;var vv;const wv=ct.getLogger("esri.symbols.IconSymbol3DLayer");let bv=vv=class extends lm{constructor(t){super(t),this.material=null,this.resource=null,this.type="icon",this.size=12,this.anchor="center",this.anchorPosition=void 0,this.outline=void 0}clone(){return new vv({anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),enabled:this.enabled,material:u(this.material)?this.material.clone():null,outline:u(this.outline)?this.outline.clone():null,resource:this.resource&&this.resource.clone(),size:this.size})}static fromSimpleMarkerSymbol(t){const e=t.color||sg,i=Mv(t),s=t.outline&&t.outline.width>0?{size:t.outline.width,color:(t.outline.color||sg).clone()}:null;return new vv({size:t.size,resource:{primitive:kv(t.style)},material:{color:e},outline:s,anchor:i?"relative":void 0,anchorPosition:i})}static fromPictureMarkerSymbol(t){const e=!t.color||function(t){return 0===t.r&&0===t.g&&0===t.b}(t.color)?sg:t.color,i=Mv(t);return new vv({size:t.width<=t.height?t.height:t.width,resource:{href:t.url},material:{color:e.clone()},anchor:i?"relative":void 0,anchorPosition:i})}static fromCIMSymbol(t){return new vv({resource:{href:dn({mediaType:"application/json",data:JSON.stringify(t.data)})}})}};function Mv(t){const e="width"in t?t.width:t.size,i="height"in t?t.height:t.size,s=Sv(t.xoffset),n=Sv(t.yoffset);return(s||n)&&e&&i?{x:-s/e,y:n/i}:null}function Sv(t){return isFinite(t)?t:0}e([oe({type:Om,json:{write:!0}})],bv.prototype,"material",void 0),e([oe({type:hv,json:{write:!0}})],bv.prototype,"resource",void 0),e([Md({Icon:"icon"},{readOnly:!0})],bv.prototype,"type",void 0),e([oe(vm)],bv.prototype,"size",void 0),e([Md({center:"center",left:"left",right:"right",top:"top",bottom:"bottom",topLeft:"top-left",topRight:"top-right",bottomLeft:"bottom-left",bottomRight:"bottom-right",relative:"relative"}),oe({json:{default:"center"}})],bv.prototype,"anchor",void 0),e([oe({type:pv,json:{type:[Number],read:{reader:t=>new pv({x:t[0],y:t[1]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],bv.prototype,"anchorPosition",void 0),e([oe({type:gv,json:{write:!0}})],bv.prototype,"outline",void 0),bv=vv=e([si("esri.symbols.IconSymbol3DLayer")],bv);const xv={circle:"circle",cross:"cross",diamond:"kite",square:"square",x:"x",triangle:"triangle",path:null};function kv(t){return xv[t]||(wv.warn(t+' cannot be mapped to Icon symbol. Fallback to "circle"'),"circle")}const Iv=bv;function jv(t,e,i=qo){return e||(e=new i),e===t||(e.removeAll(),function(t){return t&&(Array.isArray(t)||"items"in t&&Array.isArray(t.items))}(t)?e.addMany(t):t&&e.add(t)),e}function _v(t){return t}const Tv=t=>{let i=class extends t{constructor(...t){super(...t),this._loadController=null,this.loadError=null,this.loadStatus="not-loaded",this._set("loadWarnings",[]),this.addResolvingPromise(new Promise((t=>{const e=this.load.bind(this);this.load=i=>{const s=new Promise(((t,e)=>{const s=ts(i,e);this.destroyed&&e(new Ve("load:instance-destroyed",`Instance of '${this.declaredClass||this.constructor.name}' is already destroyed`,{instance:this})),this._promiseProps.when(t,e).finally((()=>{s&&s.remove()}))}));if("not-loaded"===this.loadStatus){this._set("loadStatus","loading");const t=this._loadController=new AbortController;e({signal:t.signal}),Xi(t.signal,(()=>{this._promiseProps.abort()}))}return t(),s}}))),this.when((()=>{this._set("loadStatus","loaded"),this._loadController=null}),(t=>{this._set("loadStatus","failed"),this._set("loadError",t),this._loadController=null}))}get loaded(){return"loaded"===this.loadStatus}get loadWarnings(){return this._get("loadWarnings")}load(){return null}cancelLoad(){var t;return this.isFulfilled()||(this._set("loadError",new Ve("load:cancelled","Cancelled")),null==(t=this._loadController)||t.abort()),this}};return e([oe({readOnly:!0})],i.prototype,"loaded",null),e([oe({readOnly:!0})],i.prototype,"loadError",void 0),e([oe()],i.prototype,"loadStatus",void 0),e([oe({type:[Ie],readOnly:!0})],i.prototype,"loadWarnings",null),i=e([si("esri.core.Loadable")],i),i};let Ov=class extends(Tv(Zo)){};Ov=e([si("esri.core.Loadable")],Ov),function(t){t.LoadableMixin=Tv,t.isLoadable=function(t){return!(!t||!t.load)}}(Ov||(Ov={}));const Av=Ov;var Fv;const Cv=new ri({avgRating:"avg-rating",numRatings:"num-ratings",numComments:"num-comments",numViews:"num-views"});let Pv=Fv=class extends jo{constructor(t){super(t),this.categories=null,this.disableExtraQuery=!1,this.extent=null,this.filter=null,this.num=10,this.query=null,this.sortField=null,this.start=1}get sortOrder(){return this._get("sortOrder")||"asc"}set sortOrder(t){"asc"!==t&&"desc"!==t||this._set("sortOrder",t)}clone(){return new Fv({categories:this.categories?H(this.categories):null,disableExtraQuery:this.disableExtraQuery,extent:this.extent?this.extent.clone():null,filter:this.filter,num:this.num,query:this.query,sortField:this.sortField,sortOrder:this.sortOrder,start:this.start})}toRequestOptions(t,e){let i,s;if(this.categories&&(i=this.categories.map((t=>Array.isArray(t)?JSON.stringify(t):t))),this.extent){const t=Mp(this.extent,ap.WGS84);u(t)&&(s=`${t.xmin},${t.ymin},${t.xmax},${t.ymax}`)}let n=this.query;!this.disableExtraQuery&&t.extraQuery&&(n="("+n+")"+t.extraQuery);const r={categories:i,bbox:s,q:n,filter:this.filter,num:this.num,sortField:null,sortOrder:null,start:this.start};return this.sortField&&(r.sortField=this.sortField.split(",").map((t=>Cv.toJSON(t.trim()))).join(","),r.sortOrder=this.sortOrder),{query:{...e,...r}}}};e([oe()],Pv.prototype,"categories",void 0),e([oe()],Pv.prototype,"disableExtraQuery",void 0),e([oe({type:of})],Pv.prototype,"extent",void 0),e([oe()],Pv.prototype,"filter",void 0),e([oe()],Pv.prototype,"num",void 0),e([oe()],Pv.prototype,"query",void 0),e([oe()],Pv.prototype,"sortField",void 0),e([oe()],Pv.prototype,"sortOrder",null),e([oe()],Pv.prototype,"start",void 0),Pv=Fv=e([si("esri.portal.PortalQueryParams")],Pv);const Ev=Pv;let Rv=class extends jo{constructor(t){super(t),this.nextQueryParams=null,this.queryParams=null,this.results=null,this.total=null}};e([oe()],Rv.prototype,"nextQueryParams",void 0),e([oe()],Rv.prototype,"queryParams",void 0),e([oe()],Rv.prototype,"results",void 0),e([oe()],Rv.prototype,"total",void 0),Rv=e([si("esri.portal.PortalQueryResult")],Rv);const Lv=Rv;let Nv=class extends Vd{constructor(t){super(t),this.created=null,this.id=null,this.portal=null,this.title=null,this.username=null}get url(){const t=this.get("portal.restUrl");return t?`${t}/content/users/${this.username}/${this.id}`:null}toJSON(){throw new Ve("internal:not-yet-implemented","PortalFolder.toJSON is not yet implemented")}};e([oe({type:Date})],Nv.prototype,"created",void 0),e([oe()],Nv.prototype,"id",void 0),e([oe()],Nv.prototype,"portal",void 0),e([oe()],Nv.prototype,"title",void 0),e([oe({readOnly:!0})],Nv.prototype,"url",null),e([oe()],Nv.prototype,"username",void 0),Nv=e([si("esri.portal.PortalFolder")],Nv);const Dv=Nv;let Vv=class extends Vd{constructor(t){super(t),this.access=null,this.created=null,this.description=null,this.id=null,this.isInvitationOnly=!1,this.modified=null,this.owner=null,this.portal=null,this.snippet=null,this.sortField=null,this.sortOrder=null,this.tags=null,this.title=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal._normalizeUrl(`${t}/info/${e}?f=json`):null}get url(){const t=this.get("portal.restUrl");return t?t+"/community/groups/"+this.id:null}fetchCategorySchema(t){return this.portal._request(this.url+"/categorySchema",t).then((e=>{const i=e.categorySchema||[];return i.some((t=>"contentCategorySetsGroupQuery.LivingAtlas"===t.source))?this._fetchCategorySchemaSet("LivingAtlas",t):i}))}fetchMembers(t){return this.portal._request(this.url+"/users",t)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+="&w="+t),e}toJSON(){throw new Ve("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}queryItems(t,e){let i=Tt(Ev,t);return parseFloat(this.portal.currentVersion)>5?(i=i||new Ev,this.portal._queryPortal(`/content/groups/${this.id}/search`,i,"PortalItem",e)):(i=i?i.clone():new Ev,i.query="group:"+this.id+(i.query?" "+i.query:""),this.portal.queryItems(i,e))}_fetchCategorySchemaSet(t,e){return this.portal._fetchSelf(this.portal.authMode,!0,e).then((t=>{const i=t.contentCategorySetsGroupQuery;if(i){const t=new Ev;return t.disableExtraQuery=!0,t.num=1,t.query=i,this.portal.queryGroups(t,e)}throw new Ve("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery value not found")})).then((i=>{if(i.total){const s=i.results[0],n=new Ev;return n.num=1,n.query=`typekeywords:"${t}"`,s.queryItems(n,e)}throw new Ve("portal-group:fetchCategorySchema","contentCategorySetsGroupQuery group not found")})).then((t=>t.total?t.results[0].fetchData("json",e).then((t=>{const e=t&&t.categorySchema;return e&&e.length?e:[]})):[]))}};e([oe()],Vv.prototype,"access",void 0),e([oe({type:Date})],Vv.prototype,"created",void 0),e([oe()],Vv.prototype,"description",void 0),e([oe()],Vv.prototype,"id",void 0),e([oe()],Vv.prototype,"isInvitationOnly",void 0),e([oe({type:Date})],Vv.prototype,"modified",void 0),e([oe()],Vv.prototype,"owner",void 0),e([oe()],Vv.prototype,"portal",void 0),e([oe()],Vv.prototype,"snippet",void 0),e([oe()],Vv.prototype,"sortField",void 0),e([oe()],Vv.prototype,"sortOrder",void 0),e([oe()],Vv.prototype,"tags",void 0),e([oe()],Vv.prototype,"thumbnail",void 0),e([oe({readOnly:!0})],Vv.prototype,"thumbnailUrl",null),e([oe()],Vv.prototype,"title",void 0),e([oe({readOnly:!0})],Vv.prototype,"url",null),Vv=e([si("esri.portal.PortalGroup")],Vv);const $v=Vv,zv=Object.freeze({__proto__:null,default:$v});var Gv;let Uv=Gv=class extends Vd{constructor(...t){super(...t),this.access=null,this.created=null,this.culture=null,this.description=null,this.email=null,this.fullName=null,this.modified=null,this.orgId=null,this.portal=null,this.preferredView=null,this.privileges=null,this.region=null,this.role=null,this.roleId=null,this.sourceJSON=null,this.units=null,this.username=null,this.userType=null}get thumbnailUrl(){const t=this.url,e=this.thumbnail;return t&&e?this.portal._normalizeUrl(`${t}/info/${e}?f=json`):null}get userContentUrl(){const t=this.get("portal.restUrl");return t?`${t}/content/users/${this.username}`:null}get url(){const t=this.get("portal.restUrl");return t?`${t}/community/users/${this.username}`:null}addItem(t){const e=t&&t.item,i=t&&t.data,s=t&&t.folder,n={method:"post"};e&&(n.query=e.createPostQuery(),null!=i&&("string"==typeof i?n.query.text=i:"object"==typeof i&&(n.query.text=JSON.stringify(i))));let r=this.userContentUrl;return s&&(r+="/"+("string"==typeof s?s:s.id)),this.portal._request(r+"/addItem",n).then((t=>(e.id=t.id,e.portal=this.portal,e.loaded?e.reload():e.load())))}deleteItem(t){let e=this.userContentUrl;return t.ownerFolder&&(e+="/"+t.ownerFolder),this.portal._request(e+`/items/${t.id}/delete`,{method:"post"}).then((()=>{t.id=null,t.portal=null}))}deleteItems(t){const e=this.userContentUrl+"/deleteItems",i=t.map((t=>t.id));if(i.length){const s={method:"post",query:{items:i.join(",")}};return this.portal._request(e,s).then((()=>{t.forEach((t=>{t.id=null,t.portal=null}))}))}return Promise.resolve(void 0)}fetchFolders(){return this.portal._request(this.userContentUrl,{query:{num:1}}).then((t=>{let e;return e=t&&t.folders?t.folders.map((t=>{const e=Dv.fromJSON(t);return e.portal=this.portal,e})):[],e}))}fetchGroups(){return this.portal._request(this.url).then((t=>{let e;return e=t&&t.groups?t.groups.map((t=>{const e=$v.fromJSON(t);return e.portal=this.portal,e})):[],e}))}fetchItems(t){t||(t={});let e,i=this.userContentUrl;return t.folder&&(i+="/"+t.folder.id),Promise.resolve().then((function(){return NO})).then((({default:s})=>(e=s,this.portal._request(i,{query:{folders:!1,num:t.num||10,start:t.start||1,sortField:t.sortField||"created",sortOrder:t.sortOrder||"asc"}})))).then((t=>{let i;return t&&t.items?(i=t.items.map((t=>{const i=e.fromJSON(t);return i.portal=this.portal,i})),Promise.all(i.map((t=>t.load()))).catch((t=>t)).then((()=>({items:i,nextStart:t.nextStart,total:t.total})))):{items:[],nextStart:-1,total:0}}))}fetchTags(){return this.portal._request(this.url+"/tags").then((t=>t.tags))}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+="&w="+t),e}queryFavorites(t){return this.favGroupId?(this._favGroup||(this._favGroup=new $v({id:this.favGroupId,portal:this.portal})),this._favGroup.queryItems(t)):Promise.reject(new Ve("internal:unknown","Unknown internal error",{internalError:"Unknown favGroupId"}))}toJSON(){throw new Ve("internal:not-yet-implemented","PortalGroup.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw Error("JSON object is already hydrated");const e=new Gv;return e.sourceJSON=t,e.read(t),e}};e([oe()],Uv.prototype,"access",void 0),e([oe({type:Date})],Uv.prototype,"created",void 0),e([oe()],Uv.prototype,"culture",void 0),e([oe()],Uv.prototype,"description",void 0),e([oe()],Uv.prototype,"email",void 0),e([oe()],Uv.prototype,"favGroupId",void 0),e([oe()],Uv.prototype,"fullName",void 0),e([oe({type:Date})],Uv.prototype,"modified",void 0),e([oe()],Uv.prototype,"orgId",void 0),e([oe()],Uv.prototype,"portal",void 0),e([oe()],Uv.prototype,"preferredView",void 0),e([oe()],Uv.prototype,"privileges",void 0),e([oe()],Uv.prototype,"region",void 0),e([oe()],Uv.prototype,"role",void 0),e([oe()],Uv.prototype,"roleId",void 0),e([oe()],Uv.prototype,"sourceJSON",void 0),e([oe()],Uv.prototype,"thumbnail",void 0),e([oe({readOnly:!0})],Uv.prototype,"thumbnailUrl",null),e([oe()],Uv.prototype,"units",void 0),e([oe({readOnly:!0})],Uv.prototype,"userContentUrl",null),e([oe({readOnly:!0})],Uv.prototype,"url",null),e([oe()],Uv.prototype,"username",void 0),e([oe()],Uv.prototype,"userType",void 0),Uv=Gv=e([si("esri.portal.PortalUser")],Uv);const qv=Uv,Bv=Object.freeze({__proto__:null,default:qv});var Wv;let Hv;const Jv={PortalGroup:()=>Promise.resolve().then((function(){return zv})),PortalItem:()=>Promise.resolve().then((function(){return NO})),PortalUser:()=>Promise.resolve().then((function(){return Bv}))};let Zv=Wv=class extends(Ld(Av)){constructor(t){super(t),this.access=null,this.allSSL=!1,this.authMode="auto",this.authorizedCrossOriginDomains=null,this.basemapGalleryGroupQuery=null,this.bingKey=null,this.canListApps=!1,this.canListData=!1,this.canListPreProvisionedItems=!1,this.canProvisionDirectPurchase=!1,this.canSearchPublic=!0,this.canShareBingPublic=!1,this.canSharePublic=!1,this.canSignInArcGIS=!1,this.canSignInIDP=!1,this.colorSetsGroupQuery=null,this.commentsEnabled=!1,this.created=null,this.culture=null,this.customBaseUrl=null,this.defaultBasemap=null,this.defaultDevBasemap=null,this.defaultExtent=null,this.defaultVectorBasemap=null,this.description=null,this.devBasemapGalleryGroupQuery=null,this.eueiEnabled=null,this.featuredGroups=null,this.featuredItemsGroupQuery=null,this.galleryTemplatesGroupQuery=null,this.livingAtlasGroupQuery=null,this.hasCategorySchema=!1,this.helperServices=null,this.homePageFeaturedContent=null,this.homePageFeaturedContentCount=null,this.httpPort=null,this.httpsPort=null,this.id=null,this.ipCntryCode=null,this.isPortal=!1,this.isReadOnly=!1,this.layerTemplatesGroupQuery=null,this.maxTokenExpirationMinutes=null,this.modified=null,this.name=null,this.portalHostname=null,this.portalMode=null,this.portalProperties=null,this.region=null,this.rotatorPanels=null,this.showHomePageDescription=!1,this.sourceJSON=null,this.supportsHostedServices=!1,this.symbolSetsGroupQuery=null,this.templatesGroupQuery=null,this.units=null,this.url=it.portalUrl,this.urlKey=null,this.user=null,this.useStandardizedQuery=!1,this.useVectorBasemaps=!1,this.vectorBasemapGalleryGroupQuery=null}normalizeCtorArgs(t){return"string"==typeof t?{url:t}:t}destroy(){this._esriId_credentialCreateHandle&&(this._esriId_credentialCreateHandle.remove(),this._esriId_credentialCreateHandle=null)}readAuthorizedCrossOriginDomains(t){if(t)for(const e of t)-1===it.request.trustedServers.indexOf(e)&&it.request.trustedServers.push(e);return t}readDefaultBasemap(t){return this._readBasemap(t)}readDefaultDevBasemap(t){return this._readBasemap(t)}readDefaultVectorBasemap(t){return this._readBasemap(t)}get extraQuery(){return this.id&&this.user&&this.user.orgId&&!this.canSearchPublic?" AND orgid:"+this.id:null}get isOrganization(){return!!this.access}get restUrl(){let t=this.url;if(t){const e=t.indexOf("/sharing");t=e>0?t.substring(0,e):this.url.replace(/\/+$/,""),t+="/sharing/rest"}return t}get stylesGroupQuery(){return hr(ct.getLogger(this.declaredClass),"stylesGroupQuery",{replacement:"stylesGroupQuery3d",version:"4.21"}),this.stylesGroupQuery3d}get thumbnailUrl(){const t=this.restUrl,e=this.thumbnail;return t&&e?this._normalizeSSL(t+"/portals/self/resources/"+e):null}readUrlKey(t){return t?t.toLowerCase():t}readUser(t){let e=null;return t&&(e=qv.fromJSON(t),e.portal=this),e}load(t){const e=Promise.resolve().then((function(){return ZO})).then((({default:e})=>{Ji(t),Hv=e})).then((()=>this.sourceJSON?this.sourceJSON:this._fetchSelf(this.authMode,!1,t))).then((t=>{if(Pn){const t=Pn;this.credential=t.findCredential(this.restUrl),this.credential||this.authMode!==Wv.AUTH_MODE_AUTO||(this._esriId_credentialCreateHandle=t.on("credential-create",(()=>{t.findCredential(this.restUrl)&&this._signIn()})))}this.sourceJSON=t,this.read(t)}));return this.addResolvingPromise(e),Promise.resolve(this)}async createClosestFacilityTask(){cr(ct.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/closestFacility",version:"4.21"}),await this.load();const t=this._getHelperServiceUrl("closestFacility");return new((await import("./p-edc8202e.js")).default)(t)}async createElevationLayers(){await this.load();const t=this._getHelperService("defaultElevationLayers"),e=(await import("./p-aabbbb9a.js")).default;return t?t.map((t=>new e({id:t.id,url:t.url}))):[]}async createGeometryService(){cr(ct.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/geometryService",version:"4.21"}),await this.load();const t=this._getHelperServiceUrl("geometry");return new((await import("./p-a9f2caa5.js")).default)({url:t})}async createPrintTask(){cr(ct.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/print",version:"4.21"}),await this.load();const t=this._getHelperServiceUrl("printTask");return new((await import("./p-f4a9173e.js")).default)(t)}async createRouteTask(){cr(ct.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/route",version:"4.21"}),await this.load();const t=this._getHelperServiceUrl("route");return new((await import("./p-de09abc7.js")).default)(t)}async createServiceAreaTask(){cr(ct.getLogger(this.declaredClass),null,{replacement:"Use helperServices url with esri/rest/serviceArea",version:"4.21"}),await this.load();const t=this._getHelperServiceUrl("serviceArea");return new((await import("./p-2f0c6779.js")).default)(t)}fetchBasemaps(t,e){const i=new Ev;return i.query=t||(it.apiKey&&Nn(this.url)?this.devBasemapGalleryGroupQuery:this.useVectorBasemaps?this.vectorBasemapGalleryGroupQuery:this.basemapGalleryGroupQuery),i.disableExtraQuery=!0,this.queryGroups(i,e).then((t=>{if(i.num=100,i.query='type:"Web Map" -type:"Web Application"',t.total){const s=t.results[0];return i.sortField=s.sortField||"name",i.sortOrder=s.sortOrder||"desc",s.queryItems(i,e)}return null})).then((t=>{let e;return e=t&&t.total?t.results.filter((t=>"Web Map"===t.type)).map((t=>new Hv({portalItem:t}))):[],e}))}fetchCategorySchema(t){return this.hasCategorySchema?this._request(this.restUrl+"/portals/self/categorySchema",t).then((t=>t.categorySchema)):Qi(t)?Promise.reject(Hi()):Promise.resolve([])}fetchFeaturedGroups(t){const e=this.featuredGroups,i=new Ev;if(i.num=100,i.sortField="title",e&&e.length){const s=[];for(const t of e)s.push(`(title:"${t.title}" AND owner:${t.owner})`);return i.query=s.join(" OR "),this.queryGroups(i,t).then((t=>t.results))}return Qi(t)?Promise.reject(Hi()):Promise.resolve([])}fetchRegions(t){const e=this.user&&this.user.culture||this.culture||pi();return this._request(this.restUrl+"/portals/regions",{...t,query:{culture:e}})}static getDefault(){return Wv._default&&!Wv._default.destroyed||(Wv._default=new Wv),Wv._default}queryGroups(t,e){return this._queryPortal("/community/groups",t,"PortalGroup",e)}queryItems(t,e){return this._queryPortal("/search",t,"PortalItem",e)}queryUsers(t,e){return t.sortField||(t.sortField="username"),this._queryPortal("/community/users",t,"PortalUser",e)}toJSON(){throw new Ve("internal:not-yet-implemented","Portal.toJSON is not yet implemented")}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw Error("JSON object is already hydrated");return new Wv({sourceJSON:t})}_getHelperService(t){const e=this.helperServices&&this.helperServices[t];if(!e)throw new Ve("portal:service-not-found",`The \`helperServices\` do not include an entry named "${t}"`);return e}_getHelperServiceUrl(t){const e=this._getHelperService(t);if(!e.url)throw new Ve("portal:service-url-not-found",`The \`helperServices\` entry "${t}" does not include a \`url\` value`);return e.url}_fetchSelf(t=this.authMode,e=!1,i){const s=this.restUrl+"/portals/self",n={authMode:t,query:{culture:pi().toLowerCase()},...i};return"auto"===n.authMode&&(n.authMode="no-prompt"),e&&(n.query.default=!0),this._request(s,n)}_queryPortal(t,e,i,s){const n=Tt(Ev,e),r=e=>this._request(this.restUrl+t,{...n.toRequestOptions(this),...s}).then((t=>{const i=n.clone();return i.start=t.nextStart,new Lv({nextQueryParams:i,queryParams:n,total:t.total,results:Wv._resultsToTypedArray(e,{portal:this},t,s)})})).then((t=>Promise.all(t.results.map((e=>"function"==typeof e.when?e.when():t))).then((()=>t),(e=>(Ki(e),t)))));return i&&Jv[i]?Jv[i]().then((({default:t})=>(Ji(s),r(t)))):r()}_signIn(){if(this.authMode===Wv.AUTH_MODE_ANONYMOUS)return Promise.reject(new Ve("portal:invalid-auth-mode",`Current "authMode"' is "${this.authMode}"`));if("failed"===this.loadStatus)return Promise.reject(this.loadError);const t=t=>Promise.resolve().then((()=>"not-loaded"===this.loadStatus?(t||(this.authMode="immediate"),this.load().then((()=>null))):"loading"===this.loadStatus?this.load().then((()=>this.credential?null:(this.credential=t,this._fetchSelf("immediate")))):this.user&&this.credential===t?null:(this.credential=t,this._fetchSelf("immediate")))).then((t=>{t&&(this.sourceJSON=t,this.read(t))}));return Pn?Pn.getCredential(this.restUrl).then((e=>t(e))):t(this.credential)}_normalizeSSL(t){return t.replace(/^http:/i,"https:").replace(":7080",":7443")}_normalizeUrl(t){const e=this.credential&&this.credential.token;return this._normalizeSSL(e?t+(t.indexOf("?")>-1?"&":"?")+"token="+e:t)}_requestToTypedArray(t,e,i){return this._request(t,e).then((t=>{const e=Wv._resultsToTypedArray(i,{portal:this},t);return Promise.all(e.map((e=>"function"==typeof e.when?e.when():t))).then((()=>e),(()=>e))}))}_readBasemap(t){if(t){const e=Hv.fromJSON(t);return e.portalItem={portal:this},e}return null}_request(t,e={}){const i={f:"json",...e.query},{authMode:s=(this.authMode===Wv.AUTH_MODE_ANONYMOUS?"anonymous":"auto"),body:n=null,cacheBust:r=!1,method:o="auto",responseType:a="json",signal:l}=e,u={authMode:s,body:n,cacheBust:r,method:o,query:i,responseType:a,timeout:0,signal:l};return $n(this._normalizeSSL(t),u).then((t=>t.data))}static _resultsToTypedArray(t,e,i,s){let n;if(i){const r=u(s)?s.signal:null;n=i.listings||i.notifications||i.userInvitations||i.tags||i.items||i.groups||i.comments||i.provisions||i.results||i.relatedItems||i,(t||e)&&(n=n.map((i=>{const s=Object.assign(t?t.fromJSON(i):i,e);return"function"==typeof s.load&&s.load(r),s})))}else n=[];return n}};Zv.AUTH_MODE_ANONYMOUS="anonymous",Zv.AUTH_MODE_AUTO="auto",Zv.AUTH_MODE_IMMEDIATE="immediate",e([oe()],Zv.prototype,"access",void 0),e([oe()],Zv.prototype,"allSSL",void 0),e([oe()],Zv.prototype,"authMode",void 0),e([oe()],Zv.prototype,"authorizedCrossOriginDomains",void 0),e([Sd("authorizedCrossOriginDomains")],Zv.prototype,"readAuthorizedCrossOriginDomains",null),e([oe()],Zv.prototype,"basemapGalleryGroupQuery",void 0),e([oe()],Zv.prototype,"bingKey",void 0),e([oe()],Zv.prototype,"canListApps",void 0),e([oe()],Zv.prototype,"canListData",void 0),e([oe()],Zv.prototype,"canListPreProvisionedItems",void 0),e([oe()],Zv.prototype,"canProvisionDirectPurchase",void 0),e([oe()],Zv.prototype,"canSearchPublic",void 0),e([oe()],Zv.prototype,"canShareBingPublic",void 0),e([oe()],Zv.prototype,"canSharePublic",void 0),e([oe()],Zv.prototype,"canSignInArcGIS",void 0),e([oe()],Zv.prototype,"canSignInIDP",void 0),e([oe()],Zv.prototype,"colorSetsGroupQuery",void 0),e([oe()],Zv.prototype,"commentsEnabled",void 0),e([oe({type:Date})],Zv.prototype,"created",void 0),e([oe()],Zv.prototype,"credential",void 0),e([oe()],Zv.prototype,"culture",void 0),e([oe()],Zv.prototype,"currentVersion",void 0),e([oe()],Zv.prototype,"customBaseUrl",void 0),e([oe()],Zv.prototype,"defaultBasemap",void 0),e([Sd("defaultBasemap")],Zv.prototype,"readDefaultBasemap",null),e([oe()],Zv.prototype,"defaultDevBasemap",void 0),e([Sd("defaultDevBasemap")],Zv.prototype,"readDefaultDevBasemap",null),e([oe({type:of})],Zv.prototype,"defaultExtent",void 0),e([oe()],Zv.prototype,"defaultVectorBasemap",void 0),e([Sd("defaultVectorBasemap")],Zv.prototype,"readDefaultVectorBasemap",null),e([oe()],Zv.prototype,"description",void 0),e([oe()],Zv.prototype,"devBasemapGalleryGroupQuery",void 0),e([oe()],Zv.prototype,"eueiEnabled",void 0),e([oe({readOnly:!0})],Zv.prototype,"extraQuery",null),e([oe()],Zv.prototype,"featuredGroups",void 0),e([oe()],Zv.prototype,"featuredItemsGroupQuery",void 0),e([oe()],Zv.prototype,"galleryTemplatesGroupQuery",void 0),e([oe()],Zv.prototype,"livingAtlasGroupQuery",void 0),e([oe()],Zv.prototype,"hasCategorySchema",void 0),e([oe()],Zv.prototype,"helpBase",void 0),e([oe()],Zv.prototype,"helperServices",void 0),e([oe()],Zv.prototype,"helpMap",void 0),e([oe()],Zv.prototype,"homePageFeaturedContent",void 0),e([oe()],Zv.prototype,"homePageFeaturedContentCount",void 0),e([oe()],Zv.prototype,"httpPort",void 0),e([oe()],Zv.prototype,"httpsPort",void 0),e([oe()],Zv.prototype,"id",void 0),e([oe()],Zv.prototype,"ipCntryCode",void 0),e([oe({readOnly:!0})],Zv.prototype,"isOrganization",null),e([oe()],Zv.prototype,"isPortal",void 0),e([oe()],Zv.prototype,"isReadOnly",void 0),e([oe()],Zv.prototype,"layerTemplatesGroupQuery",void 0),e([oe()],Zv.prototype,"maxTokenExpirationMinutes",void 0),e([oe({type:Date})],Zv.prototype,"modified",void 0),e([oe()],Zv.prototype,"name",void 0),e([oe()],Zv.prototype,"portalHostname",void 0),e([oe()],Zv.prototype,"portalMode",void 0),e([oe()],Zv.prototype,"portalProperties",void 0),e([oe()],Zv.prototype,"region",void 0),e([oe({readOnly:!0})],Zv.prototype,"restUrl",null),e([oe()],Zv.prototype,"rotatorPanels",void 0),e([oe()],Zv.prototype,"showHomePageDescription",void 0),e([oe()],Zv.prototype,"sourceJSON",void 0),e([oe()],Zv.prototype,"staticImagesUrl",void 0),e([oe({readOnly:!0,json:{read:!1}})],Zv.prototype,"stylesGroupQuery",null),e([oe({json:{name:"2DStylesGroupQuery"}})],Zv.prototype,"stylesGroupQuery2d",void 0),e([oe({json:{name:"stylesGroupQuery"}})],Zv.prototype,"stylesGroupQuery3d",void 0),e([oe()],Zv.prototype,"supportsHostedServices",void 0),e([oe()],Zv.prototype,"symbolSetsGroupQuery",void 0),e([oe()],Zv.prototype,"templatesGroupQuery",void 0),e([oe()],Zv.prototype,"thumbnail",void 0),e([oe({readOnly:!0})],Zv.prototype,"thumbnailUrl",null),e([oe()],Zv.prototype,"units",void 0),e([oe()],Zv.prototype,"url",void 0),e([oe()],Zv.prototype,"urlKey",void 0),e([Sd("urlKey")],Zv.prototype,"readUrlKey",null),e([oe()],Zv.prototype,"user",void 0),e([Sd("user")],Zv.prototype,"readUser",null),e([oe()],Zv.prototype,"useStandardizedQuery",void 0),e([oe()],Zv.prototype,"useVectorBasemaps",void 0),e([oe()],Zv.prototype,"vectorBasemapGalleryGroupQuery",void 0),Zv=Wv=e([si("esri.portal.Portal")],Zv);const Qv=Zv;var Kv;let Yv=Kv=class extends lm{constructor(t){super(t),this.material=null,this.type="line",this.join="miter",this.cap="butt",this.size=hm(1),this.pattern=null}clone(){const t={enabled:this.enabled,material:u(this.material)?this.material.clone():null,size:this.size,join:this.join,cap:this.cap,pattern:u(this.pattern)?this.pattern.clone():null};return new Kv(t)}static fromSimpleLineSymbol(t){const e={enabled:!0,size:t.width||1,cap:t.cap||"butt",join:t.join||"miter",pattern:t.style&&"inside-frame"!==t.style?new Zm({style:t.style}):null,material:new Tm({color:(t.color||sg).clone()})};return new Kv(e)}};e([oe({type:Tm,json:{write:!0}})],Yv.prototype,"material",void 0),e([Md({Line:"line"},{readOnly:!0})],Yv.prototype,"type",void 0),e([oe({type:Gg,json:{write:!0,default:"miter"}})],Yv.prototype,"join",void 0),e([oe({type:$g,json:{write:!0,default:"butt"}})],Yv.prototype,"cap",void 0),e([oe(vm)],Yv.prototype,"size",void 0),e([oe(ig)],Yv.prototype,"pattern",void 0),Yv=Kv=e([si("esri.symbols.LineSymbol3DLayer")],Yv);const Xv=Yv;var tw;const ew=oi()({sphere:"sphere",cylinder:"cylinder",cube:"cube",cone:"cone",diamond:"diamond",tetrahedron:"tetrahedron",invertedCone:"inverted-cone"});let iw=tw=class extends Vd{clone(){return new tw({href:this.href,primitive:this.primitive})}};e([oe({type:String,json:{read:tv,write:ev}})],iw.prototype,"href",void 0),e([Md(ew)],iw.prototype,"primitive",void 0),iw=tw=e([si("esri.symbols.support.ObjectSymbol3DLayerResource")],iw);const sw="sphere",nw=iw;var rw;let ow=rw=class extends jo{constructor(){super(...arguments),this.x=0,this.y=0,this.z=0}clone(){return new rw({x:this.x,y:this.y,z:this.z})}};var aw;e([oe({type:Number})],ow.prototype,"x",void 0),e([oe({type:Number})],ow.prototype,"y",void 0),e([oe({type:Number})],ow.prototype,"z",void 0),ow=rw=e([si("esri.symbols.support.Symbol3DAnchorPosition3D")],ow);let lw=aw=class extends lm{constructor(t){super(t),this.material=null,this.castShadows=!0,this.resource=null,this.type="object",this.width=void 0,this.height=void 0,this.depth=void 0,this.anchor=void 0,this.anchorPosition=void 0,this.heading=void 0,this.tilt=void 0,this.roll=void 0}clone(){return new aw({heading:this.heading,tilt:this.tilt,roll:this.roll,anchor:this.anchor,anchorPosition:this.anchorPosition&&this.anchorPosition.clone(),depth:this.depth,enabled:this.enabled,height:this.height,material:u(this.material)?this.material.clone():null,castShadows:this.castShadows,resource:this.resource&&this.resource.clone(),width:this.width})}get isPrimitive(){return!this.resource||"string"!=typeof this.resource.href}};e([oe({type:Om,json:{write:!0}})],lw.prototype,"material",void 0),e([oe({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],lw.prototype,"castShadows",void 0),e([oe({type:nw,json:{write:!0}})],lw.prototype,"resource",void 0),e([Md({Object:"object"},{readOnly:!0})],lw.prototype,"type",void 0),e([oe({type:Number,json:{write:!0}})],lw.prototype,"width",void 0),e([oe({type:Number,json:{write:!0}})],lw.prototype,"height",void 0),e([oe({type:Number,json:{write:!0}})],lw.prototype,"depth",void 0),e([Md({center:"center",top:"top",bottom:"bottom",origin:"origin",relative:"relative"}),oe({json:{default:"origin"}})],lw.prototype,"anchor",void 0),e([oe({type:ow,json:{type:[Number],read:{reader:t=>new ow({x:t[0],y:t[1],z:t[2]})},write:{writer:(t,e)=>{e.anchorPosition=[t.x,t.y,t.z]},overridePolicy(){return{enabled:"relative"===this.anchor}}}}})],lw.prototype,"anchorPosition",void 0),e([oe({type:Number,json:{write:!0}})],lw.prototype,"heading",void 0),e([oe({type:Number,json:{write:!0}})],lw.prototype,"tilt",void 0),e([oe({type:Number,json:{write:!0}})],lw.prototype,"roll",void 0),e([oe({readOnly:!0})],lw.prototype,"isPrimitive",null),lw=aw=e([si("esri.symbols.ObjectSymbol3DLayer")],lw);const uw=lw;var cw;let hw=cw=class extends lm{constructor(t){super(t),this.material=null,this.castShadows=!0,this.type="path",this.profile="circle",this.join="miter",this.cap="butt",this.width=void 0,this.height=void 0,this.anchor="center",this.profileRotation="all"}readWidth(t,e){return null!=t?t:null==e.height&&null!=e.size?e.size:void 0}readHeight(t,e){return null!=t?t:null==e.width&&null!=e.size?e.size:void 0}clone(){return new cw({enabled:this.enabled,material:u(this.material)?this.material.clone():null,castShadows:this.castShadows,profile:this.profile,join:this.join,cap:this.cap,width:this.width,height:this.height,profileRotation:this.profileRotation,anchor:this.anchor})}};e([oe({type:Om,json:{write:!0}})],hw.prototype,"material",void 0),e([oe({type:Boolean,nonNullable:!0,json:{write:!0,default:!0}})],hw.prototype,"castShadows",void 0),e([Md({Path:"path"},{readOnly:!0})],hw.prototype,"type",void 0),e([oe({type:["circle","quad"],json:{write:!0,default:"circle"}})],hw.prototype,"profile",void 0),e([oe({type:Gg,json:{write:!0,default:"miter"}})],hw.prototype,"join",void 0),e([oe({type:zg,json:{write:!0,default:"butt"}})],hw.prototype,"cap",void 0),e([oe({type:Number,json:{write:{enabled:!0,target:{width:{type:Number},size:{type:Number}}}}})],hw.prototype,"width",void 0),e([Sd("width",["width","size","height"])],hw.prototype,"readWidth",null),e([oe({type:Number,json:{write:!0}})],hw.prototype,"height",void 0),e([Sd("height",["height","size","width"])],hw.prototype,"readHeight",null),e([oe({type:["center","bottom","top"],json:{write:!0,default:"center"}})],hw.prototype,"anchor",void 0),e([oe({type:["heading","all"],json:{write:!0,default:"all"}})],hw.prototype,"profileRotation",void 0),hw=cw=e([si("esri.symbols.PathSymbol3DLayer")],hw);const dw=hw;var pw;let fw=pw=class extends Vd{constructor(){super(...arguments),this.color=new bd([0,0,0,1]),this.size=0}clone(){return new pw({color:H(this.color),size:this.size})}};e([oe(gm)],fw.prototype,"color",void 0),e([oe(vm)],fw.prototype,"size",void 0),fw=pw=e([si("esri.symbols.support.Symbol3DHalo")],fw);const yw=fw;var mw;let gw=mw=class extends lm{constructor(t){super(t),this._userSize=void 0,this.halo=null,this.material=null,this.text=void 0,this.type="text"}get font(){return this._get("font")||null}set font(t){t&&this._userSize&&(t.size=this._userSize),this._set("font",t)}writeFont(t,e,i,s){const n={...s,textSymbol3D:!0};e.font=t.write({},n),delete e.font.size}get size(){return null!=this._userSize?this._userSize:this.font&&null!=this.font.size?this.font.size:9}set size(t){this._userSize=t,this.font&&(this.font.size=this._userSize),this.notifyChange("size")}clone(){return new mw({enabled:this.enabled,font:this.font&&H(this.font),halo:this.halo&&H(this.halo),material:u(this.material)?this.material.clone():null,size:this.size,text:this.text})}static fromTextSymbol(t){const e=function(t,e){return t&&e>0?{color:H(t),size:e}:null}(t.haloColor,t.haloSize),i=t.font?t.font.clone():new Kg;return new mw({size:i.size,font:i,halo:e,material:t.color?{color:t.color.clone()}:null,text:t.text})}};e([oe({type:Kg,json:{write:!0}})],gw.prototype,"font",null),e([xd("font")],gw.prototype,"writeFont",null),e([oe({type:yw,json:{write:!0}})],gw.prototype,"halo",void 0),e([oe({type:Om,json:{write:!0}})],gw.prototype,"material",void 0),e([oe(vm),oe()],gw.prototype,"size",null),e([oe({type:String,json:{write:!0}})],gw.prototype,"text",void 0),e([Md({Text:"text"},{readOnly:!0})],gw.prototype,"type",void 0),gw=mw=e([si("esri.symbols.TextSymbol3DLayer")],gw);const vw=gw;var ww;let bw=ww=class extends lm{constructor(t){super(t),this.color=Mw.clone(),this.type="water",this.waterbodySize="medium",this.waveDirection=null,this.waveStrength="moderate"}clone(){return new ww({color:H(this.color),waterbodySize:this.waterbodySize,waveDirection:this.waveDirection,waveStrength:this.waveStrength})}};e([oe({type:bd,nonNullable:!0,json:{type:[Rt],write:(t,e,i)=>e[i]=t.toArray(1),default:()=>Mw.clone(),defaultEquals:t=>t.toCss(!0)===Mw.toCss(!0)}})],bw.prototype,"color",void 0),e([Md({Water:"water"},{readOnly:!0})],bw.prototype,"type",void 0),e([oe({type:["small","medium","large"],json:{write:!0,default:"medium"}})],bw.prototype,"waterbodySize",void 0),e([oe({type:Number,json:{write:!0,default:null}})],bw.prototype,"waveDirection",void 0),e([oe({type:["calm","rippled","slight","moderate"],json:{write:!0,default:"moderate"}})],bw.prototype,"waveStrength",void 0),bw=ww=e([si("esri.symbols.WaterSymbol3DLayer")],bw);const Mw=new bd([0,119,190]),Sw=bw;var xw;let kw=xw=class extends jo{constructor(){super(...arguments),this.portal=null}clone(){return new xw({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}};e([oe({type:String})],kw.prototype,"name",void 0),e([oe({type:String})],kw.prototype,"styleUrl",void 0),e([oe({type:String})],kw.prototype,"styleName",void 0),e([oe({type:Qv})],kw.prototype,"portal",void 0),kw=xw=e([si("esri.symbols.support.StyleOrigin")],kw);const Iw=kw;var jw;let _w=jw=class extends jo{clone(){return new jw({url:this.url})}};e([oe({type:String})],_w.prototype,"url",void 0),_w=jw=e([si("esri.symbols.support.Thumbnail")],_w);const Tw=_w,Ow={icon:Iv,object:uw,line:Xv,path:dw,fill:Jg,extrude:Cm,text:vw,water:Sw},Aw=qo.ofType({base:lm,key:"type",typeMap:Ow,errorContext:"symbol-layer"}),Fw=ct.getLogger("esri.symbols.Symbol3D");let Cw=class extends sm{constructor(t){super(t),this.styleOrigin=null,this.thumbnail=null,this.type=null;const e=this.__accessor__&&this.__accessor__.metadatas&&this.__accessor__.metadatas.symbolLayers;this._set("symbolLayers",new(e&&e.type||qo))}get color(){return null}set color(t){Fw.error("Symbol3D does not support colors on the symbol level. Colors may be set on individual symbol layer materials instead.")}set symbolLayers(t){jv(t,this._get("symbolLayers"))}readStyleOrigin(t,e,i){if(t.styleUrl&&t.name){const e=Yg(t.styleUrl,i);return new Iw({styleUrl:e,name:t.name})}if(t.styleName&&t.name)return new Iw({portal:i&&i.portal||Qv.getDefault(),styleName:t.styleName,name:t.name});i&&i.messages&&i.messages.push(new Ie("symbol3d:incomplete-style-origin","Style origin requires either a 'styleUrl' or 'styleName' and a 'name' property",{context:i,definition:t}))}writeStyleOrigin(t,e,i,s){if(t.styleUrl&&t.name){let i=Xg(t.styleUrl,s);on(i)&&(i=sn(i)),e.styleOrigin={styleUrl:i,name:t.name}}else t.styleName&&t.name&&(t.portal&&s&&s.portal&&!Js(t.portal.restUrl,s.portal.restUrl)?s&&s.messages&&s.messages.push(new Ie("symbol:cross-portal","The symbol style origin cannot be persisted because it refers to an item on a different portal than the one being saved to.",{symbol:this})):e.styleOrigin={styleName:t.styleName,name:t.name})}normalizeCtorArgs(t){return t instanceof lm||t&&Ow[t.type]?{symbolLayers:[t]}:Array.isArray(t)?{symbolLayers:t}:t}};e([oe({json:{read:!1,write:!1}})],Cw.prototype,"color",null),e([oe({type:Aw,nonNullable:!0,json:{write:!0}}),ba(_v)],Cw.prototype,"symbolLayers",null),e([oe({type:Iw})],Cw.prototype,"styleOrigin",void 0),e([Sd("styleOrigin")],Cw.prototype,"readStyleOrigin",null),e([xd("styleOrigin",{"styleOrigin.styleUrl":{type:String},"styleOrigin.styleName":{type:String},"styleOrigin.name":{type:String}})],Cw.prototype,"writeStyleOrigin",null),e([oe({type:Tw,json:{read:!1}})],Cw.prototype,"thumbnail",void 0),e([oe({type:["point-3d","line-3d","polygon-3d","mesh-3d","label-3d"],readOnly:!0})],Cw.prototype,"type",void 0),Cw=e([si("esri.symbols.Symbol3D")],Cw);const Pw=Cw;let Ew=class extends Vd{constructor(t){super(t),this.visible=!0}clone(){}};e([oe({type:["line"],readOnly:!0,json:{read:!1,write:{ignoreOrigin:!0}}})],Ew.prototype,"type",void 0),e([oe({readOnly:!0})],Ew.prototype,"visible",void 0),Ew=e([si("esri.symbols.callouts.Callout3D")],Ew);const Rw=Ew;var Lw;let Nw=Lw=class extends Vd{constructor(){super(...arguments),this.color=new bd("white")}clone(){return new Lw({color:H(this.color)})}};e([oe(gm)],Nw.prototype,"color",void 0),Nw=Lw=e([si("esri.symbols.callouts.LineCallout3DBorder")],Nw);const Dw=Nw;var Vw;Object.freeze({__proto__:null,get LineCallout3DBorder(){return Nw},default:Dw});let $w=Vw=class extends Rw{constructor(t){super(t),this.type="line",this.color=new bd([0,0,0,1]),this.size=hm(1),this.border=null}get visible(){return this.size>0&&u(this.color)&&this.color.a>0}clone(){return new Vw({color:H(this.color),size:this.size,border:H(this.border)})}};function zw(t){if(!t)return!1;const e=t.verticalOffset;return!!e&&!(e.screenLength<=0||e.maxWorldLength<=0)}function Gw(t){if(!t)return!1;if(!t.supportsCallout||!t.supportsCallout())return!1;const e=t.callout;return!!e&&!!e.visible&&!!zw(t)}e([Md({line:"line"},{readOnly:!0})],$w.prototype,"type",void 0),e([oe(gm)],$w.prototype,"color",void 0),e([oe(vm)],$w.prototype,"size",void 0),e([oe({type:Dw,json:{write:!0}})],$w.prototype,"border",void 0),e([oe({readOnly:!0})],$w.prototype,"visible",null),$w=Vw=e([si("esri.symbols.callouts.LineCallout3D")],$w);const Uw={types:{key:"type",base:Rw,typeMap:{line:$w}},json:{write:!0}};var qw;let Bw=qw=class extends Vd{constructor(){super(...arguments),this.screenLength=0,this.minWorldLength=0}clone(){return new qw({screenLength:this.screenLength,minWorldLength:this.minWorldLength,maxWorldLength:this.maxWorldLength})}};e([oe(vm)],Bw.prototype,"screenLength",void 0),e([oe({type:Number,json:{write:!0,default:0}})],Bw.prototype,"minWorldLength",void 0),e([oe({type:Number,json:{write:!0}})],Bw.prototype,"maxWorldLength",void 0),Bw=qw=e([si("esri.symbols.support.Symbol3DVerticalOffset")],Bw);const Ww=Bw;var Hw;const Jw=qo.ofType({base:null,key:"type",typeMap:{text:vw}});let Zw=Hw=class extends Pw{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.styleOrigin=null,this.symbolLayers=new Jw,this.type="label-3d"}supportsCallout(){return!0}hasVisibleCallout(){return Gw(this)}hasVisibleVerticalOffset(){return zw(this)}clone(){return new Hw({styleOrigin:H(this.styleOrigin),symbolLayers:H(this.symbolLayers),thumbnail:H(this.thumbnail),callout:H(this.callout),verticalOffset:H(this.verticalOffset)})}static fromTextSymbol(t){return new Hw({symbolLayers:[vw.fromTextSymbol(t)]})}};e([oe({type:Ww,json:{write:!0}})],Zw.prototype,"verticalOffset",void 0),e([oe(Uw)],Zw.prototype,"callout",void 0),e([oe({json:{read:!1,write:!1}})],Zw.prototype,"styleOrigin",void 0),e([oe({type:Jw})],Zw.prototype,"symbolLayers",void 0),e([Md({LabelSymbol3D:"label-3d"},{readOnly:!0})],Zw.prototype,"type",void 0),Zw=Hw=e([si("esri.symbols.LabelSymbol3D")],Zw);const Qw=Zw;var Kw;const Yw=qo.ofType({base:null,key:"type",typeMap:{line:Xv,path:dw}}),Xw=qo.ofType({base:null,key:"type",typeMap:{line:Xv,path:dw}});let tb=Kw=class extends Pw{constructor(t){super(t),this.symbolLayers=new Yw,this.type="line-3d"}clone(){return new Kw({styleOrigin:H(this.styleOrigin),symbolLayers:H(this.symbolLayers),thumbnail:H(this.thumbnail)})}static fromSimpleLineSymbol(t){return new Kw({symbolLayers:[Xv.fromSimpleLineSymbol(t)]})}};e([oe({type:Yw,json:{type:Xw}})],tb.prototype,"symbolLayers",void 0),e([Md({LineSymbol3D:"line-3d"},{readOnly:!0})],tb.prototype,"type",void 0),tb=Kw=e([si("esri.symbols.LineSymbol3D")],tb);const eb=tb;let ib=class extends sm{constructor(t){super(t),this.angle=0,this.type=null,this.xoffset=0,this.yoffset=0,this.size=9}hash(){return`${this.type}.${this.angle}.${this.size}.${this.xoffset}.${this.yoffset}`}};e([oe({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],ib.prototype,"angle",void 0),e([oe({type:["simple-marker","picture-marker"],readOnly:!0})],ib.prototype,"type",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],ib.prototype,"xoffset",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],ib.prototype,"yoffset",void 0),e([oe({type:Number,cast:t=>"auto"===t?t:dm(t),json:{write:!0}})],ib.prototype,"size",void 0),ib=e([si("esri.symbols.MarkerSymbol")],ib);const sb=ib;var nb;const rb=qo.ofType({base:null,key:"type",typeMap:{fill:Jg}});let ob=nb=class extends Pw{constructor(t){super(t),this.symbolLayers=new rb,this.type="mesh-3d"}clone(){return new nb({styleOrigin:H(this.styleOrigin),symbolLayers:H(this.symbolLayers),thumbnail:H(this.thumbnail)})}};e([oe({type:rb})],ob.prototype,"symbolLayers",void 0),e([Md({MeshSymbol3D:"mesh-3d"},{readOnly:!0})],ob.prototype,"type",void 0),ob=nb=e([si("esri.symbols.MeshSymbol3D")],ob);const ab=ob;function lb(t,e){return function(t){return t&&("service"===t.origin||"portal-item"===t.origin)&&t.layer&&("feature"===t.layer.type||"stream"===t.layer.type)}(e)&&!on(t)&&e.layer.parsedUrl?nn(e.layer.parsedUrl.path,"images",t):Yg(t,e)}const ub={json:{read:{source:["imageData","url"],reader:function(t,e,i){return e.imageData?dn({mediaType:e.contentType||"image/png",isBase64:!0,data:e.imageData}):lb(e.url,i)}},write:{writer(t,e,i,s){!function(t,e,i,s){if(ln(t)){const n=hn(t);e.contentType=n.mediaType,e.imageData=n.data,i&&i.imageData===e.imageData&&i.url&&ev(i.url,e,"url",s)}else ev(t,e,"url",s)}(t,e,this.source,s)}}}},cb={readOnly:!0,json:{read:{source:["imageData","url"],reader(t,e,i){const s={};return e.imageData&&(s.imageData=e.imageData),e.contentType&&(s.contentType=e.contentType),e.url&&(s.url=lb(e.url,i)),s}}}};var hb;let db=hb=class extends Um{constructor(...t){super(...t),this.type="picture-fill",this.url=null,this.xscale=1,this.yscale=1,this.width=12,this.height=12,this.xoffset=0,this.yoffset=0,this.source=null}normalizeCtorArgs(t,e,i,s){if(t&&"string"!=typeof t&&null==t.imageData)return t;const n={};return t&&(n.url=t),e&&(n.outline=e),null!=i&&(n.width=dm(i)),null!=s&&(n.height=dm(s)),n}clone(){const t=new hb({color:H(this.color),height:this.height,outline:this.outline&&this.outline.clone(),url:this.url,width:this.width,xoffset:this.xoffset,xscale:this.xscale,yoffset:this.yoffset,yscale:this.yscale});return t._set("source",H(this.source)),t}hash(){var t;return`${super.hash()}.${null==(t=this.color)?void 0:t.hash()}.${this.height}.${this.url}.${this.width}.${this.xoffset}.${this.xscale}.${this.yoffset}.${this.yscale}`}};e([Md({esriPFS:"picture-fill"},{readOnly:!0})],db.prototype,"type",void 0),e([oe(ub)],db.prototype,"url",void 0),e([oe({type:Number,json:{write:!0}})],db.prototype,"xscale",void 0),e([oe({type:Number,json:{write:!0}})],db.prototype,"yscale",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],db.prototype,"width",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],db.prototype,"height",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],db.prototype,"xoffset",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],db.prototype,"yoffset",void 0),e([oe(cb)],db.prototype,"source",void 0),db=hb=e([si("esri.symbols.PictureFillSymbol")],db);const pb=db;var fb;let yb=fb=class extends sb{constructor(...t){super(...t),this.color=null,this.type="picture-marker",this.url=null,this.source=null,this.height=12,this.width=12,this.size=null}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t&&null==t.imageData)return t;const s={};return t&&(s.url=t),null!=e&&(s.width=dm(e)),null!=i&&(s.height=dm(i)),s}readHeight(t,e){return e.size||t}readWidth(t,e){return e.size||t}clone(){const t=new fb({angle:this.angle,height:this.height,url:this.url,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset});return t._set("source",H(this.source)),t}hash(){return`${super.hash()}.${this.height}.${this.url}.${this.width}`}};e([oe({json:{write:!1}})],yb.prototype,"color",void 0),e([Md({esriPMS:"picture-marker"},{readOnly:!0})],yb.prototype,"type",void 0),e([oe(ub)],yb.prototype,"url",void 0),e([oe(cb)],yb.prototype,"source",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],yb.prototype,"height",void 0),e([Sd("height",["height","size"])],yb.prototype,"readHeight",null),e([oe({type:Number,cast:dm,json:{write:!0}})],yb.prototype,"width",void 0),e([oe({json:{write:!1}})],yb.prototype,"size",void 0),yb=fb=e([si("esri.symbols.PictureMarkerSymbol")],yb);const mb=yb;var gb;const vb=qo.ofType({base:null,key:"type",typeMap:{icon:Iv,object:uw,text:vw}}),wb=qo.ofType({base:null,key:"type",typeMap:{icon:Iv,object:uw}});let bb=gb=class extends Pw{constructor(t){super(t),this.verticalOffset=null,this.callout=null,this.symbolLayers=new vb,this.type="point-3d"}writeSymbolLayers(t,e,i,s){const n=t.filter((t=>"text"!==t.type));if(s&&s.messages&&n.length<t.length){const e=t.find((t=>"text"===t.type));s.messages.push(new Ve("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PointSymbol3D",{symbolLayer:e}))}e[i]=n.map((t=>t.write({},s))).toArray()}supportsCallout(){if((this.symbolLayers?this.symbolLayers.length:0)<1)return!1;for(const t of this.symbolLayers.items)switch(t.type){case"icon":case"text":case"object":continue;default:return!1}return!0}hasVisibleCallout(){return Gw(this)}hasVisibleVerticalOffset(){return zw(this)}clone(){return new gb({verticalOffset:H(this.verticalOffset),callout:H(this.callout),styleOrigin:H(this.styleOrigin),symbolLayers:H(this.symbolLayers),thumbnail:H(this.thumbnail)})}static fromSimpleMarkerSymbol(t){return new gb({symbolLayers:[Iv.fromSimpleMarkerSymbol(t)]})}static fromPictureMarkerSymbol(t){return new gb({symbolLayers:[Iv.fromPictureMarkerSymbol(t)]})}static fromCIMSymbol(t){var e,i;return"CIMPointSymbol"!==(null==(e=t.data)||null==(i=e.symbol)?void 0:i.type)?null:new gb(t.data.symbol.callout?{symbolLayers:[Iv.fromCIMSymbol(t)],callout:{type:"line",size:.5,color:[0,0,0]},verticalOffset:{screenLength:40}}:{symbolLayers:[Iv.fromCIMSymbol(t)]})}static fromTextSymbol(t){return new gb({symbolLayers:[vw.fromTextSymbol(t)]})}};e([oe({type:Ww,json:{write:!0}})],bb.prototype,"verticalOffset",void 0),e([oe(Uw)],bb.prototype,"callout",void 0),e([oe({type:vb,json:{type:wb,origins:{"web-scene":{type:wb}}}})],bb.prototype,"symbolLayers",void 0),e([xd("web-scene","symbolLayers")],bb.prototype,"writeSymbolLayers",null),e([Md({PointSymbol3D:"point-3d"},{readOnly:!0})],bb.prototype,"type",void 0),bb=gb=e([si("esri.symbols.PointSymbol3D")],bb);const Mb=bb;var Sb;const xb=qo.ofType({base:null,key:"type",typeMap:{extrude:Cm,fill:Jg,icon:Iv,line:Xv,object:uw,text:vw,water:Sw}}),kb=qo.ofType({base:null,key:"type",typeMap:{extrude:Cm,fill:Jg,icon:Iv,line:Xv,object:uw,water:Sw}});let Ib=Sb=class extends Pw{constructor(t){super(t),this.symbolLayers=new xb,this.type="polygon-3d"}writeSymbolLayers(t,e,i,s){const n=t.filter((t=>"text"!==t.type));if(s&&s.messages&&n.length<t.length){const e=t.find((t=>"text"===t.type));s.messages.push(new Ve("symbol-layer:unsupported","Symbol layers of type 'text' cannot be persisted in PolygonSymbol3D",{symbolLayer:e}))}e[i]=n.map((t=>t.write({},s))).toArray()}clone(){return new Sb({styleOrigin:H(this.styleOrigin),symbolLayers:H(this.symbolLayers),thumbnail:H(this.thumbnail)})}static fromJSON(t){const e=new Sb;if(e.read(t),2===e.symbolLayers.length&&"fill"===e.symbolLayers.getItemAt(0).type&&"line"===e.symbolLayers.getItemAt(1).type){const i=e.symbolLayers.getItemAt(0),s=e.symbolLayers.getItemAt(1);!s.enabled||t.symbolLayers&&t.symbolLayers[1]&&!1===t.symbolLayers[1].enable||(i.outline={size:s.size,color:u(s.material)?s.material.color:null}),e.symbolLayers.removeAt(1)}return e}static fromSimpleFillSymbol(t){return new Sb({symbolLayers:[Jg.fromSimpleFillSymbol(t)]})}};e([oe({type:xb,json:{type:kb}})],Ib.prototype,"symbolLayers",void 0),e([xd("web-scene","symbolLayers")],Ib.prototype,"writeSymbolLayers",null),e([Md({PolygonSymbol3D:"polygon-3d"},{readOnly:!0})],Ib.prototype,"type",void 0),Ib=Sb=e([si("esri.symbols.PolygonSymbol3D")],Ib);const jb=Ib;var _b;const Tb=new ri({esriSFSSolid:"solid",esriSFSNull:"none",esriSFSHorizontal:"horizontal",esriSFSVertical:"vertical",esriSFSForwardDiagonal:"forward-diagonal",esriSFSBackwardDiagonal:"backward-diagonal",esriSFSCross:"cross",esriSFSDiagonalCross:"diagonal-cross"});let Ob=_b=class extends Um{constructor(...t){super(...t),this.color=new bd([0,0,0,.25]),this.outline=new zm,this.type="simple-fill",this.style="solid"}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t)return t;const s={};return t&&(s.style=t),e&&(s.outline=e),i&&(s.color=i),s}clone(){return new _b({color:H(this.color),outline:this.outline&&this.outline.clone(),style:this.style})}hash(){return`${super.hash()}${this.style}.${this.color&&this.color.hash()}`}};e([oe()],Ob.prototype,"color",void 0),e([oe()],Ob.prototype,"outline",void 0),e([Md({esriSFS:"simple-fill"},{readOnly:!0})],Ob.prototype,"type",void 0),e([oe({type:Tb.apiValues,json:{read:Tb.read,write:Tb.write}})],Ob.prototype,"style",void 0),Ob=_b=e([si("esri.symbols.SimpleFillSymbol")],Ob);const Ab=Ob;var Fb;const Cb=new ri({esriSMSCircle:"circle",esriSMSSquare:"square",esriSMSCross:"cross",esriSMSX:"x",esriSMSDiamond:"diamond",esriSMSTriangle:"triangle",esriSMSPath:"path"});let Pb=Fb=class extends sb{constructor(...t){super(...t),this.color=new bd([255,255,255,.25]),this.type="simple-marker",this.size=12,this.style="circle",this.outline=new zm}normalizeCtorArgs(t,e,i,s){if(t&&"string"!=typeof t)return t;const n={};return t&&(n.style=t),null!=e&&(n.size=dm(e)),i&&(n.outline=i),s&&(n.color=s),n}writeColor(t,e){t&&"x"!==this.style&&"cross"!==this.style&&(e.color=t.toJSON()),null===t&&(e.color=null)}set path(t){this.style="path",this._set("path",t)}clone(){return new Fb({angle:this.angle,color:H(this.color),outline:this.outline&&this.outline.clone(),path:this.path,size:this.size,style:this.style,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){var t;return`${super.hash()}.${this.color&&this.color.hash()}.${this.path}.${this.style}.${null==(t=this.outline)?void 0:t.hash()}`}};e([oe()],Pb.prototype,"color",void 0),e([xd("color")],Pb.prototype,"writeColor",null),e([Md({esriSMS:"simple-marker"},{readOnly:!0})],Pb.prototype,"type",void 0),e([oe()],Pb.prototype,"size",void 0),e([oe({type:Cb.apiValues,json:{read:Cb.read,write:Cb.write}})],Pb.prototype,"style",void 0),e([oe({type:String,json:{write:!0}})],Pb.prototype,"path",null),e([oe({types:{key:"type",base:null,defaultKeyValue:"simple-line",typeMap:{"simple-line":zm}},json:{default:null,write:!0}})],Pb.prototype,"outline",void 0),Pb=Fb=e([si("esri.symbols.SimpleMarkerSymbol")],Pb);const Eb=Pb;var Rb;let Lb=Rb=class extends sm{constructor(...t){super(...t),this.backgroundColor=null,this.borderLineColor=null,this.borderLineSize=null,this.font=new Kg,this.horizontalAlignment="center",this.kerning=!0,this.haloColor=null,this.haloSize=null,this.rightToLeft=null,this.rotated=!1,this.text="",this.type="text",this.verticalAlignment=null,this.xoffset=0,this.yoffset=0,this.angle=0,this.width=null,this.lineWidth=192,this.lineHeight=1}normalizeCtorArgs(t,e,i){if(t&&"string"!=typeof t)return t;const s={};return t&&(s.text=t),e&&(s.font=e),i&&(s.color=i),s}writeLineWidth(t,e,i,s){s&&"string"!=typeof s||(e[i]=t)}castLineWidth(t){return dm(t)}writeLineHeight(t,e,i,s){s&&"string"!=typeof s||(e[i]=t)}clone(){return new Rb({angle:this.angle,backgroundColor:H(this.backgroundColor),borderLineColor:H(this.borderLineColor),borderLineSize:this.borderLineSize,color:H(this.color),font:this.font&&this.font.clone(),haloColor:H(this.haloColor),haloSize:this.haloSize,horizontalAlignment:this.horizontalAlignment,kerning:this.kerning,lineHeight:this.lineHeight,lineWidth:this.lineWidth,rightToLeft:this.rightToLeft,rotated:this.rotated,text:this.text,verticalAlignment:this.verticalAlignment,width:this.width,xoffset:this.xoffset,yoffset:this.yoffset})}hash(){return`${this.backgroundColor&&this.backgroundColor.hash()}.${this.borderLineColor}.${this.borderLineSize}.${this.color.hash()}.${this.font&&this.font.hash()}.${this.haloColor&&this.haloColor.hash()}.${this.haloSize}.${this.horizontalAlignment}.${this.kerning}.${this.rightToLeft}.${this.rotated}.${this.text}.${this.verticalAlignment}.${this.width}.${this.xoffset}.${this.yoffset}.${this.lineHeight}.${this.lineWidth}.${this.angle}`}};e([oe({type:bd,json:{write:!0}})],Lb.prototype,"backgroundColor",void 0),e([oe({type:bd,json:{write:!0}})],Lb.prototype,"borderLineColor",void 0),e([oe({type:Number,json:{write:!0}})],Lb.prototype,"borderLineSize",void 0),e([oe({type:Kg,json:{write:!0}})],Lb.prototype,"font",void 0),e([oe({type:["left","right","center","justify"],json:{write:!0}})],Lb.prototype,"horizontalAlignment",void 0),e([oe({type:Boolean,json:{write:!0}})],Lb.prototype,"kerning",void 0),e([oe({type:bd,json:{write:!0}})],Lb.prototype,"haloColor",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],Lb.prototype,"haloSize",void 0),e([oe({type:Boolean,json:{write:!0}})],Lb.prototype,"rightToLeft",void 0),e([oe({type:Boolean,json:{write:!0}})],Lb.prototype,"rotated",void 0),e([oe({type:String,json:{write:!0}})],Lb.prototype,"text",void 0),e([Md({esriTS:"text"},{readOnly:!0})],Lb.prototype,"type",void 0),e([oe({type:["baseline","top","middle","bottom"],json:{write:!0}})],Lb.prototype,"verticalAlignment",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],Lb.prototype,"xoffset",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],Lb.prototype,"yoffset",void 0),e([oe({type:Number,json:{read:t=>t&&-1*t,write:(t,e)=>e.angle=t&&-1*t}})],Lb.prototype,"angle",void 0),e([oe({type:Number,json:{write:!0}})],Lb.prototype,"width",void 0),e([oe({type:Number})],Lb.prototype,"lineWidth",void 0),e([xd("lineWidth")],Lb.prototype,"writeLineWidth",null),e([ba("lineWidth")],Lb.prototype,"castLineWidth",null),e([oe({type:Number})],Lb.prototype,"lineHeight",void 0),e([xd("lineHeight")],Lb.prototype,"writeLineHeight",null),Lb=Rb=e([si("esri.symbols.TextSymbol")],Lb);const Nb=Lb;var Db;const Vb=ct.getLogger("esri.symbols.WebStyleSymbol");let $b=Db=class extends sm{constructor(t){super(t),this.styleName=null,this.portal=null,this.styleUrl=null,this.thumbnail=null,this.name=null,this.type="web-style"}read(t,e){this.portal=e?e.portal:void 0,super.read(t,e)}clone(){return new Db({name:this.name,styleUrl:this.styleUrl,styleName:this.styleName,portal:this.portal})}fetchSymbol(t){return this._fetchSymbol("webRef",t)}fetchCIMSymbol(t){return this._fetchSymbol("cimRef",t)}async _fetchSymbol(t,e){const i=await import("./p-6ceabf3b.js");Ji(e);const s=i.resolveWebStyleSymbol(this,{portal:this.portal},t,e);return s.catch((t=>{Vb.error("#fetchSymbol()","Failed to create symbol from style",t)})),s}};e([oe({json:{write:!1}})],$b.prototype,"color",void 0),e([oe({type:String,json:{write:!0}})],$b.prototype,"styleName",void 0),e([oe({type:Qv,json:{write:!1}})],$b.prototype,"portal",void 0),e([oe({type:String,json:{read:tv,write:ev}})],$b.prototype,"styleUrl",void 0),e([oe({type:Tw,json:{read:!1}})],$b.prototype,"thumbnail",void 0),e([oe({type:String,json:{write:!0}})],$b.prototype,"name",void 0),e([Md({styleSymbolReference:"web-style"},{readOnly:!0})],$b.prototype,"type",void 0),$b=Db=e([si("esri.symbols.WebStyleSymbol")],$b);const zb=$b;function Gb(t){if(!t)return!1;switch(t.type){case"picture-fill":case"picture-marker":case"simple-fill":case"simple-line":case"simple-marker":case"text":case"cim":return!0;default:return!1}}function Ub(t){if(!t)return!1;switch(t.type){case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":return!0;default:return!1}}const qb={base:sm,key:"type",typeMap:{"simple-fill":Ab,"picture-fill":pb,"picture-marker":mb,"simple-line":zm,"simple-marker":Eb,text:Nb,"label-3d":Qw,"line-3d":eb,"mesh-3d":ab,"point-3d":Mb,"polygon-3d":jb,"web-style":zb,cim:om},errorContext:"symbol"},Bb={base:sm,key:"type",typeMap:{"picture-marker":mb,"simple-marker":Eb,text:Nb,"web-style":zb,cim:om},errorContext:"symbol"},Wb=Oe({types:qb}),Hb={base:sm,key:"type",typeMap:{"simple-fill":Ab,"picture-fill":pb,"picture-marker":mb,"simple-line":zm,"simple-marker":Eb,text:Nb,"line-3d":eb,"mesh-3d":ab,"point-3d":Mb,"polygon-3d":jb,"web-style":zb,cim:om},errorContext:"symbol"},Jb={base:sm,key:"type",typeMap:{text:Nb,"label-3d":Qw},errorContext:"symbol"},Zb={base:sm,key:"type",typeMap:{"line-3d":eb,"mesh-3d":ab,"point-3d":Mb,"polygon-3d":jb,"web-style":zb,cim:om},errorContext:"symbol"},Qb={base:sm,key:"type",typeMap:{"label-3d":Qw},errorContext:"symbol"},Kb=Et(qb);function Yb(){const t=new Float32Array(16);return t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}const Xb=Yb();function tM(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function eM(t,e,i,s,n,r,o,a,l,u,c,h,d,p,f,y,m){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t[4]=r,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=d,t[12]=p,t[13]=f,t[14]=y,t[15]=m,t}function iM(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function sM(t,e){if(t===e){const i=e[1],s=e[2],n=e[3],r=e[6],o=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=i,t[6]=e[9],t[7]=e[13],t[8]=s,t[9]=r,t[11]=e[14],t[12]=n,t[13]=o,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function nM(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],y=e[13],m=e[14],g=e[15],v=i*a-s*o,w=i*l-n*o,b=i*u-r*o,M=s*l-n*a,S=s*u-r*a,x=n*u-r*l,k=c*y-h*f,I=c*m-d*f,j=c*g-p*f,_=h*m-d*y,T=h*g-p*y,O=d*g-p*m;let A=v*O-w*T+b*_+M*j-S*I+x*k;return A?(A=1/A,t[0]=(a*O-l*T+u*_)*A,t[1]=(n*T-s*O-r*_)*A,t[2]=(y*x-m*S+g*M)*A,t[3]=(d*S-h*x-p*M)*A,t[4]=(l*j-o*O-u*I)*A,t[5]=(i*O-n*j+r*I)*A,t[6]=(m*b-f*x-g*w)*A,t[7]=(c*x-d*b+p*w)*A,t[8]=(o*T-a*j+u*k)*A,t[9]=(s*j-i*T-r*k)*A,t[10]=(f*S-y*b+g*v)*A,t[11]=(h*b-c*S-p*v)*A,t[12]=(a*I-o*_-l*k)*A,t[13]=(i*_-s*I+n*k)*A,t[14]=(y*w-f*M-m*v)*A,t[15]=(c*M-h*w+d*v)*A,t):null}function rM(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],f=e[11],y=e[12],m=e[13],g=e[14],v=e[15];let w=i[0],b=i[1],M=i[2],S=i[3];return t[0]=w*s+b*a+M*h+S*y,t[1]=w*n+b*l+M*d+S*m,t[2]=w*r+b*u+M*p+S*g,t[3]=w*o+b*c+M*f+S*v,w=i[4],b=i[5],M=i[6],S=i[7],t[4]=w*s+b*a+M*h+S*y,t[5]=w*n+b*l+M*d+S*m,t[6]=w*r+b*u+M*p+S*g,t[7]=w*o+b*c+M*f+S*v,w=i[8],b=i[9],M=i[10],S=i[11],t[8]=w*s+b*a+M*h+S*y,t[9]=w*n+b*l+M*d+S*m,t[10]=w*r+b*u+M*p+S*g,t[11]=w*o+b*c+M*f+S*v,w=i[12],b=i[13],M=i[14],S=i[15],t[12]=w*s+b*a+M*h+S*y,t[13]=w*n+b*l+M*d+S*m,t[14]=w*r+b*u+M*p+S*g,t[15]=w*o+b*c+M*f+S*v,t}function oM(t,e,i){const s=i[0],n=i[1],r=i[2];let o,a,l,u,c,h,d,p,f,y,m,g;return e===t?(t[12]=e[0]*s+e[4]*n+e[8]*r+e[12],t[13]=e[1]*s+e[5]*n+e[9]*r+e[13],t[14]=e[2]*s+e[6]*n+e[10]*r+e[14],t[15]=e[3]*s+e[7]*n+e[11]*r+e[15]):(o=e[0],a=e[1],l=e[2],u=e[3],c=e[4],h=e[5],d=e[6],p=e[7],f=e[8],y=e[9],m=e[10],g=e[11],t[0]=o,t[1]=a,t[2]=l,t[3]=u,t[4]=c,t[5]=h,t[6]=d,t[7]=p,t[8]=f,t[9]=y,t[10]=m,t[11]=g,t[12]=o*s+c*n+f*r+e[12],t[13]=a*s+h*n+y*r+e[13],t[14]=l*s+d*n+m*r+e[14],t[15]=u*s+p*n+g*r+e[15]),t}function aM(t,e,i){const s=i[0],n=i[1],r=i[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function lM(t,e,i,s){let n,r,o,a,l,u,c,h,d,p,f,y,m,g,v,w,b,M,S,x,k,I,j,_,T=s[0],O=s[1],A=s[2],F=Math.sqrt(T*T+O*O+A*A);return F<ph?null:(F=1/F,T*=F,O*=F,A*=F,n=Math.sin(i),r=Math.cos(i),o=1-r,a=e[0],l=e[1],u=e[2],c=e[3],h=e[4],d=e[5],p=e[6],f=e[7],y=e[8],m=e[9],g=e[10],v=e[11],w=T*T*o+r,b=O*T*o+A*n,M=A*T*o-O*n,S=T*O*o-A*n,x=O*O*o+r,k=A*O*o+T*n,I=T*A*o+O*n,j=O*A*o-T*n,_=A*A*o+r,t[0]=a*w+h*b+y*M,t[1]=l*w+d*b+m*M,t[2]=u*w+p*b+g*M,t[3]=c*w+f*b+v*M,t[4]=a*S+h*x+y*k,t[5]=l*S+d*x+m*k,t[6]=u*S+p*x+g*k,t[7]=c*S+f*x+v*k,t[8]=a*I+h*j+y*_,t[9]=l*I+d*j+m*_,t[10]=u*I+p*j+g*_,t[11]=c*I+f*j+v*_,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function uM(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=i,t[7]=0,t[8]=0,t[9]=-i,t[10]=s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function cM(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=s+s,l=n+n,u=r+r,c=s*a,h=s*l,d=s*u,p=n*l,f=n*u,y=r*u,m=o*a,g=o*l,v=o*u;return t[0]=1-(p+y),t[1]=h+v,t[2]=d-g,t[3]=0,t[4]=h-v,t[5]=1-(c+y),t[6]=f+m,t[7]=0,t[8]=d+g,t[9]=f-m,t[10]=1-(c+p),t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t}Object.freeze({__proto__:null,create:Yb,clone:function(t){const e=new Float32Array(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},fromValues:function(t,e,i,s,n,r,o,a,l,u,c,h,d,p,f,y){const m=new Float32Array(16);return m[0]=t,m[1]=e,m[2]=i,m[3]=s,m[4]=n,m[5]=r,m[6]=o,m[7]=a,m[8]=l,m[9]=u,m[10]=c,m[11]=h,m[12]=d,m[13]=p,m[14]=f,m[15]=y,m},createView:function(t,e){return new Float32Array(t,e,16)},IDENTITY:Xb});const hM=[0,0,0];function dM(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t[9]=e[9]-i[9],t[10]=e[10]-i[10],t[11]=e[11]-i[11],t[12]=e[12]-i[12],t[13]=e[13]-i[13],t[14]=e[14]-i[14],t[15]=e[15]-i[15],t}function pM(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function fM(t,e){if(t===e)return!0;const i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=t[9],d=t[10],p=t[11],f=t[12],y=t[13],m=t[14],g=t[15],v=e[0],w=e[1],b=e[2],M=e[3],S=e[4],x=e[5],k=e[6],I=e[7],j=e[8],_=e[9],T=e[10],O=e[11],A=e[12],F=e[13],C=e[14],P=e[15];return Math.abs(i-v)<=ph*Math.max(1,Math.abs(i),Math.abs(v))&&Math.abs(s-w)<=ph*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(n-b)<=ph*Math.max(1,Math.abs(n),Math.abs(b))&&Math.abs(r-M)<=ph*Math.max(1,Math.abs(r),Math.abs(M))&&Math.abs(o-S)<=ph*Math.max(1,Math.abs(o),Math.abs(S))&&Math.abs(a-x)<=ph*Math.max(1,Math.abs(a),Math.abs(x))&&Math.abs(l-k)<=ph*Math.max(1,Math.abs(l),Math.abs(k))&&Math.abs(u-I)<=ph*Math.max(1,Math.abs(u),Math.abs(I))&&Math.abs(c-j)<=ph*Math.max(1,Math.abs(c),Math.abs(j))&&Math.abs(h-_)<=ph*Math.max(1,Math.abs(h),Math.abs(_))&&Math.abs(d-T)<=ph*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(p-O)<=ph*Math.max(1,Math.abs(p),Math.abs(O))&&Math.abs(f-A)<=ph*Math.max(1,Math.abs(f),Math.abs(A))&&Math.abs(y-F)<=ph*Math.max(1,Math.abs(y),Math.abs(F))&&Math.abs(m-C)<=ph*Math.max(1,Math.abs(m),Math.abs(C))&&Math.abs(g-P)<=ph*Math.max(1,Math.abs(g),Math.abs(P))}function yM(t){const e=ph,i=t[0],s=t[1],n=t[2],r=t[4],o=t[5],a=t[6],l=t[8],u=t[9],c=t[10];return Math.abs(1-(i*i+r*r+l*l))<=e&&Math.abs(1-(s*s+o*o+u*u))<=e&&Math.abs(1-(n*n+a*a+c*c))<=e}Object.freeze({__proto__:null,copy:tM,set:eM,identity:iM,transpose:sM,invert:nM,adjoint:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],y=e[13],m=e[14],g=e[15];return t[0]=a*(d*g-p*m)-h*(l*g-u*m)+y*(l*p-u*d),t[1]=-(s*(d*g-p*m)-h*(n*g-r*m)+y*(n*p-r*d)),t[2]=s*(l*g-u*m)-a*(n*g-r*m)+y*(n*u-r*l),t[3]=-(s*(l*p-u*d)-a*(n*p-r*d)+h*(n*u-r*l)),t[4]=-(o*(d*g-p*m)-c*(l*g-u*m)+f*(l*p-u*d)),t[5]=i*(d*g-p*m)-c*(n*g-r*m)+f*(n*p-r*d),t[6]=-(i*(l*g-u*m)-o*(n*g-r*m)+f*(n*u-r*l)),t[7]=i*(l*p-u*d)-o*(n*p-r*d)+c*(n*u-r*l),t[8]=o*(h*g-p*y)-c*(a*g-u*y)+f*(a*p-u*h),t[9]=-(i*(h*g-p*y)-c*(s*g-r*y)+f*(s*p-r*h)),t[10]=i*(a*g-u*y)-o*(s*g-r*y)+f*(s*u-r*a),t[11]=-(i*(a*p-u*h)-o*(s*p-r*h)+c*(s*u-r*a)),t[12]=-(o*(h*m-d*y)-c*(a*m-l*y)+f*(a*d-l*h)),t[13]=i*(h*m-d*y)-c*(s*m-n*y)+f*(s*d-n*h),t[14]=-(i*(a*m-l*y)-o*(s*m-n*y)+f*(s*l-n*a)),t[15]=i*(a*d-l*h)-o*(s*d-n*h)+c*(s*l-n*a),t},determinant:function(t){const e=t[0],i=t[1],s=t[2],n=t[3],r=t[4],o=t[5],a=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],p=t[12],f=t[13],y=t[14],m=t[15];return(e*o-i*r)*(h*m-d*y)-(e*a-s*r)*(c*m-d*f)+(e*l-n*r)*(c*y-h*f)+(i*a-s*o)*(u*m-d*p)-(i*l-n*o)*(u*y-h*p)+(s*l-n*a)*(u*f-c*p)},multiply:rM,translate:oM,scale:aM,rotate:lM,rotateX:function(t,e,i){const s=Math.sin(i),n=Math.cos(i),r=e[4],o=e[5],a=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=r*n+u*s,t[5]=o*n+c*s,t[6]=a*n+h*s,t[7]=l*n+d*s,t[8]=u*n-r*s,t[9]=c*n-o*s,t[10]=h*n-a*s,t[11]=d*n-l*s,t},rotateY:function(t,e,i){const s=Math.sin(i),n=Math.cos(i),r=e[0],o=e[1],a=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*n-u*s,t[1]=o*n-c*s,t[2]=a*n-h*s,t[3]=l*n-d*s,t[8]=r*s+u*n,t[9]=o*s+c*n,t[10]=a*s+h*n,t[11]=l*s+d*n,t},rotateZ:function(t,e,i){const s=Math.sin(i),n=Math.cos(i),r=e[0],o=e[1],a=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=r*n+u*s,t[1]=o*n+c*s,t[2]=a*n+h*s,t[3]=l*n+d*s,t[4]=u*n-r*s,t[5]=c*n-o*s,t[6]=h*n-a*s,t[7]=d*n-l*s,t},fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},fromScaling:function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotation:function(t,e,i){let s,n,r,o=i[0],a=i[1],l=i[2],u=Math.sqrt(o*o+a*a+l*l);return u<ph?null:(u=1/u,o*=u,a*=u,l*=u,s=Math.sin(e),n=Math.cos(e),r=1-n,t[0]=o*o*r+n,t[1]=a*o*r+l*s,t[2]=l*o*r-a*s,t[3]=0,t[4]=o*a*r-l*s,t[5]=a*a*r+n,t[6]=l*a*r+o*s,t[7]=0,t[8]=o*l*r+a*s,t[9]=a*l*r-o*s,t[10]=l*l*r+n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},fromXRotation:uM,fromYRotation:function(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=0,t[2]=-i,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=i,t[9]=0,t[10]=s,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromZRotation:function(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=0,t[3]=0,t[4]=-i,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},fromRotationTranslation:cM,fromQuat2:function(t,e){const i=hM,s=-e[0],n=-e[1],r=-e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=s*s+n*n+r*r+o*o;return h>0?(i[0]=2*(a*o+c*s+l*r-u*n)/h,i[1]=2*(l*o+c*n+u*s-a*r)/h,i[2]=2*(u*o+c*r+a*n-l*s)/h):(i[0]=2*(a*o+c*s+l*r-u*n),i[1]=2*(l*o+c*n+u*s-a*r),i[2]=2*(u*o+c*r+a*n-l*s)),cM(t,e,i),t},getTranslation:function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},getScaling:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.sqrt(i*i+s*s+n*n),t[1]=Math.sqrt(r*r+o*o+a*a),t[2]=Math.sqrt(l*l+u*u+c*c),t},getRotation:function(t,e){const i=e[0]+e[5]+e[10];let s=0;return i>0?(s=2*Math.sqrt(i+1),t[3]=.25*s,t[0]=(e[6]-e[9])/s,t[1]=(e[8]-e[2])/s,t[2]=(e[1]-e[4])/s):e[0]>e[5]&&e[0]>e[10]?(s=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/s,t[0]=.25*s,t[1]=(e[1]+e[4])/s,t[2]=(e[8]+e[2])/s):e[5]>e[10]?(s=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/s,t[0]=(e[1]+e[4])/s,t[1]=.25*s,t[2]=(e[6]+e[9])/s):(s=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/s,t[0]=(e[8]+e[2])/s,t[1]=(e[6]+e[9])/s,t[2]=.25*s),t},fromRotationTranslationScale:function(t,e,i,s){const n=e[0],r=e[1],o=e[2],a=e[3],l=n+n,u=r+r,c=o+o,h=n*l,d=n*u,p=n*c,f=r*u,y=r*c,m=o*c,g=a*l,v=a*u,w=a*c,b=s[0],M=s[1],S=s[2];return t[0]=(1-(f+m))*b,t[1]=(d+w)*b,t[2]=(p-v)*b,t[3]=0,t[4]=(d-w)*M,t[5]=(1-(h+m))*M,t[6]=(y+g)*M,t[7]=0,t[8]=(p+v)*S,t[9]=(y-g)*S,t[10]=(1-(h+f))*S,t[11]=0,t[12]=i[0],t[13]=i[1],t[14]=i[2],t[15]=1,t},fromRotationTranslationScaleOrigin:function(t,e,i,s,n){const r=e[0],o=e[1],a=e[2],l=e[3],u=r+r,c=o+o,h=a+a,d=r*u,p=r*c,f=r*h,y=o*c,m=o*h,g=a*h,v=l*u,w=l*c,b=l*h,M=s[0],S=s[1],x=s[2],k=n[0],I=n[1],j=n[2],_=(1-(y+g))*M,T=(p+b)*M,O=(f-w)*M,A=(p-b)*S,F=(1-(d+g))*S,C=(m+v)*S,P=(f+w)*x,E=(m-v)*x,R=(1-(d+y))*x;return t[0]=_,t[1]=T,t[2]=O,t[3]=0,t[4]=A,t[5]=F,t[6]=C,t[7]=0,t[8]=P,t[9]=E,t[10]=R,t[11]=0,t[12]=i[0]+k-(_*k+A*I+P*j),t[13]=i[1]+I-(T*k+F*I+E*j),t[14]=i[2]+j-(O*k+C*I+R*j),t[15]=1,t},fromQuat:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=i+i,a=s+s,l=n+n,u=i*o,c=s*o,h=s*a,d=n*o,p=n*a,f=n*l,y=r*o,m=r*a,g=r*l;return t[0]=1-h-f,t[1]=c+g,t[2]=d-m,t[3]=0,t[4]=c-g,t[5]=1-u-f,t[6]=p+y,t[7]=0,t[8]=d+m,t[9]=p-y,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},frustum:function(t,e,i,s,n,r,o){const a=1/(i-e),l=1/(n-s),u=1/(r-o);return t[0]=2*r*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*r*l,t[6]=0,t[7]=0,t[8]=(i+e)*a,t[9]=(n+s)*l,t[10]=(o+r)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=o*r*2*u,t[15]=0,t},perspective:function(t,e,i,s,n){const r=1/Math.tan(e/2);let o;return t[0]=r/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=n&&n!==1/0?(o=1/(s-n),t[10]=(n+s)*o,t[14]=2*n*s*o):(t[10]=-1,t[14]=-2*s),t},perspectiveFromFieldOfView:function(t,e,i,s){const n=Math.tan(e.upDegrees*Math.PI/180),r=Math.tan(e.downDegrees*Math.PI/180),o=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),l=2/(o+a),u=2/(n+r);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(o-a)*l*.5,t[9]=(n-r)*u*.5,t[10]=s/(i-s),t[11]=-1,t[12]=0,t[13]=0,t[14]=s*i/(i-s),t[15]=0,t},ortho:function(t,e,i,s,n,r,o){const a=1/(e-i),l=1/(s-n),u=1/(r-o);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+i)*a,t[13]=(n+s)*l,t[14]=(o+r)*u,t[15]=1,t},lookAt:function(t,e,i,s){let n,r,o,a,l,u,c,h,d,p;const f=e[0],y=e[1],m=e[2],g=s[0],v=s[1],w=s[2],b=i[0],M=i[1],S=i[2];return Math.abs(f-b)<ph&&Math.abs(y-M)<ph&&Math.abs(m-S)<ph?iM(t):(c=f-b,h=y-M,d=m-S,p=1/Math.sqrt(c*c+h*h+d*d),c*=p,h*=p,d*=p,n=v*d-w*h,r=w*c-g*d,o=g*h-v*c,p=Math.sqrt(n*n+r*r+o*o),p?(p=1/p,n*=p,r*=p,o*=p):(n=0,r=0,o=0),a=h*o-d*r,l=d*n-c*o,u=c*r-h*n,p=Math.sqrt(a*a+l*l+u*u),p?(p=1/p,a*=p,l*=p,u*=p):(a=0,l=0,u=0),t[0]=n,t[1]=a,t[2]=c,t[3]=0,t[4]=r,t[5]=l,t[6]=h,t[7]=0,t[8]=o,t[9]=u,t[10]=d,t[11]=0,t[12]=-(n*f+r*y+o*m),t[13]=-(a*f+l*y+u*m),t[14]=-(c*f+h*y+d*m),t[15]=1,t)},targetTo:function(t,e,i,s){const n=e[0],r=e[1],o=e[2],a=s[0],l=s[1],u=s[2];let c=n-i[0],h=r-i[1],d=o-i[2],p=c*c+h*h+d*d;p>0&&(p=1/Math.sqrt(p),c*=p,h*=p,d*=p);let f=l*d-u*h,y=u*c-a*d,m=a*h-l*c;return p=f*f+y*y+m*m,p>0&&(p=1/Math.sqrt(p),f*=p,y*=p,m*=p),t[0]=f,t[1]=y,t[2]=m,t[3]=0,t[4]=h*m-d*y,t[5]=d*f-c*m,t[6]=c*y-h*f,t[7]=0,t[8]=c,t[9]=h,t[10]=d,t[11]=0,t[12]=n,t[13]=r,t[14]=o,t[15]=1,t},str:function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},frob:function(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2+t[9]**2+t[10]**2+t[11]**2+t[12]**2+t[13]**2+t[14]**2+t[15]**2)},add:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t[9]=e[9]+i[9],t[10]=e[10]+i[10],t[11]=e[11]+i[11],t[12]=e[12]+i[12],t[13]=e[13]+i[13],t[14]=e[14]+i[14],t[15]=e[15]+i[15],t},subtract:dM,multiplyScalar:function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t[9]=e[9]*i,t[10]=e[10]*i,t[11]=e[11]*i,t[12]=e[12]*i,t[13]=e[13]*i,t[14]=e[14]*i,t[15]=e[15]*i,t},multiplyScalarAndAdd:function(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t[3]=e[3]+i[3]*s,t[4]=e[4]+i[4]*s,t[5]=e[5]+i[5]*s,t[6]=e[6]+i[6]*s,t[7]=e[7]+i[7]*s,t[8]=e[8]+i[8]*s,t[9]=e[9]+i[9]*s,t[10]=e[10]+i[10]*s,t[11]=e[11]+i[11]*s,t[12]=e[12]+i[12]*s,t[13]=e[13]+i[13]*s,t[14]=e[14]+i[14]*s,t[15]=e[15]+i[15]*s,t},exactEquals:pM,equals:fM,isOrthoNormal:yM,mul:rM,sub:dM});class mM{constructor(t,e,i){this.strength=t,this.radius=e,this.threshold=i,this.type="bloom"}interpolate(t,e,i){this.strength=SM(t.strength,e.strength,i),this.radius=SM(t.radius,e.radius,i),this.threshold=SM(t.threshold,e.threshold,i)}clone(){return new mM(this.strength,this.radius,this.threshold)}toJSON(){return{type:"bloom",radius:xM(this.radius),strength:this.strength,threshold:this.threshold}}}class gM{constructor(t){this.radius=t,this.type="blur"}interpolate(t,e,i){this.radius=Math.round(SM(t.radius,e.radius,i))}clone(){return new gM(this.radius)}toJSON(){return{type:"blur",radius:xM(this.radius)}}}class vM{constructor(t,e){this.type=t,this.amount=e,"invert"!==this.type&&"grayscale"!==this.type&&"sepia"!==this.type||(this.amount=Math.min(this.amount,1))}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,e,i){this.amount=SM(t.amount,e.amount,i),this._updateMatrix()}clone(){return new vM(this.type,this.amount)}toJSON(){return{type:this.type,amount:this.amount}}_updateMatrix(){const t=this._colorMatrix||Yb();switch(this.type){case"brightness":this._colorMatrix=((t,e)=>{const i=eM(t,e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1);return sM(i,i)})(t,this.amount);break;case"contrast":this._colorMatrix=((t,e)=>{const i=eM(t,e,0,0,.5-.5*e,0,e,0,.5-.5*e,0,0,e,.5-.5*e,0,0,0,1);return sM(i,i)})(t,this.amount);break;case"grayscale":this._colorMatrix=(t=>{const e=1-this.amount,i=eM(t,.2126+.7874*e,.7152-.7152*e,.0722-.0722*e,0,.2126-.2126*e,.7152+.2848*e,.0722-.0722*e,0,.2126-.2126*e,.7152-.7152*e,.0722+.9278*e,0,0,0,0,1);return sM(i,i)})(t);break;case"invert":this._colorMatrix=((t,e)=>{const i=1-2*e,s=eM(t,i,0,0,e,0,i,0,e,0,0,i,e,0,0,0,1);return sM(s,s)})(t,this.amount);break;case"saturate":this._colorMatrix=((t,e)=>{const i=eM(t,.213+.787*e,.715-.715*e,.072-.072*e,0,.213-.213*e,.715+.285*e,.072-.072*e,0,.213-.213*e,.715-.715*e,.072+.928*e,0,0,0,0,1);return sM(i,i)})(t,this.amount);break;case"sepia":this._colorMatrix=(t=>{const e=1-this.amount,i=eM(t,.393+.607*e,.769-.769*e,.189-.189*e,0,.349-.349*e,.686+.314*e,.168-.168*e,0,.272-.272*e,.534-.534*e,.131+.869*e,0,0,0,0,1);return sM(i,i)})(t)}}}class wM{constructor(t,e,i,s){this.offsetX=t,this.offsetY=e,this.blurRadius=i,this.color=s,this.type="drop-shadow"}interpolate(t,e,i){this.offsetX=SM(t.offsetX,e.offsetX,i),this.offsetY=SM(t.offsetY,e.offsetY,i),this.blurRadius=SM(t.blurRadius,e.blurRadius,i),this.color[0]=Math.round(SM(t.color[0],e.color[0],i)),this.color[1]=Math.round(SM(t.color[1],e.color[1],i)),this.color[2]=Math.round(SM(t.color[2],e.color[2],i)),this.color[3]=SM(t.color[3],e.color[3],i)}clone(){return new wM(this.offsetX,this.offsetY,this.blurRadius,[...this.color])}toJSON(){const t=[...this.color];return t[3]*=255,{type:"drop-shadow",xoffset:xM(this.offsetX),yoffset:xM(this.offsetY),blurRadius:xM(this.blurRadius),color:t}}}class bM{constructor(t){this.angle=t,this.type="hue-rotate"}get colorMatrix(){return this._colorMatrix||this._updateMatrix(),this._colorMatrix}interpolate(t,e,i){this.angle=SM(t.angle,e.angle,i),this._updateMatrix()}clone(){return new bM(this.angle)}toJSON(){return{type:"hue-rotate",angle:this.angle}}_updateMatrix(){const t=this._colorMatrix||Yb();this._colorMatrix=((t,e)=>{const i=Math.sin(e*Math.PI/180),s=Math.cos(e*Math.PI/180),n=eM(t,.213+.787*s-.213*i,.715-.715*s-.715*i,.072-.072*s+.928*i,0,.213-.213*s+.143*i,.715+.285*s+.14*i,.072-.072*s-.283*i,0,.213-.213*s-.787*i,.715-.715*s+.715*i,.072+.928*s+.072*i,0,0,0,0,1);return sM(n,n)})(t,this.angle)}}class MM{constructor(t){this.amount=t,this.type="opacity",this.amount=Math.min(this.amount,1)}interpolate(t,e,i){this.amount=SM(t.amount,e.amount,i)}clone(){return new MM(this.amount)}toJSON(){return{type:"opacity",amount:this.amount}}}function SM(t,e,i){return t+(e-t)*i}function xM(t){return Math.round(1e3*hm(t))/1e3}function kM(t){switch(t.type){case"grayscale":case"sepia":case"invert":return new vM(t.type,0);case"saturate":case"brightness":case"contrast":return new vM(t.type,1);case"opacity":return new MM(1);case"hue-rotate":return new bM(0);case"blur":return new gM(0);case"drop-shadow":return new wM(0,0,0,[...Qc("transparent")]);case"bloom":return new mM(0,0,0)}}function IM(t,e){const i=t.length>e.length?t:e;return(t.length>e.length?e:t).every(((t,e)=>t.type===i[e].type))}function jM(t,e){const i=t.length>e.length?t:e,s=t.length>e.length?e:t;for(let t=s.length;t<i.length;t++)s.push(kM(i[t]))}var _M,TM={exports:{}};function OM(t){if(!t||0===t.length)return null;if("string"==typeof t){const e=AM(t);return e&&0!==e.length?e:null}const e=t.map((t=>{if(!Number.isFinite(t.scale)||t.scale<=0)throw new Ve("effect:invalid-scale","scale must be finite and greater than 0",{stop:t});return{scale:t.scale,effects:AM(t.value)}}));e.sort(((t,e)=>e.effects.length-t.effects.length));for(let t=0;t<e.length-1;t++){if(!IM(e[t].effects,e[t+1].effects))throw new Ve("effect:interpolation-impossible","Cannot interpolate by scale between 2 lists of mixed effects",{a:e[t].effects,b:e[t+1].effects});jM(e[t].effects,e[t+1].effects)}return e.sort(((t,e)=>e.scale-t.scale)),e}function AM(t){let e;if(!t)return[];try{e=TM.exports.parse(t)}catch(e){throw new Ve("effect:invalid-syntax","Invalid effect syntax",{value:t,error:e})}return e.map((t=>function(t){try{switch(t.name){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":return function(t){let e=1;return FM(t.parameters,1),1===t.parameters.length&&(e=LM(t.parameters[0])),new vM(t.name,e)}(t);case"opacity":return function(t){let e=1;return FM(t.parameters,1),1===t.parameters.length&&(e=LM(t.parameters[0])),new MM(e)}(t);case"hue-rotate":return function(t){let e=0;return FM(t.parameters,1),1===t.parameters.length&&(e=function(t){return function(t){if("quantity"!==t.type||!(0===t.value&&null===t.unit||t.unit&&null!=EM[t.unit]))throw new Ve("effect:type-error","Expected <angle>, Actual: "+CM(t),{term:t})}(t),t.value*EM[t.unit]||0}(t.parameters[0])),new bM(e)}(t);case"blur":return function(t){let e=0;return FM(t.parameters,1),1===t.parameters.length&&(e=NM(t.parameters[0]),PM(e,t.parameters[0])),new gM(e)}(t);case"drop-shadow":return function(t){const e=[];let i=null;for(const s of t.parameters)if("color"===s.type){if(e.length&&Object.freeze(e),i)throw new Ve("effect:type-error","Accepts only one color",{});i=DM(s)}else{const t=NM(s);if(Object.isFrozen(e))throw new Ve("effect:type-error","<length> parameters not consecutive",{lengths:e});e.push(t),3===e.length&&PM(t,s)}if(e.length<2||e.length>3)throw new Ve("effect:type-error",`Expected <length>{2,3}, Actual: <length>{${e.length}}`,{lengths:e});return new wM(e[0],e[1],e[2]||0,i||VM("black"))}(t);case"bloom":return function(t){let e=1,i=0,s=0;return FM(t.parameters,3),t.parameters[0]&&(e=LM(t.parameters[0])),t.parameters[1]&&(i=NM(t.parameters[1]),PM(i,t.parameters[1])),t.parameters[2]&&(s=LM(t.parameters[2])),new mM(e,i,s)}(t)}}catch(e){throw e.details.filter=t,e}throw new Ve("effect:unknown-effect",`Effect '${t.name}' is not supported`,{effect:t})}(t)))}function FM(t,e){if(t.length>e)throw new Ve("effect:type-error",`Function supports up to ${e} parameters, Actual: ${t.length}`,{parameters:t})}function CM(t){if("color"===t.type)return"<color>";if(t.unit){if(RM[t.unit])return"<length>";if(EM[t.unit])return"<angle>";if("%"===t.unit)return"<percentage>"}return"<double>"}function PM(t,e){if(t<0)throw new Ve("effect:type-error","Negative values are not allowed, Actual: "+t,{term:e})}(_M=TM).exports&&(_M.exports=function(){function t(e,i,s,n){var r=Error.call(this,e);return Object.setPrototypeOf&&Object.setPrototypeOf(r,t.prototype),r.expected=i,r.found=s,r.location=n,r.name="SyntaxError",r}function e(t,e,i){return i=i||" ",t.length>e?t:t+(i+=i.repeat(e-=t.length)).slice(0,e)}return function(t){function e(){this.constructor=t}e.prototype=Error.prototype,t.prototype=new e}(t),t.prototype.format=function(t){var i="Error: "+this.message;if(this.location){var s,n=null;for(s=0;s<t.length;s++)if(t[s].source===this.location.source){n=t[s].text.split(/\r\n|\n|\r/g);break}var r=this.location.start,o=this.location.source+":"+r.line+":"+r.column;if(n){var a=this.location.end,l=e("",(""+r.line).length),u=n[r.line-1],c=r.line===a.line?a.column:u.length+1;i+="\n --\x3e "+o+"\n"+l+" |\n"+r.line+" | "+u+"\n"+l+" | "+e("",r.column-1)+e("",c-r.column,"^")}else i+="\n at "+o}return i},t.buildMessage=function(t,e){var i={literal:function(t){return'"'+n(t.text)+'"'},class:function(t){var e=t.parts.map((function(t){return Array.isArray(t)?r(t[0])+"-"+r(t[1]):r(t)}));return"["+(t.inverted?"^":"")+e+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(t){return t.description}};function s(t){return t.charCodeAt(0).toString(16).toUpperCase()}function n(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+s(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+s(t)}))}function r(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(t){return"\\x0"+s(t)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(t){return"\\x"+s(t)}))}function o(t){return i[t.type](t)}return"Expected "+function(t){var e,i,s=t.map(o);if(s.sort(),s.length>0){for(e=1,i=1;e<s.length;e++)s[e-1]!==s[e]&&(s[i]=s[e],i++);s.length=i}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(t)+" but "+function(t){return t?'"'+n(t)+'"':"end of input"}(e)+" found."},{SyntaxError:t,parse:function(e,i){var s,n={},r=(i=void 0!==i?i:{}).grammarSource,o={start:ot},a=ot,l="none",u="grad",c="turn",h=/^[ \t\n\r]/,d=/^[a-z\-]/,p=/^[0-9a-fA-F]/,f=/^[+\-]/,y=/^[0-9]/,m=st("none"),g=et("none",!1),v=et(")",!1),w=et(",",!1),b=st("whitespace"),M=it([" ","\t","\n","\r"],!1,!1),S=st("function"),x=et("(",!1),k=st("identifier"),I=it([["a","z"],"-"],!1,!1),j=st("percentage"),_=et("%",!1),T=st("length"),O=et("px",!1),A=et("cm",!1),F=et("mm",!1),C=et("in",!1),P=et("pt",!1),E=et("pc",!1),R=st("angle"),L=et("deg",!1),N=et("rad",!1),D=et("grad",!1),V=et("turn",!1),$=st("number"),z=st("color"),G=et("#",!1),U=it([["0","9"],["a","f"],["A","F"]],!1,!1),q=it(["+","-"],!1,!1),B=it([["0","9"]],!1,!1),W=et(".",!1),H=et("e",!1),J=0,Z=0,Q=[{line:1,column:1}],K=0,Y=[],X=0;if("startRule"in i){if(!(i.startRule in o))throw Error("Can't start parsing from rule \""+i.startRule+'".');a=o[i.startRule]}function tt(){return e.substring(Z,J)}function et(t,e){return{type:"literal",text:t,ignoreCase:e}}function it(t,e,i){return{type:"class",parts:t,inverted:e,ignoreCase:i}}function st(t){return{type:"other",description:t}}function nt(t){var i,s=Q[t];if(s)return s;for(i=t-1;!Q[i];)i--;for(s={line:(s=Q[i]).line,column:s.column};i<t;)10===e.charCodeAt(i)?(s.line++,s.column=1):s.column++,i++;return Q[t]=s,s}function rt(t){J<K||(J>K&&(K=J,Y=[]),Y.push(t))}function ot(){var t;return(t=at())===n&&(t=function(){var t,e;if(t=[],(e=lt())!==n)for(;e!==n;)t.push(e),e=lt();else t=n;return t}()),t}function at(){var t,i;return X++,t=J,ct(),e.substr(J,4)===l?(i=l,J+=4):(i=n,0===X&&rt(g)),i!==n?(ct(),Z=t,t=[]):(J=t,t=n),X--,t===n&&0===X&&rt(m),t}function lt(){var t,i,s,r;return t=J,ct(),(i=function(){var t,i,s;return X++,t=J,(i=ht())!==n?(40===e.charCodeAt(J)?(s="(",J++):(s=n,0===X&&rt(x)),s!==n?(Z=t,t=i):(J=t,t=n)):(J=t,t=n),X--,t===n&&(i=n,0===X&&rt(S)),t}())!==n?(ct(),(s=function(){var t,i,s,r,o,a,l,u;if(t=J,(i=ut())!==n){for(s=[],r=J,o=ct(),44===e.charCodeAt(J)?(a=",",J++):(a=n,0===X&&rt(w)),a===n&&(a=null),l=ct(),(u=ut())!==n?r=o=[o,a,l,u]:(J=r,r=n);r!==n;)s.push(r),r=J,o=ct(),44===e.charCodeAt(J)?(a=",",J++):(a=n,0===X&&rt(w)),a===n&&(a=null),l=ct(),(u=ut())!==n?r=o=[o,a,l,u]:(J=r,r=n);Z=t,t=function(t,e){return e.length>0?function(t,e){return[t].concat(function(t){return t.map((function(t){return t[3]}))}(e))}(t,e):[t]}(i,s)}else J=t,t=n;return t}())===n&&(s=null),ct(),41===e.charCodeAt(J)?(r=")",J++):(r=n,0===X&&rt(v)),r!==n?(ct(),Z=t,t=function(t,e){return{type:"function",name:t,parameters:e||[]}}(i,s)):(J=t,t=n)):(J=t,t=n),t}function ut(){var t,e;return t=J,(e=dt())===n&&(e=pt())===n&&(e=ft())===n&&(e=function(){var t,e;return X++,t=J,ct(),(e=mt())!==n?(Z=t,t=function(t){return{value:t,unit:null}}(e)):(J=t,t=n),X--,t===n&&0===X&&rt($),t}()),e!==n&&(Z=t,e=function(t){return{type:"quantity",value:t.value,unit:t.unit}}(e)),(t=e)===n&&(t=J,(e=yt())!==n&&(Z=t,e=function(t){return{type:"color",colorType:t.type,value:t.value}}(e)),t=e),t}function ct(){var t,i;for(X++,t=[],h.test(e.charAt(J))?(i=e.charAt(J),J++):(i=n,0===X&&rt(M));i!==n;)t.push(i),h.test(e.charAt(J))?(i=e.charAt(J),J++):(i=n,0===X&&rt(M));return X--,i=n,0===X&&rt(b),t}function ht(){var t,i,s;if(X++,t=J,i=[],d.test(e.charAt(J))?(s=e.charAt(J),J++):(s=n,0===X&&rt(I)),s!==n)for(;s!==n;)i.push(s),d.test(e.charAt(J))?(s=e.charAt(J),J++):(s=n,0===X&&rt(I));else i=n;return i!==n&&(Z=t,i=tt()),X--,(t=i)===n&&(i=n,0===X&&rt(k)),t}function dt(){var t,i,s;return X++,t=J,ct(),(i=mt())!==n?(37===e.charCodeAt(J)?(s="%",J++):(s=n,0===X&&rt(_)),s!==n?(Z=t,t=function(t){return{value:t,unit:"%"}}(i)):(J=t,t=n)):(J=t,t=n),X--,t===n&&0===X&&rt(j),t}function pt(){var t,i,s;return X++,t=J,ct(),(i=mt())!==n?("px"===e.substr(J,2)?(s="px",J+=2):(s=n,0===X&&rt(O)),s!==n?(Z=t,t=function(t){return{value:t,unit:"px"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,ct(),(i=mt())!==n?("cm"===e.substr(J,2)?(s="cm",J+=2):(s=n,0===X&&rt(A)),s!==n?(Z=t,t=function(t){return{value:t,unit:"cm"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,ct(),(i=mt())!==n?("mm"===e.substr(J,2)?(s="mm",J+=2):(s=n,0===X&&rt(F)),s!==n?(Z=t,t=function(t){return{value:t,unit:"mm"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,ct(),(i=mt())!==n?("in"===e.substr(J,2)?(s="in",J+=2):(s=n,0===X&&rt(C)),s!==n?(Z=t,t=function(t){return{value:t,unit:"in"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,ct(),(i=mt())!==n?("pt"===e.substr(J,2)?(s="pt",J+=2):(s=n,0===X&&rt(P)),s!==n?(Z=t,t=function(t){return{value:t,unit:"pt"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,ct(),(i=mt())!==n?("pc"===e.substr(J,2)?(s="pc",J+=2):(s=n,0===X&&rt(E)),s!==n?(Z=t,t=function(t){return{value:t,unit:"pc"}}(i)):(J=t,t=n)):(J=t,t=n)))))),X--,t===n&&0===X&&rt(T),t}function ft(){var t,i,s;return X++,t=J,(i=mt())!==n?("deg"===e.substr(J,3)?(s="deg",J+=3):(s=n,0===X&&rt(L)),s!==n?(Z=t,t=function(t){return{value:t,unit:"deg"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,(i=mt())!==n?("rad"===e.substr(J,3)?(s="rad",J+=3):(s=n,0===X&&rt(N)),s!==n?(Z=t,t=function(t){return{value:t,unit:"rad"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,(i=mt())!==n?(e.substr(J,4)===u?(s=u,J+=4):(s=n,0===X&&rt(D)),s!==n?(Z=t,t=function(t){return{value:t,unit:"grad"}}(i)):(J=t,t=n)):(J=t,t=n),t===n&&(t=J,(i=mt())!==n?(e.substr(J,4)===c?(s=c,J+=4):(s=n,0===X&&rt(V)),s!==n?(Z=t,t=function(t){return{value:t,unit:"turn"}}(i)):(J=t,t=n)):(J=t,t=n)))),X--,t===n&&(i=n,0===X&&rt(R)),t}function yt(){var t,i,s,r;if(X++,t=J,35===e.charCodeAt(J)?(i="#",J++):(i=n,0===X&&rt(G)),i!==n){if(s=[],p.test(e.charAt(J))?(r=e.charAt(J),J++):(r=n,0===X&&rt(U)),r!==n)for(;r!==n;)s.push(r),p.test(e.charAt(J))?(r=e.charAt(J),J++):(r=n,0===X&&rt(U));else s=n;s!==n?(Z=t,t={type:"hex",value:tt()}):(J=t,t=n)}else J=t,t=n;return t===n&&(t=J,(i=lt())!==n&&(Z=t,i=function(t){return{type:"function",value:t}}(i)),(t=i)===n&&(t=J,(i=ht())!==n&&(Z=t,i={type:"named",value:tt()}),t=i)),X--,t===n&&(i=n,0===X&&rt(z)),t}function mt(){var t,i,s,r,o,a,l;for(t=J,f.test(e.charAt(J))?(e.charAt(J),J++):0===X&&rt(q),i=J,s=[],y.test(e.charAt(J))?(r=e.charAt(J),J++):(r=n,0===X&&rt(B));r!==n;)s.push(r),y.test(e.charAt(J))?(r=e.charAt(J),J++):(r=n,0===X&&rt(B));if(46===e.charCodeAt(J)?(r=".",J++):(r=n,0===X&&rt(W)),r!==n){if(o=[],y.test(e.charAt(J))?(a=e.charAt(J),J++):(a=n,0===X&&rt(B)),a!==n)for(;a!==n;)o.push(a),y.test(e.charAt(J))?(a=e.charAt(J),J++):(a=n,0===X&&rt(B));else o=n;o!==n?i=s=[s,r,o]:(J=i,i=n)}else J=i,i=n;if(i===n)if(i=[],y.test(e.charAt(J))?(s=e.charAt(J),J++):(s=n,0===X&&rt(B)),s!==n)for(;s!==n;)i.push(s),y.test(e.charAt(J))?(s=e.charAt(J),J++):(s=n,0===X&&rt(B));else i=n;if(i!==n){if(s=J,101===e.charCodeAt(J)?(r="e",J++):(r=n,0===X&&rt(H)),r!==n){if(f.test(e.charAt(J))?(o=e.charAt(J),J++):(o=n,0===X&&rt(q)),o===n&&(o=null),a=[],y.test(e.charAt(J))?(l=e.charAt(J),J++):(l=n,0===X&&rt(B)),l!==n)for(;l!==n;)a.push(l),y.test(e.charAt(J))?(l=e.charAt(J),J++):(l=n,0===X&&rt(B));else a=n;a!==n?s=r=[r,o,a]:(J=s,s=n)}else J=s,s=n;s===n&&(s=null),Z=t,t=parseFloat(tt())}else J=t,t=n;return t}if((s=a())!==n&&J===e.length)return s;throw s!==n&&J<e.length&&rt({type:"end"}),function(e,i,s){return new t(t.buildMessage(e,i),e,i,s)}(Y,K<e.length?e.charAt(K):null,function(t,e){var i=nt(t),s=nt(e);return{source:r,start:{offset:t,line:i.line,column:i.column},end:{offset:e,line:s.line,column:s.column}}}(K,K<e.length?K+1:K))}}}());const EM={deg:1,grad:.9,rad:180/Math.PI,turn:360},RM={px:1,cm:96/2.54,mm:96/2.54/10,in:96,pc:16,pt:96/72};function LM(t){!function(t){if("quantity"!==t.type||null!==t.unit&&"%"!==t.unit)throw new Ve("effect:type-error","Expected <double> or <percentage>, Actual: "+CM(t),{term:t})}(t);const e=t.value;return PM(e,t),"%"===t.unit?.01*e:e}function NM(t){return function(t){if("quantity"!==t.type||!(0===t.value&&null===t.unit||t.unit&&null!=RM[t.unit]))throw new Ve("effect:type-error","Expected <length>, Actual: "+CM(t),{term:t})}(t),t.value*RM[t.unit]||0}function DM(t){switch(t.colorType){case"hex":return function(t){const e=t.length>5,i=e?8:4,s=(1<<i)-1,n=e?1:17,r=e?9===t.length:5===t.length;let o=Number("0x"+t.substr(1));if(isNaN(o))return null;const a=[0,0,0,1];let l;return r&&(l=o&s,o>>=i,a[3]=n*l/255),l=o&s,o>>=i,a[2]=n*l,l=o&s,o>>=i,a[1]=n*l,l=o&s,o>>=i,a[0]=n*l,a}(t.value);case"named":return VM(t.value);case"function":return function(t){if(FM(t.parameters,4),$M.test(t.name))return[LM(t.parameters[0]),LM(t.parameters[1]),LM(t.parameters[2]),t.parameters[3]?LM(t.parameters[3]):1];if(zM.test(t.name))return Yc(function(t){return function(t){if("quantity"!==t.type||null!==t.unit)throw new Ve("effect:type-error","Expected <double>, Actual: "+CM(t),{term:t})}(t),PM(t.value,t),t.value}(t.parameters[0]),LM(t.parameters[1]),LM(t.parameters[2]),t.parameters[3]?LM(t.parameters[3]):1);throw new Ve("effect:syntax-error",`Invalid color function '${t.name}'`,{colorFunction:t})}(t.value)}}function VM(t){if(!Zc(t))throw new Ve("effect:unknown-color",`color '${t}' isn't valid`,{namedColor:t});return function(t){return[...Qc(t)]}(t)}const $M=/^rgba?/i,zM=/^hsla?/i;function GM(t,e,i){try{return function(t){if(!t||0===t.length)return null;if(function(t){const e=t[0];return!!e&&"scale"in e}(t)){const e=[];for(const i of t)e.push({scale:i.scale,value:qM(i.value)});return e}return qM(t)}(t)}catch(t){var s;null==i||null==(s=i.messages)||s.push(t)}return null}function UM(t,e,i,s){try{K(i,function(t){const e=OM(t);return e?function(t){const e=t[0];return!!e&&"type"in e}(e)?e.map((t=>t.toJSON())):e.map((({scale:t,effects:e})=>({scale:t,value:e.map((t=>t.toJSON()))}))):null}(t),e)}catch(t){s.messages&&s.messages.push(t)}}function qM(t){if(!t||!t.length)return"";const e=[];for(const i of t){let t=[];switch(i.type){case"grayscale":case"sepia":case"saturate":case"invert":case"brightness":case"contrast":case"opacity":t=[BM(i,"amount")];break;case"blur":t=[BM(i,"radius","pt")];break;case"hue-rotate":t=[BM(i,"angle","deg")];break;case"drop-shadow":t=[BM(i,"xoffset","pt"),BM(i,"yoffset","pt"),BM(i,"blurRadius","pt"),WM(i,"color")];break;case"bloom":t=[BM(i,"strength"),BM(i,"radius","pt"),BM(i,"threshold")]}const s=`${i.type}(${t.filter(Boolean).join(" ")})`;OM(s),e.push(s)}return e.join(" ")}function BM(t,e,i){if(null==t[e])throw new Ve("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});return i?t[e]+i:""+t[e]}function WM(t,e){if(null==t[e])throw new Ve("effect:missing-parameter",`Missing parameter '${e}' in ${t.type} effect`,{effect:t});const i=t[e];return`rgba(${i[0]||0}, ${i[1]||0}, ${i[2]||0}, ${i[3]/255||0})`}function HM(t,e,i={}){return JM(t,e,i,ZM)}function JM(t,e,i={},s){let n=null;const r=i.once?(t,i)=>{s(t)&&(v(n),e(t,i))}:(t,i)=>{s(t)&&e(t,i)};if(n=function(t,e,i=!1,s=J){return i?function(t,e,i){let s=!1;return co(t,((t,n)=>{s||(s=!0,i(n,t)||e(t,n),s=!1)}))}(t,e,s):function(t,e,i){let s,n,r=ho(t,((t,o)=>{s&&s.uid!==n?r.remove():(s||(s=mo.acquireTracked(t,e,o,i),n=s.uid),bo(s))}));return{remove:Jt((()=>{r.remove(),s&&(s.uid!==n||s.removed||(s.removed=!0,bo(s)),s=null),r=null}))}}(t,e,s)}(t,r,i.sync,i.equals),i.initial){const e=t();r(e,e)}return n}function ZM(){return!0}function QM(t){return!!t}let KM=class extends jo{constructor(){super(...arguments),this.updating=!1,this.handleId=0,this.handles=new Wo,this.scheduleHandleId=0,this.pendingPromises=new Set}destroy(){this.removeAll(),this.handles.destroy()}add(t,e,i,s=0){const n=0!=(1&s),r=++this.handleId;n||this.installSyncUpdatingWatch(t,e,r);const o=0!=(2&s)?Xo(t,e,i,n):t.watch(e,i,n);return this.handles.add(o,r),{remove:()=>this.handles.remove(r)}}addOnCollectionPropertyChange(t,e,i,s=0){const n=0!=(2&s),r=++this.handleId;return this.handles.add([ca(t,e,"after-changes",this.createSyncUpdatingCallback()),ca(t,e,"change",i,n?t=>{i({added:t.items,removed:[],moved:[],target:t})}:void 0)],r),{remove:()=>{this.handles.remove(r)}}}addOnCollectionChange(t,e,i=0){const s=0!=(2&i),n=++this.handleId;return this.handles.add([t.on("after-changes",this.createSyncUpdatingCallback()),t.on("change",e)],n),s&&e({added:t.items,removed:[],moved:[],target:t}),{remove:()=>{this.handles.remove(n)}}}addPromise(t){if(c(t))return t;const e=++this.handleId;this.handles.add({remove:()=>{this.pendingPromises.delete(t)&&(0!==this.pendingPromises.size||this.handles.has(YM)||this._set("updating",!1))}},e),this.pendingPromises.add(t),this._set("updating",!0);const i=()=>this.handles.remove(e);return t.then(i,i),t}removeAll(){this.pendingPromises.clear(),this.handles.removeAll(),this._set("updating",!1)}installSyncUpdatingWatch(t,e,i){const s=HM((()=>Kt(t,e)),this.createSyncUpdatingCallback(),{sync:!0,equals:()=>!1});return this.handles.add(s,i),s}createSyncUpdatingCallback(){return()=>{this.handles.remove(YM),++this.scheduleHandleId;const t=this.scheduleHandleId;this._get("updating")||this._set("updating",!0),this.handles.add(Zr((()=>{t===this.scheduleHandleId&&(this._set("updating",this.pendingPromises.size>0),this.handles.remove(YM))})),YM)}}};e([oe({readOnly:!0})],KM.prototype,"updating",void 0),KM=e([si("esri.views.support.WatchUpdatingTracking")],KM);const YM=-42,XM=t=>{let i=class extends t{destroy(){this.destroyed||(this.handles.destroy(),this.updatingHandles.destroy())}get handles(){return this._get("handles")||new Wo}get updatingHandles(){return this._get("updatingHandles")||new KM}};return e([oe({readOnly:!0})],i.prototype,"handles",null),e([oe({readOnly:!0})],i.prototype,"updatingHandles",null),i=e([si("esri.core.HandleOwner")],i),i};let tS=class extends(XM(jo)){};tS=e([si("esri.core.HandleOwner")],tS);const eS={milliseconds:1,seconds:1e3,minutes:6e4,hours:36e5,days:864e5,weeks:6048e5,months:26784e5,years:31536e6,decades:31536e7,centuries:31536e8},iS={milliseconds:{getter:"getMilliseconds",setter:"setMilliseconds",multiplier:1},seconds:{getter:"getSeconds",setter:"setSeconds",multiplier:1},minutes:{getter:"getMinutes",setter:"setMinutes",multiplier:1},hours:{getter:"getHours",setter:"setHours",multiplier:1},days:{getter:"getDate",setter:"setDate",multiplier:1},weeks:{getter:"getDate",setter:"setDate",multiplier:7},months:{getter:"getMonth",setter:"setMonth",multiplier:1},years:{getter:"getFullYear",setter:"setFullYear",multiplier:1},decades:{getter:"getFullYear",setter:"setFullYear",multiplier:10},centuries:{getter:"getFullYear",setter:"setFullYear",multiplier:100}};function sS(t,e,i){const s=new Date(t.getTime());if(e&&i){const t=iS[i],{getter:n,setter:r,multiplier:o}=t;s[r](s[n]()+e*o)}return s}function nS(t,e){switch(e){case"milliseconds":return new Date(t.getTime());case"seconds":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());case"minutes":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes());case"hours":return new Date(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours());case"days":return new Date(t.getFullYear(),t.getMonth(),t.getDate());case"weeks":return new Date(t.getFullYear(),t.getMonth(),t.getDate()-t.getDay());case"months":return new Date(t.getFullYear(),t.getMonth(),1);case"years":return new Date(t.getFullYear(),0,1);case"decades":return new Date(t.getFullYear()-t.getFullYear()%10,0,1);case"centuries":return new Date(t.getFullYear()-t.getFullYear()%100,0,1);default:return new Date}}var rS;let oS=rS=class extends Vd{constructor(t){super(t),this.end=null,this.start=null}static get allTime(){return aS}static get empty(){return lS}readEnd(t,e){return null!=e.end?new Date(e.end):null}writeEnd(t,e){e.end=t?t.getTime():null}get isAllTime(){return this.equals(rS.allTime)}get isEmpty(){return this.equals(rS.empty)}readStart(t,e){return null!=e.start?new Date(e.start):null}writeStart(t,e){e.start=t?t.getTime():null}clone(){return new rS({end:this.end,start:this.start})}equals(t){if(!t)return!1;const e=u(this.start)?this.start.getTime():this.start,i=u(this.end)?this.end.getTime():this.end,s=u(t.start)?t.start.getTime():t.start,n=u(t.end)?t.end.getTime():t.end;return e===s&&i===n}expandTo(t){if(this.isEmpty||this.isAllTime)return this.clone();const e=x(this.start,(e=>nS(e,t))),i=x(this.end,(e=>sS(nS(e,t),1,t)));return new rS({start:e,end:i})}intersection(t){if(!t)return this.clone();if(this.isEmpty||t.isEmpty)return rS.empty;if(this.isAllTime)return t.clone();if(t.isAllTime)return this.clone();const e=S(this.start,-1/0,(t=>t.getTime())),i=S(this.end,1/0,(t=>t.getTime())),s=S(t.start,-1/0,(t=>t.getTime())),n=S(t.end,1/0,(t=>t.getTime()));let r,o;if(s>=e&&s<=i?r=s:e>=s&&e<=n&&(r=e),i>=s&&i<=n?o=i:n>=e&&n<=i&&(o=n),!isNaN(r)&&!isNaN(o)){const t=new rS;return t.start=r===-1/0?null:new Date(r),t.end=o===1/0?null:new Date(o),t}return rS.empty}offset(t,e){if(this.isEmpty||this.isAllTime)return this.clone();const i=new rS,{start:s,end:n}=this;return u(s)&&(i.start=sS(s,t,e)),u(n)&&(i.end=sS(n,t,e)),i}union(t){if(!t||t.isEmpty)return this.clone();if(this.isEmpty)return t.clone();if(this.isAllTime||t.isAllTime)return aS.clone();const e=u(this.start)&&u(t.start)?new Date(Math.min(this.start.getTime(),t.start.getTime())):null,i=u(this.end)&&u(t.end)?new Date(Math.max(this.end.getTime(),t.end.getTime())):null;return new rS({start:e,end:i})}};e([oe({type:Date,json:{write:{allowNull:!0}}})],oS.prototype,"end",void 0),e([Sd("end")],oS.prototype,"readEnd",null),e([xd("end")],oS.prototype,"writeEnd",null),e([oe({readOnly:!0,json:{read:!1}})],oS.prototype,"isAllTime",null),e([oe({readOnly:!0,json:{read:!1}})],oS.prototype,"isEmpty",null),e([oe({type:Date,json:{write:{allowNull:!0}}})],oS.prototype,"start",void 0),e([Sd("start")],oS.prototype,"readStart",null),e([xd("start")],oS.prototype,"writeStart",null),oS=rS=e([si("esri.TimeExtent")],oS);const aS=new oS,lS=new oS({start:void 0,end:void 0}),uS=oS;var cS;let hS=cS=class extends Vd{async collectRequiredFields(t,e){return My(t,e,this.expression)}clone(){return new cS({expression:this.expression,title:this.title})}};e([oe({type:String,json:{write:!0}})],hS.prototype,"expression",void 0),e([oe({type:String,json:{write:!0}})],hS.prototype,"title",void 0),hS=cS=e([si("esri.layers.support.FeatureExpressionInfo")],hS);const dS=hS;function pS(t){return new ap({wkt:`GEOCCS["Spherical geocentric",\n    DATUM["Not specified",\n      SPHEROID["Sphere",${t.radius},0]],\n    PRIMEM["Greenwich",0.0,\n      AUTHORITY["EPSG","8901"]],\n    UNIT["m",1.0],\n    AXIS["Geocentric X",OTHER],\n    AXIS["Geocentric Y",EAST],\n    AXIS["Geocentric Z",NORTH]\n  ]`})}const fS=pS(hp),yS=pS(dp),mS=pS(pp),gS=new ap({wkt:`GEOCCS["WGS 84",\n  DATUM["WGS_1984",\n    SPHEROID["WGS 84",${hp.radius},298.257223563,\n      AUTHORITY["EPSG","7030"]],\n    AUTHORITY["EPSG","6326"]],\n  PRIMEM["Greenwich",0,\n    AUTHORITY["EPSG","8901"]],\n  UNIT["m",1.0,\n    AUTHORITY["EPSG","9001"]],\n  AXIS["Geocentric X",OTHER],\n  AXIS["Geocentric Y",OTHER],\n  AXIS["Geocentric Z",NORTH],\n  AUTHORITY["EPSG","4978"]\n]`});function vS(t){return t&&t===dp?yS:t&&t===pp?mS:fS}function wS(t){return t&&(tp(t)||t===yS)?yS:t&&(ip(t)||t===mS)?mS:fS}function bS(t){return t&&(tp(t)||t===yS)?dp:t&&(ip(t)||t===mS)?pp:hp}function MS(t){return Xd(t)?dp:ep(t)?pp:hp}const SS=39.37,xS=hp.radius*Math.PI/200,kS=/UNIT\[([^\]]+)\]\]$/i,IS=$d,jS=/UNIT\[([^\]]+)\]/i,_S=new Set([4261,4305,4807,4810,4811,4812,4816,4819,4821,4901,4902,37225,104139,104140]),TS=oi()({meter:"meters",foot:"feet",foot_us:"us-feet",foot_clarke:"clarke-feet",yard_clarke:"clarke-yards",link_clarke:"clarke-links",yard_sears:"sears-yards",foot_sears:"sears-feet",chain_sears:"sears-chains",chain_benoit_1895_b:"benoit-1895-b-chains",yard_indian:"indian-yards",yard_indian_1937:"indian-1937-yards",foot_gold_coast:"gold-coast-feet",chain_sears_1922_truncated:"sears-1922-truncated-chains","50_kilometers":"50-kilometers","150_kilometers":"150-kilometers"}),OS=t=>t*t,AS=t=>t*t*t,FS={length:{baseUnit:"meters",units:{millimeters:{inBaseUnits:.001},centimeters:{inBaseUnits:.01},decimeters:{inBaseUnits:.1},meters:{inBaseUnits:1},kilometers:{inBaseUnits:1e3},inches:{inBaseUnits:.0254},feet:{inBaseUnits:.3048},yards:{inBaseUnits:.9144},miles:{inBaseUnits:1609.344},"nautical-miles":{inBaseUnits:1852},"us-feet":{inBaseUnits:1200/3937}}},area:{baseUnit:"square-meters",units:{"square-millimeters":{inBaseUnits:OS(.001)},"square-centimeters":{inBaseUnits:OS(.01)},"square-decimeters":{inBaseUnits:OS(.1)},"square-meters":{inBaseUnits:1},"square-kilometers":{inBaseUnits:OS(1e3)},"square-inches":{inBaseUnits:OS(.0254)},"square-feet":{inBaseUnits:OS(.3048)},"square-yards":{inBaseUnits:OS(.9144)},"square-miles":{inBaseUnits:OS(1609.344)},"square-us-feet":{inBaseUnits:OS(1200/3937)},acres:{inBaseUnits:.0015625*OS(1609.344)},ares:{inBaseUnits:100},hectares:{inBaseUnits:1e4}}},volume:{baseUnit:"liters",units:{liters:{inBaseUnits:1},"cubic-millimeters":{inBaseUnits:1e3*AS(.001)},"cubic-centimeters":{inBaseUnits:1e3*AS(.01)},"cubic-decimeters":{inBaseUnits:1e3*AS(.1)},"cubic-meters":{inBaseUnits:1e3},"cubic-kilometers":{inBaseUnits:1e3*AS(1e3)},"cubic-inches":{inBaseUnits:1e3*AS(.0254)},"cubic-feet":{inBaseUnits:1e3*AS(.3048)},"cubic-yards":{inBaseUnits:1e3*AS(.9144)},"cubic-miles":{inBaseUnits:1e3*AS(1609.344)}}},angle:{baseUnit:"radians",units:{radians:{inBaseUnits:1},degrees:{inBaseUnits:Math.PI/180}}}},CS=function(){const t={};for(const e in FS)for(const i in FS[e].units)t[i]=e;return t}();function PS(t){const e=CS[t];if(e)return e;throw Error("unknown measure")}function ES(t,e=null){return e=e||PS(t),FS[e].baseUnit===t}function RS(t,e,i){if(e===i)return t;const s=PS(e);if(s!==PS(i))throw Error("incompatible units");const n=ES(e,s)?t:function(t,e,i){return t*FS[i].units[e].inBaseUnits}(t,e,s);return ES(i,s)?n:function(t,e,i){return t/FS[i].units[e].inBaseUnits}(n,i,s)}function LS(t){return TS.fromJSON(t.toLowerCase())||null}function NS(t){if(t&&"object"==typeof t&&!function(t){return!(tp(t)||ip(t))}(t))return 1;const e=DS(t);return e>1e5?1:e}function DS(t,e=hp.metersPerDegree){return VS(t,!0)||e}function VS(t,e=!1){let i,s,n=null;if(null!=t&&("object"==typeof t?(i=t.wkid,s=t.wkt):"number"==typeof t?i=t:"string"==typeof t&&(s=t)),i){if(Xd(i))return dp.metersPerDegree;if(ep(i))return pp.metersPerDegree;n=IS.values[IS[i]],!n&&e&&_S.has(i)&&(n=xS)}else s&&(qS(s)?n=$S(kS.exec(s),n):US(s)&&(n=$S(jS.exec(s),n)));return n}function $S(t,e){return t&&t[1]?zS(t[1]):e}function zS(t){return parseFloat(t.split(",")[1])}function GS(t){let e,i,s=null;if(null!=t&&("object"==typeof t?(e=t.wkid,i=t.wkt):"number"==typeof t?e=t:"string"==typeof t&&(i=t)),e)s=IS.units[IS[e]];else if(i){const t=qS(i)?kS:US(i)?jS:null;if(t){const e=t.exec(i);e&&e[1]&&(s=function(t){const e=/[\\"\\']{1}([^\\"\\']+)/.exec(t);let i=e&&e[1];if(!i||-1===IS.units.indexOf(i)){const e=zS(t);i=null;const s=IS.values;for(let t=0;t<s.length;++t)if(Math.abs(e-s[t])<1e-7){i=IS.units[t];break}}return i}(e[1]))}}return u(s)?LS(s):null}function US(t){return/^GEOCCS/i.test(t)}function qS(t){return/^PROJCS/i.test(t)}const BS={esriAcres:"acres",esriAres:"ares",esriHectares:"hectares",esriSquareCentimeters:"square-centimeters",esriSquareDecimeters:"square-decimeters",esriSquareFeet:"square-feet",esriSquareInches:"square-inches",esriSquareKilometers:"square-kilometers",esriSquareMeters:"square-meters",esriSquareMiles:"square-miles",esriSquareMillimeters:"square-millimeters",esriSquareUsFeet:"square-us-feet",esriSquareYards:"square-yards"},WS={esriCentimeters:"centimeters",esriDecimeters:"decimeters",esriFeet:"feet",esriInches:"inches",esriKilometers:"kilometers",esriMeters:"meters",esriMiles:"miles",esriMillimeters:"millimeters",esriNauticalMiles:"nautical-miles",esriYards:"yards"},HS=oi()(BS),JS=oi()(WS);oi()({...BS,...WS});const ZS={inches:RS(1,"meters","inches"),feet:RS(1,"meters","feet"),"us-feet":RS(1,"meters","us-feet"),yards:RS(1,"meters","yards"),miles:RS(1,"meters","miles"),"nautical-miles":RS(1,"meters","nautical-miles"),millimeters:RS(1,"meters","millimeters"),centimeters:RS(1,"meters","centimeters"),decimeters:RS(1,"meters","decimeters"),meters:RS(1,"meters","meters"),kilometers:RS(1,"meters","kilometers"),"decimal-degrees":1/function(t,e,i){return RS(1,"meters","meters")/(i*Math.PI/180)}(0,0,hp.radius)},QS=function(){const t=Object.keys(ZS);return t.sort(),t}();var KS;const YS=oi()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),XS=new ri({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let tx=KS=class extends Vd{constructor(){super(...arguments),this.offset=null}readFeatureExpressionInfo(t,e){return null!=t?t:e.featureExpression&&0===e.featureExpression.value?{expression:"0"}:void 0}writeFeatureExpressionInfo(t,e,i,s){e[i]=t.write({},s),"0"===t.expression&&(e.featureExpression={value:0})}get mode(){const{offset:t,featureExpressionInfo:e}=this;return this._isOverridden("mode")?this._get("mode"):u(t)||e?"relative-to-ground":"on-the-ground"}set mode(t){this._override("mode",t)}set unit(t){this._set("unit",t)}write(t,e){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(t,e):null}clone(){return new KS({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}};e([oe({type:dS,json:{write:!0}})],tx.prototype,"featureExpressionInfo",void 0),e([Sd("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],tx.prototype,"readFeatureExpressionInfo",null),e([xd("featureExpressionInfo",{featureExpressionInfo:{type:dS},"featureExpression.value":{type:[0]}})],tx.prototype,"writeFeatureExpressionInfo",null),e([oe({type:YS.apiValues,nonNullable:!0,json:{type:YS.jsonValues,read:YS.read,write:{writer:YS.write,isRequired:!0}}})],tx.prototype,"mode",null),e([oe({type:Number,json:{write:!0}})],tx.prototype,"offset",void 0),e([oe({type:QS,json:{type:String,read:XS.read,write:XS.write}})],tx.prototype,"unit",null),tx=KS=e([si("esri.layers.support.ElevationInfo")],tx);const ex=tx,ix={type:Boolean,value:!0,json:{origins:{service:{read:!1,write:!1},"web-map":{read:!1,write:!1}},name:"screenSizePerspective",write:!0}},sx={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(t,e)=>!e.disablePopup},write:{enabled:!0,writer(t,e,i){e[i]=!t}}}},nx={type:Boolean,value:!0,json:{name:"showLabels",write:!0}},rx={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:ev}}},ox={type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:!0}},ax={value:null,type:ex,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:!0}};function lx(t){return{type:t,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const ux={type:Number,json:{origins:{"web-document":{write:!0,read:!0},"portal-item":{write:!0}}}},cx={...ux,json:{...ux.json,origins:{"web-document":{...ux.json.origins["web-document"],write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(t,e,i)=>i&&"service"!==i.origin||!e.drawingInfo||void 0===e.drawingInfo.transparency?e.layerDefinition&&e.layerDefinition.drawingInfo&&void 0!==e.layerDefinition.drawingInfo.transparency?mm(e.layerDefinition.drawingInfo.transparency):void 0:mm(e.drawingInfo.transparency)}}},hx={type:uS,readOnly:!0,get(){var t,e;if(null==(t=this.layer)||!t.timeInfo)return null;const{datesInUnknownTimezone:i,timeOffset:s,useViewTime:n}=this.layer,r=null==(e=this.view)?void 0:e.timeExtent;let o=this.layer.timeExtent;i&&(o=function(t){if(!t)return t;const{start:e,end:i}=t;return new uS({start:u(e)?sS(e,e.getTimezoneOffset(),"minutes"):e,end:u(i)?sS(i,i.getTimezoneOffset(),"minutes"):i})}(o));let a=n?r&&o?r.intersection(o):r||o:o;if(!a||a.isEmpty||a.isAllTime)return a;s&&(a=a.offset(-s.value,s.unit)),i&&(a=function(t){if(!t)return t;const{start:e,end:i}=t;return new uS({start:u(e)?sS(e,-e.getTimezoneOffset(),"minutes"):e,end:u(i)?sS(i,-i.getTimezoneOffset(),"minutes"):i})}(a));const l=this._get("timeExtent");return a.equals(l)?l:a}},dx={type:of,readOnly:!0,json:{origins:{service:{read:{source:["fullExtent","spatialReference"],reader:(t,e)=>{const i=of.fromJSON(t);return null!=e.spatialReference&&"object"==typeof e.spatialReference&&(i.spatialReference=ap.fromJSON(e.spatialReference)),i}}}},read:!1}},px={type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}}}},fx={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.minScale"},write:{target:"layerDefinition.minScale"}}},yx={type:Number,json:{origins:{service:{write:{enabled:!1}}},read:{source:"layerDefinition.maxScale"},write:{target:"layerDefinition.maxScale"}}};var mx;let gx=mx=class extends Vd{constructor(t){super(t),this.minValue=0,this.maxValue=0}clone(){return new mx({minValue:this.minValue,maxValue:this.maxValue})}};e([oe({type:Number,json:{write:!0}})],gx.prototype,"minValue",void 0),e([oe({type:Number,json:{write:!0}})],gx.prototype,"maxValue",void 0),gx=mx=e([si("esri.renderer.support.AuthoringInfoClassBreakInfo")],gx);const vx=gx;var wx;let bx=wx=class extends Vd{constructor(t){super(t),this.field="",this.normalizationField="",this.label="",this.classBreakInfos=[]}clone(){return new wx({field:this.field,normalizationField:this.normalizationField,label:this.label,classBreakInfos:H(this.classBreakInfos)})}};e([oe({type:String,json:{write:!0}})],bx.prototype,"field",void 0),e([oe({type:String,json:{write:!0}})],bx.prototype,"normalizationField",void 0),e([oe({type:String,json:{write:!0}})],bx.prototype,"label",void 0),e([oe({type:[vx],json:{write:!0}})],bx.prototype,"classBreakInfos",void 0),bx=wx=e([si("esri.renderers.support.AuthoringInfoFieldInfo")],bx);const Mx=bx;var Sx;const xx=new ri({percentTotal:"percent-of-total",ratio:"ratio",percent:"percent"}),kx=new ri({sizeInfo:"size",colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation"}),Ix={key:t=>"number"==typeof t?"number":"string",typeMap:{number:Number,string:String},base:null},jx=["high-to-low","above-and-below","centered-on","extremes"],_x=[...new Set(["high-to-low","above-and-below","centered-on","extremes","90-10","above","below","high-to-low","above-and-below","90-10","above","below"])],Tx=["seconds","minutes","hours","days","months","years"];let Ox=Sx=class extends Vd{constructor(t){super(t),this.endTime=null,this.field=null,this.maxSliderValue=null,this.minSliderValue=null,this.startTime=null,this.type=null,this.units=null}castEndTime(t){return"string"==typeof t||"number"==typeof t?t:null}castStartTime(t){return"string"==typeof t||"number"==typeof t?t:null}get style(){return"color"===this.type?this._get("style"):null}set style(t){this._set("style",t)}get theme(){return"color"===this.type||"size"===this.type?this._get("theme")||"high-to-low":null}set theme(t){this._set("theme",t)}clone(){return new Sx({endTime:this.endTime,field:this.field,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,startTime:this.startTime,style:this.style,theme:this.theme,type:this.type,units:this.units})}};e([oe({types:Ix,json:{write:!0}})],Ox.prototype,"endTime",void 0),e([ba("endTime")],Ox.prototype,"castEndTime",null),e([oe({type:String,json:{write:!0}})],Ox.prototype,"field",void 0),e([oe({type:Number,json:{write:!0}})],Ox.prototype,"maxSliderValue",void 0),e([oe({type:Number,json:{write:!0}})],Ox.prototype,"minSliderValue",void 0),e([oe({types:Ix,json:{write:!0}})],Ox.prototype,"startTime",void 0),e([ba("startTime")],Ox.prototype,"castStartTime",null),e([oe({type:xx.apiValues,value:null,json:{type:xx.jsonValues,read:xx.read,write:xx.write}})],Ox.prototype,"style",null),e([oe({type:_x,value:null,json:{type:_x,origins:{"web-scene":{type:jx,write:{writer:(t,e)=>{jx.indexOf(t)>-1&&(e.theme=t)}}}},write:!0}})],Ox.prototype,"theme",null),e([oe({type:kx.apiValues,json:{type:kx.jsonValues,read:kx.read,write:kx.write}})],Ox.prototype,"type",void 0),e([oe({type:Tx,json:{type:Tx,write:!0}})],Ox.prototype,"units",void 0),Ox=Sx=e([si("esri.renderers.support.AuthoringInfoVisualVariable")],Ox);const Ax=Ox;let Fx=class extends Vd{constructor(t){super(t),this.type=null}};e([oe({readOnly:!0,json:{read:!1,write:!0}})],Fx.prototype,"type",void 0),Fx=e([si("esri.rest.support.ColorRamp")],Fx);const Cx=Fx;var Px;let Ex=Px=class extends Cx{constructor(t){super(t),this.algorithm=null,this.fromColor=null,this.toColor=null,this.type="algorithmic"}clone(){return new Px({fromColor:H(this.fromColor),toColor:H(this.toColor),algorithm:this.algorithm})}};e([Md({esriCIELabAlgorithm:"cie-lab",esriHSVAlgorithm:"hsv",esriLabLChAlgorithm:"lab-lch"})],Ex.prototype,"algorithm",void 0),e([oe({type:bd,json:{type:[Rt],write:!0}})],Ex.prototype,"fromColor",void 0),e([oe({type:bd,json:{type:[Rt],write:!0}})],Ex.prototype,"toColor",void 0),e([oe({type:["algorithmic"]})],Ex.prototype,"type",void 0),Ex=Px=e([si("esri.rest.support.AlgorithmicColorRamp")],Ex);const Rx=Ex;var Lx;let Nx=Lx=class extends Cx{constructor(t){super(t),this.colorRamps=null,this.type="multipart"}clone(){return new Lx({colorRamps:H(this.colorRamps)})}};e([oe({type:[Rx],json:{write:!0}})],Nx.prototype,"colorRamps",void 0),e([oe({type:["multipart"]})],Nx.prototype,"type",void 0),Nx=Lx=e([si("esri.rest.support.MultipartColorRamp")],Nx);const Dx=Nx,Vx={key:"type",base:Cx,typeMap:{algorithmic:Rx,multipart:Dx}};function $x(t){return t&&t.type?"algorithmic"===t.type?Rx.fromJSON(t):"multipart"===t.type?Dx.fromJSON(t):null:null}var zx;const Gx=new ri({esriClassifyDefinedInterval:"defined-interval",esriClassifyEqualInterval:"equal-interval",esriClassifyManual:"manual",esriClassifyNaturalBreaks:"natural-breaks",esriClassifyQuantile:"quantile",esriClassifyStandardDeviation:"standard-deviation"}),Ux=new ri({classedSize:"class-breaks-size",classedColor:"class-breaks-color",univariateColorSize:"univariate-color-size",relationship:"relationship",predominance:"predominance",dotDensity:"dot-density"}),qx=["inches","feet","yards","miles","nautical-miles","millimeters","centimeters","decimeters","meters","kilometers","decimal-degrees"];let Bx=zx=class extends Vd{constructor(t){super(t),this.colorRamp=null,this.lengthUnit=null,this.maxSliderValue=null,this.minSliderValue=null,this.visualVariables=null}get classificationMethod(){const t=this._get("classificationMethod"),e=this.type;return e&&"relationship"!==e?"class-breaks-size"===e||"class-breaks-color"===e?t||"manual":null:t}set classificationMethod(t){this._set("classificationMethod",t)}readColorRamp(t){if(t)return $x(t)}get fields(){return this.type&&"predominance"!==this.type?null:this._get("fields")}set fields(t){this._set("fields",t)}get field1(){return this.type&&"relationship"!==this.type?null:this._get("field1")}set field1(t){this._set("field1",t)}get field2(){return this.type&&"relationship"!==this.type?null:this._get("field2")}set field2(t){this._set("field2",t)}get focus(){return this.type&&"relationship"!==this.type?null:this._get("focus")}set focus(t){this._set("focus",t)}get numClasses(){return this.type&&"relationship"!==this.type?null:this._get("numClasses")}set numClasses(t){this._set("numClasses",t)}get statistics(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("statistics"):null}set statistics(t){this._set("statistics",t)}get standardDeviationInterval(){const t=this.type;return t&&"relationship"!==t&&"class-breaks-size"!==t&&"class-breaks-color"!==t||this.classificationMethod&&"standard-deviation"!==this.classificationMethod?null:this._get("standardDeviationInterval")}set standardDeviationInterval(t){this._set("standardDeviationInterval",t)}get type(){return this._get("type")}set type(t){let e=t;"classed-size"===t?e="class-breaks-size":"classed-color"===t&&(e="class-breaks-color"),this._set("type",e)}get univariateSymbolStyle(){return"univariate-color-size"===this.type&&"above-and-below"===this.univariateTheme?this._get("univariateSymbolStyle"):null}set univariateSymbolStyle(t){this._set("univariateSymbolStyle",t)}get univariateTheme(){return"univariate-color-size"===this.type?this._get("univariateTheme"):null}set univariateTheme(t){this._set("univariateTheme",t)}clone(){return new zx({classificationMethod:this.classificationMethod,colorRamp:H(this.colorRamp),fields:this.fields&&this.fields.slice(0),field1:H(this.field1),field2:H(this.field2),focus:this.focus,numClasses:this.numClasses,maxSliderValue:this.maxSliderValue,minSliderValue:this.minSliderValue,lengthUnit:this.lengthUnit,statistics:this.statistics,standardDeviationInterval:this.standardDeviationInterval,type:this.type,visualVariables:this.visualVariables&&this.visualVariables.map((t=>t.clone())),univariateSymbolStyle:this.univariateSymbolStyle,univariateTheme:this.univariateTheme})}};e([oe({type:Gx.apiValues,value:null,json:{type:Gx.jsonValues,read:Gx.read,write:Gx.write,origins:{"web-document":{default:"manual",type:Gx.jsonValues,read:Gx.read,write:Gx.write}}}})],Bx.prototype,"classificationMethod",null),e([oe({types:Vx,json:{write:!0}})],Bx.prototype,"colorRamp",void 0),e([Sd("colorRamp")],Bx.prototype,"readColorRamp",null),e([oe({type:[String],value:null,json:{write:!0}})],Bx.prototype,"fields",null),e([oe({type:Mx,value:null,json:{write:!0}})],Bx.prototype,"field1",null),e([oe({type:Mx,value:null,json:{write:!0}})],Bx.prototype,"field2",null),e([oe({type:["HH","HL","LH","LL"],value:null,json:{write:!0}})],Bx.prototype,"focus",null),e([oe({type:Number,value:null,json:{type:Rt,write:!0}})],Bx.prototype,"numClasses",null),e([oe({type:qx,json:{type:qx,read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],Bx.prototype,"lengthUnit",void 0),e([oe({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Bx.prototype,"maxSliderValue",void 0),e([oe({type:Number,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Bx.prototype,"minSliderValue",void 0),e([oe({type:Object,value:null,json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Bx.prototype,"statistics",null),e([oe({type:[.25,.33,.5,1],value:null,json:{type:[.25,.33,.5,1],write:!0}})],Bx.prototype,"standardDeviationInterval",null),e([oe({type:Ux.apiValues,value:null,json:{type:Ux.jsonValues,read:Ux.read,write:Ux.write}})],Bx.prototype,"type",null),e([oe({type:[Ax],json:{write:!0}})],Bx.prototype,"visualVariables",void 0),e([oe({type:["caret","circle-caret","arrow","circle-arrow","plus-minus","circle-plus-minus","square","circle","triangle","happy-sad","thumb","custom"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Bx.prototype,"univariateSymbolStyle",null),e([oe({type:["high-to-low","above-and-below","above","below","90-10"],value:null,json:{write:!0,origins:{"web-scene":{write:!1}}}})],Bx.prototype,"univariateTheme",null),Bx=zx=e([si("esri.renderers.support.AuthoringInfo")],Bx);const Wx=Bx,Hx=new ri({simple:"simple",uniqueValue:"unique-value",classBreaks:"class-breaks",heatmap:"heatmap",dotDensity:"dot-density",dictionary:"dictionary"},{ignoreUnknown:!0});let Jx=class extends Vd{constructor(t){super(t),this.authoringInfo=null,this.type=null}async getRequiredFields(t){if(!this.collectRequiredFields)return[];const e=new Set;return await this.collectRequiredFields(e,t),Array.from(e).sort()}getSymbol(t,e){}async getSymbolAsync(t,e){}getSymbols(){return[]}getAttributeHash(){return JSON.stringify(this)}getMeshHash(){return JSON.stringify(this)}};e([oe({type:Wx,json:{write:!0}})],Jx.prototype,"authoringInfo",void 0),e([oe({type:Hx.apiValues,readOnly:!0,json:{type:Hx.jsonValues,read:!1,write:{writer:Hx.write,ignoreOrigin:!0}}})],Jx.prototype,"type",void 0),Jx=e([si("esri.renderers.Renderer")],Jx);const Zx=Jx;var Qx;let Kx=Qx=class extends Vd{constructor(){super(...arguments),this.title=null}clone(){return new Qx({title:this.title})}};e([oe({type:String,json:{write:!0}})],Kx.prototype,"title",void 0),Kx=Qx=e([si("esri.renderers.support.LegendOptions")],Kx);const Yx=Kx;var Xx;let tk=Xx=class extends Yx{constructor(){super(...arguments),this.showLegend=null}clone(){return new Xx({title:this.title,showLegend:this.showLegend})}};e([oe({type:Boolean,json:{write:!0}})],tk.prototype,"showLegend",void 0),tk=Xx=e([si("esri.renderers.visualVariables.support.VisualVariableLegendOptions")],tk);const ek=tk,ik=ct.getLogger("esri.renderers.visualVariables.VisualVariable"),sk=new ri({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"});let nk=class extends Vd{constructor(t){super(t),this.index=null,this.type=null,this.field=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null}castField(t){return null==t?t:"function"==typeof t?(ik.error(".field: field must be a string value"),null):mt(t)}get arcadeRequired(){return!!this.valueExpression}clone(){}getAttributeHash(){return`${this.type}-${this.field}-${this.valueExpression}`}};e([oe()],nk.prototype,"index",void 0),e([oe({type:sk.apiValues,readOnly:!0,json:{read:sk.read,write:sk.write}})],nk.prototype,"type",void 0),e([oe({type:String,json:{write:!0}})],nk.prototype,"field",void 0),e([ba("field")],nk.prototype,"castField",null),e([oe({type:String,json:{write:!0}})],nk.prototype,"valueExpression",void 0),e([oe({type:String,json:{write:!0}})],nk.prototype,"valueExpressionTitle",void 0),e([oe({readOnly:!0})],nk.prototype,"arcadeRequired",null),e([oe({type:ek,json:{write:!0}})],nk.prototype,"legendOptions",void 0),nk=e([si("esri.renderers.visualVariables.VisualVariable")],nk);const rk=nk;var ok;let ak=ok=class extends Vd{constructor(t){super(t),this.color=null,this.label=null,this.value=null}writeValue(t,e,i){e[i]=null==t?0:t}clone(){return new ok({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};e([oe({type:bd,json:{type:[Rt],write:!0}})],ak.prototype,"color",void 0),e([oe({type:String,json:{write:!0}})],ak.prototype,"label",void 0),e([oe({type:Number,json:{write:{writerEnsuresNonNull:!0}}})],ak.prototype,"value",void 0),e([xd("value")],ak.prototype,"writeValue",null),ak=ok=e([si("esri.renderers.visualVariables.support.ColorStop")],ak);const lk=ak;var uk;let ck=uk=class extends rk{constructor(t){super(t),this.type="color",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)),this._set("stops",t)}clone(){return new uk({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};e([oe({readOnly:!0})],ck.prototype,"cache",null),e([oe({type:["color"],json:{type:["colorInfo"]}})],ck.prototype,"type",void 0),e([oe({type:String,json:{write:!0}})],ck.prototype,"normalizationField",void 0),e([oe({type:[lk],json:{write:!0}})],ck.prototype,"stops",null),ck=uk=e([si("esri.renderers.visualVariables.ColorVariable")],ck);const hk=ck;var dk;let pk=dk=class extends Vd{constructor(t){super(t),this.label=null,this.opacity=null,this.value=null}readOpacity(t,e){return mm(e.transparency)}writeOpacity(t,e,i){e[i]=ym(t)}clone(){return new dk({label:this.label,opacity:this.opacity,value:this.value})}};e([oe({type:String,json:{write:!0}})],pk.prototype,"label",void 0),e([oe({type:Number,json:{type:Rt,write:{target:"transparency"}}})],pk.prototype,"opacity",void 0),e([Sd("opacity",["transparency"])],pk.prototype,"readOpacity",null),e([xd("opacity")],pk.prototype,"writeOpacity",null),e([oe({type:Number,json:{write:!0}})],pk.prototype,"value",void 0),pk=dk=e([si("esri.renderers.visualVariables.support.OpacityStop")],pk);const fk=pk;var yk;let mk=yk=class extends rk{constructor(t){super(t),this.type="opacity",this.normalizationField=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null}}set stops(t){t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)),this._set("stops",t)}clone(){return new yk({field:this.field,normalizationField:this.normalizationField,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,stops:this.stops&&this.stops.map((t=>t.clone())),legendOptions:this.legendOptions&&this.legendOptions.clone()})}getAttributeHash(){return`${super.getAttributeHash()}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};e([oe({readOnly:!0})],mk.prototype,"cache",null),e([oe({type:["opacity"],json:{type:["transparencyInfo"]}})],mk.prototype,"type",void 0),e([oe({type:String,json:{write:!0}})],mk.prototype,"normalizationField",void 0),e([oe({type:[fk],json:{write:!0}})],mk.prototype,"stops",null),mk=yk=e([si("esri.renderers.visualVariables.OpacityVariable")],mk);const gk=mk;var vk;let wk=vk=class extends rk{constructor(t){super(t),this.axis=null,this.type="rotation",this.rotationType="geographic",this.valueExpressionTitle=null}get cache(){return{hasExpression:!!this.valueExpression,compiledFunc:null}}writeValueExpressionTitleWebScene(t,e,i,s){s&&s.messages&&s.messages.push(new Ve("property:unsupported",this.type+"VisualVariable.valueExpressionTitle is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:`visualVariables[${this.index}].valueExpressionTitle`,context:s}))}clone(){return new vk({axis:this.axis,rotationType:this.rotationType,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,legendOptions:this.legendOptions&&this.legendOptions.clone()})}};e([oe({readOnly:!0})],wk.prototype,"cache",null),e([oe({type:["heading","tilt","roll"],json:{origins:{"web-scene":{default:"heading",write:!0}}}})],wk.prototype,"axis",void 0),e([oe({type:["rotation"],json:{type:["rotationInfo"]}})],wk.prototype,"type",void 0),e([oe({type:["geographic","arithmetic"],json:{write:!0,origins:{"web-document":{write:!0,default:"geographic"}}}})],wk.prototype,"rotationType",void 0),e([oe({type:String,json:{write:!0}})],wk.prototype,"valueExpressionTitle",void 0),e([xd("web-scene","valueExpressionTitle")],wk.prototype,"writeValueExpressionTitleWebScene",null),wk=vk=e([si("esri.renderers.visualVariables.RotationVariable")],wk);const bk=wk;var Mk;let Sk=Mk=class extends Vd{constructor(t){super(t),this.label=null,this.size=null,this.value=null}clone(){return new Mk({label:this.label,size:this.size,value:this.value})}};e([oe({type:String,json:{write:!0}})],Sk.prototype,"label",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],Sk.prototype,"size",void 0),e([oe({type:Number,json:{write:!0}})],Sk.prototype,"value",void 0),Sk=Mk=e([si("esri.renderers.visualVariables.support.SizeStop")],Sk);const xk=Sk;var kk;let Ik=kk=class extends ek{constructor(){super(...arguments),this.customValues=null}clone(){return new kk({title:this.title,showLegend:this.showLegend,customValues:this.customValues&&this.customValues.slice(0)})}};e([oe({type:[Number],json:{write:!0}})],Ik.prototype,"customValues",void 0),Ik=kk=e([si("esri.renderers.visualVariables.support.SizeVariableLegendOptions")],Ik);const jk=Ik;function _k(t){return t&&"esri.renderers.visualVariables.SizeVariable"===t.declaredClass}function Tk(t){return null!=t&&!isNaN(t)&&isFinite(t)}function Ok(t){return t.valueExpression?"expression":t.field&&"string"==typeof t.field?"field":"unknown"}let Ak=class extends Vd{constructor(t){super(t),this.type=null}};e([oe({type:["attachments","custom","fields","media","text"],readOnly:!0,json:{read:!1,write:!0}})],Ak.prototype,"type",void 0),Ak=e([si("esri.popup.content.Content")],Ak);const Fk=Ak;var Ck;let Pk=Ck=class extends Fk{constructor(t){super(t),this.description=null,this.displayType=null,this.title=null,this.type="attachments"}clone(){return new Ck({description:this.description,displayType:this.displayType,title:this.title})}};e([oe({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Pk.prototype,"description",void 0),e([oe({type:["auto","preview","list"],json:{write:!0}})],Pk.prototype,"displayType",void 0),e([oe({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Pk.prototype,"title",void 0),e([oe({type:["attachments"],readOnly:!0,json:{read:!1,write:!0}})],Pk.prototype,"type",void 0),Pk=Ck=e([si("esri.popup.content.AttachmentsContent")],Pk);const Ek=Pk;var Rk;let Lk=Rk=class extends Fk{constructor(t){super(t),this.creator=null,this.destroyer=null,this.outFields=null,this.type="custom"}clone(){return new Rk({creator:this.creator,destroyer:this.destroyer,outFields:Array.isArray(this.outFields)?H(this.outFields):null})}};e([oe()],Lk.prototype,"creator",void 0),e([oe()],Lk.prototype,"destroyer",void 0),e([oe()],Lk.prototype,"outFields",void 0),e([oe({type:["custom"],readOnly:!0})],Lk.prototype,"type",void 0),Lk=Rk=e([si("esri.popup.content.CustomContent")],Lk);const Nk=Lk,Dk=oi()({shortDate:"short-date",shortDateShortTime:"short-date-short-time",shortDateShortTime24:"short-date-short-time-24",shortDateLongTime:"short-date-long-time",shortDateLongTime24:"short-date-long-time-24",shortDateLE:"short-date-le",shortDateLEShortTime:"short-date-le-short-time",shortDateLEShortTime24:"short-date-le-short-time-24",shortDateLELongTime:"short-date-le-long-time",shortDateLELongTime24:"short-date-le-long-time-24",longMonthDayYear:"long-month-day-year",longMonthDayYearShortTime:"long-month-day-year-short-time",longMonthDayYearShortTime24:"long-month-day-year-short-time-24",longMonthDayYearLongTime:"long-month-day-year-long-time",longMonthDayYearLongTime24:"long-month-day-year-long-time-24",dayShortMonthYear:"day-short-month-year",dayShortMonthYearShortTime:"day-short-month-year-short-time",dayShortMonthYearShortTime24:"day-short-month-year-short-time-24",dayShortMonthYearLongTime:"day-short-month-year-long-time",dayShortMonthYearLongTime24:"day-short-month-year-long-time-24",longDate:"long-date",longDateShortTime:"long-date-short-time",longDateShortTime24:"long-date-short-time-24",longDateLongTime:"long-date-long-time",longDateLongTime24:"long-date-long-time-24",longMonthYear:"long-month-year",shortMonthYear:"short-month-year",year:"year"});var Vk;Dk.toJSON.bind(Dk),Dk.fromJSON.bind(Dk);let $k=Vk=class extends Vd{constructor(t){super(t),this.dateFormat=null,this.dateTimeFormatOptions=null,this.digitSeparator=!1,this.places=null}clone(){return new Vk({dateFormat:this.dateFormat,digitSeparator:this.digitSeparator,places:this.places})}format(t){return this.dateFormat?Ai(t,{...Oi(this.dateFormat),...this.dateTimeFormatOptions}):Ri(t,Ei(this))}};e([Md(Dk)],$k.prototype,"dateFormat",void 0),e([oe({type:Object,json:{read:!1}})],$k.prototype,"dateTimeFormatOptions",void 0),e([oe({type:Boolean,json:{write:!0}})],$k.prototype,"digitSeparator",void 0),e([oe({type:Rt,json:{write:!0}})],$k.prototype,"places",void 0),$k=Vk=e([si("esri.popup.support.FieldInfoFormat")],$k);const zk=$k;var Gk;let Uk=Gk=class extends Vd{constructor(t){super(t),this.fieldName=null,this.format=null,this.isEditable=!1,this.label=null,this.stringFieldOption="text-box",this.statisticType=null,this.tooltip=null,this.visible=!0}clone(){return new Gk({fieldName:this.fieldName,format:this.format?H(this.format):null,isEditable:this.isEditable,label:this.label,stringFieldOption:this.stringFieldOption,statisticType:this.statisticType,tooltip:this.tooltip,visible:this.visible})}};e([oe({type:String,json:{write:!0}})],Uk.prototype,"fieldName",void 0),e([oe({type:zk,json:{write:!0}})],Uk.prototype,"format",void 0),e([oe({type:Boolean,json:{write:!0,default:!1}})],Uk.prototype,"isEditable",void 0),e([oe({type:String,json:{write:!0}})],Uk.prototype,"label",void 0),e([Md(new ri({richtext:"rich-text",textarea:"text-area",textbox:"text-box"}),{default:"text-box"})],Uk.prototype,"stringFieldOption",void 0),e([oe({type:["count","sum","min","max","avg","stddev","var"],json:{write:!0}})],Uk.prototype,"statisticType",void 0),e([oe({type:String,json:{write:!0}})],Uk.prototype,"tooltip",void 0),e([oe({type:Boolean,json:{write:!0}})],Uk.prototype,"visible",void 0),Uk=Gk=e([si("esri.popup.FieldInfo")],Uk);const qk=Uk;var Bk;let Wk=Bk=class extends Fk{constructor(t){super(t),this.description=null,this.fieldInfos=null,this.title=null,this.type="fields"}writeFieldInfos(t,e){e.fieldInfos=t&&t.map((t=>t.toJSON()))}clone(){return new Bk({description:this.description,fieldInfos:Array.isArray(this.fieldInfos)?H(this.fieldInfos):null,title:this.title})}};e([oe({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Wk.prototype,"description",void 0),e([oe({type:[qk]})],Wk.prototype,"fieldInfos",void 0),e([xd("fieldInfos")],Wk.prototype,"writeFieldInfos",null),e([oe({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],Wk.prototype,"title",void 0),e([oe({type:["fields"],readOnly:!0,json:{read:!1,write:!0}})],Wk.prototype,"type",void 0),Wk=Bk=e([si("esri.popup.content.FieldsContent")],Wk);const Hk=Wk;let Jk=class extends Vd{constructor(t){super(t),this.altText=null,this.caption="",this.title="",this.type=null}};e([oe({type:String,json:{write:!0}})],Jk.prototype,"altText",void 0),e([oe({type:String,json:{write:!0}})],Jk.prototype,"caption",void 0),e([oe({type:String,json:{write:!0}})],Jk.prototype,"title",void 0),e([oe({type:["image","bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],Jk.prototype,"type",void 0),Jk=e([si("esri.popup.content.mixins.MediaInfo")],Jk);const Zk=Jk;var Qk;let Kk=Qk=class extends jo{constructor(t){super(t),this.tooltip=null,this.value=null}clone(){return new Qk({tooltip:this.tooltip,value:this.value})}};e([oe()],Kk.prototype,"tooltip",void 0),e([oe()],Kk.prototype,"value",void 0),Kk=Qk=e([si("esri.popup.content.support.ChartMediaInfoValueSeries")],Kk);const Yk=Kk;var Xk;let tI=Xk=class extends Vd{constructor(t){super(t),this.fields=[],this.normalizeField=null,this.series=[],this.tooltipField=null}clone(){return new Xk({fields:H(this.fields),normalizeField:this.normalizeField,tooltipField:this.tooltipField})}};e([oe({type:[String],json:{write:!0}})],tI.prototype,"fields",void 0),e([oe({type:String,json:{write:!0}})],tI.prototype,"normalizeField",void 0),e([oe({type:[Yk],json:{read:!1}})],tI.prototype,"series",void 0),e([oe({type:String,json:{write:!0}})],tI.prototype,"tooltipField",void 0),tI=Xk=e([si("esri.popup.content.support.ChartMediaInfoValue")],tI);const eI=tI;let iI=class extends Zk{constructor(t){super(t),this.type=null,this.value=null}};e([oe({type:["bar-chart","column-chart","line-chart","pie-chart"],readOnly:!0,json:{read:!1,write:!0}})],iI.prototype,"type",void 0),e([oe({type:eI,json:{write:!0}})],iI.prototype,"value",void 0),iI=e([si("esri.popup.content.mixins.ChartMediaInfo")],iI);const sI=iI,nI=oi()({barchart:"bar-chart",columnchart:"column-chart",linechart:"line-chart",piechart:"pie-chart"});var rI;let oI=rI=class extends sI{constructor(t){super(t),this.type="bar-chart"}clone(){return new rI({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};e([oe({type:["bar-chart"],readOnly:!0,json:{type:["barchart"],read:!1,write:nI.write}})],oI.prototype,"type",void 0),oI=rI=e([si("esri.popup.content.BarChartMediaInfo")],oI);const aI=oI;var lI;let uI=lI=class extends sI{constructor(t){super(t),this.type="column-chart"}clone(){return new lI({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};e([oe({type:["column-chart"],readOnly:!0,json:{type:["columnchart"],read:!1,write:nI.write}})],uI.prototype,"type",void 0),uI=lI=e([si("esri.popup.content.ColumnChartMediaInfo")],uI);const cI=uI;var hI;let dI=hI=class extends Vd{constructor(t){super(t),this.linkURL=null,this.sourceURL=null}clone(){return new hI({linkURL:this.linkURL,sourceURL:this.sourceURL})}};e([oe({type:String,json:{write:!0}})],dI.prototype,"linkURL",void 0),e([oe({type:String,json:{write:!0}})],dI.prototype,"sourceURL",void 0),dI=hI=e([si("esri.popup.content.support.ImageMediaInfoValue")],dI);const pI=dI;var fI;let yI=fI=class extends Zk{constructor(t){super(t),this.refreshInterval=null,this.type="image",this.value=null}clone(){return new fI({altText:this.altText,title:this.title,caption:this.caption,refreshInterval:this.refreshInterval,value:this.value?this.value.clone():null})}};e([oe({type:Number,json:{write:!0}})],yI.prototype,"refreshInterval",void 0),e([oe({type:["image"],readOnly:!0,json:{read:!1,write:!0}})],yI.prototype,"type",void 0),e([oe({type:pI,json:{write:!0}})],yI.prototype,"value",void 0),yI=fI=e([si("esri.popup.content.ImageMediaInfo")],yI);const mI=yI;var gI;let vI=gI=class extends sI{constructor(t){super(t),this.type="line-chart"}clone(){return new gI({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};e([oe({type:["line-chart"],readOnly:!0,json:{type:["linechart"],read:!1,write:nI.write}})],vI.prototype,"type",void 0),vI=gI=e([si("esri.popup.content.LineChartMediaInfo")],vI);const wI=vI;var bI;let MI=bI=class extends sI{constructor(t){super(t),this.type="pie-chart"}clone(){return new bI({altText:this.altText,title:this.title,caption:this.caption,value:this.value?this.value.clone():null})}};e([oe({type:["pie-chart"],readOnly:!0,json:{type:["piechart"],read:!1,write:nI.write}})],MI.prototype,"type",void 0),MI=bI=e([si("esri.popup.content.PieChartMediaInfo")],MI);const SI=MI,xI={base:Zk,key:"type",defaultKeyValue:"image",typeMap:{"bar-chart":aI,"column-chart":cI,"line-chart":wI,"pie-chart":SI,image:mI}};var kI;let II=kI=class extends Fk{constructor(t){super(t),this.activeMediaInfoIndex=null,this.description=null,this.mediaInfos=null,this.title=null,this.type="media"}readMediaInfos(t){return t&&t.map((t=>"image"===t.type?mI.fromJSON(t):"barchart"===t.type?aI.fromJSON(t):"columnchart"===t.type?cI.fromJSON(t):"linechart"===t.type?wI.fromJSON(t):"piechart"===t.type?SI.fromJSON(t):void 0)).filter(Boolean)}writeMediaInfos(t,e){e.mediaInfos=t&&t.map((t=>t.toJSON()))}clone(){return new kI({activeMediaInfoIndex:this.activeMediaInfoIndex,description:this.description,mediaInfos:this.mediaInfos?H(this.mediaInfos):null,title:this.title})}};e([oe()],II.prototype,"activeMediaInfoIndex",void 0),e([oe({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],II.prototype,"description",void 0),e([oe({types:[xI]})],II.prototype,"mediaInfos",void 0),e([Sd("mediaInfos")],II.prototype,"readMediaInfos",null),e([xd("mediaInfos")],II.prototype,"writeMediaInfos",null),e([oe({json:{write:!0,origins:{"web-scene":{write:!1,read:!1}}}})],II.prototype,"title",void 0),e([oe({type:["media"],readOnly:!0,json:{read:!1,write:!0}})],II.prototype,"type",void 0),II=kI=e([si("esri.popup.content.MediaContent")],II);const jI=II;var _I;let TI=_I=class extends Fk{constructor(t){super(t),this.text=null,this.type="text"}clone(){return new _I({text:this.text})}};e([oe({type:String,json:{write:!0}})],TI.prototype,"text",void 0),e([oe({type:["text"],readOnly:!0,json:{read:!1,write:!0}})],TI.prototype,"type",void 0),TI=_I=e([si("esri.popup.content.TextContent")],TI);const OI=TI,AI={base:null,key:"type",typeMap:{attachment:Ek,media:jI,text:OI,field:Hk}};var FI;let CI=FI=class extends Vd{constructor(t){super(t),this.name=null,this.title=null,this.expression=null,this.returnType=null}clone(){return new FI({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};e([oe({type:String,json:{write:!0}})],CI.prototype,"name",void 0),e([oe({type:String,json:{write:!0}})],CI.prototype,"title",void 0),e([oe({type:String,json:{write:!0}})],CI.prototype,"expression",void 0),e([oe({type:["string","number"],json:{write:!0}})],CI.prototype,"returnType",void 0),CI=FI=e([si("esri.popup.ExpressionInfo")],CI);const PI=CI;var EI;let RI=EI=class extends Vd{constructor(t){super(t),this.returnTopmostRaster=null,this.showNoDataRecords=null}clone(){return new EI({showNoDataRecords:this.showNoDataRecords,returnTopmostRaster:this.returnTopmostRaster})}};e([oe({type:Boolean,json:{write:!0}})],RI.prototype,"returnTopmostRaster",void 0),e([oe({type:Boolean,json:{write:!0}})],RI.prototype,"showNoDataRecords",void 0),RI=EI=e([si("esri.popup.LayerOptions")],RI);const LI=RI;var NI;let DI=NI=class extends Vd{constructor(t){super(t),this.field=null,this.order=null}clone(){return new NI({field:this.field,order:this.order})}};e([oe({type:String,json:{write:!0}})],DI.prototype,"field",void 0),e([oe({type:["asc","desc"],json:{write:!0}})],DI.prototype,"order",void 0),DI=NI=e([si("esri.popup.support.RelatedRecordsInfoFieldOrder")],DI);const VI=DI;var $I;let zI=$I=class extends Vd{constructor(t){super(t),this.showRelatedRecords=null,this.orderByFields=null}clone(){return new $I({showRelatedRecords:this.showRelatedRecords,orderByFields:this.orderByFields?H(this.orderByFields):null})}};e([oe({type:Boolean,json:{write:!0}})],zI.prototype,"showRelatedRecords",void 0),e([oe({type:[VI],json:{write:!0}})],zI.prototype,"orderByFields",void 0),zI=$I=e([si("esri.popup.RelatedRecordsInfo")],zI);const GI=zI;let UI=0;const qI=t=>{let i=class extends t{constructor(...t){super(...t),Object.defineProperty(this,"uid",{writable:!1,configurable:!1,value:Date.now().toString(16)+"-object-"+UI++})}};return i=e([si("esri.core.Identifiable")],i),i};let BI=class extends(qI(class{})){};var WI;BI=e([si("esri.core.Identifiable")],BI);let HI=WI=class extends(qI(jo)){constructor(t){super(t),this.active=!1,this.className=null,this.disabled=!1,this.id=null,this.indicator=!1,this.title=null,this.type=null,this.visible=!0}clone(){return new WI({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible})}};e([oe()],HI.prototype,"active",void 0),e([oe()],HI.prototype,"className",void 0),e([oe()],HI.prototype,"disabled",void 0),e([oe()],HI.prototype,"id",void 0),e([oe()],HI.prototype,"indicator",void 0),e([oe()],HI.prototype,"title",void 0),e([oe()],HI.prototype,"type",void 0),e([oe()],HI.prototype,"visible",void 0),HI=WI=e([si("esri.support.actions.ActionBase")],HI);const JI=HI;var ZI;let QI=ZI=class extends JI{constructor(t){super(t),this.image=null,this.type="button"}clone(){return new ZI({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image})}};e([oe()],QI.prototype,"image",void 0),QI=ZI=e([si("esri.support.Action.ActionButton")],QI);const KI=QI;var YI;let XI=YI=class extends JI{constructor(t){super(t),this.image=null,this.type="toggle",this.value=!1}clone(){return new YI({active:this.active,className:this.className,disabled:this.disabled,id:this.id,indicator:this.indicator,title:this.title,visible:this.visible,image:this.image,value:this.value})}};e([oe()],XI.prototype,"image",void 0),e([oe()],XI.prototype,"value",void 0),XI=YI=e([si("esri.support.Action.ActionToggle")],XI);const tj=XI;var ej;const ij=qo.ofType({key:"type",defaultKeyValue:"button",base:JI,typeMap:{button:KI,toggle:tj}}),sj={base:Fk,key:"type",typeMap:{media:jI,custom:Nk,text:OI,attachments:Ek,fields:Hk}},nj="esri.PopupTemplate",rj=ct.getLogger(nj),oj=["attachments","fields","media","text"];let aj=ej=class extends Vd{constructor(){super(...arguments),this.actions=null,this.content="",this.expressionInfos=null,this.fieldInfos=null,this.layerOptions=null,this.lastEditInfoEnabled=!0,this.outFields=null,this.overwriteActions=!1,this.returnGeometry=!1,this.title="",this.relatedRecordsInfo=null}castContent(t){return Array.isArray(t)?t.map((t=>Et(sj,t))):"string"==typeof t||"function"==typeof t||t instanceof HTMLElement||cs(t)?t:(rj.error("content error","unsupported content value",{value:t}),null)}readContent(t,e){const{popupElements:i}=e;return Array.isArray(i)&&i.length>0?this._readPopupInfoElements(e):this._readPopupInfo(e)}writeContent(t,e,i,s){"string"!=typeof t?Array.isArray(t)&&(e.popupElements=t.filter((t=>-1!==oj.indexOf(t.type))).map((t=>t&&t.toJSON(s))),e.popupElements.forEach((t=>{"attachments"===t.type?this._writeAttachmentContent(e):"media"===t.type?this._writeMediaContent(t,e):"text"===t.type&&this._writeTextContent(t,e)}))):e.description=t}writeFieldInfos(t,e,i,s){const{content:n}=this,r=Array.isArray(n)?n:null;if(t){const i=r?r.filter((t=>"fields"===t.type)):[],n=i.length&&i.every((t=>{var e;return null==(e=t.fieldInfos)?void 0:e.length}));e.fieldInfos=t.filter(Boolean).map((t=>{const e=t.toJSON(s);return n&&(e.visible=!1),e}))}if(r)for(const t of r)"fields"===t.type&&this._writeFieldsContent(t,e)}writeLayerOptions(t,e,i,s){e[i]=!t||null===t.showNoDataRecords&&null===t.returnTopmostRaster?null:t.toJSON(s)}writeTitle(t,e){e.title=t||""}clone(){const{actions:t}=this,e=t?H(t.toArray()):[];return new ej({actions:e,content:Array.isArray(this.content)?H(this.content):this.content,expressionInfos:Array.isArray(this.expressionInfos)?H(this.expressionInfos):null,fieldInfos:Array.isArray(this.fieldInfos)?H(this.fieldInfos):null,layerOptions:this.layerOptions?H(this.layerOptions):null,lastEditInfoEnabled:this.lastEditInfoEnabled,outFields:Array.isArray(this.outFields)?H(this.outFields):null,overwriteActions:this.overwriteActions,returnGeometry:this.returnGeometry,title:this.title,relatedRecordsInfo:this.relatedRecordsInfo?H(this.relatedRecordsInfo):null})}async collectRequiredFields(t,e){await this._collectExpressionInfoFields(t,e,this.expressionInfos),vy(t,e,[...this.outFields||[],...this._getActionsFields(this.actions),...this._getTitleFields(this.title),...this._getContentFields(this.content)])}async getRequiredFields(t){const e=new Set;return await this.collectRequiredFields(e,t),[...e].sort()}_writeFieldsContent(t,e){if(!Array.isArray(t.fieldInfos)||!t.fieldInfos.length)return;const i=H(t.fieldInfos);Array.isArray(e.fieldInfos)?i.forEach((t=>{const i=e.fieldInfos.find((e=>e.fieldName.toLowerCase()===t.fieldName.toLowerCase()));i?i.visible=!0:e.fieldInfos.push(t)})):e.fieldInfos=i}_writeAttachmentContent(t){t.showAttachments||(t.showAttachments=!0)}_writeTextContent(t,e){!e.description&&t.text&&(e.description=t.text)}_writeMediaContent(t,e){if(!Array.isArray(t.mediaInfos)||!t.mediaInfos.length)return;const i=H(t.mediaInfos);e.mediaInfos=Array.isArray(e.mediaInfos)?[...e.mediaInfos,...i]:i}_readPopupInfoElements({description:t,mediaInfos:e,popupElements:i}){const s={description:!1,mediaInfos:!1};return i.map((i=>"media"===i.type?(i.mediaInfos||!e||s.mediaInfos||(i.mediaInfos=e,s.mediaInfos=!0),jI.fromJSON(i)):"text"===i.type?(i.text||!t||s.description||(i.text=t,s.description=!0),OI.fromJSON(i)):"attachments"===i.type?Ek.fromJSON(i):"fields"===i.type?Hk.fromJSON(i):void 0)).filter(Boolean)}_readPopupInfo({description:t,mediaInfos:e,showAttachments:i}){const s=[];return s.push(t?new OI({text:t}):new Hk),Array.isArray(e)&&e.length&&s.push(jI.fromJSON({mediaInfos:e})),i&&s.push(Ek.fromJSON({displayType:"auto"})),s.length?s:t}_getContentElementFields(t){return t&&"attachments"!==t.type?"custom"===t.type?t.outFields||[]:"fields"===t.type?this._getFieldInfoFields(t.fieldInfos||this.fieldInfos):"media"===t.type?(t.mediaInfos||[]).reduce(((t,e)=>[...t,...this._getMediaInfoFields(e)]),[]):"text"===t.type?this._extractFieldNames(t.text):void 0:[]}_getMediaInfoFields(t){const{caption:e,title:i,value:s}=t,n=s||{},{fields:r=[],normalizeField:o,tooltipField:a,sourceURL:l,linkURL:u}=n,c=[...this._extractFieldNames(i),...this._extractFieldNames(e),...this._extractFieldNames(l),...this._extractFieldNames(u),...r];return o&&c.push(o),a&&c.push(a),c}_getContentFields(t){return"string"==typeof t?this._extractFieldNames(t):Array.isArray(t)?t.reduce(((t,e)=>[...t,...this._getContentElementFields(e)]),[]):[]}async _collectExpressionInfoFields(t,e,i){i&&await Promise.all(i.map((i=>My(t,e,i.expression))))}_getFieldInfoFields(t){return t?t.filter((t=>void 0===t.visible||!!t.visible)).map((t=>t.fieldName)).filter((t=>-1===t.indexOf("relationships/")&&-1===t.indexOf("expression/"))):[]}_getActionsFields(t){return t?t.toArray().reduce(((t,e)=>[...t,...this._getActionFields(e)]),[]):[]}_getActionFields(t){const{className:e,title:i,type:s}=t,n="button"===s||"toggle"===s?t.image:"";return[...this._extractFieldNames(i),...this._extractFieldNames(e),...this._extractFieldNames(n)]}_getTitleFields(t){return"string"==typeof t?this._extractFieldNames(t):[]}_extractFieldNames(t){if(!t||"string"!=typeof t)return[];const e=t.match(/{[^}]*}/g);if(!e)return[];const i=/\{(\w+):.+\}/,s=e.filter((t=>!(0===t.indexOf("{relationships/")||0===t.indexOf("{expression/")))).map((t=>t.replace(i,"{$1}")));return s?s.map((t=>t.slice(1,-1))):[]}};e([oe({type:ij})],aj.prototype,"actions",void 0),e([oe()],aj.prototype,"content",void 0),e([ba("content")],aj.prototype,"castContent",null),e([Sd("content",["description","fieldInfos","popupElements","mediaInfos","showAttachments"])],aj.prototype,"readContent",null),e([xd("content",{popupElements:{type:qo.ofType(AI)},showAttachments:{type:Boolean},mediaInfos:{type:qo.ofType(xI)},description:{type:String}})],aj.prototype,"writeContent",null),e([oe({type:[PI],json:{write:!0}})],aj.prototype,"expressionInfos",void 0),e([oe({type:[qk]})],aj.prototype,"fieldInfos",void 0),e([xd("fieldInfos")],aj.prototype,"writeFieldInfos",null),e([oe({type:LI})],aj.prototype,"layerOptions",void 0),e([xd("layerOptions")],aj.prototype,"writeLayerOptions",null),e([oe({type:Boolean,json:{read:{source:"showLastEditInfo"},write:{target:"showLastEditInfo"},default:!0}})],aj.prototype,"lastEditInfoEnabled",void 0),e([oe()],aj.prototype,"outFields",void 0),e([oe()],aj.prototype,"overwriteActions",void 0),e([oe()],aj.prototype,"returnGeometry",void 0),e([oe({json:{type:String}})],aj.prototype,"title",void 0),e([xd("title")],aj.prototype,"writeTitle",null),e([oe({type:GI,json:{write:!0}})],aj.prototype,"relatedRecordsInfo",void 0),aj=ej=e([si(nj)],aj);const lj=aj;var uj;let cj=uj=class extends Vd{constructor(...t){super(...t),this.isAggregate=!1,this.layer=null,this.popupTemplate=null,this.sourceLayer=null,Object.defineProperty(this,"uid",{value:oo(),configurable:!0})}normalizeCtorArgs(t,e,i,s){return t&&!t.declaredClass?t:{geometry:t,symbol:e,attributes:i,popupTemplate:s}}set attributes(t){const e=this._get("attributes");e!==t&&(this._set("attributes",t),this._notifyLayer("attributes",e,t))}set geometry(t){const e=this._get("geometry");e!==t&&(this._set("geometry",t),this._notifyLayer("geometry",e,t))}set symbol(t){const e=this._get("symbol");e!==t&&(this._set("symbol",t),this._notifyLayer("symbol",e,t))}set visible(t){const e=this._get("visible");e!==t&&(this._set("visible",t),this._notifyLayer("visible",e,t))}getEffectivePopupTemplate(t=!1){if(this.popupTemplate)return this.popupTemplate;for(const e of[this.sourceLayer,this.layer])if(e){if("popupTemplate"in e&&e.popupTemplate)return e.popupTemplate;if(t&&"defaultPopupTemplate"in e&&u(e.defaultPopupTemplate))return e.defaultPopupTemplate}return null}getAttribute(t){return this.attributes&&this.attributes[t]}setAttribute(t,e){if(this.attributes){const i=this.getAttribute(t);this.attributes[t]=e,this._notifyLayer("attributes",i,e,t)}else this.attributes={[t]:e},this._notifyLayer("attributes",void 0,e,t)}getObjectId(){return this.sourceLayer&&"objectIdField"in this.sourceLayer&&this.sourceLayer.objectIdField?this.getAttribute(this.sourceLayer.objectIdField):null}toJSON(){return{geometry:u(this.geometry)?this.geometry.toJSON():null,symbol:u(this.symbol)?this.symbol.toJSON():null,attributes:{...this.attributes},popupTemplate:this.popupTemplate&&this.popupTemplate.toJSON()}}clone(){return new uj(this.cloneProperties())}notifyGeometryChanged(){this._notifyLayer("geometry",this.geometry,this.geometry)}cloneProperties(){return{attributes:H(this.attributes),geometry:H(this.geometry),layer:this.layer,popupTemplate:this.popupTemplate&&this.popupTemplate.clone(),sourceLayer:this.sourceLayer,symbol:H(this.symbol),visible:this.visible}}_notifyLayer(t,e,i,s){if(!this.layer||!("graphicChanged"in this.layer))return;const n={graphic:this,property:t,oldValue:e,newValue:i};"attributes"===t&&(n.attributeName=s),this.layer.graphicChanged(n)}};e([oe({value:null})],cj.prototype,"attributes",null),e([oe({value:null,types:ry,json:{read:ey}})],cj.prototype,"geometry",null),e([oe({type:Boolean})],cj.prototype,"isAggregate",void 0),e([oe()],cj.prototype,"layer",void 0),e([oe({type:lj})],cj.prototype,"popupTemplate",void 0),e([oe()],cj.prototype,"sourceLayer",void 0),e([oe({value:null,types:qb})],cj.prototype,"symbol",null),e([oe({type:Boolean,value:!0})],cj.prototype,"visible",null),cj=uj=e([si("esri.Graphic")],cj),(cj||(cj={})).generateUID=oo;const hj=cj;function dj(){}const pj=ct.getLogger("esri.renderers.visualVariables.support.visualVariableUtils"),fj=new hj,yj=Math.PI,mj=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i;function gj(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.filter((t=>"color"===t.type))[0]:t;if(!s)return;if("esri.renderers.visualVariables.ColorVariable"!==s.declaredClass)return void pj.warn("The visualVariable should be an instance of esri.renderers.visualVariables.ColorVariable");const n="number"==typeof e,r=n?null:e,o=r&&r.attributes;let a=n?e:null;const l=s.field,{ipData:c,hasExpression:h}=s.cache;let d=s.cache.compiledFunc;if(!l&&!h){const t=s.stops;return t&&t[0]&&t[0].color}if("number"!=typeof a)if(h){if(!u(i)||!u(i.arcade))return void pj.error("Use of arcade expressions requires an arcade context");const t=i.arcade.arcadeUtils,e=t.getViewInfo({viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}),n=t.createExecContext(r,e);if(!d){const e=t.createSyntaxTree(s.valueExpression);d=t.createFunction(e),s.cache.compiledFunc=d}a=t.executeFunction(d,n)}else o&&(a=o[l]);const p=s.normalizationField,f=o?parseFloat(o[p]):void 0;if(null!=a&&(!p||n||!isNaN(f)&&0!==f)){isNaN(f)||n||(a/=f);const t=Ij(a,c);if(t){const e=t[0],n=t[1],r=e===n?s.stops[e].color:bd.blendColors(s.stops[e].color,s.stops[n].color,t[2],u(i)?i.color:void 0);return new bd(r)}}}function vj(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.filter((t=>"opacity"===t.type))[0]:t;if(!s)return;if("esri.renderers.visualVariables.OpacityVariable"!==s.declaredClass)return void pj.warn("The visualVariable should be an instance of esri.renderers.visualVariables.OpacityVariable");const n="number"==typeof e,r=n?null:e,o=r&&r.attributes;let a=n?e:null;const l=s.field,{ipData:u,hasExpression:h}=s.cache;let d=s.cache.compiledFunc;if(!l&&!h){const t=s.stops;return t&&t[0]&&t[0].opacity}if("number"!=typeof a)if(h){if(c(i)||c(i.arcade))return void pj.error("Use of arcade expressions requires an arcade context");const t=i.arcade.arcadeUtils,e=t.getViewInfo({viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}),n=t.createExecContext(r,e);if(!d){const e=t.createSyntaxTree(s.valueExpression);d=t.createFunction(e),s.cache.compiledFunc=d}a=t.executeFunction(d,n)}else o&&(a=o[l]);const p=s.normalizationField,f=o?parseFloat(o[p]):void 0;if(null!=a&&(!p||n||!isNaN(f)&&0!==f)){isNaN(f)||n||(a/=f);const t=Ij(a,u);if(t){const e=t[0],i=t[1];if(e===i)return s.stops[e].opacity;{const n=s.stops[e].opacity;return n+(s.stops[i].opacity-n)*t[2]}}}}function wj(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.filter((t=>"rotation"===t.type))[0]:t;if(!s)return;if("esri.renderers.visualVariables.RotationVariable"!==s.declaredClass)return void pj.warn("The visualVariable should be an instance of esri.renderers.visualVariables.RotationVariable");const n=s.axis||"heading",r="heading"===n&&"arithmetic"===s.rotationType?90:0,o="heading"===n&&"arithmetic"===s.rotationType?-1:1,a="number"==typeof e?null:e,l=a&&a.attributes,u=s.field,{hasExpression:h}=s.cache;let d=s.cache.compiledFunc,p=0;if(!u&&!h)return p;if(h){if(c(i)||c(i.arcade))return void pj.error("Use of arcade expressions requires an arcade context");const t=i.arcade.arcadeUtils,e=t.getViewInfo({viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}),n=t.createExecContext(a,e);if(!d){const e=t.createSyntaxTree(s.valueExpression);d=t.createFunction(e),s.cache.compiledFunc=d}p=t.executeFunction(d,n)}else l&&(p=l[u]||0);return p="number"!=typeof p||isNaN(p)?null:r+o*p,p}function bj(t,e,i){const s="visualVariables"in t&&t.visualVariables?t.visualVariables.filter((t=>"size"===t.type))[0]:t;if(!s)return;if("esri.renderers.visualVariables.SizeVariable"!==s.declaredClass)return void pj.warn("The visualVariable should be an instance of esri.renderers.visualVariables.SizeVariable");const n=xj(function(t,e,i){const s="number"==typeof e,n=s?null:e,r=n&&n.attributes;let o=s?e:null;const{isScaleDriven:a}=t.cache;let l=t.cache.compiledFunc;if(a){const e=u(i)?i.scale:void 0,s=u(i)?i.view:void 0;o=null==e||"3d"===s?function(t){let e=null,i=null;const s=t.stops;return s?(e=s[0].value,i=s[s.length-1].value):(e=t.minDataValue||0,i=t.maxDataValue||0),(e+i)/2}(t):e}else if(!s)switch(t.inputValueType){case"expression":{if(c(i)||c(i.arcade))return void pj.error("Use of arcade expressions requires an arcade context");const e=i.arcade.arcadeUtils,s=e.getViewInfo({viewingMode:i.viewingMode,scale:i.scale,spatialReference:i.spatialReference}),r=e.createExecContext(n,s);if(!l){const i=e.createSyntaxTree(t.valueExpression);l=e.createFunction(i),t.cache.compiledFunc=l}o=e.executeFunction(l,r);break}case"field":r&&(o=r[t.field]);break;case"unknown":o=null}if(!Tk(o))return null;if(s||!t.normalizationField)return o;const h=r?parseFloat(r[t.normalizationField]):null;return Tk(h)&&0!==h?o/h:null}(s,e,i),s,e,i,s.cache.ipData);return null==n||isNaN(n)?0:n}function Mj(t,e,i){return null==t?null:_k(t)?bj(t,e,i):Tk(t)?t:null}function Sj(t,e,i){return Tk(i)&&t>i?i:Tk(e)&&t<e?e:t}function xj(t,e,i,s,n){switch(e.transformationType){case"additive":return function(t,e,i,s){return t+(Mj(e.minSize,i,s)||e.minDataValue)}(t,e,i,s);case"constant":return function(t,e,i){const s=t.stops;let n=s&&s.length&&s[0].size;return null==n&&(n=t.minSize),Mj(n,e,i)}(e,i,s);case"clamped-linear":return function(t,e,i,s){const n=(t-e.minDataValue)/(e.maxDataValue-e.minDataValue),r=Mj(e.minSize,i,s),o=Mj(e.maxSize,i,s),a=u(s)?s.shape:void 0;if(t<=e.minDataValue)return r;if(t>=e.maxDataValue)return o;if("area"===e.scaleBy&&a){const t="circle"===a,e=t?yj*(r/2)**2:r*r,i=e+n*((t?yj*(o/2)**2:o*o)-e);return t?2*Math.sqrt(i/yj):Math.sqrt(i)}return r+n*(o-r)}(t,e,i,s);case"proportional":return function(t,e,i,s){const n=u(s)?s.shape:void 0,r=t/e.minDataValue,o=Mj(e.minSize,i,s),a=Mj(e.maxSize,i,s);let l=null;return l="circle"===n?2*Math.sqrt(r*(o/2)**2):"square"===n||"diamond"===n||"image"===n?Math.sqrt(r*o**2):r*o,Sj(l,o,a)}(t,e,i,s);case"stops":return function(t,e,i,s,n){const[r,o,a]=Ij(t,n);if(r===o)return Mj(e.stops[r].size,i,s);{const t=Mj(e.stops[r].size,i,s);return t+(Mj(e.stops[o].size,i,s)-t)*a}}(t,e,i,s,n);case"real-world-size":return function(t,e,i,s){const n=(u(s)&&s.resolution?s.resolution:1)*ZS[e.valueUnit],r=Mj(e.minSize,i,s),o=Mj(e.maxSize,i,s),{valueRepresentation:a}=e;let l=null;return l="area"===a?2*Math.sqrt(t/yj)/n:"radius"===a||"distance"===a?2*t/n:t/n,Sj(l,r,o)}(t,e,i,s);case"identity":return t;case"unknown":return null}}function kj(t,e,i){const{isScaleDriven:s}=t.cache;if(!(s&&"3d"===i||e))return null;const n={scale:e,view:i};let r=Mj(t.minSize,fj,n),o=Mj(t.maxSize,fj,n);if(null!=r||null!=o){if(r>o){const t=o;o=r,r=t}return{minSize:r,maxSize:o}}}function Ij(t,e){if(!e)return;let i=0,s=e.length-1;return e.some(((e,n)=>t<e?(s=n,!0):(i=n,!1))),[i,s,(t-e[i])/(e[s]-e[i])]}function jj(t,e,i){const s=["proportional","proportional","proportional"];for(const n of t){const t=n.useSymbolValue?"symbol-value":bj(n,e,i);switch(n.axis){case"width":s[0]=t;break;case"depth":s[1]=t;break;case"height":s[2]=t;break;case"width-and-depth":s[0]=t,s[1]=t;break;case"all":case void 0:case null:s[0]=t,s[1]=t,s[2]=t}}return s}const _j=Object.freeze({__proto__:null,getAllSizes:jj,getColor:gj,getOpacity:vj,getRotationAngle:wj,getSize:bj,getSizeForValue:xj,getSizeFromNumberOrVariable:Mj,getSizeRangeAtScale:kj,getVisualVariableValues:function(t,e,i){if(!t.visualVariables)return;const s=[],n=[],r=[],o=[],a=[];for(const e of t.visualVariables)switch(e.type){case"color":n.push(e);break;case"opacity":r.push(e);break;case"rotation":a.push(e);break;case"size":o.push(e)}return n.forEach((t=>{const n=gj(t,e,i);s.push({variable:t,value:n})})),r.forEach((t=>{const n=vj(t,e,i);s.push({variable:t,value:n})})),a.forEach((t=>{const n=wj(t,e,i);s.push({variable:t,value:n})})),o.forEach((t=>{const n=bj(t,e,i);s.push({variable:t,value:n})})),s.filter((t=>null!=t.value))},viewScaleRE:mj});var Tj;const Oj=ct.getLogger("esri.renderers.visualVariables.SizeVariable"),Aj=new ri({width:"width",depth:"depth",height:"height",widthAndDepth:"width-and-depth",all:"all"}),Fj=new ri({unknown:"unknown",inch:"inches",foot:"feet",yard:"yards",mile:"miles","nautical-mile":"nautical-miles",millimeter:"millimeters",centimeter:"centimeters",decimeter:"decimeters",meter:"meters",kilometer:"kilometers","decimal-degree":"decimal-degrees"});function Cj(t){if(null!=t)return"string"==typeof t||"number"==typeof t?dm(t):"size"===t.type?_k(t)?t:(delete(t={...t}).type,new Ej(t)):void 0}function Pj(t,e,i){if("object"!=typeof t)return t;const s=new Ej;return s.read(t,i),s}let Ej=Tj=class extends rk{constructor(t){super(t),this.axis=null,this.legendOptions=null,this.normalizationField=null,this.scaleBy=null,this.target=null,this.type="size",this.useSymbolValue=null,this.valueExpression=null,this.valueRepresentation=null,this.valueUnit=null}get cache(){return{ipData:this._interpolateData(),hasExpression:!!this.valueExpression,compiledFunc:null,isScaleDriven:mj.test(this.valueExpression)}}set expression(t){Oj.warn("'expression' is deprecated since version 4.2. Use 'valueExpression' instead. The only supported expression is 'view.scale'."),"view.scale"===t?(this.valueExpression="$view.scale",this._set("expression",t)):this._set("expression",null)}set index(t){_k(this.maxSize)&&(this.maxSize.index=`visualVariables[${t}].maxSize`),_k(this.minSize)&&(this.minSize.index=`visualVariables[${t}].minSize`),this._set("index",t)}get inputValueType(){return Ok(this)}set maxDataValue(t){t&&this.stops&&(Oj.warn("cannot set maxDataValue when stops is not null."),t=null),this._set("maxDataValue",t)}set maxSize(t){t&&this.stops&&(Oj.warn("cannot set maxSize when stops is not null."),t=null),this._set("maxSize",t)}castMaxSize(t){return Cj(t)}readMaxSize(t,e,i){return Pj(t,0,i)}set minDataValue(t){t&&this.stops&&(Oj.warn("cannot set minDataValue when stops is not null."),t=null),this._set("minDataValue",t)}set minSize(t){t&&this.stops&&(Oj.warn("cannot set minSize when stops is not null."),t=null),this._set("minSize",t)}castMinSize(t){return Cj(t)}readMinSize(t,e,i){return Pj(t,0,i)}get arcadeRequired(){return!!this.valueExpression||this.minSize&&"object"==typeof this.minSize&&this.minSize.arcadeRequired||this.maxSize&&"object"==typeof this.maxSize&&this.maxSize.arcadeRequired}set stops(t){null==this.minDataValue&&null==this.maxDataValue&&null==this.minSize&&null==this.maxSize?t&&Array.isArray(t)&&(t=t.filter((t=>!!t))).sort(((t,e)=>t.value-e.value)):t&&(Oj.warn("cannot set stops when one of minDataValue, maxDataValue, minSize or maxSize is not null."),t=null),this._set("stops",t)}get transformationType(){return function(t,e){return"unknown"===(e||Ok(t))?"constant":t.stops?"stops":null!=t.minSize&&null!=t.maxSize&&null!=t.minDataValue&&null!=t.maxDataValue?"clamped-linear":"unknown"===(t.valueUnit||"unknown")?null!=t.minSize&&null!=t.minDataValue?t.minSize&&t.minDataValue?"proportional":"additive":"identity":"real-world-size"}(this,this.inputValueType)}readValueExpression(t,e){return t||e.expression&&"$view.scale"}writeValueExpressionWebScene(t,e,i,s){if("$view.scale"===t){if(s&&s.messages){const t=this.index;s.messages.push(new Ve("property:unsupported",this.type+"VisualVariable.valueExpression = '$view.scale' is not supported in Web Scene. Please remove this property to save the Web Scene.",{instance:this,propertyName:("string"==typeof t?t:`visualVariables[${t}]`)+".valueExpression",context:s}))}}else e[i]=t}readValueUnit(t){return t?Fj.read(t):null}clone(){return new Tj({axis:this.axis,field:this.field,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,maxDataValue:this.maxDataValue,maxSize:_k(this.maxSize)?this.maxSize.clone():this.maxSize,minDataValue:this.minDataValue,minSize:_k(this.minSize)?this.minSize.clone():this.minSize,normalizationField:this.normalizationField,stops:this.stops&&this.stops.map((t=>t.clone())),target:this.target,useSymbolValue:this.useSymbolValue,valueRepresentation:this.valueRepresentation,valueUnit:this.valueUnit,legendOptions:this.legendOptions&&this.legendOptions.clone()})}flipSizes(){if("clamped-linear"===this.transformationType){const{minSize:t,maxSize:e}=this;return this.minSize=e,this.maxSize=t,this}if("stops"===this.transformationType){const t=this.stops,e=t.map((t=>t.size)).reverse(),i=t.length;for(let s=0;s<i;s++)t[s].size=e[s];return this}return this}getAttributeHash(){return`${super.getAttributeHash()}-${this.target}-${this.normalizationField}`}_interpolateData(){return this.stops&&this.stops.map((t=>t.value||0))}};e([oe({readOnly:!0})],Ej.prototype,"cache",null),e([oe({type:Aj.apiValues,json:{type:Aj.jsonValues,origins:{"web-map":{read:!1}},read:Aj.read,write:Aj.write}})],Ej.prototype,"axis",void 0),e([oe({type:String,value:null,json:{read:!1}})],Ej.prototype,"expression",null),e([oe()],Ej.prototype,"index",null),e([oe({type:String,readOnly:!0})],Ej.prototype,"inputValueType",null),e([oe({type:jk,json:{write:!0}})],Ej.prototype,"legendOptions",void 0),e([oe({type:Number,value:null,json:{write:!0}})],Ej.prototype,"maxDataValue",null),e([oe({type:Number,value:null,json:{write:!0}})],Ej.prototype,"maxSize",null),e([ba("maxSize")],Ej.prototype,"castMaxSize",null),e([Sd("maxSize")],Ej.prototype,"readMaxSize",null),e([oe({type:Number,value:null,json:{write:!0}})],Ej.prototype,"minDataValue",null),e([oe({type:Number,value:null,json:{write:!0}})],Ej.prototype,"minSize",null),e([ba("minSize")],Ej.prototype,"castMinSize",null),e([Sd("minSize")],Ej.prototype,"readMinSize",null),e([oe({type:String,json:{write:!0}})],Ej.prototype,"normalizationField",void 0),e([oe({readOnly:!0})],Ej.prototype,"arcadeRequired",null),e([oe({type:String})],Ej.prototype,"scaleBy",void 0),e([oe({type:[xk],value:null,json:{write:!0}})],Ej.prototype,"stops",null),e([oe({type:["outline"],json:{write:!0}})],Ej.prototype,"target",void 0),e([oe({type:String,readOnly:!0})],Ej.prototype,"transformationType",null),e([oe({type:["size"],json:{type:["sizeInfo"]}})],Ej.prototype,"type",void 0),e([oe({type:Boolean,json:{write:!0,origins:{"web-map":{read:!1}}}})],Ej.prototype,"useSymbolValue",void 0),e([oe({type:String,json:{write:!0}})],Ej.prototype,"valueExpression",void 0),e([Sd("valueExpression",["valueExpression","expression"])],Ej.prototype,"readValueExpression",null),e([xd("web-scene","valueExpression")],Ej.prototype,"writeValueExpressionWebScene",null),e([oe({type:["radius","diameter","area","width","distance"],json:{write:!0}})],Ej.prototype,"valueRepresentation",void 0),e([oe({type:Fj.apiValues,json:{write:Fj.write,origins:{"web-map":{read:!1},"web-scene":{write:!0}}}})],Ej.prototype,"valueUnit",void 0),e([Sd("valueUnit")],Ej.prototype,"readValueUnit",null),Ej=Tj=e([si("esri.renderers.visualVariables.SizeVariable")],Ej);const Rj=Ej,Lj=ct.getLogger("esri.renderers.visualVariables.VisualVariableFactory"),Nj={color:hk,size:Rj,opacity:gk,rotation:bk},Dj=new ri({colorInfo:"color",transparencyInfo:"opacity",rotationInfo:"rotation",sizeInfo:"size"}),Vj=/^\[([^\]]+)\]$/i;let $j=class extends jo{constructor(){super(...arguments),this.colorVariables=null,this.opacityVariables=null,this.rotationVariables=null,this.sizeVariables=null}set visualVariables(t){if(this._resetVariables(),(t=t&&t.filter((t=>!!t)))&&t.length){for(const e of t)switch(e.type){case"color":this.colorVariables.push(e);break;case"opacity":this.opacityVariables.push(e);break;case"rotation":this.rotationVariables.push(e);break;case"size":this.sizeVariables.push(e)}this.sizeVariables.length&&this.sizeVariables.some((t=>!!t.target))&&t.sort(((t,e)=>{let i=null;return i=t.target===e.target?0:t.target?1:-1,i}));for(let e=0;e<t.length;e++)t[e].index=e;this._set("visualVariables",t)}else this._set("visualVariables",t)}readVariables(t,e,i){const{rotationExpression:s,rotationType:n}=e,r=s&&s.match(Vj),o=r&&r[1];if(o&&(t||(t=[]),t.push({type:"rotationInfo",rotationType:n,field:o})),t)return t.map((t=>{const e=Dj.read(t.type),s=Nj[e];s||(Lj.warn("Unknown variable type: "+e),i&&i.messages&&i.messages.push(new Ie("visual-variable:unsupported",`visualVariable of type '${e}' is not supported`,{definition:t,context:i})));const n=new s;return n.read(t,i),n}))}writeVariables(t,e){const i=[];for(const s of t){const t=s.toJSON(e);t&&i.push(t)}return i}_resetVariables(){this.colorVariables=[],this.opacityVariables=[],this.rotationVariables=[],this.sizeVariables=[]}};e([oe()],$j.prototype,"visualVariables",null),$j=e([si("esri.renderers.visualVariables.VisualVariableFactory")],$j);const zj=$j,Gj={base:rk,key:"type",typeMap:{opacity:gk,color:hk,rotation:bk,size:Rj}},Uj=t=>{let i=class extends t{constructor(){super(...arguments),this._vvFactory=new zj}set visualVariables(t){this._vvFactory.visualVariables=t,this._set("visualVariables",this._vvFactory.visualVariables)}readVisualVariables(t,e,i){return this._vvFactory.readVariables(t,e,i)}writeVisualVariables(t,e,i,s){e[i]=this._vvFactory.writeVariables(t,s)}get arcadeRequiredForVisualVariables(){if(!this.visualVariables)return!1;for(const t of this.visualVariables)if(t.arcadeRequired)return!0;return!1}hasVisualVariables(t,e){return t?this.getVisualVariablesForType(t,e).length>0:this.getVisualVariablesForType("size",e).length>0||this.getVisualVariablesForType("color",e).length>0||this.getVisualVariablesForType("opacity",e).length>0||this.getVisualVariablesForType("rotation",e).length>0}getVisualVariablesForType(t,e){const i=this.visualVariables;return i?i.filter((i=>i.type===t&&("string"==typeof e?i.target===e:!1!==e||!i.target))):[]}async collectVVRequiredFields(t,e){let i=[];this.visualVariables&&(i=i.concat(this.visualVariables));for(const s of i)s&&(s.field&&wy(t,e,s.field),s.normalizationField&&wy(t,e,s.normalizationField),s.valueExpression&&await My(t,e,s.valueExpression))}};return e([oe({types:[Gj],value:null,json:{write:!0}})],i.prototype,"visualVariables",null),e([Sd("visualVariables",["visualVariables","rotationType","rotationExpression"])],i.prototype,"readVisualVariables",null),e([xd("visualVariables")],i.prototype,"writeVisualVariables",null),i=e([si("esri.renderers.mixins.VisualVariablesMixin")],i),i},qj={retainId:!1,ignoreDrivers:!1,hasLabelingContext:!0};function Bj(t,e,i,s){const n=function(t,e,i){if(!t)return null;if(i&&"web-scene"===i.origin&&!(t instanceof Pw)&&!(t instanceof zb)){const s=function(t,e=qj){if(!t)return{symbol:null};const{retainId:i=qj.retainId,ignoreDrivers:s=qj.ignoreDrivers,hasLabelingContext:n=qj.hasLabelingContext,retainCIM:r=qj.retainCIM}=e;let o;if(Ub(t)||t instanceof zb)o=t.clone();else if("cim"===t.type){var a,l;const e=null==(a=t.data)||null==(l=a.symbol)?void 0:l.type;if("CIMPointSymbol"!==e)return{error:new Ve("symbol-conversion:unsupported-cim-symbol",`CIM symbol of type '${e||"unknown"}' is unsupported in 3D`,{symbol:t})};o=r?t.clone():Mb.fromCIMSymbol(t)}else if(t instanceof zm)o=eb.fromSimpleLineSymbol(t);else if(t instanceof Eb)o=Mb.fromSimpleMarkerSymbol(t);else if(t instanceof mb)o=Mb.fromPictureMarkerSymbol(t);else if(t instanceof Ab)o=jb.fromSimpleFillSymbol(t);else{if(!(t instanceof Nb))return{error:new Ve("symbol-conversion:unsupported-2d-symbol",`2D symbol of type '${t.type||t.declaredClass}' is unsupported in 3D`,{symbol:t})};o=n?Qw.fromTextSymbol(t):Mb.fromTextSymbol(t)}if(i&&"cim"!==o.type&&(o.id=t.id),s&&Ub(o))for(let t=0;t<o.symbolLayers.length;++t)o.symbolLayers.getItemAt(t)._ignoreDrivers=!0;return{symbol:o}}(t,{retainCIM:!0});return u(s.symbol)?s.symbol.write(e,i):(i.messages&&i.messages.push(new Ve("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in scenes. Use 3D symbology instead when working with WebScene and SceneView`,{symbol:t,context:i,error:s.error})),null)}return i&&"web-map"===i.origin&&"web-style"===t.type?(i.messages&&i.messages.push(new Ve("symbol:unsupported",`Symbols of type '${t.declaredClass}' are not supported in webmaps. Use CIMSymbol instead when working with WebMap in MapView.`,{symbol:t,context:i})),null):t.write(e,i)}(t,{},s);n&&(e[i]=n)}function Wj(t,e){return Wb(t,null,e)}const Hj={types:Hb,json:{write:{writer:Bj},origins:{"web-scene":{types:Zb,write:{writer:Bj},read:{reader:Oe({types:Zb})}}}}},Jj={types:{base:sm,key:"type",typeMap:{"simple-fill":qb.typeMap["simple-fill"],"picture-fill":qb.typeMap["picture-fill"],"polygon-3d":qb.typeMap["polygon-3d"]}},json:{write:{writer:Bj},origins:{"web-scene":{type:jb,write:{writer:Bj}}}}};var Zj;let Qj=Zj=class extends Vd{constructor(t){super(t),this.description=null,this.label=null,this.minValue=null,this.maxValue=0,this.symbol=null}clone(){return new Zj({description:this.description,label:this.label,minValue:this.minValue,maxValue:this.maxValue,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol);return`${this.minValue}.${this.maxValue}.${t}`}};e([oe({type:String,json:{write:!0}})],Qj.prototype,"description",void 0),e([oe({type:String,json:{write:!0}})],Qj.prototype,"label",void 0),e([oe({type:Number,json:{read:{source:"classMinValue"},write:{target:"classMinValue"}}})],Qj.prototype,"minValue",void 0),e([oe({type:Number,json:{read:{source:"classMaxValue"},write:{target:"classMaxValue"}}})],Qj.prototype,"maxValue",void 0),e([oe(Hj)],Qj.prototype,"symbol",void 0),Qj=Zj=e([si("esri.renderers.support.ClassBreakInfo")],Qj);const Kj=Qj;var Yj;const Xj=ct.getLogger("esri.renderers.ClassBreaksRenderer"),t_="percent-of-total",e_="field",i_=new ri({esriNormalizeByLog:"log",esriNormalizeByPercentOfTotal:t_,esriNormalizeByField:e_}),s_=Tt(Kj);let n_=Yj=class extends(Uj(Zx)){constructor(t){super(t),this._compiledValueExpression={valueExpression:null,compiledFunction:null},this.backgroundFillSymbol=null,this.classBreakInfos=null,this.defaultLabel=null,this.defaultSymbol=null,this.field=null,this.isMaxInclusive=!0,this.legendOptions=null,this.normalizationField=null,this.normalizationTotal=null,this.type="class-breaks",this.valueExpression=null,this.valueExpressionTitle=null,this._set("classBreakInfos",[])}readClassBreakInfos(t,e,i){if(!Array.isArray(t))return;let s=e.minValue;return t.map((t=>{const e=new Kj;return e.read(t,i),null==e.minValue&&(e.minValue=s),null==e.maxValue&&(e.maxValue=e.minValue),s=e.maxValue,e}))}writeClassBreakInfos(t,e,i,s){const n=t.map((t=>t.write({},s)));this._areClassBreaksConsecutive()&&n.forEach((t=>delete t.classMinValue)),e[i]=n}castField(t){return null==t?t:"function"==typeof t?(Xj.error(".field: field must be a string value"),null):mt(t)}get minValue(){return this.classBreakInfos&&this.classBreakInfos[0]&&this.classBreakInfos[0].minValue||0}get normalizationType(){let t=this._get("normalizationType");const e=!!this.normalizationField,i=null!=this.normalizationTotal;return e||i?(t=(e?e_:i&&t_)||null,e&&i&&Xj.warn("warning: both normalizationField and normalizationTotal are set!")):t!==e_&&t!==t_||(t=null),t}set normalizationType(t){this._set("normalizationType",t)}addClassBreakInfo(t,e,i){let s=null;s="number"==typeof t?new Kj({minValue:t,maxValue:e,symbol:Kb(i)}):s_(H(t)),this.classBreakInfos.push(s),1===this.classBreakInfos.length&&this.notifyChange("minValue")}removeClassBreakInfo(t,e){const i=this.classBreakInfos.length;for(let s=0;s<i;s++){const i=[this.classBreakInfos[s].minValue,this.classBreakInfos[s].maxValue];if(i[0]===t&&i[1]===e){this.classBreakInfos.splice(s,1);break}}}getBreakIndex(t,e){return this.valueExpression&&(c(e)||c(e.arcade))&&Xj.warn(""),this.valueExpression?this._getBreakIndexForExpression(t,e):this._getBreakIndexForField(t)}async getClassBreakInfo(t,e){let i=e;this.valueExpression&&(c(e)||c(e.arcade))&&(i={...i,arcade:await ay()});const s=this.getBreakIndex(t,i);return-1!==s?this.classBreakInfos[s]:null}getSymbol(t,e){if(this.valueExpression&&(c(e)||c(e.arcade)))return void Xj.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this.getBreakIndex(t,e);return i>-1?this.classBreakInfos[i].symbol:this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(c(e)||c(e.arcade))){const t=await ay(),{arcadeUtils:e}=t;e.hasGeometryOperations(this.valueExpression)&&await e.enableGeometryOperations(),i={...i,arcade:t}}const s=this.getBreakIndex(t,i);return s>-1?this.classBreakInfos[s].symbol:this.defaultSymbol}getSymbols(){const t=[];return this.classBreakInfos.forEach((e=>{e.symbol&&t.push(e.symbol)})),this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){const t=JSON.stringify(this.backgroundFillSymbol),e=JSON.stringify(this.defaultSymbol),i=`${this.normalizationField}.${this.normalizationType}.${this.normalizationTotal}`;return`${t}.${e}.${this.classBreakInfos.reduce(((t,e)=>t+e.getMeshHash()),"")}.${i}.${this.field}.${this.valueExpression}`}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}clone(){return new Yj({field:this.field,backgroundFillSymbol:this.backgroundFillSymbol&&this.backgroundFillSymbol.clone(),defaultLabel:this.defaultLabel,defaultSymbol:this.defaultSymbol&&this.defaultSymbol.clone(),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,classBreakInfos:H(this.classBreakInfos),isMaxInclusive:this.isMaxInclusive,normalizationField:this.normalizationField,normalizationTotal:this.normalizationTotal,normalizationType:this.normalizationType,visualVariables:H(this.visualVariables),legendOptions:H(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(t,e))),My(t,e,this.valueExpression)];wy(t,e,this.field),wy(t,e,this.normalizationField),await Promise.all(i)}_getBreakIndexForExpression(t,e){const{viewingMode:i,scale:s,spatialReference:n,arcade:r}=y(e,{});let o=this._compiledValueExpression.valueExpression===this.valueExpression?this._compiledValueExpression.compiledFunction:null;const a=r.arcadeUtils;if(!o){const t=a.createSyntaxTree(this.valueExpression);o=a.createFunction(t),this._compiledValueExpression.compiledFunction=o}this._compiledValueExpression.valueExpression=this.valueExpression;const l=a.executeFunction(o,a.createExecContext(t,a.getViewInfo({viewingMode:i,scale:s,spatialReference:n})));return this._getBreakIndexfromInfos(l)}_getBreakIndexForField(t){const e=t.attributes,i=this.normalizationType;let s=parseFloat(e[this.field]);if(i){const t=this.normalizationTotal,n=parseFloat(e[this.normalizationField]);if("log"===i)s=Math.log(s)*Math.LOG10E;else if(i!==t_||isNaN(t)){if(i===e_&&!isNaN(n)){if(isNaN(s)||isNaN(n))return-1;s/=n}}else s=s/t*100}return this._getBreakIndexfromInfos(s)}_getBreakIndexfromInfos(t){const e=this.isMaxInclusive;if(null!=t&&"number"==typeof t&&!isNaN(t))for(let i=0;i<this.classBreakInfos.length;i++){const s=[this.classBreakInfos[i].minValue,this.classBreakInfos[i].maxValue];if(s[0]<=t&&(e?t<=s[1]:t<s[1]))return i}return-1}_areClassBreaksConsecutive(){const t=this.classBreakInfos,e=t.length;for(let i=1;i<e;i++)if(t[i-1].maxValue!==t[i].minValue)return!1;return!0}};e([oe(Jj)],n_.prototype,"backgroundFillSymbol",void 0),e([oe({type:[Kj]})],n_.prototype,"classBreakInfos",void 0),e([Sd("classBreakInfos")],n_.prototype,"readClassBreakInfos",null),e([xd("classBreakInfos")],n_.prototype,"writeClassBreakInfos",null),e([oe({type:String,json:{write:!0}})],n_.prototype,"defaultLabel",void 0),e([oe(Hj)],n_.prototype,"defaultSymbol",void 0),e([oe({type:String,json:{write:!0}})],n_.prototype,"field",void 0),e([ba("field")],n_.prototype,"castField",null),e([oe({type:Boolean})],n_.prototype,"isMaxInclusive",void 0),e([oe({type:Yx,json:{write:!0}})],n_.prototype,"legendOptions",void 0),e([oe({type:Number,readOnly:!0,value:null,json:{read:!1,write:{overridePolicy(){return 0!==this.classBreakInfos.length&&this._areClassBreaksConsecutive()?{enabled:!0}:{enabled:!1}}}}})],n_.prototype,"minValue",null),e([oe({type:String,json:{write:!0}})],n_.prototype,"normalizationField",void 0),e([oe({type:Number,cast:t=>gt(t),json:{write:!0}})],n_.prototype,"normalizationTotal",void 0),e([oe({type:i_.apiValues,value:null,json:{type:i_.jsonValues,read:i_.read,write:i_.write}})],n_.prototype,"normalizationType",null),e([Md({classBreaks:"class-breaks"})],n_.prototype,"type",void 0),e([oe({type:String,json:{write:!0}})],n_.prototype,"valueExpression",void 0),e([oe({type:String,json:{write:!0}})],n_.prototype,"valueExpressionTitle",void 0),n_=Yj=e([si("esri.renderers.ClassBreaksRenderer")],n_);const r_=n_;class o_{constructor(t,e,i){this._namespace=t,this._storage=e,this._removeFunc=!1,this._hit=0,this._miss=0,this._storage.register(this),this._namespace+=":",i&&(this._storage.registerRemoveFunc(this._namespace,i),this._removeFunc=!0)}destroy(){this._storage.clear(this._namespace),this._removeFunc&&this._storage.deregisterRemoveFunc(this._namespace),this._storage.deregister(this),this._storage=null}get namespace(){return this._namespace.slice(0,-1)}get hitRate(){return this._hit/(this._hit+this._miss)}get size(){return this._storage.size}get maxSize(){return this._storage.maxSize}resetHitRate(){this._hit=this._miss=0}put(t,e,i,s=0){this._storage.put(this._namespace+t,e,i,s)}get(t){const e=this._storage.get(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}pop(t){const e=this._storage.pop(this._namespace+t);return void 0===e?++this._miss:++this._hit,e}updateSize(t,e,i){this._storage.updateSize(this._namespace+t,e,i)}clear(){this._storage.clear(this._namespace)}clearAll(){this._storage.clearAll()}getStats(){return this._storage.getStats()}resetStats(){this._storage.resetStats()}}class a_{constructor(t=10485760){this._maxSize=t,this._db=new Map,this._size=0,this._hit=0,this._miss=0,this._removeFuncs=new Dr,this._users=new Dr}destroy(){this.clearAll(),this._removeFuncs.clear(),this._users.clear(),this._db=null}register(t){this._users.push(t)}deregister(t){this._users.removeUnordered(t)}registerRemoveFunc(t,e){this._removeFuncs.push([t,e])}deregisterRemoveFunc(t){this._removeFuncs.filterInPlace((e=>e[0]!==t))}get size(){return this._size}get maxSize(){return this._maxSize}set maxSize(t){this._maxSize=Math.max(t,0),this._checkSizeLimit()}put(t,e,i,s){const n=this._db.get(t);if(n&&(this._size-=n.size,this._db.delete(t),n.entry!==e&&this._notifyRemove(t,n.entry,0)),i>this._maxSize)return void this._notifyRemove(t,e,0);if(void 0===e)return void console.warn("Refusing to cache undefined entry ");if(!i||i<0)return void console.warn("Refusing to cache entry with invalid size "+i);const r=1+Math.max(s,-3)- -3;this._db.set(t,{entry:e,size:i,lifetime:r,lives:r}),this._size+=i,this._checkSizeLimit()}updateSize(t,e,i){const s=this._db.get(t);if(s&&s.entry===e){for(this._size-=s.size;i>this._maxSize;){const s=this._notifyRemove(t,e,1);if(!(u(s)&&s>0))return void this._db.delete(t);i=s}s.size=i,this._size+=i,this._checkSizeLimit()}}pop(t){const e=this._db.get(t);if(e)return this._size-=e.size,this._db.delete(t),++this._hit,e.entry;++this._miss}get(t){const e=this._db.get(t);if(void 0!==e)return this._db.delete(t),e.lives=e.lifetime,this._db.set(t,e),++this._hit,e.entry;++this._miss}getStats(){const t={Size:Math.round(this._size/1048576)+"/"+Math.round(this._maxSize/1048576)+"MB","Hit rate":Math.round(100*this._getHitRate())+"%",Entries:""+this._db.size},e={},i=[];this._db.forEach(((t,s)=>{const n=t.lifetime;i[n]=(i[n]||0)+t.size,this._users.forAll((i=>{const n=i.namespace;s.startsWith(n)&&(e[n]=(e[n]||0)+t.size)}))}));const s={};this._users.forAll((t=>{const i=t.namespace;!isNaN(t.hitRate)&&t.hitRate>0?(e[i]=e[i]||0,s[i]=Math.round(100*t.hitRate)+"%"):s[i]="0%"}));const n=Object.keys(e);n.sort(((t,i)=>e[i]-e[t])),n.forEach((i=>t[i]=Math.round(e[i]/2**20)+"MB / "+s[i]));for(let e=i.length-1;e>=0;--e){const s=i[e];s&&(t["Priority "+(e+-3-1)]=Math.round(s/this.size*100)+"%")}return t}resetStats(){this._hit=this._miss=0,this._users.forAll((t=>t.resetHitRate()))}clear(t){this._db.forEach(((e,i)=>{i.startsWith(t)&&(this._size-=e.size,this._db.delete(i),this._notifyRemove(i,e.entry,0))}))}clearAll(){this._db.forEach(((t,e)=>this._notifyRemove(e,t.entry,0))),this._size=0,this._db.clear()}_getHitRate(){return this._hit/(this._hit+this._miss)}_notifyRemove(t,e,i){let s;return this._removeFuncs.some((n=>{if(t.startsWith(n[0])){const t=n[1](e,i);return"number"==typeof t&&(s=t),!0}return!1})),s}_checkSizeLimit(){if(!(this._size<=this._maxSize))for(const[t,e]of this._db){if(this._db.delete(t),e.lives<=1){this._size-=e.size;const i=this._notifyRemove(t,e.entry,1);u(i)&&i>0&&(this._size+=i,e.lives=e.lifetime,e.size=i,this._db.set(t,e))}else--e.lives,this._db.set(t,e);if(this._size<=.9*this.maxSize)return}}}class l_{constructor(t,e){this._storage=new a_,this._storage.maxSize=t,e&&this._storage.registerRemoveFunc("",e)}put(t,e,i){this._storage.put(t,e,i,1)}pop(t){return this._storage.pop(t)}get(t){return this._storage.get(t)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}get maxSize(){return this._storage.maxSize}set maxSize(t){this._storage.maxSize=t}}var u_;const c_=ct.getLogger("esri.renderers.DictionaryRenderer"),h_={type:"CIMSimpleLineCallout",lineSymbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",width:.5,color:[0,0,0,255]}]}};let d_=u_=class extends(Uj(Zx)){constructor(t){super(t),this._ongoingRequests=new Map,this._symbolCache=new l_(100),this.config=null,this.fieldMap=null,this.scaleExpression=null,this.scaleExpressionTitle=null,this.url=null,this.type="dictionary"}writeData(t,e){t&&(e.scalingExpressionInfo={expression:t,returnType:"number"})}writeVisualVariables(t,e,i,s){null!=s&&s.origin||super.writeVisualVariables(t,e,i,s)}clone(){return new u_({config:H(this.config),scaleExpression:this.scaleExpression,scaleExpressionTitle:this.scaleExpressionTitle,fieldMap:H(this.fieldMap),url:H(this.url),visualVariables:H(this.visualVariables)})}async getSymbolAsync(t,e){let i;this._dictionaryPromise||(this._dictionaryPromise=this.fetchResources(e));try{i=await this._dictionaryPromise}catch(t){if(is(t))return this._dictionaryPromise=null,null}const s={};if(this.fieldMap)for(const e of this._symbolFields){const i=this.fieldMap[e];s[e]=i&&null!=t.attributes[i]?""+t.attributes[i]:""}const n=i(s,e);if(!n||"string"!=typeof n)return null;const r=""+at(n),o=this._symbolCache.get(r);if(o)return o.catch((()=>{this._symbolCache.pop(r)})),o;const a=n.split(";"),l=[],c=[];for(const t of a)if(t&&0!==t.length)if(-1===t.indexOf("po:"))if(-1!==t.indexOf("|")){for(const e of t.split("|"))if(this._itemNames.has(e)){l.push(e);break}}else this._itemNames.has(t)&&l.push(t);else{const e=t.substr(3).split("|");if(3===e.length){const t=e[0],i=e[1];let s=e[2];if("DashTemplate"===i)s=s.split(" ").map((t=>Number(t)));else if("Color"===i){const t=new bd(s).toRgba();s=[t[0],t[1],t[2],255*t[3]]}else s=Number(s);c.push({primitiveName:t,propertyName:i,value:s})}}const h=!u(t.geometry)||!t.geometry.hasZ&&"point"===t.geometry.type,d=this._cimPartsToCIMSymbol(l,c,h,e);return this._symbolCache.put(r,d,1),d}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e),this.scaleExpression&&await My(t,e,this.scaleExpression);for(const i in this.fieldMap){const s=this.fieldMap[i];e.has(s)&&t.add(s)}}get arcadeRequired(){return!0}async fetchResources(t){if(this._dictionaryPromise)return this._dictionaryPromise;if(!this.url)return void c_.error("no valid URL!");const e=u(t)?t.abortOptions:null,i=$n(this.url+"/resources/styles/dictionary-info.json",{responseType:"json",query:{f:"json"},...e}),[{data:s}]=await Promise.all([i,ay()]);if(!s)throw this._dictionaryPromise=null,new Ve("esri.renderers.DictionaryRenderer","Bad dictionary data!");const n=s.expression,r=s.authoringInfo;this._refSymbolUrlTemplate=this.url+"/"+s.cimRefTemplateUrl,this._itemNames=new Set(s.itemsNames),this._symbolFields=r.symbol;const o={};if(this.config){const t=this.config;for(const e in t)o[e]=t[e]}if(r.configuration)for(const t of r.configuration)o.hasOwnProperty(t.name)||(o[t.name]=t.value);const a=[];if(u(t)&&t.fields&&this.fieldMap)for(const e of this._symbolFields){const i=this.fieldMap[e],s=t.fields.filter((t=>t.name===i));s.length>0&&a.push({...s[0],name:e})}return this._dictionaryPromise=((t,e,i,s)=>cy.create(t,e,i,s,["$feature","$view"]))(n,u(t)?t.spatialReference:null,a,o).then((t=>{const e={scale:0};return(i,s)=>{const n=t.repurposeFeature({geometry:null,attributes:i});return e.scale=u(s)?s.scale:void 0,t.evaluate({$feature:n,$view:e})}})).catch((t=>(c_.error("Creating dictinoary expression failed:",t),null))),this._dictionaryPromise}getSymbol(){return null}getSymbols(){return[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){return`${this.url}-${JSON.stringify(this.fieldMap)}`}getSymbolFields(){return this._symbolFields}async _getSymbolPart(t,e){if(this._ongoingRequests.has(t))return this._ongoingRequests.get(t).then((t=>t.data));const i=$n(this._refSymbolUrlTemplate.replace(/\{itemName\}/gi,t),{responseType:"json",query:{f:"json"},...e});this._ongoingRequests.set(t,i);try{return(await i).data}catch(e){return this._ongoingRequests.delete(t),Promise.reject(e)}}_combineSymbolParts(t,e,i){if(!t||0===t.length)return null;const s={...t[0]};if(t.length>1){s.symbolLayers=[];for(const e of t)s.symbolLayers.unshift(...e.symbolLayers)}return i&&(s.callout=h_),{type:"CIMSymbolReference",symbol:s,primitiveOverrides:e}}async _cimPartsToCIMSymbol(t,e,i,s){const n=Array(t.length);for(let e=0;e<t.length;e++)n[e]=this._getSymbolPart(t[e],s);const r=await Promise.all(n);return new om({data:this._combineSymbolParts(r,e,i)})}};e([oe({type:Object,json:{read:{source:"configuration"},write:{target:"configuration"}}})],d_.prototype,"config",void 0),e([oe({type:Object,json:{write:!0}})],d_.prototype,"fieldMap",void 0),e([oe({type:String,json:{read:{source:"scalingExpressionInfo.expression"},write:!0}})],d_.prototype,"scaleExpression",void 0),e([xd("scaleExpression")],d_.prototype,"writeData",null),e([oe({type:String,json:{read:{source:"scalingExpressionInfo.title"},write:{target:"scalingExpressionInfo.title",overridePolicy(t){return{enabled:!!t&&!!this.scaleExpression}}}}})],d_.prototype,"scaleExpressionTitle",void 0),e([oe({type:String,json:{write:!0}})],d_.prototype,"url",void 0),e([xd("visualVariables")],d_.prototype,"writeVisualVariables",null),d_=u_=e([si("esri.renderers.DictionaryRenderer")],d_);const p_=d_,f_=Object.freeze({__proto__:null,default:p_});var y_;const m_=ct.getLogger("esri.renderers.support.AttributeColorInfo");let g_=y_=class extends Vd{constructor(t){super(t),this.color=null,this.field=null,this.label=null,this.valueExpression=null,this.valueExpressionTitle=null}castField(t){return null==t?t:"function"==typeof t?(m_.error(".field: field must be a string value"),null):mt(t)}getAttributeHash(){return`${this.field}-${this.valueExpression}`}clone(){return new y_({color:this.color&&this.color.clone(),field:this.field,label:this.label,valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle})}};e([oe({type:bd,json:{type:[Number],write:!0}})],g_.prototype,"color",void 0),e([oe({type:String,json:{write:!0}})],g_.prototype,"field",void 0),e([ba("field")],g_.prototype,"castField",null),e([oe({type:String,json:{write:!0}})],g_.prototype,"label",void 0),e([oe({type:String,json:{write:!0}})],g_.prototype,"valueExpression",void 0),e([oe({type:String,json:{write:!0}})],g_.prototype,"valueExpressionTitle",void 0),g_=y_=e([si("esri.renderers.support.AttributeColorInfo")],g_);const v_=g_;var w_;let b_=w_=class extends Vd{constructor(){super(...arguments),this.unit=null}clone(){return new w_({unit:this.unit})}};e([oe({type:String,json:{write:!0}})],b_.prototype,"unit",void 0),b_=w_=e([si("esri.renderers.support.DotDensityLegendOptions")],b_);const M_=b_;var S_;let x_=S_=class extends(Uj(Zx)){constructor(t){super(t),this.attributes=null,this.backgroundColor=new bd([0,0,0,0]),this.blendDots=!0,this.dotBlendingEnabled=!0,this.dotShape="square",this.dotSize=1,this.legendOptions=null,this.outline=new zm,this.dotValue=null,this.referenceDotValue=null,this.referenceScale=null,this.seed=1,this.type="dot-density"}calculateDotValue(t){if(null==this.referenceScale)return this.dotValue;const e=t/this.referenceScale*this.dotValue;return e<1?1:e}getSymbol(){return new Ab({outline:this.outline})}async getSymbolAsync(){return this.getSymbol()}getSymbols(){return[this.getSymbol()]}getAttributeHash(){return this.attributes&&this.attributes.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){return JSON.stringify(this.outline)}clone(){return new S_({attributes:H(this.attributes),backgroundColor:H(this.backgroundColor),dotBlendingEnabled:H(this.dotBlendingEnabled),dotShape:H(this.dotShape),dotSize:H(this.dotSize),dotValue:H(this.dotValue),legendOptions:H(this.legendOptions),outline:H(this.outline),referenceScale:H(this.referenceScale),visualVariables:H(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}getControllerHash(){return`${this.attributes.map((t=>t.field||t.valueExpression||""))}-${this.outline&&JSON.stringify(this.outline.toJSON())||""}`}async collectRequiredFields(t,e){await this.collectVVRequiredFields(t,e);for(const i of this.attributes)i.valueExpression&&await My(t,e,i.valueExpression),i.field&&t.add(i.field)}};e([oe({type:[v_],json:{write:!0}})],x_.prototype,"attributes",void 0),e([oe({type:bd,json:{write:!0}})],x_.prototype,"backgroundColor",void 0),e([oe({type:Boolean}),ue("dotBlendingEnabled")],x_.prototype,"blendDots",void 0),e([oe({type:Boolean,json:{write:!0}})],x_.prototype,"dotBlendingEnabled",void 0),e([oe({type:String,json:{write:!1}})],x_.prototype,"dotShape",void 0),e([oe({type:Number,json:{write:!1}})],x_.prototype,"dotSize",void 0),e([oe({type:M_,json:{write:!0}})],x_.prototype,"legendOptions",void 0),e([oe({type:zm,json:{default:null,write:!0}})],x_.prototype,"outline",void 0),e([oe({type:Number,json:{write:!0}})],x_.prototype,"dotValue",void 0),e([oe({type:Number}),ue("dotValue")],x_.prototype,"referenceDotValue",void 0),e([oe({type:Number,json:{write:!0}})],x_.prototype,"referenceScale",void 0),e([oe({type:Number,json:{write:!0}})],x_.prototype,"seed",void 0),e([Md({dotDensity:"dot-density"})],x_.prototype,"type",void 0),x_=S_=e([si("esri.renderers.DotDensityRenderer")],x_);const k_=x_;var I_;let j_=I_=class extends Vd{constructor(t){super(t),this.color=null,this.ratio=null}clone(){return new I_({color:this.color,ratio:this.ratio})}};e([oe({type:bd,json:{write:!0}})],j_.prototype,"color",void 0),e([oe({type:Number,json:{write:!0}})],j_.prototype,"ratio",void 0),j_=I_=e([si("esri.renderers.support.HeatmapColorStop")],j_);const __=j_;var T_;let O_=T_=class extends Zx{constructor(t){super(t),this.blurRadius=10,this.colorStops=[new __({ratio:0,color:new bd("rgba(255, 140, 0, 0)")}),new __({ratio:.75,color:new bd("rgba(255, 140, 0, 1)")}),new __({ratio:.9,color:new bd("rgba(255, 0,   0, 1)")})],this.field=null,this.fieldOffset=0,this.maxPixelIntensity=100,this.minPixelIntensity=0,this.type="heatmap"}async collectRequiredFields(t,e){const i=this.field;i&&"string"==typeof i&&wy(t,e,i)}getAttributeHash(){return null}getMeshHash(){return`${JSON.stringify(this.colorStops)}.${this.blurRadius}.${this.field}`}clone(){return new T_({blurRadius:this.blurRadius,colorStops:H(this.colorStops),field:this.field,maxPixelIntensity:this.maxPixelIntensity,minPixelIntensity:this.minPixelIntensity})}};e([oe({type:Number,json:{write:!0}})],O_.prototype,"blurRadius",void 0),e([oe({type:[__],json:{write:!0}})],O_.prototype,"colorStops",void 0),e([oe({type:String,json:{write:!0}})],O_.prototype,"field",void 0),e([oe({type:Number,json:{write:{overridePolicy:(t,e,i)=>({enabled:null==i})}}})],O_.prototype,"fieldOffset",void 0),e([oe({type:Number,json:{write:!0}})],O_.prototype,"maxPixelIntensity",void 0),e([oe({type:Number,json:{write:!0}})],O_.prototype,"minPixelIntensity",void 0),e([Md({heatmap:"heatmap"})],O_.prototype,"type",void 0),O_=T_=e([si("esri.renderers.HeatmapRenderer")],O_);const A_=O_;var F_;let C_=F_=class extends(Uj(Zx)){constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.type="simple"}async collectRequiredFields(t,e){await Promise.all([this.collectSymbolFields(t,e),this.collectVVRequiredFields(t,e)])}async collectSymbolFields(t,e){await Promise.all(this.getSymbols().map((i=>i.collectRequiredFields(t,e))))}getSymbol(t,e){return this.symbol}async getSymbolAsync(t,e){return this.symbol}getSymbols(){return this.symbol?[this.symbol]:[]}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){return this.getSymbols().reduce(((t,e)=>t+JSON.stringify(e)),"")}get arcadeRequired(){return this.arcadeRequiredForVisualVariables}clone(){return new F_({description:this.description,label:this.label,symbol:this.symbol&&this.symbol.clone(),visualVariables:H(this.visualVariables),authoringInfo:this.authoringInfo&&this.authoringInfo.clone()})}};e([oe({type:String,json:{write:!0}})],C_.prototype,"description",void 0),e([oe({type:String,json:{write:!0}})],C_.prototype,"label",void 0),e([oe(Hj)],C_.prototype,"symbol",void 0),e([Md({simple:"simple"})],C_.prototype,"type",void 0),C_=F_=e([si("esri.renderers.SimpleRenderer")],C_);const P_=C_,E_=["esri.Color","esri.portal.Portal","esri.symbols.support.Symbol3DAnchorPosition2D","esri.symbols.support.Symbol3DAnchorPosition3D"];function R_(t){return t instanceof jo}function L_(t){return t instanceof qo?Object.keys(t.items):R_(t)?Gt(t).keys():t?Object.keys(t):[]}function N_(t,e){return t instanceof qo?t.items[e]:t[e]}function D_(t){return t?t.declaredClass:null}function V_(t,e){const i=t.diff;if(i&&"function"==typeof i)return i(t,e);const s=L_(t),n=L_(e);if(0===s.length&&0===n.length)return;if(!s.length||!n.length||function(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&t.length!==e.length}(t,e))return{type:"complete",oldValue:t,newValue:e};const r=n.filter((t=>-1===s.indexOf(t))),o=s.filter((t=>-1===n.indexOf(t))),a=s.filter((i=>n.indexOf(i)>-1&&N_(t,i)!==N_(e,i))).concat(r,o).sort(),l=D_(t);if(l&&E_.indexOf(l)>-1&&a.length)return{type:"complete",oldValue:t,newValue:e};let c;const h=R_(t)&&R_(e);for(const s of a){const n=N_(t,s),r=N_(e,s);let o;(h||"function"!=typeof n&&"function"!=typeof r)&&n!==r&&(null==n&&null==r||(o=i&&i[s]&&"function"==typeof i[s]?i[s](n,r):"object"==typeof n&&"object"==typeof r&&D_(n)===D_(r)?V_(n,r):{type:"complete",oldValue:n,newValue:r},u(o)&&(u(c)?c.diff[s]=o:c={type:"partial",diff:{[s]:o}})))}return c}function $_(t,e){if(c(t))return!1;const i=e.split(".");let s=t;for(const t of i){if("complete"===s.type)return!0;if("partial"!==s.type)return!1;{const e=s.diff[t];if(!e)return!1;s=e}}return!0}function z_(t,e){for(const i of e)if($_(t,i))return!0;return!1}function G_(t,e){if(!("function"==typeof t||"function"==typeof e||c(t)&&c(e)))return c(t)||c(e)||"object"==typeof t&&"object"==typeof e&&D_(t)!==D_(e)?{type:"complete",oldValue:t,newValue:e}:V_(t,e)}var U_;let q_=U_=class extends Vd{constructor(t){super(t),this.description=null,this.label=null,this.symbol=null,this.value=null}clone(){return new U_({value:this.value,description:this.description,label:this.label,symbol:this.symbol?this.symbol.clone():null})}getMeshHash(){const t=JSON.stringify(this.symbol&&this.symbol.toJSON());return`${this.value}.${t}`}};e([oe({type:String,json:{write:!0}})],q_.prototype,"description",void 0),e([oe({type:String,json:{write:!0}})],q_.prototype,"label",void 0),e([oe(Hj)],q_.prototype,"symbol",void 0),e([oe({type:[String,Number],json:{type:String,write:{writer:(t,e)=>{e.value=null==t?void 0:""+t}}}})],q_.prototype,"value",void 0),q_=U_=e([si("esri.renderers.support.UniqueValueInfo")],q_);const B_=q_,W_={};function H_(t,e,i){return t.styleUrl?async function(t,e){try{return{data:(await Q_(t,e)).data,baseUrl:wn(t),styleUrl:t}}catch(t){return Ki(t),null}}(t.styleUrl,i):t.styleName?function(t,e,i){const s=e&&e.portal||Qv.getDefault();let n;const r=`${s.url} - ${s.user&&s.user.username} - ${t}`;return W_[r]||(W_[r]=function(t,e,i){return e.load(i).then((()=>{const s=new Ev({disableExtraQuery:!0,query:`owner:${K_} AND type:${Y_} AND typekeywords:"${t}"`});return e.queryItems(s,i)})).then((({results:e})=>{let s=null;const n=t.toLowerCase();if(e&&Array.isArray(e))for(const t of e)if(t.typeKeywords.some((t=>t.toLowerCase()===n))&&t.type===Y_&&t.owner===K_){s=t;break}if(!s)throw new Ve("symbolstyleutils:style-not-found",`The style '${t}' could not be found`,{styleName:t});return s.load(i)}))}(t,s,i).then((t=>(n=t,t.fetchData()))).then((e=>({data:e,baseUrl:n.itemUrl,styleName:t})))),W_[r]}(t.styleName,e,i):Promise.reject(new Ve("symbolstyleutils:style-url-and-name-missing","Either styleUrl or styleName is required to resolve a style"))}function J_(t){return null===t||"CIMSymbolReference"===t.type?t:{type:"CIMSymbolReference",symbol:t}}function Z_(t,e){if("cimRef"===e)return t.cimRef;if(t.formatInfos&&!l("enable-feature:force-wosr"))for(const e of t.formatInfos)if("gltf"===e.type)return e.href;return t.webRef}function Q_(t,e){const i={responseType:"json",query:{f:"json"},...e};return $n(sn(t),i)}const K_="esri_en",Y_="Style",X_="https://cdn.arcgis.com/sharing/rest/content/items/220936cc6ed342c9937abd8f180e7d1e/resources/styles/cim/{SymbolName}.json?f=json";var tT;const eT=ct.getLogger("esri.renderers.UniqueValueRenderer"),iT=Tt(B_);let sT=tT=class extends(Uj(Zx)){constructor(t){super(t),this._valueInfoMap={},this._isDefaultSymbolDerived=!1,this.type="unique-value",this.backgroundFillSymbol=null,this.field=null,this.field2=null,this.field3=null,this.valueExpression=null,this.valueExpressionTitle=null,this.legendOptions=null,this.defaultLabel=null,this.fieldDelimiter=null,this.portal=null,this.styleOrigin=null,this.diff={uniqueValueInfos(t,e){if(!t&&!e)return;if(!t||!e)return{type:"complete",oldValue:t,newValue:e};let i=!1;const s={type:"collection",added:[],removed:[],changed:[],unchanged:[]};for(let n=0;n<e.length;n++){const r=t.find((t=>t.value===e[n].value));r?G_(r,e[n])?(s.changed.push({type:"complete",oldValue:r,newValue:e[n]}),i=!0):s.unchanged.push({oldValue:r,newValue:e[n]}):(s.added.push(e[n]),i=!0)}for(let n=0;n<t.length;n++)e.find((e=>e.value===t[n].value))||(s.removed.push(t[n]),i=!0);return i?s:void 0}},this._set("uniqueValueInfos",[])}get _cache(){return{compiledFunc:null}}castField(t){return null==t||"function"==typeof t?t:mt(t)}writeField(t,e,i,s){"string"==typeof t?e[i]=t:s&&s.messages?s.messages.push(new Ve("property:unsupported","UniqueValueRenderer.field set to a function cannot be written to JSON")):eT.error(".field: cannot write field to JSON since it's not a string value")}set defaultSymbol(t){this._isDefaultSymbolDerived=!1,this._set("defaultSymbol",t)}readPortal(t,e,i){return i.portal||Qv.getDefault()}readStyleOrigin(t,e,i){if(e.styleName)return Object.freeze({styleName:e.styleName});if(e.styleUrl){const t=Yg(e.styleUrl,i);return Object.freeze({styleUrl:t})}}writeStyleOrigin(t,e,i,s){t.styleName?e.styleName=t.styleName:t.styleUrl&&(e.styleUrl=Xg(t.styleUrl,s))}set uniqueValueInfos(t){this.styleOrigin?eT.error("#uniqueValueInfos=","Cannot modify unique value infos of a UniqueValueRenderer created from a web style"):(this._set("uniqueValueInfos",t),this._updateValueInfoMap())}addUniqueValueInfo(t,e){if(this.styleOrigin)return void eT.error("#addUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");let i;i="object"==typeof t?iT(t):new B_({value:t,symbol:Kb(e)}),this.uniqueValueInfos.push(i),this._valueInfoMap[i.value]=i}removeUniqueValueInfo(t){if(this.styleOrigin)eT.error("#removeUniqueValueInfo()","Cannot modify unique value infos of a UniqueValueRenderer created from a web style");else for(let e=0;e<this.uniqueValueInfos.length;e++)if(this.uniqueValueInfos[e].value===t+""){delete this._valueInfoMap[t],this.uniqueValueInfos.splice(e,1);break}}async getUniqueValueInfo(t,e){let i=e;return this.valueExpression&&(c(e)||c(e.arcade))&&(i={...i,arcade:await ay()}),this._getUniqueValueInfo(t,i)}getSymbol(t,e){if(this.valueExpression&&(c(e)||c(e.arcade)))return void eT.error("#getSymbol()","Please use getSymbolAsync if valueExpression is used");const i=this._getUniqueValueInfo(t,e);return i&&i.symbol||this.defaultSymbol}async getSymbolAsync(t,e){let i=e;if(this.valueExpression&&(c(i)||c(i.arcade))){const t=await ay(),{arcadeUtils:e}=t;e.hasGeometryOperations(this.valueExpression)&&await e.enableGeometryOperations(),i={...i,arcade:t}}const s=this._getUniqueValueInfo(t,i);return s&&s.symbol||this.defaultSymbol}getSymbols(){const t=[];for(const e of this.uniqueValueInfos)e.symbol&&t.push(e.symbol);return this.defaultSymbol&&t.push(this.defaultSymbol),t}getAttributeHash(){return this.visualVariables&&this.visualVariables.reduce(((t,e)=>t+e.getAttributeHash()),"")}getMeshHash(){return`${JSON.stringify(this.backgroundFillSymbol)}.${JSON.stringify(this.defaultSymbol)}.${this.uniqueValueInfos.reduce(((t,e)=>t+e.getMeshHash()),"")}.${this.field}.${this.field2}.${this.field3}.${this.fieldDelimiter}.${this.valueExpression}`}clone(){const t=new tT({field:this.field,field2:this.field2,field3:this.field3,defaultLabel:this.defaultLabel,defaultSymbol:H(this.defaultSymbol),valueExpression:this.valueExpression,valueExpressionTitle:this.valueExpressionTitle,fieldDelimiter:this.fieldDelimiter,visualVariables:H(this.visualVariables),legendOptions:H(this.legendOptions),authoringInfo:this.authoringInfo&&this.authoringInfo.clone(),backgroundFillSymbol:H(this.backgroundFillSymbol)});this._isDefaultSymbolDerived&&(t._isDefaultSymbolDerived=!0),t._set("portal",this.portal);const e=H(this.uniqueValueInfos);return this.styleOrigin&&(t._set("styleOrigin",Object.freeze(H(this.styleOrigin))),Object.freeze(e)),t._set("uniqueValueInfos",e),t._updateValueInfoMap(),t}get arcadeRequired(){return this.arcadeRequiredForVisualVariables||!!this.valueExpression}async collectRequiredFields(t,e){const i=[this.collectVVRequiredFields(t,e),this.collectSymbolFields(t,e)];await Promise.all(i)}async collectSymbolFields(t,e){const i=[...this.getSymbols().map((i=>i.collectRequiredFields(t,e))),My(t,e,this.valueExpression)];wy(t,e,this.field),wy(t,e,this.field2),wy(t,e,this.field3),await Promise.all(i)}populateFromStyle(){return H_(this.styleOrigin,{portal:this.portal}).then((t=>{const e=[];return this._valueInfoMap={},t&&t.data&&Array.isArray(t.data.items)&&t.data.items.forEach((i=>{const s=new zb({styleUrl:t.styleUrl,styleName:t.styleName,portal:this.portal,name:i.name});this.defaultSymbol||i.name!==t.data.defaultItem||(this.defaultSymbol=s,this._isDefaultSymbolDerived=!0);const n=new B_({value:i.name,symbol:s});e.push(n),this._valueInfoMap[i.name]=n})),this._set("uniqueValueInfos",Object.freeze(e)),!this.defaultSymbol&&this.uniqueValueInfos.length&&(this.defaultSymbol=this.uniqueValueInfos[0].symbol,this._isDefaultSymbolDerived=!0),this}))}_updateValueInfoMap(){this._valueInfoMap={},this.uniqueValueInfos.forEach((t=>this._valueInfoMap[t.value+""]=t))}_getUniqueValueInfo(t,e){return this.valueExpression?this._getUnqiueValueInfoForExpression(t,e):this._getUnqiueValueInfoForFields(t)}_getUnqiueValueInfoForExpression(t,e){const{viewingMode:i,scale:s,spatialReference:n,arcade:r}=y(e,{});let o=this._cache.compiledFunc;const a=r.arcadeUtils;if(!o){const t=a.createSyntaxTree(this.valueExpression);o=a.createFunction(t),this._cache.compiledFunc=o}const l=a.executeFunction(o,a.createExecContext(t,a.getViewInfo({viewingMode:i,scale:s,spatialReference:n})));return this._valueInfoMap[l+""]}_getUnqiueValueInfoForFields(t){const e=this.field,i=t.attributes;let s;if("function"!=typeof e&&this.field2){const t=this.field2,n=this.field3,r=[];e&&r.push(i[e]),t&&r.push(i[t]),n&&r.push(i[n]),s=r.join(this.fieldDelimiter||"")}else"function"==typeof e?s=e(t):e&&(s=i[e]);return this._valueInfoMap[s+""]}static fromPortalStyle(t,e){const i=new tT(e&&e.properties);i._set("styleOrigin",Object.freeze({styleName:t})),i._set("portal",e&&e.portal||Qv.getDefault());const s=i.populateFromStyle();return s.catch((e=>{eT.error(`#fromPortalStyle('${t}'[, ...])`,"Failed to create unique value renderer from style name",e)})),s}static fromStyleUrl(t,e){const i=new tT(e&&e.properties);i._set("styleOrigin",Object.freeze({styleUrl:t}));const s=i.populateFromStyle();return s.catch((e=>{eT.error(`#fromStyleUrl('${t}'[, ...])`,"Failed to create unique value renderer from style URL",e)})),s}};e([oe({readOnly:!0})],sT.prototype,"_cache",null),e([Md({uniqueValue:"unique-value"})],sT.prototype,"type",void 0),e([oe(Jj)],sT.prototype,"backgroundFillSymbol",void 0),e([oe({json:{type:String,read:{source:"field1"},write:{target:"field1"}}})],sT.prototype,"field",void 0),e([ba("field")],sT.prototype,"castField",null),e([xd("field")],sT.prototype,"writeField",null),e([oe({type:String,json:{write:!0}})],sT.prototype,"field2",void 0),e([oe({type:String,json:{write:!0}})],sT.prototype,"field3",void 0),e([oe({type:String,json:{write:!0}})],sT.prototype,"valueExpression",void 0),e([oe({type:String,json:{write:!0}})],sT.prototype,"valueExpressionTitle",void 0),e([oe({type:Yx,json:{write:!0}})],sT.prototype,"legendOptions",void 0),e([oe({type:String,json:{write:!0}})],sT.prototype,"defaultLabel",void 0),e([oe(Z({...Hj},{json:{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}},origins:{"web-scene":{write:{overridePolicy(){return{enabled:!this._isDefaultSymbolDerived}}}}}}}))],sT.prototype,"defaultSymbol",null),e([oe({type:String,json:{write:!0}})],sT.prototype,"fieldDelimiter",void 0),e([oe({type:Qv,readOnly:!0})],sT.prototype,"portal",void 0),e([Sd("portal",["styleName"])],sT.prototype,"readPortal",null),e([oe({readOnly:!0,json:{write:{enabled:!1,overridePolicy:()=>({enabled:!0})}}})],sT.prototype,"styleOrigin",void 0),e([Sd("styleOrigin",["styleName","styleUrl"])],sT.prototype,"readStyleOrigin",null),e([xd("styleOrigin",{styleName:{type:String},styleUrl:{type:String}})],sT.prototype,"writeStyleOrigin",null),e([oe({type:[B_],json:{write:{overridePolicy(){return this.styleOrigin?{enabled:!1}:{enabled:!0}}}}})],sT.prototype,"uniqueValueInfos",null),sT=tT=e([si("esri.renderers.UniqueValueRenderer")],sT);const nT=sT,rT={key:"type",base:Zx,typeMap:{heatmap:A_,simple:P_,"unique-value":nT,"class-breaks":r_,"dot-density":k_,dictionary:p_},errorContext:"renderer"},oT={key:"type",base:Zx,typeMap:{simple:P_,"unique-value":nT,"class-breaks":r_},errorContext:"renderer"};function aT(t,e){return uT(t,null,e)}const lT=Oe({types:rT});function uT(t,e,i){return t?t&&(t.styleName||t.styleUrl)&&"uniqueValue"!==t.type?(i&&i.messages&&i.messages.push(new Ie("renderer:unsupported","Only UniqueValueRenderer can be referenced from a web style, but found '"+t.type+"'",{definition:t,context:i})),null):lT(t,e,i):null}function cT(t,e,i,s){return function(t){return"function"==typeof t}(t)?t(e,i,s):t}function hT(t){return[t.r,t.g,t.b,t.a]}function dT(t,e,i){const s=t=>{let e=t.length;for(;e--;)if(-1===" /-,\n".indexOf(t.charAt(e)))return!1;return!0},n=[];let r=0,o=-1;do{if(o=e.indexOf("[",r),o>=r){if(o>r){const t=e.substr(r,o-r);n.push([t,null,s(t)])}if(r=o+1,o=e.indexOf("]",r),o>=r){if(o>r){const i=t[e.substr(r,o-r)];i&&n.push([null,i,!1])}r=o+1}}}while(-1!==o);if(r<e.length-1){const t=e.substr(r);n.push([t,null,s(t)])}return t=>{let e="",s=null;for(const i of n){const[n,r,o]=i;if(n)o?s=n:(s&&(e+=s,s=null),e+=n);else{const i=t.attributes[r];i&&(s&&(e+=s,s=null),e+=i)}}return pT(e,i)}}function pT(t,e){switch("string"!=typeof t&&(t+=""),e){case"LowerCase":return t.toLowerCase();case"Allcaps":return t.toUpperCase();default:return t}}function fT(t,e,i,s,n,r,o=!0){const a=e/n,l=i/r,u=Math.ceil(a/2),c=Math.ceil(l/2);for(let i=0;i<r;i++)for(let h=0;h<n;h++){const d=4*(h+(o?r-i-1:i)*n);let p=0,f=0,y=0,m=0,g=0,v=0,w=0;const b=(i+.5)*l;for(let s=Math.floor(i*l);s<(i+1)*l;s++){const i=Math.abs(b-(s+.5))/c,n=(h+.5)*a,r=i*i;for(let i=Math.floor(h*a);i<(h+1)*a;i++){let o=Math.abs(n-(i+.5))/u;const a=Math.sqrt(r+o*o);a>=-1&&a<=1&&(p=2*a*a*a-3*a*a+1,p>0&&(o=4*(i+s*e),w+=p*t[o+3],y+=p,t[o+3]<255&&(p=p*t[o+3]/250),m+=p*t[o],g+=p*t[o+1],v+=p*t[o+2],f+=p))}}s[d]=m/f,s[d+1]=g/f,s[d+2]=v/f,s[d+3]=w/y}}function yT(t){return t?{r:t[0],g:t[1],b:t[2],a:t[3]/255}:{r:0,g:0,b:0,a:0}}function mT(t){var e;return null==(e=t.data)?void 0:e.symbol}function gT(t){return"CIMVectorMarker"===t.type||"CIMPictureMarker"===t.type||"CIMBarChartMarker"===t.type||"CIMCharacterMarker"===t.type||"CIMPieChartMarker"===t.type||"CIMStackedBarChartMarker"===t.type}function vT(t){return"CIMGradientStroke"===t.type||"CIMPictureStroke"===t.type||"CIMSolidStroke"===t.type}function wT(t){return"CIMGradientFill"===t.type||"CIMHatchFill"===t.type||"CIMPictureFill"===t.type||"CIMSolidFill"===t.type||"CIMWaterFill"===t.type}function bT(t){return"CIMMarkerPlacementAlongLineRandomSize"===t.type||"CIMMarkerPlacementAlongLineSameSize"===t.type||"CIMMarkerPlacementAlongLineVariableSize"===t.type||"CIMMarkerPlacementAtExtremities"===t.type||"CIMMarkerPlacementAtMeasuredUnits"===t.type||"CIMMarkerPlacementAtRatioPositions"===t.type||"CIMMarkerPlacementOnLine"===t.type||"CIMMarkerPlacementOnVertices"===t.type}function MT(t){const e=mT(t);if("CIMTextSymbol"===e.type)return e.height;let i=0;if(e.symbolLayers)for(const t of e.symbolLayers)gT(t)&&t.size>i?i=t.size:vT(t)&&t.width>i?i=t.width:wT(t);return i}function ST(t,e,i){const s=mT(t),n=MT(t);0!==n?xT(s,e/n,!1,i):function(t,e){if("CIMTextSymbol"!==t.type){if(t.symbolLayers)for(const i of t.symbolLayers)switch(i.type){case"CIMPictureMarker":case"CIMVectorMarker":i.size=e;break;case"CIMPictureStroke":case"CIMSolidStroke":i.width=e}}else t.height=e}(s,e)}function xT(t,e,i,s){if("CIMTextSymbol"!==t.type){if(i&&t.effects)for(const i of t.effects)IT(i,e);if(t.symbolLayers)for(const i of t.symbolLayers)switch(i.type){case"CIMPictureMarker":case"CIMVectorMarker":kT(i,e,s);break;case"CIMPictureStroke":case"CIMSolidStroke":null!=s&&s.preserveOutlineWidth||(i.width*=e);break;case"CIMPictureFill":i.height*=e,i.offsetX*=e,i.offsetY*=e;break;case"CIMHatchFill":xT(i.lineSymbol,e,!0,{...s,preserveOutlineWidth:!1}),i.offsetX*=e,i.offsetY*=e,i.separation*=e}}else t.height*=e}function kT(t,e,i){if(t.markerPlacement&&function(t,e){switch(bT(t)&&(t.offset*=e),t.type){case"CIMMarkerPlacementAlongLineRandomSize":case"CIMMarkerPlacementAlongLineSameSize":if(t.customEndingOffset*=e,t.offsetAlongLine*=e,t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map((t=>t*e));t.placementTemplate=i}break;case"CIMMarkerPlacementAlongLineVariableSize":if(t.maxRandomOffset*=e,t.placementTemplate&&t.placementTemplate.length){const i=t.placementTemplate.map((t=>t*e));t.placementTemplate=i}break;case"CIMMarkerPlacementOnLine":t.startPointOffset*=e;break;case"CIMMarkerPlacementAtExtremities":t.offsetAlongLine*=e;break;case"CIMMarkerPlacementAtMeasuredUnits":case"CIMMarkerPlacementOnVertices":break;case"CIMMarkerPlacementAtRatioPositions":t.beginPosition*=e,t.endPosition*=e;break;case"CIMMarkerPlacementPolygonCenter":t.offsetX*=e,t.offsetY*=e;break;case"CIMMarkerPlacementInsidePolygon":t.offsetX*=e,t.offsetY*=e,t.stepX*=e,t.stepY*=e}}(t.markerPlacement,e),t.offsetX*=e,t.offsetY*=e,t.anchorPoint&&"Absolute"===t.anchorPointUnits&&(t.anchorPoint={x:t.anchorPoint.x*e,y:t.anchorPoint.y*e}),t.size*=e,"CIMVectorMarker"===t.type&&t.markerGraphics)for(const s of t.markerGraphics)t.scaleSymbolsProportionally||xT(s.symbol,e,!0,i)}function IT(t,e){switch(t.type){case"CIMGeometricEffectArrow":case"CIMGeometricEffectDonut":t.width*=e;break;case"CIMGeometricEffectBuffer":t.size*=e;break;case"CIMGeometricEffectCut":t.beginCut*=e,t.endCut*=e,t.middleCut*=e;break;case"CIMGeometricEffectDashes":if(t.customEndingOffset*=e,t.offsetAlongLine*=e,t.dashTemplate&&t.dashTemplate.length){const i=t.dashTemplate.map((t=>t*e));t.dashTemplate=i}break;case"CIMGeometricEffectExtension":case"CIMGeometricEffectJog":case"CIMGeometricEffectRadial":t.length*=e;break;case"CIMGeometricEffectMove":t.offsetX*=e,t.offsetY*=e;break;case"CIMGeometricEffectOffset":case"CIMGeometricEffectOffsetTangent":t.offset*=e;break;case"CIMGeometricEffectRegularPolygon":t.radius*=e;break;case"CIMGeometricEffectTaperedPolygon":t.fromWidth*=e,t.length*=e,t.toWidth*=e;break;case"CIMGeometricEffectWave":t.amplitude*=e,t.period*=e}}function jT(t){const e=[];return _T(mT(t),e),e.length?new bd(yT(e[0])):null}function _T(t,e){let i;i="CIMTextSymbol"===t.type?t.symbol:t;const s="CIMPolygonSymbol"===t.type;if(i.symbolLayers)for(const t of i.symbolLayers)if(!(t.colorLocked||s&&(vT(t)||gT(t)&&t.markerPlacement&&bT(t.markerPlacement))))switch(t.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":break;case"CIMVectorMarker":t.markerGraphics.forEach((t=>{_T(t.symbol,e)}));break;case"CIMSolidStroke":case"CIMSolidFill":TT(e,t.color);break;case"CIMHatchFill":_T(t.lineSymbol,e)}}function TT(t,e){for(const i of t)if(i.join(".")===e.join("."))return;t.push(e)}function OT(t,e){e instanceof bd||(e=new bd(e)),AT(mT(t),e)}function AT(t,e){let i;i="CIMTextSymbol"===t.type?t.symbol:t;const s="CIMPolygonSymbol"===t.type;if(i.symbolLayers)for(const t of i.symbolLayers){if(t.colorLocked)continue;if(s&&(vT(t)||gT(t)&&t.markerPlacement&&bT(t.markerPlacement)))continue;const i=e.toArray(0);switch(t.type){case"CIMPictureMarker":case"CIMPictureStroke":case"CIMPictureFill":break;case"CIMVectorMarker":t.markerGraphics.forEach((t=>{AT(t.symbol,e)}));break;case"CIMSolidStroke":case"CIMSolidFill":t.color=i;break;case"CIMHatchFill":AT(t.lineSymbol,e)}}}function FT(t){return c(t)?ls():t.then((t=>({ok:!0,value:t}))).catch((t=>({ok:!1,error:t})))}function CT(t){return t.then((t=>({ok:!0,value:t}))).catch((t=>(Ki(t),{ok:!1,error:t})))}class PT{constructor(t,e){this._storage=new a_,this._storage.maxSize=t,e&&this._storage.registerRemoveFunc("",e)}put(t,e){this._storage.put(t,e,1,1)}pop(t){return this._storage.pop(t)}get(t){return this._storage.get(t)}clear(){this._storage.clearAll()}destroy(){this._storage.destroy()}}const ET="simple-fill",RT="simple-marker",LT=new PT(1e3);function NT(t){const e=t.style;let i=null;if(t)switch(t.type){case RT:"cross"!==e&&"x"!==e&&(i=t.color);break;case ET:"solid"===e?i=t.color:"none"!==e&&(i={type:"pattern",x:0,y:0,src:lr(`esri/symbols/patterns/${e}.png`),width:5,height:5});break;case"picture-fill":i={type:"pattern",src:t.url,width:cm(t.width)*t.xscale,height:cm(t.height)*t.yscale,x:cm(t.xoffset),y:cm(t.yoffset)};break;case"text":i=t.color;break;case"cim":i=jT(t)}return i}function DT(t,e){const i=t+"-"+e;return void 0!==LT.get(i)?Promise.resolve(LT.get(i)):$n(t,{responseType:"image"}).then((t=>{const s=t.data,n=s.naturalWidth,r=s.naturalHeight,o=document.createElement("canvas");o.width=n,o.height=r;const a=o.getContext("2d");a.fillStyle=e,a.fillRect(0,0,n,r),a.globalCompositeOperation="destination-in",a.drawImage(s,0,0);const l=o.toDataURL();return LT.put(i,l),l}))}function VT(t){if(!t)return null;let e;switch(t.type){case ET:case"picture-fill":case RT:e=VT(t.outline);break;case"simple-line":{const i=cm(t.width);"none"!==t.style&&0!==i&&(e={color:t.color,style:$T(t.style),width:i,cap:t.cap,join:"miter"===t.join?cm(t.miterLimit):t.join});break}default:e=null}return e}const $T=function(){const t={};return function(e){if(t[e])return t[e];const i=e.replace(/-/g,"");return t[e]=i,i}}(),zT=new bd([128,128,128]),GT=/\/resource\/(.*?)\.svg$/,UT=new bd("white");function qT(t){if(!t)return 0;if(Ub(t)){const e=function(t){const e=t.symbolLayers&&t.symbolLayers.length;if(!e)return;const i=t.symbolLayers.getItemAt(e-1);return"outline"in i?I(i,"outline","size"):void 0}(t);return u(e)?e:0}const e=VT(t);return e&&hm(e.width)||0}function BT(t){if(c(t)||!("symbolLayers"in t)||c(t.symbolLayers))return!1;switch(t.type){case"point-3d":return t.symbolLayers.some((t=>"object"===t.type));case"line-3d":return t.symbolLayers.some((t=>"path"===t.type));case"polygon-3d":return t.symbolLayers.some((t=>"object"===t.type||"extrude"===t.type));default:return!1}}function WT(t,e){const i=e.resource.href;return!l("esri-canvas-svg-support")&&t.styleOrigin&&GT.test(i)?i.replace(GT,"/resource/png/$1.png"):i}function HT(t,e){if(null==e)return t;const i=t.toRgba();return i[3]=i[3]*e,new bd(i)}function JT(t,e,i){t&&(e||null!=i)&&(e&&(e=new bd(e)),Ub(t)?function(t,e,i){const s=t.symbolLayers;if(!s)return;const n=t=>{const s=u(t)?t:null;return HT(e=e||s||null!=i&&UT,i)};s.forEach((t=>{if("object"!==t.type||null==t.resource.href||e)if("water"===t.type)t.color=n(t.color);else{const e=u(t.material)?t.material.color:null,s=n(e);c(t.material)?t.material=new Om({color:s}):t.material.color=s,null!=i&&"outline"in t&&u(t.outline)&&u(t.outline.color)&&(t.outline.color=HT(t.outline.color,i))}}))}(t,e,i):Gb(t)&&function(t,e,i){(e=e||t.color)&&(t.color=HT(e,i)),null!=i&&"outline"in t&&t.outline&&t.outline.color&&(t.outline.color=HT(t.outline.color,i))}(t,e,i))}function ZT(t){for(const e of t)if("number"==typeof e)return e;return null}function QT(t,e,i){for(let s=0;s<3;s++){const n=t[s];switch(n){case"symbol-value":return null!=i[s]?i[s]/e[s]:1;case"proportional":break;default:if(n&&e[s])return n/e[s]}}return 1}function KT(t,e,i,s){switch(t){case"proportional":return i*s;case"symbol-value":return null!=e?e:i;default:return t}}async function YT(t,e){if(t&&e)return Ub(t)?async function(t,e){const i=t.symbolLayers;i&&await function(t,e){return rs(t.map((t=>e(t))))}(i,(async t=>async function(t,e){switch(t.type){case"extrude":!function(t,e){t.size="number"==typeof e[2]?e[2]:0}(t,e);break;case"icon":case"line":case"text":!function(t,e){const i=ZT(e);u(i)&&(t.size=i)}(t,e);break;case"path":!function(t,e){const i=QT(e,uh,[t.width,void 0,t.height]);t.width=KT(e[0],t.width,1,i),t.height=KT(e[2],t.height,1,i)}(t,e);break;case"object":await async function(t,e){const{resourceSize:i,symbolSize:s}=await async function(t){const e=await import("./p-e42138c1.js"),i=await e.computeObjectLayerResourceSize(t,10),{width:s,height:n,depth:r}=t,o=[s,r,n];let a=1;for(let t=0;t<3;t++)if(null!=o[t]){a=o[t]/i[t];break}for(let t=0;t<3;t++)null==o[t]&&(o[t]=i[t]*a);return{resourceSize:i,symbolSize:o}}(t),n=QT(e,i,s);t.width=KT(e[0],s[0],i[0],n),t.depth=KT(e[1],s[1],i[1],n),t.height=KT(e[2],s[2],i[2],n)}(t,e)}}(t,e)))}(t,e):void(Gb(t)&&function(t,e){const i=ZT(e);if(!c(i))switch(t.type){case"simple-marker":t.size=i;break;case"picture-marker":{const e=t.width/t.height;e>1?(t.width=i,t.height=i*e):(t.width=i*e,t.height=i);break}case"simple-line":t.width=i;break;case"text":t.font.size=i}}(t,e))}function XT(t,e,i){if(t&&null!=e)if(Ub(t)){const s=t.symbolLayers;s&&s.forEach((t=>{if(t&&"object"===t.type)switch(i){case"tilt":t.tilt=e;break;case"roll":t.roll=e;break;default:t.heading=e}}))}else Gb(t)&&("simple-marker"!==t.type&&"picture-marker"!==t.type&&"text"!==t.type||(t.angle=e))}let tO=null;function eO(t,e){return Math.floor(Math.random()*(e-t+1)+t)}function iO(t,e,i){const{backgroundColor:s,outline:n,dotSize:r}=t,o=i&&i.swatchSize||22,a=Math.round(o*o/r**2*.8),l=window.devicePixelRatio,u=document.createElement("canvas"),c=o*l;u.width=c,u.height=c,u.style.width=u.width/l+"px",u.style.height=u.height/l+"px";const h=u.getContext("2d");if(s&&(h.fillStyle=s.toCss(!0),h.fillRect(0,0,c,c),h.fill()),h.fillStyle=e.toCss(!0),tO&&tO.length/2===a)for(let t=0;t<2*a;t+=2)h.fillRect(tO[t],tO[t+1],r*l,r*l),h.fill();else{tO=[];for(let t=0;t<2*a;t+=2){const t=eO(0,c),e=eO(0,c);tO.push(t,e),h.fillRect(t,e,r*l,r*l),h.fill()}}n&&(n.color&&(h.strokeStyle=n.color.toCss(!0)),h.lineWidth=n.width,h.strokeRect(0,0,c,c));const d=new Image(o,o);return d.src=u.toDataURL(),d.style.filter=i.effect,d}function sO(t,e={}){const i="horizontal"===e.align,s=i?75:24,n=i?24:75,{width:r=s,height:o=n,gradient:a=!0}=e,l=window.devicePixelRatio,u=r*l,c=o*l,h=document.createElement("canvas");h.width=u,h.height=c,h.style.width=r+"px",h.style.height=o+"px";const d=h.getContext("2d");if(a){const e=d.createLinearGradient(0,0,i?u:0,i?0:c),s=t.length,n=1===s?0:1/(s-1);t.forEach(((t,i)=>e.addColorStop(i*n,""+t))),d.fillStyle=e,d.fillRect(0,0,u,c)}else{const e=i?u/t.length:u,s=i?c:c/t.length;let n=0,r=0;for(const o of t)d.fillStyle=""+o,d.fillRect(n,r,e,s),n=i?n+e:0,r=i?0:r+s}const p=document.createElement("div");return p.style.width=r+"px",p.style.height=o+"px",p.style.filter=null==e?void 0:e.effect,p.appendChild(h),p}async function nO(t,e){switch(t.type){case"web-style":{const{previewWebStyleSymbol:i}=await import("./p-5b856c63.js");return i(t,nO,e)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:i}=await import("./p-36439801.js");return i(t,e)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:i}=await import("./p-86306d05.js");return i(t,e)}case"cim":{const{previewCIMSymbol:i}=await import("./p-cc7add1a.js");return i(t,e)}default:return}}function rO(t){return t&&"opacity"in t?t.opacity*rO(t.parent):1}async function oO(t,e){var i,s;if(!t)return;const n=t.sourceLayer,r=null!=(i=u(e)&&null!=(s=e.useSourceLayer)&&s?n:t.layer)?i:n,o=rO(r);if(u(t.symbol)&&(!u(e)||!0!==e.ignoreGraphicSymbol)){const i="web-style"===t.symbol.type?await t.symbol.fetchSymbol(u(e)?e.abortOptions:null):t.symbol.clone();return JT(i,null,o),i}const a=u(e)&&e.renderer||r&&"renderer"in r&&r.renderer;let l=a&&"getSymbolAsync"in a?await a.getSymbolAsync(t,e):null;if(!l)return;if(l="web-style"===l.type?await l.fetchSymbol(u(e)?e.abortOptions:null):l.clone(),!("visualVariables"in a)||!a.visualVariables||!a.visualVariables.length)return JT(l,null,o),l;if("arcadeRequiredForVisualVariables"in a&&a.arcadeRequiredForVisualVariables&&(c(e)||c(e.arcade))){const t={...e};t.arcade=await ay(),e=t}const h=await Promise.resolve().then((function(){return _j})),d=[],p=[],f=[],y=[];for(const t of a.visualVariables)switch(t.type){case"color":d.push(t);break;case"opacity":p.push(t);break;case"rotation":y.push(t);break;case"size":t.target||f.push(t)}const m=!!d.length&&d[d.length-1],g=m?h.getColor(m,t,e):null,v=!!p.length&&p[p.length-1];let w=v?h.getOpacity(v,t,e):null;if(null!=o&&(w=null!=w?w*o:o),JT(l,g,w),f.length){const i=h.getAllSizes(f,t,e);await YT(l,i)}for(const i of y)XT(l,h.getRotationAngle(i,t,e),i.axis);return l}function aO(){const t=new Float32Array(6);return t[0]=1,t[3]=1,t}function lO(t,e,i,s){const n=e[s],r=e[s+1];t[s]=i[0]*n+i[2]*r+i[4],t[s+1]=i[1]*n+i[3]*r+i[5]}function uO(t,e,i,s=0,n=0,r=2){const o=n||e.length/r;for(let n=s;n<o;n++)lO(t,e,i,n*r)}function cO(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function hO(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5];let l=i*r-s*n;return l?(l=1/l,t[0]=r*l,t[1]=-s*l,t[2]=-n*l,t[3]=i*l,t[4]=(n*a-r*o)*l,t[5]=(s*o-i*a)*l,t):null}function dO(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1],h=i[2],d=i[3],p=i[4],f=i[5];return t[0]=s*u+r*c,t[1]=n*u+o*c,t[2]=s*h+r*d,t[3]=n*h+o*d,t[4]=s*p+r*f+a,t[5]=n*p+o*f+l,t}function pO(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=Math.sin(i),c=Math.cos(i);return t[0]=s*c+r*u,t[1]=n*c+o*u,t[2]=s*-u+r*c,t[3]=n*-u+o*c,t[4]=a,t[5]=l,t}function fO(t,e,i){const s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=i[0],u=i[1];return t[0]=e[0]*l,t[1]=s*l,t[2]=n*u,t[3]=r*u,t[4]=o,t[5]=a,t}function yO(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=i[0],c=i[1];return t[0]=s,t[1]=n,t[2]=r,t[3]=o,t[4]=s*u+r*c+a,t[5]=n*u+o*c+l,t}function mO(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=-i,t[3]=s,t[4]=0,t[5]=0,t}function gO(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function vO(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t}Object.freeze({__proto__:null,create:aO,clone:function(t){const e=new Float32Array(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},fromValues:function(t,e,i,s,n,r){const o=new Float32Array(6);return o[0]=t,o[1]=e,o[2]=i,o[3]=s,o[4]=n,o[5]=r,o},createView:function(t,e){return new Float32Array(t,e,6)},transform:lO,transformMany:uO}),Object.freeze({__proto__:null,copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},identity:cO,set:function(t,e,i,s,n,r,o){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t[4]=r,t[5]=o,t},invert:hO,determinant:function(t){return t[0]*t[3]-t[1]*t[2]},multiply:dO,rotate:pO,scale:fO,translate:yO,fromRotation:mO,fromScaling:gO,fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},str:function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},frob:function(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+1)},add:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t},subtract:vO,multiplyScalar:function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t},multiplyScalarAndAdd:function(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t[3]=e[3]+i[3]*s,t[4]=e[4]+i[4]*s,t[5]=e[5]+i[5]*s,t},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},equals:function(t,e){const i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],l=e[0],u=e[1],c=e[2],h=e[3],d=e[4],p=e[5];return Math.abs(i-l)<=ph*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(s-u)<=ph*Math.max(1,Math.abs(s),Math.abs(u))&&Math.abs(n-c)<=ph*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(r-h)<=ph*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(o-d)<=ph*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(a-p)<=ph*Math.max(1,Math.abs(a),Math.abs(p))},mul:dO,sub:vO});function wO(t,e){const i="h"+od(Math.ceil(t.level),1,6);return delete t.level,Bc(i,{...t,class:Ol("esri-widget__heading",t.class)},e)}function bO(t){return t&&"function"==typeof t.highlight}function MO(t,e){return e?{...e,query:{...t,...e.query}}:{query:t}}function SO(t){return"string"==typeof t?Vs(t):t}function xO(t,e,i){const s={};for(const n in t){if("declaredClass"===n)continue;const r=t[n];if(null!=r&&"function"!=typeof r)if(Array.isArray(r)){s[n]=[];for(let t=0;t<r.length;t++)s[n][t]=xO(r[t])}else if("object"==typeof r)if(r.toJSON){const t=r.toJSON(i&&i[n]);s[n]=e?t:JSON.stringify(t)}else s[n]=e?r:JSON.stringify(r);else s[n]=r}return s}let kO=class extends jo{constructor(...t){super(...t),this.requestOptions=null,this.url=null}normalizeCtorArgs(t,e){return"string"!=typeof t?t:{url:t,...e}}get parsedUrl(){return this._parseUrl(this.url)}_parseUrl(t){return t?Vs(t):null}_encode(t,e,i){const s={};for(const n in t){if("declaredClass"===n)continue;const r=t[n];if(null!=r&&"function"!=typeof r)if(Array.isArray(r)){s[n]=[];for(let t=0;t<r.length;t++)s[n][t]=this._encode(r[t])}else if("object"==typeof r)if(r.toJSON){const t=r.toJSON(i&&i[n]);s[n]=e?t:JSON.stringify(t)}else s[n]=e?r:JSON.stringify(r);else s[n]=r}return s}};e([oe({readOnly:!0})],kO.prototype,"parsedUrl",null),e([oe()],kO.prototype,"requestOptions",void 0),e([oe({type:String})],kO.prototype,"url",void 0),kO=e([si("esri.tasks.Task")],kO);const IO=kO,jO=t=>{let i=class extends t{constructor(...t){super(...t),this.goToOverride=null,this.view=null}callGoTo(t){const{view:e}=this;return this.goToOverride?this.goToOverride(e,t):e.goTo(t.target,t.options)}};return e([oe()],i.prototype,"goToOverride",void 0),e([oe()],i.prototype,"view",void 0),i=e([si("esri.widgets.support.GoTo")],i),i};async function _O(t,e){return await t.load(),TO(t,e)}async function TO(t,e){const i=[],s=(...t)=>{for(const e of t)c(e)||(Array.isArray(e)?s(...e):qo.isCollection(e)?e.forEach((t=>s(t))):Av.isLoadable(e)&&i.push(e))};e(s);let n=null;if(await function(t,e){return rs(t.map((t=>e(t)))).then((t=>t.map((t=>t.value))))}(i,(async t=>{!1!==(await FT(function(t){return"loadAll"in t&&"function"==typeof t.loadAll}(t)?t.loadAll():t.load())).ok||n||(n=t)})),n)throw n.loadError;return t}const OO=ct.getLogger("esri.portal.PortalItemResource");let AO=class extends jo{constructor(t){super(t),this.portalItem=null}normalizeCtorArgs(t){return t&&t.portalItem&&t.path?{...t,path:this.normalizePath(t.path,t.portalItem)}:t}set path(t){u(t)&&on(t)?OO.error("portalitemresource:invalid-path","A portal item resource path must be relative"):this._set("path",t)}_castPath(t){return this.normalizePath(t,this.portalItem)}get url(){return this.portalItem&&this.path?`${this.portalItem.itemUrl}/resources/${this.path}`:null}get itemRelativeUrl(){return this.portalItem&&this.path?"./resources/"+this.path:null}fetch(t="json",e){const i=this.url;if(c(i))throw new Ve("portal-item-resource:fetch","Portal item resource does not refer to a valid item or path");return this.portalItem.portal._request(i,{responseType:t,query:{token:this.portalItem.apiKey},signal:I(e,"signal")})}async update(t,e){return(await import("./p-bb20f481.js")).addOrUpdateResource(this,"update",t,e)}hasPath(){return u(this.path)}normalizePath(t,e){return c(t)?t:(t=t.replace(/^\/+/,""),u(e)&&on(t)&&(t=en(t,e.itemUrl)),t.replace(/^\/+/,"").replace(/^(\.\/)?resources\//,""))}};e([oe()],AO.prototype,"portalItem",void 0),e([oe({type:String,value:null})],AO.prototype,"path",null),e([ba("path")],AO.prototype,"_castPath",null),e([oe({type:String,readOnly:!0})],AO.prototype,"url",null),e([oe({type:String,readOnly:!0})],AO.prototype,"itemRelativeUrl",null),AO=e([si("esri.portal.PortalItemResource")],AO);const FO=AO;let CO=class extends jo{constructor(t){super(t),this.created=null,this.rating=null}};e([oe()],CO.prototype,"created",void 0),e([oe()],CO.prototype,"rating",void 0),CO=e([si("esri.portal.PortalRating")],CO);const PO=CO;var EO;let RO=EO=class extends(Ld(Av)){constructor(t){super(t),this.access=null,this.accessInformation=null,this.apiKey=null,this.applicationProxies=null,this.avgRating=null,this.categories=null,this.created=null,this.culture=null,this.description=null,this.extent=null,this.groupCategories=null,this.id=null,this.itemControl=null,this.licenseInfo=null,this.modified=null,this.name=null,this.numComments=null,this.numRatings=null,this.numViews=null,this.owner=null,this.ownerFolder=null,this.portal=null,this.screenshots=null,this.size=null,this.snippet=null,this.sourceJSON=null,this.tags=null,this.title=null,this.type=null,this.typeKeywords=null,this.url=null}static from(t){return kt(EO,t)}destroy(){this.portal=null}get displayName(){const t=this.type,e=this.typeKeywords||[];let i=t;return"Feature Service"===t||"Feature Collection"===t?i=e.indexOf("Table")>-1?"Table":e.indexOf("Route Layer")>-1?"Route Layer":e.indexOf("Markup")>-1?"Markup":"Feature Layer":"Image Service"===t?i=e.indexOf("Elevation 3D Layer")>-1?"Elevation Layer":e.indexOf("Tiled Imagery")>-1?"Tiled Imagery Layer":"Imagery Layer":"Scene Service"===t?i="Scene Layer":"Scene Package"===t?i="Scene Layer Package":"Stream Service"===t?i="Feature Layer":"Geoprocessing Service"===t&&this.portal&&this.portal.isPortal?i=e.indexOf("Web Tool")>-1?"Tool":"Geoprocessing Service":"Geocoding Service"===t?i="Locator":"Geoenrichment Service"===t?i="GeoEnrichment Service":"Microsoft Powerpoint"===t?i="Microsoft PowerPoint":"GeoJson"===t?i="GeoJSON":"Globe Service"===t?i="Globe Layer":"Vector Tile Service"===t?i="Tile Layer":"netCDF"===t?i="NetCDF":"Map Service"===t?i=-1===e.indexOf("Spatiotemporal")&&(e.indexOf("Hosted Service")>-1||e.indexOf("Tiled")>-1)&&-1===e.indexOf("Relational")?"Tile Layer":"Map Image Layer":t&&t.toLowerCase().indexOf("add in")>-1?i=t.replace(/(add in)/gi,"Add-In"):"datastore catalog service"===t?i="Big Data File Share":"Compact Tile Package"===t?i="Tile Package (tpkx)":"OGCFeatureServer"===t&&(i="OGC Feature Layer"),i}readExtent(t){return t&&t.length?new of(t[0][0],t[0][1],t[1][0],t[1][1]):null}get iconUrl(){const t=this.type&&this.type.toLowerCase()||"",e=this.typeKeywords||[];let i,s=!1,n=!1,r=!1,o=!1,a=!1,l=!1;return t.indexOf("service")>0||"feature collection"===t||"kml"===t||"wms"===t||"wmts"===t||"wfs"===t?(s=e.indexOf("Hosted Service")>-1,"feature service"===t||"feature collection"===t||"kml"===t||"wfs"===t?(n=e.indexOf("Table")>-1,r=e.indexOf("Route Layer")>-1,o=e.indexOf("Markup")>-1,a=-1!==e.indexOf("Spatiotemporal"),l=-1!==e.indexOf("UtilityNetwork"),i=a&&n?"spatiotemporaltable":n?"table":r?"routelayer":o?"markup":a?"spatiotemporal":s?"featureshosted":l?"utilitynetwork":"features"):i="map service"===t||"wms"===t||"wmts"===t?s||e.indexOf("Tiled")>-1||"wmts"===t?"maptiles":"mapimages":"scene service"===t?e.indexOf("Line")>-1?"sceneweblayerline":e.indexOf("3DObject")>-1?"sceneweblayermultipatch":e.indexOf("Point")>-1?"sceneweblayerpoint":e.indexOf("IntegratedMesh")>-1?"sceneweblayermesh":e.indexOf("PointCloud")>-1?"sceneweblayerpointcloud":e.indexOf("Polygon")>-1?"sceneweblayerpolygon":e.indexOf("Building")>-1?"sceneweblayerbuilding":e.indexOf("Voxel")>-1?"sceneweblayervoxel":"sceneweblayer":"image service"===t?e.indexOf("Elevation 3D Layer")>-1?"elevationlayer":e.indexOf("Tiled Imagery")>-1?"tiledimagerylayer":"imagery":"stream service"===t?"streamlayer":"vector tile service"===t?"vectortile":"datastore catalog service"===t?"datastorecollection":"geocoding service"===t?"geocodeservice":"geoprocessing service"===t&&e.indexOf("Web Tool")>-1&&this.portal&&this.portal.isPortal?"tool":"layers"):i="web map"===t||"cityengine web scene"===t?"maps":"web scene"===t?e.indexOf("ViewingMode-Local")>-1?"webscenelocal":"websceneglobal":"web mapping application"===t||"mobile application"===t||"application"===t||"operation view"===t||"desktop application"===t?"apps":"map document"===t||"map package"===t||"published map"===t||"scene document"===t||"globe document"===t||"basemap package"===t||"mobile basemap package"===t||"mobile map package"===t||"project package"===t||"project template"===t||"pro map"===t||"layout"===t||"layer"===t&&e.indexOf("ArcGIS Pro")>-1||"explorer map"===t&&e.indexOf("Explorer Document")?"mapsgray":"service definition"===t||"csv"===t||"shapefile"===t||"cad drawing"===t||"geojson"===t||"360 vr experience"===t||"netcdf"===t||"administrative report"===t?"datafiles":"explorer add in"===t||"desktop add in"===t||"windows viewer add in"===t||"windows viewer configuration"===t?"appsgray":"arcgis pro add in"===t||"arcgis pro configuration"===t?"addindesktop":"rule package"===t||"file geodatabase"===t||"sqlite geodatabase"===t||"csv collection"===t||"kml collection"===t||"windows mobile package"===t||"map template"===t||"desktop application template"===t||"gml"===t||"arcpad package"===t||"code sample"===t||"form"===t||"document link"===t||"earth configuration"===t||"operations dashboard add in"===t||"rules package"===t||"image"===t||"workflow manager package"===t||"explorer map"===t&&e.indexOf("Explorer Mapping Application")>-1||e.indexOf("Document")>-1?"datafilesgray":"network analysis service"===t||"geoprocessing service"===t||"geodata service"===t||"geometry service"===t||"geoprocessing package"===t||"locator package"===t||"geoprocessing sample"===t||"workflow manager service"===t?"toolsgray":"layer"===t||"layer package"===t||"explorer layer"===t?"layersgray":"scene package"===t?"scenepackage":"mobile scene package"===t?"mobilescenepackage":"tile package"===t||"compact tile package"===t?"tilepackage":"task file"===t?"taskfile":"report template"===t?"report-template":"statistical data collection"===t?"statisticaldatacollection":"insights workbook"===t?"workbook":"insights model"===t?"insightsmodel":"insights page"===t?"insightspage":"insights theme"===t?"insightstheme":"hub initiative"===t?"hubinitiative":"hubpage"===t?"hubpage":"hub event"===t?"hubevent":"hub site application"===t?"hubsite":"relational database connection"===t?"relationaldatabaseconnection":"big data file share"===t?"datastorecollection":"image collection"===t?"imagecollection":"style"===t?"style":"desktop style"===t?"desktopstyle":"dashboard"===t?"dashboard":"raster function template"===t?"rasterprocessingtemplate":"vector tile package"===t?"vectortilepackage":"ortho mapping project"===t?"orthomappingproject":"ortho mapping template"===t?"orthomappingtemplate":"solution"===t?"solutions":"geopackage"===t?"geopackage":"deep learning package"===t?"deeplearningpackage":"real time analytic"===t?"realtimeanalytics":"big data analytic"===t?"bigdataanalytics":"feed"===t?"feed":"excalibur imagery project"===t?"excaliburimageryproject":"notebook"===t?"notebook":"storymap"===t?"storymap":"survey123 add in"===t?"survey123addin":"mission"===t?"mission":"mission report"===t?"missionreport":"quickcapture project"===t?"quickcaptureproject":"pro report"===t?"proreport":"urban model"===t?"urbanmodel":"web experience"===t?"experiencebuilder":"web experience template"===t?"webexperiencetemplate":"workflow"===t?"workflow":"insights script"===t?"insightsscript":"kernel gateway connection"===t?"kernelgatewayconnection":"hub initiative template"===t?"hubinitiativetemplate":"storymap theme"===t?"storymaptheme":"knowledge graph"===t?"knowledgegraph":"native application"===t?"nativeapp":"native application installer"===t?"nativeappinstaller":"link chart"===t?"linkchart":"investigation"===t?"investigation":"ogcfeatureserver"===t?"features":"pro project"===t?"proproject":"insights workbook package"===t?"insightsworkbookpackage":"apache parquet"===t?"apacheparquet":"maps",i?lr("esri/images/portal/"+i+"16.png"):null}get isLayer(){return["Map Service","Feature Service","Feature Collection","Scene Service","Image Service","Stream Service","Vector Tile Service","WMTS","WMS"].indexOf(this.type)>-1}get itemUrl(){const t=this.get("portal.restUrl");return t?t+"/content/items/"+this.id:null}get thumbnailUrl(){const t=this.itemUrl,e=this.thumbnail;return t&&e?this.portal._normalizeUrl(`${t}/info/${e}?f=json`):null}get userItemUrl(){const t=this.get("portal.restUrl");if(!t)return null;const e=this.owner||this.get("portal.user.username");return e?`${t}/content/users/${this.ownerFolder?`${e}/${this.ownerFolder}`:e}/items/${this.id}`:null}load(t){this.portal||(this.portal=Qv.getDefault());const e=this.portal.load(t).then((()=>this.sourceJSON?this.sourceJSON:this.id&&this.itemUrl?this.portal._request(this.itemUrl,{signal:u(t)?t.signal:null,query:{token:this.apiKey}}):{})).then((t=>{this.sourceJSON=t,this.read(t)}));return this.addResolvingPromise(e),Promise.resolve(this)}addRating(t){const e={method:"post",query:{}};return t instanceof PO&&(t=t.rating),isNaN(t)||"number"!=typeof t||(e.query.rating=t),this.portal._request(this.itemUrl+"/addRating",e).then((()=>new PO({rating:t,created:new Date})))}clone(){const t={access:this.access,accessInformation:this.accessInformation,applicationProxies:H(this.applicationProxies),avgRating:this.avgRating,categories:H(this.categories),created:H(this.created),culture:this.culture,description:this.description,extent:H(this.extent),groupCategories:H(this.groupCategories),id:this.id,itemControl:this.itemControl,licenseInfo:this.licenseInfo,modified:H(this.modified),name:this.name,numComments:this.numComments,numRatings:this.numRatings,numViews:this.numViews,owner:this.owner,ownerFolder:this.ownerFolder,portal:this.portal,screenshots:H(this.screenshots),size:this.size,snippet:this.snippet,tags:H(this.tags),thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:H(this.typeKeywords),url:this.url};return this.loaded&&(t.loadStatus="loaded"),new EO({sourceJSON:this.sourceJSON}).set(t)}createPostQuery(){const t=this.toJSON();for(const e in t)"tags"===e&&null!==t[e]&&(t[e]=t[e].join(", ")),"typeKeywords"===e&&null!==t[e]&&(t[e]=t[e].join(", ")),"extent"===e&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}deleteRating(){return this.portal._request(this.itemUrl+"/deleteRating",{method:"post"}).then((()=>{}))}fetchData(t="json",e){return this.portal._request(this.itemUrl+"/data",{responseType:t,...e,query:{token:this.apiKey}})}fetchRating(t){return this.portal._request(this.itemUrl+"/rating",{query:{token:this.apiKey},...t}).then((t=>null!=t.rating?(t.created=new Date(t.created),new PO(t)):null))}fetchRelatedItems(t,e){return this.portal._requestToTypedArray(this.itemUrl+"/relatedItems",{query:{...t,token:this.apiKey},...e},EO)}getThumbnailUrl(t){let e=this.thumbnailUrl;return e&&t&&(e+="&w="+t),e}reload(){return this.portal._request(this.itemUrl,{cacheBust:!0,query:{token:this.apiKey}}).then((t=>(this.sourceJSON=t,this.read(t),this)))}update(t){return this.id?this.load().then((()=>this.portal._signIn())).then((()=>{const e=t&&t.data,i={method:"post"};i.query=this.createPostQuery();for(const t in i.query)null===i.query[t]&&(i.query[t]="");return i.query.clearEmptyFields=!0,null!=e&&("string"==typeof e?i.query.text=e:"object"==typeof e&&(i.query.text=JSON.stringify(e))),this.portal._request(this.userItemUrl+"/update",i).then((()=>this.reload()))})):Promise.reject(new Ve("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}updateThumbnail(t){return this.id?this.load().then((()=>this.portal._signIn())).then((()=>{const e=t.thumbnail,i=t.filename,s={method:"post"};if("string"==typeof e)s.query=ln(e)?{data:e}:{url:tn(e)},u(i)&&(s.query.filename=i);else{const t=new FormData;u(i)?t.append("file",e,i):t.append("file",e),s.body=t}return this.portal._request(this.userItemUrl+"/updateThumbnail",s).then((()=>this.reload()))})):Promise.reject(new Ve("portal:item-does-not-exist","The item does not exist yet and cannot be updated"))}async fetchResources(t={},e){return(await import("./p-bb20f481.js")).fetchResources(this,t,e)}async addResource(t,e,i){const s=await import("./p-bb20f481.js");return t.portalItem=this,s.addOrUpdateResource(t,"add",e,i)}async removeResource(t,e){const i=await import("./p-bb20f481.js");if(t.portalItem&&t.portalItem.itemUrl!==this.itemUrl)throw new Ve("removeresource:portal-item-mismatch","The portal item associated with the provided resource does not match the item");return i.removeResource(this,t,e)}async removeAllResources(t){return(await import("./p-bb20f481.js")).removeAllResources(this,t)}resourceFromPath(t){return new FO({portalItem:this,path:t})}toJSON(){const t=this.extent;return W({created:this.created&&this.created.getTime(),description:this.description,extent:t&&[[t.xmin,t.ymin],[t.xmax,t.ymax]],id:this.id,modified:this.modified&&this.modified.getTime(),name:this.name,owner:this.owner,ownerFolder:this.ownerFolder,snippet:this.snippet,tags:this.tags,thumbnail:this.thumbnail,title:this.title,type:this.type,typeKeywords:this.typeKeywords,url:this.url})}static fromJSON(t){if(!t)return null;if(t.declaredClass)throw Error("JSON object is already hydrated");return new EO({sourceJSON:t})}_getPostQuery(){const t=this.toJSON();for(const e in t)"tags"===e&&null!==t[e]&&(t[e]=t[e].join(", ")),"typeKeywords"===e&&null!==t[e]&&(t[e]=t[e].join(", ")),"extent"===e&&t[e]&&(t[e]=JSON.stringify(t[e]));return t}};e([oe({type:["private","shared","org","public"]})],RO.prototype,"access",void 0),e([oe()],RO.prototype,"accessInformation",void 0),e([oe({type:String})],RO.prototype,"apiKey",void 0),e([oe({json:{read:{source:"appProxies"}}})],RO.prototype,"applicationProxies",void 0),e([oe()],RO.prototype,"avgRating",void 0),e([oe()],RO.prototype,"categories",void 0),e([oe({type:Date})],RO.prototype,"created",void 0),e([oe()],RO.prototype,"culture",void 0),e([oe()],RO.prototype,"description",void 0),e([oe({readOnly:!0})],RO.prototype,"displayName",null),e([oe({type:of})],RO.prototype,"extent",void 0),e([Sd("extent")],RO.prototype,"readExtent",null),e([oe()],RO.prototype,"groupCategories",void 0),e([oe({readOnly:!0})],RO.prototype,"iconUrl",null),e([oe()],RO.prototype,"id",void 0),e([oe({readOnly:!0})],RO.prototype,"isLayer",null),e([oe()],RO.prototype,"itemControl",void 0),e([oe({readOnly:!0})],RO.prototype,"itemUrl",null),e([oe()],RO.prototype,"licenseInfo",void 0),e([oe({type:Date})],RO.prototype,"modified",void 0),e([oe()],RO.prototype,"name",void 0),e([oe()],RO.prototype,"numComments",void 0),e([oe()],RO.prototype,"numRatings",void 0),e([oe()],RO.prototype,"numViews",void 0),e([oe()],RO.prototype,"owner",void 0),e([oe()],RO.prototype,"ownerFolder",void 0),e([oe({type:Qv})],RO.prototype,"portal",void 0),e([oe()],RO.prototype,"screenshots",void 0),e([oe()],RO.prototype,"size",void 0),e([oe()],RO.prototype,"snippet",void 0),e([oe()],RO.prototype,"sourceJSON",void 0),e([oe()],RO.prototype,"tags",void 0),e([oe()],RO.prototype,"thumbnail",void 0),e([oe({readOnly:!0})],RO.prototype,"thumbnailUrl",null),e([oe()],RO.prototype,"title",void 0),e([oe()],RO.prototype,"type",void 0),e([oe()],RO.prototype,"typeKeywords",void 0),e([oe()],RO.prototype,"url",void 0),e([oe({readOnly:!0})],RO.prototype,"userItemUrl",null),RO=EO=e([si("esri.portal.PortalItem")],RO);const LO=RO,NO=Object.freeze({__proto__:null,default:LO}),DO={streets:{id:"streets",classic:!0,deprecated:!0,get thumbnailUrl(){return lr("esri/images/basemap/streets.jpg")},baseMapLayers:[{id:"streets-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Street Map",showLegend:!1,visibility:!0,opacity:1}]},satellite:{id:"satellite",classic:!0,get thumbnailUrl(){return lr("esri/images/basemap/satellite.jpg")},baseMapLayers:[{id:"satellite-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1}]},hybrid:{id:"hybrid",classic:!0,get thumbnailUrl(){return lr("esri/images/basemap/hybrid.jpg")},baseMapLayers:[{id:"hybrid-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Imagery",showLegend:!1,visibility:!0,opacity:1},{id:"hybrid-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Boundaries and Places",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},terrain:{id:"terrain",classic:!0,get thumbnailUrl(){return lr("esri/images/basemap/terrain.jpg")},baseMapLayers:[{id:"terrain-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Terrain Base",showLegend:!1,visibility:!0,opacity:1},{id:"terrain-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Reference Overlay",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},topo:{id:"topo",classic:!0,deprecated:!0,get thumbnailUrl(){return lr("esri/images/basemap/topo.jpg")},baseMapLayers:[{id:"topo-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Topo Map",showLegend:!1,visibility:!0,opacity:1}]},gray:{id:"gray",classic:!0,deprecated:!0,get thumbnailUrl(){return lr("esri/images/basemap/gray.jpg")},baseMapLayers:[{id:"gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Light Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"dark-gray":{id:"dark-gray",classic:!0,deprecated:!0,get thumbnailUrl(){return lr("esri/images/basemap/dark-gray.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Base",showLegend:!1,visibility:!0,opacity:1},{id:"dark-gray-reference-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Dark_Gray_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Dark Gray Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},oceans:{id:"oceans",classic:!0,get thumbnailUrl(){return lr("esri/images/basemap/oceans.jpg")},baseMapLayers:[{id:"oceans-base-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Base",showLegend:!1,visibility:!0,opacity:1},{id:"oceans-reference-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Ocean Reference",isReference:!0,showLegend:!1,visibility:!0,opacity:1}]},"national-geographic":{id:"national-geographic",classic:!0,deprecated:!0,get thumbnailUrl(){return lr("esri/images/basemap/national-geographic.jpg")},baseMapLayers:[{id:"national-geographic-base-layer",url:"//services.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer",title:"NatGeo World Map",showLegend:!1,layerType:"ArcGISTiledMapServiceLayer",visibility:!0,opacity:1}]},osm:{id:"osm",classic:!0,get thumbnailUrl(){return lr("esri/images/basemap/osm.jpg")},baseMapLayers:[{id:"osm-base-layer",layerType:"OpenStreetMap",title:"Open Street Map",showLegend:!1,visibility:!0,opacity:1}]},"dark-gray-vector":{id:"dark-gray-vector",classic:!0,get thumbnailUrl(){return lr("esri/images/basemap/dark-gray-vector.jpg")},baseMapLayers:[{id:"dark-gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/5e9b3685f4c24d8781073dd928ebda50/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Base",visibility:!0,opacity:1},{id:"dark-gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/747cb7a5329c478cbe6981076cc879c5/resources/styles/root.json",layerType:"VectorTileLayer",title:"Dark Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"gray-vector":{id:"gray-vector",classic:!0,get thumbnailUrl(){return lr("esri/images/basemap/gray-vector.jpg")},baseMapLayers:[{id:"gray-base-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/291da5eab3a0412593b66d384379f89f/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Base",visibility:!0,opacity:1},{id:"gray-reference-layer",styleUrl:"https://cdn.arcgis.com/sharing/rest/content/items/1768e8369a214dfab4e2167d5c5f2454/resources/styles/root.json",layerType:"VectorTileLayer",title:"Light Gray Reference",isReference:!0,visibility:!0,opacity:1}]},"streets-vector":{id:"streets-vector",classic:!0,get thumbnailUrl(){return lr("esri/images/basemap/streets-vector.jpg")},baseMapLayers:[{id:"streets-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/de26a3cf4cc9451298ea173c4b324736/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets",visibility:!0,opacity:1}]},"topo-vector":{id:"topo-vector",classic:!0,get thumbnailUrl(){return lr("esri/images/basemap/topo-vector.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"topo-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/7dc6cea0b1764a1f9af2e679f642f0f5/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Topo",visibility:!0,opacity:1}]},"streets-night-vector":{id:"streets-night-vector",classic:!0,get thumbnailUrl(){return lr("esri/images/basemap/streets-night.jpg")},baseMapLayers:[{id:"streets-night-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/86f556a2d1fd468181855a35e344567f/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Night",visibility:!0,opacity:1}]},"streets-relief-vector":{id:"streets-relief-vector",classic:!0,get thumbnailUrl(){return lr("esri/images/basemap/streets-relief.jpg")},baseMapLayers:[{id:"world-hillshade-layer",url:"//services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer",layerType:"ArcGISTiledMapServiceLayer",title:"World Hillshade",showLegend:!1,visibility:!0,opacity:1},{id:"streets-relief-vector-base-layer",styleUrl:"//www.arcgis.com/sharing/rest/content/items/b266e6d17fc345b498345613930fbd76/resources/styles/root.json",title:"World Streets Relief",layerType:"VectorTileLayer",visibility:!0,opacity:1}]},"streets-navigation-vector":{id:"streets-navigation-vector",classic:!0,get thumbnailUrl(){return lr("esri/images/basemap/streets-navigation.jpg")},baseMapLayers:[{id:"streets-navigation-vector-base-layer",styleUrl:"//cdn.arcgis.com/sharing/rest/content/items/63c47b7177f946b49902c24129b87252/resources/styles/root.json",layerType:"VectorTileLayer",title:"World Streets Navigation",visibility:!0,opacity:1}]},"arcgis-imagery":{get thumbnailUrl(){return lr("esri/images/basemap/hybrid.jpg")},title:"Imagery Hybrid",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-imagery-standard":{get thumbnailUrl(){return lr("esri/images/basemap/satellite.jpg")},title:"Imagery",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Imagery",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/World_Imagery/MapServer"}]},"arcgis-imagery-labels":{title:"Hybrid [Reference]",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Imagery:Labels",title:"Hybrid Reference Layer",isReference:!0}]},"arcgis-light-gray":{get thumbnailUrl(){return lr("esri/images/basemap/gray-vector.jpg")},title:"Light Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Base",title:"Light Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:LightGray:Labels",title:"Light Gray Canvas Labels",isReference:!0}]},"arcgis-dark-gray":{get thumbnailUrl(){return lr("esri/images/basemap/dark-gray.jpg")},title:"Dark Gray Canvas",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Base",title:"Dark Gray Canvas Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:DarkGray:Labels",title:"Dark Gray Canvas Labels",isReference:!0}]},"arcgis-navigation":{get thumbnailUrl(){return lr("esri/images/basemap/streets-navigation.jpg")},title:"Navigation",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Navigation",title:"World Navigation Map"}]},"arcgis-navigation-night":{title:"Navigation (Dark Mode)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:NavigationNight",title:"World Navigation Map (Dark Mode)"}]},"arcgis-streets":{get thumbnailUrl(){return lr("esri/images/basemap/streets-vector.jpg")},title:"Streets",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Streets",title:"World Street Map"}]},"arcgis-streets-night":{get thumbnailUrl(){return lr("esri/images/basemap/streets-night.jpg")},title:"Streets (Night)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsNight",title:"World Street Map (Night)"}]},"arcgis-streets-relief":{get thumbnailUrl(){return lr("esri/images/basemap/streets-relief.jpg")},title:"Streets (with Relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:StreetsRelief:Base",title:"World Street Map (with Relief)"}]},"arcgis-topographic":{get thumbnailUrl(){return lr("esri/images/basemap/topo.jpg")},title:"Topographic",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Topographic:Base",title:"World Topographic Map"}]},"arcgis-oceans":{get thumbnailUrl(){return lr("esri/images/basemap/oceans.jpg")},title:"Oceans",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Ocean Base",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Oceans:Labels",title:"World Ocean Reference",isReference:!0}]},"osm-standard":{title:"OpenStreetMap",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Standard",title:"OpenStreetMap"}]},"osm-standard-relief":{title:"OpenStreetMap (with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StandardRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-streets":{title:"OpenStreetMap (Streets)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:Streets",title:"OpenStreetMap (Streets)"}]},"osm-streets-relief":{title:"OpenStreetMap (Streets with relief)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:StreetsRelief:Base",layerType:"VectorTileLayer",title:"OpenStreetMap Relief Base"}]},"osm-light-gray":{title:"OpenStreetMap (Light Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Base",title:"OSM (Light Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:LightGray:Labels",title:"OSM (Light Gray Reference)",isReference:!0}]},"osm-dark-gray":{title:"OpenStreetMap (Dark Gray Canvas)",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Base",title:"OSM (Dark Gray Base)"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/OSM:DarkGray:Labels",title:"OSM (Dark Gray Reference)",isReference:!0}]},"arcgis-terrain":{title:"Terrain with Labels",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Base",title:"World Terrain Base"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Terrain:Detail",title:"World Terrain Reference",isReference:!0}]},"arcgis-community":{title:"Community",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Community",title:"Community"}]},"arcgis-charted-territory":{title:"Charted Territory",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ChartedTerritory:Base",title:"Charted Territory"}]},"arcgis-colored-pencil":{title:"Colored Pencil",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ColoredPencil",title:"Colored Pencil"}]},"arcgis-nova":{title:"Nova",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Nova",title:"Nova"}]},"arcgis-modern-antique":{title:"Modern Antique",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"},{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:ModernAntique:Base",title:"Modern Antique"}]},"arcgis-midcentury":{title:"Mid-Century",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Midcentury",title:"Mid-Century"}]},"arcgis-newspaper":{title:"Newspaper",baseMapLayers:[{layerType:"VectorTileLayer",styleUrl:"https://basemaps-api.arcgis.com/arcgis/rest/services/styles/ArcGIS:Newspaper",title:"Newspaper"}]},"arcgis-hillshade-light":{title:"Hillshade",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer"}]},"arcgis-hillshade-dark":{title:"Hillshade (Dark)",baseMapLayers:[{layerType:"ArcGISTiledMapServiceLayer",showLegend:!1,title:"World Hillshade (Dark)",url:"https://ibasemaps-api.arcgis.com/arcgis/rest/services/Elevation/World_Hillshade_Dark/MapServer"}]}},VO=new Set(["bing-maps","imagery","imagery-tile","map-image","open-street-map","tile","unknown","unsupported","vector-tile","web-tile","wms","wmts"]),$O=new Set(["csv","feature","geo-rss","geojson","group","imagery","imagery-tile","kml","map-image","map-notes","ogc-feature","tile","unknown","unsupported","vector-tile","web-tile","wfs","wms","wmts"]);function zO(t){return!("feature"!==t.type||t.url||!t.source||"memory"!==t.source.type)}function GO(t,e){"maxScale"in t&&(e.maxScale=Be(t.maxScale)),"minScale"in t&&(e.minScale=Be(t.minScale))}function UO(t,e,i){if(!("write"in t)||!t.write)return i&&i.messages&&i.messages.push(new Ve("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted`,{layer:t})),null;if(function(t,e){if(e.restrictedWebMapWriting){const i=function(t){return"basemap"===t.layerContainerType?VO:"operational-layers"===t.layerContainerType?$O:null}(e);return!u(i)||i.has(t.type)&&!zO(t)}return!0}(t,i)){const e={};return t.write(e,i)?e:null}return u(e)&&function(t,e){if(function(t,e){if(zO(t)){const i=Q("featureCollection.layers",e),s=i&&i[0]&&i[0].layerDefinition;s&&GO(t,s)}else"stream"===t.type?GO(t,e.layerDefinition=e.layerDefinition||{}):"group"!==t.type&&GO(t,e)}(t,e),"blendMode"in t&&(e.blendMode=t.blendMode,"normal"===e.blendMode&&delete e.blendMode),e.opacity=Be(t.opacity),e.title=t.title||"Layer",e.visibility=t.visible,"legendEnabled"in t&&"wmts"!==t.type)if(zO(t)){const i=e.featureCollection;i&&(i.showLegend=t.legendEnabled)}else e.showLegend=t.legendEnabled}(t,e=H(e)),e}var qO;let BO=0;const WO=ct.getLogger("esri.Basemap");let HO=qO=class extends(Ld(Av)){constructor(t){super(t),this.id=null,this.portalItem=null,this.spatialReference=null,this.thumbnailUrl=null,this.title="Basemap",this.id=Date.now().toString(16)+"-basemap-"+BO++,this.baseLayers=new qo,this.referenceLayers=new qo;const e=t=>{t.parent&&t.parent!==this&&"remove"in t.parent&&t.parent.remove(t),t.parent=this,"elevation"===t.type&&WO.error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' is not supported as a basemap layer and will therefore be ignored.`)},i=t=>{t.parent=null};this.baseLayers.on("after-add",(t=>e(t.item))),this.referenceLayers.on("after-add",(t=>e(t.item))),this.baseLayers.on("after-remove",(t=>i(t.item))),this.referenceLayers.on("after-remove",(t=>i(t.item)))}initialize(){this.when().catch((t=>{WO.error("#load()",`Failed to load basemap (title: '${this.title}', id: '${this.id}')`,t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){var t;const e=this.baseLayers.removeAll();for(const t of e)t.destroy();const i=this.referenceLayers.removeAll();for(const t of i)t.destroy();this.baseLayers.destroy(),this.referenceLayers.destroy(),null==(t=this.portalItem)||t.destroy(),this.portalItem=null}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set baseLayers(t){this._set("baseLayers",jv(t,this._get("baseLayers")))}_writeBaseLayers(t,e,i){const s=[];t?(i={...i,layerContainerType:"basemap"},this.baseLayers.forEach((t=>{const e=UO(t,i.webmap?i.webmap.getLayerJSONFromResourceInfo(t):null,i);u(e)&&s.push(e)})),this.referenceLayers.forEach((t=>{const e=UO(t,i.webmap?i.webmap.getLayerJSONFromResourceInfo(t):null,i);u(e)&&(e.isReference=!0,s.push(e))})),e.baseMapLayers=s):e.baseMapLayers=s}set referenceLayers(t){this._set("referenceLayers",jv(t,this._get("referenceLayers")))}writeTitle(t,e){e.title=t||"Basemap"}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return _O(this,(t=>{t(this.baseLayers,this.referenceLayers)}))}clone(){const t={id:this.id,title:this.title,portalItem:this.portalItem,baseLayers:this.baseLayers.slice(),referenceLayers:this.referenceLayers.slice()};return this.loaded&&(t.loadStatus="loaded"),new qO({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}write(t,e){return t=t||{},e&&e.origin||(e={origin:"web-map",...e}),super.write(t,e),!this.loaded&&this.resourceInfo&&this.resourceInfo.data.baseMapLayers&&(t.baseMapLayers=this.resourceInfo.data.baseMapLayers.map((t=>{const e=H(t);return e.url&&pn(e.url)&&(e.url="https:"+e.url),e.templateUrl&&pn(e.templateUrl)&&(e.templateUrl="https:"+e.templateUrl),e}))),t}async _loadFromSource(t){const{resourceInfo:e,portalItem:i}=this;Ji(t);const s=[];e?(s.push(this._loadLayersFromJSON(e.data,e.context?e.context.url:null,t)),e.data.id&&!e.data.title&&s.push(async function(t){if(!t)return;const e=t.indexOf("-vector")>-1?t.slice(0,t.indexOf("-vector")):t,i=await Ms("esri/t9n/basemaps");return i[t]||i[e]}(e.data.id).then((t=>{t&&this.read({title:t},e.context)})))):i&&s.push(this._loadFromItem(i,t)),await Promise.all(s)}async _loadLayersFromJSON(t,e,i){const s=this.resourceInfo&&this.resourceInfo.context,n=this.portalItem&&this.portalItem.portal||s&&s.portal||null,r=s&&"web-scene"===s.origin?"web-scene":"web-map",{populateOperationalLayers:o}=await import("./p-ecb2a67b.js"),a=[];if(Ji(i),t.baseMapLayers&&Array.isArray(t.baseMapLayers)){const i={context:{origin:r,url:e,portal:n,layerContainerType:"basemap"},defaultLayerType:"DefaultTileLayer"},s=o(this.baseLayers,t.baseMapLayers.filter((t=>!t.isReference)),i);a.push(s);const l=o(this.referenceLayers,t.baseMapLayers.filter((t=>t.isReference)),i);a.push(l)}await rs(a)}async _loadFromItem(t,e){const i=await t.load(e),s=await i.fetchData("json",e),n=Vs(t.itemUrl);return this._set("resourceInfo",{data:s.baseMap,context:{origin:"web-map",portal:t.portal||Qv.getDefault(),url:n}}),this.read(this.resourceInfo.data,this.resourceInfo.context),this.read({spatialReference:s.spatialReference},this.resourceInfo.context),this.read({title:t.title,thumbnailUrl:t.thumbnailUrl},{origin:"portal-item",portal:t.portal||Qv.getDefault(),url:n}),this._loadLayersFromJSON(this.resourceInfo.data,n,e)}static fromId(t){const e=DO[t];if(e){if(e.deprecated){let e=null;"dark-gray"===t?e="dark-gray-vector":"gray"===t?e="gray-vector":"streets"===t?e="streets-vector":"topo"===t&&(e="topo-vector"),dr(WO,`The ${t} basemap has entered mature support and is no longer being updated.`,{replacement:e,see:"https://arcg.is/1iq8aD",warnOnce:!0})}return qO.fromJSON(e)}return null}};e([oe({json:{write:{ignoreOrigin:!0,target:"baseMapLayers",writer(t,e,i,s){this._writeBaseLayers(t,e,s)}},origins:{"web-scene":{write:{ignoreOrigin:!0,target:{baseMapLayers:{type:qo}},writer(t,e,i,s){this._writeBaseLayers(t,e,s)}}}}}})],HO.prototype,"baseLayers",null),e([oe({type:String,json:{origins:{"web-scene":{write:!0}}}})],HO.prototype,"id",void 0),e([oe({type:LO})],HO.prototype,"portalItem",void 0),e([oe()],HO.prototype,"referenceLayers",null),e([oe({readOnly:!0})],HO.prototype,"resourceInfo",void 0),e([oe({type:ap})],HO.prototype,"spatialReference",void 0),e([oe()],HO.prototype,"thumbnailUrl",void 0),e([oe({type:String,json:{origins:{"web-scene":{write:{isRequired:!0}}}}})],HO.prototype,"title",void 0),e([xd("title")],HO.prototype,"writeTitle",null),HO=qO=e([si("esri.Basemap")],HO);const JO=HO,ZO=Object.freeze({__proto__:null,default:JO});var QO;let KO=QO=class extends Vd{constructor(t){super(t),this.type="none"}clone(){return new QO({type:this.type})}};var YO;e([Md({none:"none",stayAbove:"stay-above"})],KO.prototype,"type",void 0),KO=QO=e([si("esri.ground.NavigationConstraint")],KO);const XO=ct.getLogger("esri.Ground");let tA=YO=class extends(Ld(Av)){constructor(t){super(t),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new qo;const e=t=>{t.parent&&t.parent!==this&&"remove"in t.parent&&t.parent.remove(t),t.parent=this,"elevation"!==t.type&&"base-elevation"!==t.type&&XO.error(`Layer '${t.title}, id:${t.id}' of type '${t.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`)};this.layers.on("after-add",(t=>e(t.item))),this.layers.on("after-remove",(t=>(t=>{t.parent=null})(t.item)))}initialize(){this.when().catch((t=>{XO.error("#load()","Failed to load ground",t)})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context)}destroy(){const t=this.layers.removeAll();for(const e of t)e.destroy();this.layers.destroy()}normalizeCtorArgs(t){return t&&"resourceInfo"in t&&(this._set("resourceInfo",t.resourceInfo),delete(t={...t}).resourceInfo),t}set layers(t){this._set("layers",jv(t,this._get("layers")))}writeLayers(t,e,i,s){const n=[];t?(s={...s,layerContainerType:"ground"},t.forEach((t=>{if("write"in t){const e={};(function(t){return()=>t})(t)().write(e,s)&&n.push(e)}else s&&s.messages&&s.messages.push(new Ve("layer:unsupported",`Layers (${t.title}, ${t.id}) of type '${t.declaredClass}' cannot be persisted in the ground`,{layer:t}))})),e.layers=n):e.layers=n}load(t){return this.addResolvingPromise(this._loadFromSource(t)),Promise.resolve(this)}loadAll(){return _O(this,(t=>{t(this.layers)}))}async queryElevation(t,e){await this.load({signal:null==e?void 0:e.signal});const{ElevationQuery:i}=await import("./p-46c46260.js");Ji(e);const s=new i,n=this.layers.filter(eA).toArray();return s.queryAll(n,t,e)}async createElevationSampler(t,e){await this.load({signal:null==e?void 0:e.signal});const{ElevationQuery:i}=await import("./p-46c46260.js");Ji(e);const s=new i,n=this.layers.filter(eA).toArray();return s.createSamplerAll(n,t,e)}clone(){const t={opacity:this.opacity,surfaceColor:H(this.surfaceColor),navigationConstraint:H(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(t.loadStatus="loaded"),new YO({resourceInfo:this.resourceInfo}).set(t)}read(t,e){this.resourceInfo||this._set("resourceInfo",{data:t,context:e}),super.read(t,e)}_loadFromSource(t){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,t):Promise.resolve(null)}_loadLayersFromJSON(t,e,i){const s=e&&e.origin||"web-scene",n=e&&e.portal||null,r=e&&e.url||null;return import("./p-ecb2a67b.js").then((({populateOperationalLayers:e})=>{Ji(i);const o=[];return t.layers&&Array.isArray(t.layers)&&o.push(e(this.layers,t.layers,{context:{origin:s,url:r,portal:n,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"})),rs(o)})).then((()=>{}))}};function eA(t){return"elevation"===t.type||function(t){return t&&"createElevationSampler"in t}(t)}e([oe({json:{read:!1}})],tA.prototype,"layers",null),e([xd("layers")],tA.prototype,"writeLayers",null),e([oe({readOnly:!0})],tA.prototype,"resourceInfo",void 0),e([oe({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:Rt,read:{reader:mm,source:"transparency"},write:{writer:(t,e)=>{e.transparency=ym(t)},target:"transparency"}}})],tA.prototype,"opacity",void 0),e([oe({type:bd,json:{type:[Rt],write:(t,e)=>{e.surfaceColor=t.toJSON().slice(0,3)}}})],tA.prototype,"surfaceColor",void 0),e([oe({type:KO,json:{write:!0}})],tA.prototype,"navigationConstraint",void 0),tA=YO=e([si("esri.Ground")],tA);const iA=tA;let sA=class extends(XM(qo)){constructor(t){super(t),this.getCollections=null}initialize(){this.handles.add(po((()=>this.refresh())))}destroy(){this.getCollections=null}refresh(){const t=u(this.getCollections)?this.getCollections():null;if(c(t))return void this.removeAll();let e=0;for(const i of t)u(i)&&(e=this._processCollection(e,i));this.splice(e,this.length)}_createNewInstance(t){return new qo(t)}_processCollection(t,e){if(!e)return t;const i=this.itemFilterFunction?this.itemFilterFunction:t=>!!t;for(const s of e)if(s){if(i(s)){const e=this.indexOf(s,t);e>=0?e!==t&&this.reorder(s,t):this.add(s,t),++t}if(this.getChildrenFunction){const e=this.getChildrenFunction(s);if(Array.isArray(e))for(const i of e)t=this._processCollection(t,i);else t=this._processCollection(t,e)}}return t}};e([oe()],sA.prototype,"getCollections",void 0),e([oe()],sA.prototype,"getChildrenFunction",void 0),e([oe()],sA.prototype,"itemFilterFunction",void 0),sA=e([si("esri.core.CollectionFlattener")],sA);const nA=sA;function rA(t){var e;return!(!(t&&t.loaded&&"capabilities"in t&&null!=t&&null!=(e=t.capabilities)&&e.operations&&"supportsEditing"in t.capabilities.operations&&!0===t.capabilities.operations.supportsEditing)||"editingEnabled"in t&&!t.editingEnabled)}const oA=ct.getLogger("esri.support.basemapUtils");function aA(t){return!(null==t||!t.baseLayers.concat(t.referenceLayers).some(lA))}function lA(t){if(cA(t.url))return!0;if("vector-tile"===t.type)for(const e in t.sourceNameToSource){const i=t.sourceNameToSource[e];if(cA(null==i?void 0:i.sourceUrl))return!0}return!1}const uA=/^(basemaps|ibasemaps).*-api\.arcgis\.com$/i;function cA(t){if(!t)return!1;const e=new Rs(tn(t));return uA.test(e.authority)}const hA=ct.getLogger("esri.support.groundUtils"),dA={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};let pA=0;const fA=ct.getLogger("esri.layers.Layer");let yA=class extends(To.EventedMixin(qI(Av))){constructor(){super(...arguments),this.attributionDataUrl=null,this.fullExtent=new of(-180,-90,180,90,ap.WGS84),this.id=Date.now().toString(16)+"-layer-"+pA++,this.legendEnabled=!0,this.listMode="show",this.opacity=1,this.parent=null,this.popupEnabled=!0,this.attributionVisible=!0,this.spatialReference=ap.WGS84,this.title=null,this.type=null,this.url=null,this.visible=!0}static async fromArcGISServerUrl(t){const e="string"==typeof t?{url:t}:t,i=await import("./p-3ce2b78b.js");try{return await i.fromUrl(e)}catch(t){throw fA.error("#fromArcGISServerUrl({ url: '"+e.url+"'})","Failed to create layer from arcgis server url",t),t}}static async fromPortalItem(t){const e="portalItem"in t?t:{portalItem:t},i=await import("./p-46c7e1f0.js");try{return await i.fromItem(e)}catch(t){const i=e&&e.portalItem;throw fA.error("#fromPortalItem()","Failed to create layer from portal item (portal: '"+(i&&i.portal&&i.portal.url||it.portalUrl)+"', id: '"+(i&&i.id||"unset")+"')",t),t}}initialize(){this.when().catch((t=>{var e,i;is(t)||ct.getLogger(this.declaredClass).error("#load()",`Failed to load layer (title: '${null!=(e=this.title)?e:"no title"}', id: '${null!=(i=this.id)?i:"no id"}')`,{error:t})}))}destroy(){if(this.parent){const t=this,e=this.parent;"layers"in e&&e.layers.includes(t)?e.layers.remove(t):"tables"in e&&e.tables.includes(t)?e.tables.remove(t):"baseLayers"in e&&e.baseLayers.includes(t)?e.baseLayers.remove(t):"baseLayers"in e&&e.referenceLayers.includes(t)&&e.referenceLayers.remove(t)}}get hasAttributionData(){return null!=this.attributionDataUrl}get parsedUrl(){const t=this.url;return t?Vs(t):null}async fetchAttributionData(){const t=this.attributionDataUrl;if(this.hasAttributionData&&t)return(await $n(t,{query:{f:"json"},responseType:"json"})).data;throw new Ve("layer:no-attribution-data","Layer does not have attribution data")}};e([oe({type:String})],yA.prototype,"attributionDataUrl",void 0),e([oe({type:of})],yA.prototype,"fullExtent",void 0),e([oe({readOnly:!0})],yA.prototype,"hasAttributionData",null),e([oe({type:String})],yA.prototype,"id",void 0),e([oe({type:Boolean,nonNullable:!0})],yA.prototype,"legendEnabled",void 0),e([oe({type:["show","hide","hide-children"]})],yA.prototype,"listMode",void 0),e([oe({type:Number,range:{min:0,max:1},nonNullable:!0})],yA.prototype,"opacity",void 0),e([oe()],yA.prototype,"parent",void 0),e([oe({readOnly:!0})],yA.prototype,"parsedUrl",null),e([oe({type:Boolean})],yA.prototype,"popupEnabled",void 0),e([oe({type:Boolean})],yA.prototype,"attributionVisible",void 0),e([oe({type:ap})],yA.prototype,"spatialReference",void 0),e([oe({type:String})],yA.prototype,"title",void 0),e([oe({type:String,readOnly:!0,json:{read:!1}})],yA.prototype,"type",void 0),e([oe()],yA.prototype,"url",void 0),e([oe({type:Boolean,nonNullable:!0})],yA.prototype,"visible",void 0),yA=e([si("esri.layers.Layer")],yA);const mA=yA;function gA(t){return t&&"group"===t.type}function vA(t,e,i){let s,n;if(t)for(let r=0,o=t.length;r<o;r++){if(s=t.getItemAt(r),s[e]===i)return s;if(gA(s)&&(n=vA(s.layers,e,i),n))return n}}const wA=ct.getLogger("esri.support.LayersMixin"),bA=t=>{let i=class extends t{constructor(...t){super(...t),this.layers=new qo;const e=t=>{t.parent=this,this.layerAdded(t),"elevation"!==t.type&&"base-elevation"!==t.type||wA.error(`Layer 'title:${t.title}, id:${t.id}' of type '${t.type}' is not supported as an operational layer and will therefore be ignored.`)},i=t=>{t.parent=null,this.layerRemoved(t)};this.layers.on("before-add",(t=>(t=>{t.parent&&"remove"in t.parent&&t.parent.remove(t)})(t.item))),this.layers.on("after-add",(t=>e(t.item))),this.layers.on("after-remove",(t=>i(t.item)))}destroy(){const t=this.layers.removeAll();for(const e of t)this.layerRemoved(e),e.destroy();this.layers.destroy()}set layers(t){this._set("layers",jv(t,this._get("layers")))}add(t,e){const i=this.layers;if(e=i.getNextIndex(e),t instanceof mA){const s=t;s.parent===this?this.reorder(s,e):i.add(s,e)}else cs(t)?t.then((t=>{this.destroyed||this.add(t,e)})):wA.error("#add()","The item being added is not a Layer or a Promise that resolves to a Layer.")}addMany(t,e){const i=this.layers;e=i.getNextIndex(e),t.slice().forEach((t=>{t.parent!==this?(i.add(t,e),e+=1):this.reorder(t,e)}))}findLayerById(t){return vA(this.layers,"id",t)}findLayerByUid(t){return vA(this.layers,"uid",t)}remove(t){return this.layers.remove(t)}removeMany(t){return this.layers.removeMany(t)}removeAll(){return this.layers.removeAll()}reorder(t,e){return this.layers.reorder(t,e)}layerAdded(t){}layerRemoved(t){}};return e([oe()],i.prototype,"layers",null),i=e([si("esri.support.LayersMixin")],i),i},MA="esri.support.TablesMixin",SA=ct.getLogger(MA);function xA(t){return t&&"group"===t.type}function kA(t,e,i){if(t)for(let s=0,n=t.length;s<n;s++){const n=t.getItemAt(s);if(n[e]===i)return n;if(xA(n)){const t=kA(n.tables,e,i);if(t)return t}}}const IA=t=>{let i=class extends t{constructor(...t){super(...t),this.tables=new qo,this.tables.on("after-add",(t=>{const e=t.item;e.parent&&e.parent!==this&&"tables"in e.parent&&e.parent.tables.remove(e),e.parent=this,"feature"!==e.type&&SA.error(`Layer 'title:${e.title}, id:${e.id}' of type '${e.type}' is not supported as a table and will therefore be ignored.`)})),this.tables.on("after-remove",(t=>{t.item.parent=null}))}destroy(){const t=this.tables.removeAll();for(const e of t)e.destroy();this.tables.destroy()}set tables(t){this._set("tables",jv(t,this._get("tables")))}findTableById(t){return kA(this.tables,"id",t)}findTableByUid(t){return kA(this.tables,"uid",t)}};return e([oe()],i.prototype,"tables",null),i=e([si(MA)],i),i};let jA=class extends(IA(bA(To.EventedMixin(jo)))){constructor(t){super(t),this.allLayers=new nA({getCollections:()=>{var t,e,i;return[null==(t=this.basemap)?void 0:t.baseLayers,null==(e=this.ground)?void 0:e.layers,this.layers,null==(i=this.basemap)?void 0:i.referenceLayers]},getChildrenFunction:t=>"layers"in t?t.layers:null}),this.allTables=new nA({getCollections:()=>[this.tables,this.layers],getChildrenFunction:t=>{const e=[];return"tables"in t&&e.push(t.tables),"layers"in t&&e.push(t.layers),e},itemFilterFunction:t=>{const e=t.parent;return e&&"tables"in e&&e.tables.includes(t)}}),this.basemap=null,this.editableLayers=new nA({getCollections:()=>[this.allLayers],itemFilterFunction:rA}),this.ground=new iA,this._basemapCache={}}destroy(){var t,e;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),null==(t=this.ground)||t.destroy(),null==(e=this.basemap)||e.destroy(),function(t){for(const e in t){const i=t[e];!1===(null==i?void 0:i.destroyed)&&i.destroy(),delete t[e]}}(this._basemapCache),this._basemapCache=null}castBasemap(t){return function(t,e){var i;let s;if("string"==typeof t){if(!(t in DO)){const e=Object.entries(DO).filter((([t,e])=>it.apiKey&&!e.classic||!it.apiKey&&e.classic&&!e.deprecated)).map((([t])=>`"${t}"`)).join(", ");return oA.warn(`Unable to find basemap definition for: ${t}. Try one of these: ${e}`),null}e&&(s=e[t]),s||(s=JO.fromId(t),e&&(e[t]=s))}else s=Tt(JO,t);return null!=(i=s)&&i.destroyed&&(oA.warn("The provided basemap is already destroyed",{basemap:s}),s=null),s}(t,this._basemapCache)}castGround(t){const e=function(t){let e=null;return"string"==typeof t?t in dA?e=new iA({resourceInfo:{data:{layers:[dA[t]]}}}):hA.warn(`Unable to find ground definition for: ${t}. Try "world-elevation"`):e=Tt(iA,t),e}(t);return c(e)?this._get("ground"):e}findLayerById(t){return this.allLayers.find((e=>e.id===t))}findTableById(t){return this.allTables.find((e=>e.id===t))}};e([oe({readOnly:!0,dependsOn:[]})],jA.prototype,"allLayers",void 0),e([oe({readOnly:!0})],jA.prototype,"allTables",void 0),e([oe({type:JO})],jA.prototype,"basemap",void 0),e([ba("basemap")],jA.prototype,"castBasemap",null),e([oe({readOnly:!0})],jA.prototype,"editableLayers",void 0),e([oe({type:iA,nonNullable:!0})],jA.prototype,"ground",void 0),e([ba("ground")],jA.prototype,"castGround",null),jA=e([si("esri.Map")],jA);const _A=jA;function TA(t){return Math.sqrt(Math.max(t[0]*t[0]+t[4]*t[4]+t[8]*t[8],t[1]*t[1]+t[5]*t[5]+t[9]*t[9],t[2]*t[2]+t[6]*t[6]+t[10]*t[10]))}class OA{constructor(t,e){this.min=t,this.max=e,this.range=e-t}ndiff(t,e=0){return Math.ceil((t-e)/this.range)*this.range+e}_normalize(t,e,i,s=0,n=!1){return(i-=s)<t?i+=this.ndiff(t-i):i>e&&(i-=this.ndiff(i-e)),n&&i===e&&(i=t),i+s}normalize(t,e=0,i=!1){return this._normalize(this.min,this.max,t,e,i)}clamp(t,e=0){return od(t-e,this.min,this.max)+e}monotonic(t,e,i){return t<e?e:e+this.ndiff(t-e,i)}minimalMonotonic(t,e,i){return this._normalize(t,t+this.range,e,i)}center(t,e,i){return e=this.monotonic(t,e,i),this.normalize((t+e)/2,i)}diff(t,e,i){return this.monotonic(t,e,i)-t}shortestSignedDiff(t,e){t=this.normalize(t);const i=(e=this.normalize(e))-t,s=e<t?this.minimalMonotonic(t,e)-t:e-this.minimalMonotonic(e,t);return Math.abs(i)<Math.abs(s)?i:s}contains(t,e,i){return e=this.minimalMonotonic(t,e),(i=this.minimalMonotonic(t,i))>t&&i<e}}function AA(t){for(const e in t){const i=t[e];i instanceof Function&&(t[e]=i.bind(t))}return t}AA(new OA(0,2*Math.PI)),AA(new OA(-Math.PI,Math.PI));const FA=AA(new OA(0,360));var CA;let PA=CA=class extends Vd{constructor(...t){super(...t),this.position=new Fp([0,0,0]),this.heading=0,this.tilt=0,this.fov=55}normalizeCtorArgs(t,e,i,s){if(t&&"object"==typeof t&&("x"in t||Array.isArray(t))){const n={position:t};return null!=e&&(n.heading=e),null!=i&&(n.tilt=i),null!=s&&(n.fov=s),n}return t}writePosition(t,e,i,s){const n=t.clone();n.x=gt(t.x||0),n.y=gt(t.y||0),n.z=t.hasZ?gt(t.z||0):t.z,e[i]=n.write({},s)}readPosition(t,e){const i=new Fp;return i.read(t,e),i.x=gt(i.x||0),i.y=gt(i.y||0),i.z=i.hasZ?gt(i.z||0):i.z,i}equals(t){return!!t&&this.tilt===t.tilt&&this.heading===t.heading&&this.fov===t.fov&&this.position.equals(t.position)}clone(){return new CA({position:this.position.clone(),heading:this.heading,tilt:this.tilt,fov:this.fov})}};e([oe({type:Fp,json:{write:{isRequired:!0}}})],PA.prototype,"position",void 0),e([xd("position")],PA.prototype,"writePosition",null),e([Sd("position")],PA.prototype,"readPosition",null),e([oe({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),ba((t=>FA.normalize(gt(t))))],PA.prototype,"heading",void 0),e([oe({type:Number,nonNullable:!0,json:{write:{isRequired:!0}}}),ba((t=>od(gt(t),-180,180)))],PA.prototype,"tilt",void 0),e([oe({type:Number,nonNullable:!0,json:{read:!1,write:!1}})],PA.prototype,"fov",void 0),PA=CA=e([si("esri.Camera")],PA);const EA=PA;var RA;let LA=RA=class extends Vd{constructor(t){super(t),this.rotation=0,this.scale=0,this.targetGeometry=null,this.camera=null}castRotation(t){return(t%=360)<0&&(t+=360),t}clone(){return new RA({rotation:this.rotation,scale:this.scale,targetGeometry:u(this.targetGeometry)?this.targetGeometry.clone():null,camera:u(this.camera)?this.camera.clone():null})}};function NA(){return{enabled:!this.camera}}e([oe({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:NA}}}}})],LA.prototype,"rotation",void 0),e([ba("rotation")],LA.prototype,"castRotation",null),e([oe({type:Number,json:{write:!0,origins:{"web-map":{default:0,write:!0},"web-scene":{write:{overridePolicy:NA}}}}})],LA.prototype,"scale",void 0),e([oe({types:ry,json:{read:ey,write:!0,origins:{"web-scene":{read:ey,write:{overridePolicy:NA}}}}})],LA.prototype,"targetGeometry",void 0),e([oe({type:EA,json:{write:!0}})],LA.prototype,"camera",void 0),LA=RA=e([si("esri.Viewpoint")],LA);const DA=LA;class VA{constructor(){this._propertyOriginMap=new Map,this._originStores=[,,,,,,,],this._values=new Map}clone(t){const e=new VA,i=this._originStores[0];i&&i.forEach(((t,i)=>{e.set(i,H(t),0)}));for(let i=2;i<7;i++){const s=this._originStores[i];s&&s.forEach(((s,n)=>{t&&t.has(n)||e.set(n,H(s),i)}))}return e}get(t,e){const i=void 0===e?this._values:this._originStores[e];return i?i.get(t):void 0}keys(t){const e=null==t?this._values:this._originStores[t];return e?[...e.keys()]:[]}set(t,e,i=6){let s=this._originStores[i];if(s||(s=new Map,this._originStores[i]=s),s.set(t,e),!this._values.has(t)||this._propertyOriginMap.get(t)<=i){const s=this._values.get(t);return this._values.set(t,e),this._propertyOriginMap.set(t,i),s!==e}return!1}delete(t,e=6){const i=this._originStores[e];if(!i)return;const s=i.get(t);if(i.delete(t),this._values.has(t)&&this._propertyOriginMap.get(t)===e){this._values.delete(t);for(let i=e-1;i>=0;i--){const e=this._originStores[i];if(e&&e.has(t)){this._values.set(t,e.get(t)),this._propertyOriginMap.set(t,i);break}}}return s}has(t,e){const i=void 0===e?this._values:this._originStores[e];return!!i&&i.has(t)}revert(t,e){for(;e>0&&!this.has(t,e);)--e;const i=this._originStores[e],s=i&&i.get(t),n=this._values.get(t);return this._values.set(t,s),this._propertyOriginMap.set(t,e),n!==s}originOf(t){return this._propertyOriginMap.get(t)||0}forEach(t){this._values.forEach(t)}}const $A=t=>{let i=class extends t{constructor(...t){super(...t);const e=Gt(this),i=e.metadatas,s=e.store,n=new VA;e.store=n,s.keys().forEach((t=>{n.set(t,s.get(t),0)})),Object.keys(i).forEach((t=>{e.internalGet(t)&&n.set(t,e.internalGet(t),0)}))}read(t,e){Od(this,t,e)}getAtOrigin(t,e){const i=zA(this),s=br(e);if("string"==typeof t)return i.get(t,s);const n={};return t.forEach((t=>{n[t]=i.get(t,s)})),n}originOf(t){return Mr(this.originIdOf(t))}originIdOf(t){return zA(this).originOf(t)}revert(t,e){const i=zA(this),s=br(e),n=Gt(this);let r;r="string"==typeof t?"*"===t?i.keys(s):[t]:t,r.forEach((t=>{n.invalidate(t),i.revert(t,s),n.commit(t)}))}};return i=e([si("esri.core.ReadOnlyMultiOriginJSONSupport")],i),i};function zA(t){return Gt(t).store}let GA=class extends($A(jo)){};GA=e([si("esri.core.ReadOnlyMultiOriginJSONSupport")],GA);const UA=t=>{let i=class extends t{constructor(...t){super(...t)}clear(t,e="user"){return qA(this).delete(t,br(e))}write(t={},e){return Rd(this,t=t||{},e),t}setAtOrigin(t,e,i){Gt(this).setAtOrigin(t,e,br(i))}removeOrigin(t){const e=qA(this),i=br(t),s=e.keys(i);for(const t of s)e.originOf(t)===i&&e.set(t,e.get(t,i),6)}updateOrigin(t,e){const i=qA(this),s=br(e),n=this.get(t);for(let e=s+1;e<7;++e)i.delete(t,e);i.set(t,n,s)}toJSON(t){return this.write({},t)}};return i=e([si("esri.core.WriteableMultiOriginJSONSupport")],i),i.prototype.toJSON.isDefaultToJSON=!0,i};function qA(t){return Gt(t).store}const BA=t=>{let i=class extends(UA($A(t))){constructor(...t){super(...t)}};return i=e([si("esri.core.MultiOriginJSONSupport")],i),i};let WA=class extends(BA(jo)){};WA=e([si("esri.core.MultiOriginJSONSupport")],WA);const HA={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},JA=Object.values(HA),ZA=RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${JA.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),QA=RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${JA.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),KA=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function YA(t){return!!ZA.test(t)}function XA(t){const e=Vs(t),i=e.path.match(ZA)||e.path.match(QA);if(!i)return null;const[,s,n,r,o]=i,a=n.indexOf("/");return{title:eF(-1!==a?n.slice(a+1):n),serverType:HA[r.toLowerCase()],sublayer:null!=o&&""!==o?parseInt(o,10):null,url:{path:s}}}function tF(t){const e=Vs(t).path.match(KA);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function eF(t){return(t=t.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+t.slice(1)}function iF(t,e){const i=[];if(t){const e=XA(t);u(e)&&e.title&&i.push(e.title)}if(e){const t=eF(e);i.push(t)}if(2===i.length){if(-1!==i[0].toLowerCase().indexOf(i[1].toLowerCase()))return i[0];if(-1!==i[1].toLowerCase().indexOf(i[0].toLowerCase()))return i[1]}return i.join(" - ")}function sF(t){if(!t)return!1;const e=-1!==(t=t.toLowerCase()).indexOf(".arcgis.com/"),i=-1!==t.indexOf("//services")||-1!==t.indexOf("//tiles")||-1!==t.indexOf("//features");return e&&i}function nF(t,e){return t?Mn(In(t,e)):t}function rF(t){let{url:e}=t;if(!e)return{url:e};e=In(e,t.logger);const i=Vs(e),s=XA(i.path);let n;if(u(s))null!=s.sublayer&&null==t.layer.layerId&&(n=s.sublayer),e=s.url.path;else if(t.nonStandardUrlAllowed){const t=tF(i.path);u(t)&&(e=t.serviceUrl,n=t.sublayerId)}return{url:Mn(e),layerId:n}}function oF(t,e,i,s,n){ev(e,s,"url",n),s.url&&null!=t.layerId&&(s.url=nn(s.url,i,""+t.layerId))}function aF(t){if(!t)return!1;const e=t.toLowerCase(),i=-1!==e.indexOf("/services/"),s=-1!==e.indexOf("/mapserver/wmsserver"),n=-1!==e.indexOf("/imageserver/wmsserver"),r=-1!==e.indexOf("/wmsserver");return i&&(s||n||r)}function lF(t){if(!t)return!1;const e=new Rs(tn(t)).authority.toLowerCase();return"server.arcgisonline.com"===e||"services.arcgisonline.com"===e}const uF=oi()({esriTimeUnitsMilliseconds:"milliseconds",esriTimeUnitsSeconds:"seconds",esriTimeUnitsMinutes:"minutes",esriTimeUnitsHours:"hours",esriTimeUnitsDays:"days",esriTimeUnitsWeeks:"weeks",esriTimeUnitsMonths:"months",esriTimeUnitsYears:"years",esriTimeUnitsDecades:"decades",esriTimeUnitsCenturies:"centuries",esriTimeUnitsUnknown:void 0});var cF;let hF=cF=class extends Vd{constructor(t){super(t),this.value=0,this.unit="milliseconds"}toMilliseconds(){return function(t,e){return 0===t?0:t*eS[e]/1}(this.value,this.unit)}clone(){return new cF({value:this.value,unit:this.unit})}};e([oe({type:Number,json:{write:!0},nonNullable:!0})],hF.prototype,"value",void 0),e([oe({type:uF.apiValues,json:{type:uF.jsonValues,read:uF.read,write:uF.write},nonNullable:!0})],hF.prototype,"unit",void 0),hF=cF=e([si("esri.TimeInterval")],hF);const dF=hF,pF=new ri({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeString:"string",esriFieldTypeDate:"date",esriFieldTypeOID:"oid",esriFieldTypeGeometry:"geometry",esriFieldTypeBlob:"blob",esriFieldTypeRaster:"raster",esriFieldTypeGUID:"guid",esriFieldTypeGlobalID:"global-id",esriFieldTypeXML:"xml"});var fF;let yF=fF=class extends Vd{constructor(t){super(t),this.color=new bd([0,0,0,1])}clone(){return new fF(H({color:this.color}))}};e([oe({type:bd,json:{write:!0}})],yF.prototype,"color",void 0),yF=fF=e([si("esri.webmap.background.ColorBackground")],yF);const mF=yF;var gF;!function(t){t[t.HANDSHAKE=0]="HANDSHAKE",t[t.OPEN=1]="OPEN",t[t.OPENED=2]="OPENED",t[t.RESPONSE=3]="RESPONSE",t[t.INVOKE=4]="INVOKE",t[t.ABORT=5]="ABORT",t[t.CLOSE=6]="CLOSE",t[t.OPEN_PORT=7]="OPEN_PORT",t[t.ON=8]="ON"}(gF||(gF={}));let vF=0;function wF(){return vF++}function bF(t){return t?JSON.stringify("string"==typeof t?{name:"message",message:t}:t.toJSON?t:{name:t.name,message:t.message,details:t.details||{stack:t.stack}}):null}function MF(t,e,i,s){if(e.type===gF.OPEN_PORT)return void t.postMessage(e,[e.port]);if(e.type!==gF.INVOKE&&e.type!==gF.RESPONSE)return void t.postMessage(e);let n;!function(t){return t&&"object"==typeof t&&("result"in t||"transferList"in t)}(i)?(n=xF(s),e.data=i):(n=xF(i.transferList),e.data=i.result),n?t.postMessage(e,n):t.postMessage(e)}function SF(t){if(!t)return null;const e=t.data;return e?"string"==typeof e?JSON.parse(e):e:null}function xF(t){if(!t||!t.length)return null;if(l("esri-workers-arraybuffer-transfer"))return t;const e=t.filter((t=>!function(t){return t instanceof ArrayBuffer||t&&t.constructor&&"ArrayBuffer"===t.constructor.name}(t)));return e.length?e:null}const kF={statsWorker:()=>import("./p-74b56182.js"),geometryEngineWorker:()=>import("./p-ad7e0ffd.js"),CSVSourceWorker:()=>import("./p-87e1d41d.js"),EdgeProcessingWorker:()=>import("./p-a0610e60.js"),ElevationSamplerWorker:()=>import("./p-ef03fe6e.js"),FeatureServiceSnappingSourceWorker:()=>import("./p-886dff72.js"),GeoJSONSourceWorker:()=>import("./p-b610656c.js"),LercWorker:()=>import("./p-6632d4a5.js"),MemorySourceWorker:()=>import("./p-686b81a8.js"),PBFDecoderWorker:()=>import("./p-8849e929.js"),Pipeline:()=>import("./p-238a3066.js"),PointCloudWorker:()=>import("./p-229da844.js"),RasterWorker:()=>import("./p-55e0b3eb.js"),SceneLayerWorker:()=>import("./p-1a7a3504.js"),WFSSourceWorker:()=>import("./p-47d10f9c.js"),WorkerTileHandler:()=>import("./p-0cc62634.js")},{CLOSE:IF,ABORT:jF,INVOKE:_F,RESPONSE:TF,OPEN_PORT:OF,ON:AF}=gF;class FF{constructor(t){this._timer=null,this._cancelledJobIds=new Set,this._invokeMessages=[],this._invoke=t,this._timer=null,this._process=this._process.bind(this)}push(t){t.type===gF.ABORT?this._cancelledJobIds.add(t.jobId):(this._invokeMessages.push(t),null===this._timer&&(this._timer=setTimeout(this._process,0)))}clear(){this._invokeMessages.length=0,this._cancelledJobIds.clear(),this._timer=null}_process(){this._timer=null;for(const t of this._invokeMessages)this._cancelledJobIds.has(t.jobId)||this._invoke(t);this._cancelledJobIds.clear(),this._invokeMessages.length=0}}class CF{constructor(t,e){this._port=t,this._outJobs=new Map,this._inJobs=new Map,this._invokeQueue=new FF((t=>this._onInvokeMessage(t))),this._client=e.client,this._onMessage=this._onMessage.bind(this),this._channel=e.channel,this._schedule=e.schedule,this._port.addEventListener("message",this._onMessage),this._port.start()}static connect(t){const e=new MessageChannel;let i;i="function"==typeof t?new t:"default"in t&&"function"==typeof t.default?new t.default:t;const s=new CF(e.port1,{channel:e,client:i});return"object"==typeof i&&"remoteClient"in i&&(i.remoteClient=s),CF.clients.set(s,i),e.port2}static loadWorker(t){const e=kF[t];return e?e():Promise.resolve(null)}close(){this._post({type:IF}),this._close()}isBusy(){return this._outJobs.size>0}invoke(t,e,i){const s=i&&i.signal,n=i&&i.transferList;if(!this._port)return Promise.reject(new Ve("worker:port-closed",`Cannot call invoke('${t}'), port is closed`,{methodName:t,data:e}));const r=wF();return new Promise(((i,o)=>{const a=ts(s,(()=>{var t;const e=this._outJobs.get(r);e&&(this._outJobs.delete(r),null==(t=e.abortHandle)||t.remove(),this._post({type:jF,jobId:r}),o(Hi()))}));this._outJobs.set(r,{resolve:i,reject:o,abortHandle:a,debugInfo:t}),this._post({type:_F,jobId:r,methodName:t,abortable:null!=s},e,n)}))}on(t,e){const i=new MessageChannel;function s(t){e(t.data)}return this._port.postMessage({type:gF.ON,eventType:t,port:i.port2},[i.port2]),i.port1.addEventListener("message",s),i.port1.start(),{remove(){i.port1.postMessage({type:gF.CLOSE}),i.port1.close(),i.port1.removeEventListener("message",s)}}}openPort(){const t=new MessageChannel;return this._post({type:OF,port:t.port2}),t.port1}_close(){this._channel&&(this._channel=null),this._port.removeEventListener("message",this._onMessage),this._port.close(),this._outJobs.forEach((t=>{var e;null==(e=t.abortHandle)||e.remove(),t.reject(Hi(`Worker closing, aborting job calling '${t.debugInfo}'`))})),this._inJobs.clear(),this._outJobs.clear(),this._invokeQueue.clear(),this._port=this._client=this._schedule=null}_onMessage(t){u(this._schedule)?this._schedule((()=>this._processMessage(t))):this._processMessage(t)}_processMessage(t){const e=SF(t);if(e)switch(e.type){case TF:this._onResponseMessage(e);break;case _F:this._invokeQueue.push(e);break;case jF:this._onAbortMessage(e);break;case IF:this._onCloseMessage();break;case OF:this._onOpenPortMessage(e);break;case AF:this._onOnMessage(e)}}_onAbortMessage(t){const e=this._inJobs,i=t.jobId,s=e.get(i);this._invokeQueue.push(t),s&&(s.controller&&s.controller.abort(),e.delete(i))}_onCloseMessage(){const t=this._client;this._close(),t&&"destroy"in t&&CF.clients.get(this)===t&&t.destroy(),CF.clients.delete(this),t&&t.remoteClient&&(t.remoteClient=null)}_onInvokeMessage(t){const{methodName:e,jobId:i,data:s,abortable:n}=t,r=n?new AbortController:null,o=this._inJobs;let a,l=this._client,u=l[e];try{if(!u&&e&&-1!==e.indexOf(".")){const t=e.split(".");for(let e=0;e<t.length-1;e++)l=l[t[e]],u=l[t[e+1]]}if("function"!=typeof u)throw new TypeError(e+" is not a function");a=u.call(l,s,{client:this,signal:r?r.signal:null})}catch(t){return void this._post({type:TF,jobId:i,error:bF(t)})}cs(a)?(o.set(i,{controller:r,promise:a}),a.then((t=>{o.has(i)&&(o.delete(i),this._post({type:TF,jobId:i},t))}),(t=>{o.has(i)&&(o.delete(i),is(t)||this._post({type:TF,jobId:i,error:bF(t||{message:"Error encountered at method "+e})}))}))):this._post({type:TF,jobId:i},a)}_onOpenPortMessage(t){new CF(t.port,{client:this._client})}_onOnMessage(t){const{port:e}=t,i=this._client.on(t.eventType,(t=>{e.postMessage(t)})),s=zi(t.port,"message",(t=>{SF(t).type===gF.CLOSE&&(s.remove(),i.remove(),e.close())}))}_onResponseMessage(t){var e;const{jobId:i,error:s,data:n}=t,r=this._outJobs;if(!r.has(i))return;const o=r.get(i);r.delete(i),null==(e=o.abortHandle)||e.remove(),s?o.reject(Ve.fromJSON(JSON.parse(s))):o.resolve(n)}_post(t,e,i){return MF(this._port,t,e,i)}}CF.kernelInfo={revision:et,version:"4.22",buildDate:tt},CF.clients=new Map;const PF=ct.getLogger("esri.core.workers.Connection");class EF{constructor(){this._clients=[],this._clientPromises=[],this._clientIdx=0}destroy(){this.close()}get closed(){return!this._clients||!this._clients.length}open(t,e){return new Promise(((i,s)=>{let n=!0;const r=t=>{Ji(e.signal),n&&(n=!1,t())};this._clients.length=t.length,this._clientPromises.length=t.length;for(let n=0;n<t.length;++n){const o=t[n];cs(o)?this._clientPromises[n]=o.then((t=>(this._clients[n]=new CF(t,e),r(i),this._clients[n])),(()=>(r(s),null))):(this._clients[n]=new CF(o,e),this._clientPromises[n]=Promise.resolve(this._clients[n]),r(i))}}))}broadcast(t,e,i){const s=Array(this._clientPromises.length);for(let n=0;n<this._clientPromises.length;++n)s[n]=this._clientPromises[n].then((s=>s.invoke(t,e,i)));return s}close(){for(const t of this._clientPromises)t.then((t=>t.close()));this._clients.length=0,this._clientPromises.length=0}getAvailableClient(){let t;for(let e=0;e<this._clients.length;++e){const i=this._clients[e];if(i){if(!i.isBusy())return Promise.resolve(i)}else t=t||[],t.push(this._clientPromises[e])}return t?Promise.race(t):(this._clientIdx=(this._clientIdx+1)%this._clients.length,Promise.resolve(this._clients[this._clientIdx]))}invoke(t,e,i){let s=null;return Array.isArray(i)?(PF.warn("invoke()","The transferList parameter is deprecated, use the options object instead"),s={transferList:i}):s=i,this.closed?Promise.reject(Error("Connection closed")):this.getAvailableClient().then((i=>i.invoke(t,e,s)))}on(t,e){return Promise.all(this._clientPromises).then((()=>$t(this._clients.map((i=>i.on(t,e))))))}openPorts(){return new Promise((t=>{const e=Array(this._clientPromises.length);let i=e.length;for(let s=0;s<this._clientPromises.length;++s)this._clientPromises[s].then((n=>{e[s]=n.openPort(),0==--i&&t(e)}))}))}get test(){return{numClients:this._clients.length}}}const RF={};class LF{constructor(){const t=document.createDocumentFragment();["addEventListener","dispatchEvent","removeEventListener"].forEach((e=>{this[e]=(...i)=>t[e](...i)}))}}const NF=i.MutationObserver||i.WebKitMutationObserver,DF=function(){let t;if(i.process&&i.process.nextTick)t=t=>{i.process.nextTick(t)};else if(i.Promise)t=t=>{i.Promise.resolve().then(t)};else if(NF){const e=[],i=document.createElement("div");new NF((()=>{for(;e.length>0;)e.shift()()})).observe(i,{attributes:!0}),t=t=>{e.push(t),i.setAttribute("queueStatus","1")}}return t}(),VF=(()=>{const t=i.MessageEvent;try{new t("message",{data:null})}catch{return(t,e={})=>{const{data:i,bubbles:s=!1,cancelable:n=!1}=e,r=document.createEvent("Event");return r.initEvent(t,s,n),r.data=i,r}}return(e,i)=>new t(e,i)})();class $F{constructor(){this._dispatcher=new LF,this._workerPostMessage({type:gF.HANDSHAKE})}terminate(){}get onmessage(){return this._onmessageHandler}set onmessage(t){this._onmessageHandler&&this.removeEventListener("message",this._onmessageHandler),this._onmessageHandler=t,t&&this.addEventListener("message",t)}get onmessageerror(){return this._onmessageerrorHandler}set onmessageerror(t){this._onmessageerrorHandler&&this.removeEventListener("messageerror",this._onmessageerrorHandler),this._onmessageerrorHandler=t,t&&this.addEventListener("messageerror",t)}get onerror(){return this._onerrorHandler}set onerror(t){this._onerrorHandler&&this.removeEventListener("error",this._onerrorHandler),this._onerrorHandler=t,t&&this.addEventListener("error",t)}postMessage(t){DF((()=>{this._workerMessageHandler(VF("message",{data:t}))}))}dispatchEvent(t){return this._dispatcher.dispatchEvent(t)}addEventListener(t,e,i){this._dispatcher.addEventListener(t,e,i)}removeEventListener(t,e,i){this._dispatcher.removeEventListener(t,e,i)}_workerPostMessage(t){DF((()=>{this.dispatchEvent(VF("message",{data:t}))}))}async _workerMessageHandler(t){const e=SF(t);if(e&&e.type===gF.OPEN){const{modulePath:t,jobId:i}=e;let s=await CF.loadWorker(t);s||(s=await import(t));const n=CF.connect(s);this._workerPostMessage({type:gF.OPENED,jobId:i,data:n})}}}const zF=ct.getLogger("esri.core.workers"),{HANDSHAKE:GF}=gF;let UF,qF;const BF="Failed to create Worker. Fallback to execute module in main thread";async function WF(t){return new Promise((e=>{function i(n){const r=SF(n);r&&r.type===GF&&(t.removeEventListener("message",i),t.removeEventListener("error",s),e(t))}function s(e){e.preventDefault(),t.removeEventListener("message",i),t.removeEventListener("error",s),zF.warn("Failed to create Worker. Fallback to execute module in main thread",e),(t=new $F).addEventListener("message",i),t.addEventListener("error",s)}t.addEventListener("message",i),t.addEventListener("error",s)}))}let HF=0;const JF=ct.getLogger("esri.core.workers"),{ABORT:ZF,INVOKE:QF,OPEN:KF,OPENED:YF,RESPONSE:XF}=gF;class tC{constructor(t,e){this._outJobs=new Map,this._inJobs=new Map,this.worker=t,this.id=e,t.addEventListener("message",this._onMessage.bind(this)),t.addEventListener("error",(t=>{t.preventDefault(),JF.error(t)}))}static async create(t){const e=await async function(){if(!l("esri-workers"))return WF(new $F);if(!UF&&!qF)try{const t='let globalId=0;const outgoing=new Map,configuration=JSON.parse("{CONFIGURATION}");self.esriConfig=configuration.esriConfig;const workerPath=self.esriConfig.workers.workerPath,HANDSHAKE=0,OPEN=1,OPENED=2,RESPONSE=3,INVOKE=4,ABORT=5;function createAbortError(){const e=new Error("Aborted");return e.name="AbortError",e}function receiveMessage(e){return e&&e.data?"string"==typeof e.data?JSON.parse(e.data):e.data:null}function invokeStaticMessage(e,o,r){const t=r&&r.signal,n=globalId++;return new Promise(((r,i)=>{if(t){if(t.aborted)return i(createAbortError());t.addEventListener("abort",(()=>{outgoing.get(n)&&(outgoing.delete(n),self.postMessage({type:5,jobId:n}),i(createAbortError()))}))}outgoing.set(n,{resolve:r,reject:i}),self.postMessage({type:4,jobId:n,methodName:e,abortable:null!=t,data:o})}))}let workerRevisionChecked=!1;function checkWorkerRevision(e){if(!workerRevisionChecked&&e.kernelInfo){workerRevisionChecked=!0;const{revision:o,buildDate:r,version:t}=configuration.kernelInfo,{revision:n,buildDate:i,version:s}=e.kernelInfo;o!==n&&console.warn(`[esri.core.workers] Version mismatch detected between ArcGIS API for JavaScript and assets:\nAPI version: ${t} [Date: ${r}, Revision: ${o.slice(0,8)}]\nAssets version: ${s} [Date: ${i}, Revision: ${n.slice(0,8)}]`)}}function messageHandler(e){const o=receiveMessage(e);if(!o)return;const r=o.jobId;switch(o.type){case 1:let e;function t(o){const t=e.connect(o);self.postMessage({type:2,jobId:r,data:t},[t])}"function"==typeof define&&define.amd?require([workerPath],(r=>{e=r.default||r,checkWorkerRevision(e),e.loadWorker(o.modulePath).then((e=>e||new Promise((e=>{require([o.modulePath],e)})))).then(t)})):"System"in self&&"function"==typeof System.import?System.import(workerPath).then((r=>(e=r.default,checkWorkerRevision(e),e.loadWorker(o.modulePath)))).then((e=>e||System.import(o.modulePath))).then(t):(self.RemoteClient||importScripts(workerPath),e=self.RemoteClient.default||self.RemoteClient,checkWorkerRevision(e),e.loadWorker(o.modulePath).then(t));break;case 3:if(outgoing.has(r)){const e=outgoing.get(r);outgoing.delete(r),o.error?e.reject(JSON.parse(o.error)):e.resolve(o.data)}}}self.dojoConfig=configuration.loaderConfig,esriConfig.workers.loaderUrl&&(self.importScripts(esriConfig.workers.loaderUrl),"function"==typeof require&&"function"==typeof require.config&&require.config(configuration.loaderConfig)),self.addEventListener("message",messageHandler),self.postMessage({type:0});'.replace('"{CONFIGURATION}"',`'${function(){let t;if(null!=it.default){const e={...it};delete e.default,t=JSON.parse(JSON.stringify(e))}else t=JSON.parse(JSON.stringify(it));t.assetsPath=tn(t.assetsPath),t.request.interceptors=[],t.log.interceptors=[],t.locale=pi(),t.has={"esri-csp-restrictions":l("esri-csp-restrictions"),"esri-2d-debug":!1,"esri-2d-update-debug":l("esri-2d-update-debug"),"esri-2d-query-centroid-enabled":l("esri-2d-query-centroid-enabled"),"featurelayer-pbf":l("featurelayer-pbf"),"featurelayer-simplify-thresholds":l("featurelayer-simplify-thresholds"),"featurelayer-simplify-payload-size-factors":l("featurelayer-simplify-payload-size-factors"),"esri-atomics":l("esri-atomics"),"esri-shared-array-buffer":l("esri-shared-array-buffer"),"esri-tiles-debug":l("esri-tiles-debug"),"esri-workers-arraybuffer-transfer":l("esri-workers-arraybuffer-transfer"),"host-webworker":1},t.workers.loaderUrl&&(t.workers.loaderUrl=tn(t.workers.loaderUrl)),t.workers.workerPath=tn(t.workers.workerPath?t.workers.workerPath:lr("esri/core/workers/RemoteClient.js"));const e=it.workers.loaderConfig,i=function(t){var e;const i={async:t.async,isDebug:t.isDebug,locale:t.locale,baseUrl:t.baseUrl,has:{...t.has},map:{...t.map},packages:t.packages&&t.packages.concat()||[],paths:{...t.paths}};return t.hasOwnProperty("async")||(i.async=!0),t.hasOwnProperty("isDebug")||(i.isDebug=!1),t.baseUrl||(i.baseUrl=RF.baseUrl),null==(e=RF.packages)||e.forEach((t=>{!function(t,e){for(const i of t)if(i.name===e.name)return;t.push(e)}(i.packages,t)})),i}({baseUrl:null==e?void 0:e.baseUrl,locale:pi(),has:{"csp-restrictions":1,"dojo-test-sniff":0,"host-webworker":1,...null==e?void 0:e.has},map:{...null==e?void 0:e.map},paths:{...null==e?void 0:e.paths},packages:(null==e?void 0:e.packages)||[]});return JSON.stringify({esriConfig:t,loaderConfig:i,kernelInfo:{version:"4.22",buildDate:tt,revision:et}})}()}'`);UF=URL.createObjectURL(new Blob([t],{type:"text/javascript"}))}catch(t){qF=t||{}}let t;if(UF)try{t=new Worker(UF,{name:"esri-worker-"+HF++})}catch(e){zF.warn(BF,qF),t=new $F}else zF.warn(BF,qF),t=new $F;return WF(t)}();return new tC(e,t)}terminate(){this.worker.terminate()}async open(t,e={}){const{signal:i}=e,s=wF();return new Promise(((e,n)=>{const r={resolve:e,reject:n,abortHandle:ts(i,(()=>{this._outJobs.delete(s),this._post({type:ZF,jobId:s})}))};this._outJobs.set(s,r),this._post({type:KF,jobId:s,modulePath:t})}))}_onMessage(t){const e=SF(t);if(e)switch(e.type){case YF:this._onOpenedMessage(e);break;case XF:this._onResponseMessage(e);break;case ZF:this._onAbortMessage(e);break;case QF:this._onInvokeMessage(e)}}_onAbortMessage(t){const e=this._inJobs,i=t.jobId,s=e.get(i);s&&(s.controller&&s.controller.abort(),e.delete(i))}_onInvokeMessage(t){const{methodName:e,jobId:i,data:s,abortable:n}=t,r=n?new AbortController:null,o=this._inJobs,a=Cn[e];let l;try{if("function"!=typeof a)throw new TypeError(e+" is not a function");l=a.call(null,s,{signal:r?r.signal:null})}catch(t){return void this._post({type:XF,jobId:i,error:bF(t)})}cs(l)?(o.set(i,{controller:r,promise:l}),l.then((t=>{o.has(i)&&(o.delete(i),this._post({type:XF,jobId:i},t))}),(t=>{o.has(i)&&(o.delete(i),t||(t={message:"Error encountered at method"+e}),is(t)||this._post({type:XF,jobId:i,error:bF(t||{message:"Error encountered at method "+e})}))}))):this._post({type:XF,jobId:i},l)}_onOpenedMessage(t){var e;const{jobId:i,data:s}=t,n=this._outJobs.get(i);n&&(this._outJobs.delete(i),null==(e=n.abortHandle)||e.remove(),n.resolve(s))}_onResponseMessage(t){var e;const{jobId:i,error:s,data:n}=t,r=this._outJobs.get(i);r&&(this._outJobs.delete(i),null==(e=r.abortHandle)||e.remove(),s?r.reject(Ve.fromJSON(JSON.parse(s))):r.resolve(n))}_post(t,e,i){return MF(this.worker,t,e,i)}}let eC=l("esri-workers-debug")?1:l("host-browser")?navigator.hardwareConcurrency-1:0;eC||(eC=l("safari")&&l("mac")||l("trident")?7:2);let iC=0;const sC=[];async function nC(t,e){const i=new EF;return await i.open(t,e),i}async function rC(t,e={}){if("string"!=typeof t)throw new Ve("workers:undefined-module","modulePath is missing");let i=e.strategy||"distributed";if(l("host-webworker")&&!l("esri-workers")&&(i="local"),"local"===i){let i=await CF.loadWorker(t);i||(i=await import(t)),Ji(e.signal);const s=e.client||i;return nC([CF.connect(i)],{...e,client:s})}if(await aC(),Ji(e.signal),"dedicated"===i){const i=iC++%eC;return nC([await sC[i].open(t,e)],e)}if(e.maxNumWorkers&&e.maxNumWorkers>0){const i=Math.min(e.maxNumWorkers,eC);if(i<eC){const s=Array(i);for(let n=0;n<i;++n){const i=iC++%eC;s[n]=sC[i].open(t,e)}return nC(s,e)}}return nC(sC.map((i=>i.open(t,e))),e)}let oC=null;async function aC(){if(oC)return oC;new AbortController;const t=[];for(let e=0;e<eC;e++){const i=tC.create(e).then((t=>(sC[e]=t,t)));t.push(i)}return oC=Promise.all(t),oC}const lC={widthBreakpoint:{getValue(t){const e=t.viewSize[0],i=t.breakpoints,s=this.values;return e<=i.xsmall?s.xsmall:e<=i.small?s.small:e<=i.medium?s.medium:e<=i.large?s.large:s.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(t){const e=t.viewSize[1],i=t.breakpoints,s=this.values;return e<=i.xsmall?s.xsmall:e<=i.small?s.small:e<=i.medium?s.medium:e<=i.large?s.large:s.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(t){const e=t.viewSize,i=this.values;return e[1]>=e[0]?i.portrait:i.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},uC={xsmall:544,small:768,medium:992,large:1200};function cC(t,e){return e?lC[t].valueToClassName[e].split(" "):[]}const hC=t=>{let i=class extends t{constructor(...t){super(...t),this._breakpointsHandles=new Wo,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=uC}initialize(){this._breakpointsHandles.add(Xo(this,["breakpoints","size"],this._updateClassNames))}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=null)}set breakpoints(t){if(t===this._get("breakpoints"))return;const e=function(t){return t&&t.xsmall<t.small&&t.small<t.medium&&t.medium<t.large}(t);if(!e){const t=JSON.stringify(uC,null,2);console.warn("provided breakpoints are not valid, using defaults:"+t)}t=e?t:uC,this._set("breakpoints",{...t})}_updateClassNames(){if(!this.container)return;const t=Ar.acquire(),e=Ar.acquire();let i,s=!1;for(i in lC){const n=this[i],r=lC[i].getValue({viewSize:this.size,breakpoints:this.breakpoints});n!==r&&(s=!0,this[i]=r,cC(i,n).forEach((t=>e.push(t))),cC(i,r).forEach((e=>t.push(e))))}s&&(this._applyClassNameChanges(t,e),Ar.release(t),Ar.release(e))}_applyClassNameChanges(t,e){const i=this.container;i&&(e.forEach((t=>i.classList.remove(t))),t.forEach((t=>i.classList.add(t))))}_removeActiveClassNames(){const t=this.container;if(!t)return;let e;for(e in lC)cC(e,this[e]).forEach((e=>t.classList.remove(e)))}};return e([oe()],i.prototype,"breakpoints",null),e([oe()],i.prototype,"orientation",void 0),e([oe()],i.prototype,"widthBreakpoint",void 0),e([oe()],i.prototype,"heightBreakpoint",void 0),i=e([si("esri.views.BreakpointsOwner")],i),i};let dC=class extends jo{constructor(){super(...arguments),this.items=new qo,this._watchUpdatingTracking=new KM,this._callbacks=new Map,this._projector=wu(),this._hiddenProjector=wu()}get needsRender(){return this.items.length>0}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(this.items,(t=>{for(const e of t.added){const t=()=>e.render();this._callbacks.set(e,t),this._projector.append(this.surface,t)}for(const e of t.removed){const t=this._projector.detach(this._callbacks.get(e));this.surface.removeChild(t.domNode),this._callbacks.delete(e)}}))}addItem(t){this.items.add(t)}removeItem(t){this.items.remove(t)}destroy(){this.items.removeAll(),this._callbacks.forEach((t=>this._projector.detach(t))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy()}render(){this._projector.renderNow()}computeBoundingRect(t){const e=this._hiddenSurface,i=this._hiddenProjector;let s=null;const n=()=>(s=t.render(),s);i.append(e,n),i.renderNow();const r={left:0,top:0,right:0,bottom:0};if(s&&s.domNode){const t=s.domNode.getBoundingClientRect();r.left=t.left,r.top=t.top,r.right=t.right,r.bottom=t.bottom}for(i.detach(n);e.firstChild;)e.removeChild(e.firstChild);return r}overlaps(t,e){const i=this.computeBoundingRect(t),s=this.computeBoundingRect(e);return Math.max(i.left,s.left)<=Math.min(i.right,s.right)&&Math.max(i.top,s.top)<=Math.min(i.bottom,s.bottom)}get hasVisibleItems(){return this.items.some((t=>t.visible))}renderCanvas(t){if(!this.items.some((t=>t.visible)))return;const e=t.getContext("2d");e.save(),e.font="10px "+getComputedStyle(this.surface).fontFamily,this.items.forEach((t=>{e.save(),t.renderCanvas(e),e.restore()})),e.restore()}};e([oe({readOnly:!0})],dC.prototype,"surface",void 0),e([oe({readOnly:!0})],dC.prototype,"items",void 0),e([oe({readOnly:!0})],dC.prototype,"needsRender",null),e([oe({readOnly:!0})],dC.prototype,"_watchUpdatingTracking",void 0),e([oe({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],dC.prototype,"updating",void 0),dC=e([si("esri.views.overlay.ViewOverlay")],dC);const pC=dC;function fC(t,e,i,s){let n=null,r=1e3;"number"==typeof e?(r=e,s=i):(n=null!=e?e:null,r=i);let o,a=0;const l=()=>{a=0,t.apply(s,o)},u=(...t)=>{n&&n.apply(s,t),o=t,r?a||(a=setTimeout(l,r)):l()};return u.remove=()=>{a&&(clearTimeout(a),a=0)},u.forceUpdate=()=>{a&&(clearTimeout(a),l())},u.hasPendingUpdates=()=>!!a,u}const yC=["B","kB","MB","GB","TB"];var mC;const gC={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};let vC=mC=class extends Vd{constructor(t){super(t),this.contentType=null,this.exifInfo=null,this.id=null,this.globalId=null,this.keywords=null,this.name=null,this.parentGlobalId=null,this.parentObjectId=null,this.size=null,this.url=null}get orientationInfo(){const{exifInfo:t}=this,e=function(t){const{exifInfo:e,exifName:i,tagName:s}=t;if(!e||!i||!s)return null;const n=e.find((t=>t.name===i));return n?function(t){const{tagName:e,tags:i}=t;if(!i||!e)return null;const s=i.find((t=>t.name===e));return s&&s.value||null}({tagName:s,tags:n.tags}):null}({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:t});return gC[e]||null}clone(){return new mC({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};e([oe({type:String})],vC.prototype,"contentType",void 0),e([oe()],vC.prototype,"exifInfo",void 0),e([oe({readOnly:!0})],vC.prototype,"orientationInfo",null),e([oe({type:Rt})],vC.prototype,"id",void 0),e([oe({type:String})],vC.prototype,"globalId",void 0),e([oe({type:String})],vC.prototype,"keywords",void 0),e([oe({type:String})],vC.prototype,"name",void 0),e([oe({json:{read:!1}})],vC.prototype,"parentGlobalId",void 0),e([oe({json:{read:!1}})],vC.prototype,"parentObjectId",void 0),e([oe({type:Rt})],vC.prototype,"size",void 0),e([oe({json:{read:!1}})],vC.prototype,"url",void 0),vC=mC=e([si("esri.layers.support.AttachmentInfo")],vC);const wC=vC;var bC;let MC=bC=class extends Vd{constructor(t){super(t),this.attachmentTypes=null,this.attachmentsWhere=null,this.keywords=null,this.globalIds=null,this.name=null,this.num=null,this.objectIds=null,this.returnMetadata=!1,this.size=null,this.start=null,this.where=null}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new bC(H({attachmentTypes:this.attachmentTypes,attachmentsWhere:this.attachmentsWhere,keywords:this.keywords,where:this.where,globalIds:this.globalIds,name:this.name,num:this.num,objectIds:this.objectIds,returnMetadata:this.returnMetadata,size:this.size,start:this.start}))}};e([oe({type:[String],json:{write:!0}})],MC.prototype,"attachmentTypes",void 0),e([oe({type:String,json:{read:{source:"attachmentsDefinitionExpression"},write:{target:"attachmentsDefinitionExpression"}}})],MC.prototype,"attachmentsWhere",void 0),e([oe({type:[String],json:{write:!0}})],MC.prototype,"keywords",void 0),e([oe({type:[Number],json:{write:!0}})],MC.prototype,"globalIds",void 0),e([oe({json:{write:!0}})],MC.prototype,"name",void 0),e([oe({type:Number,json:{read:{source:"resultRecordCount"}}})],MC.prototype,"num",void 0),e([oe({type:[Number],json:{write:!0}})],MC.prototype,"objectIds",void 0),e([oe({type:Boolean,json:{default:!1,write:!0}})],MC.prototype,"returnMetadata",void 0),e([oe({type:[Number],json:{write:!0}})],MC.prototype,"size",void 0),e([oe({type:Number,json:{read:{source:"resultOffset"}}})],MC.prototype,"start",void 0),e([xd("start"),xd("num")],MC.prototype,"writeStart",null),e([oe({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],MC.prototype,"where",void 0),MC=bC=e([si("esri.rest.support.AttachmentQuery")],MC),MC.from=Tt(MC);const SC=MC,xC=ct.getLogger("esri.widgets.Feature.support.featureUtils"),kC=/href=(""|'')/gi,IC=/(\{([^\{\r\n]+)\})/g,jC=/\'/g,_C=/^\s*expression\//i,TC=/(\n)/gi,OC=/[\u00A0-\u9999<>\&]/gim,AC=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,FC=/^(?:mailto:|tel:)/,CC="relationships/",PC=Oi("short-date-short-time");function EC(t){if(!c(t))return t.get("sourceLayer")||t.get("layer")}async function RC(t,e){return"function"==typeof t?t.call(null,e):t}function LC(t=""){if(t)return!FC.test(t.trim().toLowerCase())}function NC(t){return!!t&&_C.test(t)}function DC(t,e){const i=function(t,e){if(!NC(e)||!t)return null;const i=e.replace(_C,"").toLowerCase();let s;return t.some((t=>t.name.toLowerCase()===i&&(s=t,!0))),s}(e,null==t?void 0:t.fieldName);return i?i.title||null:t?t.label||t.fieldName:null}function VC(t,e){const i=$C(e,t);return i?i.name:t}function $C(t,e){return t&&"function"==typeof t.getField?t.getField(e):null}function zC(t){return(""+t).trim()}function GC({attributes:t,globalAttributes:e,layer:i,text:s,expressionAttributes:n,fieldInfoMap:r}){return s?UC({formattedAttributes:e,template:BC(s,{...e,...n,...t},i),fieldInfoMap:r}):""}function UC({formattedAttributes:t,template:e,fieldInfoMap:i}){return zC(function(t){return t.replace(kC,"")}(rt(rt(e,(t=>function(t,e){const i=e.get(t.toLowerCase());return`{${i&&i.fieldName||t}}`}(t,i))),t)))}function qC(t,e){return t.replace(IC,((t,i,s)=>{const n=$C(e,s);return n?`{${n.name}}`:i}))}function BC(t,e,i){const s=qC(t,i);return s?s.replace(AC,((t,i,s)=>function(t,e,i){return rt(t,function(t,e=!1){const i={...t};return Object.keys(i).forEach((t=>function(t,e,i=!1){const s=e[t];if("string"==typeof s){const n="%27",r=(i?encodeURIComponent(s):s).replace(jC,n);e[t]=r}}(t,i,e))),i}(i,(e=zC(e))&&"{"!==e[0]))}(t,i||s,e))):s}function WC(t,e){const i=e.fieldName,s=HC(e.fieldInfos,i),n=null==s?void 0:s.clone(),r=e.preventPlacesFormatting,o=e.layer,a=$C(o,i);if(n&&"date"===(null==a?void 0:a.type)){const t=n.format||new zk;t.dateFormat=t.dateFormat||"short-date-short-time",t.dateTimeFormatOptions=function(t){return"feature"===(null==t?void 0:t.type)}(o)&&o.datesInUnknownTimezone||function(t){return!(null==t||!t.layer)}(o)&&function(t){return"map-image"===(null==t?void 0:t.type)}(o.layer)&&o.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,n.format=t}const l=n&&n.format;return"string"==typeof(t=function(t,e){if("string"==typeof t&&e&&null==e.dateFormat&&(null!=e.places||null!=e.digitSeparator)){const e=Number(t);if(!isNaN(e))return e}return t}(t,l))||null==t||null==l?t:r?Ri(t,{...Ei(l),minimumFractionDigits:0,maximumFractionDigits:20}):l.format(t)}function HC(t,e){if(!t||!t.length||!e)return;const i=e.toLowerCase();let s;return t.some((t=>!(!t.fieldName||t.fieldName.toLowerCase()!==i||(s=t,0)))),s}function JC(t){const e=[];if(!t)return e;const{fieldInfos:i,content:s}=t;return i&&e.push(...i),s&&Array.isArray(s)?(s.forEach((t=>{if("fields"===t.type){const i=t&&t.fieldInfos;i&&e.push(...i)}})),e):e}function ZC(t){return t.replace(OC,(t=>`&#${t.charCodeAt(0)};`))}function QC(t){return"string"==typeof t?t.replace(TC,'<br class="esri-text-new-line" />'):t}function KC({fieldInfos:t,attributes:e,layer:i,graphic:s,fieldInfoMap:n,relatedInfos:r}){const o={};return null==r||r.forEach((t=>function(t,e){t&&e&&(e.relatedFeatures&&e.relatedFeatures&&e.relatedFeatures.forEach((i=>XC({attributes:t,graphic:i,relatedInfo:e}))),e.relatedStatsFeatures&&e.relatedStatsFeatures&&e.relatedStatsFeatures.forEach((i=>XC({attributes:t,graphic:i,relatedInfo:e}))))}(o,t))),Object.keys(e).forEach((r=>{o[r]=function(t){const{value:e,fieldName:i,fieldInfos:s,fieldInfoMap:n,layer:r,graphic:o}=t;if(null==e)return"";const a=function({fieldName:t,value:e,graphic:i,layer:s}){if(YC(t))return null;if(!s||"function"!=typeof s.getFieldDomain)return null;const n=s.getFieldDomain(t,{feature:i});return n&&"coded-value"===n.type?n.getName(e):null}({fieldName:i,value:e,graphic:o,layer:r});if(a)return a;const l=function({fieldName:t,graphic:e,layer:i}){if(YC(t))return null;if(!i||"function"!=typeof i.getFeatureType)return null;const{typeIdField:s}=i;if(!s||t!==s)return null;const n=i.getFeatureType(e);return n?n.name:null}({fieldName:i,graphic:o,layer:r});if(l)return l;if(n.get(i.toLowerCase()))return WC(e,{fieldInfos:s,fieldName:i,layer:r});const u=r&&r.fieldsIndex;return u&&u.isDateField(i)?Ai(e,PC):QC(e)}({fieldName:r,fieldInfos:t,fieldInfoMap:n,layer:i,value:e[r],graphic:s})})),o}function YC(t=""){return!!t&&-1!==t.indexOf(CC)}function XC({attributes:t,graphic:e,relatedInfo:i}){t&&e&&i&&Object.keys(e.attributes).forEach((s=>{const n=function(t){return t?`${CC}${t.layerId}/${t.fieldName}`:""}({layerId:""+i.relation.id,fieldName:s});t[n]=e.attributes[s]}))}const tP=t=>{if(!t)return!1;const e=t.toUpperCase();return e.indexOf("CURRENT_TIMESTAMP")>-1||e.indexOf("CURRENT_DATE")>-1||e.indexOf("CURRENT_TIME")>-1},eP=({layer:t,method:e,query:i,definitionExpression:s})=>{var n,r;if(null==(n=t.capabilities)||null==(r=n.query)||!r.supportsCacheHint||"attachments"===e)return;const o=u(i.where)&&i.where,a=u(i.geometry)&&i.geometry;tP(s)||tP(o)||"extent"===(null==a?void 0:a.type)||"tile"===i.resultType||(i.cacheHint=!0)},iP={editing:!1,operations:{add:!0,update:!0,delete:!0}},sP=qo.ofType(wC);let nP=class extends tS{constructor(t){super(t),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...iP},this.activeAttachmentInfo=null,this.attachmentInfos=new sP,this.graphic=null,this.mode="view",this.handles.add([Xo(this,"graphic",(()=>this._graphicChanged()))])}destroy(){this._attachmentLayer=null,this.graphic=null}castAbilities(t){return{...iP,...t}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){return this.get("graphic.layer.capabilities.operations.supportsResizeAttachments")||!1}async getAttachments(){const{_attachmentLayer:t,attachmentInfos:e}=this;if(!t||"function"!=typeof t.queryAttachments)throw new Ve("invalid-layer","getAttachments(): A valid layer is required.");const i=this._getFeatureId(),s=new SC({objectIds:[i],returnMetadata:!0}),n=[],r=t.queryAttachments(s).then((t=>t[i]||n)).catch((()=>n));this._getAttachmentsPromise=r,this.notifyChange("state");const o=await r;return e.removeAll(),o.length&&e.addMany(o),this._getAttachmentsPromise=null,this.notifyChange("state"),o}async addAttachment(t){const{_attachmentLayer:e,attachmentInfos:i,graphic:s,abilities:n}=this;if(!t)throw new Ve("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});if(!n.operations.add)throw new Ve("invalid-abilities","addAttachment(): add abilities are required.");if(!e||"function"!=typeof e.addAttachment)throw new Ve("invalid-layer","addAttachment(): A valid layer is required.");const r=e.addAttachment(s,t).then((t=>this._queryAttachment(t.objectId))),o=await r;return i.add(o),o}async deleteAttachment(t){const{_attachmentLayer:e,attachmentInfos:i,graphic:s,abilities:n}=this;if(!t)throw new Ve("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!n.operations.delete)throw new Ve("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!e||"function"!=typeof e.deleteAttachments)throw new Ve("invalid-layer","deleteAttachment(): A valid layer is required.");const r=e.deleteAttachments(s,[t.id]).then((()=>t)),o=await r;return i.remove(o),o}async updateAttachment(t,e=this.activeAttachmentInfo){const{_attachmentLayer:i,attachmentInfos:s,graphic:n,abilities:r}=this;if(!t)throw new Ve("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});if(!e)throw new Ve("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!r.operations.update)throw new Ve("invalid-abilities","updateAttachment(): Update abilities are required.");const o=s.findIndex((t=>t===e));if(!i||"function"!=typeof i.updateAttachment)throw new Ve("invalid-layer","updateAttachment(): A valid layer is required.");const a=i.updateAttachment(n,e.id,t).then((t=>this._queryAttachment(t.objectId))),l=await a;return s.splice(o,1,l),l}async _queryAttachment(t){if(!t)throw new Ve("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:e}=this,i=this._getFeatureId(),s=new SC({objectIds:[i],attachmentsWhere:"AttachmentId="+t,returnMetadata:!0});return e.queryAttachments(s).then((t=>t[i][0]))}_getFeatureId(){const{_attachmentLayer:t,graphic:e}=this;if(!t||!e)return null;const{objectIdField:i}=t,{attributes:s}=e;return s&&s[i]}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((()=>{})))}_setAttachmentLayer(){const{graphic:t}=this,e=EC(t);this._attachmentLayer=e?"scene"===e.type&&u(e.associatedLayer)?e.associatedLayer:e:null}};e([oe()],nP.prototype,"abilities",void 0),e([ba("abilities")],nP.prototype,"castAbilities",null),e([oe()],nP.prototype,"activeAttachmentInfo",void 0),e([oe({readOnly:!0,type:sP})],nP.prototype,"attachmentInfos",void 0),e([oe({type:hj})],nP.prototype,"graphic",void 0),e([oe()],nP.prototype,"mode",void 0),e([oe({readOnly:!0})],nP.prototype,"state",null),e([oe({readOnly:!0})],nP.prototype,"supportsResizeAttachments",null),nP=e([si("esri.widgets.Attachments.AttachmentsViewModel")],nP);const rP=nP,oP={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},aP=window.CSS;let lP=class extends Dc{constructor(t,e){super(t,e),this.abilities=null,this.displayType="auto",this.graphic=null,this.label=void 0,this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new rP,this.visibleElements={...oP},this._supportsImageOrientation=aP&&aP.supports&&aP.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null}initialize(){this.own(ca(this,"viewModel.attachmentInfos","change",(()=>this.scheduleRender())),Xo(this,"viewModel.mode",(()=>this._modeChanged())))}get effectiveDisplayType(){return"auto"===this.displayType?this.viewModel.supportsResizeAttachments?"preview":"list":this.displayType}castVisibleElements(t){return{...oP,...t}}addAttachment(){const{_addAttachmentForm:t,viewModel:e}=this;return this._set("submitting",!0),this._set("error",null),e.addAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),e.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new Ve("attachments:add-attachment",this.messages.addErrorMessage,t)),t}))}deleteAttachment(t){const{viewModel:e}=this;return this._set("submitting",!0),this._set("error",null),e.deleteAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),e.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new Ve("attachments:delete-attachment",this.messages.deleteErrorMessage,t)),t}))}updateAttachment(){const{viewModel:t}=this,{_updateAttachmentForm:e}=this;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(e).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((t=>{throw this._set("submitting",!1),this._set("error",new Ve("attachments:update-attachment",this.messages.updateErrorMessage,t)),t}))}render(){const{submitting:t,viewModel:e}=this,{state:i}=e;return Bc("div",{class:this.classes("esri-attachments","esri-widget")},t?this.renderProgressBar():null,"loading"===i?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:t,visibleElements:e}=this;return t&&e.errorMessage?Bc("div",{key:"error-message",class:"esri-attachments__error-message"},t.message):null}renderAttachments(){const{mode:t,activeAttachmentInfo:e}=this.viewModel;return"add"===t?this.renderAddForm():"edit"===t?this.renderDetailsForm(e):this.renderAttachmentContainer()}renderLoading(){return Bc("div",{class:"esri-attachments__loader-container",key:"loader"},Bc("div",{class:"esri-attachments__loader"}))}renderProgressBar(){return this.visibleElements.progressBar?Bc("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}renderAddForm(){const{submitting:t,selectedFile:e}=this,i=t||!e,s=this.visibleElements.cancelAddButton?Bc("button",{type:"button",bind:this,disabled:t,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--tertiary","esri-button--small","esri-button--half",t&&"esri-button--disabled")},this.messages.cancel):null,n=this.visibleElements.addSubmitButton?Bc("button",{type:"submit",disabled:i,class:this.classes("esri-button","esri-button--secondary","esri-button--small","esri-button--half",{"esri-button--disabled":i})},this.messages.add):null,r=e?Bc("span",{key:"file-name",class:"esri-attachments__file-name"},e.name):null,o=Bc("form",{bind:this,afterCreate:Cl,afterRemoved:Fl,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},Bc("fieldset",{class:"esri-attachments__file-fieldset"},r,Bc("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},e?this.messages.changeFile:this.messages.selectFile,Bc("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),n,s);return Bc("div",{key:"add-form-container",class:"esri-attachments__form-node"},o)}renderDetailsForm(t){const{visibleElements:e,viewModel:i,selectedFile:s,submitting:n}=this,{contentType:r,size:o,url:a}=t,{abilities:l}=i,u=n||!s,c=l.editing&&l.operations.delete&&e.deleteButton?Bc("button",{key:"delete-button",type:"button",disabled:n,bind:this,onclick:e=>this._submitDeleteAttachment(e,t),class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-attachments__delete-button",{"esri-button--disabled":n})},this.messages.delete):null,h=l.editing&&l.operations.update&&e.updateButton?Bc("button",{disabled:u,key:"update-button",type:"submit",class:this.classes("esri-button","esri-button--small","esri-button--third",{"esri-button--disabled":u})},this.messages.update):null,d=this.visibleElements.cancelUpdateButton?Bc("button",{disabled:n,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes("esri-button","esri-button--small","esri-button--tertiary","esri-button--third",{"esri-button--disabled":n})},this.messages.cancel):null,p=s?Bc("span",{key:"file-name",class:"esri-attachments__file-name"},s.name):null,f=l.editing&&l.operations.update?Bc("fieldset",{key:"file",class:"esri-attachments__file-fieldset"},p,Bc("label",{class:this.classes("esri-attachments__file-label","esri-button","esri-button--secondary")},this.messages.changeFile,Bc("input",{class:"esri-attachments__file-input",type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,y=Bc("fieldset",{key:"size",class:"esri-attachments__metadata-fieldset"},Bc("label",null,function(t,e){let i=0===e?0:Math.floor(Math.log(e)/Math.log(1024));i=od(i,0,4);const s=Ri(e/1024**i,{maximumFractionDigits:2});return rt(t.units.bytes[yC[i]],{fileSize:s})}(this.messagesUnits,o))),m=Bc("fieldset",{key:"content-type",class:"esri-attachments__metadata-fieldset"},Bc("label",null,r)),g=Bc("form",{bind:this,afterCreate:Cl,afterRemoved:Fl,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},Bc("div",{class:"esri-attachments__metadata"},y,m),f,Bc("div",{class:"esri-attachments__actions"},c,d,h));return Bc("div",{key:"edit-form-container",class:"esri-attachments__form-node"},Bc("a",{class:"esri-attachments__item-link",href:a,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:t,size:400}),Bc("div",{class:"esri-attachments__item-link-overlay"},Bc("span",{class:"esri-attachments__item-link-overlay-icon"},Bc("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},Bc("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),Bc("path",{fill:"none",d:"M0 0h32v32H0z"}))))),g)}renderImageMask({attachmentInfo:t,size:e}){const{supportsResizeAttachments:i}=this.viewModel,{contentType:s,name:n,url:r}=t,o=i&&function(t){const e=t.toLowerCase();return"image/bmp"===e||"image/emf"===e||"image/exif"===e||"image/gif"===e||"image/x-icon"===e||"image/jpeg"===e||"image/png"===e||"image/tiff"===e||"image/x-wmf"===e}(s),a=this._getCSSTransform(t,o),l=a?{transform:a,"image-orientation":"none"}:{},u=-1===r.indexOf("?")?"?":"&",c=o?`${r}${u}w=${e}`:function(t){const e=lr("esri/themes/base/images/files/");return t?"text/plain"===t?e+"text-32.svg":"application/pdf"===t?e+"pdf-32.svg":"text/csv"===t?e+"csv-32.svg":"application/gpx+xml"===t?e+"gpx-32.svg":"application/x-dwf"===t?e+"cad-32.svg":"application/postscript"===t||"application/json"===t||"text/xml"===t||"model/vrml"===t?e+"code-32.svg":"application/x-zip-compressed"===t||"application/x-7z-compressed"===t||"application/x-gzip"===t||"application/x-tar"===t||"application/x-gtar"===t||"application/x-bzip2"===t||"application/gzip"===t||"application/x-compress"===t||"application/x-apple-diskimage"===t||"application/x-rar-compressed"===t||"application/zip"===t?e+"zip-32.svg":-1!==t.indexOf("image/")?e+"image-32.svg":-1!==t.indexOf("audio/")?e+"sound-32.svg":-1!==t.indexOf("video/")?e+"video-32.svg":-1!==t.indexOf("msexcel")||-1!==t.indexOf("ms-excel")||-1!==t.indexOf("spreadsheetml")?e+"excel-32.svg":-1!==t.indexOf("msword")||-1!==t.indexOf("ms-word")||-1!==t.indexOf("wordprocessingml")?e+"word-32.svg":-1!==t.indexOf("powerpoint")||-1!==t.indexOf("presentationml")?e+"report-32.svg":e+"generic-32.svg":e+"generic-32.svg"}(s),h={"esri-attachments__image--resizable":i};return Bc("div",{class:this.classes({"esri-attachments__item-mask--icon":!o},"esri-attachments__item-mask")},Bc("img",{styles:l,alt:n,src:c,class:this.classes(h,"esri-attachments__image")}))}renderAttachmentInfo({attachmentInfo:t,displayType:e}){const{viewModel:i}=this,{abilities:s}=i,{name:n,url:r}=t,o=this.renderImageMask({attachmentInfo:t,size:"list"===e?48:400}),a=s.editing?Bc("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",Al(this.container)?"esri-icon-left":"esri-icon-right")}):null,l=[o,Bc("label",{class:"esri-attachments__label"},Bc("span",{class:"esri-attachments__filename"},n||this.messages.noTitle),a)],u=s.editing?Bc("button",{key:"details-button",bind:this,class:"esri-attachments__item-button",title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":t.id,onclick:()=>this._startEditAttachment(t),type:"button"},l):Bc("a",{key:"details-link",class:"esri-attachments__item-button",href:r,target:"_blank"},l);return Bc("li",{class:"esri-attachments__item",key:t},u)}renderAttachmentContainer(){const{effectiveDisplayType:t,viewModel:e,visibleElements:i}=this,{attachmentInfos:s,abilities:n}=e,r=s&&s.length,o={"esri-attachments__container--list":"preview"!==t,"esri-attachments__container--preview":"preview"===t},a=n.editing&&n.operations.add&&i.addButton?Bc("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes("esri-button","esri-button--tertiary","esri-attachments__add-attachment-button"),type:"button"},Bc("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon","esri-icon-plus")}),this.messages.add):null,l=r?Bc("ul",{class:"esri-attachments__items"},s.toArray().map((e=>this.renderAttachmentInfo({attachmentInfo:e,displayType:t})))):Bc("div",{class:"esri-widget__content--empty"},this.messages.noAttachments);return Bc("div",{key:"attachments-container",class:this.classes("esri-attachments__container",o)},l,a)}_modeChanged(){this._set("error",null),this._set("selectedFile",null)}_handleFileInputChange(t){const e=t.target,i=e&&e.files&&e.files.item(0);this._set("selectedFile",i)}_submitDeleteAttachment(t,e){t.preventDefault(),this.deleteAttachment(e)}_submitAddAttachment(t){t.preventDefault(),this.addAttachment()}_submitUpdateAttachment(t){t.preventDefault(),this.updateAttachment()}_startEditAttachment(t){const{viewModel:e}=this;e.activeAttachmentInfo=t,e.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(t){t.preventDefault(),this.viewModel.mode="view"}_getCSSTransform(t,e){const{orientationInfo:i}=t;return!this._supportsImageOrientation&&e&&i?[i.rotation?`rotate(${i.rotation}deg)`:"",i.mirrored?"scaleX(-1)":""].join(" "):""}};e([ue("viewModel.abilities")],lP.prototype,"abilities",void 0),e([oe()],lP.prototype,"displayType",void 0),e([oe({readOnly:!0})],lP.prototype,"effectiveDisplayType",null),e([ue("viewModel.graphic")],lP.prototype,"graphic",void 0),e([oe({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],lP.prototype,"label",void 0),e([oe(),zc("esri/widgets/Attachments/t9n/Attachments")],lP.prototype,"messages",void 0),e([oe(),zc("esri/core/t9n/Units")],lP.prototype,"messagesUnits",void 0),e([oe({readOnly:!0})],lP.prototype,"selectedFile",void 0),e([oe({readOnly:!0})],lP.prototype,"submitting",void 0),e([oe({readOnly:!0})],lP.prototype,"error",void 0),e([oe({type:rP})],lP.prototype,"viewModel",void 0),e([oe()],lP.prototype,"visibleElements",void 0),e([ba("visibleElements")],lP.prototype,"castVisibleElements",null),lP=e([si("esri.widgets.Attachments")],lP);const uP=lP;let cP=class extends rP{constructor(t){super(t),this.description=null,this.title=null}};e([oe()],cP.prototype,"description",void 0),e([oe()],cP.prototype,"title",void 0),cP=e([si("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],cP);const hP=cP;let dP=class extends Dc{constructor(t,e){super(t,e),this.description=null,this.headingLevel=2,this.title=null}render(){return Bc("div",{class:"esri-feature-element-info"},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:t}=this;return t?Bc(wO,{level:this.headingLevel,class:"esri-feature-element-info__title"},t):null}renderDescription(){const{description:t}=this;return t?Bc("div",{key:"description",class:"esri-feature-element-info__description"},t):null}};e([oe()],dP.prototype,"description",void 0),e([oe()],dP.prototype,"headingLevel",void 0),e([oe()],dP.prototype,"title",void 0),dP=e([si("esri.widgets.Feature.support.FeatureElementInfo")],dP);const pP=dP;let fP=class extends Dc{constructor(t,e){super(t,e),this._featureElementInfo=null,this.attachmentsWidget=new uP,this.description=null,this.displayType=null,this.graphic=null,this.headingLevel=2,this.title=null,this.viewModel=new hP}initialize(){this._featureElementInfo=new pP,Xo(this,["viewModel.description","viewModel.title","headingLevel"],(()=>this._setupFeatureElementInfo())),Xo(this,"viewModel.graphic",(t=>this.attachmentsWidget.graphic=t))}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy()}render(){var t;const{attachmentsWidget:e}=this;return Bc("div",{class:"esri-feature-attachments"},null==(t=this._featureElementInfo)?void 0:t.render(),null==e?void 0:e.render())}_setupFeatureElementInfo(){const{description:t,title:e,headingLevel:i}=this;this._featureElementInfo.set({description:t,title:e,headingLevel:i})}};e([oe({readOnly:!0})],fP.prototype,"attachmentsWidget",void 0),e([ue("viewModel.description")],fP.prototype,"description",void 0),e([ue("attachmentsWidget.displayType")],fP.prototype,"displayType",void 0),e([ue("viewModel.graphic")],fP.prototype,"graphic",void 0),e([oe()],fP.prototype,"headingLevel",void 0),e([ue("viewModel.title")],fP.prototype,"title",void 0),e([oe({type:hP})],fP.prototype,"viewModel",void 0),fP=e([si("esri.widgets.Feature.FeatureAttachments")],fP);const yP=fP;let mP=class extends(XM(jo)){constructor(t){super(t),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(Xo(this,"creator",(t=>{this._destroyContent(),this._createContent(t)})))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:t,graphic:e,destroyer:i}=this;t&&(RC(i,{graphic:e}).catch((()=>null)),this._set("created",null))}async _createContent(t){const{graphic:e}=this,i=RC(t,{graphic:e}).catch((()=>null));this._loadingPromise=i,this.notifyChange("state");const s=await i;i===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",s))}};e([oe({readOnly:!0})],mP.prototype,"created",void 0),e([oe()],mP.prototype,"creator",void 0),e([oe()],mP.prototype,"destroyer",void 0),e([oe({type:hj})],mP.prototype,"graphic",void 0),e([oe({readOnly:!0})],mP.prototype,"state",null),mP=e([si("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],mP);const gP=mP;let vP=class extends Dc{constructor(t,e){super(t,e),this.creator=null,this.graphic=null,this.viewModel=null,this._addTargetToAnchors=t=>{Array.from(t.querySelectorAll("a")).forEach((t=>{LC(t.href)&&!t.hasAttribute("target")&&t.setAttribute("target","_blank")}))}}renderLoading(){return Bc("div",{class:"esri-feature-content__loader-container",key:"loader"},Bc("div",{class:"esri-feature-content__loader"}))}renderCreated(){var t;const e=null==(t=this.viewModel)?void 0:t.created;return e?e instanceof HTMLElement?Bc("div",{key:e,bind:e,afterCreate:this._attachToNode}):Wc(e)?Bc("div",{key:e},!e.destroyed&&e.render()):Bc("div",{key:e,innerHTML:e,afterCreate:this._addTargetToAnchors}):null}render(){var t;return Bc("div",{class:"esri-feature-content"},"loading"===(null==(t=this.viewModel)?void 0:t.state)?this.renderLoading():this.renderCreated())}_attachToNode(t){t.appendChild(this)}};e([ue("viewModel.creator")],vP.prototype,"creator",void 0),e([ue("viewModel.graphic")],vP.prototype,"graphic",void 0),e([oe({type:gP})],vP.prototype,"viewModel",void 0),vP=e([si("esri.widgets.Feature.FeatureContent")],vP);const wP=vP;let bP=class extends jo{constructor(t){super(t),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null}get formattedFieldInfos(){const{expressionInfos:t,fieldInfos:e}=this,i=[];return null==e||e.forEach((e=>{if(e.hasOwnProperty("visible")&&!e.visible)return;const s=e.clone();s.label=DC(s,t),i.push(s)})),i}};e([oe()],bP.prototype,"attributes",void 0),e([oe({type:[PI]})],bP.prototype,"expressionInfos",void 0),e([oe()],bP.prototype,"description",void 0),e([oe({type:[qk]})],bP.prototype,"fieldInfos",void 0),e([oe({readOnly:!0})],bP.prototype,"formattedFieldInfos",null),e([oe()],bP.prototype,"title",void 0),bP=e([si("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],bP);const MP=bP,SP=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];let xP=class extends Dc{constructor(t,e){super(t,e),this._featureElementInfo=null,this.attributes=null,this.description=null,this.expressionInfos=null,this.fieldInfos=null,this.title=null,this.viewModel=new MP,this.messages=null,this.messagesURIUtils=null}initialize(){this._featureElementInfo=new pP,Xo(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo()))}destroy(){this._featureElementInfo.destroy()}renderFieldInfo(t,e){const{attributes:i}=this.viewModel,s=t.fieldName,n=t.label||s,r=i?null==i[s]?"":i[s]:"",o=!(!t.format||!t.format.dateFormat),a="number"!=typeof r||o?function(t,e){if("string"!=typeof e||!e)return e;const i=function(t){let e=null;return SP.some((i=>(i.pattern.test(t)&&(e=i),!!e))),e}(e);if(!i)return e;const s=e.match(i.pattern),n=rt(rt(i.label,{messages:t,hierPart:s&&s[2]}),{appName:i.appName});return e.replace(i.pattern,`<a${i.target?` target="${i.target}"`:""} href="$1"${"_blank"===i.target?' rel="noreferrer"':""}>${n}</a>`)}(this.messagesURIUtils,r):this._forceLTR(r),l={"esri-feature-fields__field-data--date":o};return Bc("tr",{key:`fields-element-info-row-${s}-${e}`},Bc("th",{key:`fields-element-info-row-header-${s}-${e}`,class:"esri-feature-fields__field-header",innerHTML:n}),Bc("td",{key:`fields-element-info-row-data-${s}-${e}`,class:this.classes("esri-feature-fields__field-data",l),innerHTML:a}))}renderFields(){const{formattedFieldInfos:t}=this.viewModel;return null!=t&&t.length?Bc("table",{class:"esri-widget__table",summary:this.messages.fieldsSummary},Bc("tbody",null,t.map(((t,e)=>this.renderFieldInfo(t,e))))):null}render(){var t;return Bc("div",{class:"esri-feature-fields"},null==(t=this._featureElementInfo)?void 0:t.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:t,title:e}=this;this._featureElementInfo.set({description:t,title:e})}_forceLTR(t){return"&lrm;"+t}};e([ue("viewModel.attributes")],xP.prototype,"attributes",void 0),e([ue("viewModel.description")],xP.prototype,"description",void 0),e([ue("viewModel.expressionInfos")],xP.prototype,"expressionInfos",void 0),e([ue("viewModel.fieldInfos")],xP.prototype,"fieldInfos",void 0),e([ue("viewModel.title")],xP.prototype,"title",void 0),e([oe({type:MP})],xP.prototype,"viewModel",void 0),e([oe(),zc("esri/widgets/Feature/t9n/Feature")],xP.prototype,"messages",void 0),e([oe(),zc("esri/widgets/support/t9n/uriUtils")],xP.prototype,"messagesURIUtils",void 0),xP=e([si("esri.widgets.Feature.FeatureFields")],xP);const kP=xP;var IP;let jP=IP=class extends Vd{constructor(t){super(t),this.name=null,this.code=null}clone(){return new IP({name:this.name,code:this.code})}};e([oe({type:String,json:{write:!0}})],jP.prototype,"name",void 0),e([oe({type:[String,Number],json:{write:!0}})],jP.prototype,"code",void 0),jP=IP=e([si("esri.layers.support.CodedValue")],jP);const _P=jP,TP=new ri({inherited:"inherited",codedValue:"coded-value",range:"range"});let OP=class extends Vd{constructor(t){super(t),this.name=null,this.type=null}};e([oe({type:String,json:{write:!0}})],OP.prototype,"name",void 0),e([Md(TP)],OP.prototype,"type",void 0),OP=e([si("esri.layers.support.Domain")],OP);const AP=OP;var FP;let CP=FP=class extends AP{constructor(t){super(t),this.codedValues=null,this.type="coded-value"}getName(t){let e=null;if(this.codedValues){const i=t+"";this.codedValues.some((t=>(t.code+""===i&&(e=t.name),!!e)))}return e}clone(){return new FP({codedValues:H(this.codedValues),name:this.name})}};e([oe({type:[_P],json:{write:!0}})],CP.prototype,"codedValues",void 0),e([Md({codedValue:"coded-value"})],CP.prototype,"type",void 0),CP=FP=e([si("esri.layers.support.CodedValueDomain")],CP);const PP=CP;var EP;let RP=EP=class extends AP{constructor(t){super(t),this.type="inherited"}clone(){return new EP}};e([Md({inherited:"inherited"})],RP.prototype,"type",void 0),RP=EP=e([si("esri.layers.support.InheritedDomain")],RP);const LP=RP;var NP;let DP=NP=class extends AP{constructor(t){super(t),this.maxValue=null,this.minValue=null,this.type="range"}clone(){return new NP({maxValue:this.maxValue,minValue:this.minValue,name:this.name})}};e([oe({type:Number,json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range&&e.range[1]},write:{enabled:!1,overridePolicy(){return{enabled:null!=this.maxValue&&null==this.minValue}},target:"range",writer(t,e,i){e[i]=[this.minValue||0,t]}}}})],DP.prototype,"maxValue",void 0),e([oe({type:Number,json:{type:[Number],read:{source:"range",reader:(t,e)=>e.range&&e.range[0]},write:{target:"range",writer(t,e,i){e[i]=[t,this.maxValue||0]}}}})],DP.prototype,"minValue",void 0),e([Md({range:"range"})],DP.prototype,"type",void 0),DP=NP=e([si("esri.layers.support.RangeDomain")],DP);const VP=DP,$P={key:"type",base:AP,typeMap:{range:VP,"coded-value":PP,inherited:LP}};function zP(t){if(!t||!t.type)return null;switch(t.type){case"range":return VP.fromJSON(t);case"codedValue":return PP.fromJSON(t);case"inherited":return LP.fromJSON(t)}return null}var GP;const UP=new ri({binary:"binary",coordinate:"coordinate",countOrAmount:"count-or-amount",dateAndTime:"date-and-time",description:"description",locationOrPlaceName:"location-or-place-name",measurement:"measurement",nameOrTitle:"name-or-title",none:"none",orderedOrRanked:"ordered-or-ranked",percentageOrRatio:"percentage-or-ratio",typeOrCategory:"type-or-category",uniqueIdentifier:"unique-identifier"});let qP=GP=class extends Vd{constructor(t){super(t),this.alias=null,this.defaultValue=void 0,this.description=null,this.domain=null,this.editable=!0,this.length=-1,this.name=null,this.nullable=!0,this.type=null,this.valueType=null}readDescription(t,{description:e}){let i;try{i=JSON.parse(e)}catch(t){}return i?i.value:null}readValueType(t,{description:e}){let i;try{i=JSON.parse(e)}catch(t){}return i?UP.fromJSON(i.fieldValueType):null}clone(){return new GP({alias:this.alias,defaultValue:this.defaultValue,description:this.description,domain:this.domain&&this.domain.clone()||null,editable:this.editable,length:this.length,name:this.name,nullable:this.nullable,type:this.type,valueType:this.valueType})}};e([oe({type:String,json:{write:!0}})],qP.prototype,"alias",void 0),e([oe({type:[String,Number],json:{write:{allowNull:!0}}})],qP.prototype,"defaultValue",void 0),e([oe()],qP.prototype,"description",void 0),e([Sd("description")],qP.prototype,"readDescription",null),e([oe({types:$P,json:{read:{reader:zP},write:!0}})],qP.prototype,"domain",void 0),e([oe({type:Boolean,json:{write:!0}})],qP.prototype,"editable",void 0),e([oe({type:Rt,json:{write:!0}})],qP.prototype,"length",void 0),e([oe({type:String,json:{write:!0}})],qP.prototype,"name",void 0),e([oe({type:Boolean,json:{write:!0}})],qP.prototype,"nullable",void 0),e([Md(pF)],qP.prototype,"type",void 0),e([oe()],qP.prototype,"valueType",void 0),e([Sd("valueType",["description"])],qP.prototype,"readValueType",null),qP=GP=e([si("esri.layers.support.Field")],qP);const BP=qP;var WP;let HP=WP=class extends Vd{constructor(t){super(t),this.type="map-layer"}clone(){const{mapLayerId:t,gdbVersion:e}=this;return new WP({mapLayerId:t,gdbVersion:e})}};var JP;e([Md({mapLayer:"map-layer"})],HP.prototype,"type",void 0),e([oe({type:Rt,json:{write:!0}})],HP.prototype,"mapLayerId",void 0),e([oe({type:String,json:{write:!0}})],HP.prototype,"gdbVersion",void 0),HP=WP=e([si("esri.layers.support.source.MapLayerSource")],HP);let ZP=JP=class extends Vd{constructor(t){super(t),this.type="query-table"}clone(){var t;const{workspaceId:e,query:i,oidFields:s,spatialReference:n,geometryType:r}=this,o={workspaceId:e,query:i,oidFields:s,spatialReference:null!=(t=null==n?void 0:n.clone())?t:void 0,geometryType:r};return new JP(o)}};var QP;e([Md({queryTable:"query-table"})],ZP.prototype,"type",void 0),e([oe({type:String,json:{write:!0}})],ZP.prototype,"workspaceId",void 0),e([oe({type:String,json:{write:!0}})],ZP.prototype,"query",void 0),e([oe({type:String,json:{write:!0}})],ZP.prototype,"oidFields",void 0),e([oe({type:ap,json:{write:!0}})],ZP.prototype,"spatialReference",void 0),e([Md(Jf)],ZP.prototype,"geometryType",void 0),ZP=JP=e([si("esri.layers.support.source.QueryTableDataSource")],ZP);let KP=QP=class extends Vd{constructor(t){super(t),this.type="raster"}clone(){const{workspaceId:t,dataSourceName:e}=this;return new QP({workspaceId:t,dataSourceName:e})}};var YP;e([Md({raster:"raster"})],KP.prototype,"type",void 0),e([oe({type:String,json:{write:!0}})],KP.prototype,"dataSourceName",void 0),e([oe({type:String,json:{write:!0}})],KP.prototype,"workspaceId",void 0),KP=QP=e([si("esri.layers.support.source.RasterDataSource")],KP);let XP=YP=class extends Vd{constructor(t){super(t),this.type="table"}clone(){const{workspaceId:t,gdbVersion:e,dataSourceName:i}=this;return new YP({workspaceId:t,gdbVersion:e,dataSourceName:i})}};var tE,eE;e([Md({table:"table"})],XP.prototype,"type",void 0),e([oe({type:String,json:{write:!0}})],XP.prototype,"workspaceId",void 0),e([oe({type:String,json:{write:!0}})],XP.prototype,"gdbVersion",void 0),e([oe({type:String,json:{write:!0}})],XP.prototype,"dataSourceName",void 0),XP=YP=e([si("esri.layers.support.source.TableDataSource")],XP);const iE=oi()({esriLeftInnerJoin:"left-inner-join",esriLeftOuterJoin:"left-outer-join"});let sE=tE=class extends Vd{constructor(t){super(t),this.type="join-table"}readLeftTableSource(t,e,i){return rE()(t,e,i)}castLeftTableSource(t){return Et(aE(),t)}readRightTableSource(t,e,i){return rE()(t,e,i)}castRightTableSource(t){return Et(aE(),t)}clone(){var t,e;const{leftTableKey:i,rightTableKey:s,leftTableSource:n,rightTableSource:r,joinType:o}=this,a={leftTableKey:i,rightTableKey:s,leftTableSource:null!=(t=null==n?void 0:n.clone())?t:void 0,rightTableSource:null!=(e=null==r?void 0:r.clone())?e:void 0,joinType:o};return new tE(a)}};e([Md({joinTable:"join-table"})],sE.prototype,"type",void 0),e([oe({type:String,json:{write:!0}})],sE.prototype,"leftTableKey",void 0),e([oe({type:String,json:{write:!0}})],sE.prototype,"rightTableKey",void 0),e([oe({json:{write:!0}})],sE.prototype,"leftTableSource",void 0),e([Sd("leftTableSource")],sE.prototype,"readLeftTableSource",null),e([ba("leftTableSource")],sE.prototype,"castLeftTableSource",null),e([oe({json:{write:!0}})],sE.prototype,"rightTableSource",void 0),e([Sd("rightTableSource")],sE.prototype,"readRightTableSource",null),e([ba("rightTableSource")],sE.prototype,"castRightTableSource",null),e([Md(iE)],sE.prototype,"joinType",void 0),sE=tE=e([si("esri.layers.support.source.JoinTableDataSource")],sE);let nE=null;function rE(){return nE||(nE=Oe({types:aE()})),nE}let oE=null;function aE(){return oE||(oE={key:"type",base:null,typeMap:{"data-layer":uE,"map-layer":HP}}),oE}const lE={key:"type",base:null,typeMap:{"join-table":sE,"query-table":ZP,raster:KP,table:XP}};let uE=eE=class extends Vd{constructor(t){super(t),this.type="data-layer"}clone(){const{fields:t,dataSource:e}=this;return new eE({fields:t,dataSource:e})}};var cE;e([Md({dataLayer:"data-layer"})],uE.prototype,"type",void 0),e([oe({type:[BP],json:{write:!0}})],uE.prototype,"fields",void 0),e([oe({types:lE,json:{write:!0}})],uE.prototype,"dataSource",void 0),uE=eE=e([si("esri.layers.support.source.DataLayerSource")],uE),uE.from=Tt(uE);const hE=new ri({upperLeft:"upper-left",lowerLeft:"lower-left"});let dE=cE=class extends Vd{constructor(t){super(t),this.extent=null,this.mode="view",this.originPosition="upper-left",this.tolerance=1}clone(){return new cE(H({extent:this.extent,mode:this.mode,originPosition:this.originPosition,tolerance:this.tolerance}))}};e([oe({type:of,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],dE.prototype,"extent",void 0),e([oe({type:["view","edit"],json:{write:!0}})],dE.prototype,"mode",void 0),e([oe({type:String,json:{read:hE.read,write:hE.write}})],dE.prototype,"originPosition",void 0),e([oe({type:Number,json:{write:{overridePolicy(){return{enabled:"view"===this.mode}}}}})],dE.prototype,"tolerance",void 0),dE=cE=e([si("esri.rest.support.QuantizationParameters")],dE);const pE=dE;var fE;const yE=new ri({count:"count",sum:"sum",min:"min",max:"max",avg:"avg",stddev:"stddev",var:"var",exceedslimit:"exceedslimit",percentile_cont:"percentile-continuous",percentile_disc:"percentile-discrete"});let mE=fE=class extends Vd{constructor(t){super(t),this.maxPointCount=void 0,this.maxRecordCount=void 0,this.maxVertexCount=void 0,this.onStatisticField=null,this.outStatisticFieldName=null,this.statisticType=null,this.statisticParameters=null}writeStatisticParameters(t,e){"percentile-continuous"!==this.statisticType&&"percentile-discrete"!==this.statisticType||(e.statisticParameters=H(t))}clone(){return new fE({maxPointCount:this.maxPointCount,maxRecordCount:this.maxRecordCount,maxVertexCount:this.maxVertexCount,onStatisticField:this.onStatisticField,outStatisticFieldName:this.outStatisticFieldName,statisticType:this.statisticType,statisticParameters:H(this.statisticParameters)})}};e([oe({type:Number,json:{write:!0}})],mE.prototype,"maxPointCount",void 0),e([oe({type:Number,json:{write:!0}})],mE.prototype,"maxRecordCount",void 0),e([oe({type:Number,json:{write:!0}})],mE.prototype,"maxVertexCount",void 0),e([oe({type:String,json:{write:!0}})],mE.prototype,"onStatisticField",void 0),e([oe({type:String,json:{write:!0}})],mE.prototype,"outStatisticFieldName",void 0),e([oe({type:String,json:{read:{source:"statisticType",reader:yE.read},write:{target:"statisticType",writer:yE.write}}})],mE.prototype,"statisticType",void 0),e([oe({type:Object})],mE.prototype,"statisticParameters",void 0),e([xd("statisticParameters")],mE.prototype,"writeStatisticParameters",null),mE=fE=e([si("esri.rest.support.StatisticDefinition")],mE);const gE=mE;var vE;const wE=new ri({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),bE=new ri({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let ME=vE=class extends Vd{constructor(t){super(t),this.aggregateIds=null,this.cacheHint=void 0,this.datumTransformation=null,this.distance=void 0,this.dynamicDataSource=void 0,this.formatOf3DObjects=null,this.gdbVersion=null,this.geometry=null,this.geometryPrecision=void 0,this.groupByFieldsForStatistics=null,this.having=null,this.historicMoment=null,this.maxAllowableOffset=void 0,this.maxRecordCountFactor=1,this.multipatchOption=null,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.outStatistics=null,this.parameterValues=null,this.pixelSize=null,this.quantizationParameters=null,this.rangeValues=null,this.relationParameter=null,this.resultType=null,this.returnCentroid=!1,this.returnDistinctValues=!1,this.returnExceededLimitFeatures=!0,this.returnGeometry=!1,this.returnQueryGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.sourceSpatialReference=null,this.spatialRelationship="intersects",this.start=void 0,this.sqlFormat=null,this.text=null,this.timeExtent=null,this.timeReferenceUnknownClient=!1,this.units=null,this.where=null}static from(t){return kt(vE,t)}castDatumTransformation(t){return"number"==typeof t||"object"==typeof t?t:null}writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeParameterValues(t,e){if(t){const i={};for(const e in t){const s=t[e];i[e]=Array.isArray(s)?s.map((t=>t instanceof Date?t.getTime():t)):s instanceof Date?s.getTime():s}e.parameterValues=i}}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,e.where="1=1"}writeWhere(t,e){e.where=t||"1=1"}clone(){return new vE(H({aggregateIds:this.aggregateIds,cacheHint:this.cacheHint,datumTransformation:this.datumTransformation,distance:this.distance,gdbVersion:this.gdbVersion,geometry:this.geometry,geometryPrecision:this.geometryPrecision,groupByFieldsForStatistics:this.groupByFieldsForStatistics,having:this.having,historicMoment:u(this.historicMoment)?new Date(this.historicMoment.getTime()):null,maxAllowableOffset:this.maxAllowableOffset,maxRecordCountFactor:this.maxRecordCountFactor,multipatchOption:this.multipatchOption,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,outStatistics:this.outStatistics,parameterValues:this.parameterValues,pixelSize:this.pixelSize,quantizationParameters:this.quantizationParameters,rangeValues:this.rangeValues,relationParameter:this.relationParameter,resultType:this.resultType,returnDistinctValues:this.returnDistinctValues,returnGeometry:this.returnGeometry,returnCentroid:this.returnCentroid,returnExceededLimitFeatures:this.returnExceededLimitFeatures,returnQueryGeometry:this.returnQueryGeometry,returnM:this.returnM,returnZ:this.returnZ,dynamicDataSource:this.dynamicDataSource,sourceSpatialReference:this.sourceSpatialReference,spatialRelationship:this.spatialRelationship,start:this.start,sqlFormat:this.sqlFormat,text:this.text,timeExtent:this.timeExtent,timeReferenceUnknownClient:this.timeReferenceUnknownClient,units:this.units,where:this.where}))}};ME.MAX_MAX_RECORD_COUNT_FACTOR=5,e([oe({json:{write:!0}})],ME.prototype,"aggregateIds",void 0),e([oe({type:Boolean,json:{write:!0}})],ME.prototype,"cacheHint",void 0),e([oe({json:{write:!0}})],ME.prototype,"datumTransformation",void 0),e([ba("datumTransformation")],ME.prototype,"castDatumTransformation",null),e([oe({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],ME.prototype,"distance",void 0),e([oe({type:uE,json:{write:!0}})],ME.prototype,"dynamicDataSource",void 0),e([oe({type:String,json:{write:!0}})],ME.prototype,"formatOf3DObjects",void 0),e([oe({type:String,json:{write:!0}})],ME.prototype,"gdbVersion",void 0),e([oe({types:ry,json:{read:ey,write:!0}})],ME.prototype,"geometry",void 0),e([oe({type:Number,json:{write:!0}})],ME.prototype,"geometryPrecision",void 0),e([oe({type:[String],json:{write:!0}})],ME.prototype,"groupByFieldsForStatistics",void 0),e([oe({type:String,json:{write:!0}})],ME.prototype,"having",void 0),e([oe({type:Date})],ME.prototype,"historicMoment",void 0),e([xd("historicMoment")],ME.prototype,"writeHistoricMoment",null),e([oe({type:Number,json:{write:!0}})],ME.prototype,"maxAllowableOffset",void 0),e([oe({type:Number,cast:t=>t<1?1:t>vE.MAX_MAX_RECORD_COUNT_FACTOR?vE.MAX_MAX_RECORD_COUNT_FACTOR:t,json:{write:{overridePolicy:t=>({enabled:t>1})}}})],ME.prototype,"maxRecordCountFactor",void 0),e([oe({type:["xyFootprint"],json:{write:!0}})],ME.prototype,"multipatchOption",void 0),e([oe({type:Number,json:{read:{source:"resultRecordCount"}}})],ME.prototype,"num",void 0),e([oe({json:{write:!0}})],ME.prototype,"objectIds",void 0),e([oe({type:[String],json:{write:!0}})],ME.prototype,"orderByFields",void 0),e([oe({type:[String],json:{write:!0}})],ME.prototype,"outFields",void 0),e([oe({type:ap,json:{name:"outSR",write:!0}})],ME.prototype,"outSpatialReference",void 0),e([oe({type:[gE],json:{write:{enabled:!0,overridePolicy(){return{enabled:u(this.outStatistics)&&this.outStatistics.length>0}}}}})],ME.prototype,"outStatistics",void 0),e([oe({json:{write:!0}})],ME.prototype,"parameterValues",void 0),e([xd("parameterValues")],ME.prototype,"writeParameterValues",null),e([oe({type:Fp,json:{write:!0}})],ME.prototype,"pixelSize",void 0),e([oe({type:pE,json:{write:!0}})],ME.prototype,"quantizationParameters",void 0),e([oe({type:[Object],json:{write:!0}})],ME.prototype,"rangeValues",void 0),e([oe({type:String,json:{read:{source:"relationParam"},write:{target:"relationParam",overridePolicy(){return{enabled:"relation"===this.spatialRelationship}}}}})],ME.prototype,"relationParameter",void 0),e([oe({type:String,json:{write:!0}})],ME.prototype,"resultType",void 0),e([oe({type:Boolean,json:{default:!1,write:!0}})],ME.prototype,"returnCentroid",void 0),e([oe({type:Boolean,json:{default:!1,write:!0}})],ME.prototype,"returnDistinctValues",void 0),e([oe({type:Boolean,json:{default:!0,write:!0}})],ME.prototype,"returnExceededLimitFeatures",void 0),e([oe({type:Boolean,json:{write:!0}})],ME.prototype,"returnGeometry",void 0),e([oe({type:Boolean,json:{default:!1,write:!0}})],ME.prototype,"returnQueryGeometry",void 0),e([oe({type:Boolean,json:{default:!1,write:!0}})],ME.prototype,"returnM",void 0),e([oe({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],ME.prototype,"returnZ",void 0),e([oe({type:ap,json:{write:!0}})],ME.prototype,"sourceSpatialReference",void 0),e([Md(wE,{ignoreUnknown:!1,name:"spatialRel"})],ME.prototype,"spatialRelationship",void 0),e([oe({type:Number,json:{read:{source:"resultOffset"}}})],ME.prototype,"start",void 0),e([xd("start"),xd("num")],ME.prototype,"writeStart",null),e([oe({type:String,json:{write:!0}})],ME.prototype,"sqlFormat",void 0),e([oe({type:String,json:{write:!0}})],ME.prototype,"text",void 0),e([oe({type:uS,json:{write:!0}})],ME.prototype,"timeExtent",void 0),e([oe({type:Boolean,json:{default:!1,write:!0}})],ME.prototype,"timeReferenceUnknownClient",void 0),e([Md(bE,{ignoreUnknown:!1}),oe({json:{write:{overridePolicy(t){return{enabled:t&&this.distance>0}}}}})],ME.prototype,"units",void 0),e([oe({type:String,json:{write:{overridePolicy(t){return{enabled:null!=t||this.start>0}}}}})],ME.prototype,"where",void 0),e([xd("where")],ME.prototype,"writeWhere",null),ME=vE=e([si("esri.rest.support.Query")],ME);const SE=ME;var xE;let kE=xE=class extends Vd{constructor(t){super(t),this.dynamicDataSource=void 0,this.gdbVersion=null,this.geometryPrecision=void 0,this.historicMoment=null,this.maxAllowableOffset=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.relationshipId=void 0,this.start=void 0,this.num=void 0,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.where=null}_writeHistoricMoment(t,e){e.historicMoment=t&&t.getTime()}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10,this.start>0&&null==this.where&&(e.definitionExpression="1=1")}clone(){return new xE(H({dynamicDataSource:this.dynamicDataSource,gdbVersion:this.gdbVersion,geometryPrecision:this.geometryPrecision,historicMoment:this.historicMoment&&new Date(this.historicMoment.getTime()),maxAllowableOffset:this.maxAllowableOffset,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,relationshipId:this.relationshipId,start:this.start,num:this.num,returnGeometry:this.returnGeometry,where:this.where,returnZ:this.returnZ,returnM:this.returnM}))}};e([oe({type:uE,json:{write:!0}})],kE.prototype,"dynamicDataSource",void 0),e([oe({type:String,json:{write:!0}})],kE.prototype,"gdbVersion",void 0),e([oe({type:Number,json:{write:!0}})],kE.prototype,"geometryPrecision",void 0),e([oe({type:Date})],kE.prototype,"historicMoment",void 0),e([xd("historicMoment")],kE.prototype,"_writeHistoricMoment",null),e([oe({type:Number,json:{write:!0}})],kE.prototype,"maxAllowableOffset",void 0),e([oe({type:[Number],json:{write:!0}})],kE.prototype,"objectIds",void 0),e([oe({type:[String],json:{write:!0}})],kE.prototype,"orderByFields",void 0),e([oe({type:[String],json:{write:!0}})],kE.prototype,"outFields",void 0),e([oe({type:ap,json:{read:{source:"outSR"},write:{target:"outSR"}}})],kE.prototype,"outSpatialReference",void 0),e([oe({json:{write:!0}})],kE.prototype,"relationshipId",void 0),e([oe({type:Number,json:{read:{source:"resultOffset"}}})],kE.prototype,"start",void 0),e([xd("start"),xd("num")],kE.prototype,"writeStart",null),e([oe({type:Number,json:{read:{source:"resultRecordCount"}}})],kE.prototype,"num",void 0),e([oe({json:{write:!0}})],kE.prototype,"returnGeometry",void 0),e([oe({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],kE.prototype,"returnM",void 0),e([oe({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],kE.prototype,"returnZ",void 0),e([oe({type:String,json:{read:{source:"definitionExpression"},write:{target:"definitionExpression"}}})],kE.prototype,"where",void 0),kE=xE=e([si("esri.rest.support.RelationshipQuery")],kE),kE.from=Tt(kE);const IE=kE;function jE(t){const e={};for(const i in t){if("declaredClass"===i)continue;const s=t[i];if(null!=s&&"function"!=typeof s)if(Array.isArray(s)){e[i]=[];for(let t=0;t<s.length;t++)e[i][t]=jE(s[t])}else"object"==typeof s?s.toJSON&&(e[i]=JSON.stringify(s)):e[i]=s}return e}function _E(t){const e=t.toJSON();return e.attachmentTypes&&(e.attachmentTypes=e.attachmentTypes.join(",")),e.keywords&&(e.keywords=e.keywords.join(",")),e.globalIds&&(e.globalIds=e.globalIds.join(",")),e.objectIds&&(e.objectIds=e.objectIds.join(",")),e.size&&(e.size=e.size.join(",")),e}function TE(t,e){const i={};for(const s of t){const{parentObjectId:t,parentGlobalId:n,attachmentInfos:r}=s;for(const s of r){const{id:r}=s,o=Us(Rn(`${e}/${t}/attachments/${r}`)),a=wC.fromJSON(s);a.set({url:o,parentObjectId:t,parentGlobalId:n}),i[t]?i[t].push(a):i[t]=[a]}}return i}const OE={102100:{maxX:20037508.342788905,minX:-20037508.342788905,plus180Line:new Hf({paths:[[[20037508.342788905,-20037508.342788905],[20037508.342788905,20037508.342788905]]],spatialReference:ap.WebMercator}),minus180Line:new Hf({paths:[[[-20037508.342788905,-20037508.342788905],[-20037508.342788905,20037508.342788905]]],spatialReference:ap.WebMercator})},4326:{maxX:180,minX:-180,plus180Line:new Hf({paths:[[[180,-180],[180,180]]],spatialReference:ap.WGS84}),minus180Line:new Hf({paths:[[[-180,-180],[-180,180]]],spatialReference:ap.WGS84})}};function AE(t,e){return Math.ceil((t-e)/(2*e))}function FE(t,e){const i=CE(t);for(const t of i)for(const i of t)i[0]+=e;return t}function CE(t){return ty(t)?t.rings:t.paths}function PE(t){const e=(null==t?void 0:t.isWebMercator)?102100:4326;return[OE[e].minX,OE[e].maxX]}function EE(t){return{geometryType:iy(t[0]),geometries:t.map((t=>t.toJSON()))}}const RE=ct.getLogger("esri.geometry.support.normalizeUtils");function LE(t){return"polygon"===t[0].type}function NE(t){return"polyline"===t[0].type}function DE(t,e,i){if(e){const e=function(t,e){if(!(t instanceof Hf||t instanceof qf)){const t="straightLineDensify: the input geometry is neither polyline nor polygon";throw RE.error(t),new Ve(t)}const i=CE(t),s=[];for(const t of i){const i=[];s.push(i),i.push([t[0][0],t[0][1]]);for(let s=0;s<t.length-1;s++){const n=t[s][0],r=t[s][1],o=t[s+1][0],a=t[s+1][1],l=Math.sqrt((o-n)*(o-n)+(a-r)*(a-r)),u=(a-r)/l,c=(o-n)/l,h=l/e;if(h>1){for(let t=1;t<=h-1;t++){const s=t*e;i.push([c*s+n,u*s+r])}const t=(l+Math.floor(h-1)*e)/2;i.push([c*t+n,u*t+r])}i.push([o,a])}}return function(t){return"polygon"===t.type}(t)?new qf({rings:s,spatialReference:t.spatialReference}):new Hf({paths:s,spatialReference:t.spatialReference})}(t,1e6);t=Ip(e,!0)}return i&&(t=FE(t,i)),t}function VE(t,e,i){if(Array.isArray(t)){const s=t[0];if(s>e){const i=AE(s,e);t[0]=s+i*(-2*e)}else if(s<i){const e=AE(s,i);t[0]=s+e*(-2*i)}}else{const s=t.x;if(s>e){const i=AE(s,e);t=t.clone().offset(i*(-2*e),0)}else if(s<i){const e=AE(s,i);t=t.clone().offset(e*(-2*i),0)}}return t}async function $E(t,e,i){var s;if(!Array.isArray(t))return $E([t],e);const n=null!=(s=null==e?void 0:e.url)?s:it.geometryServiceUrl;let r,o,a,l,h,d,p,f,y=0;const m=[],g=[];for(const e of t)if(c(e))g.push(e);else if(r||(r=e.spatialReference,o=Jd(r),a=r.isWebMercator,d=a?102100:4326,l=OE[d].maxX,h=OE[d].minX,p=OE[d].plus180Line,f=OE[d].minus180Line),o)if("mesh"===e.type)g.push(e);else if("point"===e.type)g.push(VE(e.clone(),l,h));else if("multipoint"===e.type){const t=e.clone();t.points=t.points.map((t=>VE(t,l,h))),g.push(t)}else if("extent"===e.type){const t=e.clone()._normalize(!1,!1,o);g.push(t.rings?new qf(t):t)}else if(e.extent){const t=e.extent,i=AE(t.xmin,h)*(2*l);let s=0===i?e.clone():FE(e.clone(),i);t.offset(i,0),t.intersects(p)&&t.xmax!==l?(y=t.xmax>y?t.xmax:y,s=DE(s,a),m.push(s),g.push("cut")):t.intersects(f)&&t.xmin!==h?(y=t.xmax*(2*l)>y?t.xmax*(2*l):y,s=DE(s,a,360),m.push(s),g.push("cut")):g.push(s)}else g.push(e.clone());else g.push(e);let v=AE(y,l),w=-90;const b=v,M=new Hf;for(;v>0;){const t=360*v-180;M.addPath([[t,w],[t,-1*w]]),w*=-1,v--}if(m.length>0&&b>0){const e=function(t,e){let i=-1;for(let s=0;s<e.cutIndexes.length;s++){const n=e.cutIndexes[s],r=e.geometries[s],o=CE(r);for(let t=0;t<o.length;t++){const e=o[t];e.some((i=>{if(i[0]<180)return!0;{let i=0;for(let t=0;t<e.length;t++){const s=e[t][0];i=s>i?s:i}i=Number(i.toFixed(9));const s=-360*AE(i,180);for(let i=0;i<e.length;i++){const e=r.getPoint(t,i);r.setPoint(t,i,e.clone().offset(s,0))}return!0}}))}if(n===i){if(LE(t))for(const e of CE(r))t[n]=t[n].addRing(e);else if(NE(t))for(const e of CE(r))t[n]=t[n].addPath(e)}else i=n,t[n]=r}return t}(m,await async function(t,e,i,s){const n="string"==typeof t?Vs(t):t,r=e[0].spatialReference,o={...s,query:{...n.query,f:"json",sr:JSON.stringify(r),target:JSON.stringify({geometryType:iy(e[0]),geometries:e}),cutter:JSON.stringify(i)}},a=await $n(n.path+"/cut",o),{cutIndexes:l,geometries:u=[]}=a.data;return{cutIndexes:l,geometries:u.map((t=>{const e=ey(t);return e.spatialReference=r,e}))}}(n,m,M,i)),s=[],r=[];for(let i=0;i<g.length;i++){const n=g[i];if("cut"!==n)r.push(n);else{const n=e.shift(),o=t[i];u(o)&&"polygon"===o.type&&o.rings&&o.rings.length>1&&n.rings.length>=o.rings.length?(s.push(n),r.push("simplify")):r.push(a?kp(n):n)}}if(!s.length)return r;const o=await async function(t,e,i){const s="string"==typeof t?Vs(t):t,n=e[0].spatialReference,r=iy(e[0]),o={...i,query:{...s.query,f:"json",sr:n.wkid?n.wkid:JSON.stringify(n),geometries:JSON.stringify(EE(e))}};return function(t,e,i){const s=ny(e);return t.map((t=>{const e=s.fromJSON(t);return e.spatialReference=i,e}))}((await $n(s.path+"/simplify",o)).data,r,n)}(n,s,i),l=[];for(let t=0;t<r.length;t++){const e=r[t];l.push("simplify"!==e?e:a?kp(o.shift()):o.shift())}return l}const S=[];for(let t=0;t<g.length;t++){const e=g[t];if("cut"!==e)S.push(e);else{const t=m.shift();S.push(!0===a?kp(t):t)}}return Promise.resolve(S)}function zE(t,e){const i=Jd(e);if(i){const[e,s]=i.valid,n=s-e;if(t<e)for(;t<e;)t+=n;if(t>s)for(;t>s;)t-=n}return t}const GE=l("esri-text-decoder")?new TextDecoder("utf-8"):null,UE=l("safari")||l("ios")?6:l("ff")?12:32;class qE{constructor(t,e,i=0,s=(t?t.byteLength:0)){this._tag=0,this._dataType=99,this.init(t,e,i,s)}init(t,e,i,s){this._data=t,this._dataView=e,this._pos=i,this._end=s}clone(){return new qE(this._data,this._dataView,this._pos,this._end)}pos(){return this._pos}move(t){this._pos=t}nextTag(t){for(;;){if(this._pos===this._end)return!1;const e=this._decodeVarint();if(this._tag=e>>3,this._dataType=7&e,!t||t===this._tag)break;this.skip()}return!0}next(){if(this._pos===this._end)return!1;const t=this._decodeVarint();return this._tag=t>>3,this._dataType=7&t,!0}empty(){return this._pos>=this._end}tag(){return this._tag}getInt32(){return this._decodeVarint()}getInt64(){return this._decodeVarint()}getUInt32(){let t=4294967295;return t=(127&this._data[this._pos])>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<7)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<14)>>>0,this._data[this._pos++]<128?t:(t=(t|(127&this._data[this._pos])<<21)>>>0,this._data[this._pos++]<128?t:(t=(t|(15&this._data[this._pos])<<28)>>>0,this._data[this._pos++]<128?t:void 0))))}getUInt64(){return this._decodeVarint()}getSInt32(){const t=this.getUInt32();return t>>>1^-(1&t)|0}getSInt64(){return this._decodeSVarint()}getBool(){const t=0!==this._data[this._pos];return this._skip(1),t}getEnum(){return this._decodeVarint()}getFixed64(){const t=this._dataView,e=this._pos,i=t.getUint32(e,!0)+4294967296*t.getUint32(e+4,!0);return this._skip(8),i}getSFixed64(){const t=this._dataView,e=this._pos,i=t.getUint32(e,!0)+4294967296*t.getInt32(e+4,!0);return this._skip(8),i}getDouble(){const t=this._dataView.getFloat64(this._pos,!0);return this._skip(8),t}getFixed32(){const t=this._dataView.getUint32(this._pos,!0);return this._skip(4),t}getSFixed32(){const t=this._dataView.getInt32(this._pos,!0);return this._skip(4),t}getFloat(){const t=this._dataView.getFloat32(this._pos,!0);return this._skip(4),t}getString(){const t=this._getLength(),e=this._pos,i=this._toString(this._data,e,e+t);return this._skip(t),i}getBytes(){const t=this._getLength(),e=this._pos,i=this._toBytes(this._data,e,e+t);return this._skip(t),i}getLength(){return this._getLengthUnsafe()}processMessageWithArgs(t,e,i,s){const n=this.getMessage(),r=t(n,e,i,s);return n.release(),r}processMessage(t){const e=this.getMessage(),i=t(e);return e.release(),i}getMessage(){const t=this._getLength(),e=qE.pool.acquire();return e.init(this._data,this._dataView,this._pos,this._pos+t),this._skip(t),e}release(){qE.pool.release(this)}dataType(){return this._dataType}skip(){switch(this._dataType){case 0:this._decodeVarint();break;case 1:this._skip(8);break;case 2:this._skip(this._getLength());break;case 5:this._skip(4);break;default:throw Error("Invalid data type!")}}skipLen(t){this._skip(t)}_skip(t){if(this._pos+t>this._end)throw Error("Attempt to skip past the end of buffer!");this._pos+=t}_decodeVarint(){const t=this._data;let e,i=this._pos,s=0;if(this._end-i>=10)do{if(e=t[i++],s|=127&e,0==(128&e))break;if(e=t[i++],s|=(127&e)<<7,0==(128&e))break;if(e=t[i++],s|=(127&e)<<14,0==(128&e))break;if(e=t[i++],s|=(127&e)<<21,0==(128&e))break;if(e=t[i++],s+=268435456*(127&e),0==(128&e))break;if(e=t[i++],s+=34359738368*(127&e),0==(128&e))break;if(e=t[i++],s+=4398046511104*(127&e),0==(128&e))break;if(e=t[i++],s+=562949953421312*(127&e),0==(128&e))break;if(e=t[i++],s+=72057594037927940*(127&e),0==(128&e))break;if(e=t[i++],s+=0x8000000000000000*(127&e),0==(128&e))break;throw Error("Varint too long!")}while(0);else{let n=1;for(;i!==this._end&&(e=t[i],0!=(128&e));)++i,s+=(127&e)*n,n*=128;if(i===this._end)throw Error("Varint overrun!");++i,s+=e*n}return this._pos=i,s}_decodeSVarint(){const t=this._decodeVarint();return t%2?-(t+1)/2:t/2}_getLength(){if(2!==this._dataType)throw Error("Not a delimited data type!");return this._decodeVarint()}_getLengthUnsafe(){return this.getUInt32()}_toString(t,e,i){if((i=Math.min(this._end,i))-e>UE&&GE){const s=t.subarray(e,i);return GE.decode(s)}let s="",n="";for(let r=e;r<i;++r){const e=t[r];128&e?n+="%"+e.toString(16):(s+=decodeURIComponent(n)+String.fromCharCode(e),n="")}return n.length&&(s+=decodeURIComponent(n)),s}_toBytes(t,e,i){return i=Math.min(this._end,i),new Uint8Array(t.buffer,e,i-e)}}qE.pool=new gr(qE,null,(t=>{t._data=null,t._dataView=null}));class BE{constructor(t=[],e=[],i=!1){this.lengths=null!=t?t:[],this.coords=null!=e?e:[],this.hasIndeterminateRingOrder=i}get isPoint(){return 0===this.lengths.length}get maxLength(){return Math.max(...this.lengths)}get size(){return this.lengths.reduce(((t,e)=>t+e))}forEachVertex(t){let e=0;this.lengths.length||t(this.coords[0],this.coords[1]);for(let i=0;i<this.lengths.length;i++){const s=this.lengths[i];for(let i=0;i<s;i++)t(this.coords[2*(i+e)],this.coords[2*(i+e)+1]);e+=s}}clone(t){return t?(t.set(this.coords),new BE(this.lengths.slice(),t,this.hasIndeterminateRingOrder)):new BE(this.lengths.slice(),this.coords.slice(),this.hasIndeterminateRingOrder)}}class WE{constructor(t=null,e={},i,s){this.geometry=t,this.attributes=e,this.centroid=i,this.objectId=s,this.displayId=0,this.geohashX=0,this.geohashY=0}weakClone(){const t=new WE(this.geometry,this.attributes,this.centroid,this.objectId);return t.displayId=this.displayId,t.geohashX=this.geohashX,t.geohashY=this.geohashY,t}}function HE(t){return!(c(t.geometry)||!t.geometry.coords||!t.geometry.coords.length)}class JE extends WE{}class ZE{constructor(){this.objectIdFieldName=null,this.globalIdFieldName=null,this.geohashFieldName=null,this.geometryProperties=null,this.geometryType=null,this.spatialReference=null,this.hasZ=!1,this.hasM=!1,this.features=[],this.fields=[],this.transform=null,this.exceededTransferLimit=!1,this.uniqueIdField=null,this.queryGeometryType=null,this.queryGeometry=null}weakClone(){const t=new ZE;return t.objectIdFieldName=this.objectIdFieldName,t.globalIdFieldName=this.globalIdFieldName,t.geohashFieldName=this.geohashFieldName,t.geometryProperties=this.geometryProperties,t.geometryType=this.geometryType,t.spatialReference=this.spatialReference,t.hasZ=this.hasZ,t.hasM=this.hasM,t.features=this.features,t.fields=this.fields,t.transform=this.transform,t.exceededTransferLimit=this.exceededTransferLimit,t.uniqueIdField=this.uniqueIdField,t.queryGeometry=this.queryGeometry,t.queryGeometryType=this.queryGeometryType,t}}const QE=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"];class KE{constructor(t){this.options=t,this.geometryTypes=QE,this._coordinatePtr=0,this._vertexDimension=0}createFeatureResult(){return new ZE}prepareFeatures(t){this._vertexDimension=2,t.hasZ&&this._vertexDimension++,t.hasM&&this._vertexDimension++}finishFeatureResult(t){if(!t||!t.features||!t.hasZ||!this.options.sourceSpatialReference||!t.spatialReference||Hd(t.spatialReference,this.options.sourceSpatialReference)||t.spatialReference.vcsWkid)return;const e=NS(this.options.sourceSpatialReference)/NS(t.spatialReference);if(1!==e)for(const i of t.features){if(!HE(i))continue;const t=i.geometry.coords;for(let i=2;i<t.length;i+=3)t[i]*=e}}addFeature(t,e){t.features.push(e)}createFeature(){return new WE}createSpatialReference(){return{wkid:0}}createGeometry(){return new BE}addField(t,e){t.fields.push(e)}allocateCoordinates(t){t.coords.length=t.lengths.reduce(((t,e)=>t+e),0)*this._vertexDimension,this._coordinatePtr=0}addCoordinate(t,e){t.coords[this._coordinatePtr++]=e}addCoordinatePoint(t,e){t.coords.push(e)}addLength(t,e){t.lengths.push(e)}addQueryGeometry(t,e){t.queryGeometry=e.queryGeometry,t.queryGeometryType=e.queryGeometryType}createPointGeometry(){return new BE}}const YE=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeString","esriFieldTypeDate","esriFieldTypeOID","esriFieldTypeGeometry","esriFieldTypeBlob","esriFieldTypeRaster","esriFieldTypeGUID","esriFieldTypeGlobalID","esriFieldTypeXML"],XE=["sqlTypeBigInt","sqlTypeBinary","sqlTypeBit","sqlTypeChar","sqlTypeDate","sqlTypeDecimal","sqlTypeDouble","sqlTypeFloat","sqlTypeGeometry","sqlTypeGUID","sqlTypeInteger","sqlTypeLongNVarchar","sqlTypeLongVarbinary","sqlTypeLongVarchar","sqlTypeNChar","sqlTypeNVarchar","sqlTypeOther","sqlTypeReal","sqlTypeSmallInt","sqlTypeSqlXml","sqlTypeTime","sqlTypeTimestamp","sqlTypeTimestamp2","sqlTypeTinyInt","sqlTypeVarbinary","sqlTypeVarchar"],tR=["upperLeft","lowerLeft"];function eR(t){return t>=YE.length?null:YE[t]}function iR(t){return t>=XE.length?null:XE[t]}function sR(t){return t>=tR.length?null:tR[t]}function nR(t,e){return e>=t.geometryTypes.length?null:t.geometryTypes[e]}function rR(t,e,i){const s=e.createPointGeometry(i);for(;t.next();)switch(t.tag()){case 3:{const i=t.getUInt32(),n=t.pos()+i;let r=0;for(;t.pos()<n;)e.addCoordinatePoint(s,t.getSInt64(),r++);break}default:t.skip()}return s}function oR(t,e,i){const s=e.createGeometry(i),n=2+(i.hasZ?1:0)+(i.hasM?1:0);for(;t.next();)switch(t.tag()){case 2:{const i=t.getUInt32(),n=t.pos()+i;let r=0;for(;t.pos()<n;)e.addLength(s,t.getUInt32(),r++);break}case 3:{const i=t.getUInt32(),r=t.pos()+i;let o=0;for(e.allocateCoordinates(s);t.pos()<r;)e.addCoordinate(s,t.getSInt64(),o),o++,o===n&&(o=0);break}default:t.skip()}return s}function aR(t){const e=new BE;let i="esriGeometryPoint";for(;t.next();)switch(t.tag()){case 2:{const i=t.getUInt32(),s=t.pos()+i;for(;t.pos()<s;)e.lengths.push(t.getUInt32());break}case 3:{const i=t.getUInt32(),s=t.pos()+i;for(;t.pos()<s;)e.coords.push(t.getSInt64());break}case 1:i=QE[t.getEnum()];break;default:t.skip()}return{queryGeometry:e,queryGeometryType:i}}function lR(t){for(;t.next();)switch(t.tag()){case 1:return t.getString();case 2:return t.getFloat();case 3:return t.getDouble();case 4:return t.getSInt32();case 5:return t.getUInt32();case 6:return t.getInt64();case 7:return t.getUInt64();case 8:return t.getSInt64();case 9:return t.getBool();default:return t.skip(),null}return null}function uR(t){const e={type:eR(0)};for(;t.next();)switch(t.tag()){case 1:e.name=t.getString();break;case 2:e.type=eR(t.getEnum());break;case 3:e.alias=t.getString();break;case 4:e.sqlType=iR(t.getEnum());break;default:t.skip();break;case 6:e.defaultValue=t.getString()}return e}function cR(t){const e={};for(;t.next();)switch(t.tag()){case 1:e.name=t.getString();break;case 2:e.isSystemMaintained=t.getBool();break;default:t.skip()}return e}function hR(t,e,i,s){const n=e.createFeature(i);let r=0;for(;t.next();)switch(t.tag()){case 1:{const e=s[r++].name;n.attributes[e]=t.processMessage(lR);break}case 2:n.geometry=t.processMessageWithArgs(oR,e,i);break;case 4:n.centroid=t.processMessageWithArgs(rR,e,i);break;default:t.skip()}return n}function dR(t){const e=[1,1,1,1];for(;t.next();)switch(t.tag()){case 1:e[0]=t.getDouble();break;case 2:e[1]=t.getDouble();break;case 4:e[2]=t.getDouble();break;case 3:e[3]=t.getDouble();break;default:t.skip()}return e}function pR(t){const e=[0,0,0,0];for(;t.next();)switch(t.tag()){case 1:e[0]=t.getDouble();break;case 2:e[1]=t.getDouble();break;case 4:e[2]=t.getDouble();break;case 3:e[3]=t.getDouble();break;default:t.skip()}return e}function fR(t){const e={originPosition:sR(0)};for(;t.next();)switch(t.tag()){case 1:e.originPosition=sR(t.getEnum());break;case 2:e.scale=t.processMessage(dR);break;case 3:e.translate=t.processMessage(pR);break;default:t.skip()}return e}function yR(t){const e={};for(;t.next();)switch(t.tag()){case 1:e.shapeAreaFieldName=t.getString();break;case 2:e.shapeLengthFieldName=t.getString();break;case 3:e.units=t.getString();break;default:t.skip()}return e}function mR(t,e){const i=e.createSpatialReference();for(;t.next();)switch(t.tag()){case 1:i.wkid=t.getUInt32();break;case 5:i.wkt=t.getString();break;case 2:i.latestWkid=t.getUInt32();break;case 3:i.vcsWkid=t.getUInt32();break;case 4:i.latestVcsWkid=t.getUInt32();break;default:t.skip()}return i}function gR(t,e){const i=e.createFeatureResult();i.geometryType=nR(e,0);let s=!1;for(;t.next();)switch(t.tag()){case 1:i.objectIdFieldName=t.getString();break;case 3:i.globalIdFieldName=t.getString();break;case 4:i.geohashFieldName=t.getString();break;case 5:i.geometryProperties=t.processMessage(yR);break;case 7:i.geometryType=nR(e,t.getEnum());break;case 8:i.spatialReference=t.processMessageWithArgs(mR,e);break;case 10:i.hasZ=t.getBool();break;case 11:i.hasM=t.getBool();break;case 12:i.transform=t.processMessage(fR);break;case 9:{const e=t.getBool();i.exceededTransferLimit=e;break}case 13:e.addField(i,t.processMessage(uR));break;case 15:s||(e.prepareFeatures(i),s=!0),e.addFeature(i,t.processMessageWithArgs(hR,e,i,i.fields));break;case 2:i.uniqueIdField=t.processMessage(cR);break;default:t.skip()}return e.finishFeatureResult(i),i}function vR(t,e){const i={};let s=null;for(;t.next();)switch(t.tag()){case 4:s=t.processMessageWithArgs(aR);break;case 1:i.featureResult=t.processMessageWithArgs(gR,e);break;default:t.skip()}return u(s)&&i.featureResult&&e.addQueryGeometry(i,s),i}function wR(t,e){const i=function(t,e){try{const i=2,s=new qE(new Uint8Array(t),new DataView(t)),n={};for(;s.next();)s.tag()===i?n.queryResult=s.processMessageWithArgs(vR,e):s.skip();return n}catch(t){throw new Ve("query:parsing-pbf","Error while parsing FeatureSet PBF payload",{error:t})}}(t,e),s=i.queryResult.featureResult,n=i.queryResult.queryGeometry,r=i.queryResult.queryGeometryType;if(s&&s.features&&s.features.length&&s.objectIdFieldName){const t=s.objectIdFieldName;for(const e of s.features)e.attributes&&(e.objectId=e.attributes[t])}return s&&(s.queryGeometry=n,s.queryGeometryType=r),s}function bR(t,e,i){if(c(e)||c(i)||i.vcsWkid||Hd(e,i))return null;const s=NS(e)/NS(i);if(1===s)return null;switch(t){case"point":case"esriGeometryPoint":return t=>function(t,e){t&&null!=t.z&&(t.z*=e)}(t,s);case"polyline":case"esriGeometryPolyline":return t=>function(t,e){if(t)for(const i of t.paths)for(const t of i)t.length>2&&(t[2]*=e)}(t,s);case"polygon":case"esriGeometryPolygon":return t=>function(t,e){if(t)for(const i of t.rings)for(const t of i)t.length>2&&(t[2]*=e)}(t,s);case"multipoint":case"esriGeometryMultipoint":return t=>function(t,e){if(t)for(const i of t.points)i.length>2&&(i[2]*=e)}(t,s);default:return null}}function MR(t,e,i){if(null==t.hasM||t.hasZ)for(const t of e)for(const e of t)e.length>2&&(e[2]*=i)}function SR(t,e,i){if(!t&&!e||!i)return;const s=NS(i);xR(t,i,s),xR(e,i,s)}function xR(t,e,i){if(t)for(const s of t)kR(s.geometry,e,i)}function kR(t,e,i){if(c(t)||!t.spatialReference||Hd(t.spatialReference,e))return;const s=NS(t.spatialReference)/i;if(1!==s)if("x"in t)null!=t.z&&(t.z*=s);else if("rings"in t)MR(t,t.rings,s);else if("paths"in t)MR(t,t.paths,s);else if("points"in t&&(null==t.hasM||t.hasZ))for(const e of t.points)e.length>2&&(e[2]*=s)}function IR(t,e,i){if(!i||!i.features||!i.hasZ)return;const s=bR(i.geometryType,e,t.outSpatialReference);if(!c(s))for(const t of i.features)s(t.geometry)}const jR="Layer does not support extent calculation.";function _R(t,e){const i=t.geometry,s=t.toJSON(),n=s;if(u(i)&&(n.geometry=JSON.stringify(i),n.geometryType=iy(i),n.inSR=i.spatialReference.wkid||JSON.stringify(i.spatialReference)),s.groupByFieldsForStatistics&&(n.groupByFieldsForStatistics=s.groupByFieldsForStatistics.join(",")),s.objectIds&&(n.objectIds=s.objectIds.join(",")),s.orderByFields&&(n.orderByFields=s.orderByFields.join(",")),!s.outFields||!s.returnDistinctValues&&(null!=e&&e.returnCountOnly||null!=e&&e.returnExtentOnly||null!=e&&e.returnIdsOnly)?delete n.outFields:n.outFields=-1!==s.outFields.indexOf("*")?"*":s.outFields.join(","),s.outSR?n.outSR=s.outSR.wkid||JSON.stringify(s.outSR):i&&(s.returnGeometry||s.returnCentroid)&&(n.outSR=n.inSR),s.returnGeometry&&delete s.returnGeometry,s.outStatistics&&(n.outStatistics=JSON.stringify(s.outStatistics)),s.pixelSize&&(n.pixelSize=JSON.stringify(s.pixelSize)),s.quantizationParameters&&(n.quantizationParameters=JSON.stringify(s.quantizationParameters)),s.parameterValues&&(n.parameterValues=JSON.stringify(s.parameterValues)),s.rangeValues&&(n.rangeValues=JSON.stringify(s.rangeValues)),s.dynamicDataSource&&(n.layer=JSON.stringify({source:s.dynamicDataSource}),delete s.dynamicDataSource),s.timeExtent){const t=s.timeExtent,{start:e,end:i}=t;null==e&&null==i||(n.time=e===i?e:`${null==e?"null":e},${null==i?"null":i}`),delete s.timeExtent}return n}async function TR(t,e,i,s){const n=u(e.timeExtent)&&e.timeExtent.isEmpty?{data:{features:[]}}:await ER(t,e,"json",s);return IR(e,i,n.data),n}async function OR(t,e,i,s){if(u(e.timeExtent)&&e.timeExtent.isEmpty)return Promise.resolve({data:i.createFeatureResult()});const n=await AR(t,e,s),r=n;return r.data=wR(n.data,i),r}function AR(t,e,i){return ER(t,e,"pbf",i)}function FR(t,e,i){return u(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):ER(t,e,"json",i,{returnIdsOnly:!0})}function CR(t,e,i){return u(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):ER(t,e,"json",i,{returnIdsOnly:!0,returnCountOnly:!0})}function PR(t,e,i){return u(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):ER(t,e,"json",i,{returnExtentOnly:!0,returnCountOnly:!0}).then((t=>{const e=t.data;if(e.hasOwnProperty("extent"))return t;if(e.features)throw Error(jR);if(e.hasOwnProperty("count"))throw Error(jR);return t}))}function ER(t,e,i,s={},n={}){const r="string"==typeof t?Vs(t):t,o=e.geometry?[e.geometry]:[];return s.responseType="pbf"===i?"array-buffer":"json",$E(o,null,s).then((t=>{const o=t&&t[0];u(o)&&((e=e.clone()).geometry=o);const a=jE({...r.query,f:i,...n,..._R(e,n)});return $n(nn(r.path,"query"),{...s,query:{...a,...s.query}})}))}const RR=Object.freeze({__proto__:null,executeQuery:TR,executeQueryForCount:CR,executeQueryForExtent:PR,executeQueryForIds:FR,executeQueryPBF:OR,executeQueryPBFBuffer:AR,queryToQueryStringParameters:_R,runQuery:ER});async function LR(t,e,i){return CR(SO(t),SE.from(e),{...i}).then((t=>t.data.count))}async function NR(t,e,i){return FR(SO(t),SE.from(e),{...i}).then((t=>t.data.objectIds))}const DR=new ri({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryEnvelope:"extent",mesh:"mesh","":null});let VR=class extends Vd{constructor(t){super(t),this.displayFieldName=null,this.exceededTransferLimit=!1,this.features=[],this.fields=null,this.geometryType=null,this.hasM=!1,this.hasZ=!1,this.queryGeometry=null,this.spatialReference=null}readFeatures(t,e){const i=ap.fromJSON(e.spatialReference),s=[];for(let e=0;e<t.length;e++){const n=t[e],r=hj.fromJSON(n),o=n.geometry&&n.geometry.spatialReference;u(r.geometry)&&!o&&(r.geometry.spatialReference=i),s.push(r)}return s}writeGeometryType(t,e,i,s){if(t)return void DR.write(t,e,i,s);const{features:n}=this;if(n)for(const t of n)if(t&&u(t.geometry))return void DR.write(t.geometry.type,e,i,s)}readQueryGeometry(t,e){if(!t)return null;const i=!!t.spatialReference,s=ey(t);return!i&&e.spatialReference&&(s.spatialReference=ap.fromJSON(e.spatialReference)),s}writeSpatialReference(t,e){if(t)return void(e.spatialReference=t.toJSON());const{features:i}=this;if(i)for(const t of i)if(t&&u(t.geometry)&&t.geometry.spatialReference)return void(e.spatialReference=t.geometry.spatialReference.toJSON())}toJSON(t){const e=this.write();if(e.features&&Array.isArray(t)&&t.length>0)for(let i=0;i<e.features.length;i++){const s=e.features[i];if(s.geometry){const e=t&&t[i];s.geometry=e&&e.toJSON()||s.geometry}}return e}quantize(t){const{scale:[e,i],translate:[s,n]}=t,r=this.features,o=this._getQuantizationFunction(this.geometryType,(t=>Math.round((t-s)/e)),(t=>Math.round((n-t)/i)));for(let t=0,e=r.length;t<e;t++)o(r[t].geometry)||(r.splice(t,1),t--,e--);return this.transform=t,this}unquantize(){const{geometryType:t,features:e,transform:i}=this;if(!i)return this;const{translate:[s,n],scale:[r,o]}=i,a=this._getHydrationFunction(t,(t=>t*r+s),(t=>n-t*o));for(const{geometry:t}of e)u(t)&&a(t);return this.transform=null,this}_quantizePoints(t,e,i){let s,n;const r=[];for(let o=0,a=t.length;o<a;o++){const a=t[o];if(o>0){const t=e(a[0]),o=i(a[1]);t===s&&o===n||(r.push([t-s,o-n]),s=t,n=o)}else s=e(a[0]),n=i(a[1]),r.push([s,n])}return r.length>0?r:null}_getQuantizationFunction(t,e,i){return"point"===t?t=>(t.x=e(t.x),t.y=i(t.y),t):"polyline"===t||"polygon"===t?t=>{const s=ty(t)?t.rings:t.paths,n=[];for(let t=0,r=s.length;t<r;t++){const r=this._quantizePoints(s[t],e,i);r&&n.push(r)}return n.length>0?(ty(t)?t.rings=n:t.paths=n,t):null}:"multipoint"===t?t=>{const s=this._quantizePoints(t.points,e,i);return s.length>0?(t.points=s,t):null}:"extent"===t?t=>t:null}_getHydrationFunction(t,e,i){return"point"===t?t=>{t.x=e(t.x),t.y=i(t.y)}:"polyline"===t||"polygon"===t?t=>{const s=ty(t)?t.rings:t.paths;let n,r;for(let t=0,o=s.length;t<o;t++){const o=s[t];for(let t=0,s=o.length;t<s;t++){const s=o[t];t>0?(n+=s[0],r+=s[1]):(n=s[0],r=s[1]),s[0]=e(n),s[1]=i(r)}}}:"extent"===t?t=>{t.xmin=e(t.xmin),t.ymin=i(t.ymin),t.xmax=e(t.xmax),t.ymax=i(t.ymax)}:"multipoint"===t?t=>{const s=t.points;let n,r;for(let t=0,o=s.length;t<o;t++){const o=s[t];t>0?(n+=o[0],r+=o[1]):(n=o[0],r=o[1]),o[0]=e(n),o[1]=i(r)}}:void 0}};e([oe({type:String,json:{write:!0}})],VR.prototype,"displayFieldName",void 0),e([oe({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],VR.prototype,"exceededTransferLimit",void 0),e([oe({type:[hj],json:{write:!0}})],VR.prototype,"features",void 0),e([Sd("features")],VR.prototype,"readFeatures",null),e([oe({type:[BP],json:{write:!0}})],VR.prototype,"fields",void 0),e([oe({type:["point","multipoint","polyline","polygon","extent","mesh"],json:{read:{reader:DR.read}}})],VR.prototype,"geometryType",void 0),e([xd("geometryType")],VR.prototype,"writeGeometryType",null),e([oe({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],VR.prototype,"hasM",void 0),e([oe({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],VR.prototype,"hasZ",void 0),e([oe({types:ry,json:{write:!0}})],VR.prototype,"queryGeometry",void 0),e([Sd("queryGeometry")],VR.prototype,"readQueryGeometry",null),e([oe({type:ap,json:{write:!0}})],VR.prototype,"spatialReference",void 0),e([xd("spatialReference")],VR.prototype,"writeSpatialReference",null),e([oe({json:{write:!0}})],VR.prototype,"transform",void 0),VR=e([si("esri.rest.support.FeatureSet")],VR),VR.prototype.toJSON.isDefaultToJSON=!0;const $R=VR,zR=Object.freeze({__proto__:null,default:$R});async function GR(t,e,i){const s=await UR(t,e,i);return $R.fromJSON(s)}async function UR(t,e,i){const s=SO(t),n={...i},r=SE.from(e),{data:o}=await TR(s,r,r.sourceSpatialReference,n);return o}function qR(t,e){return t?e?4:3:e?3:2}const BR=ct.getLogger("esri.tasks.support.optimizedFeatureSet"),WR={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0},HR=(t,e,i,s,n,r)=>{t[i]=n,t[i+1]=r},JR=(t,e,i,s,n,r)=>{t[i]=n,t[i+1]=r,t[i+2]=e[s+2]},ZR=(t,e,i,s,n,r)=>{t[i]=n,t[i+1]=r,t[i+2]=e[s+3]},QR=(t,e,i,s,n,r)=>{t[i]=n,t[i+1]=r,t[i+2]=e[s+2],t[i+3]=e[s+3]};function KR(t,e,i,s){if(t){if(i)return e&&s?QR:JR;if(e&&s)return ZR}else if(e&&s)return JR;return HR}function YR({scale:t,translate:e},i){return Math.round((i-e[0])/t[0])}function XR({scale:t,translate:e},i){return Math.round((e[1]-i)/t[1])}function tL({scale:t,translate:e},i){return i*t[0]+e[0]}function eL({scale:t,translate:e},i){return e[1]-i*t[1]}function iL(t,e,i){return t?e?i?uL(t):rL(t):i?aL(t):sL(t):null}function sL(t){const e=t.coords;return{x:e[0],y:e[1]}}function nL(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t}function rL(t){const e=t.coords;return{x:e[0],y:e[1],z:e[2]}}function oL(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.z,t}function aL(t){const e=t.coords;return{x:e[0],y:e[1],m:e[2]}}function lL(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.m,t}function uL(t){const e=t.coords;return{x:e[0],y:e[1],z:e[2],m:e[3]}}function cL(t,e){return t.coords[0]=e.x,t.coords[1]=e.y,t.coords[2]=e.z,t.coords[3]=e.m,t}function hL(t,e){return t&&e?cL:t?oL:e?lL:nL}function dL(t,e,i,s,n){const r=hL(i,s);for(const i of e){const{geometry:e,attributes:s}=i;let o;e&&(o=r(new BE,e)),t.push(new WE(o,s,null,s[n]))}return t}function pL(t,e,i){if(c(t))return null;const s=qR(e,i),n=[];for(let e=0;e<t.coords.length;e+=s){const i=[];for(let n=0;n<s;n++)i.push(t.coords[e+n]);n.push(i)}return e?i?{points:n,hasZ:e,hasM:i}:{points:n,hasZ:e}:i?{points:n,hasM:i}:{points:n}}function fL(t,e,i,s,n){const r=qR(i,s);for(const i of e){const e=i.geometry,s=i.attributes;let o;e&&(o=yL(new BE,e,r)),t.push(new WE(o,s,null,s[n]))}return t}function yL(t,e,i=qR(e.hasZ,e.hasM)){t.lengths[0]=e.points.length;const s=t.coords;let n=0;for(const t of e.points)for(let e=0;e<i;e++)s[n++]=t[e];return t}function mL(t,e,i){if(!t)return null;const s=qR(e,i),{coords:n,lengths:r}=t,o=[];let a=0;for(const t of r){const e=[];for(let i=0;i<t;i++){const t=[];for(let e=0;e<s;e++)t.push(n[a++]);e.push(t)}o.push(e)}return e?i?{paths:o,hasZ:e,hasM:i}:{paths:o,hasZ:e}:i?{paths:o,hasM:i}:{paths:o}}function gL(t,e,i,s,n){const r=qR(i,s);for(const i of e){const e=i.geometry,s=i.attributes;let o;e&&(o=vL(new BE,e,r)),t.push(new WE(o,s,null,s[n]))}return t}function vL(t,e,i=qR(e.hasZ,e.hasM)){const{lengths:s,coords:n}=t;let r=0;for(const t of e.paths){for(const e of t)for(let t=0;t<i;t++)n[r++]=e[t];s.push(t.length)}return t}function wL(t,e,i){if(!t)return null;const s=qR(e,i),{coords:n,lengths:r}=t,o=[];let a=0;for(const t of r){const e=[];for(let i=0;i<t;i++){const t=[];for(let e=0;e<s;e++)t.push(n[a++]);e.push(t)}o.push(e)}return e?i?{rings:o,hasZ:e,hasM:i}:{rings:o,hasZ:e}:i?{rings:o,hasM:i}:{rings:o}}function bL(t,e,i,s,n){for(const r of e){const e=r.geometry,o=r.centroid,a=r.attributes;let l;e&&(l=ML(new BE,e,i,s)),u(o)?t.push(new WE(l,a,nL(new BE,o),a[n])):t.push(new WE(l,a,null,a[n]))}return t}function ML(t,e,i=e.hasZ,s=e.hasM){return SL(t,e.rings,i,s),t}function SL(t,e,i,s){const n=qR(i,s),{lengths:r,coords:o}=t;let a=0;r.length=o.length=0;for(const t of e){for(const e of t)for(let t=0;t<n;t++)o[a++]=e[t];r.push(t.length)}return t}const xL=[],kL=[];function IL(t,e,i,s,n){xL[0]=t;const[r]=jL(kL,xL,e,i,s,n);return xL.length=kL.length=0,r}function jL(t,e,i,s,n,r){if(t.length=0,!i){for(const i of e)t.push(new WE(null,i.attributes,null,i.attributes[r]));return t}switch(i){case"esriGeometryPoint":return dL(t,e,s,n,r);case"esriGeometryMultipoint":return fL(t,e,s,n,r);case"esriGeometryPolyline":return gL(t,e,s,n,r);case"esriGeometryPolygon":return bL(t,e,s,n,r);default:BR.error("convertToFeatureSet:unknown-geometry",new Ve(`Unable to parse unknown geometry type '${i}'`)),t.length=0}return t}function _L(t,e,i,s,n,r){const o=t.length;switch(i){case"esriGeometryPoint":dL(t,e,s,n,r);break;case"esriGeometryMultipoint":fL(t,e,s,n,r);break;case"esriGeometryPolyline":gL(t,e,s,n,r);break;case"esriGeometryPolygon":bL(t,e,s,n,r);break;default:BR.error("convertToFeatureSet:unknown-geometry",new Ve(`Unable to parse unknown geometry type '${i}'`))}for(let s=0;s<e.length;s++)t[s+o].geometryType=i,t[s+o].insertAfter=e[s].insertAfter,t[s+o].groupId=e[s].groupId;return t}function TL(t,e,i,s){kL[0]=t,FL(xL,kL,e,i,s);const n=xL[0];return xL.length=kL.length=0,n}function OL(t,e,i){if(c(t))return null;const s=new BE;return"hasZ"in t&&null==e&&(e=t.hasZ),"hasM"in t&&null==i&&(i=t.hasM),Yf(t)?hL(null!=e?e:null!=t.z,null!=i?i:null!=t.m)(s,t):ty(t)?ML(s,t,e,i):Xf(t)?vL(s,t,qR(e,i)):Kf(t)?yL(s,t,qR(e,i)):void BR.error("convertFromGeometry:unknown-geometry",new Ve(`Unable to parse unknown geometry type '${t}'`))}function AL(t,e,i,s){const n=t&&("coords"in t?t:t.geometry);if(c(n))return null;switch(e){case"esriGeometryPoint":{let t=sL;return i&&s?t=uL:i?t=rL:s&&(t=aL),t(n)}case"esriGeometryMultipoint":return pL(n,i,s);case"esriGeometryPolyline":return mL(n,i,s);case"esriGeometryPolygon":return wL(n,i,s);default:return void BR.error("convertToGeometry:unknown-geometry",new Ve(`Unable to parse unknown geometry type '${e}'`))}}function FL(t,e,i,s,n){if(t.length=0,c(i))return function(t,e){for(const i of e)t.push({attributes:i.attributes});return t}(t,e);switch(i){case"esriGeometryPoint":return function(t,e,i,s){let n=sL;i&&s?n=uL:i?n=rL:s&&(n=aL);for(const i of e){const{geometry:e,attributes:s}=i,r=u(e)?n(e):null;t.push({attributes:s,geometry:r})}return t}(t,e,s,n);case"esriGeometryMultipoint":return function(t,e,i,s){for(const n of e){const{geometry:e,attributes:r}=n;let o;e&&(o=pL(e,i,s)),t.push({attributes:r,geometry:o})}return t}(t,e,s,n);case"esriGeometryPolyline":return function(t,e,i,s){for(const n of e){const{geometry:e,attributes:r}=n;let o;u(e)&&(o=mL(e,i,s)),t.push({attributes:r,geometry:o})}return t}(t,e,s,n);case"esriGeometryPolygon":return function(t,e,i,s){for(const n of e){const{geometry:e,attributes:r,centroid:o}=n;let a;if(u(e)&&(a=wL(e,i,s)),o){const e=sL(o);t.push({attributes:r,centroid:e,geometry:a})}else t.push({attributes:r,geometry:a})}return t}(t,e,s,n);default:BR.error("convertToFeatureSet:unknown-geometry",new Ve(`Unable to parse unknown geometry type '${i}'`))}return t}function CL(t){const{objectIdFieldName:e,spatialReference:i,transform:s,fields:n,hasM:r,hasZ:o,features:a,geometryType:l,exceededTransferLimit:u,uniqueIdField:c,queryGeometry:h,queryGeometryType:d}=t,p={features:FL([],a,l,o,r),fields:n,geometryType:l,objectIdFieldName:e,spatialReference:i,uniqueIdField:c,queryGeometry:AL(h,d,!1,!1)};return s&&(p.transform=s),u&&(p.exceededTransferLimit=u),r&&(p.hasM=r),o&&(p.hasZ=o),p}function PL(t,e){const i=new ZE,{hasM:s,hasZ:n,features:r,objectIdFieldName:o,spatialReference:a,geometryType:l,exceededTransferLimit:u,transform:c,fields:h}=t;return h&&(i.fields=h),i.geometryType=l,i.objectIdFieldName=o||e,i.spatialReference=a,i.objectIdFieldName?(r&&jL(i.features,r,l,n,s,i.objectIdFieldName),u&&(i.exceededTransferLimit=u),s&&(i.hasM=s),n&&(i.hasZ=n),c&&(i.transform=c),i):(BR.error(new Ve("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),i)}function EL(t){const{transform:e,features:i,hasM:s,hasZ:n}=t;if(!e)return t;for(const t of i)u(t.geometry)&&zL(t.geometry,t.geometry,s,n,e),t.centroid&&zL(t.centroid,t.centroid,s,n,e);return t.transform=null,t}function RL(t,e){const{geometryType:i,features:s,hasM:n,hasZ:r}=e;if(!t)return e;for(let e=0;e<s.length;e++){const o=s[e],a=o.weakClone();a.geometry=new BE,LL(a.geometry,o.geometry,n,r,i,t),o.centroid&&(a.centroid=new BE,LL(a.centroid,o.centroid,n,r,"esriGeometryPoint",t)),s[e]=a}return e.transform=t,e}function LL(t,e,i,s,n,r,o=i,a=s){if(t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0),c(e)||!e.coords.length)return null;const l=WR[n],{coords:u,lengths:h}=e,d=qR(i,s),p=qR(i&&o,s&&a),f=KR(i,s,o,a);if(!h.length)return f(t.coords,u,0,0,YR(r,u[0]),XR(r,u[1])),t.lengths.length&&(t.lengths.length=0),t.coords.length=d,t;let y,m,g,v,w=0,b=0,M=b;for(const e of h){if(e<l)continue;let i=0;b=M,g=y=YR(r,u[w]),v=m=XR(r,u[w+1]),f(t.coords,u,b,w,g,v),i++,w+=d,b+=p;for(let s=1;s<e;s++,w+=d)g=YR(r,u[w]),v=XR(r,u[w+1]),g===y&&v===m||(f(t.coords,u,b,w,g-y,v-m),b+=p,i++,y=g,m=v);i>=l&&(t.lengths.push(i),M=b)}return t.coords.length=M,t.coords.length?t:null}function NL(t,e,i,s,n,r,o=i,a=s){if(t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0),!e||!e.coords.length)return null;const l=WR[n],{coords:u,lengths:c}=e,h=qR(i,s),d=qR(i&&o,s&&a),p=KR(i,s,o,a);if(!c.length)return p(t.coords,u,0,0,u[0],u[1]),t.lengths.length&&(t.lengths.length=0),t.coords.length=h,t;let f=0;const y=r*r;for(const e of c){if(e<l){f+=e*h;continue}const i=t.coords.length/d,s=f,n=f+(e-1)*h;p(t.coords,u,t.coords.length,s,u[s],u[s+1]),VL(t.coords,u,h,y,p,s,n),p(t.coords,u,t.coords.length,n,u[n],u[n+1]);const r=t.coords.length/d-i;r>=l?t.lengths.push(r):t.coords.length=i*d,f+=e*h}return t.coords.length?t:null}function DL(t,e,i,s){const n=t[e],r=t[e+1],o=t[s],a=t[s+1];let l=t[i],u=t[i+1],c=o-l,h=a-u;if(0!==c||0!==h){const t=((n-l)*c+(r-u)*h)/(c*c+h*h);t>1?(l=o,u=a):t>0&&(l+=c*t,u+=h*t)}return c=n-l,h=r-u,c*c+h*h}function VL(t,e,i,s,n,r,o){let a,l=s,u=0;for(let t=r+i;t<o;t+=i)a=DL(e,t,r,o),a>l&&(u=t,l=a);l>s&&(u-r>i&&VL(t,e,i,s,n,r,u),n(t,e,t.length,u,e[u],e[u+1]),o-u>i&&VL(t,e,i,s,n,u,o))}function $L(t,e,i,s){if(c(e)||!e.coords||!e.coords.length)return null;const n=qR(i,s);let r=1/0,o=1/0,a=-1/0,l=-1/0;if(e&&e.coords){const t=e.coords;for(let e=0;e<t.length;e+=n){const i=t[e],s=t[e+1];r=Math.min(r,i),a=Math.max(a,i),o=Math.min(o,s),l=Math.max(l,s)}}return t[0]=r,t[1]=o,t[2]=a,t[3]=l,t}function zL(t,e,i,s,n){const{coords:r,lengths:o}=e,a=i?s?QR:JR:s?JR:HR,l=qR(i,s);if(!r.length)return t!==e&&(t.lengths.length=0,t.coords.length=0),t;if(!o.length)return a(t.coords,r,0,0,tL(n,r[0]),eL(n,r[1])),t!==e&&(t.lengths.length=0,t.coords.length=l),t;const[u,c]=n.scale;let h=0;for(let e=0;e<o.length;e++){const i=o[e];t.lengths[e]=i;let s=tL(n,r[h]),d=eL(n,r[h+1]);a(t.coords,r,h,h,s,d),h+=l;for(let e=1;e<i;e++,h+=l)s+=r[h]*u,d-=r[h+1]*c,a(t.coords,r,h,h,s,d)}return t!==e&&(t.lengths.length=o.length,t.coords.length=r.length),t}function GL(t,e,i,s,n,r){const o=qR(i,s),a=KR(i,s,n,r),l=e.coords;t.coords.length=0,t.lengths.length=0,t.lengths.push(...e.lengths);for(let e=0;e<l.length;e+=o)a(t.coords,l,t.coords.length,e,l[e],l[e+1]);return t}function UL(t,e,i,s){let n=0,r=t[s*e],o=t[s*(e+1)];for(let a=1;a<i;a++){const i=r+t[s*(e+a)],l=o+t[s*(e+a)+1],u=(i-r)*(l+o);r=i,o=l,n+=u}return.5*n}function qL(t,e){const{coords:i,lengths:s}=t;let n=0,r=0;for(let t=0;t<s.length;t++)r+=UL(i,n,s[t],e),n+=t;return Math.abs(r)}function BL(t,e){if(c(t))return null;const i=t.clone(),s=t.coords,n=t.lengths;let r=0;for(let t=0;t<n.length;t++){const o=n[t];let a=s[e*r],l=s[e*r+1];for(let t=1;t<o;t++){const n=a+s[e*(r+t)],o=l+s[e*(r+t)+1];i.coords[e*(r+t)]=n,i.coords[e*(r+t)+1]=o,a=n,l=o}r+=o}return i}function WL(t,e){return e}function HL(t,e,i,s){switch(i){case 0:return KL(t,e+s,0);case 1:return"lowerLeft"===t.originPosition?KL(t,e+s,1):function({translate:t,scale:e},i,s){return t[s]-i*e[s]}(t,e+s,1)}}function JL(t,e,i,s){return 2===i?KL(t,e,2):HL(t,e,i,s)}function ZL(t,e,i,s){return 2===i?KL(t,e,3):HL(t,e,i,s)}function QL(t,e,i,s){return 3===i?KL(t,e,3):JL(t,e,i,s)}function KL({translate:t,scale:e},i,s){return t[s]+i*e[s]}class YL{constructor(t){this.options=t,this.geometryTypes=["esriGeometryPoint","esriGeometryMultipoint","esriGeometryPolyline","esriGeometryPolygon"],this.previousCoordinate=[0,0],this.transform=null,this.applyTransform=WL,this.lengths=[],this.currentLengthIndex=0,this.toAddInCurrentPath=0,this.vertexDimension=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,this.AttributesConstructor=function(){}}createFeatureResult(){return{fields:[],features:[]}}finishFeatureResult(t){if(this.options.applyTransform&&(t.transform=null),this.AttributesConstructor=function(){},this.coordinateBuffer=null,this.lengths.length=0,!t.hasZ)return;const e=bR(t.geometryType,this.options.sourceSpatialReference,t.spatialReference);if(!c(e))for(const i of t.features)e(i.geometry)}createSpatialReference(){return{}}addField(t,e){t.fields.push(e);const i=t.fields.map((t=>t.name));this.AttributesConstructor=function(){for(const t of i)this[t]=null}}addFeature(t,e){t.features.push(e)}prepareFeatures(t){switch(this.transform=t.transform,this.options.applyTransform&&t.transform&&(this.applyTransform=this.deriveApplyTransform(t)),this.vertexDimension=2,t.hasZ&&this.vertexDimension++,t.hasM&&this.vertexDimension++,t.geometryType){case"esriGeometryPoint":this.addCoordinate=(t,e,i)=>this.addCoordinatePoint(t,e,i),this.createGeometry=t=>this.createPointGeometry(t);break;case"esriGeometryPolygon":this.addCoordinate=(t,e,i)=>this.addCoordinatePolygon(t,e,i),this.createGeometry=t=>this.createPolygonGeometry(t);break;case"esriGeometryPolyline":this.addCoordinate=(t,e,i)=>this.addCoordinatePolyline(t,e,i),this.createGeometry=t=>this.createPolylineGeometry(t);break;case"esriGeometryMultipoint":this.addCoordinate=(t,e,i)=>this.addCoordinateMultipoint(t,e,i),this.createGeometry=t=>this.createMultipointGeometry(t)}}createFeature(){return this.lengths.length=0,this.currentLengthIndex=0,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0,this.coordinateBuffer=null,this.coordinateBufferPtr=0,{attributes:new this.AttributesConstructor}}allocateCoordinates(){}addLength(t,e,i){0===this.lengths.length&&(this.toAddInCurrentPath=e),this.lengths.push(e)}addQueryGeometry(t,e){const{queryGeometry:i,queryGeometryType:s}=e,n=AL(zL(i.clone(),i,!1,!1,this.transform),s,!1,!1);t.queryGeometryType=s,t.queryGeometry={...n}}createPointGeometry(t){const e={x:0,y:0,spatialReference:t.spatialReference};return t.hasZ&&(e.z=0),t.hasM&&(e.m=0),e}addCoordinatePoint(t,e,i){switch(e=this.applyTransform(this.transform,e,i,0),i){case 0:t.x=e;break;case 1:t.y=e;break;case 2:"z"in t?t.z=e:t.m=e;break;case 3:t.m=e}}transformPathLikeValue(t,e){let i=0;return e<=1&&(i=this.previousCoordinate[e],this.previousCoordinate[e]+=t),this.applyTransform(this.transform,t,e,i)}addCoordinatePolyline(t,e,i){this.dehydratedAddPointsCoordinate(t.paths,e,i)}addCoordinatePolygon(t,e,i){this.dehydratedAddPointsCoordinate(t.rings,e,i)}addCoordinateMultipoint(t,e,i){0===i&&t.points.push([]);const s=this.transformPathLikeValue(e,i);t.points[t.points.length-1].push(s)}createPolygonGeometry(t){return{rings:[[]],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}createPolylineGeometry(t){return{paths:[[]],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}createMultipointGeometry(t){return{points:[],spatialReference:t.spatialReference,hasZ:!!t.hasZ,hasM:!!t.hasM}}dehydratedAddPointsCoordinate(t,e,i){0===i&&0==this.toAddInCurrentPath--&&(t.push([]),this.toAddInCurrentPath=this.lengths[++this.currentLengthIndex]-1,this.previousCoordinate[0]=0,this.previousCoordinate[1]=0);const s=this.transformPathLikeValue(e,i),n=t[t.length-1];0===i&&(this.coordinateBufferPtr=0,this.coordinateBuffer=Array(this.vertexDimension),n.push(this.coordinateBuffer)),this.coordinateBuffer[this.coordinateBufferPtr++]=s}deriveApplyTransform(t){const{hasZ:e,hasM:i}=t;return e&&i?QL:e?JL:i?ZL:HL}}function XL(t,e){const i=t.toJSON();return i.objectIds&&(i.objectIds=i.objectIds.join(",")),i.orderByFields&&(i.orderByFields=i.orderByFields.join(",")),!i.outFields||null!=e&&e.returnCountOnly?delete i.outFields:i.outFields=-1!==i.outFields.indexOf("*")?"*":i.outFields.join(","),i.outSpatialReference&&(i.outSR=i.outSR.wkid||JSON.stringify(i.outSR.toJSON()),delete i.outSpatialReference),i.dynamicDataSource&&(i.layer=JSON.stringify({source:i.dynamicDataSource}),delete i.dynamicDataSource),i}async function tN(t,e,i={},s){const n=jE({...t.query,f:"json",...s,...XL(e,s)});return $n(t.path+"/queryRelatedRecords",{...i,query:{...i.query,...n}})}const eN="Layer does not support extent calculation.";function iN(t,e){var i,s;const n=t.geometry,r=t.toJSON(),o=r;if(u(n)&&(o.geometry=JSON.stringify(n),o.geometryType=iy(n),o.inSR=n.spatialReference.wkid||JSON.stringify(n.spatialReference)),null!=(i=r.topFilter)&&i.groupByFields&&(o.topFilter.groupByFields=r.topFilter.groupByFields.join(",")),null!=(s=r.topFilter)&&s.orderByFields&&(o.topFilter.orderByFields=r.topFilter.orderByFields.join(",")),r.topFilter&&(o.topFilter=JSON.stringify(o.topFilter)),r.objectIds&&(o.objectIds=r.objectIds.join(",")),r.orderByFields&&(o.orderByFields=r.orderByFields.join(",")),r.outFields&&!(null!=e&&e.returnCountOnly||null!=e&&e.returnExtentOnly||null!=e&&e.returnIdsOnly)?o.outFields=-1!==r.outFields.indexOf("*")?"*":r.outFields.join(","):delete o.outFields,r.outSR?o.outSR=r.outSR.wkid||JSON.stringify(r.outSR):n&&r.returnGeometry&&(o.outSR=o.inSR),r.returnGeometry&&delete r.returnGeometry,r.timeExtent){const t=r.timeExtent,{start:e,end:i}=t;null==e&&null==i||(o.time=e===i?e:`${null==e?"null":e},${null==i?"null":i}`),delete r.timeExtent}return o}function sN(t,e,i,s={},n={}){const r="string"==typeof t?Vs(t):t,o=e.geometry?[e.geometry]:[];return s.responseType="pbf"===i?"array-buffer":"json",$E(o,null,s).then((t=>{const o=t&&t[0];u(o)&&((e=e.clone()).geometry=o);const a=jE({...r.query,f:i,...n,...iN(e,n)});return $n(nn(r.path,"queryTopFeatures"),{...s,query:{...a,...s.query}})}))}var nN;let rN=nN=class extends Vd{constructor(t){super(t),this.groupByFields=void 0,this.topCount=void 0,this.orderByFields=void 0}clone(){return new nN({groupByFields:this.groupByFields,topCount:this.topCount,orderByFields:this.orderByFields})}};e([oe({type:[String],json:{write:!0}})],rN.prototype,"groupByFields",void 0),e([oe({type:Number,json:{write:!0}})],rN.prototype,"topCount",void 0),e([oe({type:[String],json:{write:!0}})],rN.prototype,"orderByFields",void 0),rN=nN=e([si("esri.rest.support.TopFilter")],rN);const oN=rN;var aN;const lN=new ri({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),uN=new ri({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let cN=aN=class extends Vd{constructor(t){super(t),this.cacheHint=void 0,this.distance=void 0,this.geometry=null,this.geometryPrecision=void 0,this.maxAllowableOffset=void 0,this.num=void 0,this.objectIds=null,this.orderByFields=null,this.outFields=null,this.outSpatialReference=null,this.resultType=null,this.returnGeometry=!1,this.returnM=void 0,this.returnZ=void 0,this.start=void 0,this.spatialRelationship="intersects",this.timeExtent=null,this.topFilter=void 0,this.units=null,this.where="1=1"}writeStart(t,e){e.resultOffset=this.start,e.resultRecordCount=this.num||10}clone(){return new aN(H({cacheHint:this.cacheHint,distance:this.distance,geometry:this.geometry,geometryPrecision:this.geometryPrecision,maxAllowableOffset:this.maxAllowableOffset,num:this.num,objectIds:this.objectIds,orderByFields:this.orderByFields,outFields:this.outFields,outSpatialReference:this.outSpatialReference,resultType:this.resultType,returnGeometry:this.returnGeometry,returnZ:this.returnZ,returnM:this.returnM,start:this.start,spatialRelationship:this.spatialRelationship,timeExtent:this.timeExtent,topFilter:this.topFilter,units:this.units,where:this.where}))}};e([oe({type:Boolean,json:{write:!0}})],cN.prototype,"cacheHint",void 0),e([oe({type:Number,json:{write:{overridePolicy:t=>({enabled:t>0})}}})],cN.prototype,"distance",void 0),e([oe({types:ry,json:{read:ey,write:!0}})],cN.prototype,"geometry",void 0),e([oe({type:Number,json:{write:!0}})],cN.prototype,"geometryPrecision",void 0),e([oe({type:Number,json:{write:!0}})],cN.prototype,"maxAllowableOffset",void 0),e([oe({type:Number,json:{read:{source:"resultRecordCount"}}})],cN.prototype,"num",void 0),e([oe({json:{write:!0}})],cN.prototype,"objectIds",void 0),e([oe({type:[String],json:{write:!0}})],cN.prototype,"orderByFields",void 0),e([oe({type:[String],json:{write:!0}})],cN.prototype,"outFields",void 0),e([oe({type:ap,json:{read:{source:"outSR"},write:{target:"outSR"}}})],cN.prototype,"outSpatialReference",void 0),e([oe({type:String,json:{write:!0}})],cN.prototype,"resultType",void 0),e([oe({json:{write:!0}})],cN.prototype,"returnGeometry",void 0),e([oe({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],cN.prototype,"returnM",void 0),e([oe({type:Boolean,json:{write:{overridePolicy:t=>({enabled:t})}}})],cN.prototype,"returnZ",void 0),e([oe({type:Number,json:{read:{source:"resultOffset"}}})],cN.prototype,"start",void 0),e([xd("start"),xd("num")],cN.prototype,"writeStart",null),e([oe({type:String,json:{read:{source:"spatialRel",reader:lN.read},write:{target:"spatialRel",writer:lN.write}}})],cN.prototype,"spatialRelationship",void 0),e([oe({type:uS,json:{write:!0}})],cN.prototype,"timeExtent",void 0),e([oe({type:oN,json:{write:!0}})],cN.prototype,"topFilter",void 0),e([oe({type:String,json:{read:uN.read,write:{writer:uN.write,overridePolicy(t){return{enabled:t&&this.distance>0}}}}})],cN.prototype,"units",void 0),e([oe({type:String,json:{write:!0}})],cN.prototype,"where",void 0),cN=aN=e([si("esri.rest.support.TopFeaturesQuery")],cN),cN.from=Tt(cN);const hN=cN;let dN=class extends IO{constructor(t){super(t),this.dynamicDataSource=null,this.fieldsIndex=null,this.format="json",this.gdbVersion=null,this.infoFor3D=null,this.sourceSpatialReference=null}execute(t,e){return this.executeJSON(t,e).then((i=>this.featureSetFromJSON(t,i,e)))}async executeJSON(t,e){var i;const s={...this.requestOptions,...e},n=this._normalizeQuery(t),r=null!=(null==(i=t.outStatistics)?void 0:i[0]),o=l("featurelayer-pbf-statistics"),a=!r||o;let u;if("pbf"===this.format&&a)try{u=await async function(t,e,i){const s=SO(t),n={...i},r=SE.from(e),o=!r.quantizationParameters,{data:a}=await OR(s,r,new YL({sourceSpatialReference:r.sourceSpatialReference,applyTransform:o}),n);return a}(this.url,n,s)}catch(t){if("query:parsing-pbf"!==t.name)throw t;this.format="json"}return"json"!==this.format&&a||(u=await UR(this.url,n,s)),this._normalizeFields(u.fields),u}async featureSetFromJSON(t,e,i){if(!(this._queryIs3DObjectFormat(t)&&u(this.infoFor3D)&&e.features&&e.features.length))return $R.fromJSON(e);const{meshFeatureSetFromJSON:s}=await es(import("./p-cd77d022.js").then((function(t){return t.a})),i);return s(t,this.infoFor3D,e)}executeForCount(t,e){const i={...this.requestOptions,...e},s=this._normalizeQuery(t);return LR(this.url,s,i)}executeForExtent(t,e){const i={...this.requestOptions,...e},s=this._normalizeQuery(t);return async function(t,e,i){return PR(SO(t),SE.from(e),{...i}).then((t=>({count:t.data.count,extent:of.fromJSON(t.data.extent)})))}(this.url,s,i)}executeForIds(t,e){const i={...this.requestOptions,...e},s=this._normalizeQuery(t);return NR(this.url,s,i)}executeRelationshipQuery(t,e){t=IE.from(t);const i={...this.requestOptions,...e};return(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),async function(t,e,i){return e=IE.from(e),async function(t,e,i){const s=await tN(t,e,i),n=s.data,r=n.geometryType,o=n.spatialReference,a={};for(const t of n.relatedRecordGroups){const e={fields:void 0,objectIdFieldName:void 0,geometryType:r,spatialReference:o,hasZ:!!n.hasZ,hasM:!!n.hasM,features:t.relatedRecords};if(null!=t.objectId)a[t.objectId]=e;else for(const i in t)t.hasOwnProperty(i)&&"relatedRecords"!==i&&(a[t[i]]=e)}return{...s,data:a}}(SO(t),e,i).then((t=>{const e=t.data,i={};return Object.keys(e).forEach((t=>i[t]=$R.fromJSON(e[t]))),i}))}(this.url,t,i)}executeRelationshipQueryForCount(t,e){t=IE.from(t);const i={...this.requestOptions,...e};return(this.gdbVersion||this.dynamicDataSource)&&((t=t.clone()).gdbVersion=t.gdbVersion||this.gdbVersion,t.dynamicDataSource=t.dynamicDataSource||this.dynamicDataSource),async function(t,e,i){return e=IE.from(e),async function(t,e,i){const s=await tN(t,e,i,{returnCountOnly:!0}),n=s.data,r={};for(const t of n.relatedRecordGroups)null!=t.objectId&&(r[t.objectId]=t.count);return{...s,data:r}}(SO(t),e,{...i}).then((t=>t.data))}(this.url,t,i)}executeAttachmentQuery(t,e){const i={...this.requestOptions,...e};return async function(t,e,i){const s=SO(t);return function(t,e,i){let s={query:jE({...t.query,f:"json",..._E(e)})};return i&&(s={...i,...s,query:{...i.query,...s.query}}),$n(t.path+"/queryAttachments",s)}(s,SC.from(e),{...i}).then((t=>TE(t.data.attachmentGroups,s.path)))}(this.url,t,i)}executeTopFeaturesQuery(t,e){const i={...this.requestOptions,...e};return async function(t,e,i,s){const n=SO(t),r={...s},{data:o}=await async function(t,e,i,s){const n=await sN(t,e,"json",s);return IR(e,i,n.data),n}(n,hN.from(e),i,r);return $R.fromJSON(o)}(this.parsedUrl,t,this.sourceSpatialReference,i)}executeForTopIds(t,e){const i={...this.requestOptions,...e};return async function(t,e,i){const s=SO(t);return(await async function(t,e,i){return u(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{objectIds:[]}}):sN(t,e,"json",i,{returnIdsOnly:!0})}(s,hN.from(e),{...i})).data.objectIds}(this.parsedUrl,t,i)}executeForTopExtents(t,e){const i={...this.requestOptions,...e};return async function(t,e,i){const s=SO(t),n=await async function(t,e,i){return u(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0,extent:null}}):sN(t,e,"json",i,{returnExtentOnly:!0,returnCountOnly:!0}).then((t=>{const e=t.data;if(e.hasOwnProperty("extent"))return t;if(e.features)throw Error(eN);if(e.hasOwnProperty("count"))throw Error(eN);return t}))}(s,hN.from(e),{...i});return{count:n.data.count,extent:of.fromJSON(n.data.extent)}}(this.parsedUrl,t,i)}executeForTopCount(t,e){const i={...this.requestOptions,...e};return async function(t,e,i){const s=SO(t);return(await function(t,e,i){return u(e.timeExtent)&&e.timeExtent.isEmpty?Promise.resolve({data:{count:0}}):sN(t,e,"json",i,{returnIdsOnly:!0,returnCountOnly:!0})}(s,hN.from(e),{...i})).data.count}(this.parsedUrl,t,i)}_normalizeQuery(t){let e=SE.from(t);if(e.sourceSpatialReference=e.sourceSpatialReference||this.sourceSpatialReference,(this.gdbVersion||this.dynamicDataSource)&&(e=e===t?e.clone():e,e.gdbVersion=t.gdbVersion||this.gdbVersion,e.dynamicDataSource=t.dynamicDataSource?uE.from(t.dynamicDataSource):this.dynamicDataSource),u(this.infoFor3D)&&this._queryIs3DObjectFormat(t)){e=e===t?e.clone():e,e.formatOf3DObjects=null;for(const t of this.infoFor3D.queryFormats){if("3D_glb"===t.id){e.formatOf3DObjects=t.id;break}"3D_gltf"!==t.id||e.formatOf3DObjects||(e.formatOf3DObjects=t.id)}if(!e.formatOf3DObjects)throw new Ve("query:unsupported-3d-query-formats","Could not find any supported 3D object query format. Only supported formats are 3D_glb and 3D_gltf");if(c(e.outFields)||!e.outFields.includes("*")){e=e===t?e.clone():e,c(e.outFields)&&(e.outFields=[]);const{originX:i,originY:s,originZ:n,translationX:r,translationY:o,translationZ:a,scaleX:l,scaleY:u,scaleZ:h,rotationX:d,rotationY:p,rotationZ:f,rotationDeg:y}=this.infoFor3D.transformFieldRoles;e.outFields.push(i,s,n,r,o,a,l,u,h,d,p,f,y)}}return e}_normalizeFields(t){if(u(this.fieldsIndex)&&u(t))for(const e of t){const t=this.fieldsIndex.get(e.name);t&&Object.assign(e,t.toJSON())}}_queryIs3DObjectFormat(t){return u(this.infoFor3D)&&t.returnGeometry&&"xyFootprint"!==t.multipatchOption&&!t.outStatistics}};e([oe({type:uE})],dN.prototype,"dynamicDataSource",void 0),e([oe()],dN.prototype,"fieldsIndex",void 0),e([oe()],dN.prototype,"format",void 0),e([oe()],dN.prototype,"gdbVersion",void 0),e([oe()],dN.prototype,"infoFor3D",void 0),e([oe()],dN.prototype,"sourceSpatialReference",void 0),dN=e([si("esri.tasks.QueryTask")],dN);const pN=dN,fN=ct.getLogger("esri.widgets.Feature.support.relatedFeatureUtils"),yN=new Map;function mN(t){if(!YC(t))return null;const[e,i]=t.split("/").slice(1);return{layerId:e,fieldName:i}}let gN=class extends jo{constructor(t){super(t),this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(t){this._setContentElementMedia(t)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(t){const{formattedMediaInfoCount:e}=this;this.activeMediaInfoIndex=(t+e)%e}_pageContentElementMedia(t){const{activeMediaInfoIndex:e}=this;this._setContentElementMedia(e+t)}_formatMediaInfos(){const{attributes:t,mediaInfos:e,formattedAttributes:i,expressionAttributes:s,fieldInfoMap:n,layer:r}=this;return null==e?void 0:e.map((e=>{if(!e)return null;if(e.title=GC({attributes:t,fieldInfoMap:n,globalAttributes:i,expressionAttributes:s,layer:r,text:e.title}),e.caption=GC({attributes:t,fieldInfoMap:n,globalAttributes:i,expressionAttributes:s,layer:r,text:e.caption}),e.altText=GC({attributes:t,fieldInfoMap:n,globalAttributes:i,expressionAttributes:s,layer:r,text:e.altText}),"image"===e.type){const{value:t}=e;return this._setImageValue({value:t,formattedAttributes:i,layer:r}),e.value.sourceURL?e:void 0}if("pie-chart"===e.type||"line-chart"===e.type||"column-chart"===e.type||"bar-chart"===e.type){const{value:s}=e;return this._setChartValue({value:s,chartType:e.type,attributes:t,formattedAttributes:i,layer:r}),e}return null})).filter(Boolean)}_setImageValue(t){const{fieldInfoMap:e}=this,{value:i,formattedAttributes:s,layer:n}=t,{linkURL:r,sourceURL:o}=i;if(o){const t=qC(o,n);i.sourceURL=UC({formattedAttributes:s,template:t,fieldInfoMap:e})}if(r){const t=qC(r,n);i.linkURL=UC({formattedAttributes:s,template:t,fieldInfoMap:e})}}_setChartValue(t){const{value:e,attributes:i,formattedAttributes:s,chartType:n,layer:r}=t,{popupTemplate:o,relatedInfos:a}=this,{fields:l,normalizeField:u}=e;if(e.fields=function(t,e){return t&&t.map((t=>VC(t,e)))}(l,r),u&&(e.normalizeField=VC(u,r)),!l.some((t=>!!(null!=s[t]||YC(t)&&a.size))))return;const c=null==o?void 0:o.fieldInfos;l.forEach((t=>{if(YC(t))return void(e.series=[...e.series,...this._getRelatedChartInfos({fieldInfos:c,fieldName:t,formattedAttributes:s,chartType:n,value:e})]);const r=this._getChartOption({value:e,attributes:i,chartType:n,formattedAttributes:s,fieldName:t,fieldInfos:c});e.series.push(r)}))}_getRelatedChartInfos(t){var e;const{fieldInfos:i,fieldName:s,formattedAttributes:n,chartType:r,value:o}=t,a=[],l=mN(s),{layerId:u,fieldName:c}=l,h=null==(e=this.relatedInfos)?void 0:e.get(""+u);if(!h)return a;const{relatedFeatures:d,relation:p}=h;if(!p||!d)return a;const{cardinality:f}=p;return d.forEach((t=>{const{attributes:e}=t;e&&Object.keys(e).forEach((t=>{t===c&&a.push(this._getChartOption({value:o,attributes:e,formattedAttributes:n,fieldName:s,chartType:r,relatedFieldName:t,fieldInfos:i}))}))})),"one-to-many"===f||"many-to-many"===f?a:[a[0]]}_getTooltip({label:t,value:e,chartType:i}){return"pie-chart"===i?t:`${t}: ${e}`}_getChartOption(t){var e;const{value:i,attributes:s,formattedAttributes:n,fieldName:r,relatedFieldName:o,fieldInfos:a,chartType:l}=t,{layer:u}=this,{normalizeField:c,tooltipField:h}=i,d=c?YC(c)?s[mN(c).fieldName]:s[c]:null,p=o&&void 0!==s[o]?s[o]:void 0!==s[r]?s[r]:n[r],f=void 0===p?null:p&&d?p/d:p,y=new Yk({value:f});if(YC(r)){const t=mN(r),e=mN(h),i=e?e.fieldName:null,n=WC(f,{fieldInfos:a,fieldName:o,layer:u,preventPlacesFormatting:!!d}),c=t?t.label||t.fieldName:o;return y.tooltip=this._getTooltip({label:i&&void 0!==s[i]?s[i]:c,value:n,chartType:l}),y}const m=HC(a,r),g=VC(r,u),v=h&&void 0!==n[h]?n[h]:DC(m||new qk({fieldName:g}),null==(e=this.popupTemplate)?void 0:e.expressionInfos);return y.tooltip=this._getTooltip({label:v,value:n[g],chartType:l}),y}};e([oe()],gN.prototype,"activeMediaInfoIndex",void 0),e([oe({readOnly:!0})],gN.prototype,"activeMediaInfo",null),e([oe()],gN.prototype,"attributes",void 0),e([oe()],gN.prototype,"description",void 0),e([oe()],gN.prototype,"fieldInfoMap",void 0),e([oe()],gN.prototype,"formattedAttributes",void 0),e([oe()],gN.prototype,"expressionAttributes",void 0),e([oe({readOnly:!0})],gN.prototype,"formattedMediaInfos",null),e([oe()],gN.prototype,"layer",void 0),e([oe({readOnly:!0})],gN.prototype,"formattedMediaInfoCount",null),e([oe()],gN.prototype,"mediaInfos",void 0),e([oe()],gN.prototype,"popupTemplate",void 0),e([oe()],gN.prototype,"relatedInfos",void 0),e([oe()],gN.prototype,"title",void 0),gN=e([si("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],gN);const vN=gN;var wN=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],bN=[{name:"default",colors:[].concat(wN.slice(30,39),wN.slice(28,30).reverse())},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];const MN=new Map([["ar",()=>import("./p-d24e109e.js").then((t=>t.a))],["bs-ba",()=>import("./p-165f141e.js").then((t=>t.b))],["ca-es",()=>import("./p-36445a12.js").then((t=>t.c))],["cs-cz",()=>import("./p-b138a877.js").then((t=>t.c))],["da-dk",()=>import("./p-28b53674.js").then((t=>t.d))],["de-de",()=>import("./p-295fbc0e.js").then((t=>t.d))],["de-ch",()=>import("./p-a872b03a.js").then((t=>t.d))],["el-gr",()=>import("./p-1ec951ac.js").then((t=>t.e))],["en-us",()=>import("./p-0f564f5d.js").then((t=>t.e))],["en-ca",()=>import("./p-1e21fbd5.js").then((t=>t.e))],["es-es",()=>import("./p-01fac15a.js").then((t=>t.e))],["et-ee",()=>import("./p-27e13221.js").then((t=>t.e))],["fi-fi",()=>import("./p-16a12fde.js").then((t=>t.f))],["fr-fr",()=>import("./p-f03e863b.js").then((t=>t.f))],["he-il",()=>import("./p-1ceae54f.js").then((t=>t.h))],["hr-hr",()=>import("./p-1fc325c7.js").then((t=>t.h))],["hu-hu",()=>import("./p-47772cf1.js").then((t=>t.h))],["id-id",()=>import("./p-c7fb14dd.js").then((t=>t.i))],["it-it",()=>import("./p-0019b2e1.js").then((t=>t.i))],["ja-jp",()=>import("./p-b44094da.js").then((t=>t.j))],["ko-kr",()=>import("./p-6cbe357e.js").then((t=>t.k))],["lt-lt",()=>import("./p-466f16d6.js").then((t=>t.l))],["lv-lv",()=>import("./p-411892f7.js").then((t=>t.l))],["nb-no",()=>import("./p-9531c1b9.js").then((t=>t.n))],["nl-nl",()=>import("./p-c58e407e.js").then((t=>t.n))],["pl-pl",()=>import("./p-5b2248a8.js").then((t=>t.p))],["pt-br",()=>import("./p-009f491a.js").then((t=>t.p))],["pt-pt",()=>import("./p-dcf3890e.js").then((t=>t.p))],["ro-ro",()=>import("./p-bcd2c290.js").then((t=>t.r))],["ru-ru",()=>import("./p-8943a0da.js").then((t=>t.r))],["sk-sk",()=>import("./p-e82931a9.js").then((t=>t.s))],["sl-sl",()=>import("./p-1c2ca123.js").then((t=>t.s))],["sr-rs",()=>import("./p-a9f696ad.js").then((t=>t.s))],["sv-se",()=>import("./p-4ca6902f.js").then((t=>t.s))],["th-th",()=>import("./p-2055e35f.js").then((t=>t.t))],["tr-tr",()=>import("./p-c0b0c346.js").then((t=>t.t))],["uk-ua",()=>import("./p-a7184375.js").then((t=>t.u))],["vi-vn",()=>import("./p-f06c242c.js").then((t=>t.v))],["zh-cn",()=>import("./p-3f123fdb.js").then((t=>t.z))],["zh-hk",()=>import("./p-5cd40670.js").then((t=>t.z))],["zh-tw",()=>import("./p-5cd40670.js").then((t=>t.z))]]);let SN,xN;const kN="esri-feature-media__icon";let IN=class extends Dc{constructor(t,e){super(t,e),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.attributes=null,this.activeMediaInfoIndex=null,this.description=null,this.fieldInfoMap=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null,this.viewModel=new vN,this.messages=null}initialize(){this._featureElementInfo=new pP,this.own(Xo(this,["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],(()=>this._setupMediaRefreshTimer())),Xo(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo())))}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy()}render(){var t;return Bc("div",{bind:this,class:"esri-feature-media",onkeyup:this._handleMediaKeyup},null==(t=this._featureElementInfo)?void 0:t.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:t}=this.viewModel;return t?Bc("div",{key:"media-element-container",class:"esri-feature-media__container"},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(t){const{_refreshIntervalInfo:e}=this,{activeMediaInfoIndex:i,formattedMediaInfoCount:s}=this.viewModel,{value:n,refreshInterval:r,altText:o,title:a,type:l}=t,{sourceURL:u,linkURL:c}=n,h=LC(c)?"_blank":"_self",d="_blank"===h?"noreferrer":"",p=r?e:null,f=Bc("img",{alt:o||a,key:`media-${l}-${i}-${s}-${p?p.timestamp:0}`,src:p?p.sourceURL:u});return(c?Bc("a",{title:a,href:c,rel:d,target:h},f):null)||f}renderChartMediaInfo(t){const{activeMediaInfoIndex:e,formattedMediaInfoCount:i}=this.viewModel;return Bc("div",{key:`media-${t.type}-${e}-${i}`,bind:this,class:"esri-feature-media__chart",afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:t}=this.viewModel;return t?"image"===t.type?this.renderImageMediaInfo(t):-1!==t.type.indexOf("chart")?this.renderChartMediaInfo(t):null:null}renderMediaInfo(){const{activeMediaInfo:t}=this.viewModel;if(!t)return null;const e=t.title?Bc("div",{key:"media-title",class:"esri-feature-media__item-title",innerHTML:t.title}):null,i=t.caption?Bc("div",{key:"media-caption",class:"esri-feature-media__item-caption",innerHTML:t.caption}):null;return Bc("div",{key:"media-container",class:"esri-feature-media__item-container"},Bc("div",{key:"media-item-container",class:"esri-feature-media__item"},this.renderMediaInfoType()),e,i)}renderMediaPageButton(t){if(this.viewModel.formattedMediaInfoCount<2)return null;const e="previous"===t,i=e?this.messages.previous:this.messages.next,s=this.classes("esri-feature-media__button",e?"esri-feature-media__previous":"esri-feature-media__next"),n=e?this.classes(kN,"esri-feature-media__previous-icon","esri-icon-left-triangle-arrow"):this.classes(kN,"esri-feature-media__next-icon","esri-icon-right-triangle-arrow"),r=e?this.classes(kN,"esri-feature-media__previous-icon--rtl","esri-icon-right-triangle-arrow"):this.classes(kN,"esri-feature-media__next-icon--rtl","esri-icon-left-triangle-arrow");return Bc("button",{type:"button",key:e?"media-previous":"media-next",title:i,"aria-label":i,tabIndex:0,class:s,bind:this,onclick:e?this._previous:this._next},Bc("span",{"aria-hidden":"true",class:n}),Bc("span",{"aria-hidden":"true",class:r}))}_setupFeatureElementInfo(){const{description:t,title:e}=this;this._featureElementInfo.set({description:t,title:e})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}async _getChartDependencies(t){const e=await async function(t=pi()){if(t=function(t){return t?MN.has(t.toLowerCase())?t.toLowerCase():function(t){const e=t.split("-")[0].toLowerCase();let i=null;for(const t of MN.keys())if(t.startsWith(e)){i=t;break}return i}(t)||"en-us":"en-us"}(t),SN&&t===xN)return SN;SN=import("./p-8574655c.js").then((t=>t.i)),xN=t;try{const[e,i]=await Promise.all([SN,MN.get(xN)()]);xN===t&&(e.am4core.options.defaultLocale=i.default),e.am4core.options.suppressWarnings=!0,e.am4core.options.autoDispose=!0}catch{return SN=null,xN=null,null}return SN}(),{activeMediaInfo:i}=this.viewModel;this._renderChart({chartDiv:t,mediaInfo:i,chartsModule:e})}_handleMediaKeyup(t){const e=qi(t);"ArrowLeft"===e&&(t.stopPropagation(),this.viewModel.previous()),"ArrowRight"===e&&(t.stopPropagation(),this.viewModel.next())}_renderChart(t){const{chartsModule:e,chartDiv:i,mediaInfo:s}=t,{value:n,type:r}=s,{am4core:o}=e,a=function(t,e="default"){const i=bN.find((t=>t.name===e));return i?i.colors.map((e=>t.color(e))):null}(o);$l()&&o.useTheme(e.am4themes_dark),o.useTheme(e.am4themes_animated),o.useTheme((function(t){t instanceof o.ColorSet&&a&&(t.list=a)}));const l="pie-chart"===r?this._createPieChart(t):this._createXYChart(t);i.setAttribute("aria-label",s.altText||s.title),l.data=n.series.map((t=>({tooltip:t.tooltip,value:t.value}))).filter((t=>"pie-chart"!==r||t.value>0))}_customizeChartTooltip(t,e){t.label.wrap=!0,t.label.maxWidth=200,t.autoTextColor=!1,t.getFillFromObject=!1,t.label.fill=e.color("#ffffff"),t.background.fill=e.color({r:0,g:0,b:0,a:.7})}_createPieChart(t){const{chartDiv:e,chartsModule:i}=t,{am4core:s,am4charts:n}=i,r=s.create(e,n.PieChart);r.rtl=Al(this.container);const o=r.series.push(new n.PieSeries);return o.labels.template.disabled=!0,o.ticks.template.disabled=!0,o.dataFields.value="value",o.dataFields.category="tooltip",this._customizeChartTooltip(o.tooltip,s),r}_getMinSeriesValue(t){let e=0;return t.forEach((t=>e=Math.min(t.value,e))),e}_createColumnChart(t,e){const{chartsModule:i,mediaInfo:s}=e,{value:n}=s,{am4core:r,am4charts:o}=i,a=t.xAxes.push(new o.CategoryAxis);a.dataFields.category="tooltip",a.renderer.labels.template.disabled=!0,this._customizeChartTooltip(a.tooltip,r),a.tooltip.events.on("sizechanged",(()=>{a.tooltip.dy=-a.tooltip.contentHeight}));const l=t.yAxes.push(new o.ValueAxis),u=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(l.tooltip,r),u.wrap=!0;const c=t.series.push(new o.ColumnSeries);c.dataFields.valueY="value",c.dataFields.categoryX="tooltip",t.cursor=new o.XYCursor,n.series.length>15&&(t.scrollbarX=new r.Scrollbar)}_createBarChart(t,e){const{chartsModule:i,mediaInfo:s}=e,{value:n}=s,{am4core:r,am4charts:o}=i,a=t.yAxes.push(new o.CategoryAxis);a.dataFields.category="tooltip",a.renderer.inversed=!0,a.renderer.labels.template.disabled=!0,this._customizeChartTooltip(a.tooltip,r),a.tooltip.events.on("sizechanged",(()=>{a.tooltip.dx=a.tooltip.contentWidth}));const l=t.xAxes.push(new o.ValueAxis),u=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(l.tooltip,r),u.wrap=!0;const c=t.series.push(new o.ColumnSeries);c.dataFields.valueX="value",c.dataFields.categoryY="tooltip",t.cursor=new o.XYCursor,n.series.length>15&&(t.scrollbarY=new r.Scrollbar)}_createLineChart(t,e){const{chartsModule:i,mediaInfo:s}=e,{value:n}=s,{am4core:r,am4charts:o}=i,a=t.xAxes.push(new o.CategoryAxis);a.dataFields.category="tooltip",a.renderer.labels.template.disabled=!0,this._customizeChartTooltip(a.tooltip,r),a.tooltip.events.on("sizechanged",(()=>{a.tooltip.dy=-a.tooltip.contentHeight}));const l=t.yAxes.push(new o.ValueAxis),u=l.renderer.labels.template;l.renderer.minLabelPosition=.05,l.renderer.maxLabelPosition=.95,l.min=this._getMinSeriesValue(n.series),this._customizeChartTooltip(l.tooltip,r),u.wrap=!0;const c=t.series.push(new o.LineSeries);c.dataFields.categoryX="tooltip",c.dataFields.valueY="value",t.cursor=new o.XYCursor,n.series.length>15&&(t.scrollbarX=new r.Scrollbar)}_createXYChart(t){const{chartDiv:e,chartsModule:i,mediaInfo:s}=t,{type:n}=s,{am4core:r,am4charts:o}=i,a=r.create(e,o.XYChart);return a.rtl=Al(this.container),"column-chart"===n&&this._createColumnChart(a,t),"bar-chart"===n&&this._createBarChart(a,t),"line-chart"===n&&this._createLineChart(a,t),a}_clearMediaRefreshTimer(){const{_refreshTimer:t}=this;t&&(clearTimeout(t),this._refreshTimer=null)}_updateMediaInfoTimestamp(t){const e=Date.now();this._refreshIntervalInfo={timestamp:e,sourceURL:this._getImageSource(t,e)},this.scheduleRender()}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:t}=this.viewModel;t&&"image"===t.type&&t.refreshInterval&&this._setRefreshTimeout(t)}_setRefreshTimeout(t){const{refreshInterval:e,value:i}=t;if(!e)return;const s=6e4*e;this._updateMediaInfoTimestamp(i.sourceURL);const n=setInterval((()=>{this._updateMediaInfoTimestamp(i.sourceURL)}),s);this._refreshTimer=n}_getImageSource(t,e){const i=-1!==t.indexOf("?")?"&":"?",[s,n=""]=t.split("#");return`${s}${i}timestamp=${e}${n?"#":""}${n}`}};e([ue("viewModel.attributes")],IN.prototype,"attributes",void 0),e([ue("viewModel.activeMediaInfoIndex")],IN.prototype,"activeMediaInfoIndex",void 0),e([ue("viewModel.description")],IN.prototype,"description",void 0),e([ue("viewModel.fieldInfoMap")],IN.prototype,"fieldInfoMap",void 0),e([ue("viewModel.layer")],IN.prototype,"layer",void 0),e([ue("viewModel.mediaInfos")],IN.prototype,"mediaInfos",void 0),e([ue("viewModel.popupTemplate")],IN.prototype,"popupTemplate",void 0),e([ue("viewModel.relatedInfos")],IN.prototype,"relatedInfos",void 0),e([ue("viewModel.title")],IN.prototype,"title",void 0),e([oe({type:vN})],IN.prototype,"viewModel",void 0),e([oe(),zc("esri/widgets/Feature/t9n/Feature")],IN.prototype,"messages",void 0),IN=e([si("esri.widgets.Feature.FeatureMedia")],IN);const jN=IN;var _N;let TN=_N=class extends Vd{constructor(t){super(t),this.expression=null,this.name=null,this.returnType="boolean",this.title=null}clone(){return new _N({name:this.name,title:this.title,expression:this.expression,returnType:this.returnType})}};e([oe({type:String,json:{write:!0}})],TN.prototype,"expression",void 0),e([oe({type:String,json:{write:!0}})],TN.prototype,"name",void 0),e([oe({type:["boolean"],json:{write:!0}})],TN.prototype,"returnType",void 0),e([oe({type:String,json:{write:!0}})],TN.prototype,"title",void 0),TN=_N=e([si("esri.form.ExpressionInfo")],TN);const ON=TN;let AN=class extends Vd{constructor(t){super(t),this.description=null,this.label=null,this.type=null,this.visibilityExpression=null}};e([oe({type:String,json:{write:!0}})],AN.prototype,"description",void 0),e([oe({type:String,json:{write:!0}})],AN.prototype,"label",void 0),e([oe()],AN.prototype,"type",void 0),e([oe({type:String,json:{write:!0}})],AN.prototype,"visibilityExpression",void 0),AN=e([si("esri.form.elements.Element")],AN);const FN=AN;var CN;let PN=CN=class extends Vd{constructor(t){super(t),this.type=null}clone(){return new CN({type:this.type})}};e([oe({type:["attachment","audio","document","image","signature","video"],json:{write:!0}})],PN.prototype,"type",void 0),PN=CN=e([si("esri.form.elements.inputs.AttachmentInput")],PN);const EN=PN;var RN;let LN=RN=class extends FN{constructor(t){super(t),this.attachmentKeyword=null,this.editable=!0,this.input=null,this.type="attachment"}clone(){return new RN({attachmentKeyword:this.attachmentKeyword,description:this.description,editable:this.editable,input:this.input,label:this.label,visibilityExpression:this.visibilityExpression})}};e([oe({type:String,json:{write:!0}})],LN.prototype,"attachmentKeyword",void 0),e([oe({type:Boolean,json:{write:!0}})],LN.prototype,"editable",void 0),e([oe({type:EN,json:{read:{source:"inputType"},write:{target:"inputType"}}})],LN.prototype,"input",void 0),e([oe({type:["attachment"],json:{read:!1,write:!0}})],LN.prototype,"type",void 0),LN=RN=e([si("esri.form.elements.AttachmentElement")],LN);const NN=LN;let DN=class extends Vd{constructor(t){super(t),this.type=null}};e([oe()],DN.prototype,"type",void 0),DN=e([si("esri.form.elements.inputs.Input")],DN);const VN=DN;let $N=class extends VN{constructor(t){super(t),this.maxLength=null,this.minLength=0}};e([oe({type:Number,json:{write:!0}})],$N.prototype,"maxLength",void 0),e([oe({type:Number,json:{write:!0}})],$N.prototype,"minLength",void 0),$N=e([si("esri.form.elements.inputs.TextInput")],$N);const zN=$N;var GN;let UN=GN=class extends zN{constructor(t){super(t),this.type="barcode-scanner"}clone(){return new GN({maxLength:this.maxLength,minLength:this.minLength})}};e([oe({type:["barcode-scanner"],json:{read:!1,write:!0}})],UN.prototype,"type",void 0),UN=GN=e([si("esri.form.elements.inputs.BarcodeScannerInput")],UN);const qN=UN;var BN;let WN=BN=class extends VN{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!1,this.type="combo-box"}clone(){return new BN({showNoValueOption:this.showNoValueOption,noValueOptionLabel:this.noValueOptionLabel})}};e([oe({type:String,json:{write:!0}})],WN.prototype,"noValueOptionLabel",void 0),e([oe({type:Boolean,json:{write:!0}})],WN.prototype,"showNoValueOption",void 0),e([oe({type:["combo-box"],json:{read:!1,write:!0}})],WN.prototype,"type",void 0),WN=BN=e([si("esri.form.elements.inputs.ComboBoxInput")],WN);const HN=WN;var JN;function ZN(t){return null!=t?new Date(t):null}function QN(t){return t?t.getTime():null}let KN=JN=class extends VN{constructor(t){super(t),this.includeTime=!1,this.max=null,this.min=null,this.type="datetime-picker"}readMax(t,e){return ZN(e.max)}writeMax(t,e){e.max=QN(t)}readMin(t,e){return ZN(e.min)}writeMin(t,e){e.min=QN(t)}clone(){return new JN({includeTime:this.includeTime,max:this.max,min:this.min,type:this.type})}};e([oe({type:Boolean,json:{write:!0}})],KN.prototype,"includeTime",void 0),e([oe({type:Date,json:{type:Number,write:!0}})],KN.prototype,"max",void 0),e([Sd("max")],KN.prototype,"readMax",null),e([xd("max")],KN.prototype,"writeMax",null),e([oe({type:Date,json:{type:Number,write:!0}})],KN.prototype,"min",void 0),e([Sd("min")],KN.prototype,"readMin",null),e([xd("min")],KN.prototype,"writeMin",null),e([oe({type:["datetime-picker"],json:{read:!1,write:!0}})],KN.prototype,"type",void 0),KN=JN=e([si("esri.form.elements.inputs.DateTimePickerInput")],KN);const YN=KN;var XN;let tD=XN=class extends VN{constructor(t){super(t),this.noValueOptionLabel=null,this.showNoValueOption=!1,this.type="radio-buttons"}clone(){return new XN({noValueOptionLabel:this.noValueOptionLabel,showNoValueOption:this.showNoValueOption})}};e([oe({type:String,json:{write:!0}})],tD.prototype,"noValueOptionLabel",void 0),e([oe({type:Boolean,json:{write:!0}})],tD.prototype,"showNoValueOption",void 0),e([oe({type:["radio-buttons"],json:{read:!1,write:!0}})],tD.prototype,"type",void 0),tD=XN=e([si("esri.form.elements.inputs.RadioButtonsInput")],tD);const eD=tD;var iD;let sD=iD=class extends VN{constructor(t){super(t),this.offValue=null,this.onValue=null,this.type="switch"}clone(){return new iD({offValue:this.offValue,onValue:this.onValue})}};e([oe({type:[String,Number],json:{write:!0}})],sD.prototype,"offValue",void 0),e([oe({type:[String,Number],json:{write:!0}})],sD.prototype,"onValue",void 0),e([oe({type:["switch"],json:{read:!1,write:!0}})],sD.prototype,"type",void 0),sD=iD=e([si("esri.form.elements.inputs.SwitchInput")],sD);const nD=sD;var rD;let oD=rD=class extends zN{constructor(t){super(t),this.type="text-area"}clone(){return new rD({maxLength:this.maxLength,minLength:this.minLength})}};e([oe({type:["text-area"],json:{read:!1,write:!0}})],oD.prototype,"type",void 0),oD=rD=e([si("esri.form.elements.inputs.TextAreaInput")],oD);const aD=oD;var lD;let uD=lD=class extends zN{constructor(t){super(t),this.type="text-box"}clone(){return new lD({maxLength:this.maxLength,minLength:this.minLength})}};e([oe({type:["text-box"],json:{read:!1,write:!0}})],uD.prototype,"type",void 0),uD=lD=e([si("esri.form.elements.inputs.TextBoxInput")],uD);const cD={base:VN,key:"type",typeMap:{"barcode-scanner":qN,"combo-box":HN,"datetime-picker":YN,"radio-buttons":eD,switch:nD,"text-area":aD,"text-box":uD}};var hD;let dD=hD=class extends FN{constructor(t){super(t),this.domain=null,this.editable=!0,this.fieldName=null,this.hint=null,this.input=null,this.requiredExpression=null,this.type="field"}clone(){return new hD({description:this.description,domain:this.domain,editable:this.editable,fieldName:this.fieldName,hint:this.hint,input:this.input,label:this.label,requiredExpression:this.requiredExpression,visibilityExpression:this.visibilityExpression})}};e([oe({types:$P,json:{read:{reader:zP},write:!0}})],dD.prototype,"domain",void 0),e([oe({type:Boolean,json:{write:!0}})],dD.prototype,"editable",void 0),e([oe({type:String,json:{write:!0}})],dD.prototype,"fieldName",void 0),e([oe({type:String,json:{write:!0}})],dD.prototype,"hint",void 0),e([oe({types:cD,json:{read:{source:"inputType"},write:{target:"inputType"}}})],dD.prototype,"input",void 0),e([oe({type:String,json:{write:!0}})],dD.prototype,"requiredExpression",void 0),e([oe({type:String,json:{read:!1,write:!0}})],dD.prototype,"type",void 0),dD=hD=e([si("esri.form.elements.FieldElement")],dD);const pD=dD;var fD;let yD=fD=class extends FN{constructor(t){super(t),this.displayCount=null,this.displayType="list",this.editable=!0,this.orderByFields=null,this.relationshipId=null,this.type="relationship"}clone(){return new fD({description:this.description,displayCount:this.displayCount,displayType:this.displayType,editable:this.editable,label:this.label,orderByFields:H(this.orderByFields),relationshipId:this.relationshipId,visibilityExpression:this.visibilityExpression})}};e([oe({type:Number,json:{write:!0}})],yD.prototype,"displayCount",void 0),e([oe({type:["list"],json:{write:!0}})],yD.prototype,"displayType",void 0),e([oe({type:Boolean,json:{write:!0}})],yD.prototype,"editable",void 0),e([oe({type:[VI],json:{write:!0}})],yD.prototype,"orderByFields",void 0),e([oe({type:Number,json:{write:!0}})],yD.prototype,"relationshipId",void 0),e([oe({type:["relationship"],json:{read:!1,write:!0}})],yD.prototype,"type",void 0),yD=fD=e([si("esri.form.elements.RelationshipElement")],yD);const mD=yD;function gD(t){return{typesWithGroup:{base:FN,key:"type",typeMap:{attachment:NN,field:pD,group:t,relationship:mD}},typesWithoutGroup:{base:FN,key:"type",typeMap:{attachment:NN,field:pD,relationship:mD}}}}function vD(t,e,i=!0){if(!t)return null;const s=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter((t=>s[t.type])).map((t=>s[t.type].fromJSON(t)))}function wD(t,e,i=!0){if(!t)return null;const s=i?e.typesWithGroup.typeMap:e.typesWithoutGroup.typeMap;return t.filter((t=>s[t.type])).map((t=>t.toJSON()))}function bD(t,e,i=!0){return t?t.map((t=>Et(i?e.typesWithGroup:e.typesWithoutGroup,t))):null}var MD;let SD=MD=class extends FN{constructor(t){super(t),this.elements=null,this.initialState="expanded",this.type="group"}castElements(t){return bD(t,xD,!1)}readElements(t,e){return vD(e.formElements,xD,!1)}writeElements(t,e){e.formElements=wD(t,xD,!1)}clone(){return new MD({description:this.description,elements:H(this.elements),initialState:this.initialState,label:this.label,visibilityExpression:this.visibilityExpression})}};e([oe({json:{write:!0}})],SD.prototype,"elements",void 0),e([ba("elements")],SD.prototype,"castElements",null),e([Sd("elements",["formElements"])],SD.prototype,"readElements",null),e([xd("elements")],SD.prototype,"writeElements",null),e([oe({type:["collapsed","expanded"],json:{write:!0}})],SD.prototype,"initialState",void 0),e([oe({type:String,json:{read:!1,write:!0}})],SD.prototype,"type",void 0),SD=MD=e([si("esri.form.elements.GroupElement")],SD);const xD=gD(SD);var kD;const ID=gD(SD);let jD=kD=class extends Vd{constructor(t){super(t),this.description=null,this.elements=null,this.expressionInfos=null,this.title=null}castElements(t){return bD(t,ID)}readElements(t,e){return vD(e.formElements,ID)}writeElements(t,e){e.formElements=wD(t,ID)}clone(){return new kD({description:this.description,expressionInfos:H(this.expressionInfos),elements:H(this.elements),title:this.title})}};e([oe({type:String,json:{write:!0}})],jD.prototype,"description",void 0),e([oe({json:{write:!0}})],jD.prototype,"elements",void 0),e([ba("elements")],jD.prototype,"castElements",null),e([Sd("elements",["formElements"])],jD.prototype,"readElements",null),e([xd("elements")],jD.prototype,"writeElements",null),e([oe({type:[ON],json:{write:!0}})],jD.prototype,"expressionInfos",void 0),e([oe({type:String,json:{write:!0}})],jD.prototype,"title",void 0),jD=kD=e([si("esri.form.FormTemplate")],jD);const _D=jD;var TD;const OD=oi()({orthometric:"gravity-related-height",gravity_related_height:"gravity-related-height",ellipsoidal:"ellipsoidal"}),AD=OD.jsonValues.slice();N(AD,"orthometric");const FD=oi()({meter:"meters",foot:"feet","us-foot":"us-feet","clarke-foot":"clarke-feet","clarke-yard":"clarke-yards","clarke-link":"clarke-links","sears-yard":"sears-yards","sears-foot":"sears-feet","sears-chain":"sears-chains","benoit-1895-b-chain":"benoit-1895-b-chains","indian-yard":"indian-yards","indian-1937-yard":"indian-1937-yards","gold-coast-foot":"gold-coast-feet","sears-1922-truncated-chain":"sears-1922-truncated-chains","50-kilometers":"50-kilometers","150-kilometers":"150-kilometers"});let CD=TD=class extends Vd{constructor(t){super(t),this.heightModel="gravity-related-height",this.heightUnit="meters",this.vertCRS=null}writeHeightModel(t,e,i){return OD.write(t,e,i)}readHeightModel(t,e,i){return OD.read(t)||(i&&i.messages&&i.messages.push(function(t,e){return new Ie("height-model:unsupported",`Height model of value '${t}' is not supported`,e)}(t,{context:i})),null)}readHeightUnit(t,e,i){return FD.read(t)||(i&&i.messages&&i.messages.push(PD(t,{context:i})),null)}readHeightUnitService(t,e,i){return LS(t)||FD.read(t)||(i&&i.messages&&i.messages.push(PD(t,{context:i})),null)}readVertCRS(t,e){return e.vertCRS||e.ellipsoid||e.geoid}clone(){return new TD({heightModel:this.heightModel,heightUnit:this.heightUnit,vertCRS:this.vertCRS})}equals(t){return!!t&&(this===t||this.heightModel===t.heightModel&&this.heightUnit===t.heightUnit&&this.vertCRS===t.vertCRS)}static deriveUnitFromSR(t,e){const i=function(t){return DS(t)>=(t instanceof ap?bS(t).metersPerDegree:1e5)?"meters":GS(t)}(e);return new TD({heightModel:t.heightModel,heightUnit:i,vertCRS:t.vertCRS})}write(t,e){return e={origin:"web-scene",...e},super.write(t,e)}static fromJSON(t){if(!t)return null;const e=new TD;return e.read(t,{origin:"web-scene"}),e}};function PD(t,e){return new Ie("height-unit:unsupported",`Height unit of value '${t}' is not supported`,e)}e([oe({type:OD.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:AD,default:"ellipsoidal"}}}})],CD.prototype,"heightModel",void 0),e([xd("web-scene","heightModel")],CD.prototype,"writeHeightModel",null),e([Sd(["web-scene","service"],"heightModel")],CD.prototype,"readHeightModel",null),e([oe({type:FD.apiValues,constructOnly:!0,json:{origins:{"web-scene":{type:FD.jsonValues,write:FD.write}}}})],CD.prototype,"heightUnit",void 0),e([Sd("web-scene","heightUnit")],CD.prototype,"readHeightUnit",null),e([Sd("service","heightUnit")],CD.prototype,"readHeightUnitService",null),e([oe({type:String,constructOnly:!0,json:{origins:{"web-scene":{write:!0}}}})],CD.prototype,"vertCRS",void 0),e([Sd("service","vertCRS",["vertCRS","ellipsoid","geoid"])],CD.prototype,"readVertCRS",null),CD=TD=e([si("esri.geometry.HeightModelInfo")],CD);const ED=CD;let RD=0;const LD=ct.getLogger("esri.layers.graphics.sources.MemorySource");let ND=class extends(Av.LoadableMixin(Jo(XM(qo)))){constructor(t){super(t),this._idToClientGraphic=null,this.type="memory"}load(t){const e=u(t)?t.signal:null;return this.addResolvingPromise(this._startWorker(e)),Promise.resolve(this)}destroy(){var t;null==(t=this._connection)||t.close(),this._connection=null}get workerGeometryType(){var t;const e=null==(t=this.layer)?void 0:t.geometryType;return e?this._geometryTypeRequiresClientGraphicMapping(e)?"polygon":e:null}applyEdits(t){return this.load().then((()=>this._applyEdits(t)))}openPorts(){return this.load().then((()=>this._connection.openPorts()))}async queryFeatures(t,e={}){await this.load(e);const i=await this._connection.invoke("queryFeatures",t?t.toJSON():null,e);IR(t,this.layer.spatialReference,i);const s=$R.fromJSON(i);if(!this._requiresClientGraphicMapping())return s;const n=this.layer.objectIdField;for(const t of s.features){const e=this._idToClientGraphic.get(t.attributes[n]);e&&(t.geometry=e.geometry)}return s.geometryType=this.layer.geometryType,s}async queryFeaturesJSON(t,e={}){if(this._requiresClientGraphicMapping())throw new Ve("query-features-json:unsupported","Cannot query in JSON format for client only geometry types (mesh and extent)");await this.load(e);const i=await this._connection.invoke("queryFeatures",t?t.toJSON():null,e);return IR(t,this.layer.spatialReference,i),i}queryFeatureCount(t,e={}){return this.load(e).then((()=>this._connection.invoke("queryFeatureCount",t?t.toJSON():null,e)))}queryObjectIds(t,e={}){return this.load(e).then((()=>this._connection.invoke("queryObjectIds",t?t.toJSON():null,e)))}queryExtent(t,e={}){return this.load(e).then((()=>this._connection.invoke("queryExtent",t?t.toJSON():null,e))).then((t=>({count:t.count,extent:of.fromJSON(t.extent)})))}querySnapping(t,e={}){return this.load(e).then((()=>this._connection.invoke("querySnapping",t,e)))}async _applyEdits(t){if(!this._connection)throw new Ve("feature-layer-source:edit-failure","Memory source not loaded");const e=this.layer.objectIdField;let i=null;const s=[],n=[];await Promise.all([this._prepareClientMapping(t.addFeatures,null),this._prepareClientMapping(t.updateFeatures,null)]);const r=t=>"objectId"in t&&null!=t.objectId?t.objectId:"attributes"in t&&null!=t.attributes[e]?t.attributes[e]:null;if(t.addFeatures&&(i=this._prepareAddFeatures(t.addFeatures)),t.deleteFeatures)for(const e of t.deleteFeatures){const t=r(e);null!=t&&s.push(t)}const o=t.updateFeatures&&this._idToClientGraphic?new Map:null;if(t.updateFeatures)for(const e of t.updateFeatures)if(n.push(this._serializeFeature(e)),o){const t=r(e);null!=t&&o.set(t,e)}SR(i?i.features:null,n,this.layer.spatialReference);const{fullExtent:a,featureEditResults:l}=await this._connection.invoke("applyEdits",{adds:i?i.features:[],updates:n,deletes:s});return this.fullExtent=a,i&&i.finish(l.uidToObjectId),this._updateClientGraphicIds(o,l),this._createEditsResult(l)}async _prepareClientMapping(t,e){if("mesh"!==this.layerOrSourceGeometryType||c(t))return;const i=[];for(const{geometry:s}of t)!u(s)||"mesh"!==s.type||s.hasExtent||s.loaded||i.push(s.load({signal:e}));i.length&&await Promise.all(i)}_updateClientGraphicIds(t,e){if(this._idToClientGraphic){if(t)for(const i of e.updateResults){if(!i.success)continue;const e=t.get(i.objectId);null!=e&&this._addIdToClientGraphic(e)}for(const t of e.deleteResults)t.success&&this._idToClientGraphic.delete(t.objectId)}}_createEditsResult(t){return{addFeatureResults:t.addResults?t.addResults.map(this._createFeatureEditResult,this):[],updateFeatureResults:t.updateResults?t.updateResults.map(this._createFeatureEditResult,this):[],deleteFeatureResults:t.deleteResults?t.deleteResults.map(this._createFeatureEditResult,this):[],addAttachmentResults:[],updateAttachmentResults:[],deleteAttachmentResults:[]}}_createFeatureEditResult(t){const e=!0===t.success?null:t.error||{code:void 0,description:void 0};return{objectId:t.objectId,globalId:t.globalId,error:e?new Ve("feature-layer-source:edit-failure",e.description,{code:e.code}):null}}_prepareAddFeatures(t){const e=new Map,i=Array(t.length);let s=null;for(let n=0;n<t.length;n++){const r=t[n],o=this._serializeFeature(r);!s&&u(r.geometry)&&(s=r.geometry.type),i[n]=o,e.set(""+o.uid,r)}const n=this;return{features:i,inferredGeometryType:s,finish(t){const i=n.sourceJSON.objectIdField;for(const s in t){const r=t[s],o=e.get(s);o&&(o.attributes||(o.attributes={}),-1===r?delete o.attributes[i]:o.attributes[i]=r,n._addIdToClientGraphic(o))}}}}_addIdToClientGraphic(t){if(!this._idToClientGraphic)return;const e=t.attributes&&t.attributes[this.sourceJSON.objectIdField];null!=e&&this._idToClientGraphic.set(e,t)}get layerOrSourceGeometryType(){var t,e,i;return null!=(t=null==(e=this.layer)?void 0:e.geometryType)?t:null==(i=this.sourceJSON)?void 0:i.geometryType}_requiresClientGraphicMapping(){return this._geometryTypeRequiresClientGraphicMapping(this.layerOrSourceGeometryType)}_geometryRequiresClientGraphicMapping(t){return this._geometryTypeRequiresClientGraphicMapping(t.type)}_geometryTypeRequiresClientGraphicMapping(t){return"mesh"===t||"multipatch"===t||"extent"===t}_serializeFeature(t){const{attributes:e}=t,i=this._geometryForSerialization(t),s=""+RD++;return i?{uid:s,geometry:i.toJSON(),attributes:e}:{uid:s,attributes:e}}_geometryForSerialization(t){const{geometry:e}=t;return c(e)?null:this._geometryRequiresClientGraphicMapping(e)?e.extent?qf.fromExtent(e.extent):null:e}async _startWorker(t){this._connection=await rC("MemorySourceWorker",{strategy:l("feature-layers-workers")?"dedicated":"local",signal:t});const{fields:e,spatialReference:i,objectIdField:s,hasM:n,hasZ:r,timeInfo:o}=this.layer,a="defaults"===this.layer.originOf("spatialReference");await this._prepareClientMapping(this.items,t);const u=this._prepareAddFeatures(this.items);this.handles.add(this.on("before-changes",(t=>{LD.error("Source modifications will not propagate after layer has been loaded. Please use .applyEdits() instead"),t.preventDefault()})));const c={features:u.features,fields:e&&e.map((t=>t.toJSON())),geometryType:Zf.toJSON(this.workerGeometryType),hasM:"mesh"!==this.layerOrSourceGeometryType&&n,hasZ:"mesh"===this.layerOrSourceGeometryType||r,objectIdField:s,spatialReference:a?null:i&&i.toJSON(),timeInfo:o?o.toJSON():null},h=await this._connection.invoke("load",c,{signal:t});for(const t of h.warnings)LD.warn(t.message,{layer:this.layer,warning:t});h.featureErrors.length&&LD.warn(`Encountered ${h.featureErrors.length} validation errors while loading features`,h.featureErrors);const d=h.layerDefinition;this._geometryTypeRequiresClientGraphicMapping(u.inferredGeometryType)&&(d.geometryType=Zf.toJSON(u.inferredGeometryType)),this.sourceJSON=d,this._requiresClientGraphicMapping()&&(this._idToClientGraphic=new Map),u.finish(h.assignedObjectIds)}};e([Oo({Type:hj,ensureType:Tt(hj)})],ND.prototype,"itemType",void 0),e([oe()],ND.prototype,"type",void 0),e([oe({constructOnly:!0})],ND.prototype,"layer",void 0),e([oe({readOnly:!0})],ND.prototype,"workerGeometryType",null),e([oe()],ND.prototype,"sourceJSON",void 0),ND=e([si("esri.layers.graphics.sources.MemorySource")],ND);const DD=ND,VD=t=>{let i=class extends t{get apiKey(){var t;return this._isOverridden("apiKey")?this._get("apiKey"):function(t){return"portalItem"in t}(this)?null==(t=this.portalItem)?void 0:t.apiKey:null}set apiKey(t){null!=t?this._override("apiKey",t):(this._clearOverride("apiKey"),this.clear("apiKey","user"))}};return e([oe({type:String})],i.prototype,"apiKey",null),i=e([si("esri.layers.mixins.APIKeyMixin")],i),i},$D=t=>{let i=class extends t{get title(){if(this._get("title")&&"defaults"!==this.originOf("title"))return this._get("title");if(this.url){const t=XA(this.url);if(u(t)&&t.title)return t.title}return this._get("title")||""}set title(t){this._set("title",t)}set url(t){this._set("url",nF(t,ct.getLogger(this.declaredClass)))}};return e([oe()],i.prototype,"title",null),e([oe({type:String})],i.prototype,"url",null),i=e([si("esri.layers.mixins.ArcGISService")],i),i},zD=t=>{let i=class extends t{constructor(){super(...arguments),this.blendMode="normal",this.effect=null}};return e([oe({type:["average","color-burn","color-dodge","color","darken","destination-atop","destination-in","destination-out","destination-over","difference","exclusion","hard-light","hue","invert","lighten","lighter","luminosity","minus","multiply","normal","overlay","plus","reflect","saturation","screen","soft-light","source-atop","source-in","source-out","vivid-light","xor"],nonNullable:!0,json:{read:!1,write:!1,origins:{"web-map":{read:!0,write:!0}}}})],i.prototype,"blendMode",void 0),e([oe({json:{read:!1,write:!1,origins:{"web-map":{read:{reader:GM},write:{allowNull:!0,writer:UM}}}}})],i.prototype,"effect",void 0),i=e([si("esri.layers.mixins.BlendLayer")],i),i},GD=t=>{let i=class extends t{constructor(){super(...arguments),this.customParameters=null}};return e([oe({type:Object,json:{write:{overridePolicy:t=>({enabled:!!(t&&Object.keys(t).length>0)})}}})],i.prototype,"customParameters",void 0),i=e([si("esri.layers.mixins.CustomParametersMixin")],i),i};var UD;const qD=new ri({esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"envelope-intersects",esriSpatialRelIndexIntersects:"index-intersects",esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:"relation"}),BD=new ri({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"});let WD=UD=class extends Vd{constructor(t){super(t),this.where=null,this.geometry=null,this.spatialRelationship="intersects",this.distance=void 0,this.objectIds=null,this.units=null,this.timeExtent=null}createQuery(t={}){const{where:e,geometry:i,spatialRelationship:s,timeExtent:n,objectIds:r,units:o,distance:a}=this;return new SE({geometry:H(i),objectIds:H(r),spatialRelationship:s,timeExtent:H(n),where:e,units:o,distance:a,...t})}clone(){const{where:t,geometry:e,spatialRelationship:i,timeExtent:s,objectIds:n,units:r,distance:o}=this;return new UD({geometry:H(e),objectIds:H(n),spatialRelationship:i,timeExtent:H(s),where:t,units:r,distance:o})}};e([oe({type:String,json:{write:!0}})],WD.prototype,"where",void 0),e([oe({types:ry,json:{write:!0}})],WD.prototype,"geometry",void 0),e([oe({type:qD.apiValues,json:{name:"spatialRel",read:{reader:qD.read},write:{allowNull:!1,writer:qD.write,overridePolicy(){return{enabled:u(this.geometry)}}}}})],WD.prototype,"spatialRelationship",void 0),e([oe({type:Number,json:{write:{overridePolicy(t){return{enabled:null!=t&&null!=this.geometry}}}}})],WD.prototype,"distance",void 0),e([oe({type:[Number],json:{write:!0}})],WD.prototype,"objectIds",void 0),e([oe({type:BD.apiValues,json:{read:BD.read,write:{writer:BD.write,overridePolicy(t){return{enabled:null!=t&&null!=this.geometry}}}}})],WD.prototype,"units",void 0),e([oe({type:uS,json:{write:!0}})],WD.prototype,"timeExtent",void 0),WD=UD=e([si("esri.layers.support.FeatureFilter")],WD);const HD=WD;var JD;let ZD=JD=class extends Vd{constructor(t){super(t),this.filter=null,this.includedEffect=null,this.excludedEffect=null,this.excludedLabelsVisible=!1}clone(){return new JD({filter:u(this.filter)&&this.filter.clone(),includedEffect:this.includedEffect,excludedEffect:this.excludedEffect,excludedLabelsVisible:this.excludedLabelsVisible})}};e([oe({type:HD,json:{write:!0,origins:{"web-map":{write:{allowNull:!0,writer(t,e,i,s){if(!t)return void(e[i]=t);const n=t.write({},s),r=Object.keys(n);e[i]=1===r.length&&"where"===r[0]?n:null}}}}}})],ZD.prototype,"filter",void 0),e([oe({json:{write:!0,origins:{"web-map":{read:{reader:GM},write:{allowNull:!0,writer:UM}}}}})],ZD.prototype,"includedEffect",void 0),e([oe({json:{write:!0,origins:{"web-map":{read:{reader:GM},write:{allowNull:!0,writer:UM}}}}})],ZD.prototype,"excludedEffect",void 0),e([oe({type:Boolean,json:{write:!0,name:"showExcludedLabels",default:!1}})],ZD.prototype,"excludedLabelsVisible",void 0),ZD=JD=e([si("esri.layers.support.FeatureEffect")],ZD);const QD=ZD,KD=t=>{let i=class extends t{constructor(){super(...arguments),this.featureEffect=null}};return e([oe({type:QD,json:{origins:{"web-map":{write:{allowNull:!0}}}}})],i.prototype,"featureEffect",void 0),i=e([si("esri.layers.mixins.FeatureEffectLayer")],i),i},YD={"web-scene/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISMapServiceLayer:!0,ArcGISSceneServiceLayer:!0,ArcGISTiledElevationServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BuildingSceneLayer:!0,GroupLayer:!0,IntegratedMeshLayer:!0,OGCFeatureLayer:!0,PointCloudLayer:!0,WebTiledLayer:!0,CSV:!0,GeoJSON:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,KML:!0,RasterDataLayer:!0,Voxel:!0},"web-scene/basemap":{ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,WebTiledLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,ArcGISImageServiceLayer:!0,WMS:!0,ArcGISMapServiceLayer:!0},"web-scene/ground":{ArcGISTiledElevationServiceLayer:!0,RasterDataElevationLayer:!0},"web-map/operational-layers":{ArcGISFeatureLayer:!0,ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISStreamLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,BingMapsAerial:!0,BingMapsHybrid:!0,BingMapsRoad:!0,CSV:!0,GeoRSS:!0,GeoJSON:!0,GroupLayer:!0,KML:!0,OGCFeatureLayer:!0,SubtypeGroupLayer:!0,VectorTileLayer:!0,WFS:!0,WMS:!0,WebTiledLayer:!0},"web-map/basemap":{ArcGISImageServiceLayer:!0,ArcGISImageServiceVectorLayer:!0,ArcGISMapServiceLayer:!0,ArcGISTiledImageServiceLayer:!0,ArcGISTiledMapServiceLayer:!0,OpenStreetMap:!0,VectorTileLayer:!0,WMS:!0,WebTiledLayer:!0,BingMapsAerial:!0,BingMapsRoad:!0,BingMapsHybrid:!0},"web-map/tables":{ArcGISFeatureLayer:!0},"portal-item/operational-layers":{ArcGISSceneServiceLayer:!0,PointCloudLayer:!0,BuildingSceneLayer:!0,IntegratedMeshLayer:!0}},XD=t=>{let i=class extends t{constructor(){super(...arguments),this.title=null}writeListMode(t,e,i,s){(s&&"ground"===s.layerContainerType||t&&Ed(this,i,{},s))&&(e[i]=t)}writeOperationalLayerType(t,e,i,s){!t||s&&"tables"===s.layerContainerType||(e.layerType=t)}writeTitle(t,e){e.title=t||"Layer"}read(t,e){e&&(e.layer=this),Ad(this,0,(e=>super.read(t,e)),e)}write(t,e){if(null!=e&&e.origin){const t=`${e.origin}/${e.layerContainerType||"operational-layers"}`,s=YD[t];let n=s&&s[this.operationalLayerType];var i;if("ArcGISTiledElevationServiceLayer"===this.operationalLayerType&&"web-scene/operational-layers"===t&&(n=!1),!n)return null==(i=e.messages)||i.push(new Ve("layer:unsupported",`Layers (${this.title}, ${this.id}) of type '${this.declaredClass}' are not supported in the context of '${t}'`,{layer:this})),null}const s=super.write(t,{...e,layer:this}),n=!!e&&!!e.messages&&!!e.messages.filter((t=>t instanceof Ve&&"web-document-write:property-required"===t.name)).length;var r;return an(null==s?void 0:s.url)?(null==e||null==(r=e.messages)||r.push(new Ve("layer:invalid-url",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Blob URL cannot be written to web scenes and web maps`,{layer:this})),null):!this.url&&n?null:s}beforeSave(){}};return e([oe({type:String,json:{write:{ignoreOrigin:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0}},"portal-item":{write:!1}}}})],i.prototype,"id",void 0),e([oe({json:{write:{ignoreOrigin:!0},origins:{"web-map":{read:!1,write:!1}}}})],i.prototype,"listMode",void 0),e([xd("listMode")],i.prototype,"writeListMode",null),e([oe({type:String,readOnly:!0,json:{read:!1,write:{target:"layerType",ignoreOrigin:!0},origins:{"portal-item":{write:!1}}}})],i.prototype,"operationalLayerType",void 0),e([xd("operationalLayerType")],i.prototype,"writeOperationalLayerType",null),e([oe(ux)],i.prototype,"opacity",void 0),e([oe({type:String,json:{write:{ignoreOrigin:!0,writerEnsuresNonNull:!0},origins:{"web-scene":{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}},"portal-item":{write:!1}}},value:"Layer"})],i.prototype,"title",void 0),e([xd("title")],i.prototype,"writeTitle",null),e([oe({type:Boolean,json:{name:"visibility",origins:{"web-document":{name:"visibility",default:!0},"portal-item":{name:"visibility",read:{source:["visible","visibility"]}}}}})],i.prototype,"visible",void 0),i=e([si("esri.layers.mixins.OperationalLayer")],i),i};var tV;const eV=new ri({asc:"ascending",desc:"descending"});let iV=tV=class extends Vd{constructor(t){super(t),this.field=null,this.valueExpression=null,this.order="ascending"}clone(){return new tV({field:this.field,valueExpression:this.valueExpression,order:this.order})}};e([oe({type:String,json:{write:!0}})],iV.prototype,"field",void 0),e([oe({type:String,json:{write:!0}})],iV.prototype,"valueExpression",void 0),e([oe({type:eV.apiValues,json:{read:eV.read,write:eV.write}})],iV.prototype,"order",void 0),iV=tV=e([si("esri.layers.support.OrderByInfo")],iV);const sV=iV;function nV(t,e,i){if(!t)return null;const s=t.find((t=>!!t.field));if(!s)return null;const n=new sV;return n.read(s,i),[n]}function rV(t,e,i){const s=t.find((t=>!!t.field));s&&K(i,[s.toJSON()],e)}const oV=t=>{let i=class extends t{constructor(){super(...arguments),this.orderBy=null}};return e([oe({type:[sV],json:{origins:{"web-scene":{write:!1,read:!1}},read:{source:"layerDefinition.orderBy",reader:nV},write:{target:"layerDefinition.orderBy",writer:rV}}})],i.prototype,"orderBy",void 0),i=e([si("esri.layers.mixins.OrderedLayer")],i),i},aV=ct.getLogger("esri.layers.mixins.PortalLayer"),lV=t=>{let i=class extends t{constructor(){super(...arguments),this.resourceReferences={portalItem:null,paths:[]},this.userHasEditingPrivileges=!0}destroy(){var t;null==(t=this.portalItem)||t.destroy(),this.portalItem=null}set portalItem(t){t!==this._get("portalItem")&&(this.removeOrigin("portal-item"),this._set("portalItem",t))}readPortalItem(t,e,i){if(e.itemId)return new LO({id:e.itemId,portal:i&&i.portal})}writePortalItem(t,e){t&&t.id&&(e.itemId=t.id)}async loadFromPortal(t,e){if(this.portalItem&&this.portalItem.id)try{const i=await import("./p-68b00541.js").then((function(t){return t.l}));return Ji(e),await i.load({instance:this,supportedTypes:t.supportedTypes,validateItem:t.validateItem,supportsData:t.supportsData},e)}catch(t){throw is(t)||aV.warn(`Failed to load layer (${this.title}, ${this.id}) portal item (${this.portalItem.id})\n  ${t}`),t}}async finishLoadEditablePortalLayer(t){this._set("userHasEditingPrivileges",await this.fetchUserHasEditingPrivileges(t).catch((t=>(Ki(t),!0))))}async fetchUserHasEditingPrivileges(t){const e=this.url?null==Pn?void 0:Pn.findCredential(this.url):null;if(!e)return!0;const i=uV.credential===e?uV.user:await this.fetchEditingUser(t);return uV.credential=e,uV.user=i,c(i)||null==i.privileges||i.privileges.includes("features:user:edit")}async fetchEditingUser(t){var e,i;const s=null==(e=this.portalItem)||null==(i=e.portal)?void 0:i.user;if(s)return s;const n=Pn.findServerInfo(this.url);if(null==n||!n.owningSystemUrl)return null;const r=n.owningSystemUrl+"/sharing/rest",o=Qv.getDefault();if(o&&o.loaded&&sn(o.restUrl)===sn(r))return o.user;const a=r+"/community/self",l=u(t)?t.signal:null,c=await FT($n(a,{authMode:"no-prompt",query:{f:"json"},signal:l}));return c.ok?qv.fromJSON(c.value.data):null}read(t,e){e&&(e.layer=this),super.read(t,e)}write(t,e){const i=e&&e.portal,s=this.portalItem&&this.portalItem.id&&(this.portalItem.portal||Qv.getDefault());return i&&s&&!Js(s.restUrl,i.restUrl)?(e.messages&&e.messages.push(new Ve("layer:cross-portal",`The layer '${this.title} (${this.id})' cannot be persisted because it refers to an item on a different portal than the one being saved to. To save the scene, set the layer.portalItem to null or save the scene to the same portal as the item associated with the layer`,{layer:this})),null):super.write(t,{...e,layer:this})}};return e([oe({type:LO})],i.prototype,"portalItem",null),e([Sd("web-document","portalItem",["itemId"])],i.prototype,"readPortalItem",null),e([xd("web-document","portalItem",{itemId:{type:String}})],i.prototype,"writePortalItem",null),e([oe()],i.prototype,"resourceReferences",void 0),e([oe({readOnly:!0})],i.prototype,"userHasEditingPrivileges",void 0),i=e([si("esri.layers.mixins.PortalLayer")],i),i},uV={credential:null,user:null},cV=new qo,hV=new WeakMap;function dV(t){return t&&"object"==typeof t&&"refreshInterval"in t&&"refresh"in t}function pV(t,e){return Number.isFinite(t)&&Number.isFinite(e)?e<=0?t:pV(e,t%e):0}let fV=0,yV=0;function mV(){const t=Date.now();for(const i of cV)if(i.refreshInterval){var e;t-(null!=(e=hV.get(i))?e:0)+5>=6e4*i.refreshInterval&&(hV.set(i,t),i.refresh(t))}}po((()=>{const t=Date.now();let e=0;for(const i of cV)e=pV(Math.round(6e4*i.refreshInterval),e),i.refreshInterval?hV.get(i)||hV.set(i,t):hV.delete(i);if(e!==yV){if(yV=e,clearInterval(fV),0===yV)return void(fV=0);fV=setInterval(mV,yV)}}));const gV=t=>{let i=class extends t{constructor(...t){super(...t),this.refreshInterval=0,this.refreshTimestamp=0,this._debounceHasDataChanged=ps((()=>this.hasDataChanged())),this.when().then((()=>{!function(t){dV(t)&&cV.push(t)}(this)}),(()=>{}))}destroy(){!function(t){dV(t)&&cV.includes(t)&&cV.remove(t)}(this)}get refreshParameters(){return{_ts:this.refreshTimestamp||null}}refresh(t=Date.now()){ss(this._debounceHasDataChanged()).then((e=>{e&&this._set("refreshTimestamp",t),this.emit("refresh",{dataChanged:e})}),(t=>{ct.getLogger(this.declaredClass).error(t),this.emit("refresh",{dataChanged:!1,error:t})}))}async hasDataChanged(){return!0}};return e([oe({type:Number,cast:t=>t>=.1?t:t<=0?0:.1,json:{write:!0}})],i.prototype,"refreshInterval",void 0),e([oe({readOnly:!0})],i.prototype,"refreshTimestamp",void 0),e([oe()],i.prototype,"refreshParameters",null),i=e([si("esri.layers.mixins.RefreshableLayer")],i),i},vV=t=>{let i=class extends t{constructor(){super(...arguments),this.minScale=0,this.maxScale=0}get scaleRangeId(){return`${this.minScale},${this.maxScale}`}};return e([oe({type:Number,nonNullable:!0,json:{write:!0}})],i.prototype,"minScale",void 0),e([oe({type:Number,nonNullable:!0,json:{write:!0}})],i.prototype,"maxScale",void 0),e([oe({readOnly:!0})],i.prototype,"scaleRangeId",null),i=e([si("esri.layers.mixins.ScaleRangeLayer")],i),i};var wV;let bV=wV=class extends Vd{constructor(t){super(t),this.respectsDaylightSaving=!1,this.timezone=null}readRespectsDaylightSaving(t,e){return void 0!==e.respectsDaylightSaving?e.respectsDaylightSaving:void 0!==e.respectDaylightSaving&&e.respectDaylightSaving}clone(){const{respectsDaylightSaving:t,timezone:e}=this;return new wV({respectsDaylightSaving:t,timezone:e})}};e([oe({type:Boolean,json:{write:!0}})],bV.prototype,"respectsDaylightSaving",void 0),e([Sd("respectsDaylightSaving",["respectsDaylightSaving","respectDaylightSaving"])],bV.prototype,"readRespectsDaylightSaving",null),e([oe({type:String,json:{read:{source:"timeZone"},write:{target:"timeZone"}}})],bV.prototype,"timezone",void 0),bV=wV=e([si("esri.layers.support.TimeReference")],bV);const MV=bV;var SV;let xV=SV=class extends Vd{constructor(t){super(t),this.cumulative=!1,this.endField=null,this.fullTimeExtent=null,this.hasLiveData=!1,this.interval=null,this.startField=null,this.timeReference=null,this.trackIdField=null,this.useTime=!0}readFullTimeExtent(t,e){return e.timeExtent&&Array.isArray(e.timeExtent)&&2===e.timeExtent.length?new uS({start:new Date(e.timeExtent[0]),end:new Date(e.timeExtent[1])}):null}writeFullTimeExtent(t,e){e.timeExtent=t&&u(t.start)&&u(t.end)?[t.start.getTime(),t.end.getTime()]:null}readInterval(t,e){return e.timeInterval&&e.timeIntervalUnits?new dF({value:e.timeInterval,unit:uF.fromJSON(e.timeIntervalUnits)}):e.defaultTimeInterval&&e.defaultTimeIntervalUnits?new dF({value:e.defaultTimeInterval,unit:uF.fromJSON(e.defaultTimeIntervalUnits)}):null}writeInterval(t,e){if(t){const i=t.toJSON();e.timeInterval=i.value,e.timeIntervalUnits=i.unit}else e.timeInterval=null,e.timeIntervalUnits=null}clone(){const{cumulative:t,endField:e,hasLiveData:i,interval:s,startField:n,timeReference:r,fullTimeExtent:o,trackIdField:a,useTime:l}=this;return new SV({cumulative:t,endField:e,hasLiveData:i,interval:s,startField:n,timeReference:H(r),fullTimeExtent:H(o),trackIdField:a,useTime:l})}};e([oe({type:Boolean,json:{read:{source:"exportOptions.timeDataCumulative"},write:{target:"exportOptions.timeDataCumulative"}}})],xV.prototype,"cumulative",void 0),e([oe({type:String,json:{read:{source:"endTimeField"},write:{target:"endTimeField",allowNull:!0}}})],xV.prototype,"endField",void 0),e([oe({type:uS,json:{write:{enabled:!0,allowNull:!0}}})],xV.prototype,"fullTimeExtent",void 0),e([Sd("fullTimeExtent",["timeExtent"])],xV.prototype,"readFullTimeExtent",null),e([xd("fullTimeExtent")],xV.prototype,"writeFullTimeExtent",null),e([oe({type:Boolean,json:{write:!0}})],xV.prototype,"hasLiveData",void 0),e([oe({type:dF,json:{write:{enabled:!0,allowNull:!0}}})],xV.prototype,"interval",void 0),e([Sd("interval",["timeInterval","timeIntervalUnits","defaultTimeInterval","defaultTimeIntervalUnits"])],xV.prototype,"readInterval",null),e([xd("interval")],xV.prototype,"writeInterval",null),e([oe({type:String,json:{read:{source:"startTimeField"},write:{target:"startTimeField",allowNull:!0}}})],xV.prototype,"startField",void 0),e([oe({type:MV,json:{write:{enabled:!0,allowNull:!0}}})],xV.prototype,"timeReference",void 0),e([oe({type:String,json:{write:{enabled:!0,allowNull:!0}}})],xV.prototype,"trackIdField",void 0),e([oe({type:Boolean,json:{read:{source:"exportOptions.useTime"},write:{target:"exportOptions.useTime"}}})],xV.prototype,"useTime",void 0),xV=SV=e([si("esri.layers.support.TimeInfo")],xV);const kV=xV,IV=t=>{let i=class extends t{constructor(){super(...arguments),this.timeExtent=null,this.timeOffset=null,this.useViewTime=!0}readOffset(t,e){const i=e.timeInfo.exportOptions;if(!i)return null;const s=i.timeOffset,n=uF.fromJSON(i.timeOffsetUnits);return s&&n?new dF({value:s,unit:n}):null}set timeInfo(t){yy(t,this.fieldsIndex),this._set("timeInfo",t)}};return e([oe({type:uS,json:{write:!1}})],i.prototype,"timeExtent",void 0),e([oe({type:dF})],i.prototype,"timeOffset",void 0),e([Sd("service","timeOffset",["timeInfo.exportOptions"])],i.prototype,"readOffset",null),e([oe({value:null,type:kV,json:{write:!0,origins:{"web-document":{read:!1,write:!1}}}})],i.prototype,"timeInfo",null),e([oe({type:Boolean,json:{read:{source:"timeAnimation"},write:{target:"timeAnimation"},origins:{"web-scene":{read:!1,write:!1}}}})],i.prototype,"useViewTime",void 0),i=e([si("esri.layers.mixins.TemporalLayer")],i),i};var jV;let _V=jV=class extends Vd{constructor(t){super(t)}clone(){const{name:t,fields:e,isAscending:i,isUnique:s,description:n}=this;return new jV({name:t,fields:e,isAscending:i,isUnique:s,description:n})}};e([oe({constructOnly:!0})],_V.prototype,"name",void 0),e([oe({constructOnly:!0})],_V.prototype,"fields",void 0),e([oe({constructOnly:!0})],_V.prototype,"isAscending",void 0),e([oe({constructOnly:!0})],_V.prototype,"isUnique",void 0),e([oe({constructOnly:!0})],_V.prototype,"description",void 0),_V=jV=e([si("esri.layers.support.FeatureIndex")],_V);let TV=class extends Vd{constructor(){super(...arguments),this.type=null}};e([oe({type:["selection","cluster"],readOnly:!0,json:{read:!1,write:!0}})],TV.prototype,"type",void 0),TV=e([si("esri.layers.support.FeatureReduction")],TV);const OV=TV;var AV;let FV=AV=class extends Vd{constructor(){super(...arguments),this.statisticType=null,this.onStatisticField=null,this.onStatisticValueExpression=null}clone(){return new AV({statisticType:this.statisticType,onStatisticField:this.onStatisticField,onStatisticValueExpression:this.onStatisticValueExpression})}};e([oe({type:String,json:{write:!0}})],FV.prototype,"statisticType",void 0),e([oe({type:String,json:{write:!0}})],FV.prototype,"onStatisticField",void 0),e([oe({type:String,json:{write:!0}})],FV.prototype,"onStatisticValueExpression",void 0),FV=AV=e([si("esri.layers.support.OutStatistic")],FV);const CV=FV;var PV;let EV=PV=class extends Vd{constructor(){super(...arguments),this.name=null}clone(){return new PV({name:this.name,outStatistic:this.outStatistic.clone()})}};e([oe({type:String,json:{write:!0}})],EV.prototype,"name",void 0),e([oe({type:CV,json:{write:!0}})],EV.prototype,"outStatistic",void 0),EV=PV=e([si("esri.layers.support.AggregateField")],EV);const RV=EV,LV=/__begin__/gi,NV=/__end__/gi,DV=/^__begin__/i,VV=/__end__$/i;function $V(t){const e={expression:"",type:"none"};return t.labelExpressionInfo?t.labelExpressionInfo.value?(e.expression=t.labelExpressionInfo.value,e.type="conventional"):t.labelExpressionInfo.expression&&(e.expression=t.labelExpressionInfo.expression,e.type="arcade"):null!=t.labelExpression&&(e.expression=function(t){return t.replace(/\[/g,"{").replace(/\]/g,"}")}(t.labelExpression),e.type="conventional"),e}function zV(t){let e;return t?(e=rt(t,(t=>'__begin__$feature["'+t+'"]__end__')),e=DV.test(e)?e.replace(DV,""):'"'+e,e=VV.test(e)?e.replace(VV,""):e+'"',e=e.replace(LV,'" + ').replace(NV,' + "')):e='""',e}const GV=/^\s*\{([^}]+)\}\s*$/i,UV=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*$/i,qV=/^\s*(?:(?:\$feature\.(\w+))|(?:\$feature\[(["'])([\w\s]+)(\2)\]));?\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])(\1|\3)(\5)\s*\));?\s*$/i,BV=/^\s*(?:DomainName\(\s*\$feature\s*,\s*(["'])([\w\s]+)(\1)\s*\));?\s*$/i;function WV(t){if(!t)return null;let e=UV.exec(t)||qV.exec(t);return e?e[1]||e[3]:(e=BV.exec(t),e?e[2]:null)}var HV;let JV=HV=class extends Vd{constructor(){super(...arguments),this.expression=null,this.title=null,this.value=null}readExpression(t,e){return e.value?zV(e.value):t}writeExpression(t,e,i){null!=this.value&&(t=zV(this.value)),null!=t&&(e[i]=t)}clone(){return new HV({expression:this.expression,title:this.title,value:this.value})}};e([oe({type:String,json:{write:{writerEnsuresNonNull:!0}}})],JV.prototype,"expression",void 0),e([Sd("expression",["expression","value"])],JV.prototype,"readExpression",null),e([xd("expression")],JV.prototype,"writeExpression",null),e([oe({type:String,json:{write:!0,origins:{"web-scene":{write:!1}}}})],JV.prototype,"title",void 0),e([oe({json:{read:!1,write:!1}})],JV.prototype,"value",void 0),JV=HV=e([si("esri.layers.support.LabelExpressionInfo")],JV);const ZV=JV,QV=[252,146,31,255],KV={type:"esriSMS",style:"esriSMSCircle",size:6,color:QV,outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[153,153,153,255]}},YV={type:"esriSLS",style:"esriSLSSolid",width:.75,color:QV},XV={type:"esriSFS",style:"esriSFSSolid",color:[252,146,31,196],outline:{type:"esriSLS",style:"esriSLSSolid",width:.75,color:[255,255,255,191]}},t$={type:"esriSMS",style:"esriSMSCircle",color:[0,0,0,255],outline:null,size:10.5},e$={type:"esriSLS",style:"esriSLSSolid",color:[0,0,0,255],width:1.5},i$={type:"esriSFS",style:"esriSFSSolid",color:[0,0,0,255],outline:null};Eb.fromJSON(KV),zm.fromJSON(YV),Ab.fromJSON(XV);const s$=Nb.fromJSON({type:"esriTS",color:[255,255,255,255],font:{family:"arial-unicode-ms",size:10,weight:"bold"},horizontalAlignment:"center",kerning:!0,haloColor:[0,0,0,255],haloSize:1,rotated:!1,text:"",xoffset:0,yoffset:0,angle:0}),n$=Eb.fromJSON(t$),r$=zm.fromJSON(e$),o$=Ab.fromJSON(i$);var a$;const l$=new ri({esriServerPointLabelPlacementAboveCenter:"above-center",esriServerPointLabelPlacementAboveLeft:"above-left",esriServerPointLabelPlacementAboveRight:"above-right",esriServerPointLabelPlacementBelowCenter:"below-center",esriServerPointLabelPlacementBelowLeft:"below-left",esriServerPointLabelPlacementBelowRight:"below-right",esriServerPointLabelPlacementCenterCenter:"center-center",esriServerPointLabelPlacementCenterLeft:"center-left",esriServerPointLabelPlacementCenterRight:"center-right",esriServerLinePlacementAboveAfter:"above-after",esriServerLinePlacementAboveAlong:"above-along",esriServerLinePlacementAboveBefore:"above-before",esriServerLinePlacementAboveStart:"above-start",esriServerLinePlacementAboveEnd:"above-end",esriServerLinePlacementBelowAfter:"below-after",esriServerLinePlacementBelowAlong:"below-along",esriServerLinePlacementBelowBefore:"below-before",esriServerLinePlacementBelowStart:"below-start",esriServerLinePlacementBelowEnd:"below-end",esriServerLinePlacementCenterAfter:"center-after",esriServerLinePlacementCenterAlong:"center-along",esriServerLinePlacementCenterBefore:"center-before",esriServerLinePlacementCenterStart:"center-start",esriServerLinePlacementCenterEnd:"center-end",esriServerPolygonPlacementAlwaysHorizontal:"always-horizontal"},{ignoreUnknown:!0});function u$(t){return!t||"service"!==t.origin&&!c$(t.layer)}function c$(t){return"map-image"===(null==t?void 0:t.type)}function h$(t){var e,i;return!!c$(t)&&!(null==(e=t.capabilities)||null==(i=e.exportMap)||!i.supportsArcadeExpressionForLabeling)}let d$=a$=class extends Vd{constructor(t){super(t),this.type="label",this.name=null,this.deconflictionStrategy="static",this.labelExpression=null,this.labelExpressionInfo=null,this.labelPlacement=null,this.maxScale=0,this.minScale=0,this.symbol=s$,this.useCodedValues=void 0,this.where=null}static evaluateWhere(t,e){const i=function(t,e,i){switch(e){case"=":return t==i;case"<>":return t!=i;case">":return t>i;case">=":return t>=i;case"<":return t<i;case"<=":return t<=i}return!1};try{if(null==t)return!0;const s=t.split(" ");if(3===s.length)return i(e[s[0]],s[1],s[2]);if(7===s.length){const t=i(e[s[0]],s[1],s[2]),n=s[3],r=i(e[s[4]],s[5],s[6]);switch(n){case"AND":return t&&r;case"OR":return t||r}}return!1}catch(e){console.log("Error.: can't parse = "+t)}}readLabelExpression(t,e){const i=e.labelExpressionInfo;if(!i||!i.value&&!i.expression)return t}writeLabelExpression(t,e,i){if(this.labelExpressionInfo)if(null!=this.labelExpressionInfo.value)t=function(t){return t.replace(/\{/g,"[").replace(/\}/g,"]")}(this.labelExpressionInfo.value);else if(null!=this.labelExpressionInfo.expression){const e=WV(this.labelExpressionInfo.expression);e&&(t="["+e+"]")}null!=t&&(e[i]=t)}writeLabelExpressionInfo(t,e,i,s){if(null==t&&null!=this.labelExpression&&u$(s))t=new ZV({expression:this.getLabelExpressionArcade()});else if(!t)return;const n=t.toJSON(s);n.expression&&(e[i]=n)}writeMaxScale(t,e){(t||this.minScale)&&(e.maxScale=t)}writeMinScale(t,e){(t||this.maxScale)&&(e.minScale=t)}getLabelExpression(){return $V(this)}getLabelExpressionArcade(){return function(t){const e=$V(t);if(!e)return null;switch(e.type){case"conventional":return zV(e.expression);case"arcade":return e.expression}return null}(this)}getLabelExpressionSingleField(){return function(t){const e=$V(t);if(!e)return null;switch(e.type){case"conventional":return function(t){const e=t.match(GV);return e&&e[1].trim()||null}(e.expression);case"arcade":return WV(e.expression)}return null}(this)}hash(){return JSON.stringify(this)}clone(){return new a$({deconflictionStrategy:this.deconflictionStrategy,labelExpression:this.labelExpression,labelExpressionInfo:H(this.labelExpressionInfo),labelPlacement:this.labelPlacement,maxScale:this.maxScale,minScale:this.minScale,name:this.name,symbol:H(this.symbol),where:this.where,useCodedValues:this.useCodedValues})}};e([oe({type:String,json:{write:!0}})],d$.prototype,"name",void 0),e([oe({type:String,json:{write:!0,default:"static",origins:{"web-scene":{write:!1}}}})],d$.prototype,"deconflictionStrategy",void 0),e([oe({type:String,json:{write:{overridePolicy(t,e,i){return this.labelExpressionInfo&&"service"===(null==i?void 0:i.origin)&&h$(i.layer)?{enabled:!1}:{allowNull:!0}}}}})],d$.prototype,"labelExpression",void 0),e([Sd("labelExpression")],d$.prototype,"readLabelExpression",null),e([xd("labelExpression")],d$.prototype,"writeLabelExpression",null),e([oe({type:ZV,json:{write:{overridePolicy:(t,e,i)=>function(t){return u$(t)||h$(t.layer)}(i)?{allowNull:!0}:{enabled:!1}}}})],d$.prototype,"labelExpressionInfo",void 0),e([xd("labelExpressionInfo")],d$.prototype,"writeLabelExpressionInfo",null),e([oe({type:l$.apiValues,json:{type:l$.jsonValues,read:l$.read,write:l$.write}})],d$.prototype,"labelPlacement",void 0),e([oe({type:Number})],d$.prototype,"maxScale",void 0),e([xd("maxScale")],d$.prototype,"writeMaxScale",null),e([oe({type:Number})],d$.prototype,"minScale",void 0),e([xd("minScale")],d$.prototype,"writeMinScale",null),e([oe({types:Jb,json:{origins:{"web-scene":{types:Qb,write:Bj,default:null}},write:Bj,default:null}})],d$.prototype,"symbol",void 0),e([oe({type:Boolean,json:{write:!0}})],d$.prototype,"useCodedValues",void 0),e([oe({type:String,json:{write:!0}})],d$.prototype,"where",void 0),d$=a$=e([si("esri.layers.support.LabelClass")],d$);const p$=d$;var f$;let y$=f$=class extends Vd{constructor(t){super(t),this.type="cluster",this.clusterRadius=dm("80px"),this.clusterMinSize=dm("12px"),this.clusterMaxSize=dm("50px"),this.popupEnabled=!0,this.popupTemplate=null,this.symbol=null,this.labelingInfo=null,this.labelsVisible=!0,this.fields=null}clone(){return new f$({clusterRadius:this.clusterRadius,clusterMinSize:this.clusterMinSize,clusterMaxSize:this.clusterMaxSize,labelingInfo:H(this.labelingInfo),labelsVisible:this.labelsVisible,fields:H(this.fields),popupEnabled:this.popupEnabled,popupTemplate:H(this.popupTemplate)})}};e([oe({type:["cluster"],readOnly:!0,json:{write:!0}})],y$.prototype,"type",void 0),e([oe({type:Number,cast:t=>"auto"===t?t:dm(t),json:{write:!0}})],y$.prototype,"clusterRadius",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],y$.prototype,"clusterMinSize",void 0),e([oe({type:Number,cast:dm,json:{write:!0}})],y$.prototype,"clusterMaxSize",void 0),e([oe(sx)],y$.prototype,"popupEnabled",void 0),e([oe({type:lj,json:{read:{source:"popupInfo"},write:{target:"popupInfo"}}})],y$.prototype,"popupTemplate",void 0),e([oe({types:Bb})],y$.prototype,"symbol",void 0),e([oe({type:[p$],json:{read:{source:"drawingInfo.labelingInfo"},write:{target:"drawingInfo.labelingInfo"}}})],y$.prototype,"labelingInfo",void 0),e([oe(nx)],y$.prototype,"labelsVisible",void 0),e([oe({type:[RV],json:{write:!0}})],y$.prototype,"fields",void 0),y$=f$=e([si("esri.layers.support.FeatureReductionCluster")],y$);const m$=y$;var g$;let v$=g$=class extends OV{constructor(t){super(t),this.type="selection"}clone(){return new g$}};e([oe({type:["selection"]})],v$.prototype,"type",void 0),v$=g$=e([si("esri.layers.support.FeatureReductionSelection")],v$);const w$=v$,b$={types:{key:"type",base:OV,typeMap:{selection:w$,cluster:m$}},json:{name:"layerDefinition.featureReduction",write:{allowNull:!0},origins:{"web-map":{types:{key:"type",base:OV,typeMap:{selection:m$}}},"web-scene":{types:{key:"type",base:OV,typeMap:{selection:w$}}}}}},M$=new ri({esriFeatureEditToolAutoCompletePolygon:"auto-complete-polygon",esriFeatureEditToolCircle:"circle",esriFeatureEditToolEllipse:"ellipse",esriFeatureEditToolFreehand:"freehand",esriFeatureEditToolLine:"line",esriFeatureEditToolNone:"none",esriFeatureEditToolPoint:"point",esriFeatureEditToolPolygon:"polygon",esriFeatureEditToolRectangle:"rectangle",esriFeatureEditToolArrow:"arrow",esriFeatureEditToolTriangle:"triangle",esriFeatureEditToolLeftArrow:"left-arrow",esriFeatureEditToolRightArrow:"right-arrow",esriFeatureEditToolUpArrow:"up-arrow",esriFeatureEditToolDownArrow:"down-arrow"});let S$=class extends Vd{constructor(t){super(t),this.name=null,this.description=null,this.drawingTool=null,this.prototype=null,this.thumbnail=null}};e([oe({json:{write:!0}})],S$.prototype,"name",void 0),e([oe({json:{write:!0}})],S$.prototype,"description",void 0),e([oe({json:{read:M$.read,write:M$.write}})],S$.prototype,"drawingTool",void 0),e([oe({json:{write:!0}})],S$.prototype,"prototype",void 0),e([oe({json:{write:!0}})],S$.prototype,"thumbnail",void 0),S$=e([si("esri.layers.support.FeatureTemplate")],S$);const x$=S$;let k$=class extends Vd{constructor(t){super(t),this.id=null,this.name=null,this.domains=null,this.templates=null}readDomains(t){const e={};for(const i of Object.keys(t))e[i]=zP(t[i]);return e}writeDomains(t,e){const i={};for(const e of Object.keys(t)){var s;t[e]&&(i[e]=null==(s=t[e])?void 0:s.toJSON())}e.domains=i}};e([oe({json:{write:!0}})],k$.prototype,"id",void 0),e([oe({json:{write:!0}})],k$.prototype,"name",void 0),e([oe({json:{write:!0}})],k$.prototype,"domains",void 0),e([Sd("domains")],k$.prototype,"readDomains",null),e([xd("domains")],k$.prototype,"writeDomains",null),e([oe({type:[x$],json:{write:!0}})],k$.prototype,"templates",void 0),k$=e([si("esri.layers.support.FeatureType")],k$);const I$=k$;function j$(t){return"date"===t.type||"esriFieldTypeDate"===t.type}function _$(t){return"oid"===t.type||"esriFieldTypeOID"===t.type}function T$(t){return"global-id"===t.type||"esriFieldTypeGlobalID"===t.type}class O${constructor(t){if(this.fields=t,this._fieldsMap=new Map,this._dateFieldsSet=new Set,this._numericFieldsSet=new Set,this.dateFields=[],this.numericFields=[],this._requiredFields=null,!t)return;const e=[];for(const i of t){const t=i&&i.name;if(t){const s=A$(t);this._fieldsMap.set(t,i),this._fieldsMap.set(s,i),e.push(s),j$(i)?(this.dateFields.push(i),this._dateFieldsSet.add(i)):$y(i)&&(this._numericFieldsSet.add(i),this.numericFields.push(i)),_$(i)||T$(i)||(i.editable=null==i.editable||!!i.editable,i.nullable=null==i.nullable||!!i.nullable)}}e.sort(),this.uid=e.join(",")}destroy(){this._fieldsMap.clear()}get requiredFields(){if(!this._requiredFields){this._requiredFields=[];for(const t of this.fields)_$(t)||T$(t)||t.nullable||void 0!==Ay(t)||this._requiredFields.push(t)}return this._requiredFields}has(t){return null!=this.get(t)}get(t){return null!=t?this._fieldsMap.get(t)||this._fieldsMap.get(A$(t)):void 0}isDateField(t){return this._dateFieldsSet.has(this.get(t))}isNumericField(t){return this._numericFieldsSet.has(this.get(t))}normalizeFieldName(t){const e=this.get(t);if(e)return e.name}}function A$(t){return t.toLowerCase().trim()}const F$=ct.getLogger("esri.layers.support.fieldProperties");function C$(){return{fields:{type:[BP],value:null},fieldsIndex:{readOnly:!0,get(){return new O$(this.fields||[])}},outFields:{type:[String],json:{read:!1},set:function(t){this._userOutFields=t,this.notifyChange("outFields")},get:function(){const t=this._userOutFields;if(!t||!t.length)return null;if(t.includes("*"))return["*"];if(!this.fields)return t;for(const e of t)this.fieldsIndex.has(e)||F$.error("field-attributes-layer:invalid-field",`Invalid field ${e} found in outFields`,{layer:this,outFields:t});return gy(this.fieldsIndex,t)}}}}let P$=class extends Vd{constructor(t){super(t),this.shapeAreaField=null,this.shapeLengthField=null,this.units=null}};e([oe({type:String,json:{read:{source:"shapeAreaFieldName"}}})],P$.prototype,"shapeAreaField",void 0),e([oe({type:String,json:{read:{source:"shapeLengthFieldName"}}})],P$.prototype,"shapeLengthField",void 0),e([oe({type:String,json:{read:t=>HS.read(t)||JS.read(t)}})],P$.prototype,"units",void 0),P$=e([si("esri.layers.support.GeometryFieldsInfo")],P$);const E$=P$,R$=/\[([^\[\]]+)\]/gi;function L$(t,e,i){return t?t.map((t=>{const s=new p$;if(s.read(t,i),s.labelExpression){const t=e.fields||e.layerDefinition&&e.layerDefinition.fields||this.fields;s.labelExpression=s.labelExpression.replace(R$,((e,i)=>`[${function(t,e){if(!e)return t;const i=t.toLowerCase();for(let t=0;t<e.length;t++){const s=e[t].name;if(s.toLowerCase()===i)return s}return t}(i,t)}]`))}return s})):null}var N$;let D$=N$=class extends Vd{constructor(t){super(t),this.floorField=null,this.viewAllMode=!1,this.viewAllLevelIds=new qo}clone(){return new N$({floorField:this.floorField,viewAllMode:this.viewAllMode,viewAllLevelIds:this.viewAllLevelIds})}};e([oe({type:String,json:{write:!0}})],D$.prototype,"floorField",void 0),e([oe({json:{read:!1,write:!1}})],D$.prototype,"viewAllMode",void 0),e([oe({json:{read:!1,write:!1}})],D$.prototype,"viewAllLevelIds",void 0),D$=N$=e([si("esri.layers.support.LayerFloorInfo")],D$);const V$=D$,$$=new ri({esriRelCardinalityOneToOne:"one-to-one",esriRelCardinalityOneToMany:"one-to-many",esriRelCardinalityManyToMany:"many-to-many"}),z$=new ri({esriRelRoleOrigin:"origin",esriRelRoleDestination:"destination"});let G$=class extends Vd{constructor(t){super(t),this.cardinality=null,this.composite=null,this.id=null,this.keyField=null,this.keyFieldInRelationshipTable=null,this.name=null,this.relatedTableId=null,this.relationshipTableId=null,this.role=null}};e([oe({json:{read:$$.read,write:$$.write}})],G$.prototype,"cardinality",void 0),e([oe({json:{read:!0,write:!0}})],G$.prototype,"composite",void 0),e([oe({json:{read:!0,write:!0}})],G$.prototype,"id",void 0),e([oe({json:{read:!0,write:!0}})],G$.prototype,"keyField",void 0),e([oe({json:{read:!0,write:!0}})],G$.prototype,"keyFieldInRelationshipTable",void 0),e([oe({json:{read:!0,write:!0}})],G$.prototype,"name",void 0),e([oe({json:{read:!0,write:!0}})],G$.prototype,"relatedTableId",void 0),e([oe({json:{read:!0,write:!0}})],G$.prototype,"relationshipTableId",void 0),e([oe({json:{read:z$.read,write:z$.write}})],G$.prototype,"role",void 0),G$=e([si("esri.layers.support.Relationship")],G$);const U$=G$;async function q$(t,e,i){const s=t&&t.getAtOrigin&&t.getAtOrigin("renderer",e.origin);if(s&&"unique-value"===s.type&&s.styleOrigin){const n=await FT(s.populateFromStyle());if(Ji(i),!1===n.ok){const i=n.error;e&&e.messages&&e.messages.push(new Ie("renderer:style-reference","Failed to create unique value renderer from style reference: "+i.message,{error:i,context:e})),t.clear("renderer",e.origin)}}}const B$=["oid","global-id"],W$=["oid","global-id","guid"];function H$({displayField:t,editFieldsInfo:e,fields:i,objectIdField:s,title:n},r){if(!i)return null;const o=function({editFieldsInfo:t,fields:e,objectIdField:i},s){return function(t,e){const i=t;return e&&(t=t.filter((t=>-1===e.indexOf(t.type)))),t===i&&(t=t.slice()),t.sort(Q$),t}(e,(null==s?void 0:s.ignoreFieldTypes)||ez).map((e=>new qk({fieldName:e.name,isEditable:Y$(e,t),label:e.alias,format:X$(e),visible:Z$(e,{editFieldsInfo:t,objectIdField:i,visibleFieldNames:null==s?void 0:s.visibleFieldNames})})))}({editFieldsInfo:e,fields:i,objectIdField:s},r);if(!o.length)return null;const a=function(t){const e=function({displayField:t,fields:e}){return t||(e&&e.length?xy(e,"name-or-title")||xy(e,"unique-identifier")||xy(e,"type-or-category")||function(t){for(const e of t){if(!e||!e.name)continue;const t=e.name.toLowerCase();if(t.indexOf("name")>-1||t.indexOf("title")>-1)return e.name}return null}(e):null)}(t),{titleBase:i}=t;return e?`${i}: {${e.trim()}}`:i}({titleBase:n,fields:i,displayField:t}),l=[new Hk,new Ek];return new lj({title:a,content:l,fieldInfos:o})}const J$=[/^fnode_$/i,/^tnode_$/i,/^lpoly_$/i,/^rpoly_$/i,/^poly_$/i,/^subclass$/i,/^subclass_$/i,/^rings_ok$/i,/^rings_nok$/i,/shape/i,/perimeter/i,/objectid/i,/_i$/i],Z$=(t,{editFieldsInfo:e,objectIdField:i,visibleFieldNames:s})=>s?s.has(t.name):!(K$(t.name,e)||i&&t.name===i||B$.indexOf(t.type)>-1||J$.some((e=>e.test(t.name))));function Q$(t,e){return"oid"===t.type?-1:"oid"===e.type?1:tz(t)?-1:tz(e)?1:(t.alias||t.name).toLocaleLowerCase().localeCompare((e.alias||e.name).toLocaleLowerCase())}function K$(t,e){if(!t||!e)return!1;const{creationDateField:i,creatorField:s,editDateField:n,editorField:r}=e;return-1!==[i&&i.toLowerCase(),s&&s.toLowerCase(),n&&n.toLowerCase(),r&&r.toLowerCase()].indexOf(t.toLowerCase())}function Y$(t,e){return t.editable&&-1===W$.indexOf(t.type)&&!K$(t.name,e)}function X$(t){switch(t.type){case"small-integer":case"integer":case"single":return new zk({digitSeparator:!0,places:0});case"double":return new zk({digitSeparator:!0,places:2});case"date":return new zk({dateFormat:"long-month-day-year"});default:return null}}function tz(t){return"name"===(t.name&&t.name.toLowerCase())||"name"===(t.alias&&t.alias.toLowerCase())||void 0}const ez=["geometry","blob","raster","guid","xml"],iz=new ri({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),sz={name:"supportsName",size:"supportsSize",contentType:"supportsContentType",keywords:"supportsKeywords",exifInfo:"supportsExifInfo"},nz="FeatureLayer",rz=ct.getLogger("esri.layers.FeatureLayer");function oz(t){return t&&t instanceof qo}function az(t,e,i){return!!(t&&t.hasOwnProperty(e)?t[e]:i)}function lz(t,e,i){return t&&t.hasOwnProperty(e)?t[e]:i}const uz=C$();function cz(t,e,i){const s=!(null==i||!i.writeLayerSchema);return{enabled:s,ignoreOrigin:s}}let hz=class extends(KD(zD(oV(IV(vV(gV($D(XD(lV(BA(GD(VD(mA))))))))))))){constructor(...t){super(...t),this._handles=new Wo,this.capabilities=null,this.charts=null,this.copyright=null,this.datesInUnknownTimezone=!1,this.displayField=null,this.definitionExpression=null,this.dynamicDataSource=null,this.editFieldsInfo=null,this.editingInfo=null,this.elevationInfo=null,this.featureReduction=null,this.fields=null,this.fieldsIndex=null,this.floorInfo=null,this.formTemplate=null,this.fullExtent=null,this.gdbVersion=null,this.geometryFieldsInfo=null,this.geometryType=null,this.hasM=void 0,this.hasZ=void 0,this.heightModelInfo=null,this.historicMoment=null,this.infoFor3D=null,this.isTable=!1,this.labelsVisible=!0,this.labelingInfo=null,this.layerId=void 0,this.legendEnabled=!0,this.minScale=0,this.maxScale=0,this.globalIdField=null,this.objectIdField=null,this.outFields=null,this.path=null,this.popupEnabled=!0,this.popupTemplate=null,this.relationships=null,this.sourceJSON=null,this.returnM=void 0,this.returnZ=void 0,this.screenSizePerspectiveEnabled=!0,this.serviceDefinitionExpression=null,this.spatialReference=ap.WGS84,this.subtypeCode=null,this.templates=null,this.timeInfo=null,this.title=null,this.sublayerTitleMode="item-title",this.trackIdField=null,this.type="feature",this.typeIdField=null,this.types=null,this.indexes=new(qo.ofType(_V)),this.userIsAdmin=!1,this.version=void 0,this.visible=!0}destroy(){var t;null==(t=this.source)||t.destroy(),this._handles=m(this._handles)}normalizeCtorArgs(t,e){return"string"==typeof t?{url:t,...e}:t}load(t){const e=u(t)?t.signal:null;if(this.portalItem&&this.portalItem.loaded&&this.source)return void this.addResolvingPromise(this.createGraphicsSource(e).then((t=>this._initLayerProperties(t))));const i=this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection"]},t).catch(Ki).then((async()=>{if(this.url&&null==this.layerId&&/FeatureServer|MapServer\/*$/i.test(this.url)){const t=await this._fetchFirstLayerId(e);null!=t&&(this.layerId=t)}if(!this.url&&!this._hasMemorySource())throw new Ve("feature-layer:missing-url-or-source","Feature layer must be created with either a url or a source");return this._initLayerProperties(await this.createGraphicsSource(e))})).then((()=>this.finishLoadEditablePortalLayer(t)));return this.addResolvingPromise(i),Promise.resolve(this)}readCapabilities(t,e){return{attachment:this._readAttachmentCapabilities((e=e.layerDefinition||e).attachmentProperties),data:this._readDataCapabilities(e),metadata:this._readMetadataCapabilities(e),operations:this._readOperationsCapabilities(e.capabilities||t,e),query:this._readQueryCapabilities(e),queryRelated:this._readQueryRelatedCapabilities(e),editing:this._readEditingCapabilities(e)}}get createQueryVersion(){return this.commitProperty("definitionExpression"),this.commitProperty("dynamicDataSource"),this.commitProperty("timeExtent"),this.commitProperty("timeOffset"),this.commitProperty("geometryType"),this.commitProperty("gdbVersion"),this.commitProperty("historicMoment"),this.commitProperty("returnZ"),this.commitProperty("capabilities"),this.commitProperty("returnM"),(this._get("createQueryVersion")||0)+1}get editingEnabled(){return!(this.loaded&&!this.capabilities.operations.supportsEditing)&&(this._isOverridden("editingEnabled")?this._get("editingEnabled"):this._hasMemorySource()||this.userHasEditingPrivileges)}set editingEnabled(t){null!=t?this._override("editingEnabled",t):this._clearOverride("editingEnabled")}readEditingEnabled(t,e){return this._readEditingEnabled(e,!1)}readEditingEnabledFromWebMap(t,e,i){return this._readEditingEnabled(e,!0,i)}writeEditingEnabled(t,e){this._writeEditingEnabled(t,e,!1)}writeEditingEnabledToWebMap(t,e,i,s){this._writeEditingEnabled(t,e,!0,s)}readEditingInfo(t,e){const{editingInfo:i}=e;return i?{lastEditDate:null!=i.lastEditDate?new Date(i.lastEditDate):null}:null}readIsTable(t,e){return"Table"===(e=e&&e.layerDefinition||e).type||!e.geometryType}writeIsTable(t,e,i,s){null!=s&&s.writeLayerSchema&&K(i,t?"Table":"Feature Layer",e)}readMinScale(t,e){return e.effectiveMinScale||t||0}readMaxScale(t,e){return e.effectiveMaxScale||t||0}readGlobalIdFieldFromService(t,e){if((e=e.layerDefinition||e).globalIdField)return e.globalIdField;if(e.fields)for(const t of e.fields)if("esriFieldTypeGlobalID"===t.type)return t.name}readObjectIdFieldFromService(t,e){if((e=e.layerDefinition||e).objectIdField)return e.objectIdField;if(e.fields)for(const t of e.fields)if("esriFieldTypeOID"===t.type)return t.name}get parsedUrl(){const t=this.url?Vs(this.url):null;return null!=t&&(null!=this.dynamicDataSource?t.path=nn(t.path,"dynamicLayer"):null!=this.layerId&&(t.path=nn(t.path,""+this.layerId))),t}get defaultPopupTemplate(){return this.createPopupTemplate()}set renderer(t){py(t,this.fieldsIndex),this._set("renderer",t)}readRenderer(t,e,i){const s=(e=e.layerDefinition||e).drawingInfo&&e.drawingInfo.renderer||void 0;if(s){const t=uT(s,e,i)||void 0;return t||rz.error("Failed to create renderer",{rendererDefinition:e.drawingInfo.renderer,layer:this,context:i}),t}if(e.defaultSymbol)return e.types&&e.types.length?new nT({defaultSymbol:dz(e.defaultSymbol,e,i),field:e.typeIdField,uniqueValueInfos:e.types.map((t=>({id:t.id,symbol:dz(t.symbol,t,i)})))}):new P_({symbol:dz(e.defaultSymbol,e,i)})}set source(t){const e=this._get("source");e!==t&&(oz(e)&&this._resetMemorySource(e),oz(t)&&this._initMemorySource(t),this._set("source",t))}castSource(t){return t?Array.isArray(t)||t instanceof qo?new DD({layer:this,items:t}):t:null}readSource(t,e){const i=$R.fromJSON(e.featureSet);return new DD({layer:this,items:i&&i.features||[]})}readServiceDefinitionExpression(t,e){return e.definitionQuery||e.definitionExpression}readTemplates(t,e){const i=e.editFieldsInfo,s=i&&i.creatorField,n=i&&i.editorField;return t=t&&t.map((t=>x$.fromJSON(t))),this._fixTemplates(t,s),this._fixTemplates(t,n),t}readTitle(t,e){const i=e.layerDefinition&&e.layerDefinition.name||e.name,s=e.title||e.layerDefinition&&e.layerDefinition.title;if(i){const t=this.portalItem&&this.portalItem.title;if("item-title"===this.sublayerTitleMode)return this.url?iF(this.url,i):i;let e=i;if(!e&&this.url){const t=XA(this.url);u(t)&&(e=t.title)}if(!e)return;return"item-title-and-service-name"===this.sublayerTitleMode&&t&&t!==e&&(e=t+" - "+e),eF(e)}if("item-title"===this.sublayerTitleMode&&s)return s}readTitleFromWebMap(t,e){return e.title||e.layerDefinition&&e.layerDefinition.name}readTypeIdField(t,e){let i=(e=e.layerDefinition||e).typeIdField;if(i&&e.fields){i=i.toLowerCase();const t=e.fields.find((t=>t.name.toLowerCase()===i));t&&(i=t.name)}return i}readTypes(t,e){t=(e=e.layerDefinition||e).types;const i=e.editFieldsInfo,s=i&&i.creatorField,n=i&&i.editorField;return t&&t.map((t=>(t=I$.fromJSON(t),this._fixTemplates(t.templates,s),this._fixTemplates(t.templates,n),t)))}set url(t){const e=rF({layer:this,url:t,nonStandardUrlAllowed:!0,logger:rz});this._set("url",e.url),null!=e.layerId&&this._set("layerId",e.layerId)}writeUrl(t,e,i,s){oF(this,t,null,e,s)}readVersion(t,e){return e.currentVersion?e.currentVersion:e.hasOwnProperty("capabilities")||e.hasOwnProperty("drawingInfo")||e.hasOwnProperty("hasAttachments")||e.hasOwnProperty("htmlPopupType")||e.hasOwnProperty("relationships")||e.hasOwnProperty("timeInfo")||e.hasOwnProperty("typeIdField")||e.hasOwnProperty("types")?10:9.3}readVisible(t,e){return e.layerDefinition&&null!=e.layerDefinition.defaultVisibility?!!e.layerDefinition.defaultVisibility:null!=e.visibility?!!e.visibility:void 0}addAttachment(t,e){return this.load().then((()=>this._checkAttachmentSupport(t))).then((()=>{if(!("addAttachment"in this.source))throw new Ve(nz,"Layer source does not support addAttachment capability");return this.source.addAttachment(t,e)}))}updateAttachment(t,e,i){return this.load().then((()=>this._checkAttachmentSupport(t))).then((()=>{if(!("updateAttachment"in this.source))throw new Ve(nz,"Layer source does not support updateAttachment capability");return this.source.updateAttachment(t,e,i)}))}async applyEdits(t,e){const i=await import("./p-8d1e1055.js");return await this.load(),i.applyEdits(this,this.source,t,e)}on(t,e){return super.on(t,e)}createPopupTemplate(t){return H$(this,t)}async createGraphicsSource(t){if(this._hasMemorySource())return this.source.load({signal:t});const{default:e}=await es(import("./p-2b4c3232.js"),t);return new e({layer:this}).load({signal:t})}createQuery(){const t=new SE,e=this.get("capabilities.data");t.dynamicDataSource=this.dynamicDataSource,t.gdbVersion=this.gdbVersion,t.historicMoment=this.historicMoment,t.returnGeometry=!0,e&&(e.supportsZ&&null!=this.returnZ&&(t.returnZ=this.returnZ),e.supportsM&&null!=this.returnM&&(t.returnM=this.returnM)),t.outFields=["*"],t.where=this.definitionExpression||"1=1";const{timeOffset:i,timeExtent:s}=this;return t.timeExtent=null!=i&&null!=s?s.offset(-i.value,i.unit):s||null,t.multipatchOption="multipatch"===this.geometryType?"xyFootprint":null,t}deleteAttachments(t,e){return this.load().then((()=>this._checkAttachmentSupport(t))).then((()=>{if(!("deleteAttachments"in this.source))throw new Ve(nz,"Layer source does not support deleteAttachments capability");return this.source.deleteAttachments(t,e)}))}fetchRecomputedExtents(t){return this.load({signal:null==t?void 0:t.signal}).then((()=>{if(this.source.fetchRecomputedExtents)return this.source.fetchRecomputedExtents(t);throw new Ve(nz,"Layer source does not support fetchUpdates capability")}))}getFeatureType(t){const{typeIdField:e,types:i}=this;if(!e||!t)return null;const s=t.attributes?t.attributes[e]:void 0;if(null==s)return null;let n=null;return i.some((t=>{const{id:e}=t;return null!=e&&(""+e==""+s&&(n=t),!!n)})),n}getFieldDomain(t,e){const i=this.getFeatureType(e&&e.feature);if(i){const e=i.domains&&i.domains[t];if(e&&"inherited"!==e.type)return e}return this._getLayerDomain(t)}getField(t){return this.fieldsIndex.get(t)}queryAttachments(t,e){return t=SC.from(t),this.load().then((()=>{if(!this.get("capabilities.data.supportsAttachment"))throw new Ve(nz,"this layer doesn't support attachments");const{attachmentTypes:e,objectIds:i,globalIds:s,num:n,size:r,start:o,where:a}=t;if(!this.get("capabilities.operations.supportsQueryAttachments")){const l=e&&e.length,u=s&&s.length,c=r&&r.length;if(i&&i.length>1||l||u||c||n||o||a)throw new Ve(nz,"when 'supportsQueryAttachments' is false, only objectIds of length 1 are supported",t)}if(!(i&&i.length||a))throw new Ve(nz,"'objectIds' or 'where' are required to perform attachment query",t);if(!("queryAttachments"in this.source))throw new Ve(nz,"Layer source does not support queryAttachments capability",t);return this.source.queryAttachments(t)}))}queryFeatures(t,e){return this.load().then((()=>this.source.queryFeatures(SE.from(t)||this.createQuery(),e))).then((t=>{if(null!=t&&t.features)for(const e of t.features)e.layer=e.sourceLayer=this;return t}))}queryObjectIds(t,e){return this.load().then((()=>{if(this.source.queryObjectIds)return this.source.queryObjectIds(SE.from(t)||this.createQuery(),e);throw new Ve(nz,"Layer source does not support queryObjectIds capability")}))}queryFeatureCount(t,e){return this.load().then((()=>{if(this.source.queryFeatureCount)return this.source.queryFeatureCount(SE.from(t)||this.createQuery(),e);throw new Ve(nz,"Layer source does not support queryFeatureCount capability")}))}queryExtent(t,e){return this.load().then((()=>{if(this.source.queryExtent)return this.source.queryExtent(SE.from(t)||this.createQuery(),e);throw new Ve(nz,"Layer source does not support queryExtent capability")}))}queryRelatedFeatures(t,e){return this.load().then((()=>{if("queryRelatedFeatures"in this.source)return this.source.queryRelatedFeatures(IE.from(t),e);throw new Ve(nz,"Layer source does not support queryRelatedFeatures capability")}))}queryRelatedFeaturesCount(t,e){return this.load().then((()=>{if("queryRelatedFeaturesCount"in this.source)return this.source.queryRelatedFeaturesCount(IE.from(t),e);throw new Ve(nz,"Layer source does not support queryRelatedFeaturesCount capability")}))}queryTopFeatures(t,e){return this.load().then((()=>{if("queryTopFeatures"in this.source&&this.get("capabilities.query.supportsTopFeaturesQuery"))return this.source.queryTopFeatures(hN.from(t),e).then((t=>{if(null!=t&&t.features)for(const e of t.features)e.layer=e.sourceLayer=this;return t}));throw new Ve(nz,"Layer source does not support queryTopFeatures capability")}))}queryTopObjectIds(t,e){return this.load().then((()=>{if("queryTopObjectIds"in this.source&&this.get("capabilities.query.supportsTopFeaturesQuery"))return this.source.queryTopObjectIds(hN.from(t),e);throw new Ve(nz,"Layer source does not support queryTopObjectIds capability")}))}queryTopFeaturesExtent(t,e){return this.load().then((()=>{if("queryTopExtents"in this.source&&this.get("capabilities.query.supportsTopFeaturesQuery"))return this.source.queryTopExtents(hN.from(t),e);throw new Ve(nz,"Layer source does not support queryTopExtents capability")}))}queryTopFeatureCount(t,e){return this.load().then((()=>{if("queryTopCount"in this.source&&this.get("capabilities.query.supportsTopFeaturesQuery"))return this.source.queryTopCount(hN.from(t),e);throw new Ve(nz,"Layer source does not support queryFeatureCount capability")}))}read(t,e){const i=t.featureCollection;if(i){const t=i.layers;t&&1===t.length&&(super.read(t[0],e),null!=i.showLegend&&super.read({showLegend:i.showLegend},e))}super.read(t,e),e&&"service"===e.origin&&this.revert(["objectIdField","fields","timeInfo","spatialReference"],"service")}write(t,e){var i,s;const n=(e={...e,writeLayerSchema:null!=(i=null==(s=e)?void 0:s.writeLayerSchema)?i:this._hasMemorySource()}).origin,r=e.layerContainerType,o=e.messages;if(this.isTable){if("web-scene"===n||"web-map"===n&&"tables"!==r)return o&&o.push(new Ve("layer:unsupported",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a Table source cannot be written to web scenes and web maps`,{layer:this})),null;if(this._hasMemorySource())return o&&o.push(new Ve("layer:unsupported",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using an in-memory Table source cannot be written to web scenes and web maps`,{layer:this})),null}else if(this.loaded&&"web-map"===n&&"tables"===r)return o&&o.push(new Ve("layer:unsupported",`Layer (${this.title}, ${this.id}) of type '${this.declaredClass}' using a non-table source cannot be written to tables in web maps`,{layer:this})),null;return super.write(t,e)}_readEditingEnabled(t,e,i){var s;let n=null==(s=t.layerDefinition)?void 0:s.capabilities;return n?this._hasEditingCapability(n):(n=t.capabilities,e&&"web-map"===(null==i?void 0:i.origin)&&!this._hasMemorySource()&&n?this._hasEditingCapability(n):void 0)}_hasEditingCapability(t){return t.toLowerCase().split(",").map((t=>t.trim())).includes("editing")}_writeEditingEnabled(t,e,i,s){if(!t){var n,r;const t=null!=(n=this.capabilities)&&null!=(r=n.operations)&&r.supportsSync?"Query,Sync":"Query";K("layerDefinition.capabilities",t,e),!i||null!=s&&s.writeLayerSchema||(e.capabilities=t)}}_checkAttachmentSupport(t){const{attributes:e}=t,{objectIdField:i}=this;return this.get("capabilities.data.supportsAttachment")?t?e?e[i]?void 0:Promise.reject(new Ve(nz,"feature is missing the identifying attribute "+i)):Promise.reject(new Ve(nz,"'attributes' are required on a feature to query attachments")):Promise.reject(new Ve(nz,"A feature is required to add/delete/update attachments")):Promise.reject(new Ve(nz,"this layer doesn't support attachments"))}_getLayerDomain(t){const e=this.fieldsIndex.get(t);return e?e.domain:null}_fetchFirstLayerId(t){return $n(this.url,{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:t}).then((t=>{const e=t.data;if(e)return Array.isArray(e.layers)&&e.layers.length>0?e.layers[0].id:Array.isArray(e.tables)&&e.tables.length>0?e.tables[0].id:void 0}))}async _initLayerProperties(t){return this._set("source",t),t.sourceJSON&&(this.sourceJSON=t.sourceJSON,this.read(t.sourceJSON,{origin:"service",url:this.parsedUrl})),this._verifySource(),this._verifyFields(),py(this.renderer,this.fieldsIndex),yy(this.timeInfo,this.fieldsIndex),q$(this,{origin:"service"})}async hasDataChanged(){var t;if(null!=(t=this.source)&&t.refresh)try{var e;const{dataChanged:t,updates:i}=await(null==(e=this.source)?void 0:e.refresh());if(u(i)&&(this.sourceJSON={...this.sourceJSON,...i},this.read(i,{origin:"service",url:this.parsedUrl})),t)return!0}catch{}if(this.definitionExpression)try{return(await async function(t,e){const{WhereClause:i}=await import("./p-8ec48dc4.js");return i.create(t,e)}(this.definitionExpression,this.fieldsIndex)).hasDateFunctions}catch{}return!1}_verifyFields(){const t=this.parsedUrl&&this.parsedUrl.path||"undefined";this.objectIdField||console.log("FeatureLayer: 'objectIdField' property is not defined (url: "+t+")"),this.isTable||this._hasMemorySource()||-1!==t.search(/\/FeatureServer\//i)||this.fields&&this.fields.some((function(t){return"geometry"===t.type}))||console.log("FeatureLayer: unable to find field of type 'geometry' in the layer 'fields' list. If you are using a map service layer, features will not have geometry (url: "+t+")")}_fixTemplates(t,e){t&&t.forEach((t=>{const i=t.prototype&&t.prototype.attributes;i&&e&&delete i[e]}))}_verifySource(){if(this._hasMemorySource()){if(this.url)throw new Ve("feature-layer:mixed-source-and-url","FeatureLayer cannot be created with both an in-memory source and a url")}else if(!this.url)throw new Ve("feature-layer:source-or-url-required","FeatureLayer requires either a url, a valid portal item or a source")}_initMemorySource(t){t.forEach((t=>{t.layer=this,t.sourceLayer=this})),this._handles.add([t.on("after-add",(t=>{t.item.layer=this,t.item.sourceLayer=this})),t.on("after-remove",(t=>{t.item.layer=null,t.item.sourceLayer=null}))],"fl-source")}_resetMemorySource(t){t.forEach((t=>{t.layer=null,t.sourceLayer=null})),this._handles.remove("fl-source")}_hasMemorySource(){return!(this.url||!this.source)}_readAttachmentCapabilities(t){const e={supportsName:!1,supportsSize:!1,supportsContentType:!1,supportsKeywords:!1,supportsExifInfo:!1};return t&&Array.isArray(t)&&t.forEach((t=>{const i=sz[t.name];i&&(e[i]=!!t.isEnabled)})),e}_readDataCapabilities(t){return{isVersioned:az(t,"isDataVersioned",!1),supportsAttachment:az(t,"hasAttachments",!1),supportsM:az(t,"hasM",!1),supportsZ:az(t,"hasZ",!1)}}_readMetadataCapabilities(t){return{supportsAdvancedFieldProperties:az(t,"supportsFieldDescriptionProperty",!1)}}_readOperationsCapabilities(t,e){const i=t?t.toLowerCase().split(",").map((t=>t.trim())):[],s=i.includes("editing")&&!e.datesInUnknownTimezone;let n=s&&i.includes("create"),r=s&&i.includes("delete"),o=s&&i.includes("update");const a=i.includes("changetracking");return s&&!(n||r||o)&&(n=r=o=!0),{supportsCalculate:az(e,"supportsCalculate",!1),supportsTruncate:az(e,"supportsTruncate",!1),supportsValidateSql:az(e,"supportsValidateSql",!1),supportsAdd:n,supportsDelete:r,supportsEditing:s,supportsChangeTracking:a,supportsQuery:i.includes("query"),supportsQueryAttachments:az(e.advancedQueryCapabilities,"supportsQueryAttachments",!1),supportsResizeAttachments:az(e,"supportsAttachmentsResizing",!1),supportsSync:i.includes("sync"),supportsUpdate:o,supportsExceedsLimitStatistics:az(e,"supportsExceedsLimitStatistics",!1)}}_readQueryCapabilities(t){var e;const i=t.advancedQueryCapabilities,s=t.ownershipBasedAccessControlForFeatures,n=t.archivingInfo,r=null==(e=this.url)?void 0:e.includes("MapServer"),o=!l("mapserver-pbf-enabled")&&r&&this.version<10.81,a=(t.supportedQueryFormats||"").split(",").reduce(((t,e)=>{const i=e.toLowerCase().trim();return i&&t.add(i),t}),new Set);return{supportsStatistics:az(i,"supportsStatistics",t.supportsStatistics),supportsPercentileStatistics:az(i,"supportsPercentileStatistics",!1),supportsCentroid:az(i,"supportsReturningGeometryCentroid",!1),supportsDistance:az(i,"supportsQueryWithDistance",!1),supportsDistinct:az(i,"supportsDistinct",t.supportsAdvancedQueries),supportsExtent:az(i,"supportsReturningQueryExtent",!1),supportsGeometryProperties:az(i,"supportsReturningGeometryProperties",!1),supportsHavingClause:az(i,"supportsHavingClause",!1),supportsOrderBy:az(i,"supportsOrderBy",t.supportsAdvancedQueries),supportsPagination:az(i,"supportsPagination",!1),supportsQuantization:az(t,"supportsCoordinatesQuantization",!1),supportsQuantizationEditMode:az(t,"supportsQuantizationEditMode",!1),supportsQueryGeometry:az(t,"supportsReturningQueryGeometry",!1),supportsResultType:az(i,"supportsQueryWithResultType",!1),supportsMaxRecordCountFactor:az(i,"supportsMaxRecordCountFactor",!1),supportsSqlExpression:az(i,"supportsSqlExpression",!1),supportsStandardizedQueriesOnly:az(t,"useStandardizedQueries",!1),supportsTopFeaturesQuery:az(i,"supportsTopFeaturesQuery",!1),supportsQueryByOthers:az(s,"allowOthersToQuery",!0),supportsHistoricMoment:az(n,"supportsQueryWithHistoricMoment",!1),supportsFormatPBF:!o&&a.has("pbf"),supportsDisjointSpatialRelationship:az(i,"supportsDisjointSpatialRel",!1),supportsCacheHint:az(i,"supportsQueryWithCacheHint",!1),maxRecordCountFactor:lz(t,"maxRecordCountFactor",void 0),maxRecordCount:lz(t,"maxRecordCount",void 0),standardMaxRecordCount:lz(t,"standardMaxRecordCount",void 0),tileMaxRecordCount:lz(t,"tileMaxRecordCount",void 0)}}_readQueryRelatedCapabilities(t){const e=t.advancedQueryCapabilities,i=az(e,"supportsAdvancedQueryRelated",!1);return{supportsPagination:az(e,"supportsQueryRelatedPagination",!1),supportsCount:i,supportsOrderBy:i}}_readEditingCapabilities(t){const e=t.ownershipBasedAccessControlForFeatures;return{supportsGeometryUpdate:az(t,"allowGeometryUpdates",!0),supportsGlobalId:az(t,"supportsApplyEditsWithGlobalIds",!1),supportsReturnServiceEditsInSourceSpatialReference:az(t,"supportsReturnServiceEditsInSourceSR",!1),supportsRollbackOnFailure:az(t,"supportsRollbackOnFailureParameter",!1),supportsUpdateWithoutM:az(t,"allowUpdateWithoutMValues",!1),supportsUploadWithItemId:az(t,"supportsAttachmentsByUploadId",!1),supportsDeleteByAnonymous:az(e,"allowAnonymousToDelete",!0),supportsDeleteByOthers:az(e,"allowOthersToDelete",!0),supportsUpdateByAnonymous:az(e,"allowAnonymousToUpdate",!0),supportsUpdateByOthers:az(e,"allowOthersToUpdate",!0)}}};e([oe({readOnly:!0,json:{read:!1}})],hz.prototype,"capabilities",void 0),e([Sd("service","capabilities",["advancedQueryCapabilities","allowGeometryUpdates","allowUpdateWithoutMValues","archivingInfo","capabilities","datesInUnknownTimezone","hasAttachments","hasM","hasZ","maxRecordCount","maxRecordCountFactor","ownershipBasedAccessControlForFeatures","standardMaxRecordCount","supportedQueryFormats","supportsAdvancedQueries","supportsApplyEditsWithGlobalIds","supportsAttachmentsByUploadId","supportsAttachmentsResizing","supportsCalculate","supportsCoordinatesQuantization","supportsExceedsLimitStatistics","supportsFieldDescriptionProperty","supportsQuantizationEditMode","supportsRollbackOnFailureParameter","supportsStatistics","supportsTruncate","supportsValidateSql","tileMaxRecordCount","useStandardizedQueries"])],hz.prototype,"readCapabilities",null),e([oe({json:{origins:{"portal-item":{write:!0},"web-map":{write:!0}}}})],hz.prototype,"charts",void 0),e([oe({readOnly:!0})],hz.prototype,"createQueryVersion",null),e([oe({type:String,json:{read:{source:"layerDefinition.copyrightText"},origins:{service:{read:{source:"copyrightText"}}}}})],hz.prototype,"copyright",void 0),e([oe({type:Boolean})],hz.prototype,"datesInUnknownTimezone",void 0),e([oe({type:String,json:{read:{source:"layerDefinition.displayField"},origins:{service:{read:{source:"displayField"}}}}})],hz.prototype,"displayField",void 0),e([oe({type:String,json:{origins:{service:{read:!1,write:!1}},name:"layerDefinition.definitionExpression",write:{enabled:!0,allowNull:!0}}})],hz.prototype,"definitionExpression",void 0),e([oe({types:qb,readOnly:!0})],hz.prototype,"defaultSymbol",void 0),e([oe({type:uE})],hz.prototype,"dynamicDataSource",void 0),e([oe({readOnly:!0})],hz.prototype,"editFieldsInfo",void 0),e([oe({type:Boolean})],hz.prototype,"editingEnabled",null),e([Sd(["portal-item","web-scene"],"editingEnabled",["layerDefinition.capabilities"])],hz.prototype,"readEditingEnabled",null),e([Sd("web-map","editingEnabled",["capabilities","layerDefinition.capabilities"])],hz.prototype,"readEditingEnabledFromWebMap",null),e([xd(["portal-item","web-scene"],"editingEnabled",{"layerDefinition.capabilities":{type:String}})],hz.prototype,"writeEditingEnabled",null),e([xd("web-map","editingEnabled",{capabilities:{type:String},"layerDefinition.capabilities":{type:String}})],hz.prototype,"writeEditingEnabledToWebMap",null),e([oe({readOnly:!0})],hz.prototype,"editingInfo",void 0),e([Sd("editingInfo")],hz.prototype,"readEditingInfo",null),e([oe(ax)],hz.prototype,"elevationInfo",void 0),e([oe(b$)],hz.prototype,"featureReduction",void 0),e([oe({...uz.fields,json:{read:{source:"layerDefinition.fields"},origins:{service:{name:"fields"},"web-map":{write:{target:"layerDefinition.fields",overridePolicy:cz}}}}})],hz.prototype,"fields",void 0),e([oe(uz.fieldsIndex)],hz.prototype,"fieldsIndex",void 0),e([oe({type:V$,json:{read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo"}}})],hz.prototype,"floorInfo",void 0),e([oe({type:_D,json:{name:"formInfo",write:!0,origins:{"web-scene":{read:!1,write:!1}}}})],hz.prototype,"formTemplate",void 0),e([oe({type:of,json:{origins:{service:{read:{source:"extent"}}},read:{source:"layerDefinition.extent"}}})],hz.prototype,"fullExtent",void 0),e([oe()],hz.prototype,"gdbVersion",void 0),e([oe({readOnly:!0,type:E$,json:{read:{source:"geometryProperties"}}})],hz.prototype,"geometryFieldsInfo",void 0),e([oe({type:["point","polygon","polyline","multipoint","multipatch","mesh"],json:{origins:{service:{read:iz.read},"web-map":{write:{target:"layerDefinition.geometryType",overridePolicy:cz,writer(t,e,i){const s=t?iz.toJSON(t):null;s&&K(i,s,e)}}}},read:{source:"layerDefinition.geometryType",reader:iz.read}}})],hz.prototype,"geometryType",void 0),e([oe({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasM"}}})],hz.prototype,"hasM",void 0),e([oe({type:Boolean,json:{origins:{service:{read:!0}},read:{source:"layerDefinition.hasZ"}}})],hz.prototype,"hasZ",void 0),e([oe({readOnly:!0,type:ED})],hz.prototype,"heightModelInfo",void 0),e([oe({type:Date})],hz.prototype,"historicMoment",void 0),e([oe(px)],hz.prototype,"id",void 0),e([oe({readOnly:!0,json:{origins:{service:{read:!0}},read:!1}})],hz.prototype,"infoFor3D",void 0),e([oe({readOnly:!0,json:{origins:{"web-map":{write:{target:"layerDefinition.type"}}}}})],hz.prototype,"isTable",void 0),e([Sd("service","isTable",["type","geometryType"]),Sd("isTable",["layerDefinition.type","layerDefinition.geometryType"])],hz.prototype,"readIsTable",null),e([xd("web-map","isTable")],hz.prototype,"writeIsTable",null),e([oe(nx)],hz.prototype,"labelsVisible",void 0),e([oe({type:[p$],json:{origins:{service:{read:{source:"drawingInfo.labelingInfo",reader:L$},write:{target:"drawingInfo.labelingInfo",enabled:!1}}},read:{source:"layerDefinition.drawingInfo.labelingInfo",reader:L$},write:{target:"layerDefinition.drawingInfo.labelingInfo"}}})],hz.prototype,"labelingInfo",void 0),e([oe(cx)],hz.prototype,"opacity",void 0),e([oe({type:Number,json:{origins:{service:{read:{source:"id"}}},read:!1}})],hz.prototype,"layerId",void 0),e([oe(ox)],hz.prototype,"legendEnabled",void 0),e([oe({type:["show","hide"]})],hz.prototype,"listMode",void 0),e([oe(fx)],hz.prototype,"minScale",void 0),e([Sd("service","minScale",["minScale","effectiveMinScale"])],hz.prototype,"readMinScale",null),e([oe(yx)],hz.prototype,"maxScale",void 0),e([Sd("service","maxScale",["maxScale","effectiveMaxScale"])],hz.prototype,"readMaxScale",null),e([oe({type:String})],hz.prototype,"globalIdField",void 0),e([Sd("globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"]),Sd("service","globalIdField",["globalIdField","fields"])],hz.prototype,"readGlobalIdFieldFromService",null),e([oe({type:String,json:{origins:{"web-map":{write:{target:"layerDefinition.objectIdField",overridePolicy:cz}}}}})],hz.prototype,"objectIdField",void 0),e([Sd("objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"]),Sd("service","objectIdField",["objectIdField","fields"])],hz.prototype,"readObjectIdFieldFromService",null),e([oe({value:"ArcGISFeatureLayer",type:["ArcGISFeatureLayer"]})],hz.prototype,"operationalLayerType",void 0),e([oe(uz.outFields)],hz.prototype,"outFields",void 0),e([oe({readOnly:!0})],hz.prototype,"parsedUrl",null),e([oe({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],hz.prototype,"path",void 0),e([oe(sx)],hz.prototype,"popupEnabled",void 0),e([oe({type:lj,json:{name:"popupInfo",write:!0}})],hz.prototype,"popupTemplate",void 0),e([oe({readOnly:!0})],hz.prototype,"defaultPopupTemplate",null),e([oe({type:[U$],readOnly:!0})],hz.prototype,"relationships",void 0),e([oe({types:rT,json:{origins:{service:{write:{target:"drawingInfo.renderer",enabled:!1}},"web-scene":{types:oT,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:(t,e,i)=>({ignoreOrigin:null==i?void 0:i.writeLayerSchema})}}},write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:(t,e,i)=>({ignoreOrigin:null==i?void 0:i.writeLayerSchema})}}})],hz.prototype,"renderer",null),e([Sd("service","renderer",["drawingInfo.renderer","defaultSymbol"]),Sd("renderer",["layerDefinition.drawingInfo.renderer","layerDefinition.defaultSymbol"])],hz.prototype,"readRenderer",null),e([oe()],hz.prototype,"sourceJSON",void 0),e([oe({type:Boolean})],hz.prototype,"returnM",void 0),e([oe({type:Boolean})],hz.prototype,"returnZ",void 0),e([oe(ix)],hz.prototype,"screenSizePerspectiveEnabled",void 0),e([oe()],hz.prototype,"source",null),e([ba("source")],hz.prototype,"castSource",null),e([Sd("portal-item","source",["featureSet"]),Sd("web-map","source",["featureSet"])],hz.prototype,"readSource",null),e([oe({readOnly:!0})],hz.prototype,"serviceDefinitionExpression",void 0),e([Sd("service","serviceDefinitionExpression",["definitionQuery","definitionExpression"])],hz.prototype,"readServiceDefinitionExpression",null),e([oe({type:ap,json:{origins:{service:{read:{source:"extent.spatialReference"}}},read:{source:"layerDefinition.extent.spatialReference"}}})],hz.prototype,"spatialReference",void 0),e([oe({type:Number})],hz.prototype,"subtypeCode",void 0),e([oe({type:[x$]})],hz.prototype,"templates",void 0),e([Sd("templates",["editFieldsInfo","creatorField","editorField","templates"])],hz.prototype,"readTemplates",null),e([oe({type:kV})],hz.prototype,"timeInfo",void 0),e([oe()],hz.prototype,"title",void 0),e([Sd("service","title",["name"]),Sd("portal-item","title",["layerDefinition.title","layerDefinition.name","title"])],hz.prototype,"readTitle",null),e([Sd("web-map","title",["layerDefinition.name","title"])],hz.prototype,"readTitleFromWebMap",null),e([oe({type:String})],hz.prototype,"sublayerTitleMode",void 0),e([oe({type:String,json:{read:{source:"timeInfo.trackIdField"}}})],hz.prototype,"trackIdField",void 0),e([oe({json:{read:!1}})],hz.prototype,"type",void 0),e([oe({type:String})],hz.prototype,"typeIdField",void 0),e([Sd("service","typeIdField"),Sd("typeIdField",["layerDefinition.typeIdField"])],hz.prototype,"readTypeIdField",null),e([oe({type:[I$]})],hz.prototype,"types",void 0),e([Sd("service","types",["types"]),Sd("types",["layerDefinition.types"])],hz.prototype,"readTypes",null),e([oe({readOnly:!0,json:{write:!1}})],hz.prototype,"serverGens",void 0),e([oe({type:qo.ofType(_V),readOnly:!0})],hz.prototype,"indexes",void 0),e([oe(rx)],hz.prototype,"url",null),e([xd("url")],hz.prototype,"writeUrl",null),e([oe({readOnly:!0})],hz.prototype,"userIsAdmin",void 0),e([oe({json:{origins:{service:{read:!0}},read:!1}})],hz.prototype,"version",void 0),e([Sd("service","version",["currentVersion","capabilities","drawingInfo","hasAttachments","htmlPopupType","relationships","timeInfo","typeIdField","types"])],hz.prototype,"readVersion",null),e([oe({type:Boolean,json:{origins:{"portal-item":{write:{target:"layerDefinition.defaultVisibility"}}}}})],hz.prototype,"visible",void 0),e([Sd("portal-item","visible",["visibility","layerDefinition.defaultVisibility"])],hz.prototype,"readVisible",null),hz=e([si("esri.layers.FeatureLayer")],hz);const dz=Oe({types:Hb}),pz=hz,fz=Object.freeze({__proto__:null,default:pz}),yz=["$datastore","$map","$layer","$aggregatedfeatures"],mz=ct.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils");async function gz({graphic:t,view:e}){const{isAggregate:i,layer:s}=t;if(!i||!s||"2d"!==(null==e?void 0:e.type))return[];const n=await e.whenLayerView(s);if(!n.createQuery||!n.queryFeatures)return[];const r=n.createQuery();r.aggregateIds=[t.getObjectId()];const{features:o}=await n.queryFeatures(r);return o}async function vz({expressionAttributes:t,info:e,arcadeUtils:i,interceptor:s,spatialReference:n,map:r,graphic:o,view:a}){const l="expression/"+e.name,u=i.createSyntaxTree(e.expression),c=yz.filter((t=>i.hasVariable(u,t))),[h]=await Bi([gz({graphic:o,view:a}),i.loadScriptDependencies(u,!0,c)]),d=i.getViewInfo({spatialReference:n}),p=i.createExecContext(o,d);p.interceptor=s,p.useAsync=!0,function({aggregatedFeatures:t,arcadeUtils:e,featureSetVars:i,context:s,viewInfo:n,map:r,graphic:o,interceptor:a}){i.forEach((i=>{const l=i.toLowerCase();if("$map"===l&&(s.vars[l]=e.convertMapToFeatureSetCollection({map:r,spatialReference:n.sr,interceptor:a})),"$layer"===l&&(s.vars[l]=e.convertFeatureLayerToFeatureSet({layer:o.sourceLayer,spatialReference:n.sr,interceptor:a})),"$datastore"===l&&(s.vars[l]=e.convertServiceUrlToWorkspace({url:o.sourceLayer.url,spatialReference:n.sr,interceptor:a})),"$aggregatedfeatures"===l){const i=o.layer,{fields:r,objectIdField:u,geometryType:c,spatialReference:h,displayField:d}=i,p=new pz({fields:r,objectIdField:u,geometryType:c,spatialReference:h,displayField:d,..."feature"===i.type?{templates:i.templates,typeIdField:i.typeIdField,types:i.types}:null,source:t});s.vars[l]=e.convertFeatureLayerToFeatureSet({layer:p,spatialReference:n.sr,interceptor:a})}}))}({aggregatedFeatures:h,arcadeUtils:i,featureSetVars:c,context:p,viewInfo:d,map:r,graphic:o,interceptor:s});const f=i.createFunction(u,p),y=await i.executeAsyncFunction(f,p).catch((t=>mz.error("arcade-execution-error",{error:t,graphic:o,expressionInfo:e})));t[l]="string"==typeof y?QC(ZC(y)):Array.isArray(y)?function(t){return`<ul class="esri-widget__list">${t.map((t=>`<li>${"string"==typeof t?QC(ZC(t)):t}</li>`)).join("")}</ul>`}(y):y&&"esri.arcade.Dictionary"===y.declaredClass?function(t){return`<table class="esri-widget__table">${t.keys().map((e=>{const i=t.field(e);return`<tr><th>${e}</th><td>${"string"==typeof i?QC(ZC(i)):i}</td></tr>`})).join("")}</table>`}(y):y}async function wz({popupTemplate:t,spatialReference:e,graphic:i,interceptor:s,map:n,view:r}){const o=t.expressionInfos,a=[],l={};if(!o||!o.length)return l;const u=await import("./p-b7e07897.js").then((function(t){return t.as}));for(const t of o)a.push(vz({expressionAttributes:l,info:t,arcadeUtils:u,interceptor:s,spatialReference:e,map:n,graphic:i,view:r}));return await rs(a),l}var bz;const Mz="esri.widgets.FeatureViewModel",Sz=ct.getLogger(Mz),xz={attachmentsContent:!0,customContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0};let kz=bz=class extends jo{constructor(t){super(t),this._handles=new Wo,this._error=null,this._featureAbortController=null,this.graphicChangedThrottled=fC(this.graphicChanged,1,this),this._expressionAttributes=null,this.abilities={...xz},this.content=null,this.contentViewModels=[],this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=t=>{const{abilities:e}=this;return"attachments"===t.type&&e.attachmentsContent||"custom"===t.type&&e.customContent||"fields"===t.type&&e.fieldsContent||"media"===t.type&&e.mediaContent||"text"===t.type&&e.textContent},this._handles.add(Xo(this,["graphic","_effectivePopupTemplate","abilities"],(()=>this.graphicChangedThrottled())))}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear()}get _effectivePopupTemplate(){return u(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return function(t,e){const i=new Map;return t&&t.forEach((t=>{const s=VC(t.fieldName,e);t.fieldName=s,i.set(s.toLowerCase(),t)})),i}(JC(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return EC(this.graphic)}castAbilities(t){return{...xz,...t}}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(t){this._set("graphic",t?t.clone():null)}get spatialReference(){return this.get("view.spatialReference")||null}set spatialReference(t){void 0!==t?this._override("spatialReference",t):this._clearOverride("spatialReference")}get map(){return this.get("view.map")||null}set map(t){void 0!==t?this._override("map",t):this._clearOverride("map")}get waitingForContent(){return!!this._featureAbortController}setActiveMedia(t,e){const i=this.contentViewModels[t];i instanceof vN&&i.setActiveMedia(e)}nextMedia(t){const e=this.contentViewModels[t];e instanceof vN&&e.next()}previousMedia(t){const e=this.contentViewModels[t];e instanceof vN&&e.previous()}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null)}async graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:t}=this;if(!t)return;const e=new AbortController;this._featureAbortController=e;try{await this._queryFeature({signal:e.signal})}catch(e){is(e)||(this._error=e,Sz.error("error","The popupTemplate could not be displayed for this feature.",{error:e,graphic:t,popupTemplate:this._effectivePopupTemplate}))}this._featureAbortController===e&&(this._featureAbortController=null)}_cancelFeatureQuery(){const{_featureAbortController:t}=this;t&&t.abort(),this._featureAbortController=null}_compileContent(t){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(t)?t.filter(this._isAllowedContentType).map(((t,e)=>"attachments"===t.type?this._compileAttachments(t,e):"custom"===t.type?this._compileCustom(t,e):"fields"===t.type?this._compileFields(t,e):"media"===t.type?this._compileMedia(t,e):"text"===t.type?this._compileText(t,e):void 0)):"string"==typeof t?this._compileText(new OI({text:t}),0).text:t}_destroyContentViewModels(){this.contentViewModels.forEach((t=>t&&!t.destroyed&&t.destroy())),this._set("contentViewModels",[])}_compileAttachments(t,e){const{graphic:i}=this,{description:s,title:n}=t;return this.contentViewModels[e]=new hP({graphic:i,...this._compileTitleAndDesc({title:n,description:s})}),t}_compileCustom(t,e){const{graphic:i}=this,{creator:s,destroyer:n}=t;return this.contentViewModels[e]=new gP({graphic:i,creator:s,destroyer:n}),t}_compileTitleAndDesc({title:t,description:e}){const{_fieldInfoMap:i,_sourceLayer:s,graphic:n,formattedAttributes:r,_expressionAttributes:o}=this,{attributes:a}=n,l=r.global;return{title:GC({attributes:a,fieldInfoMap:i,globalAttributes:l,expressionAttributes:o,layer:s,text:t}),description:GC({attributes:a,fieldInfoMap:i,globalAttributes:l,expressionAttributes:o,layer:s,text:e})}}_compileFields(t,e){const{_effectivePopupTemplate:i,formattedAttributes:s}=this,n=t.clone(),r={...s.global,...s.content[e]},o=(null==t?void 0:t.fieldInfos)||(null==i?void 0:i.fieldInfos),a=null==o?void 0:o.filter((({fieldName:t})=>NC(t)||YC(t)||r.hasOwnProperty(t))),l=null==i?void 0:i.expressionInfos,{description:u,title:c}=n,h=new MP({attributes:r,expressionInfos:l,fieldInfos:a,...this._compileTitleAndDesc({title:c,description:u})});return this.contentViewModels[e]=h,n.fieldInfos=h.formattedFieldInfos.slice(0),n}_compileMedia(t,e){const{graphic:i,_fieldInfoMap:s,_effectivePopupTemplate:n,relatedInfos:r,_sourceLayer:o,_expressionAttributes:a}=this,{attributes:l}=i,u=this.formattedAttributes.global,c=t.clone(),{description:h,mediaInfos:d,title:p}=c,f=new vN({activeMediaInfoIndex:c.activeMediaInfoIndex||0,attributes:l,layer:o,fieldInfoMap:s,formattedAttributes:u,expressionAttributes:a,mediaInfos:d,popupTemplate:n,relatedInfos:r,...this._compileTitleAndDesc({title:p,description:h})});return c.mediaInfos=f.formattedMediaInfos.slice(0),this.contentViewModels[e]=f,c}_compileText(t,e){const i=t.clone(),{graphic:s,_fieldInfoMap:n,_sourceLayer:r,_expressionAttributes:o}=this;if(i&&i.text){const{attributes:t}=s;i.text=GC({attributes:t,fieldInfoMap:n,globalAttributes:this.formattedAttributes.global,expressionAttributes:o,layer:r,text:i.text})}return this.contentViewModels[e]=new gP({graphic:s,creator:i.text}),i}_compileLastEditInfo(){const{_effectivePopupTemplate:t,_sourceLayer:e,graphic:i}=this;if(!t)return;const{lastEditInfoEnabled:s}=t,n=null==e?void 0:e.editFieldsInfo;return s&&n?function(t,e){const{creatorField:i,creationDateField:s,editorField:n,editDateField:r}=t;if(!e)return;const o=e[r];if("number"==typeof o){const t=e[n];return{type:"edit",date:Ai(o,PC),user:t}}const a=e[s];if("number"==typeof a){const t=e[i];return{type:"create",date:Ai(a,PC),user:t}}return null}(n,i.attributes):void 0}_compileTitle(t){const{_fieldInfoMap:e,_sourceLayer:i,graphic:s,_expressionAttributes:n}=this,{attributes:r}=s;return GC({attributes:r,fieldInfoMap:e,globalAttributes:this.formattedAttributes.global,expressionAttributes:n,layer:i,text:t})}async _getTitle(){const{_effectivePopupTemplate:t,graphic:e}=this;return RC(null==t?void 0:t.title,{graphic:e})}async _getContent(){const{_effectivePopupTemplate:t,graphic:e}=this;return RC(null==t?void 0:t.content,{graphic:e})}async _queryFeature(t){const{_featureAbortController:e,_sourceLayer:i,graphic:s,_effectivePopupTemplate:n,spatialReference:r,map:o,view:a}=this,{content:{value:l},title:{value:u}}=await rs({content:this._getContent(),title:this._getTitle()});if(e!==this._featureAbortController||!s)return;await async function({graphic:t,popupTemplate:e,layer:i,spatialReference:s},n){if(!i||!e)return;if("function"==typeof i.load&&await i.load(n),!t.attributes)return;const r=t.attributes[i.objectIdField];if(null==r)return;const o=[r],a=await e.getRequiredFields(i.fieldsIndex),l=Xy(a,t),u=l?[]:a,c=e.returnGeometry||await async function(t){var e;if(null==(e=t.expressionInfos)||!e.length)return!1;const i=await ay(),{arcadeUtils:{hasGeometryFunctions:s}}=i;return s(t)}(e);if(l&&!c)return;const h=await async function(t,e){var i,s;const{layer:n,graphic:r,outFields:o,objectIds:a,returnGeometry:l,spatialReference:u}=t,c=a[0];if("number"!=typeof c&&"string"!=typeof c)return xC.warn("Could not query required fields for the specified feature. The feature's ID is invalid.",{layer:n,graphic:r,objectId:c,requiredFields:o}),null;if(null==(i=n.capabilities)||null==(s=i.operations)||!s.supportsQuery)return xC.warn("The specified layer cannot be queried. The following fields will not be available.",{layer:n,graphic:r,requiredFields:o,returnGeometry:l}),null;const h=n.createQuery();return h.objectIds=a,h.outFields=null!=o&&o.length?o:[n.objectIdField],h.returnGeometry=!!l,h.returnZ=!!l,h.returnM=!!l,h.outSpatialReference=u,(await n.queryFeatures(h,e)).features[0]}({layer:i,graphic:t,outFields:u,objectIds:o,returnGeometry:c,spatialReference:s},n);h&&(h.geometry&&(t.geometry=h.geometry),h.attributes&&(t.attributes={...t.attributes,...h.attributes}))}({graphic:s,popupTemplate:n,layer:i,spatialReference:r},t);const{expressionAttributes:{value:c}}=await rs({checkForRelatedFeatures:this._checkForRelatedFeatures(t),expressionAttributes:wz({popupTemplate:this._effectivePopupTemplate,spatialReference:r,graphic:s,map:o,interceptor:bz.interceptor,view:a})});e===this._featureAbortController&&s&&(this._expressionAttributes=c,this._set("formattedAttributes",this._createFormattedAttributes(l,c)),this._set("title",this._compileTitle(u)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(l)||null))}_createFormattedAttributes(t,e){const{_effectivePopupTemplate:i,graphic:s,relatedInfos:n,_sourceLayer:r,_fieldInfoMap:o}=this,a={...s.attributes,...e},l={global:KC({fieldInfos:null==i?void 0:i.fieldInfos,graphic:s,attributes:a,layer:r,fieldInfoMap:o,relatedInfos:n}),content:[]};return Array.isArray(t)&&t.forEach(((t,e)=>{"fields"===t.type&&t.fieldInfos&&(l.content[e]=KC({fieldInfos:t.fieldInfos,graphic:s,attributes:a,layer:r,fieldInfoMap:o,relatedInfos:n}))})),l}_checkForRelatedFeatures(t){const{graphic:e,_effectivePopupTemplate:i}=this;return this._queryRelatedInfos(e,JC(i),t)}async _queryRelatedInfos(t,e,i){const{relatedInfos:s,_sourceLayer:n}=this;s.clear();const r=u(n.associatedLayer)?await n.associatedLayer.load(i):n;if(!r)return;const o=e.filter((t=>t&&YC(t.fieldName)));if(!o||!o.length)return;e.forEach((t=>this._configureRelatedInfo(t,r)));const a=await function({relatedInfos:t,layer:e},i){const s={};return t.forEach(((t,n)=>{const{relation:r}=t;if(!r){const t=new Ve("relation-required","A relation is required on a layer to retrieve related records.");throw fN.error(t),t}const{relatedTableId:o}=r;if("number"!=typeof o){const t=new Ve("A related table ID is required on a layer to retrieve related records.");throw fN.error(t),t}const a=`${e.url}/${o}`,l=yN.get(a),u=l||function(t,e){return $n(t,{query:{f:"json"},signal:e&&e.signal})}(a,i);l||yN.set(a,u),s[n]=u})),rs(s)}({relatedInfos:s,layer:r},i);Object.keys(a).forEach((t=>{var e;const i=s.get(""+t),n=null==(e=a[t])?void 0:e.value;i&&n&&(i.layerInfo=n.data)}));const l=await function({graphic:t,relatedInfos:e,layer:i},s){const n={};return e.forEach(((e,r)=>{e.layerInfo&&(n[r]=async function(t,e,i,s){const n=""+i.layerId,{layerInfo:r,queryTask:o,relation:a,relatedFields:l,outStatistics:u}=e,c=function({originRelationship:t,relationships:e,layerId:i}){let s;return e&&e.some((e=>(""+e.relatedTableId===i&&e.id===t.id&&(s=e),!!s))),s}({originRelationship:a,relationships:r.relationships,layerId:n});if(c.relationshipTableId&&c.keyFieldInRelationshipTable){const e=(await function(t,e,i,s){const n=new IE;return n.outFields=["*"],n.relationshipId="number"==typeof e.id?e.id:parseInt(e.id,10),n.objectIds=[t.attributes[i.objectIdField]],i.queryRelatedFeatures(n,s)}(t,c,i,s))[t.attributes[i.objectIdField]];if(!e)return null;const n=e.features.map((t=>t.attributes[r.objectIdField]));if((null==u?void 0:u.length)>0&&r.supportsStatistics){const t=new SE;return t.where=function(t,e){let i=0;const s=[];for(;i<e.length;)s.push(`${t} IN (${e.slice(i,1e3+i)})`),i+=1e3;return s.join(" OR ")}(r.objectIdField,n),t.outFields=l,t.outStatistics=u,rs({features:Promise.resolve(e),statsFeatures:o.execute(t)})}}const h=null==c?void 0:c.keyField;if(h){const i=$y(function(t,e){if(null!=t){e=e.toLowerCase();for(const i of t)if(i&&i.name.toLowerCase()===e)return i}return null}(r.fields,h)),n=function(t,e){const i=e.toLowerCase();for(const e in t)if(e.toLowerCase()===i)return t[e];return null}(t.attributes,a.keyField),l=i?`${h}=${n}`:`${h}='${n}'`,u=o.execute(new SE({where:l,outFields:e.relatedFields}),s),c=e.outStatistics&&e.outStatistics.length>0&&r.supportsStatistics?o.execute(new SE({where:l,outFields:e.relatedFields,outStatistics:e.outStatistics}),s):null,d={features:u};return c&&(d.statsFeatures=c),rs(d)}return null}(t,e,i,s))})),rs(n)}({graphic:t,relatedInfos:s,layer:r},i);Object.keys(l).forEach((t=>{var e;!function(t,e){if(!e)return;if(!t)return;const{features:i,statsFeatures:s}=t,n=i&&i.value;e.relatedFeatures=n?n.features:[];const r=s&&s.value;e.relatedStatsFeatures=r?r.features:[]}(null==(e=l[t])?void 0:e.value,s.get(""+t))}))}_configureRelatedInfo(t,e){const{relatedInfos:i}=this,s=mN(t.fieldName);if(!s)return;const{layerId:n,fieldName:r}=s;if(!n)return;const o=i.get(""+n)||function(t,e){const i=function(t,e){if(!e.relationships)return null;let i=null;const{relationships:s}=e;return s.some((e=>e.id===parseInt(t,10)&&(i=e,!0))),i}(t,e);if(!i)return;const s=`${e.url}/${i.relatedTableId}`;return{url:s,queryTask:new pN({url:s,sourceSpatialReference:e.spatialReference}),relation:i,relatedFields:[],outStatistics:[]}}(n,e);o&&(function({relatedInfo:t,fieldName:e,fieldInfo:i}){if(t.relatedFields.push(e),i.statisticType){const s=new gE({statisticType:i.statisticType,onStatisticField:e,outStatisticFieldName:e});t.outStatistics.push(s)}}({relatedInfo:o,fieldName:r,fieldInfo:t}),this.relatedInfos.set(n,o))}};kz.interceptor=new class{constructor(t,e){this.preLayerQueryCallback=t,this.preRequestCallback=e,this.preLayerQueryCallback||(this.preLayerQueryCallback=()=>{}),this.preRequestCallback||(this.preLayerQueryCallback=()=>{})}}((({query:t,layer:e,method:i})=>{eP({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})}),(({queryPayload:t,layer:e,method:i})=>{eP({layer:e,method:i,query:t,definitionExpression:`${e.definitionExpression} ${e.serviceDefinitionExpression}`})})),e([oe()],kz.prototype,"_error",void 0),e([oe()],kz.prototype,"_featureAbortController",void 0),e([oe({readOnly:!0})],kz.prototype,"_effectivePopupTemplate",null),e([oe({readOnly:!0})],kz.prototype,"_fieldInfoMap",null),e([oe({readOnly:!0})],kz.prototype,"_sourceLayer",null),e([oe()],kz.prototype,"abilities",void 0),e([ba("abilities")],kz.prototype,"castAbilities",null),e([oe({readOnly:!0})],kz.prototype,"content",void 0),e([oe({readOnly:!0})],kz.prototype,"contentViewModels",void 0),e([oe({type:Boolean})],kz.prototype,"defaultPopupTemplateEnabled",void 0),e([oe({readOnly:!0})],kz.prototype,"state",null),e([oe({readOnly:!0})],kz.prototype,"formattedAttributes",void 0),e([oe({type:hj,value:null})],kz.prototype,"graphic",null),e([oe({readOnly:!0})],kz.prototype,"lastEditInfo",void 0),e([oe()],kz.prototype,"relatedInfos",void 0),e([oe()],kz.prototype,"spatialReference",null),e([oe({readOnly:!0})],kz.prototype,"title",void 0),e([oe()],kz.prototype,"map",null),e([oe({readOnly:!0})],kz.prototype,"waitingForContent",null),e([oe()],kz.prototype,"view",void 0),kz=bz=e([si(Mz)],kz);const Iz=kz,jz=t=>{let i=class extends t{constructor(){super(...arguments),this.renderNodeContent=t=>Wc(t)&&!t.destroyed?Bc("div",{key:t},t.render()):t instanceof HTMLElement?Bc("div",{key:t,bind:t,afterCreate:this._attachToNode}):Hc(t)?Bc("div",{key:t,bind:t.domNode,afterCreate:this._attachToNode}):null}_attachToNode(t){t.appendChild(this)}};return i=e([si("esri.widgets.Feature.ContentMixin")],i),i},_z="esri-feature__content-element",Tz={title:!0,content:!0,lastEditedInfo:!0};let Oz=class extends(jz(Dc)){constructor(t,e){super(t,e),this._contentWidgets=[],this.graphic=null,this.defaultPopupTemplateEnabled=!1,this.headingLevel=2,this.label=void 0,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.spatialReference=null,this.title=null,this.visibleElements={...Tz},this.map=null,this.view=null,this.viewModel=new Iz}initialize(){this.own(Xo(this,"viewModel.contentViewModels",(()=>this._setupContentWidgets())))}loadDependencies(){return import("./p-187b3976.js")}destroy(){this._destroyContentWidgets()}castVisibleElements(t){return{...Tz,...t}}render(){const{state:t}=this.viewModel,e=Bc("div",{class:"esri-feature__size-container",key:"container"},this.renderTitle(),"error"===t?this.renderError():"loading"===t?this.renderLoading():this.renderContentContainer());return Bc("div",{class:this.classes("esri-feature","esri-widget")},e)}setActiveMedia(t,e){this.viewModel.setActiveMedia(t,e)}nextMedia(t){this.viewModel.nextMedia(t)}previousMedia(t){this.viewModel.previousMedia(t)}renderError(){const{messagesCommon:t,messages:e,visibleElements:i}=this;return Bc("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},i.title?Bc("div",{key:"error-title",slot:"title"},t.errorMessage):null,Bc("div",{key:"error-message",slot:"message"},e.loadingError))}renderLoading(){return Bc("div",{key:"loading-container",class:"esri-feature__loading-container"},Bc("span",{class:this.classes("esri-icon-loading-indicator esri-rotating","esri-feature__loading-spinner")}))}renderContentContainer(){const{visibleElements:t}=this;return t.content?Bc("div",{class:"esri-feature__main-container"},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:t,title:e}=this;return t.title?Bc(wO,{level:this.headingLevel,class:"esri-feature__title",innerHTML:e}):null}renderContent(){const t=this.viewModel.content,e="content";if(!t)return null;if(Array.isArray(t))return t.length?Bc("div",{key:e+"-content-elements"},t.map(this.renderContentElement,this)):null;if("string"==typeof t){const t=this._contentWidgets[0];return!t||t.destroyed?null:Bc("div",{key:e+"-content"},t.render())}return this.renderNodeContent(t)}renderContentElement(t,e){const{visibleElements:i}=this;if("boolean"!=typeof i.content&&!i.content[t.type])return null;switch(t.type){case"attachments":return this.renderAttachments(e);case"custom":return this.renderCustom(t,e);case"fields":return this.renderFields(e);case"media":return this.renderMedia(e);case"text":return this.renderText(t,e);default:return null}}renderAttachments(t){const e=this._contentWidgets[t];if(!e||e.destroyed)return null;const{state:i,attachmentInfos:s}=e.viewModel;return"loading"===i||s.length>0?Bc("div",{key:this._buildKey("attachments-element",t),class:this.classes(_z)},e.render()):null}renderCustom(t,e){const{creator:i}=t,s=this._contentWidgets[e];return!s||s.destroyed?null:i?Bc("div",{key:this._buildKey("custom-element",e),class:_z},s.render()):null}renderFields(t){const e=this._contentWidgets[t];return!e||e.destroyed?null:Bc("div",{key:this._buildKey("fields-element",t),class:_z},e.render())}renderMedia(t){const e=this._contentWidgets[t];return!e||e.destroyed?null:Bc("div",{key:this._buildKey("media-element",t),class:_z},e.render())}renderLastEditInfo(){const{visibleElements:t,messages:e}=this,{lastEditInfo:i}=this.viewModel;if(!i||!t.lastEditedInfo)return null;const{date:s,user:n}=i,r=Ni("edit"===i.type?n?e.lastEditedByUser:e.lastEdited:n?e.lastCreatedByUser:e.lastCreated,{date:s,user:n});return Bc("div",{key:"edit-info-element",class:this.classes("esri-feature__last-edited-info",_z)},r)}renderText(t,e){const i=this._contentWidgets[e];return!i||i.destroyed?null:t.text?Bc("div",{key:this._buildKey("text-element",e),class:this.classes(_z,"esri-feature__text")},i.render()):null}_buildKey(t,...e){return`${t}__${this.get("viewModel.graphic.uid")||"0"}-${e.join("-")}`}_destroyContentWidgets(){this._contentWidgets.forEach((t=>{t.viewModel=null,t&&!t.destroyed&&t.destroy()})),this._contentWidgets=[]}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:t,visibleElements:e}=this,i=this.get("viewModel.content"),{contentViewModels:s}=this.viewModel;if(Array.isArray(i))i.forEach(((i,n)=>{"attachments"===i.type&&(this._contentWidgets[n]=new yP({displayType:i.displayType,headingLevel:e.title?t+1:t,viewModel:s[n]})),"fields"===i.type&&(this._contentWidgets[n]=new kP({viewModel:s[n]})),"media"===i.type&&(this._contentWidgets[n]=new jN({viewModel:s[n]})),"text"===i.type&&(this._contentWidgets[n]=new wP({viewModel:s[n]})),"custom"===i.type&&(this._contentWidgets[n]=new wP({viewModel:s[n]}))}),this);else{const t=s[0];t&&!t.destroyed&&(this._contentWidgets[0]=new wP({viewModel:t}))}this.scheduleRender()}};e([ue("viewModel.graphic")],Oz.prototype,"graphic",void 0),e([ue("viewModel.defaultPopupTemplateEnabled")],Oz.prototype,"defaultPopupTemplateEnabled",void 0),e([oe()],Oz.prototype,"headingLevel",void 0),e([oe({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Oz.prototype,"label",void 0),e([oe(),zc("esri/widgets/Feature/t9n/Feature")],Oz.prototype,"messages",void 0),e([oe(),zc("esri/t9n/common")],Oz.prototype,"messagesCommon",void 0),e([oe(),zc("esri/widgets/support/t9n/uriUtils")],Oz.prototype,"messagesURIUtils",void 0),e([ue("viewModel.spatialReference")],Oz.prototype,"spatialReference",void 0),e([ue("viewModel.title")],Oz.prototype,"title",void 0),e([oe()],Oz.prototype,"visibleElements",void 0),e([ba("visibleElements")],Oz.prototype,"castVisibleElements",null),e([ue("viewModel.map")],Oz.prototype,"map",void 0),e([ue("viewModel.view")],Oz.prototype,"view",void 0),e([oe({type:Iz})],Oz.prototype,"viewModel",void 0),Oz=e([si("esri.widgets.Feature")],Oz);const Az=Oz;let Fz=class extends To.EventedAccessor{constructor(t){super(t),this._anchorHandles=new Wo,this.location=null,this.screenLocation=null,this.screenLocationEnabled=!1,this.view=null,this._anchorHandles.add([ta(this,["screenLocationEnabled","location","view.size","view.stationary"],(()=>this._updateScreenPointAndHandle())),ta(this,["view","view.ready"],(()=>this._wireUpView()))])}destroy(){this.view=null,this._anchorHandles&&this._anchorHandles.destroy(),this._anchorHandles=null,this._viewpointHandle=null}_wireUpView(){const t="view";if(this._anchorHandles.remove(t),this._viewpointHandle=null,!this.get("view.ready"))return;this._setScreenLocation();const{view:e}=this,i=ua(e,"3d"===e.type?"camera":"viewpoint",(()=>this._viewpointChange()));this._anchorHandles.add(i,t),this._viewpointHandle=i,this._toggleWatchingViewpoint()}_viewpointChange(){this._setScreenLocation(),this.emit("view-change")}_updateScreenPointAndHandle(){this._setScreenLocation(),this._toggleWatchingViewpoint()}_toggleWatchingViewpoint(){const{_viewpointHandle:t,location:e,screenLocationEnabled:i}=this;t&&(e&&i?t.resume():t.pause())}_setScreenLocation(){const{location:t,view:e,screenLocationEnabled:i}=this,s=this.get("view.ready"),n=i&&s&&u(t)?e.toScreen(t):null;this._set("screenLocation",n)}};e([oe()],Fz.prototype,"location",void 0),e([oe({readOnly:!0})],Fz.prototype,"screenLocation",void 0),e([oe()],Fz.prototype,"screenLocationEnabled",void 0),e([oe()],Fz.prototype,"view",void 0),Fz=e([si("esri.widgets.support.AnchorElementViewModel")],Fz);const Cz=Fz;let Pz=class extends Cz{constructor(t){super(t),this.visible=!1}};e([oe()],Pz.prototype,"visible",void 0),Pz=e([si("esri.widgets.CompassViewModel")],Pz);const Ez=Pz;let Rz=class extends Dc{constructor(t,e){super(t,e),this._animationDelay=500,this._animationPromise=null,this.location=null,this.view=null,this.viewModel=new Ez,this.visible=!1}initialize(){this.own([ta(this,"visible",(t=>this._visibleChange(t)))])}destroy(){this._animationPromise=null}show(t){const{location:e,promise:i}=t;e&&(this.viewModel.location=e),this.visible=!0,i&&i.catch((()=>{})).then((()=>this.hide()))}hide(){this.visible=!1}render(){const{visible:t}=this,{screenLocation:e}=this.viewModel,i=!!e,s={"esri-spinner--start":t&&i,"esri-spinner--finish":!t&&i},n=this._getPositionStyles();return Bc("div",{class:this.classes("esri-spinner",s),styles:n})}_visibleChange(t){if(t)return void(this.viewModel.screenLocationEnabled=!0);const e=us(this._animationDelay);this._animationPromise=e,e.catch((()=>{})).then((()=>{this._animationPromise===e&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null)}))}_getPositionStyles(){const{screenLocation:t,view:e}=this.viewModel;if(!e||c(t))return{};const{padding:i}=e;return{left:t.x-i.left+"px",top:t.y-i.top+"px"}}};e([ue("viewModel.location")],Rz.prototype,"location",void 0),e([ue("viewModel.view")],Rz.prototype,"view",void 0),e([oe({type:Ez})],Rz.prototype,"viewModel",void 0),e([ue("viewModel.visible")],Rz.prototype,"visible",void 0),Rz=e([si("esri.widgets.Spinner")],Rz);const Lz=Rz;class Nz{constructor(t=(t=>t.values().next().value)){this._peeker=t,this._items=new Set}get length(){return this._items.size}clear(){this._items.clear()}last(){if(0===this._items.size)return;let t;for(t of this._items);return t}peek(){if(0!==this._items.size)return this._peeker(this._items)}push(t){this.contains(t)||this._items.add(t)}contains(t){return this._items.has(t)}pop(){if(0===this.length)return;const t=this.peek();return this._items.delete(t),t}popLast(){if(0===this.length)return;const t=this.last();return this._items.delete(t),t}remove(t){this._items.delete(t)}filter(t){return this._items.forEach((e=>{t(e)||this._items.delete(e)})),this}}const Dz=l("mac")?"Meta":"Ctrl",Vz={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let t=48;t<58;t++)Vz[t]=String.fromCharCode(t);for(let t=1;t<25;t++)Vz[111+t]="F"+t;for(let t=65;t<91;t++)Vz[t]=[String.fromCharCode(t+32),String.fromCharCode(t)];function $z(t){switch(t){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return!0}return!1}class zz{constructor(t,e=[]){this.eventType=t,this.keyModifiers=e}matches(t){if(t.type!==this.eventType)return!1;if(0===this.keyModifiers.length)return!0;const e=t.modifiers;for(const t of this.keyModifiers)if(!e.has(t))return!1;return!0}}const Gz=ct.getLogger("esri.views.input.InputHandler");class Uz{constructor(t){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=t}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const t in this._incoming){const e=this._incoming[t];for(const t of e)this._incomingEventMatches.push(t.match)}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((t=>t.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return!1}onInstall(t){this._manager?Gz.error("This InputHandler has already been registered with an InputManager"):(t.setEventCallback((t=>this._handleEvent(t))),t.setUninstallCallback((()=>this._onUninstall())),this._manager=t)}onUninstall(){}registerIncoming(t,e,i){let s;"function"==typeof e?(i=e,s=[]):s=e||[];const n="string"==typeof t?new zz(t,s):t,r=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null},o=t=>{const e=this._incoming[t.match.eventType];if(e){const i=e.indexOf(t);e.splice(i,1),r(),this._manager&&this._manager.updateDependencies()}},a=new qz(n,i,{onPause:o,onRemove:o,onResume:t=>{const e=this._incoming[t.match.eventType];e&&-1===e.indexOf(t)&&(e.push(t),r(),this._manager&&this._manager.updateDependencies())}});let l=this._incoming[n.eventType];return l||(l=[],this._incoming[n.eventType]=l),l.push(a),r(),this._manager&&this._manager.updateDependencies(),a}registerOutgoing(t){if(this._outgoing[t])throw Error("There is already a callback registered for this outgoing InputEvent: "+t);const e=new Bz(t,{onEmit:(t,e,i,s)=>{this._manager.emit(t.eventType,e,i,s)},onRemove:t=>{delete this._outgoing[t.eventType],this._manager.updateDependencies()}});return this._outgoing[t]=e,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),e}startCapturingPointer(t){this._manager.setPointerCapture(t,!0)}stopCapturingPointer(t){this._manager.setPointerCapture(t,!1)}refreshHasPendingInputs(){this._manager.refreshHasPendingInputs()}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):Gz.error("This InputHandler is not registered with an InputManager")}_handleEvent(t){const e=this._incoming[t.type];if(e)for(const i of e)if(i.match.matches(t)&&(i.callback(t),t.shouldStopPropagation()))break}}class qz{constructor(t,e,i){this.match=t,this._callback=e,this._handler=i}pause(){this._handler.onPause(this)}resume(){this._handler.onResume(this)}remove(){this._handler.onRemove(this)}get callback(){return this._callback}}class Bz{constructor(t,e){this.eventType=t,this._removed=!1,this._handler=e}emit(t,e,i){this._removed||this._handler.onEmit(this,t,e,i)}remove(){this._removed=!0,this._handler.onRemove(this)}}class Wz extends Uz{constructor(t){super(!0),this._onChange=t,this._value="mouse",this.registerIncoming("pointer-down",(t=>{this._setValue("touch"===t.data.native.pointerType?"touch":"mouse")})),this._moveHandler=this.registerIncoming("pointer-move",(t=>{this._setValue("touch"===t.data.native.pointerType?"touch":"mouse")})),this._moveHandler.pause()}_setValue(t){t!==this._value&&("touch"===t?this._moveHandler.resume():this._moveHandler.pause(),this._value=t,this._onChange(t))}}const Hz=ct.getLogger("esri.views.input.InputManager");let Jz=class extends jo{constructor(t){super(t),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=Dz,this.latestPointerType="mouse",this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation}}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers()}destroy(){const t=Object.keys(this._nameToGroup);for(const e of t)this.uninstallHandlers(e);this.eventSource=null,this._currentPropagation=null}get hasPendingInputs(){return this._handlers.some((t=>t.handler.hasPendingInputs))}installHandlers(t,e,i=Qz.INTERNAL){if(this._nameToGroup[t])return void Hz.error("There is already an InputHandler group registered under the name `"+t+"`");if(0===e.length)return void Hz.error("Can't register a group of zero handlers");const s={name:t,handlers:e.map((t=>({handler:t,active:!0,removed:!1,priorityIndex:0,groupPriority:i,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[t]=s;for(let t=s.handlers.length-1;t>=0;t--){const e=s.handlers[t];this._handlers.push(e),e.handler.onInstall({updateDependencies:()=>{this.updateDependencies()},emit:(t,i,s,n,r)=>{this._emitInputEvent(e.priorityIndex+1,t,i,s,r,n)},setPointerCapture:(t,i)=>{this._setPointerCapture(s,e,t,i)},setEventCallback:t=>{e.eventCallback=t},setUninstallCallback:t=>{e.uninstallCallback=t},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs")}})}this.updateDependencies()}uninstallHandlers(t){const e=this._nameToGroup[t];e?(e.handlers.forEach((t=>{t.removed=!0,t.uninstallCallback()})),delete this._nameToGroup[t],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):Hz.error("There is no InputHandler group registered under the name `"+t+"`")}hasHandlers(t){return void 0!==this._nameToGroup[t]}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const t=new Set,e=new Set;this._handlersPriority=[];for(let t=this._handlers.length-1;t>=0;t--){const e=this._handlers[t];e.priorityIndex=t,this._handlersPriority.push(e)}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let i=this._handlersPriority.length-1;i>=0;i--){const s=this._handlersPriority[i];s.priorityIndex=i;let n=s.handler.hasSideEffects;if(!n)for(const e of s.handler.outgoingEventTypes)if(t.has(e)){n=!0;break}if(n)for(const i of s.handler.incomingEventMatches){t.add(i.eventType);for(const t of i.keyModifiers)$z(t)||e.add(t)}s.active=n}this._sourceEvents=t,this._keyModifiers=e,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents)}_setLatestPointerType(t){this._set("latestPointerType",t)}_onEventReceived(t,e){"pointer-capture-lost"===t&&this._pointerCaptures.delete(e.native.pointerId),this._updateKeyModifiers(t,e),this._emitInputEventFromSource(t,e,null!=this.test.timestamp?this.test.timestamp:e.native?e.native.timestamp:void 0,e.native?e.native.cancelable:void 0)}_updateKeyModifiers(t,e){if(!e)return;let i=!1;const s=()=>{if(!i){const t=new Set;this._activeKeyModifiers.forEach((e=>{t.add(e)})),this._activeKeyModifiers=t,i=!0}},n=(t,e)=>{e&&!this._activeKeyModifiers.has(t)?(s(),this._activeKeyModifiers.add(t)):!e&&this._activeKeyModifiers.has(t)&&(s(),this._activeKeyModifiers.delete(t))};if("key-down"===t||"key-up"===t){const i=e.key;this._keyModifiers.has(i)&&n(i,"key-down"===t)}const r=e.native;n("Alt",!(!r||!r.altKey)),n("Ctrl",!(!r||!r.ctrlKey)),n("Shift",!(!r||!r.shiftKey)),n("Meta",!(!r||!r.metaKey)),n("Primary",this._activeKeyModifiers.has(this.primaryKey))}_installRecognizers(){this._latestPointerTypeHandler=new Wz((t=>this._setLatestPointerType(t))),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,Qz.INTERNAL),this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler],Qz.INTERNAL)}_setPointerCapture(t,e,i,s){const n=t.name+"-"+e.priorityIndex,r=this._pointerCaptures.get(i.pointerId)||new Set;this._pointerCaptures.set(i.pointerId,r),s?(r.add(n),1===r.size&&this.eventSource&&this.eventSource.setPointerCapture(i,!0)):r.has(n)&&(r.delete(n),0===r.size&&(this._pointerCaptures.delete(i.pointerId),this.eventSource&&this.eventSource.setPointerCapture(i,!1)))}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((t=>!t.removed)),this.updateDependencies()}_emitInputEventFromSource(t,e,i,s){this._emitInputEvent(0,t,e,i,s)}_emitInputEvent(t,e,i,s,n,r){const o=void 0!==s?s:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),a={event:new Zz(e,i,o,r||this._activeKeyModifiers,void 0!==n&&n),priorityIndex:t};this._currentPropagation?this._currentPropagation.events.push(a):this._doNewPropagation(a)}_doNewPropagation(t){this._currentPropagation={events:new Nz,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:t.event.timestamp},this._currentPropagation.events.push(t),this._continuePropagation()}_continuePropagation(){const t=this._currentPropagation;if(t){for(;this._currentPropagation.events.length>0;){const{event:e,priorityIndex:i}=this._currentPropagation.events.pop(),s=e.data&&e.data.eventId;if(null==s||!this._stoppedPropagationEventIds.has(s))for(t.currentHandler=this._handlersPriority[i];t.currentHandler;){if(t.currentHandler.removed)t.needsHandlerGarbageCollect=!0;else{if(t.currentHandler.active&&!e.shouldStopPropagation()&&t.currentHandler.eventCallback(e),e.shouldStopPropagation()){null!=s&&this._stoppedPropagationEventIds.add(s);break}if(e.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:e,priorityIndex:t.currentHandler.priorityIndex+1})}t.currentHandler=this._handlersPriority[t.currentHandler.priorityIndex+1]}}t.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies()}}_pausePropagation(t){const e=new Nz;for(e.push(t);this._currentPropagation.events.length;)e.push(this._currentPropagation.events.pop());this._currentPropagation.events=e,this._currentPropagation.currentHandler=null}_compareHandlerPriority(t,e){if(t.handler.hasSideEffects!==e.handler.hasSideEffects)return t.handler.hasSideEffects?1:-1;if(t.groupPriority!==e.groupPriority)return t.groupPriority>e.groupPriority?-1:1;for(const i of t.handler.incomingEventMatches)for(const t of e.handler.incomingEventMatches){if(i.eventType!==t.eventType)continue;const e=i.keyModifiers.filter((e=>-1!==t.keyModifiers.indexOf(e)));if(e.length===i.keyModifiers.length!=(e.length===t.keyModifiers.length))return i.keyModifiers.length>t.keyModifiers.length?-1:1}return t.priorityIndex>e.priorityIndex?-1:1}_sortHandlersPriority(t){const e=[];for(const i of t){let t=0;for(;t<e.length&&this._compareHandlerPriority(i,e[t])>=0;)t++;e.splice(t,0,i)}return e}get debug(){const t=t=>{const e=this._setPointerCapture;this._setPointerCapture=()=>{},t(),this._setPointerCapture=e};return{injectEvent:(e,i)=>{t((()=>{this._onEventReceived(e,i)}))},disablePointerCapture:t}}};e([oe({readOnly:!0})],Jz.prototype,"hasPendingInputs",null),e([oe()],Jz.prototype,"eventSource",void 0),e([oe()],Jz.prototype,"recognizers",void 0),e([oe({readOnly:!0})],Jz.prototype,"latestPointerType",void 0),Jz=e([si("esri.views.input.InputManager")],Jz);class Zz{constructor(t,e,i,s,n){this.type=t,this.data=e,this.timestamp=i,this.modifiers=s,this.cancelable=n,this._propagationState=0,this._resumeCallback=null}stopPropagation(){this._propagationState|=1}shouldStopPropagation(){return 0!=(1&this._propagationState)}async(t){this._propagationState|=2;const e=(t,e)=>{this._propagationState&=-3;const i=this._resumeCallback;if(this._resumeCallback=null,i&&i(),e)throw t;return t};return("function"==typeof t?t():t).then((t=>e(t,!1)),(t=>e(t,!0)))}shouldPausePropagation(t){return!!(2&this._propagationState)&&(this._resumeCallback=t,!0)}preventDefault(){this.data.native.preventDefault()}}const Qz={DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3},Kz=new KI({id:"zoom-to-feature",title:"{messages.zoom}",className:"esri-icon-zoom-in-magnifying-glass"}),Yz=new KI({id:"remove-selected-feature",title:"{messages.remove}",className:"esri-icon-trash"}),Xz=new KI({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:"esri-icon-zoom-in-magnifying-glass"}),tG=new KI({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:"esri-icon-table"}),eG=ct.getLogger("esri.widgets.Popup.PopupViewModel");function iG(t){const{selectedFeature:e,location:i,view:s}=t;return s?"3d"===s.type?e||i:t.get("selectedFeature.geometry")||i:null}const sG=qo.ofType({key:"type",defaultKeyValue:"button",base:JI,typeMap:{button:KI,toggle:tj}}),nG="esri.widgets.Popup.PopupViewModel",rG=ct.getLogger(nG);let oG=class extends(jO(Cz)){constructor(t){super(t),this._handles=new Wo,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new sG,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new hj({symbol:new Ab({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null}get isLoadingFeature(){return this.featureViewModels.some((t=>t.waitingForContent))}initialize(){this._handles.add([Xo(this,["autoOpenEnabled","view"],(()=>this._autoOpenEnabledChange())),this.on("view-change",(()=>this._autoClose())),ta(this,["highlightEnabled","selectedFeature","visible","view"],(()=>this._highlightFeature())),ta(this,"view.animation.state",(t=>this._animationStateChange(t))),ta(this,"location",(t=>this._locationChange(t))),ta(this,"selectedFeature",(t=>this._selectedFeatureChange(t))),ta(this,["selectedFeatureIndex","featureCount","featuresPerPage"],(()=>this._selectedFeatureIndexChange())),ta(this,["featurePage","selectedFeatureIndex","featureCount","featuresPerPage, featureViewModels"],(()=>this._setGraphicOnFeatureViewModels())),ta(this,"featureViewModels",(()=>this._featureViewModelsChange())),this.on("trigger-action",(t=>function(t){const{event:e,view:i}=t,{action:s}=e,n=i&&i.popup;if(!s)return Promise.reject(new Ve("trigger-action:missing-arguments","Event has no action"));if(!n)return Promise.reject(new Ve("trigger-action:missing-arguments","view.popup is missing"));const{disabled:r,id:o}=s;if(!o)return Promise.reject(new Ve("trigger-action:invalid-action","action.id is missing"));if(r)return Promise.reject(new Ve("trigger-action:invalid-action","Action is disabled"));if(o===Kz.id)return async function(t){const{location:e,selectedFeature:i,view:s,zoomFactor:n}=t,r=iG(t);if(!r){const t=new Ve("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:r,view:s});return eG.error(t),Promise.reject(t)}const o=s.scale/n,a=t.get("selectedFeature.geometry")||e,l=a&&"point"===a.type&&function(t,e){if("3d"!==(null==e?void 0:e.type)||!t||"esri.Graphic"!==t.declaredClass)return!0;const i=e.getViewForGraphic(t);if(i&&"whenGraphicBounds"in i){let e=!1;return i.whenGraphicBounds(t,{useViewElevation:!0}).then((t=>{e=!t||!t.boundingBox||t.boundingBox[0]===t.boundingBox[3]&&t.boundingBox[1]===t.boundingBox[4]&&t.boundingBox[2]===t.boundingBox[5]})).catch((()=>{const e=new Ve("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});eG.error(e)})),e}return!0}(i,s);Kz.active=!0,Kz.disabled=!0,await t.view.goTo({target:r,scale:l?o:void 0}),Kz.active=!1,Kz.disabled=!1,t.zoomToLocation=null,l&&(t.location=a)}(n.viewModel);if(o===Xz.id)return async function(t){const{selectedFeature:e,view:i}=t;if("2d"!==(null==i?void 0:i.type)){const t=new Ve("zoomToCluster:invalid-view","View must be 2d MapView.",{view:i});throw eG.error(t),t}if(!e.isAggregate){const t=new Ve("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw eG.error(t),t}const s=e.sourceLayer,n=await i.whenLayerView(s),r=n.createQuery();r.aggregateIds=[e.getObjectId()],Xz.active=!0,Xz.disabled=!0;const{extent:o}=await n.queryExtent(r);await i.goTo({target:o}),Xz.active=!1,Xz.disabled=!1}(n.viewModel);if(o===tG.id)return n.featureMenuOpen=!n.featureMenuOpen,n.viewModel.browseClusterEnabled=!n.viewModel.browseClusterEnabled,Promise.resolve();if(n.viewModel.browseClusterEnabled=!1,o===Yz.id){n.close();const{selectedFeature:t}=n;if(!t)return Promise.reject(new Ve("trigger-action:"+Yz.id,"selectedFeature is required",{selectedFeature:t}));const{sourceLayer:e}=t;return e?e.remove(t):i.graphics.remove(t),Promise.resolve()}return Promise.resolve()}({event:t,view:this.view}))),aa(this,"waitingForResult",(()=>this._waitingForResultChange()),!0),ta(this,["features","view","view.map","view.spatialReference"],(()=>this._updateFeatureVMs())),ta(this,["view.scale"],this._viewScaleChange),aa(this,"visible",(()=>this.browseClusterEnabled=!1)),ta(this,"browseClusterEnabled",(t=>t?this.enableClusterBrowsing():this.disableClusterBrowsing()))])}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const t=this._get("allActions")||new sG;t.removeAll();const{actions:e,defaultActions:i,defaultPopupTemplateEnabled:s,includeDefaultActions:n,selectedFeature:r}=this,o=n?i.concat(e):e,a=r&&("function"==typeof r.getEffectivePopupTemplate&&r.getEffectivePopupTemplate(s)||r.popupTemplate),l=a&&a.actions,u=a&&a.overwriteActions?l:l?l.concat(o):o;return u&&u.filter(Boolean).forEach((e=>t.add(e))),t}get defaultActions(){var t;const e=this._get("defaultActions")||new sG;return e.removeAll(),e.addMany(null!=(t=this.selectedFeature)&&t.isAggregate?[Xz.clone(),tG.clone()]:[Kz.clone()]),e}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(t){const e=t||[];this._set("features",e);const{pendingPromisesCount:i,promiseCount:s,selectedFeatureIndex:n}=this,r=s&&e.length;r&&i&&-1===n?this.selectedFeatureIndex=0:r&&-1!==n||(this.selectedFeatureIndex=e.length?0:-1)}get location(){return this._get("location")||null}set location(t){const e=this.get("view.spatialReference.isWebMercator");t&&t.get("spatialReference.isWGS84")&&e&&(t=kp(t)),this._set("location",t)}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return!(!(this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(t){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(t)||!t.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",t),(t=t.slice(0)).forEach((t=>{this._pendingPromises.add(t),t.then((e=>{this._pendingPromises.has(t)&&this._updateFeatures(e),this._updatePendingPromises(t)}),(()=>this._updatePendingPromises(t)))})),this.notifyChange("pendingPromisesCount")}get selectedFeature(){const{features:t,selectedFeatureIndex:e}=this;return-1===e?null:t[e]||null}get selectedFeatureIndex(){const t=this._get("selectedFeatureIndex");return"number"==typeof t?t:-1}set selectedFeatureIndex(t){const{featureCount:e}=this;this._set("selectedFeatureIndex",t=isNaN(t)||t<-1||!e?-1:(t+e)%e)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:t}=this,e=iG(this);if(!e){const i=new Ve("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:e,view:t});return rG.error(i),Promise.reject(i)}return this.callGoTo({target:{target:e,scale:t.scale}})}clear(){this.set({promises:[],features:[],content:null,title:null,location:null})}fetchFeatures(t,e){const{view:i}=this;if(!i||!t){const e=new Ve("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:t,view:i});return rG.error(e),Promise.reject(e)}return i.fetchPopupFeatures(t,{event:e&&e.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:e&&e.signal})}open(t){const e={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...t,visible:!0},{fetchFeatures:i}=e;delete e.fetchFeatures,i&&this._setFetchFeaturesPromises(e.location),this.set(e)}triggerAction(t){const e=this.allActions.getItemAt(t);e&&!e.disabled&&this.emit("trigger-action",{action:e})}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){(function(t){t.features=t.features.filter((t=>t.isAggregate))})(this),this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){await async function(t){const{selectedFeature:e,view:i}=t;if("2d"!==(null==i?void 0:i.type)){const t=new Ve("displayClusterExtent:invalid-view","View must be 2d MapView.",{view:i});throw eG.error(t),t}if(!e.isAggregate){const t=new Ve("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw eG.error(t),t}const s=e.sourceLayer,n=await i.whenLayerView(s),r=n.createQuery();r.aggregateIds=[e.getObjectId()];const{extent:o}=await n.queryExtent(r);t.selectedClusterBoundaryFeature.geometry=o,i.graphics.add(t.selectedClusterBoundaryFeature)}(this),await async function(t){const{selectedFeature:e,view:i}=t;if("2d"!==(null==i?void 0:i.type)){const t=new Ve("browseAggregateFeatures:invalid-view","View must be 2d MapView.",{view:i});throw eG.error(t),t}if(!e.isAggregate){const t=new Ve("browseAggregateFeatures:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:e});throw eG.error(t),t}const s=e.sourceLayer,n=await i.whenLayerView(s),r=n.createQuery();r.aggregateIds=[e.getObjectId()],tG.active=!0,tG.disabled=!0;const{features:o}=await n.queryFeatures(r);tG.active=!1,tG.disabled=!1,i.popup.open({features:[e].concat(o),featureMenuOpen:!0})}(this)}_animationStateChange(t){this.zoomToLocation||(Kz.disabled="waiting-for-target"===t)}_clearBrowsedClusterGraphics(){var t;const e=null==(t=this.view)?void 0:t.graphics;e&&(e.remove(this.selectedClusterBoundaryFeature),e.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){var t;(null!=(t=this.selectedFeature)&&t.isAggregate||this.browseClusterEnabled)&&(this.browseClusterEnabled=!1,this.visible=!1)}_locationChange(t){const{selectedFeature:e,updateLocationEnabled:i}=this;i&&t&&(!e||e.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null}_setGraphicOnFeatureViewModels(){const{features:t,featureCount:e,featurePage:i,featuresPerPage:s,featureViewModels:n}=this;if(null===i)return;const r=((i-1)*s+e)%e;n.slice(r,r+s).forEach(((e,i)=>{e&&!e.graphic&&(e.graphic=t[r+i])}))}async _selectedFeatureChange(t){if(!t)return;const{location:e,updateLocationEnabled:i,view:s}=this;if(this.browseClusterEnabled){if(this._selectedClusterFeature&&(s.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),t.isAggregate)return;return t.symbol=await oO(t),this._selectedClusterFeature=t,void s.graphics.add(this._selectedClusterFeature)}!i&&e||!t.geometry?i&&!t.geometry&&this.centerAtLocation().then((()=>{this.location=s.center.clone()})):this.location=this._getPointFromGeometry(t.geometry)}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1)}_setFetchFeaturesPromises(t){return this._fetchFeaturesWithController(this._getScreenPoint(t||this.location)).then((t=>{const{clientOnlyGraphics:e,promisesPerLayerView:i}=t,s=Promise.resolve(e),n=i.map((t=>t.promise));this.promises=[s,...n]}))}_destroyFeatureVMs(){this.featureViewModels.forEach((t=>t&&!t.destroyed&&t.destroy())),this._set("featureViewModels",[])}_updateFeatureVMs(){const{selectedFeature:t,features:e,featureViewModels:i}=this;if(null!=t&&t.isAggregate||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!e||!e.length)return;const s=i.slice(0),n=[];e.forEach(((e,i)=>{if(!e)return;let r=null;if(s.some(((t,i)=>(t&&t.graphic===e&&(r=t,s.splice(i,1)),!!r))),r)n[i]=r;else{var o,a;const s=new Iz({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:null==(o=this.view)?void 0:o.spatialReference,graphic:e===t?e:null,map:null==(a=this.view)?void 0:a.map,view:this.view});n[i]=s}})),s.forEach((t=>t&&!t.destroyed&&t.destroy())),this._set("featureViewModels",n)}_getScreenPoint(t){const{view:e}=this;return e&&t&&"function"==typeof e.toScreen?e.toScreen(t):null}_autoOpenEnabledChange(){const t="auto-fetch-features",{_handles:e,autoOpenEnabled:i}=this;if(e.remove(t),i&&this.view){const i=this.view.on("click",(t=>{"mouse"===t.pointerType&&0!==t.button||this._fetchFeaturesAndOpen(t)}),Qz.WIDGET);e.add(i,t)}}_cancelFetchingFeatures(){const t=this._fetchFeaturesController;t&&t.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult")}_fetchFeaturesWithController(t,e){this._cancelFetchingFeatures();const i=new AbortController,{signal:s}=i;this._fetchFeaturesController=i,this.notifyChange("waitingForResult");const n=this.fetchFeatures(t,{signal:s,event:e});return n.catch((()=>{})).then((()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult")})),n}_fetchFeaturesAndOpen(t){const{screenPoint:e,mapPoint:i}=t,{view:s}=this;this._fetchFeaturesWithController(e,t).then((t=>{const{clientOnlyGraphics:e,promisesPerLayerView:n,location:r}=t,o=[Promise.resolve(e),...n.map((t=>t.promise))];return s.popup.open({location:r||i,promises:o}),t}))}_updatePendingPromises(t){t&&this._pendingPromises.has(t)&&(this._pendingPromises.delete(t),this.notifyChange("pendingPromisesCount"))}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}_getPointFromGeometry(t){return c(t)?null:"point"===t.type?t:"extent"===t.type?t.center:"polygon"===t.type?t.centroid:"multipoint"===t.type||"polyline"===t.type?t.extent.center:null}async _getLayerView(t,e){return await t.when(),t.whenLayerView(e)}async _highlightFeature(){const t="highlight";this._handles.remove(t);const{selectedFeature:e,highlightEnabled:i,view:s,visible:n}=this;if(!(e&&s&&i&&n))return;let{layer:r,sourceLayer:o}=e;if("map-notes"!==(null==o?void 0:o.type)&&"subtype-group"!==(null==o?void 0:o.type)||(r=o),!(r&&r instanceof mA))return;const a=this._getLayerView(s,r);this._highlightPromise=a;const l=await a;if(!(l&&bO(l)&&this._highlightPromise===a&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const u="objectIdField"in r&&r.objectIdField,c=e.attributes,h=l.highlight(c&&u&&c[u]||e);this._handles.add(h,t)}_updateFeatures(t){const{features:e}=this;if(!t||!t.length)return;if(!e.length)return void(this.features=t);const i=t.filter((t=>-1===e.indexOf(t)));this.features=e.concat(i)}};e([oe()],oG.prototype,"featurePage",void 0),e([oe()],oG.prototype,"isLoadingFeature",null),e([oe({type:sG})],oG.prototype,"actions",void 0),e([oe({readOnly:!0})],oG.prototype,"active",null),e([oe({readOnly:!0})],oG.prototype,"allActions",null),e([oe({type:Boolean})],oG.prototype,"defaultPopupTemplateEnabled",void 0),e([oe()],oG.prototype,"autoCloseEnabled",void 0),e([oe()],oG.prototype,"autoOpenEnabled",void 0),e([oe()],oG.prototype,"browseClusterEnabled",void 0),e([oe()],oG.prototype,"content",void 0),e([oe({type:sG,readOnly:!0})],oG.prototype,"defaultActions",null),e([oe({readOnly:!0})],oG.prototype,"featureCount",null),e([oe()],oG.prototype,"features",null),e([oe()],oG.prototype,"featuresPerPage",void 0),e([oe()],oG.prototype,"featureViewModelAbilities",void 0),e([oe({readOnly:!0})],oG.prototype,"featureViewModels",void 0),e([oe()],oG.prototype,"highlightEnabled",void 0),e([oe()],oG.prototype,"includeDefaultActions",void 0),e([oe({type:Fp})],oG.prototype,"location",null),e([oe({readOnly:!0})],oG.prototype,"pendingPromisesCount",null),e([oe({readOnly:!0})],oG.prototype,"selectedClusterBoundaryFeature",void 0),e([oe({readOnly:!0})],oG.prototype,"waitingForResult",null),e([oe({readOnly:!0})],oG.prototype,"promiseCount",null),e([oe()],oG.prototype,"promises",null),e([oe({value:null,readOnly:!0})],oG.prototype,"selectedFeature",null),e([oe({value:-1})],oG.prototype,"selectedFeatureIndex",null),e([oe({readOnly:!0})],oG.prototype,"selectedFeatureViewModel",null),e([oe({readOnly:!0})],oG.prototype,"state",null),e([oe()],oG.prototype,"title",void 0),e([oe()],oG.prototype,"updateLocationEnabled",void 0),e([oe()],oG.prototype,"view",void 0),e([oe()],oG.prototype,"visible",void 0),e([oe()],oG.prototype,"zoomFactor",void 0),e([oe()],oG.prototype,"zoomToLocation",void 0),e([oe()],oG.prototype,"centerAtLocation",null),oG=e([si(nG)],oG);const aG=oG,lG="selected-index",uG="popup-spinner",cG="esri-popup__button",hG="esri-popup__icon",dG={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},pG="esri-popup";function fG(t,e){return void 0===e?`${pG}__${t}`:`${pG}__${t}-${e}`}const yG="esri.widgets.Popup",mG=ct.getLogger(yG),gG={closeButton:!0,featureNavigation:!0};let vG=class extends(jz(Dc)){constructor(t,e){super(t,e),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new Wo,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([t])=>{null!=t&&t.isIntersecting&&this.viewModel.featurePage++},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback),this._displaySpinnerThrottled=fC((()=>this._displaySpinner()),0),this.actions=null,this.alignment="auto",this.autoCloseEnabled=null,this.autoOpenEnabled=null,this.defaultPopupTemplateEnabled=null,this.content=null,this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureCount=null,this.featureMenuOpen=!1,this.features=null,this.goToOverride=null,this.headingLevel=2,this.highlightEnabled=null,this.location=null,this.label=void 0,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.promises=null,this.selectedFeature=null,this.selectedFeatureIndex=null,this.spinnerEnabled=!0,this.title=null,this.updateLocationEnabled=null,this.view=null,this.viewModel=new aG,this.visible=null,this.visibleElements={...gG},this._addSelectedFeatureIndexHandle(),this.own([ta(this,"viewModel.screenLocation",(()=>this._positionContainer())),ta(this,["viewModel.active","dockEnabled"],(()=>this._toggleScreenLocationEnabled())),ta(this,"viewModel.screenLocation",((t,e)=>{!!t!=!!e&&this.reposition()})),ta(this,["viewModel.view.padding","viewModel.view.size","viewModel.active","viewModel.location","alignment"],(()=>this.reposition())),ta(this,"spinnerEnabled",(t=>this._spinnerEnabledChange(t))),ta(this,"viewModel.view.size",((t,e)=>this._updateDockEnabledForViewSize(t,e))),ta(this,"viewModel.view",((t,e)=>this._viewChange(t,e))),ta(this,"viewModel.view.ready",((t,e)=>this._viewReadyChange(t,e))),ta(this,["viewModel.waitingForResult","viewModel.location"],(()=>{this._hideSpinner(),this._displaySpinnerThrottled()})),ta(this,["selectedFeatureWidget.viewModel.title","selectedFeatureWidget.viewModel.state"],(()=>this._setTitleFromFeatureWidget())),ta(this,["selectedFeatureWidget.viewModel.content","selectedFeatureWidget.viewModel.state"],(()=>this._setContentFromFeatureWidget())),aa(this,"collapsed",(()=>{var t,e;"xsmall"===(null==(t=this.viewModel)||null==(e=t.view)?void 0:e.widthBreakpoint)&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation()})),ca(this,"viewModel.allActions","change",(()=>this._watchActions())),Xo(this,"viewModel.allActions",(()=>this._watchActions())),ta(this,"viewModel.featureViewModels",(()=>this._featureMenuViewportScrollTop()))])}destroy(){var t,e;this._destroySelectedFeatureWidget(),this._destroySpinner(),null==(t=this._handles)||t.destroy(),this._unobserveFeatureMenuObserver(),null==(e=this._featureMenuIntersectionObserver)||e.disconnect(),this._handles=null}get actionsMenuId(){return this.id+"-actions-menu"}get actionsMenuButtonId(){return this.id+"-actions-menu-button"}get featureMenuId(){return this.id+"-feature-menu"}get titleId(){return this.id+"-popup-title"}get contentId(){return this.id+"-popup-content"}get hasContent(){var t,e,i,s,n,r,o;return!!(this.selectedFeatureWidget?(null==(t=this.selectedFeatureWidget)||null==(e=t.viewModel)?void 0:e.waitingForContent)||"error"===(null==(i=this.selectedFeatureWidget)||null==(s=i.viewModel)?void 0:s.state)||(null==(n=this.selectedFeatureWidget)||null==(r=n.viewModel)?void 0:r.content):null==(o=this.viewModel)?void 0:o.content)}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return!!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}set actionsMenuOpen(t){this._set("actionsMenuOpen",!!t)}get actionsMenuOpen(){return!!this.viewModel.active&&this._get("actionsMenuOpen")}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||dG}set dockOptions(t){const e={...dG},i=this.get("viewModel.view.breakpoints"),s={};i&&(s.width=i.xsmall,s.height=i.xsmall);const n={...e,...t},r={...e.breakpoint,...s},{breakpoint:o}=n;!0===o?n.breakpoint=r:"object"==typeof o&&(n.breakpoint={...r,...o}),this._set("dockOptions",n),this._setCurrentDockPosition(),this.reposition()}get selectedFeatureWidget(){const{_feature:t,visibleElements:e,headingLevel:i}=this,{selectedFeatureViewModel:s}=this.viewModel,n={...e,title:!1};return s?(t?(t.viewModel=s,t.visibleElements=n):this._feature=new Az({headingLevel:i+1,viewModel:s,visibleElements:n}),this._feature):null}castVisibleElements(t){return{...gG,...t}}blur(){const{active:t}=this.viewModel;t||mG.warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender()}clear(){this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(t,e){return this.viewModel.fetchFeatures(t,e)}focus(){const{active:t}=this.viewModel;t||mG.warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender()}next(){return this.viewModel.next()}open(t){var e,i;this._handles.remove(lG);const s={collapsed:!!t&&!!t.collapsed,actionsMenuOpen:!!t&&!!t.actionsMenuOpen,featureMenuOpen:!!t&&!!t.featureMenuOpen};"xsmall"===(null==(e=this.viewModel)||null==(i=e.view)?void 0:i.widthBreakpoint)&&(s.collapsed=!0),this.set(s),this.viewModel.open(t),this._addSelectedFeatureIndexHandle()}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment()}triggerAction(t){this.viewModel.triggerAction(t)}render(){var t,e,i,s;const{actionsMenuOpen:n,dockEnabled:r,featureMenuVisible:o,dividedActions:a,currentAlignment:l,currentDockPosition:u}=this,{active:c}=this.viewModel,{menuActions:h}=a,d=null==(t=this.selectedFeature)||null==(e=t.layer)?void 0:e.title,p=null==(i=this.selectedFeature)||null==(s=i.layer)?void 0:s.id;return Bc("div",{class:this.classes("esri-popup",{"esri-popup--aligned-top-center":"top-center"===l,"esri-popup--aligned-bottom-center":"bottom-center"===l,"esri-popup--aligned-top-left":"top-left"===l,"esri-popup--aligned-bottom-left":"bottom-left"===l,"esri-popup--aligned-top-right":"top-right"===l,"esri-popup--aligned-bottom-right":"bottom-right"===l,"esri-popup--is-docked":c&&r,"esri-popup--shadow":c&&!r,"esri-popup--is-docked-top-left":"top-left"===u,"esri-popup--is-docked-top-center":"top-center"===u,"esri-popup--is-docked-top-right":"top-right"===u,"esri-popup--is-docked-bottom-left":"bottom-left"===u,"esri-popup--is-docked-bottom-center":"bottom-center"===u,"esri-popup--is-docked-bottom-right":"bottom-right"===u,"esri-popup--feature-menu-open":o,"esri-popup--actions-menu-open":c&&h.length>1&&n}),role:"presentation","data-layer-title":d,"data-layer-id":p,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},c?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return Bc("span",{"aria-hidden":"true",class:this.classes(hG,"esri-icon-loading-indicator","esri-rotating")})}renderNavigationLoading(){const{messagesCommon:t}=this;return this.viewModel.pendingPromisesCount?Bc("div",{key:fG("loading-container"),role:"presentation",class:"esri-popup__loading-container","aria-label":t.loading,title:t.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const t=Al(this.container);return Bc("span",{"aria-hidden":"true",class:this.classes(hG,{"esri-icon-right-triangle-arrow":t,"esri-popup__pagination-previous-icon--rtl":t,"esri-icon-left-triangle-arrow":!t,"esri-popup__pagination-previous-icon":!t})})}renderPreviousButton(){const{messages:t}=this;return Bc("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(cG,"esri-popup__pagination-previous"),"aria-label":t.previous,title:t.previous},this.renderPreviousIcon())}renderNextIcon(){const t=Al(this.container);return Bc("span",{"aria-hidden":"true",class:this.classes(hG,{"esri-icon-left-triangle-arrow":t,"esri-popup__pagination-next-icon--rtl":t,"esri-icon-right-triangle-arrow":!t,"esri-popup__pagination-next-icon":!t})})}renderNextButton(){const{messages:t}=this;return Bc("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(cG,"esri-popup__pagination-next"),"aria-label":t.next,title:t.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:t,featureMenuId:e,messagesCommon:i}=this,{featureCount:s,selectedFeatureIndex:n}=this.viewModel;return Bc("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(cG,"esri-popup__feature-menu-button"),"aria-haspopup":"true","aria-controls":e,"aria-expanded":""+t,"aria-label":i.menu,title:i.menu},this._getPageText(s,n))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:t}=this,e=this._wouldDockTo();return Bc("span",{"aria-hidden":"true",class:this.classes({"esri-icon-minimize":t,"esri-popup__icon--dock-icon":!t,"esri-icon-dock-right":!t&&("top-right"===e||"bottom-right"===e),"esri-icon-dock-left":!t&&("top-left"===e||"bottom-left"===e),"esri-icon-maximize":!t&&"top-center"===e,"esri-icon-dock-bottom":!t&&"bottom-center"===e},hG)})}renderDockButton(){var t,e,i;const{dockEnabled:s,messages:n}=this,r=null==(t=this.viewModel)||null==(e=t.view)?void 0:e.widthBreakpoint,o=s?n.undock:n.dock;return"xsmall"!==r&&null!=(i=this.dockOptions)&&i.buttonEnabled?Bc("div",{role:"button","aria-label":o,title:o,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(cG,"esri-popup__button--dock")},this.renderDockIcon()):null}renderTitle(){const{title:t}=this.viewModel,{titleId:e,collapsible:i,contentCollapsed:s,messagesCommon:n}=this,r={"esri-popup__header-container--button":i},o=Bc(wO,{level:this.headingLevel,class:"esri-popup__header-title",innerHTML:t}),a=i?Bc("button",{key:t+"--collapsible",id:e,title:s?n.expand:n.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes("esri-popup__header-container",r),"aria-expanded":s?"false":"true",onclick:this._toggleCollapsed},o):Bc("div",{key:t,id:e,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes("esri-popup__header-container",r)},o);return t?a:null}renderCloseIcon(){return Bc("span",{"aria-hidden":"true",class:this.classes(hG,"esri-icon-close")})}renderCloseButton(){const{visibleElements:t,messagesCommon:e}=this;return t.closeButton?Bc("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:cG,"aria-label":e.close,title:e.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return Bc("header",{class:"esri-popup__header"},this.renderTitle(),Bc("div",{class:"esri-popup__header-buttons"},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:t,hasContent:e,contentCollapsed:i}=this,{content:s}=this.viewModel;return e&&!i?Bc("article",{key:s,enterAnimation:this._createFeatureUpdatedAnimation(),id:t,class:"esri-popup__content"},this.renderContent()):null}renderActionsMenuButton(){const{actionsMenuId:t,actionsMenuButtonId:e,actionsMenuOpen:i,dividedActions:s,messagesCommon:n}=this,r=i?n.close:n.open,{menuActions:o}=s;return o.length?Bc("div",{key:fG("actions-menu-button"),class:this.classes(cG,"esri-popup__actions-menu-button"),role:"button",id:e,"aria-haspopup":"true","aria-controls":i?t:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":r,title:r},Bc("span",{"aria-hidden":"true",class:"esri-icon-handle-horizontal"})):null}renderMenuActions(){const{actionsMenuId:t,actionsMenuButtonId:e,actionsMenuOpen:i,dividedActions:s}=this,{menuActions:n,inlineActions:r}=s;return n.length&&i?Bc("ul",{id:t,role:"menu","aria-labelledby":e,key:fG("actions"),class:"esri-popup__actions",bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},n.toArray().map(((t,e)=>this.renderAction({action:t,index:e+r.length,type:"menu-item"})))):null}renderInlineActions(){const{inlineActions:t}=this.dividedActions;return!!t.length&&t.toArray().map(((t,e)=>this.renderAction({action:t,index:e,type:"inline"})))}renderInlineActionsContainer(){const{inlineActions:t,menuActions:e}=this.dividedActions,i=!!t.length,s=!!e.length;return i||s?Bc("div",{key:"inline-actions-container","data-inline-actions":""+i,"data-menu-actions":""+s,class:"esri-popup__inline-actions-container"},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?Bc("section",{key:fG("navigation"),class:this.classes("esri-popup__navigation")},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:t,dividedActions:e}=this,{inlineActions:i,menuActions:s}=e,n=!!i.length,r={"esri-popup__footer--has-pagination":t,"esri-popup__footer--has-actions":n,"esri-popup__footer--has-actions-menu":!!s.length};return t||n?Bc("div",{key:fG("feature-buttons"),class:this.classes("esri-popup__footer",r)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:t}=this,{featureViewModels:e,isLoadingFeature:i}=this.viewModel,s=Ni(t.selectedFeatures,{total:e.length});return Bc("section",{key:fG("menu"),class:"esri-popup__feature-menu"},Bc("strong",{class:"esri-popup__feature-menu-header"},s),Bc("nav",{bind:this,class:"esri-popup__feature-menu-viewport","data-node-ref":"_featureMenuViewportNode",afterCreate:Cl},this.renderFeatureMenu(),Bc("div",{class:"esri-popup__feature-menu-observer",bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),i?Bc("div",{class:"esri-popup__feature-menu-loader"},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:Bc("div",{key:fG("pointer"),class:"esri-popup__pointer",role:"presentation"},Bc("div",{class:this.classes("esri-popup__pointer-direction","esri-popup--shadow")}))}renderMainContainer(){const{dockEnabled:t,currentAlignment:e,currentDockPosition:i,titleId:s,contentId:n,collapsible:r,hasContent:o,contentCollapsed:a,visibleElements:l}=this,{title:u}=this.viewModel,c="bottom-left"===e||"bottom-center"===e||"bottom-right"===e||"top-left"===i||"top-center"===i||"top-right"===i,h="top-left"===e||"top-center"===e||"top-right"===e||"bottom-left"===i||"bottom-center"===i||"bottom-right"===i;return Bc("div",{class:this.classes("esri-popup__main-container","esri-widget",{"esri-popup--shadow":t,"esri-popup--is-collapsible":r,"esri-popup--is-collapsed":a}),tabIndex:l.closeButton?null:-1,role:"dialog","aria-labelledby":u?s:"","aria-describedby":o&&!a?n:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},c?this.renderFooter():null,c?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),h?this.renderFooter():null,h?this.renderFeatureMenuContainer():null)}renderContent(){var t;const e=null==(t=this.viewModel)?void 0:t.content;return e?"string"==typeof e?Bc("div",{key:e,innerHTML:e}):this.renderNodeContent(e):null}renderActionText(t){return Bc("span",{key:"text",class:"esri-popup__action-text"},t)}renderActionIcon(t){const e=this._getActionClass(t),i=this._getActionImage(t),s={"esri-icon-loading-indicator":t.active,"esri-rotating":t.active,[hG]:!!e,"esri-popup__action-image":!t.active&&!!i};return e&&(s[e]=!t.active),Bc("span",{key:"icon","aria-hidden":"true",class:this.classes(hG,s),styles:this._getIconStyles(i)})}renderAction(t){const{action:e,index:i,type:s}=t,n=this._getActionTitle(e),r={"esri-popup__action":"toggle"!==e.type,"esri-popup__action-toggle":"toggle"===e.type,"esri-popup__action-toggle--on":"toggle"===e.type&&e.value,"esri-popup__button--disabled":e.disabled},o=[this.renderActionIcon(e),this.renderActionText(n)],a="menu-item"===s?Bc("li",{key:e.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(cG,r),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},o):Bc("div",{key:e.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(cG,r),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},o);return e.visible?a:null}renderFeatureMenuItem(t,e){const{messages:i,messagesCommon:s}=this,{selectedFeatureIndex:n,selectedFeatureViewModel:r}=this.viewModel,o=t===r,a={"esri-popup__feature-menu-item--selected":o},l=o?Bc("span",{key:fG("feature-menu-selected-feature-"+n),title:i.selectedFeature,"aria-label":i.selectedFeature,class:"esri-icon-check-mark"}):null,u=Bc("span",{innerHTML:t.title||s.untitled});return Bc("li",{role:"menuitem",tabIndex:-1,key:fG("feature-menu-feature-"+n),class:this.classes(a,"esri-popup__feature-menu-item"),bind:this,"data-feature-index":e,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature},Bc("span",{class:"esri-popup__feature-menu-title"},u,l))}renderFeatureMenu(){const{featureMenuId:t}=this,{featureViewModels:e}=this.viewModel;return e.length>1?Bc("ol",{class:"esri-popup__feature-menu-list",id:t,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},e.filter((t=>!!t.graphic)).map(((t,e)=>this.renderFeatureMenuItem(t,e)))):null}_getActionTitle(t){const{messages:e,selectedFeature:i,messagesCommon:s}=this,{id:n}=t,r=null==i?void 0:i.attributes,o="zoom-to-feature"===n?Ni(t.title,{messages:e}):"remove-selected-feature"===n?Ni(t.title,{messages:s}):"zoom-to-clustered-features"===n||"browse-clustered-features"===n?Ni(t.title,{messages:e}):t.title;return o&&r?Ni(o,r):o}_getActionClass(t){const{selectedFeature:e}=this,i=null==e?void 0:e.attributes,{className:s,image:n}=t,r=n||s?s:"esri-icon-default-action";return r&&i?Ni(r,i):r}_getActionImage(t){const{selectedFeature:e}=this,i=null==e?void 0:e.attributes,{image:s}=t;return s&&i?Ni(s,i):s}_createFeatureUpdatedAnimation(){return Pl("enter","esri-popup--feature-updated")}_getInlineActionCount(){const{maxInlineActions:t,featureNavigationVisible:e}=this;if("number"!=typeof t)return null;const i=Math.round(t);return Math.max(e?i-1:i,0)}_watchActions(){const{allActions:t}=this.viewModel;this.notifyChange("dividedActions");const e="actions";this._handles.remove(e),t&&t.forEach((t=>{this._handles.add(ta(t,["active","className","disabled","id","title","image","visible"],(()=>this.scheduleRender())),e)}))}_divideActions(){const{allActions:t}=this.viewModel,e=this._getInlineActionCount(),i=null===e,s=0===e;return{inlineActions:i?t.slice(0):s?new qo:t.slice(0,e),menuActions:i?new qo:t.slice(s?0:e)}}_featureMenuOpenChanged(t){t?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0}_actionsMenuOpenChanged(t){t?this._focusFirstAction=!0:this._focusActionsMenuButton=!0}_setTitleFromFeatureWidget(){const{selectedFeatureWidget:t,messagesCommon:e}=this;var i,s;t&&(this.viewModel.title="error"===(null==(i=t.viewModel)?void 0:i.state)?e.errorMessage:(null==(s=t.viewModel)?void 0:s.title)||"")}_setContentFromFeatureWidget(){const{selectedFeatureWidget:t}=this;t&&(this.viewModel.content=t)}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(t){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(t),this._featureMenuIntersectionObserverNode=t}_handleFeatureMenuKeyup(t){"Escape"===qi(t)&&(t.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender())}_handleActionMenuKeyup(t){"Escape"===qi(t)&&(t.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender())}_handleFeatureMenuItemKeyup(t){const e=qi(t),{_featureMenuNode:i}=this,s=t.currentTarget["data-feature-index"];if(!i)return;const n=i.querySelectorAll("li"),r=n.length;"ArrowUp"!==e?"ArrowDown"!==e?"Home"!==e?"End"!==e||(t.stopPropagation(),n[n.length-1].focus()):(t.stopPropagation(),n[0].focus()):(t.stopPropagation(),n[(s+1+r)%r].focus()):(t.stopPropagation(),n[(s-1+r)%r].focus())}_handleActionMenuItemKeyup(t){const e=qi(t),{_actionsMenuNode:i}=this,s=t.currentTarget["data-action-index"];if(!i)return;const n=i.querySelectorAll("li"),r=n.length;"ArrowUp"!==e?"ArrowDown"!==e?"Home"!==e?"End"!==e||(t.stopPropagation(),n[n.length-1].focus()):(t.stopPropagation(),n[0].focus()):(t.stopPropagation(),n[(s+1+r)%r].focus()):(t.stopPropagation(),n[(s-1+r)%r].focus())}_handleMainKeyup(t){const e=qi(t);"ArrowLeft"===e&&(t.stopPropagation(),this.previous()),"ArrowRight"===e&&(t.stopPropagation(),this.next())}_spinnerEnabledChange(t){if(this._destroySpinner(),!t)return;const e=this.get("viewModel.view");this._createSpinner(e)}_hideSpinner(){const{_spinner:t}=this;t&&(t.location=null,t.hide())}_displaySpinner(){const{_spinner:t}=this;if(!t)return;const{location:e,waitingForResult:i}=this.viewModel;i?t.show({location:e}):t.hide()}_getIconStyles(t){return{"background-image":t?`url(${t})`:""}}_addSelectedFeatureIndexHandle(){const t=ta(this,"viewModel.selectedFeatureIndex",((t,e)=>this._selectedFeatureIndexUpdated(t,e)));this._handles.add(t,lG)}_selectedFeatureIndexUpdated(t,e){const{featureCount:i}=this;i&&t!==e&&-1!==t&&(this.actionsMenuOpen=!1,this.featureMenuOpen=!1)}_destroySelectedFeatureWidget(){const{_feature:t}=this;t&&(t.viewModel=null,t&&!t.destroyed&&t.destroy()),this._feature=null}_isScreenLocationWithinView(t,e){return t.x>-1&&t.y>-1&&t.x<=e.width&&t.y<=e.height}_isOutsideView(t){const{popupHeight:e,popupWidth:i,screenLocation:s,side:n,view:r}=t;if(isNaN(i)||isNaN(e)||!r||!s)return!1;const o=r.padding;return"right"===n&&s.x+i/2>r.width-o.right||"left"===n&&s.x-i/2<o.left||"top"===n&&s.y-e<o.top||"bottom"===n&&s.y+e>r.height-o.bottom}_calculateAutoAlignment(t){if("auto"!==t)return t;const{_pointerOffsetInPx:e,_containerNode:i,_mainContainerNode:s,viewModel:n}=this,{screenLocation:r,view:o}=n;if(c(r)||!o||!i)return"top-center";if(!this._isScreenLocationWithinView(r,o))return this._get("currentAlignment")||"top-center";function a(t){return parseInt(t.replace(/[^-\d\.]/g,""),10)}const l=s?window.getComputedStyle(s,null):null,u=l?a(l.getPropertyValue("max-height")):0,h=l?a(l.getPropertyValue("height")):0,{height:d,width:p}=i.getBoundingClientRect(),f=p+e,y=Math.max(d,u,h)+e,m=this._isOutsideView({popupHeight:y,popupWidth:f,screenLocation:r,side:"right",view:o}),g=this._isOutsideView({popupHeight:y,popupWidth:f,screenLocation:r,side:"left",view:o}),v=this._isOutsideView({popupHeight:y,popupWidth:f,screenLocation:r,side:"top",view:o}),w=this._isOutsideView({popupHeight:y,popupWidth:f,screenLocation:r,side:"bottom",view:o});return g?v?"bottom-right":"top-right":m?v?"bottom-left":"top-left":v?w?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(t){return"function"==typeof t?t.call(this):t}_getCurrentAlignment(){const{alignment:t,dockEnabled:e}=this;return e||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(t)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(t){const e=["left","right"];return Al(this.container)&&e.reverse(),t.replace(/leading/gi,e[0]).replace(/trailing/gi,e[1])}_callDockPosition(t){return"function"==typeof t?t.call(this):t}_getDockPosition(){var t;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null==(t=this.dockOptions)?void 0:t.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(t){var e;if("auto"!==t)return t;const i=null==(e=this.viewModel)?void 0:e.view,s=Al(this.container)?"top-left":"top-right";if(!i)return s;const n=i.padding||{left:0,right:0,top:0,bottom:0},r=i.width-n.left-n.right,{breakpoints:o}=i;return o&&r<=o.xsmall?"bottom-center":s}_positionContainer(t=this._containerNode){if(t&&(this._containerNode=t),!t)return;const{screenLocation:e}=this.viewModel,{width:i}=t.getBoundingClientRect(),s=this._calculatePositionStyle(e,i);s&&(t.style.top=s.top,t.style.left=s.left,t.style.bottom=s.bottom,t.style.right=s.right)}_calculateFullWidth(t){const{currentAlignment:e,_pointerOffsetInPx:i}=this;return"top-left"===e||"bottom-left"===e||"top-right"===e||"bottom-right"===e?t+i:t}_calculateAlignmentPosition(t,e,i,s){const{currentAlignment:n,_pointerOffsetInPx:r}=this,o=s/2,a=i.height-e,l=i.width-t,{padding:u}=this.view;return"bottom-center"===n?{top:e+r-u.top,left:t-o-u.left}:"top-left"===n?{bottom:a+r-u.bottom,right:l+r-u.right}:"bottom-left"===n?{top:e+r-u.top,right:l+r-u.right}:"top-right"===n?{bottom:a+r-u.bottom,left:t+r-u.left}:"bottom-right"===n?{top:e+r-u.top,left:t+r-u.left}:"top-center"===n?{bottom:a+r-u.bottom,left:t-o-u.left}:void 0}_calculatePositionStyle(t,e){const{dockEnabled:i,view:s}=this;if(!s)return;if(i)return{left:"",top:"",right:"",bottom:""};if(c(t)||!e)return;const n=this._calculateFullWidth(e),r=this._calculateAlignmentPosition(t.x,t.y,s,n);return r?{top:void 0!==r.top?r.top+"px":"auto",left:void 0!==r.left?r.left+"px":"auto",bottom:void 0!==r.bottom?r.bottom+"px":"auto",right:void 0!==r.right?r.right+"px":"auto"}:void 0}_viewChange(t,e){t&&e&&(this.close(),this.clear())}_viewReadyChange(t,e){if(t){const t=this.get("viewModel.view");this._wireUpView(t)}else e&&(this.close(),this.clear())}_wireUpView(t){if(this._destroySpinner(),!t)return;const{spinnerEnabled:e}=this;e&&this._createSpinner(t),this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(t,e,i){const[s,n]=t,[r,o]=e,{width:a,height:l}=i;return s<=a&&r>a||s>a&&r<=a||n<=l&&o>l||n>l&&o<=l}_updateDockEnabledForViewSize(t,e){if(!t||!e)return;const i=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},s=i.left+i.right,n=i.top+i.bottom,r=[],o=[];r[0]=t[0]-s,r[1]=t[1]-n,o[0]=e[0]-s,o[1]=e[1]-n;const{dockOptions:a}=this;this._dockingThresholdCrossed(r,o,a.breakpoint)&&this._setDockEnabledForViewSize(a),this._setCurrentDockPosition()}_focusDockButtonNode(t){this._focusDockButton&&(this._focusDockButton=!1,t.focus())}_closeButtonNodeUpdated(t){return this._focusClose?(this._focusClose=!1,void t.focus()):this._blurClose?(this._blurClose=!1,void t.blur()):void 0}_mainContainerNodeUpdated(t){return this._mainContainerNode=t,this._focusContainer?(this._focusContainer=!1,void t.focus()):this._blurContainer?(this._blurContainer=!1,void t.blur()):void 0}_featureMenuNodeUpdated(t){if(this._featureMenuNode=t,!t||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const e=t.querySelectorAll("li");e.length&&e[0].focus()}_actionsMenuNodeUpdated(t){if(this._actionsMenuNode=t,!t||!this._focusFirstAction)return;this._focusFirstAction=!1;const e=t.querySelectorAll("li");e.length&&e[0].focus()}_focusFeatureMenuButtonNode(t){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,t.focus())}_focusActionsMenuButtonNode(t){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,t.focus())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0)}_toggleScreenLocationEnabled(){const{dockEnabled:t,viewModel:e}=this;e&&(e.screenLocationEnabled=e.active&&!t)}_shouldDockAtCurrentViewSize(t){var e,i;const s=t.breakpoint,n=null==(e=this.viewModel)||null==(i=e.view)?void 0:i.ui;if(!n)return!1;const{width:r,height:o}=n;if(isNaN(r)||isNaN(o))return!1;const a=s.hasOwnProperty("width")&&r<=s.width,l=s.hasOwnProperty("height")&&o<=s.height;return a||l}_setDockEnabledForViewSize(t){t.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(t))}_getPageText(t,e){return this.featureNavigationVisible?Ni(this.messages.pageText,{index:e+1,total:t}):null}_destroySpinner(){const{_spinner:t,view:e}=this;t&&(e&&e.ui&&e.ui.remove(this._spinner,uG),t.destroy(),this._spinner=null)}_createSpinner(t){t&&(this._spinner=new Lz({view:t}),t.ui.add(this._spinner,{key:uG,position:"manual"}))}_toggleCollapsed(){this.collapsed=!this.collapsed}_close(){this.close(),this.view&&this.view.focus()}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender()}_toggleFeatureMenu(){const t=!this.featureMenuOpen;this._featureMenuOpenChanged(t),this.actionsMenuOpen=!1,this.featureMenuOpen=t}_toggleActionsMenu(){const t=!this.actionsMenuOpen;this._actionsMenuOpenChanged(t),this.featureMenuOpen=!1,this.actionsMenuOpen=t}_triggerAction(t){const e=t.currentTarget["data-action-index"],i=this.viewModel.allActions.getItemAt(e);i&&"toggle"===i.type&&(i.value=!i.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(e)}_selectFeature(t){const e=t.currentTarget["data-feature-index"];isNaN(e)||(this.viewModel.selectedFeatureIndex=e),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender()}_next(){this.next()}_previous(){this.previous()}};e([oe({readOnly:!0})],vG.prototype,"actionsMenuId",null),e([oe({readOnly:!0})],vG.prototype,"actionsMenuButtonId",null),e([oe({readOnly:!0})],vG.prototype,"featureMenuId",null),e([oe({readOnly:!0})],vG.prototype,"titleId",null),e([oe({readOnly:!0})],vG.prototype,"contentId",null),e([oe({readOnly:!0})],vG.prototype,"hasContent",null),e([oe({readOnly:!0})],vG.prototype,"featureNavigationVisible",null),e([oe({readOnly:!0})],vG.prototype,"collapsible",null),e([oe({readOnly:!0})],vG.prototype,"featureMenuVisible",null),e([oe({readOnly:!0})],vG.prototype,"contentCollapsed",null),e([oe({readOnly:!0})],vG.prototype,"dividedActions",null),e([ue("viewModel.actions")],vG.prototype,"actions",void 0),e([oe()],vG.prototype,"actionsMenuOpen",null),e([oe()],vG.prototype,"alignment",void 0),e([ue("viewModel.autoCloseEnabled")],vG.prototype,"autoCloseEnabled",void 0),e([ue("viewModel.autoOpenEnabled")],vG.prototype,"autoOpenEnabled",void 0),e([ue("viewModel.defaultPopupTemplateEnabled")],vG.prototype,"defaultPopupTemplateEnabled",void 0),e([ue("viewModel.content")],vG.prototype,"content",void 0),e([oe()],vG.prototype,"collapsed",void 0),e([oe()],vG.prototype,"collapseEnabled",void 0),e([oe({readOnly:!0})],vG.prototype,"currentAlignment",null),e([oe({readOnly:!0})],vG.prototype,"currentDockPosition",null),e([oe()],vG.prototype,"dockOptions",null),e([oe()],vG.prototype,"dockEnabled",void 0),e([ue("viewModel.featureCount")],vG.prototype,"featureCount",void 0),e([oe()],vG.prototype,"featureMenuOpen",void 0),e([ue("viewModel.features")],vG.prototype,"features",void 0),e([ue("viewModel.goToOverride")],vG.prototype,"goToOverride",void 0),e([oe()],vG.prototype,"headingLevel",void 0),e([ue("viewModel.highlightEnabled")],vG.prototype,"highlightEnabled",void 0),e([ue("viewModel.location")],vG.prototype,"location",void 0),e([oe({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],vG.prototype,"label",void 0),e([oe()],vG.prototype,"maxInlineActions",void 0),e([oe(),zc("esri/widgets/Popup/t9n/Popup")],vG.prototype,"messages",void 0),e([oe(),zc("esri/t9n/common")],vG.prototype,"messagesCommon",void 0),e([ue("viewModel.promises")],vG.prototype,"promises",void 0),e([ue("viewModel.selectedFeature")],vG.prototype,"selectedFeature",void 0),e([ue("viewModel.selectedFeatureIndex")],vG.prototype,"selectedFeatureIndex",void 0),e([oe({readOnly:!0})],vG.prototype,"selectedFeatureWidget",null),e([oe()],vG.prototype,"spinnerEnabled",void 0),e([ue("viewModel.title")],vG.prototype,"title",void 0),e([ue("viewModel.updateLocationEnabled")],vG.prototype,"updateLocationEnabled",void 0),e([ue("viewModel.view")],vG.prototype,"view",void 0),e([oe({type:aG}),Gc(["triggerAction","trigger-action"])],vG.prototype,"viewModel",void 0),e([ue("viewModel.visible")],vG.prototype,"visible",void 0),e([oe()],vG.prototype,"visibleElements",void 0),e([ba("visibleElements")],vG.prototype,"castVisibleElements",null),e([Vc()],vG.prototype,"_close",null),e([Vc()],vG.prototype,"_toggleDockEnabled",null),e([Vc()],vG.prototype,"_toggleFeatureMenu",null),e([Vc()],vG.prototype,"_toggleActionsMenu",null),e([Vc()],vG.prototype,"_triggerAction",null),e([Vc()],vG.prototype,"_selectFeature",null),e([Vc()],vG.prototype,"_next",null),e([Vc()],vG.prototype,"_previous",null),vG=e([si(yG)],vG);const wG=vG,bG=[0,0];function MG(t){t&&(fr(t),t.parentNode&&t.parentNode.removeChild(t))}const SG=t=>{let i=class extends t{constructor(...t){super(...t),this._freqInfo={freq:16,time:750},this._overlayRenderTaskHandle=null,this.height=0,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.handles.add([this.watch("cursor",(t=>{const e=this.surface;e&&e.setAttribute("data-cursor",t)})),this.watch("interacting",(t=>{const e=this.surface;e&&e.setAttribute("data-interacting",""+t)}))])}initialize(){this.handles.add(this.watch("ui",((t,e)=>this._handleUIChange(t,e)))),this._wireUI(this.ui),this.handles.add([this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))])}destroy(){this.destroyed||(this.ui&&(this.ui.destroy(),this.ui=null),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null)}set container(t){const e=this._get("container");if(e===t)return;const i="dom-size";if(this.handles.remove(i),this._stopMeasuring(),e&&(e.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),MG(this.root),this._set("root",null),mr(this.userContent,e),MG(this.userContent),this._set("userContent",null)),t){t.classList.add("esri-view");const e=document.createElement("div");e.className="esri-view-user-storage",mr(t,e),t.appendChild(e),this._set("userContent",e);const s=document.createElement("div");s.className="esri-view-root",t.insertBefore(s,t.firstChild),this._set("root",s);const n=document.createElement("div");n.className="esri-view-surface",n.setAttribute("role","application"),n.tabIndex=0,s.appendChild(n),this._set("surface",n);const r=new pC;s.appendChild(r.surface),this._set("overlay",r),r.watch("needsRender",(t=>{t&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=Qr({render:()=>{this.overlay.render()}}):this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null)})),this.forceDOMReadyCycle(),this.handles.add(Xo(this,"size",(t=>{const[e,i]=t,s="esri-view-surface--inset-outline";e>=document.body.clientWidth||i>=document.body.clientHeight?n.classList.add(s):n.classList.remove(s)})),i),this._set("container",t),this._startMeasuring()}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null)}get focused(){const t=document.activeElement===this.surface;return document.hasFocus()&&t}get popup(){return this._get("popup")||new wG({view:this})}set popup(t){const e=this._get("popup");e&&e!==t&&e.destroy(),this._set("popup",t)}get size(){return[this.width,this.height]}blur(){this.surface&&this.surface.blur()}focus(){this.surface&&this.surface.focus()}pageToContainer(t,e,i){const s=this.position;return t-=s[0],e-=s[1],i?(i[0]=t,i[1]=e):i=[t,e],i}containerToPage(t,e,i){const s=this.position;return t+=s[0],e+=s[1],i?(i[0]=t,i[1]=e):i=[t,e],i}_handleUIChange(t,e){e&&(this.handles.remove("ui"),e.destroy()),t&&this._wireUI(t),this._set("ui",t)}_wireUI(t){this.handles.remove("ui"),t&&(t.view=this,this.handles.add([Xo(this,"root",(e=>{t.container=e?function(t){const e=document.createElement("div");return t.appendChild(e),e}(e):null})),Xo(this,"popup",((e,i)=>{const s="popup";i&&t.remove(i,s),e&&(e.view=t.view,t.add(e,{key:s,position:"manual"}))}))],"ui"))}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1)}_startMeasuring(){const t=this._freqInfo;t.freq=16,t.time=750,this.handles.add([(()=>{const e=()=>{t.freq=16,t.time=750};return window.addEventListener("resize",e),{remove(){window.removeEventListener("resize",e)}}})(),Qr({prepare:t=>{const e=this._measure(),i=this._freqInfo;if(i.time+=t.deltaTime,e&&(i.freq=16,this._get("resizing")||this._set("resizing",!0)),i.time<i.freq)return;i.time=0;const s=this._position();i.freq=s||e?16:Math.min(750,2*i.freq),!e&&i.freq>=512&&this._get("resizing")&&this._set("resizing",!1)}})],"measuring"),this._measure(),this._position()}_measure(){const t=this.container,e=t?t.clientWidth:0,i=t?t.clientHeight:0;if(0===e||0===i)return this.suspended||this._set("suspended",!0),!1;const s=this.width,n=this.height;return e===s&&i===n?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",e),this._set("height",i),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:s,oldHeight:n,width:e,height:i}),!0)}_position(){const t=this.position,e=function(t){const e=(t.ownerDocument||window.document).defaultView,i=t.getBoundingClientRect();return bG[0]=i.left+e.pageXOffset,bG[1]=i.top+e.pageYOffset,bG}(this.container);return!(t&&e[0]===t[0]&&e[1]===t[1]||(this._set("position",[e[0],e[1]]),0))}forceDOMReadyCycle(){}};return e([oe({value:null,cast:t=>pr(t)})],i.prototype,"container",null),e([oe({readOnly:!0})],i.prototype,"focused",null),e([oe({readOnly:!0})],i.prototype,"height",void 0),e([oe({type:wG})],i.prototype,"popup",null),e([oe({type:pC})],i.prototype,"overlay",void 0),e([oe({readOnly:!0})],i.prototype,"position",void 0),e([oe({readOnly:!0})],i.prototype,"resizing",void 0),e([oe({readOnly:!0})],i.prototype,"root",void 0),e([oe({value:null,readOnly:!0})],i.prototype,"size",null),e([oe({readOnly:!0})],i.prototype,"surface",void 0),e([oe({readOnly:!0})],i.prototype,"suspended",void 0),e([oe()],i.prototype,"ui",void 0),e([oe({readOnly:!0})],i.prototype,"userContent",void 0),e([oe({readOnly:!0})],i.prototype,"width",void 0),e([oe()],i.prototype,"widthBreakpoint",void 0),i=e([si("esri.views.DOMContainer")],i),i};var xG;let kG=xG=class extends Vd{constructor(t){super(t),this.cols=null,this.level=0,this.levelValue=null,this.resolution=0,this.rows=null,this.scale=0}clone(){return new xG({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};e([oe({type:Number,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],kG.prototype,"cols",void 0),e([oe({type:Rt,json:{write:!0}})],kG.prototype,"level",void 0),e([oe({type:String,json:{write:!0}})],kG.prototype,"levelValue",void 0),e([oe({type:Number,json:{write:!0}})],kG.prototype,"resolution",void 0),e([oe({type:Number,json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],kG.prototype,"rows",void 0),e([oe({type:Number,json:{write:!0}})],kG.prototype,"scale",void 0),kG=xG=e([si("esri.layers.support.LOD")],kG);const IG=kG;var jG;const _G=new ri({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});let TG=jG=class extends Vd{constructor(t){super(t),this.dpi=96,this.format=null,this.origin=null,this.minScale=0,this.maxScale=0,this.size=null,this.spatialReference=null}static create(t={}){const{resolutionFactor:e=1,scales:i,size:s=256,spatialReference:n=ap.WebMercator,numLODs:r=24}=t;if(!sp(n)){const t=[];if(i)for(let e=0;e<i.length;e++){const s=i[e];t.push({level:e,scale:s,resolution:s})}else{let e=5e-4;for(let i=r-1;i>=0;i--)t.unshift({level:i,scale:e,resolution:e}),e*=2}return new jG({dpi:96,lods:t,origin:new Fp(0,0,n),size:[s,s],spatialReference:n})}const o=Jd(n),a=new Fp(t.origin?{x:t.origin.x,y:t.origin.y,spatialReference:n}:o?{x:o.origin[0],y:o.origin[1],spatialReference:n}:{x:0,y:0,spatialReference:n}),l=1/(39.37*DS(n)*96),u=[];if(i)for(let t=0;t<i.length;t++){const e=i[t];u.push({level:t,scale:e,resolution:e*l})}else{let t=Zd(n)?512/s*591657527.5917094:256/s*591657527.591555;const i=Math.ceil(r/e);u.push({level:0,scale:t,resolution:t*l});for(let s=1;s<i;s++){const i=t/2**e;u.push({level:s,scale:i,resolution:i*l}),t=i}}return new jG({dpi:96,lods:u,origin:a,size:[s,s],spatialReference:n})}get isWrappable(){const{spatialReference:t,origin:e}=this;if(t&&e){const i=Jd(t);return t.isWrappable&&Math.abs(i.origin[0]-e.x)<=i.dx}return!1}readOrigin(t,e){return Fp.fromJSON({spatialReference:e.spatialReference,...t})}set lods(t){let e=0,i=0;const s=[];this._levelToLOD={},t&&(e=-1/0,i=1/0,t.forEach((t=>{s.push(t.scale),e=t.scale>e?t.scale:e,i=t.scale<i?t.scale:i,this._levelToLOD[t.level]=t}))),this._set("scales",s),this._set("minScale",e),this._set("maxScale",i),this._set("lods",t),this._initializeUpsampleLevels()}readSize(t,e){return[e.cols,e.rows]}writeSize(t,e){e.cols=t[0],e.rows=t[1]}zoomToScale(t){const e=this.scales;if(t<=0)return e[0];if(t>=e.length-1)return e[e.length-1];{const i=Math.floor(t);return e[i]/(e[i]/e[i+1])**(t-i)}}scaleToZoom(t){const e=this.scales,i=e.length-1;let s=0;for(;s<i;s++){const i=e[s],n=e[s+1];if(i<=t)return s;if(n===t)return s+1;if(i>t&&n<t)return s+Math.log(i/t)/Math.log(i/n)}return s}snapScale(t,e=.95){const i=this.scaleToZoom(t);return this.zoomToScale(i%Math.floor(i)>=e?Math.ceil(i):Math.floor(i))}tileAt(t,e,i,s){const n=this.lodAt(t);if(!n)return null;let r,o;if("number"==typeof e)r=e,o=i;else if(Hd(e.spatialReference,this.spatialReference))r=e.x,o=e.y,s=i;else{const t=Mp(e,this.spatialReference);if(c(t))return null;r=t.x,o=t.y,s=i}const a=n.resolution*this.size[0],l=n.resolution*this.size[1];return s||(s={id:null,level:0,row:0,col:0,extent:ag()}),s.level=t,s.row=Math.floor((this.origin.y-o)/l+.001),s.col=Math.floor((r-this.origin.x)/a+.001),this.updateTileInfo(s),s}updateTileInfo(t,e=0){let i=this.lodAt(t.level);if(!i&&1===e){const e=this.lods[this.lods.length-1];e.level<t.level&&(i=e)}if(!i)return;const s=t.level-i.level,n=i.resolution*this.size[0]/2**s,r=i.resolution*this.size[1]/2**s;t.id=`${t.level}/${t.row}/${t.col}`,t.extent||(t.extent=ag()),t.extent[0]=this.origin.x+t.col*n,t.extent[1]=this.origin.y-(t.row+1)*r,t.extent[2]=t.extent[0]+n,t.extent[3]=t.extent[1]+r}upsampleTile(t){const e=this._upsampleLevels[t.level];return!(!e||-1===e.parentLevel||(t.level=e.parentLevel,t.row=Math.floor(t.row/e.factor+.001),t.col=Math.floor(t.col/e.factor+.001),this.updateTileInfo(t),0))}getTileBounds(t,e){const{resolution:i}=this.lodAt(e.level),s=i*this.size[0],n=i*this.size[1];return t[0]=this.origin.x+e.col*s,t[1]=this.origin.y-(e.row+1)*n,t[2]=t[0]+s,t[3]=t[1]+n,t}lodAt(t){return this._levelToLOD&&this._levelToLOD[t]||null}clone(){return jG.fromJSON(this.write({}))}_initializeUpsampleLevels(){const t=this.lods;this._upsampleLevels=[];let e=null;for(let i=0;i<t.length;i++){const s=t[i];this._upsampleLevels[s.level]={parentLevel:e?e.level:-1,factor:e?e.resolution/s.resolution:0},e=s}}};e([oe({type:Number,json:{write:!0}})],TG.prototype,"compressionQuality",void 0),e([oe({type:Number,json:{write:!0}})],TG.prototype,"dpi",void 0),e([oe({type:String,json:{read:_G.read,write:_G.write,origins:{"web-scene":{read:!1,write:!1}}}})],TG.prototype,"format",void 0),e([oe({readOnly:!0})],TG.prototype,"isWrappable",null),e([oe({type:Fp,json:{write:!0}})],TG.prototype,"origin",void 0),e([Sd("origin")],TG.prototype,"readOrigin",null),e([oe({type:[IG],value:null,json:{write:!0}})],TG.prototype,"lods",null),e([oe({readOnly:!0})],TG.prototype,"minScale",void 0),e([oe({readOnly:!0})],TG.prototype,"maxScale",void 0),e([oe({readOnly:!0})],TG.prototype,"scales",void 0),e([oe({cast:t=>Array.isArray(t)?t:"number"==typeof t?[t,t]:[256,256]})],TG.prototype,"size",void 0),e([Sd("size",["rows","cols"])],TG.prototype,"readSize",null),e([xd("size",{cols:{type:Rt},rows:{type:Rt}})],TG.prototype,"writeSize",null),e([oe({type:ap,json:{write:!0}})],TG.prototype,"spatialReference",void 0),TG=jG=e([si("esri.layers.support.TileInfo")],TG);const OG=TG,AG=t=>{let i=class extends t{async fetchPopupFeatures(t,e){await this.when();const{location:i,queryArea:s,layerViewsAndGraphics:n,clientOnlyGraphics:r}=await this._prepareFetchPopupFeatures(t,e),o=Promise.resolve(r),a=this._queryLayerPopupFeatures(s,n,e);return{location:i,clientOnlyGraphics:r,allGraphicsPromise:os([o,...a.map((t=>t.promise))]).then(P),promisesPerLayerView:a}}_queryLayerPopupFeatures(t,e,i){return e.map((({layerView:e,graphics:s})=>{const n={clientGraphics:s,event:u(i)?i.event:null,signal:u(i)?i.signal:null,defaultPopupTemplateEnabled:!!u(i)&&!!i.defaultPopupTemplateEnabled},r=e.fetchPopupFeatures(t,n);return{layerView:e,promise:r}}))}_isValidPopupGraphic(t,e){return t&&!!t.getEffectivePopupTemplate(u(e)&&e.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(t,e){const{clientGraphics:i,queryArea:s,location:n}=await this._popupHitTestGraphics(t,e),r=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:o,clientOnlyGraphics:a}=this._graphicsPerFetchPopupLayerView(i,r);return{clientOnlyGraphics:a,layerViewsAndGraphics:o,queryArea:s,location:n}}async _popupHitTestGraphics(t,e){const{results:i,mapPoint:s}=await this.popupHitTest(t),n=i.filter((t=>this._isValidPopupGraphic(t.graphic,e))),r=n.length?n[0].mapPoint:null;return{clientGraphics:n.map((t=>t.graphic)),queryArea:s,location:s||r}}_getFetchPopupLayerViews(){const t=[];return this.allLayerViews.forEach((e=>{this._isValidPopupLayerView(e)&&t.push(e)})),u(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&t.push(this.graphicsView),t.reverse()}_isValidPopupLayerView(t){return u(t)&&(!("layer"in t)||!t.suspended)&&"fetchPopupFeatures"in t}_graphicsPerFetchPopupLayerView(t,e){const i=[],s=new Map,n=e.map((t=>{const e=[];return s.set("layer"in t?t.layer:t.graphics,e),{layerView:t,graphics:e}}));for(const e of t){const t=s.get(e.layer)||s.get(e.sourceLayer)||null;t?t.push(e):i.push(e)}return{layerViewsAndGraphics:n,clientOnlyGraphics:i}}};return i=e([si("esri.views.PopupView")],i),i};ct.getLogger("esri.core.support.OwningCollection");let FG=class extends(XM(qo)){constructor(t){super(t),this.handles.add([this.on("before-add",(t=>{c(t.item)&&t.preventDefault()})),this.on("after-add",(t=>this._own(t.item))),this.on("after-remove",(t=>this._release(t.item)))])}get owner(){return this._get("owner")}set owner(t){t!==this._get("owner")&&(this._releaseAll(),this._set("owner",t),this._ownAll())}_ownAll(){for(const t of this.items)this._own(t)}_releaseAll(){for(const t of this.items)this._release(t)}_createNewInstance(t){return this.itemType?new(qo.ofType(this.itemType.Type))(t):new qo(t)}};function CG(t,e){return{type:t,cast:_v,set(i){const s=jv(i,this._get(e),t);s.owner=this,this._set(e,s)}}}e([oe()],FG.prototype,"owner",null),FG=e([si("esri.core.support.OwningCollection")],FG);let PG=class extends FG{_own(t){t.layer&&"remove"in t.layer&&t.layer!==this.owner&&t.layer.remove(t),t.layer=this.owner}_release(t){t.layer===this.owner&&(t.layer=null)}};e([Oo({Type:hj,ensureType:Tt(hj)})],PG.prototype,"itemType",void 0),PG=e([si("esri.support.GraphicsCollection")],PG);let EG=class extends jo{constructor(t){super(t),this.view=null,this.baseLayerViews=new qo,this.referenceLayerViews=new qo,this._loadingHandle=Xo(this,"view.map.basemap",(t=>{t&&t.load().catch((()=>{}))}))}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null)}get suspended(){return!this.view||this.view.suspended}get updating(){return!(this.view&&this.view.suspended||!(this.view&&this.view.map&&this.view.map.basemap)||this.view.map.basemap.loaded)}};e([oe({constructOnly:!0})],EG.prototype,"view",void 0),e([oe({readOnly:!0})],EG.prototype,"baseLayerViews",void 0),e([oe({readOnly:!0})],EG.prototype,"referenceLayerViews",void 0),e([oe({readOnly:!0})],EG.prototype,"suspended",null),e([oe({type:Boolean,readOnly:!0})],EG.prototype,"updating",null),EG=e([si("esri.views.BasemapView")],EG);const RG=ct.getLogger("esri.views.LayerViewManager");class LG{constructor(t,e,i){this.layer=t,this.view=e,this.layerViewImporter=i,this._controller=new AbortController,this._deferred=ns(),this._started=!1,this.done=!1,Xi(this._controller.signal,(()=>{const e=new Ve("cancelled:layerview-create","layerview creation cancelled",{layer:t});this._deferred.reject(e)}))}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:t}=this;if(!t)return;const{layer:e,view:i}=this;e.emit("layerview-destroy",{view:i,layerView:t}),i.emit("layerview-destroy",{layer:e,layerView:t}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null}async start(){if(this._started)return;this._started=!0;const{_controller:{signal:t},layer:e,view:i}=this;this._map=i.map;try{var s,n;let r,o;if(await e.load({signal:t}),"prefetchResources"in e&&await e.prefetchResources({signal:t}),e.createLayerView)r=await e.createLayerView(i,{signal:t});else{if(!this.layerViewImporter.hasLayerViewModule(e))throw new Ve("layer:view-not-supported","No layerview implementation was found");const s=await this.layerViewImporter.importLayerView(e);Ji(t),r="default"in s?new s.default({layer:e,view:i}):new s({layer:e,view:i})}const a=()=>{o=v(o),r.destroyed||r.destroy(),r.layer=null,r.parent=null,r.view=null,this.done=!0};o=Xi(t,a),Ji(t);try{await r.when()}catch(t){throw a(),t}if(!(null==(s=this._map)||null==(n=s.allLayers)?void 0:n.includes(e)))return a(),void this._deferred.reject(new Ve("view:no-layerview-for-layer","The layer has been removed from the map",{layer:e}));this.layerView=r,e.emit("layerview-create",{view:i,layerView:r}),i.emit("layerview-create",{layer:e,layerView:r}),this.done=!0,this._deferred.resolve(r)}catch(t){e.emit("layerview-create-error",{view:i,error:t}),i.emit("layerview-create-error",{layer:e,error:t}),this.done=!0,this._deferred.reject(new Ve("layerview:create-error","layerview creation failed",{layer:e,error:t}))}}}let NG=class extends tS{constructor(t){super(t),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new KM,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var t;const e=null==(t=this.view.map)?void 0:t.allLayers;if(e)for(const t of e)this.layerViewImporter.hasLayerViewModule(t)&&this.layerViewImporter.importLayerView(t)},this._reschedule=()=>(c(this._workPromise)&&(this._workPromise=ns()),this.handles.remove("reschedule"),this.handles.add(Zr(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var t,e,i;const s=this.view.map;if(this._map!==s&&(this.clear(),this._map=s),c(this._workPromise))return void this.notifyChange("updating");this.handles.remove("reschedule"),this.handles.remove("collection-change");const n=new nA({getCollections:()=>this._rootCollectionNames.map((t=>this.get(t))),getChildrenFunction:t=>t&&"layers"in t?t.layers:null});if(!n)return this._workPromise.resolve(),void(this._workPromise=null);for(const t of n)this._createLayerView(t);this._refreshCollections();for(const[t,e]of this._layerLayerViewInfoMap)n.includes(t)||(this._layerLayerViewInfoMap.delete(e.layer),e.destroy());const r=n.filter((t=>"group"===t.type)).map((t=>t.layers)),o=[null==s||null==(t=s.ground)?void 0:t.layers,null==s||null==(e=s.basemap)?void 0:e.baseLayers,null==s||null==(i=s.basemap)?void 0:i.referenceLayers,null==s?void 0:s.layers,...r].filter((t=>!!t));this.handles.add(o.map((t=>this._watchUpdatingTracking.addOnCollectionChange(t,this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null}}initialize(){this.handles.add([ca(this,"view.map.allLayers","change",this._preloadLayerViewModules,this._preloadLayerViewModules),Xo(this.view,["map.basemap","map.ground","map.layers","ready"],this._reschedule,!0)]),this._preloadLayerViewModules(),this._reschedule()}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null}get _layersToLayerViews(){const t=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&t.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(t)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return u(this._workPromise)||this._watchUpdatingTracking.updating||ht(this._layerLayerViewInfoMap,(t=>!t.done))}get updatingRemaining(){let t=0;for(const e of this._layerLayerViewInfoMap.values())e.done||++t;return t}clear(){if(!this.destroyed){for(const t of this._layerLayerViewInfoMap.values())t.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections()}}async whenLayerView(t){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(t))throw new Ve("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:t});return this._layerLayerViewInfoMap.get(t).promise}_refreshCollections(){for(const[t,e]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(t),this.get(e),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining")}_populateLayerViewsOwners(t,e,i){if(!t||!e)return void(e&&e.removeAll());let s=0;for(const n of t){const t=this._layerLayerViewInfoMap.get(n);if(!t||!t.layerView)continue;const r=t.layerView;r.layer=n,r.parent=i,e.getItemAt(s)!==r&&e.splice(s,0,r),n.layers&&this._populateLayerViewsOwners(n.layers,r.layerViews,r),s+=1}s<e.length&&e.splice(s,e.length)}_createLayerView(t){if(this._layerLayerViewInfoMap.has(t))return this.view.ready&&this._layerLayerViewInfoMap.get(t).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");t.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(t)&&this.layerViewImporter.importLayerView(t);const e=new LG(t,this.view,this.layerViewImporter);e.promise.then((()=>this._refreshCollections()),(e=>{var i,s;e&&(is(e)||"cancelled:layerview-create"===e.name)||RG.error(`Failed to create layerview for layer title:'${null!=(i=t.title)?i:"no title"}', id:'${null!=(s=t.id)?s:"no id"}' of type '${t.type}'.`,{layer:t,error:e}),this._refreshCollections()})),this._layerLayerViewInfoMap.set(t,e),this.view.ready&&e.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining")}};e([oe()],NG.prototype,"_workPromise",void 0),e([oe({readOnly:!0})],NG.prototype,"_watchUpdatingTracking",void 0),e([oe({readOnly:!0})],NG.prototype,"_layersToLayerViews",null),e([oe({readOnly:!0})],NG.prototype,"_rootCollectionNames",null),e([oe()],NG.prototype,"layerViewImporter",void 0),e([oe()],NG.prototype,"supportsGround",void 0),e([oe({readOnly:!0})],NG.prototype,"updating",null),e([oe({readOnly:!0})],NG.prototype,"updatingRemaining",null),e([oe({constructOnly:!0})],NG.prototype,"view",void 0),NG=e([si("esri.views.LayerViewManager")],NG);const DG=NG;let VG=class extends jo{constructor(t){super(t),this.factor=1.5,this.offset=pm(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};e([oe({type:Number})],VG.prototype,"factor",void 0),e([oe({nonNullable:!0})],VG.prototype,"offset",void 0),e([oe()],VG.prototype,"position",void 0),e([oe({type:Number,range:{min:0}})],VG.prototype,"size",void 0),e([oe()],VG.prototype,"maskUrl",void 0),e([oe()],VG.prototype,"maskEnabled",void 0),e([oe()],VG.prototype,"overlayUrl",void 0),e([oe()],VG.prototype,"overlayEnabled",void 0),e([oe({readOnly:!0})],VG.prototype,"version",null),e([oe({type:Boolean})],VG.prototype,"visible",void 0),VG=e([si("esri.views.Magnifier")],VG);const $G=VG;let zG=class extends jo{constructor(){super(...arguments),this._tasks=[],this.running=!1}get length(){return this._tasks.length}destroy(){this.cancelAll()}runTask(t){for(;!t.done&&this._process(t);)t.madeProgress()}push(t,e,i){return this.running=!0,new Promise(((s,n)=>this._tasks.push(new GG(s,n,t,e,i))))}unshift(t,e,i){return this.running=!0,new Promise(((s,n)=>this._tasks.unshift(new GG(s,n,t,e,i))))}_process(t){if(0===this._tasks.length)return!1;const e=this._tasks.shift();try{const i=Qi(e.signal);if(i&&!e.abortCallback)e.reject(Hi());else{const s=i?e.abortCallback(Hi()):e.callback(t);ds(s)?s.then(e.resolve,e.reject):e.resolve(s)}}catch(t){e.reject(t)}return this.running=this._tasks.length>0,!0}cancelAll(){const t=Hi();for(const e of this._tasks)if(e.abortCallback){const i=e.abortCallback(t);e.resolve(i)}else e.reject(t);this._tasks.length=0,this.running=!1}};e([oe()],zG.prototype,"running",void 0),zG=e([si("esri.layers.support.PromiseQueue")],zG);class GG{constructor(t,e,i,s,n){this.resolve=t,this.reject=e,this.callback=i,this.signal=s,this.abortCallback=n}}let UG=class extends jo{constructor(){super(...arguments),this.SCHEDULER_LOG_SLOW_TASKS=!1,this.FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES=!1}};e([oe()],UG.prototype,"SCHEDULER_LOG_SLOW_TASKS",void 0),e([oe()],UG.prototype,"FEATURE_SERVICE_SNAPPING_SOURCE_TILE_TREE_SHOW_TILES",void 0),UG=e([si("esri.views.support.DebugFlags")],UG);const qG=new UG,BG=ct.getLogger("esri.views.support.Scheduler");var WG;!function(t){t.RESOURCE_CONTROLLER="schedule",t.SLIDE="slide",t.STREAM_DATA_LOADER="stream loader",t.ELEVATION_QUERY="elevation query",t.TERRAIN_SURFACE="terrain",t.SURFACE_GEOMETRY_UPDATES="surface geometry updates",t.GRAPHICS_CORE="Graphics3D",t.I3S_CONTROLLER="I3S",t.POINT_CLOUD_LAYER="point cloud",t.FEATURE_TILE_FETCHER="feature fetcher",t.OVERLAY="overlay",t.STAGE="stage",t.GRAPHICS_DECONFLICTOR="graphics deconflictor",t.FILTER_VISIBILITY="Graphics3D filter visibility",t.SCALE_VISIBILITY="Graphics3D scale visibility",t.FRUSTUM_VISIBILITY="Graphics3D frustum visibility",t.POINT_OF_INTEREST_FREQUENT="POI frequent",t.POINT_OF_INTEREST_INFREQUENT="POI infrequent",t.LABELER="labeler",t.FEATURE_QUERY_ENGINE="feature query",t.FEATURE_TILE_TREE="feature tile tree",t.FEATURE_TILE_TREE_ACTIVE="fast feature tile tree",t.ELEVATION_ALIGNMENT="elevation alignment",t.TEXT_TEXTURE_ATLAS="text texture atlas",t.TEXTURE_UNLOAD="texture unload",t.LINE_OF_SIGHT_TOOL="line of sight tool",t.LINE_OF_SIGHT_TOOL_INTERACTIVE="interactive line of sight tool",t.ELEVATION_PROFILE="elevation profile",t.SNAPPING="snapping",t.SHADOW_ACCUMULATOR="shadow accumulator",t.CLOUDS_GENERATOR="cloud generator",t[t.TEST_PRIO=1]="TEST_PRIO"}(WG||(WG={}));const HG=new Map([[WG.RESOURCE_CONTROLLER,0],[WG.SLIDE,0],[WG.STREAM_DATA_LOADER,0],[WG.ELEVATION_QUERY,0],[WG.TERRAIN_SURFACE,1],[WG.SURFACE_GEOMETRY_UPDATES,1],[WG.GRAPHICS_CORE,2],[WG.I3S_CONTROLLER,2],[WG.POINT_CLOUD_LAYER,2],[WG.FEATURE_TILE_FETCHER,2],[WG.OVERLAY,4],[WG.STAGE,4],[WG.GRAPHICS_DECONFLICTOR,4],[WG.FILTER_VISIBILITY,4],[WG.SCALE_VISIBILITY,4],[WG.FRUSTUM_VISIBILITY,4],[WG.POINT_OF_INTEREST_FREQUENT,6],[WG.POINT_OF_INTEREST_INFREQUENT,30],[WG.LABELER,8],[WG.FEATURE_QUERY_ENGINE,8],[WG.FEATURE_TILE_TREE,16],[WG.FEATURE_TILE_TREE_ACTIVE,0],[WG.ELEVATION_ALIGNMENT,12],[WG.TEXT_TEXTURE_ATLAS,12],[WG.CLOUDS_GENERATOR,12],[WG.TEXTURE_UNLOAD,12],[WG.LINE_OF_SIGHT_TOOL,16],[WG.LINE_OF_SIGHT_TOOL_INTERACTIVE,0],[WG.SNAPPING,0],[WG.SHADOW_ACCUMULATOR,30]]);function JG(t){return HG.has(t)?HG.get(t):"number"==typeof t?t:1}const ZG=1e3/30;var QG,KG;!function(t){let i=class extends jo{constructor(t){super(t),this.updating=!0,this._microTaskQueued=!1,this.performanceInfo={total:new Rr("total"),tasks:new Map},this._frameTaskTimes=new Map,this._budget=null,this._state=1,this._tasks=new Dr,this._runQueue=new Dr,this._load=0,this._idleStateCallbacks=new Dr,this._idleUpdatesStartFired=!1,this._maxReschedule=tU,this._forceTask=!1,this._debug=!1,this._debugHandle=Xo(qG,"SCHEDULER_LOG_SLOW_TASKS",(t=>this._debug=t)),this._budget=new n(t.nowFunc);for(const t of Object.keys(WG))this.performanceInfo.tasks.set(WG[t],new Rr(WG[t]));let e;const i=this;this._test={get state(){return y(e,i._state)},set state(t){e=t},FRAME_SAFETY_BUDGET:6.5,INTERACTING_BUDGET:ZG,IDLE_BUDGET:100,get budget(){return i._budget.budget},usedBudget:0,setBudget:t=>i._budget=t,updateTask:t=>this._updateTask(t),getState:t=>this._getState(t),getRuntime:t=>this._getRuntime(t),resetRuntimes:()=>this._resetRuntimes(),getRunning:()=>this._getRunning()}}destroy(){this._debugHandle&&this._debugHandle.remove(),this._microTaskQueued=!1}activate(){this._budget.done||this._microTaskQueued||(this._microTaskQueued=!0,queueMicrotask((()=>{this._microTaskQueued&&(this._microTaskQueued=!1,this._budget.done||(this._maxReschedule=tU,this._schedule(),this.frame()))})))}registerTask(t,e){const i=JG(t),n=new s(this,t,e,i);return this._tasks.push(n),this.performanceInfo.tasks.has(t)||this.performanceInfo.tasks.set(t,new Rr(t)),n}registerIdleStateCallbacks(t,e){const i={idleBegin:t,idleEnd:e};this._idleStateCallbacks.push(i),2===this.state&&this._idleUpdatesStartFired&&i.idleBegin();const s=this;return{remove:()=>this._removeIdleStateCallbacks(i),set idleBegin(t){s._idleUpdatesStartFired&&(i.idleEnd(),2===s._state&&t()),i.idleBegin=t},set idleEnd(t){i.idleEnd=t}}}get now(){return this.nowFunc()}get load(){return this._load}set state(t){this._state!==t&&(this._state=t,2!==this.state&&this._idleUpdatesStartFired&&(this._idleUpdatesStartFired=!1,this._idleStateCallbacks.forAll((t=>t.idleEnd()))))}get state(){return c(this._test.state)?this._state:this._test.state}updateBudget(t){this._test.usedBudget=0;let e=6.5,i=t.frameDuration,s=1;switch(this.state){case 2:e=0,i=Math.max(100,t.frameDuration),s=30;break;case 1:i=Math.max(ZG,t.frameDuration)}return i=i-t.elapsedFrameTime-e,2!==this.state&&i<1&&!this._forceTask?(this._forceTask=!0,!1):(i=Math.max(i,s),this._budget.reset(i,this.state),this._maxReschedule=tU,this._updateLoad(),this._schedule())}frame(){switch(this._forceTask=!1,this._microTaskQueued=!1,this.state){case 2:this._idleUpdatesStartFired||(this._idleUpdatesStartFired=!0,this._idleStateCallbacks.forAll((t=>t.idleBegin()))),this._runIdle();break;case 1:this._runInteracting();break;default:this._runAnimating()}this._test.usedBudget=this._budget.elapsed}stopFrame(){this._budget.reset(0,this._state),this._budget.madeProgress()}_removeIdleStateCallbacks(t){this._idleUpdatesStartFired&&t.idleEnd(),this._idleStateCallbacks.removeUnordered(t)}removeTask(t){this._tasks.removeUnordered(t),this._runQueue.removeUnordered(t)}_updateTask(t){this._tasks.forAll((e=>{e.name===t&&e.setPriority(t)}))}_getState(t){if(this._runQueue.some((e=>e.name===t)))return KG.SCHEDULED;let e=KG.IDLE;return this._tasks.forAll((i=>{i.name===t&&i.needsUpdate&&(i.schedulePriority<=1?e=KG.READY:e!==KG.READY&&(e=KG.WAITING))})),e}_getRuntime(t){let e=0;return this._tasks.forAll((i=>{i.name===t&&(e+=i.runtime)})),e}_resetRuntimes(){this._tasks.forAll((t=>t.runtime=0))}_getRunning(){const t=new Map;if(this._tasks.forAll((e=>{e.needsUpdate&&t.set(e.name,(t.get(e.name)||0)+1)})),0===t.size)return null;let e="";return t.forEach(((t,i)=>{e+=t>1?` ${t}x ${i}`:" "+i})),e}_runIdle(){this._run()}_runInteracting(){this._run()}_runAnimating(){this._run()}_updateLoad(){const t=this._tasks.reduce(((t,e)=>e.needsUpdate?++t:t),0);this._load=.9*this._load+t*(1-.9)}_schedule(){if(this._maxReschedule<=0)return!1;for(this._runQueue.filterInPlace((t=>!!t.needsUpdate||(t.schedulePriority=t.basePriority,!1))),this._tasks.forAll((t=>{0===t.basePriority&&t.needsUpdate&&!this._runQueue.some((e=>e===t))&&this._runQueue.unshift(t)}));0===this._runQueue.length;){let t=!1,e=0;if(this._tasks.forAll((i=>{i.needsUpdate&&0!==i.schedulePriority&&0!==i.basePriority&&(t=!0,e=Math.max(e,i.basePriority),1===i.schedulePriority?(i.schedulePriority=0,this._runQueue.push(i)):--i.schedulePriority)})),!t)return this.updating=!1,!1;this._maxReschedule===tU&&(this._maxReschedule=e),--this._maxReschedule}return this.updating=!0,!0}_run(){const t=this._budget.now();this._startFrameTaskTimes();do{for(;this._runQueue.length>0;){const e=this._budget.now(),i=this._runQueue.pop();this._budget.resetProgress();try{i.task.runTask(this._budget)}catch(t){BG.error(`Exception in task "${i.name}"`,t)}i.schedulePriority=i.basePriority;const s=this._budget.now()-e;if(i.runtime+=s,this._frameTaskTimes.set(i.priority,this._frameTaskTimes.get(i.priority)+s),this._debug&&this._budget.elapsed>2*this._budget.budget&&console.log("Task",i.name,"used",this._budget.elapsed,"of max",this._budget.budget,"ms"),this._budget.remaining<=0)return void this._recordFrameTaskTimes(this._budget.now()-t)}}while(this._schedule());this._recordFrameTaskTimes(this._budget.now()-t)}_startFrameTaskTimes(){for(const t of Object.keys(WG))this._frameTaskTimes.set(WG[t],0)}_recordFrameTaskTimes(t){this._frameTaskTimes.forEach(((t,e)=>this.performanceInfo.tasks.get(e).record(t))),this.performanceInfo.total.record(t)}get test(){return this._test}};e([oe()],i.prototype,"updating",void 0),e([oe()],i.prototype,"nowFunc",void 0),i=e([si("esri.views.support.Scheduler")],i),t.Scheduler=i;let s=class extends jo{constructor(t,e,i,s){super({}),this._scheduler=t,this.name=e,this._basePriority=s,this.runtime=0,this._queue=new zG,this._handles=new Wo,this.schedulePriority=this._basePriority,this.task=u(i)?i:this._queue,this._handles.add(function(t,e,i={}){return JM(t,e,i,QM)}((()=>this.task.running),(()=>t.activate())))}get updating(){return this._queue.running}normalizeCtorArgs(){return{}}remove(){this.processQueue(YG),this._scheduler.removeTask(this),this.schedule=XG.schedule,this.reschedule=XG.reschedule,this._handles.destroy()}get basePriority(){return this._basePriority}setPriority(t){this.name=t;const e=JG(t);0!==this._basePriority&&0===this.schedulePriority||(this.schedulePriority=e),this._basePriority=e}get priority(){return this.name}set priority(t){this.setPriority(t)}get needsUpdate(){return this.updating||this.task.running}schedule(t,e,i){return this._queue.push(t,e,i)}reschedule(t,e,i){return this._queue.unshift(t,e,i)}processQueue(t){this._queue.runTask(t)}};e([oe({constructOnly:!0})],s.prototype,"task",void 0),e([oe({readOnly:!0})],s.prototype,"updating",null),s=e([si("esri.views.support.SchedulerTask")],s);class n{constructor(t){this.now=t,this._begin=0,this._budget=0,this._state=2,this._didWork=!1,this._enabled=!0}run(t){return!this.done&&(!0===t()&&(this._didWork=!0),!0)}get done(){return this._didWork&&this.elapsed>=this._budget&&this._enabled}get budget(){return this._budget}madeProgress(){this._didWork=!0}get state(){return this._state}get enabled(){return this._enabled}set enabled(t){this._enabled=t}reset(t,e){this._begin=this.now(),this._budget=t,this._state=e,this._didWork=!1}get remaining(){return Math.max(this._budget-this.elapsed,0)}get elapsed(){return this.now()-this._begin}resetProgress(){this._didWork=!1}get hasProgressed(){return this._didWork}}t.Budget=n}(QG||(QG={})),function(t){t.SCHEDULED="s",t.READY="r",t.WAITING="w",t.IDLE="i"}(KG||(KG={}));const YG=(()=>{const t=new QG.Budget((()=>performance.now()));return t.enabled=!1,t})(),XG=new class{remove(){}processQueue(){}schedule(t,e,i){try{if(Qi(e)){const t=Hi();return i?Promise.resolve(i(t)):Promise.reject(t)}return hs(t(YG))}catch(t){return Promise.reject(t)}}reschedule(t,e,i){return this.schedule(t,e,i)}},tU=Number.MAX_SAFE_INTEGER;class eU{constructor(t,e){this._stage=t,this._textureRequests=new Map,this._frameTask=u(e)?e.registerTask(WG.TEXTURE_UNLOAD):XG}destroy(){this._frameTask.remove(),this._textureRequests.forEach((t=>this._releaseTextureRequest(t))),this._textureRequests.clear()}fromData(t,e){const i=this.makeUid(t);let s=this._textureRequests.get(i);return s||(s={referenceCount:0,texture:e(),textureAsync:null,abortController:null},this._stage&&(this._stage.add(s.texture),this._stage.loadSynchronous(s.texture)),this._textureRequests.set(i,s)),s.referenceCount++,{uid:i,texture:s.texture,release:()=>this._release(i)}}_release(t){if(!this._textureRequests)return;const e=this._textureRequests.get(t);e?(e.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+t),e.referenceCount--,e.referenceCount<1&&this._frameTask.schedule((()=>this._releaseNow(t)))):console.warn(`TextureCollection: texture doesn't exist: '${t}'`)}get test(){return{textureRequests:this._textureRequests}}_releaseNow(t){if(!this._textureRequests)return;const e=this._textureRequests.get(t);!e||e.referenceCount>0||(this._releaseTextureRequest(e),this._textureRequests.delete(t))}_releaseTextureRequest(t){var e;t.texture?null==(e=this._stage)||e.remove(t.texture):t.abortController&&(t.abortController.abort(),t.abortController=null)}makeUid(t,e=null){return u(e)?`${t}.${e}px`:t}}const iU=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],sU={};function nU(t){return!!sU[t]}iU.forEach((t=>{sU[t]=!0}));class rU{constructor(t){this.handlers=new Map,this.counter=0,this.handlerCounts=new Map,this.view=t,this.inputManager=null}connect(t){t&&this.disconnect(),this.inputManager=t,this.handlers.forEach((({handler:t,priority:e},i)=>this.inputManager.installHandlers(i,[t],e)))}disconnect(){this.inputManager&&this.handlers.forEach(((t,e)=>this.inputManager.uninstallHandlers(e))),this.inputManager=null}destroy(){this.disconnect(),this.handlers.clear(),this.view=null}on(t,e,i,s){const n=Array.isArray(t)?t:t.split(",");if(!function(t){for(const e of t)if(!nU(e))return!1;return!0}(n))return n.some(nU)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let r,o;Array.isArray(e)?o=e:(r=e,o=[]),"function"==typeof i?r=i:s=i,s=null!=s?s:Qz.DEFAULT;const a=this.createUniqueGroupName(),l=new oU(this.view,n,o,r);this.handlers.set(a,{handler:l,priority:s});for(const t of n){const e=this.handlerCounts.get(t)||0;this.handlerCounts.set(t,e+1)}return this.inputManager&&this.inputManager.installHandlers(a,[l],s),{remove:()=>this.removeHandler(a,n)}}hasHandler(t){return!!this.handlerCounts.get(t)}removeHandler(t,e){if(this.handlers.has(t)){this.handlers.delete(t);for(const t of e){const e=this.handlerCounts.get(t);void 0===e?console.error("Trying to remove handler for event that has no handlers registered: ",t):1===e?this.handlerCounts.delete(t):this.handlerCounts.set(t,e-1)}}this.inputManager&&this.inputManager.uninstallHandlers(t)}createUniqueGroupName(){return this.counter+=1,"viewEvents_"+this.counter}}class oU extends Uz{constructor(t,e,i,s){super(!0),this.view=t;for(const t of e)switch(t){case"click":this.registerIncoming("click",i,(t=>s(this.wrapClick(t))));break;case"double-click":this.registerIncoming("double-click",i,(t=>s(this.wrapDoubleClick(t))));break;case"immediate-click":this.registerIncoming("immediate-click",i,(t=>s(this.wrapImmediateClick(t))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",i,(t=>s(this.wrapImmediateDoubleClick(t))));break;case"hold":this.registerIncoming("hold",i,(t=>s(this.wrapHold(t))));break;case"drag":this.registerIncoming("drag",i,(t=>{const e=this.wrapDrag(t);e&&s(e)}));break;case"key-down":this.registerIncoming("key-down",i,(t=>s(this.wrapKeyDown(t))));break;case"key-up":this.registerIncoming("key-up",i,(t=>s(this.wrapKeyUp(t))));break;case"pointer-down":this.registerIncoming("pointer-down",i,(t=>s(this.wrapPointer(t,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",i,(t=>s(this.wrapPointer(t,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",i,(t=>s(this.wrapPointer(t,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",i,(t=>s(this.wrapPointerDrag(t))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",i,(t=>s(this.wrapMouseWheel(t))));break;case"pointer-enter":this.registerIncoming("pointer-enter",i,(t=>s(this.wrapPointer(t,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",i,(t=>s(this.wrapPointer(t,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",i,(t=>{s(this.wrapGamepad(t))}));break;case"focus":this.registerIncoming("focus",i,(t=>{s(this.wrapFocus(t))}));break;case"blur":this.registerIncoming("blur",i,(t=>{s(this.wrapBlur(t))}))}}wrapFocus(t){return{type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapBlur(t){return{type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapClick(t){const{pointerType:e,button:i,buttons:s,x:n,y:r,native:o,eventId:a}=t.data,{cancelable:l,timestamp:u}=t;return{type:"click",pointerType:e,button:i,buttons:s,x:n,y:r,native:o,timestamp:u,screenPoint:pm(n,r),mapPoint:this.getMapPoint(n,r),eventId:a,cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapDoubleClick(t){const{pointerType:e,button:i,buttons:s,x:n,y:r,native:o,eventId:a}=t.data,{cancelable:l,timestamp:u}=t;return{type:"double-click",pointerType:e,button:i,buttons:s,x:n,y:r,native:o,timestamp:u,mapPoint:this.getMapPoint(n,r),eventId:a,cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateClick(t){const{pointerType:e,button:i,buttons:s,x:n,y:r,native:o,eventId:a}=t.data,l=o.pointerId,{cancelable:u,timestamp:c}=t;return{type:"immediate-click",pointerId:l,pointerType:e,button:i,buttons:s,x:n,y:r,native:o,timestamp:c,mapPoint:this.getMapPoint(n,r),eventId:a,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateDoubleClick(t){const{pointerType:e,button:i,buttons:s,x:n,y:r,native:o,eventId:a}=t.data,l=o.pointerId,{cancelable:u,timestamp:c}=t;return{type:"immediate-double-click",pointerId:l,pointerType:e,button:i,buttons:s,x:n,y:r,native:o,timestamp:c,mapPoint:this.getMapPoint(n,r),eventId:a,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapHold(t){const{pointerType:e,button:i,buttons:s,x:n,y:r,native:o}=t.data,{cancelable:a,timestamp:l}=t;return{type:"hold",pointerType:e,button:i,buttons:s,x:n,y:r,native:o,timestamp:l,mapPoint:this.getMapPoint(n,r),cancelable:a,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}getMapPoint(t,e){return this.view.toMap(pm(t,e),{exclude:[]})}wrapDrag(t){const e=t.data,{x:i,y:s}=e.center,{action:n,pointerType:r,button:o}=e;if("start"===n&&(this.latestDragStart=e),!this.latestDragStart)return;const a=e.pointer.native,l=e.buttons,{cancelable:u,timestamp:c}=t,h={x:this.latestDragStart.center.x,y:this.latestDragStart.center.y};return"end"===n&&(this.latestDragStart=void 0),{type:"drag",action:n,x:i,y:s,origin:h,pointerType:r,button:o,buttons:l,radius:e.radius,angle:hd(e.angle),native:a,timestamp:c,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapKeyDown(t){const{key:e,repeat:i,native:s}=t.data,{cancelable:n,timestamp:r}=t;return{type:"key-down",key:e,repeat:i,native:s,timestamp:r,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapKeyUp(t){const{key:e,native:i}=t.data,{cancelable:s,timestamp:n}=t;return{type:"key-up",key:e,native:i,timestamp:n,cancelable:s,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointer(t,e){const{x:i,y:s,button:n,buttons:r,native:o,eventId:a}=t.data,l=o.pointerId,u=o.pointerType,{cancelable:c,timestamp:h}=t;return{type:e,x:i,y:s,pointerId:l,pointerType:u,button:n,buttons:r,native:o,timestamp:h,eventId:a,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointerDrag(t){const{x:e,y:i,buttons:s,native:n,eventId:r}=t.data.currentEvent,{button:o}=t.data.startEvent,a=t.data.startEvent.native.pointerId,l=t.data.startEvent.native.pointerType,u=t.data.action,c={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:h,timestamp:d}=t;return{type:"pointer-drag",x:e,y:i,pointerId:a,pointerType:l,button:o,buttons:s,action:u,origin:c,native:n,timestamp:d,eventId:r,cancelable:h,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapMouseWheel(t){const{cancelable:e,data:i,timestamp:s}=t,{x:n,y:r,deltaY:o,native:a}=i;return{type:"mouse-wheel",x:n,y:r,deltaY:o,native:a,timestamp:s,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapGamepad(t){const{action:e,state:i,device:s}=t.data,{cancelable:n,timestamp:r}=t,{buttons:o,axes:a}=i;return{type:"gamepad",device:s,timestamp:r,action:e,buttons:o,axes:a,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}}function aU(t){return[t.on("after-add",(t=>{const e=t.item;e.view&&e.view.ready&&!e.attached&&e.attach()})),t.on("after-remove",(t=>{const e=t.item;e.active&&(e.view.activeTool=null),e.attached&&e.detach()}))]}function lU(t){return t.visible&&t.getEditableFlag(0)&&t.getEditableFlag(1)}function uU(t){return pm(t.x,t.y)}function cU(t,e){const i=(t instanceof HTMLElement?t:t.surface).getBoundingClientRect();return pm(e.clientX-i.left,e.clientY-i.top)}function hU(t,e){return e instanceof Event?cU(t,e):uU(e)}function dU(t){if(t instanceof Event)return!0;if("object"==typeof t&&"type"in t)switch(t.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return!0;default:return!1}return!1}class pU{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._currentlyActiveTool=null,this._revertToActiveTool=!1,this._cursor=null}get cursor(){return this._cursor}handleInputEvent(t,e){const i=()=>t.stopPropagation();switch(t.type){case"pointer-move":fU(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(i(),"end"===t.action&&(this._stopDrag=!1));break;case"pointer-down":{if(!yU(t))break;const s=uU(t),n=this._intersect(s,t.pointerType,e.forEachTool);if(c(n))break;const r=this._findToolAndManipulatorByKey(n,e.forEachTool,mU),o=d(r,(t=>t.manipulator)),a=d(r,(t=>t.tool));!(u(o)&&u(a)&&o.interactive)||o.grabbable&&o.grabbableForEvent(t)||!o.grabbing||o.dragging||this._ungrabManipulatorBeforeDragging(o,a,t),u(o)&&o.interactive&&o.grabbable&&o.grabbableForEvent(t)&&!o.grabbing&&(this._grabbedManipulators.set(t.pointerId,{key:n,start:s,pointerType:t.pointerType}),1===this._grabbedManipulators.size&&e.activeTool!==n.tool&&(this._currentlyActiveTool=e.activeTool,this._revertToActiveTool=!0,e.setActiveTool(n.tool)),o.grabbing=!0,o.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:s}),i());break}case"pointer-up":this._handlePointerEnd(t,e);break;case"pointer-drag":{if(!yU(t))break;const s=this._grabbedManipulators.get(t.pointerId),n=this._draggedManipulators.get(t.pointerId),r=d(s||n,(({key:t})=>t)),o=this._findManipulatorByKey(r,e.forEachTool);if(c(o))break;const a=uU(t);a.x=od(a.x,0,e.view.width),a.y=od(a.y,0,e.view.height);const l=(s||n).start;switch(t.action){case"start":case"update":"update"!==t.action&&1!==this._grabbedManipulators.size||(o.dragging=!0,o.events.emit("drag",n?{action:"update",start:l,screenPoint:a}:{action:"start",start:l,screenPoint:a,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{key:r,start:l}));break;case"end":o.dragging=!1,n&&o.events.emit("drag",{action:"end",start:l,screenPoint:a}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,e)}i();break}case"immediate-click":{const s=uU(t),n=this._intersect(s,t.pointerType,e.forEachTool),r=this._findToolAndManipulatorByKey(n,e.forEachTool,mU);if(function(t){return!!t.native.shiftKey}(t)||e.forEachTool((t=>{if((!u(r)||r.tool!==t||t.automaticManipulatorSelection)&&t.manipulators){let e=!1;t.manipulators.forEach((({manipulator:t})=>{t.selected&&(t.selected=!1,e=!0)})),e&&t.manipulatorSelectionChanged&&t.manipulatorSelectionChanged()}})),c(r))break;const{manipulator:o,tool:a}=r;if(!o.interactive)break;o.selectable&&a.automaticManipulatorSelection&&(o.selected=!o.selected,a.manipulatorSelectionChanged&&a.manipulatorSelectionChanged()),o.events.emit("immediate-click",{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:t.native.shiftKey,stopPropagation:i});break}case"click":{const s=uU(t),n=this._intersect(s,t.pointerType,e.forEachTool),r=this._findManipulatorByKey(n,e.forEachTool);if(c(r)||!r.interactive)break;r.events.emit(t.type,{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:t.native.shiftKey}),i();break}case"double-click":{const s=uU(t),n=this._intersect(s,t.pointerType,e.forEachTool),r=this._findManipulatorByKey(n,e.forEachTool);if(c(r)||!r.interactive)break;r.events.emit("double-click",{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:t.native.shiftKey,stopPropagation:i});break}case"immediate-double-click":{const s=uU(t),n=this._intersect(s,t.pointerType,e.forEachTool),r=this._findManipulatorByKey(n,e.forEachTool);if(c(r)||!r.interactive)break;r.events.emit("immediate-double-click",{screenPoint:s,button:t.button,pointerType:t.pointerType,shiftKey:t.native.shiftKey,stopPropagation:i});break}}this._updateCursor(e.forEachTool)}_ungrabManipulatorBeforeDragging(t,e,i){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:uU(i)}),this._grabbedManipulators.forEach((({key:i},s)=>{i.tool===e&&e.manipulators.findById(i.manipulatorId)===t&&this._grabbedManipulators.delete(s)}))}_handlePointerEnd(t,e){const i=d(this._grabbedManipulators.get(t.pointerId),(({key:t})=>t)),s=this._findManipulatorByKey(i,e.forEachTool);u(s)&&!s.dragging&&(1===this._grabbedManipulators.size&&0===this._draggedManipulators.size&&this._revertToActiveTool&&(e.setActiveTool(this._currentlyActiveTool),this._revertToActiveTool=!1,this._currentlyActiveTool=null),s.grabbing&&(s.grabbing=!1,s.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:uU(t)})),this._grabbedManipulators.delete(t.pointerId))}_cursorFromMap(t,e){let i=null;return ht(t,(({key:t})=>{const s=this._findManipulatorByKey(t,e);return!!(u(s)&&s.interactive&&"cursor"in s&&s.cursor)&&(i=s.cursor,!0)})),i}_updateCursor(t){this._cursor=this._grabbedManipulators.size>0?this._cursorFromMap(this._grabbedManipulators,t)||"grabbing":this._hoveredManipulators.size>0?this._cursorFromMap(this._hoveredManipulators,t)||"pointer":null}clearPointers(t,e,i=!0,s){const n=e=>e.tool===t&&(c(s)||e.manipulatorId===s);this._grabbedManipulators.forEach((({key:t,pointerType:i},s)=>{if(n(t)){this._grabbedManipulators.delete(s);const n=this._findManipulatorByKey(t,e);u(n)&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:i}))}})),this._draggedManipulators.forEach((({key:t},i)=>{if(n(t)){this._draggedManipulators.delete(i);const s=this._findManipulatorByKey(t,e);u(s)&&(s.dragging=!1,s.events.emit("drag",{action:"cancel"}))}})),i&&this._hoveredManipulators.forEach((({key:t},i)=>{if(n(t)){this._hoveredManipulators.delete(i);const s=this._findManipulatorByKey(t,e);u(s)&&(s.hovering=!1)}})),this._updateCursor(e)}_intersect(t,e,i){let s=null;return i((i=>{if(null==i.manipulators||!lU(i))return!1;const n=i.manipulators.intersect(t,e);return!c(n)&&(s={manipulatorId:n.id,tool:i},!0)})),s}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach(((e,i)=>{this._updateHoveredStateForPointerAtScreenPosition(pm(e.x,e.y),i,e.pointerType,t)}))}handleHoverEvent(t,e){"pointer-up"!==t.type&&"immediate-click"!==t.type&&"pointer-move"!==t.type||!fU(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(uU(t),t.pointerId,t.pointerType,e)}_updateHoveredStateForPointerAtScreenPosition(t,e,i,s){const n=this._intersect(t,i,s);let r=this._findManipulatorByKey(n,s);const o=d(this._hoveredManipulators.get(e),(({key:t})=>t)),a=this._findManipulatorByKey(o,s);u(r)&&!r.interactive&&(r=null),a!==r&&(u(a)&&(a.hovering=!1),u(r)?(r.hovering=!0,this._hoveredManipulators.set(e,{key:n})):this._hoveredManipulators.delete(e),this._updateCursor(s))}_findManipulatorByKey(t,e){return this._findToolAndManipulatorByKey(t,e,mU)?mU.manipulator:null}_findToolAndManipulatorByKey(t,e,i){return c(t)?null:(i.tool=null,i.manipulator=null,e((e=>{if(e!==t.tool||null==e.manipulators||!lU(e))return!1;const s=e.manipulators.findById(t.manipulatorId);return!!u(s)&&(i.manipulator=s,i.tool=e,!0)})),i.manipulator?i:null)}}function fU(t){return"mouse"===t}function yU(t){return"mouse"!==t.pointerType||0===t.button}const mU={manipulator:null,tool:null},gU=ct.getLogger("esri.views.ToolViewManager"),vU="manipulators";let wU=class extends tS{constructor(t){super(t),this._manipulatorState=new pU,this.tools=new qo,this.cursor=null,this._forEachTool=t=>{for(const e of this.tools.items)if(t(e))return}}initialize(){this.handles.add([this.view.on(iU,(t=>{this._handleInputEvent(t)}),Qz.TOOL),...aU(this.tools),this.tools.on("before-add",(t=>{const e=t.item;if(null==e||this.tools.includes(e))return gU.warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault()})),this.tools.on("before-remove",(({item:t})=>{this._manipulatorState.clearPointers(t,this._forEachTool)})),this.tools.on("change",(()=>{this._refreshToolWatchers()}))])}destroy(){this._forEachTool((t=>t.destroy()))}set activeTool(t){if(u(t)&&!this.view.ready)return void gU.error("Cannot set active tool while view is not ready.");if(t===this.activeTool)return void(u(t)&&gU.warn("Tool is already active - ignoring activation request."));u(this.activeTool)&&this.activeTool.deactivate(),u(t)&&t.activate(),this._set("activeTool",t),this._removeIncompleteTools(t);const e=c(this.activeTool);for(const t of this.tools){t.setEditableFlag(1,e||t===this.activeTool);const i=lU(t);!e&&i||this._manipulatorState.clearPointers(t,this._forEachTool,!i)}this._updateCursor()}get updating(){return this.updatingHandles.updating||this.tools.some((t=>t.updating))}attach(){this._forEachTool((t=>t.attach())),"3d"===this.view.type?(this._set("textures",new eU(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([this.view.state.watch("camera",(()=>{this._forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange()}))})),this.view.elevationProvider.on("elevation-change",(t=>{this._forEachManipulator((e=>{null!=e.onElevationChange&&e.onElevationChange(t)}))}))],vU)):this.handles.add(this.view.watch("extent",(()=>{this._forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange()}))})))}detach(){u(this.activeTool)&&(this.activeTool=null),this._forEachTool((t=>{t.detach(),t.destroy()})),this.tools.removeAll(),this.handles.remove(vU)}_forEachManipulator(t){this._forEachTool((e=>{e.manipulators&&e.manipulators.forEach((({manipulator:i})=>t(i,e)))}))}_handleInputEvent(t){let e=!1;const i={...t,stopPropagation:()=>{e=!0,t.stopPropagation()}};u(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(i):this._forEachTool((t=>{!e&&t.attached&&t.visible&&t.handleInputEvent(i)})),!e&&"key-down"===t.type&&"Escape"===t.key&&this.activeTool&&(t.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(i,{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t},view:this.view}),!e&&u(this.activeTool)&&this.activeTool.handleInputEventAfter(i),this._manipulatorState.handleHoverEvent(i,this._forEachTool),this._updateCursor()}_refreshToolWatchers(){this.handles.remove("tools"),this._forEachTool((t=>{if(t instanceof jo){const e=ta(t,["cursor","visible","editable"],(()=>{lU(t)||this._manipulatorState.clearPointers(t,this._forEachTool),this._updateCursor()}));this.handles.add(e,"tools")}t.manipulators&&this.handles.add(t.manipulators.on("change",(e=>{e.removed.forEach((({id:e})=>{this._manipulatorState.clearPointers(t,this._forEachTool,!0,e)})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()})),"tools")})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor()}_updateCursor(){let t=this._manipulatorState.cursor;this._forEachTool((e=>!(!u(e.cursor)||!e.visible||(t=e.cursor,0)))),this._get("cursor")!==t&&this._set("cursor",t)}_removeIncompleteTools(t){this.tools.filter((e=>(c(t)||e!==t)&&!e.completed)).forEach((t=>{this.tools.remove(t),t.destroy()}))}};e([oe({constructOnly:!0,nonNullable:!0})],wU.prototype,"view",void 0),e([oe({readOnly:!0,nonNullable:!0})],wU.prototype,"textures",void 0),e([oe({value:null})],wU.prototype,"activeTool",null),e([oe({readOnly:!0,type:qo})],wU.prototype,"tools",void 0),e([oe({readOnly:!0})],wU.prototype,"cursor",void 0),e([oe({readOnly:!0})],wU.prototype,"updating",null),wU=e([si("esri.views.ToolViewManager")],wU);const bU=wU;let MU=class extends jo{constructor(t){super(),this.nativeIndex=null,this._detectedDeviceType="unknown",this._detectedDeviceType="standard"===t.mapping?"standard":SU.test(t.id)?"spacemouse":"unknown",this.nativeIndex=t.index}get native(){return(navigator.getGamepads?navigator.getGamepads():[])[this.nativeIndex]}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return xU[this.deviceType]}};e([oe({nonNullable:!0,readOnly:!0})],MU.prototype,"nativeIndex",void 0),e([oe({type:String,readOnly:!0})],MU.prototype,"deviceType",null),e([oe({type:Number,readOnly:!0})],MU.prototype,"axisThreshold",null),MU=e([si("esri.views.input.gamepad.GamepadInputDevice")],MU);const SU=/^(3dconnexion|space(mouse|navigator|pilot|explorer))/i,xU={standard:.15,spacemouse:.025,unknown:0},kU=MU;let IU=class extends jo{constructor(...t){super(...t),this.devices=new qo,this.enabledFocusMode="document"}};e([oe({type:qo.ofType(kU),readOnly:!0})],IU.prototype,"devices",void 0),e([oe({type:["document","view","none"]})],IU.prototype,"enabledFocusMode",void 0),IU=e([si("esri.views.input.gamepad.GamepadSettings")],IU);const jU=IU;let _U=class extends jo{constructor(){super(...arguments),this.gamepad=new jU}};e([oe({readOnly:!0})],_U.prototype,"gamepad",void 0),_U=e([si("esri.views.input.Input")],_U);const TU=_U;let OU=class extends jo{constructor(t){super(t),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1}};e([oe({type:Boolean,nonNullable:!0})],OU.prototype,"enabled",void 0),e([oe({type:kU})],OU.prototype,"device",void 0),e([oe({type:["pan","zoom"],nonNullable:!0})],OU.prototype,"mode",void 0),e([oe({type:["forward-down","forward-up"],nonNullable:!0})],OU.prototype,"tiltDirection",void 0),e([oe({type:Number,nonNullable:!0})],OU.prototype,"velocityFactor",void 0),OU=e([si("esri.views.navigation.gamepad.GamepadSettings")],OU);const AU=OU;let FU=class extends jo{constructor(t){super(t),this.browserTouchPanEnabled=!0,this.gamepad=new AU,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0}};e([oe({type:Boolean})],FU.prototype,"browserTouchPanEnabled",void 0),e([oe({type:AU,nonNullable:!0})],FU.prototype,"gamepad",void 0),e([oe({type:Boolean})],FU.prototype,"momentumEnabled",void 0),e([oe({type:Boolean})],FU.prototype,"mouseWheelZoomEnabled",void 0),FU=e([si("esri.views.navigation.Navigation")],FU);const CU=FU;function PU(t){return"heightModelInfo"in t}function EU(t){if("unknown"===t.type||!("capabilities"in t))return!1;switch(t.type){case"csv":case"feature":case"geojson":case"subtype-group":case"ogc-feature":case"wfs":return!0;default:return!1}}function RU(t){switch(t.type){case"building-scene":case"elevation":case"integrated-mesh":case"point-cloud":case"scene":case"voxel":return!0;case"analysis":case"base-dynamic":case"base-elevation":case"base-tile":case"bing-maps":case"csv":case"geojson":case"feature":case"subtype-group":case"geo-rss":case"graphics":case"group":case"imagery":case"imagery-tile":case"kml":case"map-image":case"map-notes":case"ogc-feature":case"open-street-map":case"route":case"stream":case"tile":case"unknown":case"unsupported":case"vector-tile":case"wcs":case"web-tile":case"wfs":case"wms":case"wmts":case null:return!1}return!1}const LU=new ED({heightModel:"gravity-related-height"});var NU;const DU=ct.getLogger("esri.views.support.DefaultsFromMap");let VU=NU=class extends jo{constructor(){super(...arguments),this._handles=new Wo,this._waitTask=null,this._extentProjectController=null,this._spatialReferenceCandidates=null,this._extentCandidates=null,this.logDebugInformation=!1,this.isSpatialReferenceDone=!1,this.isTileInfoDone=!1,this.isHeightModelInfoSearching=!1,this.spatialReference=null,this.extent=null,this.heightModelInfo=null,this.vcsWkid=null,this.latestVcsWkid=null,this.mapCollectionPaths=NU.DefaultMapCollectionPaths.slice(),this.tileInfo=null}initialize(){this.watch("mapCollectionPaths",(()=>{this._running&&(this.reset(),this.start())}))}destroy(){this._set("view",null),this._handles=m(this._handles),this._cancelLoading()}get _running(){return!!(this._handles&&this._handles.size>0)}reset(){this._handles.removeAll(),this._set("isSpatialReferenceDone",!1),this._set("isTileInfoDone",!1),this._set("isHeightModelInfoSearching",!1),this._set("spatialReference",null),this._set("extent",null),this._set("heightModelInfo",null),this._set("vcsWkid",null),this._set("latestVcsWkid",null),this._set("tileInfo",null),this._spatialReferenceCandidates=null,this._extentCandidates=null}start(){this._handles.removeAll();const t=this._updateLayerChange.bind(this);for(const e of this.mapCollectionPaths)this._handles.add(ca(this.view,"map."+e,"change",t,t,t,!0));this._handles.add(ea(this,"isSpatialReferenceDone",(()=>this._updateTileInfo()),!0))}_ownerNameFromCollectionName(t){const e=t.lastIndexOf(".");return-1===e?"view":"view."+t.slice(0,e)}_ensureLoadedOwnersFromCollectionName(t){const e=this._ownerNameFromCollectionName(t).split(".");let i;for(let s=0;s<e.length&&(i=this.get(e.slice(0,s+1).join(".")),i);s++)if(i.load&&!i.isFulfilled())return{collectionName:t,owner:null,loading:i.load().catch((()=>{}))};return{collectionName:t,owner:i}}_cancelLoading(){this._waitTask=null,this._extentProjectController&&(this._extentProjectController.abort(),this._extentProjectController=null)}_updateWhen(t){let e=!0,i=!1;const s=t.catch((()=>{})).then((()=>{e?i=!0:s===this._waitTask&&this._update()}));return e=!1,i||(this._waitTask=s),i}_updateLayerChange(){this.isSpatialReferenceDone&&!this.spatialReference&&this._set("isSpatialReferenceDone",!1),this._update()}_update(){if(this._cancelLoading(),this.view){if(!this.isSpatialReferenceDone){this._debugLog("Starting search for spatial reference...");const t=this._processMapCollections((t=>this._processSpatialReferenceSource(t)));if(this._debugLog(`Search ended with status '${zU(t)}'`),0!==t){let t=null,e=this._spatialReferenceCandidates;if(!e||e.length<1?(t=this.defaultSpatialReference,this._debugLog(`No spatial reference found, locking to default (${$U(t)})`)):(this.defaultSpatialReference&&e.length>1&&e.findIndex((t=>t.equals(this.defaultSpatialReference)))>-1&&(e=[this.defaultSpatialReference]),t=e[0],this._debugLog("Locking to "+$U(t))),this._set("spatialReference",t),t)if(this.extent)this._set("isSpatialReferenceDone",!0);else{const e=this.logDebugInformation;this.logDebugInformation=!1,this._processMapCollections((e=>this._findExtent(e,t))),this.logDebugInformation=e,this._projectExtentCandidate().catch((()=>{})).then((()=>this._set("isSpatialReferenceDone",!0)))}else this._set("isSpatialReferenceDone",!0)}}if(null==this.heightModelInfo&&this.view.isHeightModelInfoRequired){this._debugLog("Starting search for height model info...");const t=this._processMapCollections((t=>this._processHeightModelInfoSource(t)),(t=>function(t){return null!=t.layers||RU(t)||EU(t)||PU(t)}(t)));this._debugLog("Search ended with status "+zU(t)),this._set("isHeightModelInfoSearching",0===t)}this._updateTileInfo()}}_processMapCollections(t,e){this._preloadMapCollections(e);let i=2;return this._forAllMapCollectionSources((t=>{if(2!==i)return!1;const{collectionName:e}=t;return this._debugLog(`Processing collection ${e}...`),!(t.loading&&!this._updateWhen(t.loading)&&(this._debugLog(`Collection ${t.collectionName} owner is loading -> wait`),i=0,1))}),(s=>!(2!==i||(null==e||e(s)?!s.load||s.isFulfilled()||this._updateWhen(s.load())?(!s.load||s.isResolved())&&t(s)&&(i=1,1):(this._debugLog(`Source ${s.id} is loading -> wait`),i=0,1):(this._debugLog(`Source ${s.id} is skipped due to predicate`),1))))),i}_preloadMapCollections(t){let e=10;const i=this.logDebugInformation;this.logDebugInformation=!1,this._forAllMapCollectionSources((()=>!0),(s=>0!==e&&!(null!=t&&!t(s)||(s.load&&!s.isFulfilled()&&(this.logDebugInformation=i,this._debugLog("Pre-loading source "+s.id),this.logDebugInformation=!1,s.load().catch((()=>{})),e--),0)))),this.logDebugInformation=i}_forAllMapCollectionSources(t,e){for(const i of this.mapCollectionPaths){const s="map."+i,n=this._ensureLoadedOwnersFromCollectionName(s);if(!1===t(n))continue;const r=n.owner;if(!r||r.isRejected&&r.isRejected()){this._debugLog(`Collection ${s} owner is invalid or rejected -> skip`);continue}const o=this.view.get(s);o?this._forEachSource(o,e):this._debugLog(`Collection ${s} does not exist -> skip`)}}_forEachSource(t,e){for(const i of t.items)!1!==e(i)&&"layers"in i&&i.layers&&this._forEachSource(i.layers,e)}_processSpatialReferenceSource(t){let e=this._getSupportedSpatialReferences(t);return 0!==e.length&&(this._spatialReferenceCandidates?(e=function(t,e,i){return t&&e?t.filter(i?function(t){return e.findIndex((function(e){return i(t,e)}))>-1}:function(t){return e.indexOf(t)>-1}):[]}(e,this._spatialReferenceCandidates,((t,e)=>t.equals(e))),e.length>0?this._spatialReferenceCandidates=e:this._debugLog(`Layer ${t.id} is ignored because its supported spatial\n          references are not compatible with the previous candidates`)):this._spatialReferenceCandidates=e,1===this._spatialReferenceCandidates.length)}_findExtent(t,e){const i="fullExtents"in t&&t.fullExtents||(u(t.fullExtent)?[t.fullExtent]:[]),s=i.find((t=>t.spatialReference.equals(e)));if(s)return this._set("extent",s),!0;if(this._getSupportedSpatialReferences(t).length>0){const e=i.map((e=>({extent:e,layer:t})));this._extentCandidates=(this._extentCandidates||[]).concat(e)}return!1}async _projectExtentCandidate(){if(!this._extentCandidates||!this._extentCandidates.length)return;const t=this.spatialReference,e=this._extentCandidates.find((e=>bp(e.extent.spatialReference,t)));if(u(e))this._set("extent",Mp(e.extent,t));else{const e=this._extentCandidates[0];this._extentProjectController=new AbortController;const i=await import("./p-420937d2.js");try{const s=await i.projectGeometry(e.extent,t,e.layer.portalItem,this._extentProjectController.signal);this._set("extent",s)}catch{}this._extentProjectController=null}}_getSupportedSpatialReferences(t){const e="supportedSpatialReferences"in t&&t.supportedSpatialReferences||(t.spatialReference?[t.spatialReference]:[]);if(0===e.length)return this._debugLog(`Layer ${t.id} is ignored because it does not have any spatial references`),[];const i=e.filter((e=>this.view.isSpatialReferenceSupported(e,t,(t=>this._debugLog(t)))));return this._debugLog(0===i.length?`Layer ${t.id} has spatial references but none of them are supported (or layer doesn't require locking)`:`Layer ${t.id} has spatial references. Resulting candidate set: ${i.map($U).join(", ")}`),i}_processHeightModelInfoSource(t){const e=function(t){const e=t.url&&XA(t.url);return null==(t.spatialReference&&t.spatialReference.vcsWkid)&&u(e)&&"ImageServer"===e.serverType||!PU(t)||!t.heightModelInfo?function(t){return EU(t)?!!(t.capabilities&&t.capabilities.data&&t.capabilities.data.supportsZ):RU(t)}(t)?ED.deriveUnitFromSR(LU,t.spatialReference):null:t.heightModelInfo}(t);return!!e&&(this._set("heightModelInfo",e),this._set("isHeightModelInfoSearching",!1),t.spatialReference&&(this._set("vcsWkid",t.spatialReference.vcsWkid),this._set("latestVcsWkid",t.spatialReference.latestVcsWkid)),!0)}_updateTileInfo(){if(null!=this.tileInfo)return;if(!this.view.isTileInfoRequired())return void this._set("isTileInfoDone",!0);if(!this.isSpatialReferenceDone)return;const t=this.get("view.map");if(!t)return void this._debugLog("updateTileInfo: no map");const e=t.basemap,i=t.get("layers.0");let s=null;if(e&&"failed"!==e.loadStatus){if(!e.loaded)return this._updateWhen(e.load()),void this._debugLog("updateTileInfo: basemap still loading");const t=e&&e.get("baseLayers.0");if(t&&"failed"!==t.loadStatus){if(!t.loaded)return this._updateWhen(t.load()),void this._debugLog("updateTileInfo: first basemap layer still loading");s="tileInfo"in t&&t.tileInfo}else{if(!i||"failed"===i.loadStatus)return this._debugLog("updateTileInfo: no tileInfo"),void this._set("isTileInfoDone",!0);if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo}}else if(i&&"failed"!==i.loadStatus){if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo}s&&!s.spatialReference.equals(this.spatialReference)&&(s=null),this._debugLog("updateTileInfo: setting "+s),this._set("tileInfo",s),this._set("isTileInfoDone",!0)}_debugLog(t){this.logDebugInformation&&DU.info(t)}};function $U(t){return t?JSON.stringify(t.toJSON()):"undefined"}function zU(t){switch(t){case 0:return"Waiting";case 1:return"Found";case 2:return"Exhausted"}}VU.DefaultMapCollectionPaths=["basemap.baseLayers","layers","ground.layers","basemap.referenceLayers"],e([oe()],VU.prototype,"logDebugInformation",void 0),e([oe({readOnly:!0})],VU.prototype,"isSpatialReferenceDone",void 0),e([oe({readOnly:!0})],VU.prototype,"isTileInfoDone",void 0),e([oe({readOnly:!0})],VU.prototype,"isHeightModelInfoSearching",void 0),e([oe({constructOnly:!0})],VU.prototype,"view",void 0),e([oe({readOnly:!0})],VU.prototype,"spatialReference",void 0),e([oe({readOnly:!0})],VU.prototype,"extent",void 0),e([oe({readOnly:!0})],VU.prototype,"heightModelInfo",void 0),e([oe({readOnly:!0})],VU.prototype,"vcsWkid",void 0),e([oe({readOnly:!0})],VU.prototype,"latestVcsWkid",void 0),e([oe()],VU.prototype,"mapCollectionPaths",void 0),e([oe()],VU.prototype,"defaultSpatialReference",void 0),e([oe({readOnly:!0})],VU.prototype,"tileInfo",void 0),VU=NU=e([si("esri.views.support.DefaultsFromMap")],VU);const GU=VU;var UU;const qU=ct.getLogger("esri.views.View");let BU=UU=class extends(XM(To.EventedMixin(Jo(jo)))){constructor(t){super(t),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new nA({getCollections:()=>{var t,e,i;return[null==(t=this.basemapView)?void 0:t.baseLayerViews,null==(e=this.groundView)?void 0:e.layerViews,this.layerViews,null==(i=this.basemapView)?void 0:i.referenceLayerViews]},getChildrenFunction:t=>t.layerViews}),this.groundView=null,this.animation=null,this.basemapView=null,this.defaultsFromMap=new GU({view:this}),this.fatalError=null,this.extent=null,this.graphics=new PG,this.navigating=!1,this.layerViews=new qo,this.magnifier=new $G,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new TU,this.navigation=new CU,this.layerViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new rU(this),this.persistableViewModels=new qo,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(this.watch("preconditionsReady",(t=>{t?(this._currentSpatialReference=this.spatialReference,UU.views.add(this)):(this._currentSpatialReference=null,UU.views.remove(this)),this.notifyChange("spatialReference"),!t&&this.ready?(this.layerViewManager.clear(),this.toolViewManager.detach(),this._teardown()):t&&!this.ready&&(this._startup(),this.toolViewManager.attach())}),!0))}initialize(){let t;this.addResolvingPromise(this.validate().then((()=>(this._isValid=!0,ia(this,"ready"))))),this.basemapView=new EG({view:this}),this.layerViewManager=new DG({view:this,layerViewImporter:{importLayerView:t=>this.importLayerView(t),hasLayerViewModule:t=>this.hasLayerViewModule(t)},supportsGround:this.supportsGround}),this.toolViewManager=new bU({view:this}),this._resetInitialViewPropertiesFromContent(),Xo(this.defaultsFromMap,"isSpatialReferenceDone",(e=>{const i=!!(this.map&&this.map.allLayers.length>0);if(e&&!this.spatialReference&&i||!t){if(e&&!this.spatialReference&&i&&!t){const e=t=us(this.spatialReferenceWarningDelay);t.then((()=>{e===t&&qU.warn("#spatialReference","no spatial reference could be derived from the currently added map layers")})).catch((()=>{}))}}else t=null}),!0)}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=m(this.graphics),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.toolViewManager=m(this.toolViewManager),this.layerViewManager=m(this.layerViewManager),this.basemapView=m(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const t=this.map;this.map=null,null==t||t.destroy()}_startup(){this._set("ready",!0)}_teardown(){this._set("ready",!1)}whenReady(){return Promise.resolve(this)}toMap(){return qU.error("#toMap()","Not implemented on this instance of View"),null}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get preconditionsReady(){return!!(!this.fatalError&&this._isValid&&!this._readyCycleForced&&this.map&&(!Av.isLoadable(this.map)||this.map.loaded)&&0!==this.width&&0!==this.height&&this.spatialReference&&this.isSpatialReferenceSupported(this.spatialReference)&&(this._currentSpatialReference||!this.initialExtentRequired||this.initialExtent||this.defaultsFromMap&&this.defaultsFromMap.isSpatialReferenceDone)&&this.defaultsFromMap&&this.defaultsFromMap.isTileInfoDone)}set map(t){var e;t!==this._get("map")&&(null!=(e=t)&&e.destroyed&&(qU.warn("#map","The provided map is already destroyed",{map:t}),t=null),Av.isLoadable(t)&&t.load().catch((()=>{})),this.initialized&&(this.forceReadyCycle(),this._resetInitialViewPropertiesFromContent()),this._set("map",t))}get spatialReference(){let t=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return t&&this.isHeightModelInfoRequired&&this.defaultsFromMap&&(t=t.clone(),t.vcsWkid=this.defaultsFromMap.vcsWkid,t.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),t}set spatialReference(t){this._userSpatialReference=t,this._set("spatialReference",t)}get stationary(){return!this.animation&&!this.navigating&&!this.resizing}get initialExtent(){return this.defaultsFromMap&&this.defaultsFromMap.extent}get cursor(){const t=this.toolViewManager?this.toolViewManager.cursor:null;return u(t)?t:this._cursor||"default"}set cursor(t){this._cursor=t,this.notifyChange("cursor")}get size(){return[this.width,this.height]}whenLayerView(t){return this.layerViewManager.whenLayerView(t)}getDefaultSpatialReference(){return this.get("defaultsFromMap.spatialReference")}getDefaultHeightModelInfo(){return this.get("map.supportsHeightModelInfo")&&this.get("map.heightModelInfo")||this.get("defaultsFromMap.heightModelInfo")||null}importLayerView(t){throw new Ve("importLayerView() not implemented")}hasLayerViewModule(t){return!1}async validate(){}invalidate(){this._isValid=!1}isSpatialReferenceSupported(t,e,i){return!0}isTileInfoRequired(){return!1}when(t,e){return this.isResolved()&&!this.ready&&qU.warn("#when()",'Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use watchUtils.whenOnce(view, "ready").then(...) instead.'),super.when(t,e)}forceReadyCycle(){this.ready&&(this._readyCycleForced=!0,la(this,"preconditionsReady",(()=>this._readyCycleForced=!1)))}addAndActivateTool(t){this.toolViewManager.tools.add(t),this.activeTool=t}tryFatalErrorRecovery(){this.fatalError=null}_resetInitialViewPropertiesFromContent(){if(!this.defaultsFromMap)return;const t=()=>this.defaultsFromMap&&this.defaultsFromMap.start();this.defaultsFromMap.reset(),this._currentSpatialReference=null,this.notifyChange("spatialReference"),this.handles.remove("defaultsFromMap"),this.handles.add([ta(this,"spatialReference",((e,i)=>{Hd(e,i)||t()})),ta(this,"initialExtentRequired",t),Zr(t)],"defaultsFromMap")}};BU.views=new qo,e([ue("toolViewManager.activeTool")],BU.prototype,"activeTool",void 0),e([oe({readOnly:!0})],BU.prototype,"allLayerViews",void 0),e([oe()],BU.prototype,"groundView",void 0),e([oe()],BU.prototype,"animation",void 0),e([oe()],BU.prototype,"basemapView",void 0),e([oe()],BU.prototype,"defaultsFromMap",void 0),e([oe()],BU.prototype,"fatalError",void 0),e([oe({type:of})],BU.prototype,"extent",void 0),e([oe(CG(PG,"graphics"))],BU.prototype,"graphics",void 0),e([oe({readOnly:!0,type:ED,dependsOn:["map.heightModelInfo?","defaultsFromMap.heightModelInfo"]})],BU.prototype,"heightModelInfo",null),e([oe({readOnly:!0})],BU.prototype,"interacting",null),e([oe({readOnly:!0})],BU.prototype,"navigating",void 0),e([oe({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","initialExtentRequired","initialExtent","defaultsFromMap.isSpatialReferenceDone","defaultsFromMap.isTileInfoDone"]})],BU.prototype,"preconditionsReady",null),e([oe({type:qo,readOnly:!0})],BU.prototype,"layerViews",void 0),e([oe({type:$G})],BU.prototype,"magnifier",void 0),e([oe({value:null,type:_A})],BU.prototype,"map",null),e([oe()],BU.prototype,"padding",void 0),e([oe({readOnly:!0})],BU.prototype,"ready",void 0),e([oe({type:ap})],BU.prototype,"spatialReference",null),e([oe()],BU.prototype,"spatialReferenceWarningDelay",void 0),e([oe()],BU.prototype,"stationary",null),e([oe({readOnly:!0})],BU.prototype,"supportsGround",void 0),e([oe({type:uS})],BU.prototype,"timeExtent",void 0),e([ue("toolViewManager.tools")],BU.prototype,"tools",void 0),e([oe()],BU.prototype,"toolViewManager",void 0),e([oe({readOnly:!0})],BU.prototype,"type",void 0),e([oe({type:Number})],BU.prototype,"scale",void 0),e([oe({readOnly:!0})],BU.prototype,"updating",void 0),e([oe({readOnly:!0})],BU.prototype,"initialExtentRequired",void 0),e([oe({readOnly:!0,type:of})],BU.prototype,"initialExtent",null),e([oe()],BU.prototype,"cursor",null),e([oe({readOnly:!0})],BU.prototype,"input",void 0),e([oe({type:CU,nonNullable:!0})],BU.prototype,"navigation",void 0),e([oe()],BU.prototype,"layerViewManager",void 0),e([oe()],BU.prototype,"width",void 0),e([oe()],BU.prototype,"height",void 0),e([oe({readOnly:!0})],BU.prototype,"resizing",void 0),e([oe({value:null,readOnly:!0})],BU.prototype,"size",null),e([oe({readOnly:!0})],BU.prototype,"suspended",void 0),e([oe({readOnly:!0})],BU.prototype,"viewEvents",void 0),e([oe({readOnly:!0})],BU.prototype,"persistableViewModels",void 0),e([oe()],BU.prototype,"_isValid",void 0),e([oe()],BU.prototype,"_readyCycleForced",void 0),e([oe()],BU.prototype,"_currentSpatialReference",void 0),BU=UU=e([si("esri.views.View")],BU);const WU=BU;let HU=class extends Zo{constructor(t){super(t),this.state="running",this.target=null}initialize(){this.addResolvingPromise(new Promise(((t,e)=>this._dfd={resolve:t,reject:e})))}get done(){return"finished"===this.state||"stopped"===this.state}stop(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._dfd.reject(new Ve("ViewAnimation stopped")))}finish(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._dfd.resolve())}update(t,e){e||(e=cs(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",e)}};e([oe({readOnly:!0})],HU.prototype,"done",null),e([oe({readOnly:!0,type:String})],HU.prototype,"state",void 0),e([oe()],HU.prototype,"target",void 0),HU=e([si("esri.views.ViewAnimation")],HU),(HU||(HU={})).State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"};const JU=HU;function ZU(t,e,i,s){const n=3*t,r=3*(i-t)-n,o=1-n-r,a=3*e,l=3*(s-e)-a,u=1-a-l;function c(t){return((o*t+r)*t+n)*t}function h(t){return(3*o*t+2*r)*t+n}return function(t,e=1e-6){return function(t){return((u*t+l)*t+a)*t}(function(t,e){let i,s,n,r,o,a;for(n=t,a=0;a<8;a++){if(r=c(n)-t,Math.abs(r)<e)return n;if(o=h(n),Math.abs(o)<1e-6)break;n-=r/o}if(i=0,s=1,n=t,n<i)return i;if(n>s)return s;for(;i<s;){if(r=c(n),Math.abs(r-t)<e)return n;t>r?i=n:s=n,n=.5*(s-i)+i}return n}(t,e))}}const QU=/^cubic-bezier\((.*)\)/,KU={};function YU(){return[1,0,0,1,0,0]}function XU(t,e){return t[0]=e[0],t[1]=e[1],t}function tq(t,e,i){return t[0]=e,t[1]=i,t}function eq(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function iq(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function sq(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function nq(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function rq(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function oq(t,e){const i=e[0]-t[0],s=e[1]-t[1];return Math.sqrt(i*i+s*s)}function aq(t,e){const i=e[0]-t[0],s=e[1]-t[1];return i*i+s*s}function lq(t){const e=t[0],i=t[1];return Math.sqrt(e*e+i*i)}function uq(t){const e=t[0],i=t[1];return e*e+i*i}function cq(t,e){return t[0]=-e[0],t[1]=-e[1],t}function hq(t,e){const i=e[0],s=e[1];let n=i*i+s*s;return n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n),t}function dq(t,e){return t[0]*e[0]+t[1]*e[1]}function pq(t,e,i){const s=e[0]*i[1]-e[1]*i[0];return t[0]=t[1]=0,t[2]=s,t}function fq(t,e,i){const s=e[0],n=e[1];return t[0]=i[0]*s+i[2]*n+i[4],t[1]=i[1]*s+i[3]*n+i[5],t}KU.ease=ZU(.25,.1,.25,1),KU.linear=ZU(0,0,1,1),KU.easeIn=KU["ease-in"]=ZU(.42,0,1,1),KU.easeOut=KU["ease-out"]=ZU(0,0,.58,1),KU.easeInOut=KU["ease-in-out"]=ZU(.42,0,.58,1),Object.freeze({__proto__:null,create:YU,clone:function(t){return[t[0],t[1],t[2],t[3],t[4],t[5]]},fromValues:function(t,e,i,s,n,r){return[t,e,i,s,n,r]},createView:function(t,e){return new Float64Array(t,e,6)}});const yq=iq;function mq(){return[0,0]}function gq(t,e){return[t,e]}function vq(t,e){return new Float64Array(t,e,2)}function wq(){return gq(1,1)}function bq(){return gq(1,0)}function Mq(){return gq(0,1)}Object.freeze({__proto__:null,copy:XU,set:tq,add:eq,subtract:iq,multiply:sq,divide:nq,ceil:function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},floor:function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},min:function(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t},max:function(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t},round:function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},scale:rq,scaleAndAdd:function(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t},distance:oq,squaredDistance:aq,length:lq,squaredLength:uq,negate:cq,inverse:function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},normalize:hq,dot:dq,cross:pq,lerp:function(t,e,i,s){const n=e[0],r=e[1];return t[0]=n+s*(i[0]-n),t[1]=r+s*(i[1]-r),t},random:function(t,e){e=e||1;const i=2*fh()*Math.PI;return t[0]=Math.cos(i)*e,t[1]=Math.sin(i)*e,t},transformMat2:function(t,e,i){const s=e[0],n=e[1];return t[0]=i[0]*s+i[2]*n,t[1]=i[1]*s+i[3]*n,t},transformMat2d:fq,transformMat3:function(t,e,i){const s=e[0],n=e[1];return t[0]=i[0]*s+i[3]*n+i[6],t[1]=i[1]*s+i[4]*n+i[7],t},transformMat4:function(t,e,i){const s=e[0],n=e[1];return t[0]=i[0]*s+i[4]*n+i[12],t[1]=i[1]*s+i[5]*n+i[13],t},rotate:function(t,e,i,s){const n=e[0]-i[0],r=e[1]-i[1],o=Math.sin(s),a=Math.cos(s);return t[0]=n*a-r*o+i[0],t[1]=n*o+r*a+i[1],t},angle:function(t,e){const i=t[0],s=t[1],n=e[0],r=e[1];let o=i*i+s*s;o>0&&(o=1/Math.sqrt(o));let a=n*n+r*r;a>0&&(a=1/Math.sqrt(a));const l=(i*n+s*r)*o*a;return l>1?0:l<-1?Math.PI:Math.acos(l)},str:function(t){return"vec2("+t[0]+", "+t[1]+")"},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]},equals:function(t,e){const i=t[0],s=t[1],n=e[0],r=e[1];return Math.abs(i-n)<=ph*Math.max(1,Math.abs(i),Math.abs(n))&&Math.abs(s-r)<=ph*Math.max(1,Math.abs(s),Math.abs(r))},projectAndScale:function(t,e,i,s,n){let r=e[0]-i[0],o=e[1]-i[1];const a=(s[0]*r+s[1]*o)*(n-1);return r=s[0]*a,o=s[1]*a,t[0]=e[0]+r,t[1]=e[1]+o,t},len:lq,sub:yq,mul:sq,div:nq,dist:oq,sqrDist:aq,sqrLen:uq});const Sq=wq(),xq=bq(),kq=Mq();function Iq(t,e,i,s){return s&&i&&!s.equals(i)&&bp(s,i)&&s.isWebMercator?s.isWebMercator?function(t,e){let i=e[1];return i>89.99999?i=89.99999:i<-89.99999&&(i=-89.99999),i=Math.sin(yh(i)),tq(t,yh(e[0])*hp.radius,.5*hp.radius*Math.log((1+i)/(1-i)))}(t,e):function(t,e){const i=mh(e[0]/hp.radius);return tq(t,i-360*Math.floor((i+180)/360),mh(.5*Math.PI-2*Math.atan(Math.exp(-e[1]/hp.radius))))}(t,e):XU(t,e)}function jq(t){return t.wkid?t:t.spatialReference||ap.WGS84}function _q(t,e){return e.type?tq(t,e.x,e.y):XU(t,e)}function Tq(t){return DS(t)}function Oq(t,e){return Math.max(t.width/e[0],t.height/e[1])*function(t){return sp(t)?39.37*Tq(t)*96:1}(t.spatialReference)}async function Aq(t,e,i,s){let n,r;if(!t)return null;if(Array.isArray(t)&&!t.length)return null;if(qo.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&"object"==typeof t[0]){const n=t.every((t=>"attributes"in t)),r=t.some((t=>!t.geometry));let o=t;if(n&&r&&e&&e.allLayerViews){const i=new Map;for(const e of t){const t=e.layer,s=i.get(t)||[],n=e.attributes[t.objectIdField];null!=n&&s.push(n),i.set(t,s)}const s=[];i.forEach(((t,i)=>{const n=e.allLayerViews.find((t=>t.layer.id===i.id));if("queryFeatures"in n){const e=i.createQuery();e.objectIds=t,e.returnGeometry=!0,s.push(n.queryFeatures(e))}}));const n=await Promise.all(s),r=[];for(const t of n)if(t&&t.features&&t.features.length)for(const e of t.features)u(e.geometry)&&r.push(e.geometry);o=r}for(const t of o)s=await Aq(t,e,i,s);return s}if(Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1])n=new Fp(t);else if(t instanceof up)n=t;else if("geometry"in t)if(t.geometry)n=t.geometry;else if(t.layer){const i=t.layer,s=e.allLayerViews.find((t=>t.layer.id===i.id));if("queryFeatures"in s){const e=i.createQuery();e.objectIds=[t.attributes[i.objectIdField]],e.returnGeometry=!0,n=I(await s.queryFeatures(e),"features",0,"geometry")}}if(c(n))return null;if(r="point"===n.type?new of({xmin:n.x,ymin:n.y,xmax:n.x,ymax:n.y,spatialReference:n.spatialReference}):n.extent,!r)return null;const o=Mp(r,i);return c(o)?null:s=s?s.union(o):o}function Fq(t,e){const i=t.targetGeometry,s=e.targetGeometry;return i.x=s.x,i.y=s.y,i.spatialReference=s.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function Cq(t,e,i){return i?tq(t,.5*(e[0]-i.right+i.left),.5*(e[1]-i.bottom+i.top)):rq(t,e,.5)}Object.freeze({__proto__:null,create:mq,clone:function(t){return[t[0],t[1]]},fromValues:gq,fromArray:function(t){const e=[0,0],i=Math.min(2,t.length);for(let s=0;s<i;++s)e[s]=t[s];return e},createView:vq,zeros:function(){return[0,0]},ones:wq,unitX:bq,unitY:Mq,ZEROS:[0,0],ONES:Sq,UNIT_X:xq,UNIT_Y:kq});const Pq=function(){const t=[0,0];return function(e,i,s){const n=i.targetGeometry;_q(t,n);const r=.5*Lq(i);return e.xmin=t[0]-r*s[0],e.ymin=t[1]-r*s[1],e.xmax=t[0]+r*s[0],e.ymax=t[1]+r*s[1],e.spatialReference=n.spatialReference,e}}(),Eq=function(){const t=[0,0];return function(e,i,s){return yq(e,function(t,e){return rq(t,e,.5)}(e,i),Cq(t,i,s))}}(),Rq=function(){const t=[1,0,0,1,0,0],e=[0,0];return function(i,s,n,r){const o=Lq(s),a=Nq(s);return tq(e,o,o),gO(t,e),pO(t,t,a),yO(t,t,Eq(e,n,r)),yO(t,t,[0,r.top-r.bottom]),tq(i,t[4],t[5])}}();function Lq(t){return t.scale*function(t){return u(t)&&sp(t.spatialReference)?1/(39.37*Tq(t.spatialReference)*96):1}(t.targetGeometry)}function Nq(t){return yh(t.rotation)||0}const Dq=function(){const t=[0,0],e=[0,0],i=[0,0];return function(s,n,r,o,a,l){return cq(t,n),rq(e,r,.5*l),tq(i,1/o*l,-1/o*l),cO(s),yO(s,s,e),a&&pO(s,s,a),fO(s,s,i),yO(s,s,t),s}}(),Vq=function(){const t=[0,0];return function(e,i,s,n){const r=Lq(i),o=Nq(i);return _q(t,i.targetGeometry),Dq(e,t,s,r,o,n)}}(),$q=function(){const t=[0,0];return function(e,i,s,n){const r=Lq(i);return _q(t,i.targetGeometry),Dq(e,t,s,r,0,n)}}();function zq(t){if(t.isWrappable){const e=Jd(t);return e.valid[1]-e.valid[0]}return 0}const Gq=function(){const t=[0,0],e=[0,0],i=[0,0,0];return function(s,n,r){iq(t,s,n),hq(t,t),iq(e,s,r),hq(e,e),pq(i,t,e);let o=57.29577951308232*Math.acos(dq(t,e)/(lq(t)*lq(e)));return i[2]<0&&(o=-o),isNaN(o)&&(o=0),o}}(),Uq=function(){const t=[0,0];return function(e,i,s,n){const r=e.targetGeometry;return Fq(e,i),Rq(t,i,s,n),r.x+=t[0],r.y+=t[1],e}}(),qq=function(){const t=[0,0];return function(e,i,s){Fq(e,i);const n=e.targetGeometry,r=jq(s),o=jq(n);return _q(t,s),Iq(t,t,r,o),n.x=t[0],n.y=t[1],e}}(),Bq=function(){const t=[0,0];return function(e,i,s,n,r){r||(r="center"),yq(t,s,n),rq(t,t,.5);const o=t[0],a=t[1];switch(r){case"center":tq(t,0,0);break;case"left":tq(t,-o,0);break;case"top":tq(t,0,a);break;case"right":tq(t,o,0);break;case"bottom":tq(t,0,-a);break;case"top-left":tq(t,-o,a);break;case"bottom-left":tq(t,-o,-a);break;case"top-right":tq(t,o,a);break;case"bottom-right":tq(t,o,-a)}return Xq(e,i,t),e}}();function Wq(t,e,i){return Fq(t,e),t.rotation+=i,t}const Hq=function(){const t=[0,0];return function(e,i,s,n,r){return Fq(e,i),isNaN(s)||0===s||(Kq(t,n,i,r),e.scale=i.scale*s,Yq(t,t,e,r),Xq(e,e,tq(t,t[0]-n[0],n[1]-t[1]))),e}}();function Jq(t,e,i){return Fq(t,e),t.scale=i,t}const Zq=function(){const t=[0,0];return function(e,i,s,n,r,o){return Fq(e,i),isNaN(s)||0===s||(Kq(t,r,i,o),e.scale=i.scale*s,e.rotation+=n,Yq(t,t,e,o),Xq(e,e,tq(t,t[0]-r[0],r[1]-t[1]))),e}}(),Qq=function(){const t=[0,0],e=[0,0];return function(i,s,n,r,o,a,l){return Eq(e,a,l),eq(t,o,e),r?Zq(i,s,n,r,t,a):Hq(i,s,n,t,a)}}(),Kq=function(){const t=[1,0,0,1,0,0];return function(e,i,s,n){return fq(e,i,function(t,e,i){return Vq(t,e,i,1),hO(t,t)}(t,s,n))}}(),Yq=function(){const t=[1,0,0,1,0,0];return function(e,i,s,n){return fq(e,i,Vq(t,s,n,1))}}(),Xq=function(){const t=[0,0],e=[1,0,0,1,0,0];return function(i,s,n){Fq(i,s);const r=Lq(s),o=i.targetGeometry;return mO(e,Nq(s)),fO(e,e,gq(r,r)),fq(t,n,e),o.x+=t[0],o.y+=t[1],i}}();class tB{constructor(t,e,i,s){const n=t.targetGeometry,r=e.targetGeometry;s?"string"==typeof s&&(s=function(t){let e=KU[t]||null;if(!e){const i=QU.exec(t);if(i){const t=i[1].split(",").map((t=>parseFloat(t.trim())));4!==t.length||t.some((t=>isNaN(t)))||(e=ZU.apply(ZU,t))}}return e}(s)||KU.ease):s=KU.ease,this.easing=s,this.duration=i,this.sCenterX=n.x,this.sCenterY=n.y,this.sScale=t.scale,this.sRotation=t.rotation,this.tCenterX=r.x,this.tCenterY=r.y,this.tScale=e.scale,this.tRotation=e.rotation,this.dCenterX=this.tCenterX-this.sCenterX,this.dCenterY=this.tCenterY-this.sCenterY,this.dScale=this.tScale-this.sScale,this.dRotation=this.tRotation-this.sRotation,this.dRotation>180?this.dRotation-=360:this.dRotation<-180&&(this.dRotation+=360)}applyRatio(t,e){const i=this.easing(e);let s,n,r,o;e>=1?(s=this.tCenterX,n=this.tCenterY,r=this.tRotation,o=this.tScale):(s=this.sCenterX+i*this.dCenterX,n=this.sCenterY+i*this.dCenterY,r=this.sRotation+i*this.dRotation,o=this.sScale+i*this.dScale),t.targetGeometry.x=s,t.targetGeometry.y=n,t.scale=o,t.rotation=r}}let eB=class extends jo{constructor(t){super(t),this.duration=200,this.transition=null,this.easing=KU.ease,this.view=null,this.viewpoint=null,this.viewpoint=new DA({targetGeometry:new Fp,scale:0,rotation:0}),this._updateTask=Qr({postRender:this._postRender.bind(this)}),this._updateTask.pause()}destroy(){this._updateTask.remove(),this._updateTask=null}animate(t,e,i){this.stop(),Fq(this.viewpoint,e),this.transition=new tB(this.viewpoint,t.target,i&&i.duration||this.duration,i&&i.easing||this.easing);const s=()=>{this.animation===t&&this._updateTask&&("finished"===t.state&&(this.transition.applyRatio(this.viewpoint,1),this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())),this.animation=null,this.updateFunction=null)};return t.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=t,t}animateContinous(t,e){this.stop(),this.updateFunction=e,this.viewpoint=t;const i=new JU({target:t.clone()}),s=()=>{this.animation===i&&this._updateTask&&(this.animation=null,this.updateFunction=null)};return i.when(s,s),this._startTime=performance.now(),this._updateTask.resume(),this.animation=i,i}stop(){this.animation&&(this.animation.stop(),this.animation=null,this.updateFunction=null)}_postRender(t){const e=this.animation;if(e&&e.state!==JU.State.STOPPED){if(this.updateFunction)this.updateFunction(this.viewpoint,t.deltaTime);else{const t=(performance.now()-this._startTime)/this.transition.duration,e=t>=1;this.transition.applyRatio(this.viewpoint,t),e&&this.animation.finish()}this.view.state&&(this.view.state.viewpoint=this.viewpoint.clone())}else this._updateTask.pause()}};e([oe()],eB.prototype,"animation",void 0),e([oe()],eB.prototype,"duration",void 0),e([oe()],eB.prototype,"transition",void 0),e([oe()],eB.prototype,"easing",void 0),e([oe()],eB.prototype,"view",void 0),e([oe()],eB.prototype,"viewpoint",void 0),eB=e([si("esri.views.2d.AnimationManager")],eB);const iB=eB;class sB{constructor(t){this.view=t,this._frameTaskHandle=null,this._updateRequested=!1,this.stationary=!0,this.updateEnabled=!0,this.animationInProgress=!1,this.prepare=()=>{this._updateParameters.state=this.view.state,this._updateParameters.stationary=this.view.stationary,this._updateParameters.pixelRatio=window.devicePixelRatio,this._updateParameters.renderingOptions=this.view.renderingOptions},this.update=()=>{if(this._updateRequested=!1,!this.updateEnabled)return;const{basemapView:t,graphicsView:e,labelManager:i,layerViews:s,state:{id:n}}=this.view;t.baseLayerViews.forEach(this._updateLayerView,this),s.forEach(this._updateLayerView,this),t.referenceLayerViews.forEach(this._updateLayerView,this),u(i)&&(i.lastUpdateId!==n&&(i.viewChange(),i.lastUpdateId=n),i.updateRequested&&i.processUpdate(this._updateParameters)),u(e)&&(e.lastUpdateId!==n&&(e.viewChange(),e.lastUpdateId=n),e.updateRequested&&e.processUpdate(this._updateParameters)),this.view.graphicsTileStore.setViewState(this._updateParameters.state),this.animationInProgress||this._updateRequested||this._frameTaskHandle.pause()}}destroy(){this.stop()}start(){this.stationary=this.view.stationary,this._updateParameters={state:this.view.state,pixelRatio:window.devicePixelRatio,stationary:this.stationary,renderingOptions:this.view.renderingOptions},this._stationaryHandle=this.view.watch("stationary",(t=>{this.stationary=t,this.requestFrame()})),this._frameTaskHandle=Qr(this)}stop(){this._frameTaskHandle&&(this._stationaryHandle.remove(),this._frameTaskHandle.remove(),this._updateParameters=this._stationaryHandle=this._frameTaskHandle=null,this.stationary=!0,this.animationInProgress=!1)}requestUpdate(){this._updateRequested||(this._updateRequested=!0,this.requestFrame())}requestFrame(){this._frameTaskHandle&&this._frameTaskHandle.resume()}_updateLayerView(t){const e=this.view.state,i=t.lastUpdateId;null!=i&&(this.stationary||t.moving)||(t.moving=!0,t.moveStart()),i!==e.id&&t.viewChange(),this.stationary&&t.moving&&(t.moving=!1,t.moveEnd()),t.lastUpdateId=e.id,t.updateRequested&&t.processUpdate(this._updateParameters),"layerViews"in t&&t.layerViews.forEach(this._updateLayerView,this)}}function nB(){return Promise.all([import("./p-053d7623.js"),import("./p-b8c4e78e.js")])}const rB=()=>nB().then((()=>import("./p-15510e94.js"))),oB=()=>nB().then((()=>import("./p-94a8a82f.js"))),aB={"base-dynamic":()=>nB().then((()=>import("./p-df3aa678.js"))),"base-tile":rB,"bing-maps":rB,csv:oB,"geo-rss":()=>nB().then((()=>import("./p-7009fa44.js"))),feature:oB,geojson:oB,graphics:()=>nB().then((()=>import("./p-ad132d89.js"))),group:()=>nB().then((()=>import("./p-e34571ba.js"))),imagery:()=>nB().then((()=>import("./p-c66d4e88.js"))),"imagery-tile":()=>nB().then((()=>import("./p-41719e77.js"))),kml:()=>nB().then((()=>import("./p-e589406a.js"))),"map-image":()=>nB().then((()=>import("./p-8c938d58.js"))),"map-notes":()=>nB().then((()=>import("./p-67d7b2ae.js"))),"ogc-feature":()=>nB().then((()=>import("./p-e9716d88.js"))),"open-street-map":rB,route:()=>nB().then((()=>import("./p-b8c58eef.js"))),stream:()=>nB().then((()=>import("./p-560c199b.js"))),"subtype-group":()=>nB().then((()=>import("./p-6b258b4d.js"))),tile:rB,"vector-tile":()=>nB().then((()=>import("./p-a1a3212a.js"))),wcs:()=>nB().then((()=>import("./p-41719e77.js"))),"web-tile":rB,wfs:oB,wms:()=>nB().then((()=>import("./p-1334bec3.js"))),wmts:()=>nB().then((()=>import("./p-d6a21530.js"))),analysis:null,"base-elevation":null,"building-scene":null,elevation:null,"integrated-mesh":null,"point-cloud":null,voxel:null,scene:null,unknown:null,unsupported:null};let lB,uB=null;function cB(){return!!uB}function hB(){return lB||(lB=import("./p-80d464d6.js").then((t=>t.p)).then((({default:t})=>t({locateFile:t=>lr("esri/geometry/support/"+t)}))).then((t=>{IB(t)})),lB)}var dB,pB,fB;!function(t){function e(t,e,i){uB.ensureCache.prepare();const s=TB(i),n=i===s,r=uB.ensureFloat64(s),o=uB._pe_geog_to_proj(uB.getPointer(t),e,r);return o&&OB(i,e,r,n),o}function i(t,e,i){return s(t,e,i,0)}function s(t,e,i,s){uB.ensureCache.prepare();const n=TB(i),r=i===n,o=uB.ensureFloat64(n),a=uB._pe_proj_to_geog_center(uB.getPointer(t),e,o,s);return a&&OB(i,e,o,r),a}t.geogToProj=e,t.projGeog=function(t,s,n,r){switch(r){case pB.PE_TRANSFORM_P_TO_G:return i(t,s,n);case pB.PE_TRANSFORM_G_TO_P:return e(t,s,n)}return 0},t.projToGeog=i,t.projToGeogCenter=s}(dB||(dB={})),function(t){t.init=function(){t.PE_BUFFER_MAX=uB.PeDefs.prototype.PE_BUFFER_MAX,t.PE_NAME_MAX=uB.PeDefs.prototype.PE_NAME_MAX,t.PE_MGRS_MAX=uB.PeDefs.prototype.PE_MGRS_MAX,t.PE_USNG_MAX=uB.PeDefs.prototype.PE_USNG_MAX,t.PE_DD_MAX=uB.PeDefs.prototype.PE_DD_MAX,t.PE_DDM_MAX=uB.PeDefs.prototype.PE_DDM_MAX,t.PE_DMS_MAX=uB.PeDefs.prototype.PE_DMS_MAX,t.PE_UTM_MAX=uB.PeDefs.prototype.PE_UTM_MAX,t.PE_PARM_MAX=uB.PeDefs.prototype.PE_PARM_MAX,t.PE_TYPE_NONE=uB.PeDefs.prototype.PE_TYPE_NONE,t.PE_TYPE_GEOGCS=uB.PeDefs.prototype.PE_TYPE_GEOGCS,t.PE_TYPE_PROJCS=uB.PeDefs.prototype.PE_TYPE_PROJCS,t.PE_TYPE_GEOGTRAN=uB.PeDefs.prototype.PE_TYPE_GEOGTRAN,t.PE_TYPE_COORDSYS=uB.PeDefs.prototype.PE_TYPE_COORDSYS,t.PE_TYPE_UNIT=uB.PeDefs.prototype.PE_TYPE_UNIT,t.PE_TYPE_LINUNIT=uB.PeDefs.prototype.PE_TYPE_LINUNIT,t.PE_STR_OPTS_NONE=uB.PeDefs.prototype.PE_STR_OPTS_NONE,t.PE_STR_AUTH_NONE=uB.PeDefs.prototype.PE_STR_AUTH_NONE,t.PE_STR_AUTH_TOP=uB.PeDefs.prototype.PE_STR_AUTH_TOP,t.PE_STR_NAME_CANON=uB.PeDefs.prototype.PE_STR_NAME_CANON,t.PE_PARM_X0=uB.PeDefs.prototype.PE_PARM_X0,t.PE_PARM_ND=uB.PeDefs.prototype.PE_PARM_ND,t.PE_TRANSFORM_1_TO_2=uB.PeDefs.prototype.PE_TRANSFORM_1_TO_2,t.PE_TRANSFORM_2_TO_1=uB.PeDefs.prototype.PE_TRANSFORM_2_TO_1,t.PE_TRANSFORM_P_TO_G=uB.PeDefs.prototype.PE_TRANSFORM_P_TO_G,t.PE_TRANSFORM_G_TO_P=uB.PeDefs.prototype.PE_TRANSFORM_G_TO_P,t.PE_HORIZON_RECT=uB.PeDefs.prototype.PE_HORIZON_RECT,t.PE_HORIZON_POLY=uB.PeDefs.prototype.PE_HORIZON_POLY,t.PE_HORIZON_LINE=uB.PeDefs.prototype.PE_HORIZON_LINE,t.PE_HORIZON_DELTA=uB.PeDefs.prototype.PE_HORIZON_DELTA}}(pB||(pB={})),function(t){const e={},i={},s=t=>{if(t){const e=t.getType();switch(e){case pB.PE_TYPE_GEOGCS:t=uB.castObject(t,uB.PeGeogcs);break;case pB.PE_TYPE_PROJCS:t=uB.castObject(t,uB.PeProjcs);break;case pB.PE_TYPE_GEOGTRAN:t=uB.castObject(t,uB.PeGeogtran);break;default:e&pB.PE_TYPE_UNIT&&(t=uB.castObject(t,uB.PeUnit))}}return t};function n(t,i){let n=null,r=e[t];if(r||(r={},e[t]=r),r.hasOwnProperty(i+""))n=r[i];else{const e=uB.PeFactory.prototype.factoryByType(t,i);uB.compare(e,uB.NULL)||(n=e,r[i]=n)}return n=s(n),n}t.initialize=function(){uB.PeFactory.prototype.initialize(null)},t.coordsys=function(t){return n(pB.PE_TYPE_COORDSYS,t)},t.factoryByType=n,t.fromString=function(t,e){let n=null,r=i[t];if(r||(r={},i[t]=r),r.hasOwnProperty(e))n=r[e];else{const i=uB.PeFactory.prototype.fromString(t,e);uB.compare(i,uB.NULL)||(n=i,r[e]=n)}return n=s(n),n},t.geogcs=function(t){return n(pB.PE_TYPE_GEOGCS,t)},t.geogtran=function(t){return n(pB.PE_TYPE_GEOGTRAN,t)},t.getCode=function(t){return uB.PeFactory.prototype.getCode(t)},t.projcs=function(t){return n(pB.PE_TYPE_PROJCS,t)},t.unit=function(t){return n(pB.PE_TYPE_UNIT,t)}}(fB||(fB={}));let yB=null;var mB,gB,vB,wB,bB,MB,SB,xB,kB;function IB(t){function e(t,e,i){t[e]=i(t[e])}uB=t,pB.init(),mB.init(),bB.init(),SB.init(),xB.init(),yB=class extends uB.PeGCSExtent{destroy(){uB.destroy(this)}};const i=[uB.PeDatum,uB.PeGeogcs,uB.PeGeogtran,uB.PeObject,uB.PeParameter,uB.PePrimem,uB.PeProjcs,uB.PeSpheroid,uB.PeUnit];for(const t of i)e(t.prototype,"getName",(t=>function(){return t.call(this,Array(pB.PE_NAME_MAX))}));for(const t of[uB.PeGeogtran,uB.PeProjcs])e(t.prototype,"getParameters",(t=>function(){const e=Array(pB.PE_PARM_MAX);let i=t.call(this);for(let t=0;t<e.length;t++){const s=uB.getValue(i,"*");e[t]=s?uB.wrapPointer(s,uB.PeParameter):null,i+=Int32Array.BYTES_PER_ELEMENT}return e}));e(uB.PeHorizon.prototype,"getCoord",(t=>function(){const e=this.getSize();if(!e)return null;const i=[];return OB(i,e,t.call(this)),i})),e(uB.PeGTlistExtendedEntry.prototype,"getEntries",(t=>{const e=uB._pe_getPeGTlistExtendedGTsSize();return function(){let i=null;const s=t.call(this);if(!uB.compare(s,uB.NULL)){i=[s];const t=this.getSteps();if(t>1){const n=uB.getPointer(s);for(let s=1;s<t;s++)i.push(uB.wrapPointer(n+e*s,uB.PeGTlistExtendedGTs))}}return i}}));const s=uB._pe_getPeHorizonSize(),n=t=>function(){let e=this._cache;if(e||(e=new Map,this._cache=e),e.has(t))return e.get(t);let i=null;const n=t.call(this);if(!uB.compare(n,uB.NULL)){i=[n];const t=n.getNump();if(t>1){const e=uB.getPointer(n);for(let n=1;n<t;n++)i.push(uB.wrapPointer(e+s*n,uB.PeHorizon))}}return e.set(t,i),i};e(uB.PeProjcs.prototype,"horizonGcsGenerate",n),e(uB.PeProjcs.prototype,"horizonPcsGenerate",n),uB.PeObject.prototype.toString=function(t=pB.PE_STR_OPTS_NONE){uB.ensureCache.prepare();const e=uB.getPointer(this),i=uB.ensureInt8(Array(pB.PE_BUFFER_MAX));return uB.UTF8ToString(uB._pe_object_to_string_ext(e,t,i))}}function jB(t){if(!t)return;const e=uB.getClass(t);if(!e)return;const i=uB.getCache(e);if(!i)return;const s=uB.getPointer(t);s&&delete i[s]}function _B(t,e){const i=[],s=Array(e);for(let e=0;e<t;e++)i.push(uB.ensureInt8(s));return i}function TB(t){let e;return Array.isArray(t[0])?(e=[],t.forEach((t=>{e.push(t[0],t[1])}))):e=t,e}function OB(t,e,i,s=!1){if(s)for(let s=0;s<2*e;s++)t[s]=uB.getValue(i+s*Float64Array.BYTES_PER_ELEMENT,"double");else{const s=0===t.length;for(let n=0;n<e;n++)s&&(t[n]=[,,]),t[n][0]=uB.getValue(i,"double"),t[n][1]=uB.getValue(i+Float64Array.BYTES_PER_ELEMENT,"double"),i+=2*Float64Array.BYTES_PER_ELEMENT}}!function(t){let e;t.init=function(){t.PE_GTLIST_OPTS_COMMON=uB.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,e=uB._pe_getPeGTlistExtendedEntrySize()},t.getGTlist=function(t,i,s,n,r,o){let a=null;const l=new uB.PeInteger(o);try{const u=uB.PeGTlistExtended.prototype.getGTlist(t,i,s,n,r,l);if((o=l.val)&&(a=[u],o>1)){const t=uB.getPointer(u);for(let i=1;i<o;i++)a.push(uB.wrapPointer(t+e*i,uB.PeGTlistExtendedEntry))}}finally{uB.destroy(l)}return a}}(mB||(mB={})),(gB||(gB={})).destroy=function(t){if(t&&t.length){for(const e of t)jB(e),e.getEntries().forEach((t=>{jB(t);const e=t.getGeogtran();jB(e),e.getParameters().forEach(jB),[e.getGeogcs1(),e.getGeogcs2()].forEach((t=>{jB(t);const e=t.getDatum();jB(e),jB(e.getSpheroid()),jB(t.getPrimem()),jB(t.getUnit())}))}));uB.PeGTlistExtendedEntry.prototype.Delete(t[0])}},(vB||(vB={})).geogToGeog=function(t,e,i,s,n){uB.ensureCache.prepare();const r=TB(i),o=i===r,a=uB.ensureFloat64(r);let l=0;s&&(l=uB.ensureFloat64(s));const u=uB._pe_geog_to_geog(uB.getPointer(t),e,a,l,n);return u&&OB(i,e,a,o),u},function(t){const e=(t,e,i,s,n,r)=>{let o,a;switch(uB.ensureCache.prepare(),t){case"dd":o=uB._pe_geog_to_dd,a=pB.PE_DD_MAX;break;case"ddm":o=uB._pe_geog_to_ddm,a=pB.PE_DDM_MAX;break;case"dms":o=uB._pe_geog_to_dms,a=pB.PE_DMS_MAX}let l=0;e&&(l=uB.getPointer(e));const u=TB(s),c=uB.ensureFloat64(u),h=_B(i,a),d=o(l,i,c,n,uB.ensureInt32(h));if(d)for(let t=0;t<i;t++)r[t]=uB.UTF8ToString(h[t]);return d},i=(t,e,i,s,n)=>{let r;switch(uB.ensureCache.prepare(),t){case"dd":r=uB._pe_dd_to_geog;break;case"ddm":r=uB._pe_ddm_to_geog;break;case"dms":r=uB._pe_dms_to_geog}let o=0;e&&(o=uB.getPointer(e));const a=s.map((t=>uB.ensureString(t))),l=uB.ensureInt32(a),u=uB.ensureFloat64(Array(2*i)),c=r(o,i,l,u);return c&&OB(n,i,u),c};t.geog_to_dms=function(t,i,s,n,r){return e("dms",t,i,s,n,r)},t.dms_to_geog=function(t,e,s,n){return i("dms",t,e,s,n)},t.geog_to_ddm=function(t,i,s,n,r){return e("ddm",t,i,s,n,r)},t.ddm_to_geog=function(t,e,s,n){return i("ddm",t,e,s,n)},t.geog_to_dd=function(t,i,s,n,r){return e("dd",t,i,s,n,r)},t.dd_to_geog=function(t,e,s,n){return i("dd",t,e,s,n)}}(wB||(wB={})),function(t){t.init=function(){t.PE_MGRS_STYLE_NEW=uB.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,t.PE_MGRS_STYLE_OLD=uB.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,t.PE_MGRS_STYLE_AUTO=uB.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,t.PE_MGRS_180_ZONE_1_PLUS=uB.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,t.PE_MGRS_ADD_SPACES=uB.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES},t.geog_to_mgrs_extended=function(t,e,i,s,n,r,o){uB.ensureCache.prepare();let a=0;t&&(a=uB.getPointer(t));const l=TB(i),u=uB.ensureFloat64(l),c=_B(e,pB.PE_MGRS_MAX),h=uB.ensureInt32(c),d=uB._pe_geog_to_mgrs_extended(a,e,u,s,n,r,h);if(d)for(let t=0;t<e;t++)o[t]=uB.UTF8ToString(c[t]);return d},t.mgrs_to_geog_extended=function(t,e,i,s,n){uB.ensureCache.prepare();let r=0;t&&(r=uB.getPointer(t));const o=i.map((t=>uB.ensureString(t))),a=uB.ensureInt32(o),l=uB.ensureFloat64(Array(2*e)),u=uB._pe_mgrs_to_geog_extended(r,e,a,s,l);return u&&OB(n,e,l),u}}(bB||(bB={})),function(t){t.geog_to_usng=function(t,e,i,s,n,r,o){uB.ensureCache.prepare();let a=0;t&&(a=uB.getPointer(t));const l=TB(i),u=uB.ensureFloat64(l),c=_B(e,pB.PE_MGRS_MAX),h=uB.ensureInt32(c),d=uB._pe_geog_to_usng(a,e,u,s,n,r,h);if(d)for(let t=0;t<e;t++)o[t]=uB.UTF8ToString(c[t]);return d},t.usng_to_geog=function(t,e,i,s){uB.ensureCache.prepare();let n=0;t&&(n=uB.getPointer(t));const r=i.map((t=>uB.ensureString(t))),o=uB.ensureInt32(r),a=uB.ensureFloat64(Array(2*e)),l=uB._pe_usng_to_geog(n,e,o,a);return l&&OB(s,e,a),l}}(MB||(MB={})),function(t){t.init=function(){t.PE_UTM_OPTS_NONE=uB.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,t.PE_UTM_OPTS_ADD_SPACES=uB.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,t.PE_UTM_OPTS_NS=uB.PeNotationUtm.prototype.PE_UTM_OPTS_NS},t.geog_to_utm=function(t,e,i,s,n){uB.ensureCache.prepare();let r=0;t&&(r=uB.getPointer(t));const o=TB(i),a=uB.ensureFloat64(o),l=_B(e,pB.PE_UTM_MAX),u=uB.ensureInt32(l),c=uB._pe_geog_to_utm(r,e,a,s,u);if(c)for(let t=0;t<e;t++)n[t]=uB.UTF8ToString(l[t]);return c},t.utm_to_geog=function(t,e,i,s,n){uB.ensureCache.prepare();let r=0;t&&(r=uB.getPointer(t));const o=i.map((t=>uB.ensureString(t))),a=uB.ensureInt32(o),l=uB.ensureFloat64(Array(2*e)),u=uB._pe_utm_to_geog(r,e,a,s,l);return u&&OB(n,e,l),u}}(SB||(SB={})),function(t){const e=new Map;t.init=function(){t.PE_PCSINFO_OPTION_NONE=uB.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,t.PE_PCSINFO_OPTION_DOMAIN=uB.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,t.PE_POLE_OUTSIDE_BOUNDARY=uB.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,t.PE_POLE_POINT=uB.PePCSInfo.prototype.PE_POLE_POINT},t.generate=function(i,s=t.PE_PCSINFO_OPTION_DOMAIN){let n,r;return e.has(i)&&(r=e.get(i),r[s]&&(n=r[s])),n||(n=uB.PePCSInfo.prototype.generate(i,s),r||(r=[],e.set(i,r)),r[s]=n),n}}(xB||(xB={})),(kB||(kB={})).version_string=function(){return uB.PeVersion.prototype.version_string()};const AB=Object.freeze({__proto__:null,get _pe(){return uB},isLoaded:cB,isSupported:function(){return!!l("esri-wasm")},load:hB,get PeCSTransformations(){return dB},get PeDefs(){return pB},get PeFactory(){return fB},get PeGCSExtent(){return yB},get PeGTlistExtended(){return mB},get PeGTlistExtendedEntry(){return gB},get PeGTTransformations(){return vB},get PeNotationDms(){return wB},get PeNotationMgrs(){return bB},get PeNotationUsng(){return MB},get PeNotationUtm(){return SB},get PePCSInfo(){return xB},get PeVersion(){return kB},_init:IB}),FB=hp.radius,CB=hp.eccentricitySquared,PB={a1:FB*CB,a2:FB*CB*FB*CB,a3:FB*CB*CB/2,a4:FB*CB*FB*CB*2.5,a5:FB*CB+FB*CB*CB/2,a6:1-CB};let EB=0;class RB{constructor(t=null){this.uid=EB++,t?(this._wkt=void 0!==t.wkt?t.wkt:null,this._wkid=void 0!==t.wkid?t.wkid:-1,this._isInverse=void 0!==t.isInverse&&!0===t.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1)}static fromGE(t){const e=new RB;return e._wkt=t.wkt,e._wkid=t.wkid,e._isInverse=t.isInverse,e}get wkt(){return this._wkt}set wkt(t){this._wkt=t,this.uid=EB++}get wkid(){return this._wkid}set wkid(t){this._wkid=t,this.uid=EB++}get isInverse(){return this._isInverse}set isInverse(t){this._isInverse=t,this.uid=EB++}getInverse(){const t=new RB;return t._wkt=this.wkt,t._wkid=this._wkid,t._isInverse=!this.isInverse,t}}class LB{constructor(t){if(this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,t&&t.steps)for(const e of t.steps)this.steps.push(e instanceof RB?e:new RB({wkid:e.wkid,wkt:e.wkt,isInverse:e.isInverse}))}static cacheKey(t,e){return[null!=t.wkid?""+t.wkid:"-1",null!=t.wkt?""+t.wkt:"",null!=e.wkid?""+e.wkid:"-1",null!=e.wkt?""+e.wkt:""].join(",")}static fromGE(t){const e=new LB;let i="";for(const s of t.steps){const t=RB.fromGE(s);e.steps.push(t),i+=t.uid+","}return e._cached_projection={},e._gtlistentry=null,e._chain=i,e}getInverse(){const t=new LB;t.steps=[];for(let e=this.steps.length-1;e>=0;e--)t.steps.push(this.steps[e].getInverse());return t}getGTListEntry(){let t="";for(const e of this.steps)t+=e.uid+",";return t!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=t),this._gtlistentry}assignCachedGe(t,e,i){this._cached_projection[LB.cacheKey(t,e)]=i}getCachedGeTransformation(t,e){let i="";for(const t of this.steps)i+=t.uid+",";i!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=i);const s=this._cached_projection[LB.cacheKey(t,e)];return void 0===s?null:s}}let NB=null,DB=null,VB=null,$B={};function zB(){return!!NB&&cB()}function GB(t){return c(VB)&&(VB=Promise.all([hB(),import("./p-27823887.js").then((t=>t.g)),import("./p-1806a866.js")])),VB.then((([,e,{hydratedAdapter:i}])=>{Ji(t),DB=i,NB=e.default,NB._enableProjection(AB)}))}function UB(t,e,i=null){return Array.isArray(t)?0===t.length?[]:qB(DB,t,t[0].spatialReference,e,i):qB(DB,[t],t.spatialReference,e,i)[0]}function qB(t,e,i,s,n=null){if(c(i)||c(s))return e;if(HB(i,s,n))return e.map((t=>function(t,e,i){return t?"x"in t?function(t,e,i,s){PW[0]=t.x,PW[1]=t.y;const n=t.z;return PW[2]=void 0!==n?n:0,XB(PW,e,0,PW,s,0,1)?(i.x=PW[0],i.y=PW[1],i.spatialReference=s,void 0===n?(i.z=void 0,i.hasZ=!1):(i.z=PW[2],i.hasZ=!0),void 0===t.m?(i.m=void 0,i.hasM=!1):(i.m=t.m,i.hasM=!0),i):null}(t,e,new Fp,i):"xmin"in t?function(t,e,i,s){const{xmin:n,ymin:r,xmax:o,ymax:a,hasZ:l,hasM:u}=t;return YB(n,r,l?t.zmin:0,e,PW,s)?(i.xmin=PW[0],i.ymin=PW[1],l&&(i.zmin=PW[2]),YB(o,a,l?t.zmax:0,e,PW,s)?(i.xmax=PW[0],i.ymax=PW[1],l&&(i.zmax=PW[2]),u&&(i.mmin=t.mmin,i.mmax=t.mmax),i.spatialReference=s,i):null):null}(t,e,new of,i):"rings"in t?QB(t,e,new qf,i,0):"paths"in t?function(t,e,i,s){const{paths:n,hasZ:r,hasM:o}=t,a=[];return tW(n,r,o,e,a,s,0)?(i.paths=a,i.spatialReference=s,i.hasZ=r,i.hasM=o,i):null}(t,e,new Hf,i):"points"in t?function(t,e,i,s){const{points:n,hasZ:r,hasM:o}=t,a=[],l=n.length,u=[];for(const t of n)u.push(t[0],t[1],r?t[2]:0);if(!XB(u,e,0,u,s,0,l))return null;for(let t=0;t<l;++t){const e=3*t,i=u[e],s=u[e+1];a.push(r&&o?[i,s,u[e+2],n[t][3]]:r?[i,s,u[e+2]]:o?[i,s,n[t][2]]:[i,s])}return i.points=a,i.spatialReference=s,i.hasZ=r,i.hasM=o,i}(t,e,new hf,i):null:null}(t,i,s)));if(c(n)){const t=LB.cacheKey(i,s);void 0!==$B[t]?n=$B[t]:(c(n=BB(i,s,null))&&(n=new LB),$B[t]=n)}if(c(NB))throw new WB;return NB._project(t,e,i,s,n)}function BB(t,e,i=null){if(c(NB))throw new WB;if(c(t)||c(e))return null;const s=NB._getTransformation(DB,t,e,i,null==i?void 0:i.spatialReference);return null!==s?LB.fromGE(s):null}class WB extends Ve{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()")}}function HB(t,e,i){return!i&&(!!Hd(t,e)||sp(t)&&sp(e)&&!!xW(t,e,_W))}async function JB(t,e,i,s){if(!zB())if(Array.isArray(t)){for(const{source:e,dest:i,geographicTransformation:n}of t)if(!HB(e,i,n))return GB(s)}else if(!HB(t,e,i))return GB(s)}function ZB(t,e,i=e.spatialReference,s=0){return u(i)&&u(QB(t,t.spatialReference,e,i,s))}function QB(t,e,i,s,n){const{rings:r,hasZ:o,hasM:a}=t,l=[];return tW(r,o,a,e,l,s,n)?(i.rings=l,i.spatialReference=s,i.hasZ=o,i.hasM=a,i):null}function KB(t,e,i,s=0){PW[0]=t.x,PW[1]=t.y;const n=t.z;return PW[2]=void 0!==n?n:s,XB(PW,t.spatialReference,0,e,i,0,1)}function YB(t,e,i,s,n,r){return AW[0]=t,AW[1]=e,AW[2]=i,XB(AW,s,0,n,r,0,1)}function XB(t,e,i,s,n,r,o=1){const a=xW(e,n,_W);if(c(a))return!1;if(a===rW){if(t===s&&i===r)return!0;const e=i+3*o;for(let n=i,o=r;n<e;n++,o++)s[o]=t[n];return!0}const l=i+3*o;for(let e=i,n=r;e<l;e+=3,n+=3)a(t,e,s,n);return!0}function tW(t,e,i,s,n,r,o=0){const a=[];for(const i of t)for(const t of i)a.push(t[0],t[1],e?t[2]:o);if(!XB(a,s,0,a,r,0,a.length/3))return!1;let l=0;n.length=0;for(const s of t){const t=[];for(const n of s)e&&i?t.push([a[l++],a[l++],a[l++],n[3]]):e?t.push([a[l++],a[l++],a[l++]]):i?(t.push([a[l++],a[l++],n[2]]),l++):(t.push([a[l++],a[l++]]),l++);n.push(t)}return!0}function eW(t,e,i,s){if(c(t)||c(s))return!1;const n=nW(t,IW),r=nW(s,jW);if(n===r&&!iW(r)&&(0!==n||Hd(t,s)))return iM(i),oM(i,i,e),!0;if(iW(r)){const t=SW[n][11],s=SW[11][r];return!c(t)&&!c(s)&&(t(e,0,FW,0),s(FW,0,CW,0),sW(TW*FW[0],TW*FW[1],i),i[12]=CW[0],i[13]=CW[1],i[14]=CW[2],!0)}if(!(3!==r&&12!==r||2!==n&&1!==n&&3!==n)){const t=SW[n][11],s=SW[11][r];return!c(t)&&!c(s)&&(t(e,0,FW,0),s(FW,0,CW,0),1===n?function(t,e,i){sW(TW*FW[0],TW*FW[1],i),sM(i,i)}(0,0,i):iM(i),i[12]=CW[0],i[13]=CW[1],i[14]=CW[2],!0)}return!1}function iW(t){return 1===t||7===t||9===t}function sW(t,e,i){const s=Math.sin(t),n=Math.cos(t),r=Math.sin(e),o=Math.cos(e),a=i;return a[0]=-s,a[4]=-r*n,a[8]=o*n,a[12]=0,a[1]=n,a[5]=-r*s,a[9]=o*s,a[13]=0,a[2]=0,a[6]=o,a[10]=r,a[14]=0,a[3]=0,a[7]=0,a[11]=0,a[15]=1,a}function nW(t,e){return e.spatialReference===t?e.spatialReferenceId:(e.spatialReference=t,"metersPerUnit"in e&&(e.metersPerUnit=DS(t,1)),e.spatialReferenceId=t.wkt===fS.wkt?1:Qd(t)?2:Yd(t)?3:function(t){return sp(t)&&32662===t.wkid}(t)?12:t.wkt===gS.wkt?4:4490===t.wkid?5:t.wkt===yS.wkt?7:t.wkt===mS.wkt?9:tp(t)?8:ip(t)?10:0)}function rW(t,e,i,s){t!==i&&(i[s++]=t[e++],i[s++]=t[e++],i[s]=t[e])}function oW(t,e,i,s){i[s++]=OW*(t[e++]/hp.radius),i[s++]=OW*(Math.PI/2-2*Math.atan(Math.exp(-t[e++]/hp.radius))),i[s]=t[e]}function aW(t,e,i,s){!function(t,e,i,s,n){const r=.4999999*Math.PI,o=od(TW*t[e+1],-r,r),a=Math.sin(o);i[s++]=TW*t[e]*n.radius,i[s++]=n.halfSemiMajorAxis*Math.log((1+a)/(1-a)),i[s]=t[e+2]}(t,e,i,s,hp)}const lW=hp.radius*Math.PI/180,uW=180/(hp.radius*Math.PI);function cW(t,e,i,s){i[s]=t[e]*lW,i[s+1]=t[e+1]*lW,i[s+2]=t[e+2]}function hW(t,e,i,s){i[s]=t[e]*uW,i[s+1]=t[e+1]*uW,i[s+2]=t[e+2]}function dW(t,e,i,s,n){const r=n+t[e+2],o=TW*t[e+1],a=TW*t[e],l=Math.cos(o);i[s++]=Math.cos(a)*l*r,i[s++]=Math.sin(a)*l*r,i[s]=Math.sin(o)*r}function pW(t,e,i,s){dW(t,e,i,s,pp.radius)}function fW(t,e,i,s){dW(t,e,i,s,dp.radius)}function yW(t,e,i,s){dW(t,e,i,s,hp.radius)}function mW(t,e,i,s,n){const r=t[e],o=t[e+1],a=t[e+2],l=Math.sqrt(r*r+o*o+a*a),u=pd(a/(0===l?1:l));i[s++]=OW*Math.atan2(o,r),i[s++]=OW*u,i[s]=l-n}function gW(t,e,i,s){mW(t,e,i,s,pp.radius)}function vW(t,e,i,s){mW(t,e,i,s,dp.radius)}function wW(t,e,i,s){mW(t,e,i,s,hp.radius)}function bW(t,e,i,s){!function(t,e,i,s,n){const r=TW*t[e],o=TW*t[e+1],a=t[e+2],l=Math.sin(o),u=Math.cos(o),c=n.radius/Math.sqrt(1-n.eccentricitySquared*l*l);i[s++]=(c+a)*u*Math.cos(r),i[s++]=(c+a)*u*Math.sin(r),i[s++]=(c*(1-n.eccentricitySquared)+a)*l}(t,e,i,s,hp)}function MW(t,e,i,s){const n=PB,r=t[e],o=t[e+1],a=t[e+2];let l,u,c,h,d,p,f,y,m,g,v,w,b,M,S,x,k,I,j,_,T;l=Math.abs(a),u=r*r+o*o,c=Math.sqrt(u),h=u+a*a,d=Math.sqrt(h),_=Math.atan2(o,r),p=a*a/h,f=u/h,M=n.a2/d,S=n.a3-n.a4/d,f>.3?(y=l/d*(1+f*(n.a1+M+p*S)/d),j=Math.asin(y),g=y*y,m=Math.sqrt(1-g)):(m=c/d*(1-p*(n.a5-M-f*S)/d),j=Math.acos(m),g=1-m*m,y=Math.sqrt(g)),v=1-hp.eccentricitySquared*g,w=hp.radius/Math.sqrt(v),b=n.a6*w,M=c-w*m,S=l-b*y,k=m*M+y*S,x=m*S-y*M,I=x/(b/v+k),j+=I,T=k+x*I/2,a<0&&(j=-j),i[s++]=OW*_,i[s++]=OW*j,i[s]=T}const SW={2:{5:null,8:null,10:null,11:rW,6:rW,1:yW,7:null,9:null,0:null,3:aW,12:cW,2:rW,4:bW},5:{5:rW,8:null,10:null,11:rW,6:rW,1:yW,7:null,9:null,0:null,3:null,12:cW,2:null,4:bW},8:{5:null,8:rW,10:null,11:rW,6:null,1:null,7:fW,9:null,0:null,3:null,12:null,2:null,4:null},10:{5:null,8:null,10:rW,11:rW,6:null,1:null,7:null,9:pW,0:null,3:null,12:null,2:null,4:null},3:{5:null,8:null,10:null,11:oW,6:oW,1:function(t,e,i,s){oW(t,e,i,s),yW(i,s,i,s)},7:null,9:null,0:null,3:rW,12:function(t,e,i,s){oW(t,e,i,s),cW(i,s,i,s)},2:oW,4:function(t,e,i,s){oW(t,e,i,s),bW(i,s,i,s)}},4:{5:MW,8:null,10:null,11:MW,6:MW,1:function(t,e,i,s){MW(t,e,i,s),yW(i,s,i,s)},7:null,9:null,0:null,3:function(t,e,i,s){MW(t,e,i,s),aW(i,s,i,s)},12:function(t,e,i,s){MW(t,e,i,s),cW(i,s,i,s)},2:MW,4:rW},1:{5:wW,8:null,10:null,11:wW,6:wW,1:rW,7:null,9:null,0:null,3:function(t,e,i,s){wW(t,e,i,s),aW(i,s,i,s)},12:function(t,e,i,s){wW(t,e,i,s),cW(i,s,i,s)},2:wW,4:function(t,e,i,s){wW(t,e,i,s),bW(i,s,i,s)}},7:{5:null,8:vW,10:null,11:vW,6:null,1:null,7:rW,9:null,0:null,3:null,12:null,2:null,4:null},9:{5:null,8:null,10:gW,11:gW,6:null,1:null,7:null,9:rW,0:null,3:null,12:null,2:null,4:null},0:{5:null,8:null,10:null,11:null,6:null,1:null,7:null,9:null,0:rW,3:null,12:null,2:null,4:null},11:{5:rW,8:rW,10:rW,11:rW,6:rW,1:yW,7:fW,9:pW,0:null,3:aW,12:cW,2:rW,4:bW},6:{5:null,8:null,10:null,11:rW,6:rW,1:yW,7:null,9:null,0:null,3:null,12:cW,2:rW,4:bW},12:{5:hW,8:null,10:null,11:hW,6:hW,1:function(t,e,i,s){hW(t,e,i,s),yW(i,s,i,s)},7:null,9:null,0:null,3:function(t,e,i,s){hW(t,e,i,s),aW(i,s,i,s)},12:rW,2:hW,4:function(t,e,i,s){hW(t,e,i,s),bW(i,s,i,s)}}};function xW(t,e,i=kW()){return c(t)||c(e)?null:function(t,e,i){if(c(t)||c(e)||i.source.spatialReference===t&&i.dest.spatialReference===e)return i;const s=nW(t,i.source),n=nW(e,i.dest);return i.projector=0===s&&0===n?Hd(t,e)?rW:null:SW[s][n],i}(t,e,i).projector}function kW(){return{source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:rW}}const IW={spatialReference:null,spatialReferenceId:0},jW={spatialReference:null,spatialReferenceId:0},_W=kW(),TW=cd(1),OW=hd(1),AW=[0,0,0],FW=[0,0,0],CW=[0,0,0],PW=[0,0,0];var EW;const RW=ct.getLogger("esri.views.MapView");let LW=EW=class extends jo{constructor(t){super(t),this.geometry=null,this.spatialReference=null}get normalizedGeometry(){return c(this.geometry)||!this.spatialReference?null:this.spatialReference.equals(this.geometry.spatialReference)?this.geometry:bp(this.geometry,this.spatialReference)?Mp(this.geometry,this.spatialReference):zB()?UB(this.geometry,this.spatialReference):(RW.error("#constraints.geometry","unsupported coordinate system. The source geometry cannot be projected to the view's coordinate system. The projection engine cannot be loaded.",{geometry:this.geometry}),null)}constrain(t,e){if(c(this.normalizedGeometry))return t;const i=t.targetGeometry;if("extent"===this.normalizedGeometry.type?Pp(this.normalizedGeometry,i):Dp(this.normalizedGeometry,i))return t;const{coordinate:s}=function(t,e){const{spatialReference:i}=e,s=[e.x,e.y];let n=1/0,r=0,o=0;const a=[0,0],l="extent"===t.type?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:t.rings;for(const t of l)for(let e=0;e<t.length-1;e++){pf(a,s,t,e);const i=oq(s,a);i<n&&(n=i,r=a[0],o=a[1])}return{coordinate:new Fp({x:r,y:o,spatialReference:i}),distance:n}}(this.normalizedGeometry,i);return s?(t.targetGeometry=s,t):t}clone(){var t,e;return new EW({geometry:null==(t=this.geometry)?void 0:t.clone(),spatialReference:null==(e=this.spatialReference)?void 0:e.clone()})}};var NW;e([oe({constructOnly:!0})],LW.prototype,"geometry",void 0),e([oe({readOnly:!0})],LW.prototype,"normalizedGeometry",null),e([oe({constructOnly:!0})],LW.prototype,"spatialReference",void 0),LW=EW=e([si("esri.views.2d.constraints.GeometryConstraint")],LW);let DW=NW=class extends jo{constructor(){super(...arguments),this.enabled=!0,this.rotationEnabled=!0}constrain(t,e){return this.enabled&&e?(this.rotationEnabled||(t.rotation=e.rotation),t):t}clone(){return new NW({enabled:this.enabled,rotationEnabled:this.rotationEnabled})}};e([oe()],DW.prototype,"enabled",void 0),e([oe()],DW.prototype,"rotationEnabled",void 0),DW=NW=e([si("esri.views.2d.constraints.RotationConstraint")],DW);const VW=DW;var $W;let zW=$W=class extends jo{constructor(t){super(t),this._lodByScale={},this._scales=[],this.effectiveLODs=null,this.effectiveMinZoom=-1,this.effectiveMaxZoom=-1,this.effectiveMinScale=0,this.effectiveMaxScale=0,this.lods=null,this.minZoom=-1,this.maxZoom=-1,this.minScale=0,this.maxScale=0,this.snapToZoom=!0}initialize(){let t,{lods:e,minScale:i,maxScale:s,minZoom:n,maxZoom:r}=this,o=-1,a=-1,l=!1,u=!1;if(0!==i&&0!==s&&i<s&&([i,s]=[s,i]),!e||!e.length)return this._set("effectiveMinScale",i),void this._set("effectiveMaxScale",s);e=e.map((t=>t.clone())),e.sort(((t,e)=>e.scale-t.scale)),e.forEach(((t,e)=>t.level=e));for(const n of e)!l&&i>0&&i>=n.scale&&(o=n.level,l=!0),!u&&s>0&&s>=n.scale&&(a=t?t.level:-1,u=!0),t=n;-1===n&&(n=0===i?0:o),-1===r&&(r=0===s?e.length-1:a),n=Math.max(n,0),n=Math.min(n,e.length-1),r=Math.max(r,0),r=Math.min(r,e.length-1),n>r&&([n,r]=[r,n]),i=e[n].scale,s=e[r].scale,e.splice(0,n),e.splice(r-n+1,e.length),e.forEach(((t,e)=>{this._lodByScale[t.scale]=t,this._scales[e]=t.scale})),this._set("effectiveLODs",e),this._set("effectiveMinZoom",n),this._set("effectiveMaxZoom",r),this._set("effectiveMinScale",i),this._set("effectiveMaxScale",s)}constrain(t,e){if(e&&t.scale===e.scale)return t;const i=this.effectiveMinScale,s=this.effectiveMaxScale,n=t.targetGeometry,r=e&&e.targetGeometry,o=0!==i&&t.scale>i;if(0!==s&&t.scale<s||o){const a=o?i:s;if(r){const i=(a-e.scale)/(t.scale-e.scale);n.x=r.x+(n.x-r.x)*i,n.y=r.y+(n.y-r.y)*i}t.scale=a}return this.snapToZoom&&this.effectiveLODs&&(t.scale=this._getClosestScale(t.scale)),t}fit(t){if(!this.effectiveLODs||!this.snapToZoom)return this.constrain(t,null);const e=this.scaleToZoom(t.scale);return t.scale=this.zoomToScale(Math.abs(e-Math.floor(e))>.99?Math.round(e):Math.floor(e)),t}zoomToScale(t){if(!this.effectiveLODs)return 0;const e=this._scales;if((t=Math.max(0,t-=this.effectiveMinZoom))<=0)return e[0];if(t>=e.length)return e[e.length-1];const i=Math.round(t-.5),s=Math.round(t);return e[s]+(s-t)*(e[i]-e[s])}scaleToZoom(t){if(!this.effectiveLODs)return-1;const e=this._scales;let i,s;if(t>=e[0])return this.effectiveMinZoom;if(t<=e[e.length-1])return this.effectiveMaxZoom;for(let n=0;n<e.length-1;n++){if(i=e[n],s=e[n+1],s===t)return n+this.effectiveMinZoom+1;if(i>t&&s<t)return n+this.effectiveMinZoom+1-(t-s)/(i-s)}}snapToClosestScale(t){if(!this.effectiveLODs)return t;const e=this.scaleToZoom(t);return this.zoomToScale(Math.round(e))}snapToNextScale(t,e=.5){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i+1)}snapToPreviousScale(t,e=2){if(!this.effectiveLODs)return t*e;const i=Math.round(this.scaleToZoom(t));return this.zoomToScale(i-1)}clone(){return new $W({lods:this.lods,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale})}_getClosestScale(t){return this._lodByScale[t]||(t=this._scales.reduce(((e,i)=>Math.abs(i-t)<=Math.abs(e-t)?i:e),this._scales[0])),this._lodByScale[t].scale}};e([oe({readOnly:!0})],zW.prototype,"effectiveLODs",void 0),e([oe({readOnly:!0})],zW.prototype,"effectiveMinZoom",void 0),e([oe({readOnly:!0})],zW.prototype,"effectiveMaxZoom",void 0),e([oe({readOnly:!0})],zW.prototype,"effectiveMinScale",void 0),e([oe({readOnly:!0})],zW.prototype,"effectiveMaxScale",void 0),e([oe({type:[IG]})],zW.prototype,"lods",void 0),e([oe()],zW.prototype,"minZoom",void 0),e([oe()],zW.prototype,"maxZoom",void 0),e([oe()],zW.prototype,"minScale",void 0),e([oe()],zW.prototype,"maxScale",void 0),e([oe()],zW.prototype,"snapToZoom",void 0),zW=$W=e([si("esri.views.2d.constraints.ZoomConstraint")],zW);const GW=zW,UW={base:null,key:"type",typeMap:{extent:of,polygon:qf}};let qW=class extends To.EventedAccessor{constructor(){super(...arguments),this.lods=null,this.minScale=0,this.maxScale=0,this.minZoom=-1,this.maxZoom=-1,this.rotationEnabled=!0,this.snapToZoom=!0}initialize(){this.watch(["_zoom","_rotation"],this.emit.bind(this,"update"),!0)}destroy(){this.view=null,this._set("_zoom",null),this._set("_rotation",null)}set geometry(t){this._set("geometry",t||null)}get _defaultLODs(){const t=this.get("view.defaultsFromMap.tileInfo"),e=this.get("view.spatialReference");return t&&e&&t.spatialReference.equals(e)?t.lods:null}get _geometry(){return new LW({geometry:this.geometry,spatialReference:this.view.spatialReference})}get _rotation(){return new VW({rotationEnabled:this.rotationEnabled})}get _zoom(){return new GW({lods:this.lods||this._defaultLODs,minZoom:this.minZoom,maxZoom:this.maxZoom,minScale:this.minScale,maxScale:this.maxScale,snapToZoom:this.snapToZoom})}canZoomInTo(t){const e=this.effectiveMaxScale;return 0===e||t>=e}canZoomOutTo(t){const e=this.effectiveMinScale;return 0===e||t<=e}constrain(t,e){return this._zoom.constrain(t,e),this._rotation.constrain(t,e),this._geometry.constrain(t,e),t}constrainByGeometry(t){return this._geometry.constrain(t)}fit(t){return this._zoom.fit(t)}zoomToScale(t){return this._zoom.zoomToScale(t)}scaleToZoom(t){return this._zoom.scaleToZoom(t)}snapScale(t){return this._zoom.snapToClosestScale(t)}snapToNextScale(t){return this._zoom.snapToNextScale(t)}snapToPreviousScale(t){return this._zoom.snapToPreviousScale(t)}};e([oe({readOnly:!0,aliasOf:"_zoom.effectiveLODs"})],qW.prototype,"effectiveLODs",void 0),e([oe({readOnly:!0,aliasOf:"_zoom.effectiveMinScale"})],qW.prototype,"effectiveMinScale",void 0),e([oe({readOnly:!0,aliasOf:"_zoom.effectiveMaxScale"})],qW.prototype,"effectiveMaxScale",void 0),e([oe({readOnly:!0,aliasOf:"_zoom.effectiveMinZoom"})],qW.prototype,"effectiveMinZoom",void 0),e([oe({readOnly:!0,aliasOf:"_zoom.effectiveMaxZoom"})],qW.prototype,"effectiveMaxZoom",void 0),e([oe({types:UW,value:null})],qW.prototype,"geometry",null),e([oe({type:[IG]})],qW.prototype,"lods",void 0),e([oe()],qW.prototype,"minScale",void 0),e([oe()],qW.prototype,"maxScale",void 0),e([oe()],qW.prototype,"minZoom",void 0),e([oe()],qW.prototype,"maxZoom",void 0),e([oe()],qW.prototype,"rotationEnabled",void 0),e([oe()],qW.prototype,"snapToZoom",void 0),e([oe()],qW.prototype,"view",void 0),e([oe()],qW.prototype,"_defaultLODs",null),e([oe({type:LW})],qW.prototype,"_geometry",null),e([oe({type:VW})],qW.prototype,"_rotation",null),e([oe({readOnly:!0,type:GW})],qW.prototype,"_zoom",null),qW=e([si("esri.views.2d.MapViewConstraints")],qW);const BW=qW;function WW(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function HW(t,e,i,s,n,r,o,a,l,u){return t[0]=e,t[1]=i,t[2]=s,t[3]=n,t[4]=r,t[5]=o,t[6]=a,t[7]=l,t[8]=u,t}function JW(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function ZW(t,e){if(t===e){const i=e[1],s=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=s,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function QW(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=i[0],p=i[1],f=i[2],y=i[3],m=i[4],g=i[5],v=i[6],w=i[7],b=i[8];return t[0]=d*s+p*o+f*u,t[1]=d*n+p*a+f*c,t[2]=d*r+p*l+f*h,t[3]=y*s+m*o+g*u,t[4]=y*n+m*a+g*c,t[5]=y*r+m*l+g*h,t[6]=v*s+w*o+b*u,t[7]=v*n+w*a+b*c,t[8]=v*r+w*l+b*h,t}function KW(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=i[0],p=i[1];return t[0]=s,t[1]=n,t[2]=r,t[3]=o,t[4]=a,t[5]=l,t[6]=d*s+p*o+u,t[7]=d*n+p*a+c,t[8]=d*r+p*l+h,t}function YW(t,e,i){const s=e[0],n=e[1],r=e[2],o=e[3],a=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=Math.sin(i),p=Math.cos(i);return t[0]=p*s+d*o,t[1]=p*n+d*a,t[2]=p*r+d*l,t[3]=p*o-d*s,t[4]=p*a-d*n,t[5]=p*l-d*r,t[6]=u,t[7]=c,t[8]=h,t}function XW(t,e,i){const s=i[0],n=i[1],r=i[2];return t[0]=s*e[0],t[1]=s*e[1],t[2]=s*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=r*e[6],t[7]=r*e[7],t[8]=r*e[8],t}function tH(t,e,i){const s=i[0],n=i[1];return t[0]=s*e[0],t[1]=s*e[1],t[2]=s*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t}function eH(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],p=e[11],f=e[12],y=e[13],m=e[14],g=e[15],v=i*a-s*o,w=i*l-n*o,b=i*u-r*o,M=s*l-n*a,S=s*u-r*a,x=n*u-r*l,k=c*y-h*f,I=c*m-d*f,j=c*g-p*f,_=h*m-d*y,T=h*g-p*y,O=d*g-p*m;let A=v*O-w*T+b*_+M*j-S*I+x*k;return A?(A=1/A,t[0]=(a*O-l*T+u*_)*A,t[1]=(l*j-o*O-u*I)*A,t[2]=(o*T-a*j+u*k)*A,t[3]=(n*T-s*O-r*_)*A,t[4]=(i*O-n*j+r*I)*A,t[5]=(s*j-i*T-r*k)*A,t[6]=(y*x-m*S+g*M)*A,t[7]=(m*b-f*x-g*w)*A,t[8]=(f*S-y*b+g*v)*A,t):null}function iH(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t[3]=e[3]-i[3],t[4]=e[4]-i[4],t[5]=e[5]-i[5],t[6]=e[6]-i[6],t[7]=e[7]-i[7],t[8]=e[8]-i[8],t}function sH(t){const e=ph,i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8];return Math.abs(1-(i*i+r*r+l*l))<=e&&Math.abs(1-(s*s+o*o+u*u))<=e&&Math.abs(1-(n*n+a*a+c*c))<=e}function nH(){const t=new Float32Array(9);return t[0]=1,t[4]=1,t[8]=1,t}function rH(t){const e=new Float32Array(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function oH(){return new Float32Array(2)}function aH(t,e){const i=new Float32Array(2);return i[0]=t,i[1]=e,i}function lH(){return oH()}function uH(){return aH(1,1)}function cH(){return aH(1,0)}function hH(){return aH(0,1)}Object.freeze({__proto__:null,fromMat4:WW,copy:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},set:HW,identity:JW,transpose:ZW,invert:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8],h=c*o-a*u,d=-c*r+a*l,p=u*r-o*l;let f=i*h+s*d+n*p;return f?(f=1/f,t[0]=h*f,t[1]=(-c*s+n*u)*f,t[2]=(a*s-n*o)*f,t[3]=d*f,t[4]=(c*i-n*l)*f,t[5]=(-a*i+n*r)*f,t[6]=p*f,t[7]=(-u*i+s*l)*f,t[8]=(o*i-s*r)*f,t):null},adjoint:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=e[4],a=e[5],l=e[6],u=e[7],c=e[8];return t[0]=o*c-a*u,t[1]=n*u-s*c,t[2]=s*a-n*o,t[3]=a*l-r*c,t[4]=i*c-n*l,t[5]=n*r-i*a,t[6]=r*u-o*l,t[7]=s*l-i*u,t[8]=i*o-s*r,t},determinant:function(t){const e=t[3],i=t[4],s=t[5],n=t[6],r=t[7],o=t[8];return t[0]*(o*i-s*r)+t[1]*(-o*e+s*n)+t[2]*(r*e-i*n)},multiply:QW,translate:KW,rotate:YW,scale:XW,scaleByVec2:tH,fromTranslation:function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},fromRotation:function(t,e){const i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=0,t[3]=-i,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromScaling:function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},fromMat2d:function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},fromQuat:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[3],o=i+i,a=s+s,l=n+n,u=i*o,c=s*o,h=s*a,d=n*o,p=n*a,f=n*l,y=r*o,m=r*a,g=r*l;return t[0]=1-h-f,t[3]=c-g,t[6]=d+m,t[1]=c+g,t[4]=1-u-f,t[7]=p-y,t[2]=d-m,t[5]=p+y,t[8]=1-u-h,t},normalFromMat4Legacy:function(t,e){const i=e[0],s=e[1],n=e[2],r=e[4],o=e[5],a=e[6],l=e[8],u=e[9],c=e[10],h=c*o-a*u,d=-c*r+a*l,p=u*r-o*l,f=i*h+s*d+n*p;if(!f)return null;const y=1/f;return t[0]=h*y,t[1]=(-c*s+n*u)*y,t[2]=(a*s-n*o)*y,t[3]=d*y,t[4]=(c*i-n*l)*y,t[5]=(-a*i+n*r)*y,t[6]=p*y,t[7]=(-u*i+s*l)*y,t[8]=(o*i-s*r)*y,t},normalFromMat4:eH,projection:function(t,e,i){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/i,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},str:function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},frob:function(t){return Math.sqrt(t[0]**2+t[1]**2+t[2]**2+t[3]**2+t[4]**2+t[5]**2+t[6]**2+t[7]**2+t[8]**2)},add:function(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t[3]=e[3]+i[3],t[4]=e[4]+i[4],t[5]=e[5]+i[5],t[6]=e[6]+i[6],t[7]=e[7]+i[7],t[8]=e[8]+i[8],t},subtract:iH,multiplyScalar:function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*i,t},multiplyScalarAndAdd:function(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t[3]=e[3]+i[3]*s,t[4]=e[4]+i[4]*s,t[5]=e[5]+i[5]*s,t[6]=e[6]+i[6]*s,t[7]=e[7]+i[7]*s,t[8]=e[8]+i[8]*s,t},exactEquals:function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},equals:function(t,e){const i=t[0],s=t[1],n=t[2],r=t[3],o=t[4],a=t[5],l=t[6],u=t[7],c=t[8],h=e[0],d=e[1],p=e[2],f=e[3],y=e[4],m=e[5],g=e[6],v=e[7],w=e[8];return Math.abs(i-h)<=ph*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(s-d)<=ph*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(n-p)<=ph*Math.max(1,Math.abs(n),Math.abs(p))&&Math.abs(r-f)<=ph*Math.max(1,Math.abs(r),Math.abs(f))&&Math.abs(o-y)<=ph*Math.max(1,Math.abs(o),Math.abs(y))&&Math.abs(a-m)<=ph*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(l-g)<=ph*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-v)<=ph*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-w)<=ph*Math.max(1,Math.abs(c),Math.abs(w))},isOrthoNormal:sH,mul:QW,sub:iH}),Object.freeze({__proto__:null,create:nH,clone:rH,fromValues:function(t,e,i,s,n,r,o,a,l){const u=new Float32Array(9);return u[0]=t,u[1]=e,u[2]=i,u[3]=s,u[4]=n,u[5]=r,u[6]=o,u[7]=a,u[8]=l,u},createView:function(t,e){return new Float32Array(t,e,9)}});const dH=lH(),pH=uH(),fH=cH(),yH=hH();function mH(t){return function(t){return t instanceof Float32Array&&t.length>=2}(t)||function(t){return Array.isArray(t)&&t.length>=2}(t)}var gH;Object.freeze({__proto__:null,create:oH,clone:function(t){const e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e},fromValues:aH,createView:function(t,e){return new Float32Array(t,e,2)},zeros:lH,ones:uH,unitX:cH,unitY:hH,ZEROS:dH,ONES:pH,UNIT_X:fH,UNIT_Y:yH});const vH=[0,0];let wH=gH=class extends Vd{constructor(t){super(t),this._viewpoint2D={center:[0,0],rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new of,this.id=0,this.inverseTransform=[1,0,0,1,0,0],this.resolution=0,this.rotation=0,this.scale=0,this.transform=[1,0,0,1,0,0],this.transformNoRotation=[1,0,0,1,0,0],this.displayMat3=nH(),this.displayViewMat3=nH(),this.viewMat3=nH(),this.viewMat2d=aO(),this.worldScreenWidth=0,this.size=[0,0]}set pixelRatio(t){this._set("pixelRatio",t),this._update()}set size(t){this._set("size",t),this._update()}set viewpoint(t){if(t){const e=this._viewpoint2D,i=t.targetGeometry;e.center[0]=i.x,e.center[1]=i.y,e.rotation=t.rotation,e.scale=t.scale,e.spatialReference=i.spatialReference}this._update()}copy(t){const e=this.size,i=this.viewpoint;return i&&e?(this.viewpoint=Fq(i,t.viewpoint),this._set("size",XU(e,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new gH({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,e,i){return mH(e)?fq(t,e,this.inverseTransform):(vH[0]=e,vH[1]=i,fq(t,vH,this.inverseTransform))}toScreen(t,e,i){return mH(e)?fq(t,e,this.transform):(vH[0]=e,vH[1]=i,fq(t,vH,this.transform))}toScreenNoRotation(t,e,i){return mH(e)?fq(t,e,this.transformNoRotation):(vH[0]=e,vH[1]=i,fq(t,vH,this.transformNoRotation))}getScreenTransform(t,e){const{center:i}=this._viewpoint2D,s=this._get("pixelRatio")||1,n=this._get("size");return Dq(t,i,n,e,0,s),t}_update(){const{center:t,spatialReference:e,scale:i,rotation:s}=this._viewpoint2D,n=this._get("pixelRatio")||1,r=this._get("size"),o=new DA({targetGeometry:new Fp(t[0],t[1],e),scale:i,rotation:s});if(this._set("viewpoint",o),!r||!e||!i)return;this.resolution=Lq(o),this.rotation=s,this.scale=i,this.spatialReference=e,XU(this.center,t),HW(this.displayMat3,0!==r[0]?2/r[0]:0,0,0,0,0!==r[1]?-2/r[1]:0,0,-1,1,1);const a=JW(this.viewMat3),l=aH(r[0]/2,r[1]/2),u=aH(-r[0]/2,-r[1]/2),c=yh(s);KW(a,a,l),YW(a,a,c),KW(a,a,u),QW(this.displayViewMat3,this.displayMat3,a);const h=cO(this.viewMat2d);return yO(h,h,l),pO(h,h,c),yO(h,h,u),Pq(this.extent,o,r),Vq(this.transform,o,r,n),hO(this.inverseTransform,this.transform),$q(this.transformNoRotation,o,r,n),this.worldScreenWidth=function(t,e){return Math.round(zq(t)/e)}(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};e([oe({readOnly:!0})],wH.prototype,"id",void 0),e([oe({value:1,json:{write:!0}})],wH.prototype,"pixelRatio",null),e([oe({json:{write:!0}})],wH.prototype,"size",null),e([oe({type:DA,json:{write:!0}})],wH.prototype,"viewpoint",null),wH=gH=e([si("esri.views.2d.ViewState")],wH);const bH=wH;let MH=class extends jo{constructor(){super(...arguments),this.left=0,this.top=0,this.right=0,this.bottom=0}};e([oe()],MH.prototype,"left",void 0),e([oe()],MH.prototype,"top",void 0),e([oe()],MH.prototype,"right",void 0),e([oe()],MH.prototype,"bottom",void 0),MH=e([si("esri.views.2d.PaddedViewState.Padding")],MH);let SH=class extends bH{constructor(...t){super(...t),this.paddedViewState=new bH,this._updateContent=(()=>{const t=[0,0];return()=>{const e=this._get("size"),i=this._get("padding");if(!e||!i)return;const s=this.paddedViewState;tq(t,i.left+i.right,i.top+i.bottom),iq(t,e,t),XU(s.size,t);const n=s.viewpoint;n&&(this.viewpoint=n)}})(),this.watch(["size","padding"],this._updateContent,!0),this.padding=new MH,this.size=[0,0]}set padding(t){this._set("padding",t||new MH)}set viewpoint(t){if(t){const e=t.clone();this.paddedViewState.viewpoint=t,Uq(e,t,this._get("size"),this._get("padding"));const i=this._viewpoint2D,s=e.targetGeometry;i.center[0]=s.x,i.center[1]=s.y,i.rotation=e.rotation,i.scale=e.scale,i.spatialReference=s.spatialReference,this._update()}}};e([oe()],SH.prototype,"paddedViewState",void 0),e([oe({type:MH})],SH.prototype,"padding",null),e([oe()],SH.prototype,"viewpoint",null),SH=e([si("esri.views.2d.PaddedViewState")],SH);const xH=SH;class kH{constructor(t,e){this.item=t,this.controller=e,this.promise=null}}class IH{constructor(t){this._deferreds=new Map,this._controllers=new Map,this._processingItems=new Map,this._isPaused=!1,this._schedule=null,this._task=null,this.concurrency=1,t.concurrency&&(this.concurrency=t.concurrency),this._queue=new Nz(t.peeker),this.process=t.process;const e=t.scheduler;t.priority&&u(e)&&(this._task=e.registerTask(t.priority,this))}destroy(){this.clear(),this._schedule&&(this._schedule.remove(),this._schedule=null),this._task&&(this._task.remove(),this._task=null)}get length(){return this._processingItems.size+this._queue.length}abort(t){const e=this._controllers.get(t);e&&e.abort()}clear(){this._queue.clear();const t=[];this._controllers.forEach((e=>t.push(e))),this._controllers.clear(),t.forEach((t=>t.abort())),this._processingItems.clear(),this._cancelNext()}forEach(t){this._deferreds.forEach(((e,i)=>t(i)))}get(t){const e=this._deferreds.get(t);return e?e.promise:void 0}isOngoing(t){return this._processingItems.has(t)}has(t){return this._deferreds.has(t)}pause(){this._isPaused||(this._isPaused=!0,this._cancelNext())}push(t,e){const i=this.get(t);if(i)return i;const s=new AbortController;let n=null;e&&(n=Xi(e,(()=>s.abort())));const r=()=>{o.remove(),u(n)&&n.remove(),this._deferreds.delete(t),this._controllers.delete(t),this._queue.remove(t),this._processingItems.delete(t),this._scheduleNext()},o=ts(s.signal,(()=>{const e=this._processingItems.get(t);e&&e.controller.abort(),r(),a.reject(Hi())})),a=ns();return this._deferreds.set(t,a),this._controllers.set(t,s),a.promise.then(r,r),this._queue.push(t),this._scheduleNext(),a.promise}last(){return this._queue.last()}peek(){return this._queue.peek()}popLast(){return this._queue.popLast()}reset(){const t=[];this._processingItems.forEach((e=>t.push(e))),this._processingItems.clear();for(const e of t)this._queue.push(e.item),e.controller.abort();this._scheduleNext()}resume(){this._isPaused&&(this._isPaused=!1,this._scheduleNext())}takeAll(){const t=[];for(;this._queue.length;)t.push(this._queue.pop());return this.clear(),t}get running(){return!this._isPaused&&this._queue.length>0&&this._processingItems.size<this.concurrency}runTask(t){for(;!t.done&&this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop()),t.madeProgress()}_scheduleNext(){this._task||this._isPaused||this._schedule||(this._schedule=Zr((()=>{this._schedule=null,this._next()})))}_next(){for(;this._queue.length>0&&this._processingItems.size<this.concurrency;)this._process(this._queue.pop())}_cancelNext(){this._schedule&&(this._schedule.remove(),this._schedule=null)}_processResult(t,e){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).resolve(e))}_processError(t,e){this._canProcessFulfillment(t)&&(this._scheduleNext(),this._deferreds.get(t.item).reject(e))}_canProcessFulfillment(t){return!!this._deferreds.get(t.item)&&this._processingItems.get(t.item)===t}_process(t){if(c(t))return;let e;const i=new AbortController,s=new kH(t,i);this._processingItems.set(t,s);try{e=this.process(t,i.signal)}catch(t){this._processError(s,t)}cs(e)?(s.promise=e,e.then((t=>this._processResult(s,t)),(t=>this._processError(s,t)))):this._processResult(s,e)}get test(){return{update:t=>this.runTask(t)}}}const jH=new Set,_H=[],TH=new Map,OH=[0,0];let AH=class extends jo{constructor(t){super(t),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:t,process:e}=this;this._queue=new IH({concurrency:t,process:(t,i)=>{const s=this._keyToItem.get(t);return e(s,{signal:i})},peeker:t=>t.values().next().value})}destroy(){this.clear(),this._queue.destroy(),this._queue=null}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(t){this._queue.abort("string"==typeof t?t:t.id)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(t){return this._keyToItem.has("string"==typeof t?t:t.id)}isOngoing(t){const e="string"==typeof t?t:t.id;return this.has(e)&&this._queue.isOngoing(e)}pause(){this._queue.pause()}push(t,e){const i=t.key.id+"-"+e;if(this.has(i))return this.get(i);const s=this._queue.push(i),n=()=>{this._keyToItem.delete(i),this.notifyChange("updating")};return this._keyToItem.set(i,t),s.then(n,n),this.notifyChange("updating"),s}reset(){this._queue.reset(),this.notifyChange("updating")}resume(){this._queue.resume()}_peekByScaleFirst(t){if(!this.state)return t.values().next().value;const e=this.tileInfoView;let i=-1/0,s=1/0;t.forEach((t=>{const e=this._keyToItem.get(t),n=this.tileInfoView.getTileScale(e.key);TH.has(n)||(TH.set(n,[]),i=Math.max(n,i),s=Math.min(n,s)),TH.get(n).push(e.key),jH.add(n)}));let n=this.state.scale;TH.has(n)||(function(t,e){t.length=0,e.forEach((e=>t.push(e)))}(_H,jH),_H.sort(((t,e)=>t-e)),n=_H.reduce(((t,e)=>Math.abs(e-n)<Math.abs(t-n)?e:t),_H[0])),n=Math.min(n,i),n=Math.max(n,s);const r=TH.get(n),o=e.getClosestInfoForScale(n),a=o.getColumnForX(this.state.center[0]),l=o.getRowForY(this.state.center[1]);return r.sort(((t,e)=>{const i=o.denormalizeCol(t.col,t.world),s=o.denormalizeCol(e.col,e.world);return Math.sqrt((a-i)*(a-i)+(l-t.row)*(l-t.row))-Math.sqrt((a-s)*(a-s)+(l-e.row)*(l-e.row))})),jH.clear(),TH.clear(),r[0].id}_peekByCenterFirst(t){if(!this.state)return t.values().next().value;const e=this.tileInfoView,i=this.state.center;let s=1/0,n=null;return t.forEach((t=>{const r=this._keyToItem.get(t);e.getTileCoords(OH,r.key);const o=oq(OH,i);o<s&&(s=o,n=r.key)})),n.id}};e([oe({constructOnly:!0})],AH.prototype,"concurrency",void 0),e([oe({constructOnly:!0})],AH.prototype,"process",void 0),e([oe()],AH.prototype,"state",void 0),e([oe({constructOnly:!0})],AH.prototype,"strategy",void 0),e([oe({constructOnly:!0})],AH.prototype,"tileInfoView",void 0),e([oe({readOnly:!0})],AH.prototype,"updating",null),AH=e([si("esri.views.2d.tiling.PagedTileQueue")],AH);class FH{constructor(t,e,i,s){this.set(t,e,i,s)}static getId(t,e,i,s){return"object"==typeof t?`${t.level}/${t.row}/${t.col}/${t.world}`:`${t}/${e}/${i}/${s}`}get key(){return this}get id(){return""+this}set id(t){this.set(t)}get hash(){return(3&this.world)<<30|(4095&this.col)<<22|(4095&this.row)<<8|63&this.level}acquire(t,e,i,s){this.set(t,e,i,s)}contains(t){const e=t.level-this.level;return this.row===t.row>>e&&this.col===t.col>>e&&this.world===t.world}equals(t){return this.level===t.level&&this.row===t.row&&this.col===t.col&&this.world===t.world}clone(){return new FH(this)}release(){this.level=0,this.row=0,this.col=0,this.world=0}set(t,e,i,s){if(null==t)this.level=0,this.row=0,this.col=0,this.world=0;else if("object"==typeof t)this.level=t.level||0,this.row=t.row||0,this.col=t.col||0,this.world=t.world||0;else if("string"==typeof t){const[e,i,s,n]=t.split("/");this.level=parseFloat(e),this.row=parseFloat(i),this.col=parseFloat(s),this.world=parseFloat(n)}else this.level=+t,this.row=+e,this.col=+i,this.world=+s||0;return this}toString(){return`${this.level}/${this.row}/${this.col}/${this.world}`}getParentKey(){return this.level<=0?null:new FH(this.level-1,this.row>>1,this.col>>1,this.world)}getChildKeys(){const t=this.level+1,e=this.row<<1,i=this.col<<1,s=this.world;return[new FH(t,e,i,s),new FH(t,e,i+1,s),new FH(t,e+1,i,s),new FH(t,e+1,i+1,s)]}compareRowMajor(t){return this.row<t.row?-1:this.row>t.row?1:this.col<t.col?-1:this.col>t.col?1:0}}function CH(t,e){return[t,e]}function PH(t,e,i){return t[0]=e,t[1]=i,t}FH.pool=new gr(FH,null,null,25,50);const EH=new FH("0/0/0/0");class RH{constructor(t,e,i,s,n,r,o,a,l,u,c,h){this.level=t,this.resolution=e,this.scale=i,this.origin=s,this.first=n,this.last=r,this.size=o,this.norm=a,this.worldStart=l,this.worldEnd=u,this.worldSize=c,this.wrap=h}static create(t,e,i=null){const s=Jd(t.spatialReference),n=CH(t.origin.x,t.origin.y),r=CH(t.size[0]*e.resolution,t.size[1]*e.resolution),o=CH(-1/0,-1/0),a=CH(1/0,1/0),l=CH(1/0,1/0);u(i)&&(PH(o,Math.max(0,Math.floor((i.xmin-n[0])/r[0])),Math.max(0,Math.floor((n[1]-i.ymax)/r[1]))),PH(a,Math.max(0,Math.floor((i.xmax-n[0])/r[0])),Math.max(0,Math.floor((n[1]-i.ymin)/r[1]))),PH(l,a[0]-o[0]+1,a[1]-o[1]+1));const{cols:c,rows:h}=e;let d,p,f,y;return!i&&c&&h&&(PH(o,0,0),PH(a,c-1,h-1),PH(l,c,h)),t.isWrappable?(d=CH(Math.ceil(Math.round((s.valid[1]-s.valid[0])/e.resolution)/t.size[0]),l[1]),p=CH(Math.floor((s.origin[0]-n[0])/r[0]),o[1]),f=CH(d[0]+p[0]-1,a[1]),y=!0):(p=o,f=a,d=l,y=!1),new RH(e.level,e.resolution,e.scale,n,o,a,l,r,p,f,d,y)}normalizeCol(t){if(!this.wrap)return t;const e=this.worldSize[0];return t<0?e-1-Math.abs((t+1)%e):t%e}denormalizeCol(t,e){return this.wrap?this.worldSize[0]*e+t:t}getWorldForColumn(t){return this.wrap?Math.floor(t/this.worldSize[0]):0}getFirstColumnForWorld(t){return t*this.worldSize[0]+this.first[0]}getLastColumnForWorld(t){return t*this.worldSize[0]+this.first[0]+this.size[0]-1}getColumnForX(t){return(t-this.origin[0])/this.norm[0]}getXForColumn(t){return this.origin[0]+t*this.norm[0]}getRowForY(t){return(this.origin[1]-t)/this.norm[1]}getYForRow(t){return this.origin[1]-t*this.norm[1]}getTileBounds(t,e,i=!1){EH.set(e);const s=i?EH.col:this.denormalizeCol(EH.col,EH.world),n=EH.row;return function(t,e,i,s,n){t[0]=e,t[1]=i,t[2]=s,t[3]=n}(t,this.getXForColumn(s),this.getYForRow(n+1),this.getXForColumn(s+1),this.getYForRow(n)),t}getTileCoords(t,e,i=!1){EH.set(e);const s=i?EH.col:this.denormalizeCol(EH.col,EH.world);return Array.isArray(t)?PH(t,this.getXForColumn(s),this.getYForRow(EH.row)):(t.x=this.getXForColumn(s),t.y=this.getYForRow(EH.row)),t}}class LH{constructor(){this.spans=[]}acquire(t){this.lodInfo=t}release(){this.lodInfo=null,this.spans.length=0}forEach(t,e){const{spans:i,lodInfo:s}=this,{level:n}=s;if(0!==i.length)for(const{row:r,colFrom:o,colTo:a}of i)for(let i=o;i<=a;i++)t.call(e,n,r,s.normalizeCol(i),s.getWorldForColumn(i))}}LH.pool=new gr(LH);class NH{constructor(t,e,i){this.row=t,this.colFrom=e,this.colTo=i}}const DH=new FH("0/0/0/0");class VH{constructor(t,e,i,s,n,r,o,a){this.x=t,this.ymin=e,this.ymax=i,this.invM=s,this.leftAdjust=n,this.rightAdjust=r,this.leftBound=o,this.rightBound=a}static create(t,e){t[1]>e[1]&&([t,e]=[e,t]);const[i,s]=t,[n,r]=e,o=n-i,a=r-s,l=0!==a?o/a:0,u=(Math.ceil(s)-s)*l,c=(Math.floor(s)-s)*l;return new VH(i,Math.floor(s),Math.ceil(r),l,o<0?u:c,o<0?c:u,o<0?n:i,o<0?i:n)}incrRow(){this.x+=this.invM}getLeftCol(){return Math.max(this.x+this.leftAdjust,this.leftBound)}getRightCol(){return Math.min(this.x+this.rightAdjust,this.rightBound)}}const $H=[[0,0],[0,0],[0,0],[0,0]];class zH{constructor(t,e=null){this.tileInfo=t,this.fullExtent=e,this.scales=[],this._lodInfos=null,this._infoByScale={},this._infoByLevel={};const i=t.lods.slice();i.sort((function(t,e){return e.scale-t.scale}));const s=this._lodInfos=i.map((i=>RH.create(t,i,e)));i.forEach(((t,e)=>{this._infoByLevel[t.level]=s[e],this._infoByScale[t.scale]=s[e],this.scales[e]=t.scale}),this),this._wrap=t.isWrappable}get spatialReference(){return this.tileInfo.spatialReference}getLODInfoAt(t){return this._infoByLevel["number"==typeof t?t:t.level]}getTileBounds(t,e,i=!1){DH.set(e);const s=this._infoByLevel[DH.level];return s?s.getTileBounds(t,DH,i):t}getTileCoords(t,e,i=!1){DH.set(e);const s=this._infoByLevel[DH.level];return s?s.getTileCoords(t,DH,i):t}getTileCoverage(t,e=192,i="closest"){const s="closest"===i?this.getClosestInfoForScale(t.scale):this.getSmallestInfoForScale(t.scale),n=LH.pool.acquire(s),r=this._wrap;let o,a,l,u=1/0,c=-1/0;const h=n.spans;$H[0][0]=$H[0][1]=$H[1][1]=$H[3][0]=-e,$H[1][0]=$H[2][0]=t.size[0]+e,$H[2][1]=$H[3][1]=t.size[1]+e;for(const e of $H)t.toMap(e,e),e[0]=s.getColumnForX(e[0]),e[1]=s.getRowForY(e[1]);const d=[];let p=3;for(let t=0;t<4;t++){if($H[t][1]===$H[p][1]){p=t;continue}const e=VH.create($H[t],$H[p]);u=Math.min(e.ymin,u),c=Math.max(e.ymax,c),void 0===d[e.ymin]&&(d[e.ymin]=[]),d[e.ymin].push(e),p=t}if(null==u||null==c||c-u>100)return null;let f=[];for(o=u;o<c;){null!=d[o]&&(f=f.concat(d[o])),a=1/0,l=-1/0;for(let t=f.length-1;t>=0;t--){const e=f[t];a=Math.min(a,e.getLeftCol()),l=Math.max(l,e.getRightCol())}if(a=Math.floor(a),l=Math.floor(l),o>=s.first[1]&&o<=s.last[1])if(r)if(s.size[0]<s.worldSize[0]){const t=Math.floor(l/s.worldSize[0]);for(let e=Math.floor(a/s.worldSize[0]);e<=t;e++)h.push(new NH(o,Math.max(s.getFirstColumnForWorld(e),a),Math.min(s.getLastColumnForWorld(e),l)))}else h.push(new NH(o,a,l));else a>s.last[0]||l<s.first[0]||(a=Math.max(a,s.first[0]),l=Math.min(l,s.last[0]),h.push(new NH(o,a,l)));o+=1;for(let t=f.length-1;t>=0;t--){const e=f[t];e.ymax>=o?e.incrRow():f.splice(t,1)}}return n}getTileParentId(t){DH.set(t);const e=this._lodInfos.indexOf(this._infoByLevel[DH.level])-1;return e<0?null:(this._getTileIdAtLOD(DH,this._lodInfos[e],DH),DH.id)}getTileResolution(t){const e=this._infoByLevel["object"==typeof t?t.level:t];return e?e.resolution:-1}getTileScale(t){const e=this._infoByLevel[t.level];return e?e.scale:-1}intersects(t,e){DH.set(e);const i=this._infoByLevel[DH.level],s=t.lodInfo;if(s.resolution>i.resolution){this._getTileIdAtLOD(DH,s,DH);const e=s.denormalizeCol(DH.col,DH.world);for(const i of t.spans)if(i.row===DH.row&&i.colFrom<=e&&i.colTo>=e)return!0}if(s.resolution<i.resolution){const[e,n,r,o]=t.spans.reduce(((t,e)=>(t[0]=Math.min(t[0],e.row),t[1]=Math.max(t[1],e.row),t[2]=Math.min(t[2],e.colFrom),t[3]=Math.max(t[3],e.colTo),t)),[1/0,-1/0,1/0,-1/0]),a=i.denormalizeCol(DH.col,DH.world),l=s.getColumnForX(i.getXForColumn(a)),u=s.getRowForY(i.getYForRow(DH.row)),c=s.getColumnForX(i.getXForColumn(a+1))-1,h=s.getRowForY(i.getYForRow(DH.row+1))-1;return!(l>o||c<r||u>n||h<e)}const n=s.denormalizeCol(DH.col,DH.world);return t.spans.some((t=>t.row===DH.row&&t.colFrom<=n&&t.colTo>=n))}normalizeBounds(t,e,i){if(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],this._wrap){const e=Jd(this.tileInfo.spatialReference),s=-i*(e.valid[1]-e.valid[0]);t[0]+=s,t[2]+=s}return t}getSmallestInfoForScale(t){const e=this.scales;if(this._infoByScale[t])return this._infoByScale[t];if(t>e[0])return this._infoByScale[e[0]];for(let i=1;i<e.length-1;i++)if(t>e[i]+1e-6)return this._infoByScale[e[i-1]];return this._infoByScale[e[e.length-1]]}getClosestInfoForScale(t){const e=this.scales;return this._infoByScale[t]||(t=e.reduce(((e,i)=>Math.abs(i-t)<Math.abs(e-t)?i:e),e[0])),this._infoByScale[t]}scaleToLevel(t){const e=this.scales;if(this._infoByScale[t])return this._infoByScale[t].level;for(let i=e.length-1;i>=0;i--)if(t<e[i])return i===e.length-1?this._infoByScale[e[e.length-1]].level:this._infoByScale[e[i]].level+(e[i]-t)/(e[i]-e[i+1]);return this._infoByScale[e[0]].level}scaleToZoom(t){return this.tileInfo.scaleToZoom(t)}_getTileIdAtLOD(t,e,i){const s=this._infoByLevel[i.level];return t.set(i),e.resolution<s.resolution?null:(e.resolution===s.resolution||(t.level=e.level,t.col=Math.floor(i.col*s.resolution/e.resolution+.01),t.row=Math.floor(i.row*s.resolution/e.resolution+.01)),t)}}const GH=new Set,UH=[],qH=new Map,BH=[0,0];let WH=class extends jo{constructor(t){super(t),this._keyToItem=new Map,this.concurrency=6,this.strategy="scale-first",this.tileInfoView=null}initialize(){const{concurrency:t,process:e,strategy:i}=this;this._queue=new IH({concurrency:t,process:(t,i)=>{const s=this._keyToItem.get(t);return e(s,{signal:i})},peeker:"scale-first"===i?t=>this._peekByScaleFirst(t):t=>this._peekByCenterFirst(t)})}destroy(){this.clear(),this._queue.destroy(),this._queue=null}get length(){return this._queue?this._queue.length:0}get onGoingCount(){return this._keyToItem.size}get updating(){return this.length>0||this.onGoingCount>0}abort(t){this._queue.abort("string"==typeof t?t:t.id)}clear(){this._queue.clear(),this._keyToItem.clear(),this.notifyChange("updating")}has(t){return this._keyToItem.has("string"==typeof t?t:t.id)}isOngoing(t){const e="string"==typeof t?t:t.id;return this.has(e)&&this._queue.isOngoing(e)}pause(){this._queue.pause()}push(t){const e=t.key.id;if(this._queue.has(e))return this._queue.get(e);const i=this._queue.push(e),s=()=>{this._keyToItem.delete(e),this.notifyChange("updating")};return this._keyToItem.set(e,t),i.then(s,s),this.notifyChange("updating"),i}reset(){this._queue.reset()}resume(){this._queue.resume()}_peekByScaleFirst(t){if(!this.state)return t.values().next().value;const e=this.tileInfoView;let i=-1/0,s=1/0;t.forEach((t=>{const e=this._keyToItem.get(t),n=this.tileInfoView.getTileScale(e.key);qH.has(n)||(qH.set(n,[]),i=Math.max(n,i),s=Math.min(n,s)),qH.get(n).push(e.key),GH.add(n)}));let n=this.state.scale;qH.has(n)||(function(t,e){t.length=0,e.forEach((e=>t.push(e)))}(UH,GH),UH.sort(((t,e)=>t-e)),n=UH.reduce(((t,e)=>Math.abs(e-n)<Math.abs(t-n)?e:t),UH[0])),n=Math.min(n,i),n=Math.max(n,s);const r=qH.get(n),o=e.getClosestInfoForScale(n),a=o.getColumnForX(this.state.center[0]),l=o.getRowForY(this.state.center[1]);return r.sort(((t,e)=>{const i=o.denormalizeCol(t.col,t.world),s=o.denormalizeCol(e.col,e.world);return Math.sqrt((a-i)*(a-i)+(l-t.row)*(l-t.row))-Math.sqrt((a-s)*(a-s)+(l-e.row)*(l-e.row))})),GH.clear(),qH.clear(),r[0].id}_peekByCenterFirst(t){if(!this.state)return t.values().next().value;const e=this.tileInfoView,i=this.state.center;let s=1/0,n=null;return t.forEach((t=>{const r=this._keyToItem.get(t);e.getTileCoords(BH,r.key);const o=oq(BH,i);o<s&&(s=o,n=r.key)})),n.id}};e([oe({constructOnly:!0})],WH.prototype,"concurrency",void 0),e([oe({constructOnly:!0})],WH.prototype,"process",void 0),e([oe()],WH.prototype,"state",void 0),e([oe({constructOnly:!0})],WH.prototype,"strategy",void 0),e([oe({constructOnly:!0})],WH.prototype,"tileInfoView",void 0),e([oe({readOnly:!0})],WH.prototype,"updating",null),WH=e([si("esri.views.2d.tiling.TileQueue")],WH);const HH=WH;class JH{constructor(t,e,i){this.maxSize=t,this.tileInfoView=e,this.removedFunc=i,this._tilePerId=new Map,this._tileKeysPerLevel=[]}has(t){return this._tilePerId.has(t)}get(t){return this._tilePerId.get(t)}pop(t){const e=this._tilePerId.get(t);if(!e)return null;const i=this._tileKeysPerLevel[e.key.level];ZH(this._tilePerId,t);for(let e=0;e<i.length;e++)if(i[e].id===t){i.splice(e,1);break}return e.visible=!0,e}add(t){t.visible=!1;const e=t.key,i=e.id;if(this._tilePerId.has(i))return;this._tilePerId.set(i,t);const s=e.level;this._tileKeysPerLevel[s]||(this._tileKeysPerLevel[s]=[]),this._tileKeysPerLevel[s].push(e)}prune(t,e,i){let s=this._tilePerId.size;if(s<=this.maxSize)return;let n=this._tileKeysPerLevel.length-1;for(;s>this.maxSize&&n>=0;)n!==t&&(s=this._pruneAroundCenterTile(s,e,i,n)),n--;s>this.maxSize&&(s=this._pruneAroundCenterTile(s,e,i,t))}_pruneAroundCenterTile(t,e,i,s){const n=this._tileKeysPerLevel[s];if(!n||0===n.length)return t;const{size:r,origin:o}=this.tileInfoView.tileInfo,a=i*r[0],l=i*r[1],u=[0,0],c=[0,0];for(n.sort(((t,i)=>(u[0]=o.x+a*(t.col+.5),u[1]=o.y-l*(t.row+.5),c[0]=o.x+a*(i.col+.5),c[1]=o.y-l*(i.row+.5),aq(u,e)-aq(c,e))));n.length>0;){const e=n.pop();if(this._removeTile(e.id),--t===this.maxSize)break}return t}_removeTile(t){const e=this._tilePerId.get(t);this.removedFunc&&this.removedFunc(e),ZH(this._tilePerId,t)}}function ZH(t,e){t.delete(e)}const QH=new FH(0,0,0,0),KH=new Map,YH=[],XH=[];class tJ{constructor(t){this._previousScale=1/0,this.cachePolicy="keep",this.coveragePolicy="closest",this.resampling=!0,this.tileIndex=new Map,this.tiles=[],this.buffer=192,this.acquireTile=t.acquireTile,this.releaseTile=t.releaseTile,this.tileInfoView=t.tileInfoView,this.resampling=null==t.resampling||!!t.resampling,t.cachePolicy&&(this.cachePolicy=t.cachePolicy),t.coveragePolicy&&(this.coveragePolicy=t.coveragePolicy),null!=t.buffer&&(this.buffer=t.buffer),t.cacheSize&&(this._tileCache=new JH(t.cacheSize,this.tileInfoView,(t=>{this.releaseTile(t)})))}destroy(){this.tileIndex.clear()}update(t){const{resampling:e,tileIndex:i}=this,s=this.tileInfoView.getTileCoverage(t.state,this.buffer,this.coveragePolicy);if(XH.length=0,YH.length=0,KH.clear(),!s)return;const{minScale:n,maxScale:r}=this.tileInfoView.tileInfo,{spans:o,lodInfo:a}=s,{level:l}=a,{scale:u,center:c,resolution:h}=t.state,d=!t.stationary&&u>this._previousScale;if(this._previousScale=u,this.tiles.length=0,!e&&(u>n||u<r))return this.tiles.length=0,KH.clear(),i.forEach((t=>{this.releaseTile(t)})),i.clear(),XH.length=0,YH.length=0,KH.clear(),LH.pool.release(s),!0;i.forEach((t=>t.visible=!0));let p=0,f=0;if(o.length>0)for(const{row:t,colFrom:e,colTo:s}of o)for(let n=e;n<=s;n++){p++;const e=QH.set(l,t,a.normalizeCol(n),a.getWorldForColumn(n)).id;if(i.has(e)){const t=i.get(e);t.isReady?(KH.set(e,t),f++):d||this._addParentTile(e,KH)}else{let t;if(this._tileCache&&this._tileCache.has(e)){if(t=this._tileCache.pop(e),this.tileIndex.set(e,t),t.isReady){KH.set(e,t),f++;continue}}else t=this.acquireTile(QH),this.tileIndex.set(e,t);d||this._addParentTile(e,KH)}}const y=f===p;i.forEach(((t,e)=>{if(QH.set(e),KH.has(e))return;const i=this.tileInfoView.intersects(s,QH),n="purge"===this.cachePolicy?QH.level!==l:QH.level>l;!i||!d&&y?!n&&i||YH.push(e):t.isReady?n&&"purge"===this.cachePolicy&&this._hasReadyAncestor(QH,l)?YH.push(e):XH.push(e):n&&YH.push(e)}));for(const t of XH){const e=i.get(t);e&&e.isReady&&KH.set(t,e)}for(const t of YH){const e=i.get(t);this._tileCache?this._tileCache.add(e):this.releaseTile(e),i.delete(t)}return KH.forEach((t=>this.tiles.push(t))),i.forEach((t=>{KH.has(t.key.id)||(t.visible=!1)})),this._tileCache&&this._tileCache.prune(l,c,h),LH.pool.release(s),KH.clear(),y}clear(t=!0){const{tileIndex:e}=this;t&&e.forEach((t=>{this.releaseTile(t)})),e.clear()}updateCacheSize(t){this._tileCache&&(this._tileCache.maxSize=t)}_addParentTile(t,e){let i=t,s=null;for(;i=this.tileInfoView.getTileParentId(i),i;)if(this.tileIndex.has(i)){if(s=this.tileIndex.get(i),s&&s.isReady){e.has(s.key.id)||e.set(s.key.id,s);break}}else if(this._tileCache&&this._tileCache.has(i)&&(s=this._tileCache.pop(i),this.tileIndex.set(i,s),s&&s.isReady)){e.has(s.key.id)||e.set(s.key.id,s);break}}_hasReadyAncestor(t,e){const i=ag();this.tileInfoView.getTileBounds(i,t,!0);for(const s of this.tileIndex.values())if(s.isReady&&s.key.level>=e&&s.key.level<t.level){const t=ag();if(this.tileInfoView.getTileBounds(t,s.key,!0),vg(t,i))return!0}return!1}}var eJ,iJ,sJ={exports:{}};eJ=sJ,void 0!==(iJ=function(){function t(i,s,n,r,o){for(;r>n;){if(r-n>600){var a=r-n+1,l=s-n+1,u=Math.log(a),c=.5*Math.exp(2*u/3),h=.5*Math.sqrt(u*c*(a-c)/a)*(l-a/2<0?-1:1);t(i,s,Math.max(n,Math.floor(s-l*c/a+h)),Math.min(r,Math.floor(s+(a-l)*c/a+h)),o)}var d=i[s],p=n,f=r;for(e(i,n,s),o(i[r],d)>0&&e(i,n,r);p<f;){for(e(i,p,f),p++,f--;o(i[p],d)<0;)p++;for(;o(i[f],d)>0;)f--}0===o(i[n],d)?e(i,n,f):e(i,++f,r),f<=s&&(n=f+1),s<=f&&(r=f-1)}}function e(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}function i(t,e){return t<e?-1:t>e?1:0}return function(e,s,n,r,o){t(e,s,n||0,r||e.length-1,o||i)}}())&&(eJ.exports=iJ);const nJ=sJ.exports;function rJ(t,e){if(!(this instanceof rJ))return new rJ(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&("function"==typeof e?this.toBBox=e:this._initFormat(e)),this.clear()}function oJ(t,e,i){if(!i)return e.indexOf(t);for(var s=0;s<e.length;s++)if(i(t,e[s]))return s;return-1}function aJ(t,e){lJ(t,0,t.children.length,e,t)}function lJ(t,e,i,s,n){n||(n=vJ(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(var r,o=e;o<i;o++)r=t.children[o],uJ(n,t.leaf?s(r):r);return n}function uJ(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function cJ(t,e){return t.minX-e.minX}function hJ(t,e){return t.minY-e.minY}function dJ(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function pJ(t){return t.maxX-t.minX+(t.maxY-t.minY)}function fJ(t,e){return(Math.max(e.maxX,t.maxX)-Math.min(e.minX,t.minX))*(Math.max(e.maxY,t.maxY)-Math.min(e.minY,t.minY))}function yJ(t,e){var i=Math.max(t.minX,e.minX),s=Math.max(t.minY,e.minY),n=Math.min(t.maxX,e.maxX),r=Math.min(t.maxY,e.maxY);return Math.max(0,n-i)*Math.max(0,r-s)}function mJ(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function gJ(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function vJ(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function wJ(t,e,i,s,n){for(var r,o=[e,i];o.length;)(i=o.pop())-(e=o.pop())<=s||(nJ(t,r=e+Math.ceil((i-e)/s/2)*s,e,i,n),o.push(e,r,r,i))}rJ.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[],s=this.toBBox;if(!gJ(t,e))return i;for(var n,r,o,a,l=[];e;){for(n=0,r=e.children.length;n<r;n++)o=e.children[n],gJ(t,a=e.leaf?s(o):o)&&(e.leaf?i.push(o):mJ(t,a)?this._all(o,i):l.push(o));e=l.pop()}return i},collides:function(t){var e=this.data,i=this.toBBox;if(!gJ(t,e))return!1;for(var s,n,r,o,a=[];e;){for(s=0,n=e.children.length;s<n;s++)if(r=e.children[s],gJ(t,o=e.leaf?i(r):r)){if(e.leaf||mJ(t,o))return!0;a.push(r)}e=a.pop()}return!1},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;e<i;e++)this.insert(t[e]);return this}var s=this._build(t.slice(),0,t.length-1,0);if(this.data.children.length)if(this.data.height===s.height)this._splitRoot(this.data,s);else{if(this.data.height<s.height){var n=this.data;this.data=s,s=n}this._insert(s,this.data.height-s.height-1,!0)}else this.data=s;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=vJ([]),this},remove:function(t,e){if(!t)return this;for(var i,s,n,r,o=this.data,a=this.toBBox(t),l=[],u=[];o||l.length;){if(o||(o=l.pop(),s=l[l.length-1],i=u.pop(),r=!0),o.leaf&&-1!==(n=oJ(t,o.children,e)))return o.children.splice(n,1),l.push(o),this._condense(l),this;r||o.leaf||!mJ(o,a)?s?(i++,o=s.children[i],r=!1):o=null:(l.push(o),u.push(i),i=0,s=o,o=o.children[0])}return this},toBBox:function(t){return t},compareMinX:cJ,compareMinY:hJ,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i,s){var n,r=i-e+1,o=this._maxEntries;if(r<=o)return aJ(n=vJ(t.slice(e,i+1)),this.toBBox),n;s||(o=Math.ceil(r/Math.pow(o,(s=Math.ceil(Math.log(r)/Math.log(o)))-1))),(n=vJ([])).leaf=!1,n.height=s;var a,l,u,c=Math.ceil(r/o),h=c*Math.ceil(Math.sqrt(o));for(wJ(t,e,i,h,this.compareMinX),a=e;a<=i;a+=h)for(wJ(t,a,u=Math.min(a+h-1,i),c,this.compareMinY),l=a;l<=u;l+=c)n.children.push(this._build(t,l,Math.min(l+c-1,u),s-1));return aJ(n,this.toBBox),n},_chooseSubtree:function(t,e,i,s){for(var n,r,o,a,l,u,c,h;s.push(e),!e.leaf&&s.length-1!==i;){for(c=h=1/0,n=0,r=e.children.length;n<r;n++)l=dJ(o=e.children[n]),(u=fJ(t,o)-l)<h?(h=u,c=l<c?l:c,a=o):u===h&&l<c&&(c=l,a=o);e=a||e.children[0]}return e},_insert:function(t,e,i){var s=i?t:(0,this.toBBox)(t),n=[],r=this._chooseSubtree(s,this.data,e,n);for(r.children.push(t),uJ(r,s);e>=0&&n[e].children.length>this._maxEntries;)this._split(n,e),e--;this._adjustParentBBoxes(s,n,e)},_split:function(t,e){var i=t[e],s=i.children.length,n=this._minEntries;this._chooseSplitAxis(i,n,s);var r=this._chooseSplitIndex(i,n,s),o=vJ(i.children.splice(r,i.children.length-r));o.height=i.height,o.leaf=i.leaf,aJ(i,this.toBBox),aJ(o,this.toBBox),e?t[e-1].children.push(o):this._splitRoot(i,o)},_splitRoot:function(t,e){this.data=vJ([t,e]),this.data.height=t.height+1,this.data.leaf=!1,aJ(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,i){var s,n,r,o,a,l,u,c;for(l=u=1/0,s=e;s<=i-e;s++)o=yJ(n=lJ(t,0,s,this.toBBox),r=lJ(t,s,i,this.toBBox)),a=dJ(n)+dJ(r),o<l?(l=o,c=s,u=a<u?a:u):o===l&&a<u&&(u=a,c=s);return c},_chooseSplitAxis:function(t,e,i){var s=t.leaf?this.compareMinX:cJ,n=t.leaf?this.compareMinY:hJ;this._allDistMargin(t,e,i,s)<this._allDistMargin(t,e,i,n)&&t.children.sort(s)},_allDistMargin:function(t,e,i,s){t.children.sort(s);var n,r,o=this.toBBox,a=lJ(t,0,e,o),l=lJ(t,i-e,i,o),u=pJ(a)+pJ(l);for(n=e;n<i-e;n++)r=t.children[n],uJ(a,t.leaf?o(r):r),u+=pJ(a);for(n=i-e-1;n>=e;n--)r=t.children[n],uJ(l,t.leaf?o(r):r),u+=pJ(l);return u},_adjustParentBBoxes:function(t,e,i){for(var s=i;s>=0;s--)uJ(e[s],t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children).splice(e.indexOf(t[i]),1):this.clear():aJ(t[i],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=Function("a","b",e.join(t[0])),this.compareMinY=Function("a","b",e.join(t[1])),this.toBBox=Function("a","return {minX: a"+t[0]+", minY: a"+t[1]+", maxX: a"+t[2]+", maxY: a"+t[3]+"};")}};class bJ{constructor(t,e){this.key=new FH(0,0,0,0),this.bounds=ag(),this.objectIds=new Set,this.key.set(e);const i=t.getLODInfoAt(this.key);this.tileInfoView=t,this.tileInfoView.getTileBounds(this.bounds,this.key,!0),this.resolution=i.resolution,this.scale=i.scale,this.level=i.level}get id(){return this.key.id}get extent(){return of.fromBounds(this.bounds,this.tileInfoView.tileInfo.spatialReference)}get transform(){return{originPosition:"upperLeft",scale:[this.resolution,this.resolution],translate:[this.bounds[0],this.bounds[3]]}}createChildTiles(){const t=this.key.getChildKeys(),e=Ar.acquire();for(let i=0;i<t.length;i++)e[i]=new bJ(this.tileInfoView,t[i]);return e}getQuantizationParameters(){return pE.fromJSON({mode:"view",originPosition:"upperLeft",tolerance:this.resolution,extent:{xmin:this.bounds[0],ymin:this.bounds[1],xmax:this.bounds[2],ymax:this.bounds[3],spatialReference:this.tileInfoView.tileInfo.spatialReference}})}}const MJ={added:[],removed:[]},SJ=new Set,xJ=new FH(0,0,0,0);class kJ extends To{constructor(t){super(),this._tiles=new Map,this._index=rJ(9,l("esri-csp-restrictions")?t=>({minX:t.bounds[0],minY:t.bounds[1],maxX:t.bounds[2],maxY:t.bounds[3]}):[".bounds[0]",".bounds[1]",".bounds[2]",".bounds[3]"]),this.tiles=[],this.tileScheme=t}destroy(){this.clear()}clear(){this.tiles.length=0,this._tiles.clear(),this._index.clear()}has(t){return this._tiles.has(t)}get(t){return this._tiles.get(t)}boundsIntersections(t){return this._index.search({minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]})}updateTiles(t){const e={added:[],removed:[]};for(const i of t.added)if(!this.has(i)){const t=new bJ(this.tileScheme,i);this._tiles.set(i,t),this._index.insert(t),e.added.push(t)}for(const i of t.removed)if(this.has(i)){const t=this.get(i);this._tiles.delete(i),this._index.remove(t),e.removed.push(t)}this.tiles.length=0,this._tiles.forEach((t=>this.tiles.push(t))),(e.added.length||e.removed.length)&&this.emit("update",e)}setViewState(t){const e=this.tileScheme.getTileCoverage(t,0);if(!e)return;const{spans:i,lodInfo:s}=e,{level:n}=s;if(i.length>0)for(const{row:t,colFrom:e,colTo:r}of i)for(let i=e;i<=r;i++){const e=xJ.set(n,t,s.normalizeCol(i),s.getWorldForColumn(i)).id;if(SJ.add(e),!this.has(e)){const t=new bJ(this.tileScheme,e);this._tiles.set(e,t),this._index.insert(t),this.tiles.push(t),MJ.added.push(t)}}for(let t=this.tiles.length-1;t>=0;t--){const e=this.tiles[t];SJ.has(e.id)||(this._tiles.delete(e.id),this.tiles.splice(t,1),this._index.remove(e),MJ.removed.push(e))}(MJ.added.length||MJ.removed.length)&&this.emit("update",MJ),LH.pool.release(e),SJ.clear(),MJ.added.length=0,MJ.removed.length=0}}class IJ{constructor(){this._names=new Map}begin(t){this._names.has(t)||(this._names.set(t,!1),(t=>-1!==t.indexOf("Brush"))(t)&&this.record("Esri.FirstDraw"),performance.mark(`Esri.${t}.Start`))}end(t){this._names.has(t)&&!this._names.get(t)&&(this._names.set(t,!0),performance.mark(`Esri.${t}.End`))}record(t){this._names.has(t)||(this._names.set(t,!0),performance.mark("Esri."+t))}}const jJ=ct.getLogger("esri.views.MapView");let _J=class extends(AG(WU)){constructor(t){super(t),this._stationaryTimer=null,this.frameTask=new sB(this),this.featuresTilingScheme=null,this.fullOpacity=1,this.graphicsView=null,this.initialExtent=null,this.labelManager=null,this.renderingOptions={samplingMode:"dynamic",edgeLabelsVisible:!0,labelsAnimationTime:125,labelCollisionsEnabled:!0},this.resizeAlign="center",this.supportsGround=!1,this.timeline=new IJ,this.type="2d",this.constraints=new BW,this.padding={top:0,right:0,bottom:0,left:0};const e=this.handles,i=()=>this.notifyChange("updating");e.add([this.watch("viewpoint",(()=>{this._lastStationaryEventTimestamp=performance.now(),this._flipStationary(160)}),!0),this.on("resize",(t=>this._resizeHandler(t))),this.watch("animationManager.animation",(t=>{this.animation=t})),this.allLayerViews.on("change",(()=>{i(),e.remove("map-view-base-layerViewsUpdating"),e.add(this.allLayerViews.map((t=>t.watch("updating",i))),"map-view-base-layerViewsUpdating")}))],"map-view-base")}destroy(){this.destroyed||(this._set("preconditionsReady",!1),this._gotoTask=this.frameTask=null)}set animation(t){const e=this._get("animation");if(t===e)return;if(e&&e.stop(),!t||t.isFulfilled())return void this._set("animation",null);this._set("animation",t),this.frameTask.animationInProgress=!0;const i=()=>{t===this._get("animation")&&(this._set("animation",null),this.frameTask.requestFrame()),this.frameTask.animationInProgress=!1};t.when(i,i)}get center(){if(!this.ready)return this._get("center");const{center:t,spatialReference:e}=this.state.paddedViewState;return new Fp({x:t[0],y:t[1],spatialReference:e})}set center(t){if(null==t)return;if(!this._normalizeInput(t))return void jJ.error("#center",`incompatible spatialReference ${JSON.stringify(t.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`);if(!this.ready)return this._set("center",t),void this.notifyChange("initialExtentRequired");const e=this.viewpoint;qq(e,e,t),this.viewpoint=e}set constraints(t){const e=this._get("constraints");e&&(this.handles.remove("map-view-base-constraints"),e.destroy()),this._set("constraints",t),t&&(t.view=this,this.ready&&(this.state.viewpoint=t.fit(this.state.paddedViewState.viewpoint)),this.handles.add(t.on("update",(()=>{this.ready&&this.state&&(this.state.viewpoint=t.fit(this.state.paddedViewState.viewpoint))})),"map-view-base-constraints"))}get extent(){return this.ready?this.state.paddedViewState.extent.clone():this._get("extent")}set extent(t){if(null==t)return;const e=this._normalizeInput(t);if(!e)return void jJ.error("#center",`incompatible spatialReference ${JSON.stringify(t.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`);if(!e.width||!e.height)return void jJ.error("#extent","invalid extent size");if(!this.ready)return this._set("extent",e),this._set("center",null),this._set("viewpoint",null),this._set("scale",0),this._set("zoom",-1),void this.notifyChange("initialExtentRequired");const i=this.viewpoint;(function(t,e,i,s,n){qq(t,e,i.center),t.scale=Oq(i,s),n&&n.constraints&&n.constraints.constrain(t)})(i,i,e,this.size,{constraints:this.constraints}),this.viewpoint=i}get graphicsTileStore(){return new kJ(this.featuresTilingScheme)}get initialExtentRequired(){const{extent:t,center:e,scale:i,viewpoint:s,zoom:n}=this;return!(this.get("map.initialViewProperties.viewpoint")||t||e&&(0!==i||-1!==n)||s)}get padding(){return this.ready?this.state.padding:this._get("padding")}set padding(t){this.ready?(this.state.padding=t,this._set("padding",this.state.padding)):this._set("padding",t)}get resolution(){return this.state?this.state.resolution:0}get rotation(){return this.ready?this.state.rotation:this._get("rotation")}set rotation(t){if(isNaN(t))return;if(!this.ready)return void this._set("rotation",t);const e=this.viewpoint;(function(t,e,i){Fq(t,e),t.rotation=i})(e,e,t),this.viewpoint=e}get scale(){return this.ready?this.state.scale:this._get("scale")}set scale(t){if(!t||isNaN(t))return;if(!this.ready){this._set("scale",t),this._set("zoom",-1);const e=this._get("extent");return e&&(this._set("extent",null),this._set("center",e.center)),void this.notifyChange("initialExtentRequired")}const e=this.viewpoint;Jq(e,e,t),this.viewpoint=e}get stationary(){return!(this.animation||this.navigating||this._get("resizing")||this._stationaryTimer)}get updating(){return!this.destroyed&&(!0===this.get("layerViewManager.updating")||!0===this.get("labelManager.updating")||!0===this.get("graphicsView.updating")||this.allLayerViews.some((t=>!t.destroyed&&!("layerViews"in t)&&!0===t.updating)))}get viewpoint(){if(!this.ready)return this._get("viewpoint");const t=this.state.paddedViewState;return t&&t.viewpoint.clone()}set viewpoint(t){if(null==t)return;const e=this._normalizeInput(t);if(!e)return void(!t.scale||isNaN(t.scale)?jJ.error("#viewpoint","invalid scale value of "+t.scale):c(t.targetGeometry)?jJ.error("#viewpoint","geometry not defined"):jJ.error("#viewpoint",`incompatible spatialReference ${JSON.stringify(t.targetGeometry.spatialReference)} with view's spatialReference ${JSON.stringify(this.spatialReference)}`));if(!this.ready)return this._set("viewpoint",e),this._set("extent",null),this._set("center",null),this._set("zoom",-1),this._set("scale",0),void this.notifyChange("initialExtentRequired");const i=new DA({targetGeometry:new Fp,scale:0,rotation:0});Fq(i,e),this.constraints.constrain(i,this.state.paddedViewState.viewpoint),this.state.viewpoint=i,this.frameTask.requestFrame(),this._set("viewpoint",i)}get zoom(){return this.ready?this.constraints.scaleToZoom(this.scale):this._get("zoom")}set zoom(t){if(null==t)return;if(!this.ready){this.notifyChange("initialExtentRequired"),this._set("zoom",t),this._set("scale",0);const e=this._get("extent");e&&(this._set("extent",null),this._set("center",e.center))}if(!this.constraints.effectiveLODs)return;const e=this.viewpoint;Jq(e,e,this.constraints.zoomToScale(t)),this.viewpoint=e,this._set("zoom",this.constraints.scaleToZoom(this.scale))}goTo(t,e){if(t)return this.animation&&(this.animation=null),this._createAnimation(),oa(this,"ready",e&&e.signal).then((()=>{const i={animate:!0,...e},s=function(t,e){return async function(t,e){if(!t||!e)return new DA({targetGeometry:new Fp,scale:0,rotation:0});let i=e.spatialReference;const{constraints:s,padding:n,viewpoint:r,size:o}=e,a=[n?o[0]-n.left-n.right:o[0],n?o[1]-n.top-n.bottom:o[1]];let l=null;t instanceof DA?l=t:t.viewpoint?l=t.viewpoint:t.target&&"esri.Viewpoint"===t.target.declaredClass&&(l=t.target);let c=null;l&&l.targetGeometry?c=l.targetGeometry:t instanceof of?c=t:(t||t&&("center"in t||"extent"in t||"target"in t))&&(c=await Aq(t.center,e,i)||await Aq(t.extent,e,i)||await Aq(t.target,e,i)||await Aq(t,e,i)),!c&&r&&r.targetGeometry?c=r.targetGeometry:!c&&e.extent&&(c=e.extent);const h=jq(c);if(i||(i=jq(e.spatialReference||e.extent||c)),!bp(c,i)&&h&&!h.equals(i))return null;const d=_q([0,0],c.center?c.center:c),p=new Fp(Iq(d,d,h,i),i);let f=null;if(l&&u(l.targetGeometry)&&"point"===l.targetGeometry.type)f=l.scale;else if(t.hasOwnProperty("scale")&&t.scale)f=t.scale;else if(t.hasOwnProperty("zoom")&&-1!==t.zoom&&s&&s.effectiveLODs)f=s.zoomToScale(t.zoom);else if(Array.isArray(c)||"point"===c.type||"extent"===c.type&&0===c.width&&0===c.height){const t=Mp(e.extent,i);f=u(t)?Oq(t,a):e.extent?Oq(e.extent,a):r.scale}else f=bp(c.extent,i)?Oq(Mp(c.extent,i),a):Oq(c.extent,a);const y=function(t){if(t&&(!Array.isArray(t)||"number"!=typeof t[0])&&("object"==typeof t||Array.isArray(t)&&"object"==typeof t[0])){if("layer"in t&&t.layer&&t.layer.minScale&&t.layer.maxScale){const e=t.layer;return{min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every((t=>"layer"in t))){let e=0,i=0;for(const s of t){const t=s.layer;t&&t.minScale&&t.maxScale&&(e=t.minScale<e?t.minScale:e,i=t.maxScale>i?t.maxScale:i)}return e&&i?{min:e,max:i}:null}}}(t);y&&(y.min&&y.min>f?f=y.min:y.max&&y.max<f&&(f=y.max));let m=0;l?m=l.rotation:t.hasOwnProperty("rotation")?m=t.rotation:r&&(m=r.rotation);let g=new DA({targetGeometry:p,scale:f,rotation:m});return s&&(g=s.fit(g),s.constrainByGeometry(g),s.rotationEnabled||(g.rotation=m)),g}(t,e)}(t,this);return this.animation.update(s),this._gotoTask={},i.animate?this._gotoAnimated(s,i):this._gotoImmediate(s,i)}));jJ.error("#goTo()","target cannot be null or undefined")}hitTest(t){return Promise.reject("Should be implemented by subclasses")}popupHitTest(t){return this.hitTest(t).then((e=>({...e,mapPoint:this.toMap(t)})))}toMap(t){if(!this.ready)return null;const[e,i]=this.state.toMap([0,0],[t.x,t.y]);return new Fp({x:e,y:i,spatialReference:this.spatialReference})}isTileInfoRequired(){return!0}toScreen(t){if(!this.ready)return null;const e=this._normalizeInput(t),i=[e.x,e.y];return this.state.toScreen(i,i),pm(i[0],i[1])}pixelSizeAt(){return this.ready?this.state.resolution:(jJ.error("#pixelSizeAt()","Map view cannot be used before it is ready"),null)}requestUpdate(){this.ready&&this.frameTask.requestUpdate()}getDefaultSpatialReference(){return this.get("map.initialViewProperties.spatialReference")||this.get("defaultsFromMap.spatialReference")||null}isSpatialReferenceSupported(t,e){return!(!e&&!this._get("ready"))||null!==this._getDefaultViewpoint()}importLayerView(t){return(t=>{const e=aB[t.type];if(!u(e))throw function(t){const e=t.declaredClass?t.declaredClass.slice(t.declaredClass.lastIndexOf(".")+1):"Unknown",i=e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();return new Ve(i+":view-not-supported",e+" is not supported in 2D")}(t);return e(t)})(t)}hasLayerViewModule(t){return(t=>u(aB[t.type]))(t)}_createAnimation(){return this.animation&&!this.animation.done||(this.animation=new JU),this.animation}_cancellableGoTo(t,e,i){const s=()=>t===this._gotoTask,n=i.then((()=>{s()&&(this.animation=null)})).catch((t=>{throw s()&&(this.animation=null,e.done||(e.stop(),this.frameTask.animationInProgress=!1)),t})),r=new Promise((t=>t(n)));return e.when().catch((()=>{s()&&r.cancel&&r.cancel()})),r}_gotoImmediate(t,e){const i=this._gotoTask,s=this.animation,n=t.then((t=>{if(Ji(e),i!==this._gotoTask)throw new Ve("view:goto-interrupted","Goto was interrupted");this.viewpoint=s.target=t,s.finish()}));return this._cancellableGoTo(i,s,n)}_gotoAnimated(t,e){const i=this._gotoTask,s=this.animation,n=t.then((t=>{if(Ji(e),i!==this._gotoTask)throw new Ve("view:goto-interrupted","Goto was interrupted");return s.update(t),this.animationManager.animate(s,this.viewpoint,e),s.when().then((()=>{}),(()=>{}))}));return this._cancellableGoTo(i,s,n)}_resizeHandler(t){const e=this.state;if(!e)return;let i=this.state.paddedViewState.viewpoint;const s=this.state.paddedViewState.size.concat();e.size=[t.width,t.height],Bq(i,i,s,this.state.paddedViewState.size,this.resizeAlign),i=this.constraints.constrain(i,null),this.state.viewpoint=i}_startup(){const t=this._getDefaultViewpoint();this.constraints.view=this,this.constraints.fit(t),this._set("animationManager",new iB({view:this})),this._set("state",new xH({padding:this._get("padding"),size:this.size,viewpoint:t})),this._set("featuresTilingScheme",new zH(OG.create({spatialReference:this.spatialReference,size:512,numLODs:36}))),this._set("ready",!0),this.frameTask&&this.frameTask.start()}_teardown(){this.frameTask&&this.frameTask.stop(),this._set("ready",!1),this._stationaryTimer&&(clearTimeout(this._stationaryTimer),this._stationaryTimer=null);const{center:[t,e],spatialReference:i,rotation:s,scale:n}=this.state.paddedViewState,r=new Fp({x:t,y:e,spatialReference:i});this._set("viewpoint",null),this._set("extent",null),this._set("center",r),this._set("zoom",-1),this._set("rotation",s),this._set("scale",n),this._set("spatialReference",i),this.constraints.view=null,this.animationManager.destroy(),this._set("animationManager",null),this._set("state",null),this.animation=null}_flipStationary(t){return null!==this._stationaryTimer||(this._stationaryTimer=setTimeout((()=>{this._stationaryTimer=null;const t=performance.now()-this._lastStationaryEventTimestamp;t<160&&(this._stationaryTimer=this._flipStationary(t))}),t)),this._stationaryTimer}_normalizeInput(t,e=this.spatialReference){const i=t&&t.targetGeometry||t;return e?i?e.equals(i.spatialReference)?t:bp(i,e)?function(t){return t&&"esri.Viewpoint"===t.declaredClass}(t)?(t.targetGeometry=Mp(i,e),t):Mp(i,e):null:null:t}_getDefaultViewpoint(){const t=this.constraints,e={zoom:this._get("zoom"),scale:this._get("scale"),center:this._normalizeInput(this._get("center")),extent:this._normalizeInput(this._get("extent")),rotation:this._get("rotation"),viewpoint:this._normalizeInput(this._get("viewpoint")),spatialReference:this._userSpatialReference};t.effectiveLODs?-1!==e.zoom&&(e.scale=t.zoomToScale(e.zoom)):e.zoom=-1;let i=null,s=null,n=0;const r=e.viewpoint&&e.viewpoint.rotation,o=e.viewpoint&&e.viewpoint.targetGeometry;u(o)&&("extent"===o.type?i=o:"point"===o.type&&(s=o,n=e.viewpoint.scale));const a=this._normalizeInput(this.get("map.initialViewProperties.viewpoint.targetGeometry.extent")),l=this._normalizeInput(this.initialExtent),c=e.extent||i||a||l,h=e.center||s||c&&c.center,d=this.get("map.initialViewProperties.viewpoint.scale"),p=e.scale||n||d||c&&Oq(c,this.size),f=this.get("map.initialViewProperties.viewpoint.rotation");return h&&p?new DA({targetGeometry:h,scale:p,rotation:e.rotation||r||f||0}):null}};e([oe()],_J.prototype,"_stationaryTimer",void 0),e([oe()],_J.prototype,"animation",null),e([oe({readOnly:!0})],_J.prototype,"animationManager",void 0),e([oe({value:null,type:Fp,dependsOn:["state.id","ready"]})],_J.prototype,"center",null),e([oe({type:BW})],_J.prototype,"constraints",null),e([oe({value:null,type:of,dependsOn:["state.id","ready"]})],_J.prototype,"extent",null),e([oe({readOnly:!0})],_J.prototype,"featuresTilingScheme",void 0),e([oe()],_J.prototype,"fullOpacity",void 0),e([oe({readOnly:!0})],_J.prototype,"graphicsTileStore",null),e([oe()],_J.prototype,"graphicsView",void 0),e([oe({type:of})],_J.prototype,"initialExtent",void 0),e([oe({dependsOn:["map.initialViewProperties?.viewpoint"]})],_J.prototype,"initialExtentRequired",null),e([oe()],_J.prototype,"labelManager",void 0),e([oe({value:{top:0,right:0,bottom:0,left:0},cast:t=>({top:0,right:0,bottom:0,left:0,...t})})],_J.prototype,"padding",null),e([oe({type:Object})],_J.prototype,"renderingOptions",void 0),e([oe()],_J.prototype,"resizeAlign",void 0),e([oe({readOnly:!0,dependsOn:["state.id"]})],_J.prototype,"resolution",null),e([oe({value:0,type:Number,dependsOn:["state.id","ready"]})],_J.prototype,"rotation",null),e([oe({value:0,type:Number,dependsOn:["state.id","ready"]})],_J.prototype,"scale",null),e([oe({type:ap,dependsOn:["map.initialViewProperties?.spatialReference","defaultsFromMap.isSpatialReferenceDone"]})],_J.prototype,"spatialReference",void 0),e([oe({readOnly:!0})],_J.prototype,"state",void 0),e([oe({dependsOn:["animation","navigating","resizing","_stationaryTimer"]})],_J.prototype,"stationary",null),e([oe({readOnly:!0})],_J.prototype,"supportsGround",void 0),e([oe({type:IJ,readOnly:!0})],_J.prototype,"timeline",void 0),e([oe({readOnly:!0})],_J.prototype,"type",void 0),e([oe({readOnly:!0,dependsOn:["layerViewManager.updating","labelManager.updating","graphicsView?.updating"]})],_J.prototype,"updating",null),e([oe({value:null,type:DA,dependsOn:["state.id","ready"]})],_J.prototype,"viewpoint",null),e([oe({value:-1,dependsOn:["state.id"]})],_J.prototype,"zoom",null),_J=e([si("esri.views.MapViewBase")],_J);const TJ=_J;function OJ(t,e){switch(e){case"primary":return"touch"===t.pointerType||0===t.button;case"secondary":return"touch"!==t.pointerType&&2===t.button;case"tertiary":return"touch"!==t.pointerType&&1===t.button}}class AJ extends Uz{constructor(t,e){super(!0),this.view=t,this.registerIncoming("double-click",e,(t=>this._handleDoubleClick(t,e)))}_handleDoubleClick(t,e){OJ(t.data,"primary")&&(t.stopPropagation(),e?this.view.mapViewNavigation.zoomOut([t.data.x,t.data.y]):this.view.mapViewNavigation.zoomIn([t.data.x,t.data.y]))}}class FJ extends Uz{constructor(t,e,i){super(!0),this.view=t,this.pointerType=e,this.registerIncoming("double-tap-drag",i,(t=>this._handleDoubleTapDrag(t)))}_handleDoubleTapDrag(t){const{data:e}=t,{pointerType:i}=e;if(i!==this.pointerType)return;t.stopPropagation();const{action:s,delta:n}=e,{view:r}=this,{mapViewNavigation:o}=r;switch(s){case"begin":{const{scale:t}=r;this._startScale=t,this._currentScale=t,this._previousDelta=n,o.begin();break}case"update":{if(this._previousDelta.y===n.y)return;this._previousDelta=n;const t=this._startScale*1.015**n.y;o.setViewpointImmediate(t/this._currentScale),this._currentScale=t;break}case"end":{const{constraints:t}=r,{effectiveLODs:e,snapToZoom:i}=t;if(!i||!e)return void o.end();const s=t.snapScale(this._currentScale),a=(n.y>0?Math.max(s,t.snapToPreviousScale(this._startScale)):Math.min(s,t.snapToNextScale(this._startScale)))/this._currentScale;o.zoom(a);break}}}}class CJ{constructor(t){this.callbacks=t,this.currentCount=0,this.callbacks.condition||(this.callbacks.condition=()=>!0)}handle(t){const e=t.data,i=e.pointers.size;switch(e.action){case"start":this.currentCount=i,this.emitStart(t);break;case"added":this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"update":this.emitUpdate(t);break;case"removed":this.startEvent&&this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"end":this.emitEnd(t),this.currentCount=0}this.previousEvent=t}emitStart(t){this.startEvent=t,this.callbacks.condition(this.currentCount,t)&&this.callbacks.start(this.currentCount,t,this.startEvent)}emitUpdate(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.update(this.currentCount,t,this.startEvent)}emitEnd(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.end(this.currentCount,t,this.startEvent),this.startEvent=null}}class PJ extends Uz{constructor(t,e,i){super(!0),this.view=t,this.pointerAction=e,this.registerIncoming("drag",i,(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()));const s=this.view.mapViewNavigation;this.dragEventSeparator=new CJ({start:(t,e)=>{s.pan.begin(this.view,e.data),e.stopPropagation()},update:(t,e)=>{s.pan.update(this.view,e.data),e.stopPropagation()},end:(t,e)=>{s.pan.end(this.view,e.data),e.stopPropagation()},condition:(t,e)=>1===t&&OJ(e.data,this.pointerAction)})}_handleDrag(t){const e=this.view.mapViewNavigation;e.pinch.zoomMomentum||e.pinch.rotateMomentum?this.stopMomentumNavigation():this.dragEventSeparator.handle(t)}stopMomentumNavigation(){this.view.mapViewNavigation.pan.stopMomentumNavigation()}}class EJ extends Uz{constructor(t,e,i){super(!0),this.view=t,this.pointerAction=e;const s=this.view.mapViewNavigation;this.dragEventSeparator=new CJ({start:(t,e)=>{s.rotate.begin(this.view,e.data),e.stopPropagation()},update:(t,e)=>{s.rotate.update(this.view,e.data),e.stopPropagation()},end:(t,e)=>{s.rotate.end(),e.stopPropagation()},condition:(t,e)=>1===t&&OJ(e.data,this.pointerAction)}),this.registerIncoming("drag",i,(t=>this.dragEventSeparator.handle(t)))}}function RJ(t){let e=t*t;return t<0&&(e*=-1),e}class LJ extends Uz{constructor(t){super(!0),this.view=t,this.frameTask=null,this.watchHandles=new Wo,this.currentDevice=null,this.transformation={translation:[0,0,0],heading:0,tilt:0,zoom:0},this.handle=this.registerIncoming("gamepad",(t=>this.handleEvent(t))),this.handle.pause()}onInstall(t){super.onInstall(t),this.watchHandles.add([Xo(this.view.navigation.gamepad,"enabled",(t=>{t?(this.handle.resume(),this.frameTask||(this.frameTask=Qr({update:t=>this.frameUpdate(t.deltaTime)}))):(this.handle.pause(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null))}))])}onUninstall(){this.watchHandles.removeAll(),this.frameTask&&(this.frameTask.remove(),this.frameTask=null),super.onUninstall()}handleEvent(t){const e=this.view.navigation.gamepad.device;e&&t.data.device!==e||this.currentDevice&&this.currentDevice!==t.data.device||("end"===t.data.action?(this.currentDevice=null,function(t){t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0}(this.transformation)):(this.currentDevice=t.data.device,function(t,e,i){const s=i,n=t.state,r=t.device,o="forward-down"===e.tiltDirection?1:-1;"standard"===r.deviceType?(s.translation[0]=RJ(n.axes[0]),s.translation[1]=RJ(n.axes[1]),s.translation[2]=RJ(n.buttons[7])-RJ(n.buttons[6]),s.heading=RJ(n.axes[2]),s.tilt=RJ(n.axes[3])):"spacemouse"===r.deviceType&&(s.translation[0]=1.2*RJ(n.axes[0]),s.translation[1]=1.2*RJ(n.axes[1]),s.translation[2]=2*-RJ(n.axes[2]),s.heading=1.2*RJ(n.axes[5]),s.tilt=1.2*RJ(n.axes[3])),s.tilt*=o,kh(s.translation,s.translation,1)}(t.data,this.view.navigation.gamepad,this.transformation)))}frameUpdate(t){const e=this.transformation;if(function(t){return 0===t.translation[0]&&0===t.translation[1]&&0===t.translation[2]&&0===t.heading&&0===t.tilt&&0===t.zoom}(e))return;const i=this.view.viewpoint.clone(),s=DJ*this.view.navigation.gamepad.velocityFactor*t;Xq(i,i,[e.translation[0]*s,-e.translation[1]*s]);const n=this.view.size;Zq(i,i,1+e.translation[2]*VJ*t,this.view.constraints.rotationEnabled?-e.heading*NJ*t:0,[n[0]/2,n[1]],n);const r=this.view.constraints.constrain(i,this.view.viewpoint);this.view.viewpoint=r}}const NJ=.06,DJ=.7,VJ=6e-4;class $J extends Uz{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._pressed=!1,this._keyMap={[e.left]:"left",[e.right]:"right",[e.up]:"up",[e.down]:"down"},this.registerIncoming("key-down",i,(t=>this._handleKeyDown(t))),this.registerIncoming("key-up",i,(t=>this._handleKeyUp(t))),this.registerIncoming("blur",i,(()=>this._handleBlur()))}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,e){const i=this._keyMap[t.data.key];if(this._pressed=null!=i,this._pressed){if(e)switch(this.view.mapViewNavigation.begin(),i){case"left":this.view.mapViewNavigation.continousPanLeft();break;case"right":this.view.mapViewNavigation.continousPanRight();break;case"up":this.view.mapViewNavigation.continousPanUp();break;case"down":this.view.mapViewNavigation.continousPanDown()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}}class zJ extends Uz{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._pressed=!1,this._keyToDirection={[e.clockwiseOption1]:"clockwise",[e.clockwiseOption2]:"clockwise",[e.counterClockwiseOption1]:"counterClockwise",[e.counterClockwiseOption2]:"counterClockwise",[e.resetOption1]:"reset",[e.resetOption2]:"reset"},this.registerIncoming("key-down",i,(t=>this._handleKeyDown(t))),this.registerIncoming("key-up",i,(t=>this._handleKeyUp(t))),this.registerIncoming("blur",i,(()=>this._handleBlur()))}_handleKeyDown(t){t.data.repeat||this._handleKey(t,!0)}_handleKeyUp(t){this._handleKey(t,!1)}_handleBlur(){this._pressed&&(this._pressed=!1,this.view.mapViewNavigation.stop())}_handleKey(t,e){const i=t.modifiers;if(i.size>0&&!i.has("Shift")||!this.view.constraints.rotationEnabled)return;const s=this._keyToDirection[t.data.key];if(this._pressed=null!=s,this._pressed){if(e)switch(this.view.mapViewNavigation.begin(),s){case"clockwise":this.view.mapViewNavigation.continousRotateClockwise();break;case"counterClockwise":this.view.mapViewNavigation.continousRotateCounterclockwise();break;case"reset":this.view.mapViewNavigation.resetRotation()}else this._pressed=!1,this.view.mapViewNavigation.stop();t.stopPropagation()}}}class GJ extends Uz{constructor(t,e,i){super(!0),this.view=t,this.keys=e,this._keysToZoomAction={},this.registerIncoming("key-down",i,(t=>this._handleKeyDown(t))),e.zoomIn.forEach((t=>this._keysToZoomAction[t]=0)),e.zoomOut.forEach((t=>this._keysToZoomAction[t]=1))}_handleKeyDown(t){this._handleKey(t)}_handleKey(t){const e=t.modifiers;if(e.size>0&&!e.has("Shift"))return;const{key:i}=t.data;if(!(i in this._keysToZoomAction))return;const s=this._keysToZoomAction[i],{mapViewNavigation:n}=this.view;let r=null;switch(s){case 0:r=n.zoomIn();break;case 1:r=n.zoomOut();break;default:return}n.begin(),r.then((()=>n.end())),t.stopPropagation()}}class UJ extends Uz{constructor(t,e){super(!0),this.view=t,this._canZoom=!0,this.registerIncoming("mouse-wheel",e,(t=>this._handleMouseWheel(t)))}_handleMouseWheel(t){if(!this.view.navigation.mouseWheelZoomEnabled)return;if(t.preventDefault(),t.stopPropagation(),!this._canZoom)return;const e=this.view.mapViewNavigation,{x:i,y:s,deltaY:n}=t.data,r=e.zoom(1/.6**(1/60*n),[i,s]);r&&(this._canZoom=!1,r.catch((()=>{})).then((()=>{this._canZoom=!0,e.end()})))}}class qJ extends Uz{constructor(t){super(!0),this.view=t,this.registerIncoming("drag",(t=>this._handleDrag(t))),this.registerIncoming("pointer-down",(()=>this.stopMomentumNavigation()));const e=this.view.mapViewNavigation;this.dragEventSeparator=new CJ({start:(t,i)=>{e.pinch.begin(this.view,i.data),i.stopPropagation()},update:(t,i)=>{e.pinch.update(this.view,i.data),i.stopPropagation()},end:(t,i)=>{e.pinch.end(this.view),i.stopPropagation()},condition:t=>t>=2})}_handleDrag(t){this.dragEventSeparator.handle(t)}stopMomentumNavigation(){this.view.mapViewNavigation.pinch.stopMomentumNavigation()}}function BJ(t){const e=t.native;return e?{buttons:e.buttons.map((t=>t.pressed?t.value?t.value:1:0)),axes:e.axes.map((e=>function(t,e){const i=Math.abs(t);return i<e?0:Math.sign(t)*(i-e)/(1-e)}(e,t.axisThreshold)))}:{buttons:[],axes:[]}}class WJ{constructor(t,e){this.element=t,this.input=e,this._hasEventListeners=!1,this.onConnectGamepad=t=>{this.connectGamepad(t.gamepad)},this.onDisconnectGamepad=t=>{const e=t.gamepad,i=e.index,s=this.inputDevices[i];s&&(this.emitGamepadEvent(e,BJ(s),!1),this.inputDevices.splice(i,1),this.latestUpdate.splice(i,1),this.input.gamepad.devices.remove(s),this.ensurePollingState())},this.frameTask=null,this.latestUpdate=[],this.inputDevices=[],this.callback=null;const i="getGamepads"in window.navigator,s=window.isSecureContext;this.supported=i&&s,this.supported&&(this.forEachGamepad((t=>this.connectGamepad(t))),window.addEventListener("gamepadconnected",this.onConnectGamepad),window.addEventListener("gamepaddisconnected",this.onDisconnectGamepad),this.ensurePollingState())}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this.onConnectGamepad),window.removeEventListener("gamepaddisconnected",this.onDisconnectGamepad))}set hasEventListeners(t){this._hasEventListeners!==t&&(this._hasEventListeners=t,this.ensurePollingState())}get eventsEnabled(){return this.supported&&this.inputDevices.length>0&&this._hasEventListeners}set onEvent(t){this.callback=t}connectGamepad(t){const e=new kU(t);"unknown"!==e.deviceType&&(this.inputDevices[t.index]=e,this.input.gamepad.devices.add(e)),this.ensurePollingState()}ensurePollingState(){this.eventsEnabled?this.startPolling():this.stopPolling()}startPolling(){null==this.frameTask&&(this.frameTask=Qr({update:()=>this.readGamepadState()}))}stopPolling(){null!=this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=[])}readGamepadState(){const t=document.hasFocus(),e=this.element.contains(document.activeElement),i="document"===this.input.gamepad.enabledFocusMode&&!t||"view"===this.input.gamepad.enabledFocusMode&&!e;this.forEachGamepad((t=>{const e=this.inputDevices[t.index];if(!e)return;const s=this.latestUpdate[t.index],n=BJ(e),r=i||function(t){for(let e=0;e<t.axes.length;e++)if(0!==t.axes[e])return!1;for(let e=0;e<t.buttons.length;e++)if(0!==t.buttons[e])return!1;return!0}(n);if(s){if(s.timestamp===t.timestamp)return;if(!s.active&&r)return;if(function(t,e){if(t.axes.length!==e.axes.length)return!1;if(t.buttons.length!==e.buttons.length)return!1;for(let i=0;i<t.axes.length;i++)if(t.axes[i]!==e.axes[i])return!1;for(let i=0;i<t.buttons.length;i++)if(t.buttons[i]!==e.buttons[i])return!1;return!0}(s.state,n))return}this.emitGamepadEvent(t,n,!r)}))}forEachGamepad(t){const e=window.navigator.getGamepads();for(let i=0;i<e.length;i++){const s=e[i];this.validate(s)&&t(s)}}emitGamepadEvent(t,e,i){const s=this.latestUpdate[t.index],n=s&&s.active;if(!n&&!i)return;const r=!n&&i?"start":n&&i?"update":"end";this.latestUpdate[t.index]={timestamp:t.timestamp,state:e,active:i},this.callback&&this.callback({device:this.inputDevices[t.index],state:e,action:r})}validate(t){if(!t)return!1;if(!t.connected)return!1;for(let e=0;e<t.axes.length;e++)if(isNaN(t.axes[e]))return!1;return!0}}const HJ=l("trident"),JJ=l("edge"),ZJ=l("chrome"),QJ=l("ff"),KJ=l("safari"),YJ="esri-view-surface--touch-none",XJ="esri-view-surface--touch-pan";class tZ{constructor(t,e){this.input=e,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=t,t.getAttribute("tabindex")||t.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new WJ(t,this.input),this._gamepadSource.onEvent=t=>this._callback("gamepad",t)}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach((t=>{this._releasePointerCaptureSafe(t)})),this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=null),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault)}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(t){this._browserTouchPanningEnabled=t,this._updateTouchAction(),this._updateTouchEventHandling()}set onEventReceived(t){this._callback=t}set activeEvents(t){for(const e in this._active)t&&t.has(e)||(this._element.removeEventListener(eZ[e],this._active[e]),delete this._active[e]);t&&t.forEach((t=>{if(!this._active[t]&&eZ[t]){const e=(this._eventHandlers[t]||this._handleDefault).bind(this,t);this._element.addEventListener(eZ[t],e),this._active[t]=e}})),this._gamepadSource.hasEventListeners=t&&t.has("gamepad")}setPointerCapture(t,e){e?(this._element.setPointerCapture(t.pointerId),this._activePointerCaptures.add(t.pointerId)):(this._releasePointerCaptureSafe(t.pointerId),this._activePointerCaptures.delete(t.pointerId))}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?YJ:XJ),this._element.classList.add(this._browserTouchPanningEnabled?XJ:YJ)}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_removeTouchAction(){this._element.classList.remove(YJ),this._element.classList.remove(XJ),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning)}_releasePointerCaptureSafe(t){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(t))return;this._element.releasePointerCapture(t)}catch(t){}}_updateNormalizedPointerLikeEvent(t,e){const i=cU(this._element,t);return tZ.test.disableSubpixelCoordinates&&(i.x=Math.round(i.x),i.y=Math.round(i.y)),e.x=i.x,e.y=i.y,e}_handleKey(t,e){const i=function(t){if(void 0!==t.key)return qi(t);const e=Vz[t.keyCode];return Array.isArray(e)?t.shiftKey?e[1]:e[0]:e}(e);i&&"key-up"===t&&this._keyDownState.delete(i);const s={native:e,key:i,repeat:i&&this._keyDownState.has(i)};i&&"key-down"===t&&this._keyDownState.add(s.key),this._callback(t,s)}_handlePointer(t,e){const i=this._updateNormalizedPointerLikeEvent(e,{native:e,x:0,y:0,pointerType:e.pointerType,button:e.button,buttons:e.buttons,eventId:this._eventId++});this._callback(t,i)}_handlePointerPreventDefault(t,e){const i=this._updateNormalizedPointerLikeEvent(e,{native:e,x:0,y:0,pointerType:e.pointerType,button:e.button,buttons:e.buttons,eventId:this._eventId++});e.preventDefault(),this._callback(t,i)}_handleMouseWheel(t,e){let i=e.deltaY;switch(e.deltaMode){case 0:(HJ||JJ)&&(i=i/document.documentElement.clientHeight*600);break;case 1:i*=30;break;case 2:i*=900}HJ||JJ?i*=.7:ZJ||KJ?i*=.6:QJ&&(i*=1.375);const s=Math.abs(i);s>100&&(i=i/s*200/(1+Math.exp(-.02*(s-100))));const n=this._updateNormalizedPointerLikeEvent(e,{native:e,x:0,y:0,deltaY:i});this._callback(t,n)}_handlePointerCaptureLost(t,e){this._activePointerCaptures.delete(e.pointerId),this._handleDefault(t,e)}_handleDefault(t,e){const i={native:e};e.preventDefault(),this._callback(t,i)}_preventAltKeyDefault(t){"Alt"===t.key&&t.preventDefault()}_preventMultiTouchPanning(t){t.touches.length>1&&t.preventDefault()}}tZ.test={disableSubpixelCoordinates:!1};const eZ={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};class iZ extends Uz{constructor(){super(!0),this.registerIncoming("context-menu",(t=>{t.data.native.preventDefault()}))}}function sZ(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}class nZ extends Uz{constructor(t=250,e=10,i=350,s=35,n=Vi){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=e,this.maximumDoubleTouchDelay=i,this.maximumDoubleTouchDistance=s,this._clock=n,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("drag",this._handleDrag.bind(this))}onUninstall(){this._pointerState.forEach((t=>{null!=t.doubleClickTimeout&&(t.doubleClickTimeout.remove(),t.doubleClickTimeout=null)}))}get hasPendingInputs(){return ht(this._pointerState,(t=>null!=t.doubleClickTimeout))}_pointerId(t){const e=t.native;return"mouse"===e.pointerType?`${e.pointerId}:${e.button}`:""+e.pointerType}_handleImmediateClick(t){const e=t.data,i=this._pointerId(e),s=this._pointerState.get(i);if(s){const n="touch"===e.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;sZ(s.event.data,e)>n?(this._clearDoubleClickTimeout(i,!0),this._startClick(t)):(this._clearDoubleClickTimeout(i,!1),this._doubleClick.emit(s.event.data,void 0,s.event.modifiers))}else this._startClick(t)}_startClick(t){const e=this._pointerId(t.data);this._pointerState.set(e,{event:t,doubleClickTimeout:this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(e)),"touch"===t.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay)}),this.refreshHasPendingInputs()}_handlePointerDrag(t){const e=this._pointerId(t.data.currentEvent);this._clearDoubleClickTimeout(e,!0)}_handleDrag(t){const e=this._pointerId(t.data.pointer);this._clearDoubleClickTimeout(e,!0)}_clearDoubleClickTimeout(t,e){const i=this._pointerState.get(t);i&&(i.doubleClickTimeout.remove(),i.doubleClickTimeout=null,e&&this._doubleClickTimeoutExceeded(t),this._pointerState.delete(t),this.refreshHasPendingInputs())}_doubleClickTimeoutExceeded(t){const e=this._pointerState.get(t);this._click.emit(e.event.data,void 0,e.event.modifiers),e.doubleClickTimeout=null,this._pointerState.delete(t),this.refreshHasPendingInputs()}}class rZ extends Uz{constructor(t=250,e=10,i=350,s=35,n=Vi){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=e,this.maximumDoubleTouchDelay=i,this.maximumDoubleTouchDistance=s,this._clock=n,this._doubleTapDragReady=!1,this._doubleTapDragActive=!1,this._dragStartCenter=pm(0,0),this._pointerState=new Map,this._doubleTapDrag=this.registerOutgoing("double-tap-drag"),this._dragEventSeparator=new CJ({start:(t,e)=>this._dragStart(t,e),update:(t,e)=>this._dragUpdate(e),end:(t,e)=>this._dragEnd(e)}),this.registerIncoming("drag",(t=>this._dragEventSeparator.handle(t))),this.registerIncoming("pointer-down",(t=>this._handlePointerDown(t))),this.registerIncoming("pointer-up",(()=>this._handlePointerUp()))}onUninstall(){this._pointerState.forEach((t=>{null!=t.doubleTapTimeout&&(t.doubleTapTimeout.remove(),t.doubleTapTimeout=null)}))}get hasPendingInputs(){return ht(this._pointerState,(t=>null!=t.doubleTapTimeout))}_clearPointerDown(t){const e=this._pointerState.get(t);e&&(e.doubleTapTimeout.remove(),e.doubleTapTimeout=null,this._pointerState.delete(t),this.refreshHasPendingInputs())}_createDoubleTapDragData(t,e,i){const{button:s,buttons:n,pointer:r,pointers:o,pointerType:a,timestamp:l}=i;return{action:t,delta:e,button:s,buttons:n,pointer:r,pointers:o,pointerType:a,timestamp:l}}_dragStart(t,e){if(!this._doubleTapDragReady||1!==t)return;this._doubleTapDragReady=!1,this._doubleTapDragActive=!0;const{data:i,modifiers:s}=e,{center:n}=i;this._dragStartCenter=n;const r=this._createDoubleTapDragData("begin",pm(0,0),i);this._doubleTapDrag.emit(r,void 0,s),e.stopPropagation()}_dragUpdate(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:i}=t,{center:s}=e,n=pm(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r=this._createDoubleTapDragData("update",n,e);this._doubleTapDrag.emit(r,void 0,i),t.stopPropagation()}_dragEnd(t){if(!this._doubleTapDragActive)return;const{data:e,modifiers:i}=t,{center:s}=e,n=pm(s.x-this._dragStartCenter.x,s.y-this._dragStartCenter.y),r=this._createDoubleTapDragData("end",n,e);this._doubleTapDrag.emit(r,void 0,i),this._doubleTapDragActive=!1,t.stopPropagation()}_handlePointerDown(t){const{data:e}=t,i=this._pointerId(e),s=this._pointerState.get(i),{pointerType:n}=e.native;if(s){const r="touch"===n?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;this._clearPointerDown(i),sZ(s.event.data,e)>r?this._storePointerDown(t):this._doubleTapDragReady=!0}else this._storePointerDown(t)}_handlePointerUp(){this._doubleTapDragReady=!1}_pointerId(t){const{native:e}=t,{pointerId:i,button:s,pointerType:n}=e;return"mouse"===n?`${i}:${s}`:""+n}_storePointerDown(t){const{data:e}=t,{pointerType:i}=e.native,s=this._pointerId(e),n=this._clock.setTimeout((()=>this._clearPointerDown(s)),"touch"===i?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay);this._pointerState.set(s,{event:t,doubleTapTimeout:n}),this.refreshHasPendingInputs()}}class oZ extends Uz{constructor(t){super(!1),this.navigationTouch=t,this.startStateModifiers=new Set,this.activePointerMap=new Map,this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this.handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this.handlePointerUpAndPointerLost.bind(this))}createPayload(t,e,i,s){return{action:t,pointerType:this.pointerType,button:this.mouseButton,buttons:e.buttons,timestamp:s,pointers:uZ(this.activePointerMap),pointer:e,angle:i.angle,radius:i.radius,center:i.center}}addPointer(t){const e=t.native.pointerId,i=lZ(this.activePointerMap).angle,s={event:t,initialAngle:0,lastAngle:0};this.activePointerMap.set(e,s);const n=cZ(s,aZ(this.activePointerMap));s.initialAngle=n,s.lastAngle=n,this.updatePointerAngles(i)}updatePointer(t){if(t&&null==t.x&&null==t.y)return;const e=this.activePointerMap.get(t.native.pointerId);e?e.event=t:this.addPointer(t)}removePointer(t){const e=lZ(this.activePointerMap).angle;this.activePointerMap.delete(t),this.updatePointerAngles(e)}updatePointerAngles(t){const e=lZ(this.activePointerMap);this.activePointerMap.forEach((i=>{i.initialAngle=cZ(i,e)-t,i.lastAngle=cZ(i,e)-t}))}emitEvent(t,e,i){const s=lZ(this.activePointerMap);this.drag.emit(this.createPayload(t,e,s,i),void 0,this.startStateModifiers)}handlePointerUpAndPointerLost(t){const e=t.data.native.pointerId,i=t.timestamp;this.activePointerMap.get(e)&&(1===this.activePointerMap.size?(this.updatePointer(t.data),!this.isCurrentDragSuppressed&&this.emitEvent("end",t.data,i),this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.removePointer(e)):(this.removePointer(e),this.emitEvent("removed",t.data,t.timestamp)))}handlePointerDrag(t){const e=t.data,i=e.currentEvent,s=t.timestamp;switch(e.action){case"start":case"update":this.isDragging?this.activePointerMap.has(i.native.pointerId)?(this.updatePointer(i),!this.isCurrentDragSuppressed&&this.emitEvent("update",i,s)):(this.addPointer(i),this.emitEvent("added",i,s),this.isCurrentDragSuppressed=this.isSuppressed):(this.updatePointer(i),this.pointerType=t.data.startEvent.pointerType,this.mouseButton=t.data.startEvent.button,this.startStateModifiers=t.modifiers,this.isDragging=!0,this.isCurrentDragSuppressed=this.isSuppressed,!this.isCurrentDragSuppressed&&this.emitEvent("start",i,s))}}get isSuppressed(){return this.navigationTouch&&!this.navigationTouch.browserTouchPanEnabled&&"touch"===this.pointerType&&1===this.activePointerMap.size}}function aZ(t){const e=[];return t.forEach((t=>{e.push(pm(t.event.x,t.event.y))})),function(t,e){if(e?(e.radius=0,e.center.x=0,e.center.y=0):e={radius:0,center:pm()},0===t.length)return e;if(1===t.length)return e.center.x=t[0].x,e.center.y=t[0].y,e;if(2===t.length){const[i,s]=t,[n,r]=[s.x-i.x,s.y-i.y];return e.radius=Math.sqrt(n*n+r*r)/2,e.center.x=(i.x+s.x)/2,e.center.y=(i.y+s.y)/2,e}let i=0,s=0;for(let e=0;e<t.length;e++)i+=t[e].x,s+=t[e].y;i/=t.length,s/=t.length;const n=t.map((t=>t.x-i)),r=t.map((t=>t.y-s));let o=0,a=0,l=0,u=0,c=0,h=0,d=0;for(let t=0;t<n.length;t++){const e=n[t],i=r[t],s=e*e,p=i*i;o+=s,a+=p,l+=e*i,u+=s*e,c+=p*i,h+=e*p,d+=i*s}const p=.5*(u+h),f=.5*(c+d),y=o*a-l*l,m=(p*a-f*l)/y,g=(o*f-l*p)/y,v=pm(m+i,g+s);return{radius:Math.sqrt(m*m+g*g+(o+a)/t.length),center:v}}(e)}function lZ(t){const e=aZ(t);let i=0;return t.forEach((t=>{let s=cZ(t,e),n=s-t.lastAngle;for(;n>Math.PI;)n-=2*Math.PI;for(;n<-Math.PI;)n+=2*Math.PI;s=t.lastAngle+n,t.lastAngle=s,i+=s-t.initialAngle})),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function uZ(t){const e=new Map;return t.forEach(((t,i)=>e.set(i,t.event))),e}function cZ(t,e){const i=t.event;return Math.atan2(i.y-e.center.y,i.x-e.center.x)}var hZ;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined"}(hZ||(hZ={}));class dZ extends Uz{constructor(t=250,e=10,i=350,s=35,n=Vi){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=e,this.maximumDoubleTouchDelay=i,this.maximumDoubleTouchDistance=s,this._clock=n,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up")})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost")})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel")}))}onUninstall(){this._pointerState.forEach((t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove()})),super.onUninstall()}_handlePointerDown(t){const e=t.data,i=this._pointerId(e);this._pointerState.has(i)||(this._pointerState.set(i,{downButton:e.native.button,immediateDoubleClick:null}),this.startCapturingPointer(e.native))}_handlePointerLoss(t,e){const i=t.data,s=this._pointerId(i),n=this._pointerState.get(s);if(n&&"pointer-up"===e&&n.downButton===i.native.button){const e=n.immediateDoubleClick;if(e){e.timeoutHandle.remove();const s="touch"===t.data.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;sZ(e,t.data)>s?this._startImmediateDoubleClick(t,n):(this._immediateDoubleClick.emit(t.data,void 0,e.modifiers),this._removeState(i))}else this._startImmediateDoubleClick(t,n)}}_startImmediateDoubleClick(t,e){e.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(t.data)),"touch"===t.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay)}}_pointerId(t){const e=t.native;return"mouse"===e.pointerType?`${e.pointerId}:${e.button}`:""+e.pointerType}_removeState(t){const e=this._pointerId(t);this._pointerState.delete(e),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs()}}class pZ extends Uz{constructor(t=300,e=1.5,i=6,s=6,n=500,r=Vi){super(!1),this.maximumClickDelay=t,this.movementUntilMouseDrag=e,this.movementUntilPenDrag=i,this.movementUntilTouchDrag=s,this.holdDelay=n,this._clock=r,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up")})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost")})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel")})),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause()}onUninstall(){this._pointerState.forEach((t=>{null!=t.holdTimeout&&(t.holdTimeout.remove(),t.holdTimeout=null)})),super.onUninstall()}_handlePointerDown(t){const e=t.data,i=e.native.pointerId;let s=null;0===this._pointerState.size&&(s=this._clock.setTimeout((()=>{const e=this._pointerState.get(i);e&&(e.isDragging||(this._pointerHold.emit(e.previousEvent,void 0,t.modifiers),e.holdEmitted=!0),e.holdTimeout=null)}),this.holdDelay));const n={startEvent:e,previousEvent:e,startTimestamp:t.timestamp,isDragging:!1,downButton:e.native.button,holdTimeout:s,modifiers:new Set};this._pointerState.set(i,n),this.startCapturingPointer(e.native),this._moveHandle.resume(),this._pointerState.size>1&&this.startDragging(t)}_createPointerDragData(t,e,i){return{action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}_handlePointerMove(t){const e=t.data,i=this._pointerState.get(e.native.pointerId);i&&(i.isDragging?this._pointerDrag.emit(this._createPointerDragData("update",i,e),void 0,i.modifiers):function(t,e){const i=e.x-t.x,s=e.y-t.y;return Math.sqrt(i*i+s*s)}(e,i.startEvent)>this._getDragThreshold(e.native.pointerType)&&this.startDragging(t),i.previousEvent=e)}_getDragThreshold(t){switch(t){case"touch":return this.movementUntilTouchDrag;case"pen":return this.movementUntilPenDrag;default:return this.movementUntilMouseDrag}}startDragging(t){const e=t.data,i=e.native.pointerId;this._pointerState.forEach((s=>{null!=s.holdTimeout&&(s.holdTimeout.remove(),s.holdTimeout=null),s.isDragging||(s.modifiers=t.modifiers,s.isDragging=!0,i===s.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",s,e)):this._pointerDrag.emit(this._createPointerDragData("start",s,s.previousEvent),t.timestamp))}))}_handlePointerLoss(t,e){const i=t.data,s=i.native.pointerId,n=this._pointerState.get(s);n&&(null!=n.holdTimeout&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging?this._pointerDrag.emit(this._createPointerDragData("end",n,"pointer-up"===e?i:n.previousEvent),void 0,n.modifiers):"pointer-up"===e&&n.downButton===i.native.button&&t.timestamp-n.startTimestamp<=this.maximumClickDelay&&!n.holdEmitted&&this._immediateClick.emit(i),this._pointerState.delete(s),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause())}}const fZ={left:"ArrowLeft",right:"ArrowRight",up:"ArrowUp",down:"ArrowDown"},yZ={zoomIn:["=","+"],zoomOut:["-","_"]},mZ={clockwiseOption1:"a",clockwiseOption2:"A",counterClockwiseOption1:"d",counterClockwiseOption2:"D",resetOption1:"n",resetOption2:"N"};let gZ=class extends jo{constructor(){super(...arguments),this._handles=new Wo}initialize(){this._handles.add([sa(this.view,"ready",(()=>this._disconnect())),ea(this.view,"ready",(()=>this._connect()))])}destroy(){this._handles&&(this._handles.removeAll(),this._handles=null),this._disconnect()}_disconnect(){this._inputManager&&(this.view.viewEvents.disconnect(),this._inputManager.destroy(),this._inputManager=null,this._source.destroy(),this._source=null)}_connect(){const t=new tZ(this.view.surface,this.view.input),e=[new dZ,new pZ,new nZ,new oZ(this.view.navigation),new rZ],i=new Jz({eventSource:t,recognizers:e});i.installHandlers("prevent-context-menu",[new iZ],Qz.INTERNAL),i.installHandlers("navigation",[new qJ(this.view),new LJ(this.view),new UJ(this.view),new AJ(this.view),new AJ(this.view,["Ctrl"]),new PJ(this.view,"primary"),new $J(this.view,fZ),new GJ(this.view,yZ),new zJ(this.view,mZ),new EJ(this.view,"secondary"),new FJ(this.view,"touch")],Qz.INTERNAL),this.view.viewEvents.connect(i),this._source=t,this._inputManager=i,Xo(this.view.navigation,"browserTouchPanEnabled",(t=>{this._source.browserTouchPanningEnabled=!t}))}get test(){return{inputManager:this._inputManager}}};e([oe()],gZ.prototype,"view",void 0),gZ=e([si("esri.views.2d.input.MapViewInputManager")],gZ);const vZ=gZ;let wZ=0,bZ=class extends jo{constructor(){super(...arguments),this.color=new bd([0,255,255]),this.haloOpacity=1,this.fillOpacity=.25}get version(){return wZ++}};e([oe({readOnly:!0})],bZ.prototype,"version",null),e([oe({type:bd})],bZ.prototype,"color",void 0),e([oe({type:bd})],bZ.prototype,"haloColor",void 0),e([oe()],bZ.prototype,"haloOpacity",void 0),e([oe()],bZ.prototype,"fillOpacity",void 0),bZ=e([si("esri.views.2d.support.HighlightOptions")],bZ);const MZ=bZ;function SZ(t,e,i,s){s.premultipliedAlpha&&function(t){const e=t.data,i=e.length;for(let t=0;t<i;t+=4){const i=e[t+3];if(i>0){const s=i/255;e[t+0]=e[t+0]/s,e[t+1]=e[t+1]/s,e[t+2]=e[t+2]/s}}}(t),i.width=t.width,i.height=t.height;const n=i.getContext("2d");n.putImageData(t,0,0),s.flipY&&function(t){t.save(),t.globalCompositeOperation="copy",t.scale(1,-1),t.translate(0,-t.canvas.height),t.drawImage(t.canvas,0,0),t.restore()}(n);const r=n.getImageData(0,0,t.width,t.height),o=function(t,e){return t.toDataURL(OZ[e.format],e.quality/100)}(i,e);return i.width=0,i.height=0,{dataUrl:o,data:r}}function xZ(t,e,i){if(!t||!e)throw Error("Cannot construct image data without dimensions");if(TZ)try{return new ImageData(t,e)}catch(t){TZ=!1}return jZ(t,e,i)}function kZ(t,e,i,s){if(!e||!i)throw Error("Cannot construct image data without dimensions");if(TZ)try{return new ImageData(t,e,i)}catch(t){TZ=!1}const n=jZ(e,i,s);return n.data.set(t,0),n}function IZ(t,e,i,s=0,n=0,r=t.width-s,o=t.height-n,a=!1){const{data:l}=t,{width:u,height:c,data:h}=e,d=r/u,p=o/c,f=Math.ceil(d/2),y=Math.ceil(p/2),m=t.width;for(let t=0;t<c;t++)for(let e=0;e<u;e++){const r=4*(e+(a?c-t-1:t)*u);let o=0,g=0,v=0,w=0,b=0,M=0;const S=(t+.5)*p;for(let r=Math.floor(t*p);r<(t+1)*p;r++){const t=Math.abs(S-(r+.5))/y,a=(e+.5)*d,u=t*t;for(let t=Math.floor(e*d);t<(e+1)*d;t++){const e=Math.abs(a-(t+.5))/f,c=Math.sqrt(u+e*e);if(c>=1)continue;let h=2*c*c*c-3*c*c+1;const d=4*(s+t+(n+r)*m);M+=h*l[d+3],g+=h,!i&&l[d+3]<255&&(h=h*l[d+3]/255),v+=h*l[d],w+=h*l[d+1],b+=h*l[d+2],o+=h}}h[r]=v/o,h[r+1]=w/o,h[r+2]=b/o,h[r+3]=M/g}return e}function jZ(t,e,i){return i||(_Z||(_Z=document.createElement("canvas"),_Z.width=1,_Z.height=1),i=_Z),i.getContext("2d").createImageData(t,e)}let _Z=null,TZ=!0;const OZ={png:"image/png",jpg:"image/jpeg",jpeg:"image/jpeg"},AZ="png",FZ={png:100,jpg:98,jpeg:98};function CZ(t,e,i={}){if(!window.WebGLRenderingContext)return EZ(t,RZ),null;const s=PZ(t,e,i);return c(s)&&EZ(t,LZ),s}function PZ(t,e,i={}){const s=1===e?["webgl","experimental-webgl","webkit-3d","moz-webgl"]:["webgl2"];let n=null;for(const e of s){try{n=t.getContext(e,i)}catch(t){}if(n)break}return n}function EZ(t,e){const i=t.parentNode;i&&(i.innerHTML='<table style="background-color: #8CE; width: 100%; height: 100%;"><tr><td align="center"><div style="display: table-cell; vertical-align: middle;"><div style="">'+e+"</div></div></td></tr></table>")}const RZ='This page requires a browser that supports WebGL.<br/><a href="http://get.webgl.org">Click here to upgrade your browser.</a>',LZ='It doesn\'t appear your computer can support WebGL.<br/><a href="http://get.webgl.org/troubleshooting/">Click here for more information.</a>';let NZ;function DZ(){return NZ||(NZ=function(){const t={available:!1,version:0,majorPerformanceCaveat:!1,maxTextureSize:0,supportsHighPrecisionFragment:!1,supportsVertexShaderSamplers:!1,supportsElementIndexUint:!1,supportsStandardDerivatives:!1,supportsInstancedArrays:!1,supportsTextureFloat:!1,supportsColorBufferFloat:!1};if(void 0===typeof WebGLRenderingContext)return t;const e=document.createElement("canvas");if(!e)return t;let i=PZ(e,1,{failIfMajorPerformanceCaveat:!0});if(c(i)&&(i=PZ(e,1),u(i)&&(t.majorPerformanceCaveat=!0)),c(i))return t;const s=i.getParameter(i.VERSION);if(!s)return t;const n=s.match(/^WebGL\s+([\d.]*)/);if(n){t.available=parseFloat(n[1])>=.94;const e=i.getShaderPrecisionFormat(i.FRAGMENT_SHADER,i.HIGH_FLOAT);e&&(t.supportsHighPrecisionFragment=e.precision>0),t.supportsVertexShaderSamplers=i.getParameter(i.MAX_VERTEX_TEXTURE_IMAGE_UNITS)>0,t.supportsElementIndexUint=null!==i.getExtension("OES_element_index_uint"),t.supportsStandardDerivatives=null!==i.getExtension("OES_standard_derivatives"),t.supportsInstancedArrays=null!==i.getExtension("ANGLE_instanced_arrays"),t.supportsTextureFloat=null!==i.getExtension("OES_texture_float"),t.supportsColorBufferFloat=null!==i.getExtension("WEBGL_color_buffer_float")&&null!==i.getExtension("EXT_float_blend")}return t.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),t.version=function(){if(void 0===typeof WebGL2RenderingContext)return!1;const t=document.createElement("canvas");return!!t&&!!u(PZ(t,2))}()?2:1,t}()),NZ}const VZ={checkMajorWebPerformanceCaveat:!0};let $Z=class extends jo{constructor(){super(...arguments),this.widget=null}destroy(){this.widget&&this.widget.destroy(),this.node=null}get id(){return this.get("widget.id")||this.get("node.id")}set node(t){const e=this._get("node");t!==e&&(t&&t.classList.add("esri-component"),e&&e.classList.remove("esri-component"),this._set("node",t))}castNode(t){return t?"string"==typeof t||function(t){return t&&"nodeType"in t}(t)?(this._set("widget",null),pr(t)):(function(t){return t&&"function"==typeof t.render}(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};e([oe({dependsOn:[]})],$Z.prototype,"id",null),e([oe()],$Z.prototype,"node",null),e([ba("node")],$Z.prototype,"castNode",null),e([oe({readOnly:!0})],$Z.prototype,"widget",void 0),$Z=e([si("esri.views.ui.Component")],$Z);const zZ=$Z,GZ={left:0,top:0,bottom:0,right:0},UZ={bottom:30,top:15,right:15,left:15},qZ="manual",BZ="esri-ui-corner";function WZ(t){const e=t,i="object"==typeof e&&null!==e&&Object.getPrototypeOf(e);return null!==i&&i!==Object.prototype||!("component"in e||"index"in e||"position"in e)?null:t}function HZ(t,{top:e,bottom:i,left:s,right:n}){t.style.top=e,t.style.bottom=i,t.style.left=s,t.style.right=n}let JZ=class extends To.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=[],this._componentToKey=new Map,this._handles=new Wo,this.view=null,this._initContainers()}initialize(){this._handles.add([Xo(this,"view.padding, container",this._applyViewPadding.bind(this)),Xo(this,"padding",this._applyUIPadding.bind(this))])}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear()}set container(t){const e=this._get("container");t!==e&&(t&&(t.classList.add("esri-ui"),t.classList.add("calcite-theme-"+($l()?"dark":"light")),this._attachContainers(t)),e&&(e.classList.remove("esri-ui"),HZ(e,{top:"",bottom:"",left:"",right:""}),fr(e)),this._set("container",t))}get height(){const t=this.get("view.height")||0;if(0===t)return t;const e=this._getViewPadding();return Math.max(t-(e.top+e.bottom),0)}get padding(){return this._get("padding")}set padding(t){t?this._override("padding",t):this._clearOverride("padding")}castPadding(t){return"number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...UZ,...t}}get width(){const t=this.get("view.width")||0;if(0===t)return t;const e=this._getViewPadding();return Math.max(t-(e.left+e.right),0)}add(t,e){let i,s;if(Array.isArray(t))return void t.forEach((t=>this.add(t,e)));const n=WZ(t);n&&({index:i,position:e,component:t,key:s}=n),e&&"object"==typeof e&&({index:i,key:s,position:e}=e),!t||e&&!this._isValidPosition(e)||this._add(t,e,i,s)}remove(t,e){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,e)));const i=this._find(t);if(i){const s=this._componentToKey;if(s.has(t)&&s.get(t)!==e)return;const n=this._components.indexOf(i);return i.node.parentNode&&i.node.parentNode.removeChild(i.node),this._componentToKey.delete(t),this._components.splice(n,1)[0]}}empty(t){return Array.isArray(t)?t.map((t=>this.empty(t))).reduce(((t,e)=>t.concat(e))):(t=t||qZ)===qZ?Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(BZ))).map((t=>this.remove(t))):this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null}move(t,e){if(Array.isArray(t)&&t.forEach((t=>this.move(t,e))),!t)return;let i;const s=WZ(t)||WZ(e);if(s&&(i=s.index,e=s.position,t=s.component||t),e&&!this._isValidPosition(e))return;const n=this.remove(t);n&&this.add(n,{position:e,index:i})}find(t){if(!t)return null;const e=this._findById(t);return e&&(e.widget||e.node)}getPosition(t){for(const e in this._positionNameToContainerLookup)if(this._positionNameToContainerLookup[e].contains(t))return e;return null}_add(t,e,i,s){t instanceof zZ||(t=new zZ({node:t})),this._place({component:t,position:e,index:i}),this._components.push(t),s&&this._componentToKey.set(t,s)}_find(t){return t?t instanceof zZ?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.get("view.padding")||GZ}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer)}_initContainers(){const t=document.createElement("div");t.classList.add("esri-ui-inner-container"),t.classList.add("esri-ui-corner-container");const e=document.createElement("div");e.classList.add("esri-ui-inner-container"),e.classList.add("esri-ui-manual-container");const i=document.createElement("div");i.classList.add("esri-ui-top-left"),i.classList.add(BZ),t.appendChild(i);const s=document.createElement("div");s.classList.add("esri-ui-top-right"),s.classList.add(BZ),t.appendChild(s);const n=document.createElement("div");n.classList.add("esri-ui-bottom-left"),n.classList.add(BZ),t.appendChild(n);const r=document.createElement("div");r.classList.add("esri-ui-bottom-right"),r.classList.add(BZ),t.appendChild(r),this._innerContainer=t,this._manualContainer=e;const o=Al();this._cornerNameToContainerLookup={"top-left":i,"top-right":s,"bottom-left":n,"bottom-right":r,"top-leading":o?s:i,"top-trailing":o?i:s,"bottom-leading":o?r:n,"bottom-trailing":o?n:r},this._positionNameToContainerLookup={manual:e,...this._cornerNameToContainerLookup}}_isValidPosition(t){return!!this._positionNameToContainerLookup[t]}_place(t){const e=t.component,i=t.index,s=this._positionNameToContainerLookup[t.position||qZ],n=i>-1;if(function(t){return t&&!t._started&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}(e.widget)&&e.widget.startup(),!n)return void s.appendChild(e.node);const r=Array.prototype.slice.call(s.children);0!==i?i>=r.length?s.appendChild(e.node):yr(e.node,r[i]):s.firstChild?yr(e.node,s.firstChild):s.appendChild(e.node)}_applyViewPadding(){const t=this.container;t&&HZ(t,this._toPxPosition(this._getViewPadding()))}_applyUIPadding(){const t=this._innerContainer;t&&HZ(t,this._toPxPosition(this.padding))}_toPxPosition(t){return{top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}}_toPxUnit(t){return 0===t?"0":t+"px"}_findByComponent(t){let e,i=null;return this._components.some((s=>(e=s===t,e&&(i=s),e))),i}_findById(t){let e,i=null;return this._components.some((s=>(e=s.id===t,e&&(i=s),e))),i}_findByNode(t){let e,i=null;return this._components.some((s=>(e=s.node===t,e&&(i=s),e))),i}};e([oe()],JZ.prototype,"container",null),e([oe()],JZ.prototype,"height",null),e([oe({value:UZ})],JZ.prototype,"padding",null),e([ba("padding")],JZ.prototype,"castPadding",null),e([oe()],JZ.prototype,"view",void 0),e([oe()],JZ.prototype,"width",null),JZ=e([si("esri.views.ui.UI")],JZ);const ZZ=JZ;function QZ(t,e){return t&&"copyright"in t&&(!e||"function"==typeof t.originOf&&"user"===t.originOf("copyright"))}function KZ(t,e,i){i&&e&&(t.find((t=>t.layerView===e&&t.text===i))||t.push({text:i,layerView:e}))}const YZ=[];let XZ=class extends tS{constructor(t){super(t),this.clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state")},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new qo,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const e=this.get("view.allLayerViews");e&&this.handles.add(e.map((t=>t.watch(["suspended","attributionVisible"],this._updateAttributionItems))),"suspension"),t&&t.removed&&t.removed.forEach((t=>{this._pendingAttributions.delete(t),this._fetchedAttributionData.delete(t)})),this._updateAttributionItems()},this._updateAttributionItems=()=>{const t=this.get("view.allLayerViews");YZ.length=0,t?(t.forEach((t=>{if(t.suspended||!t.get("layer.attributionVisible"))return;const e=t.layer;if(QZ(e,"user"))return void KZ(YZ,t,e.copyright);if(e.hasAttributionData){if(this._fetchedAttributionData.has(t)){const i=this._fetchedAttributionData.get(t);return void(i?KZ(YZ,t,this._getDynamicAttribution(i,this.view,e)):QZ(e)&&KZ(YZ,t,e.copyright))}return void this._fetchAttributionData(t)}const i=e.get("portalItem.accessInformation");KZ(YZ,t,i||e.copyright)})),function(t,e){return t.length!==e.length||t.some(((t,i)=>t.text!==e[i].text))}(this.items,YZ)&&(this.items.removeAll(),this.items.addMany(YZ)),YZ.length=0,this.notifyChange("state")):this.clear()},this.handles.add([ca(this,"view.allLayerViews","change",this._allLayerViewsChange,this._allLayerViewsChange,this.clear),ra(this,"view.stationary",(()=>this._updateAttributionItems()))])}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll()}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const e=await FT(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const i=e.ok?this._createContributionIndex(e.value,function(t){return"bing-maps"===t.type}(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,i)}this._updateAttributionItems()}_createContributionIndex(t,e){const i=t.contributors,s={};if(!i)return s;for(let t=0;t<i.length;t++){const n=i[t],r=n.coverageAreas;if(!r)return;for(const i of r){const r=i.bbox,o=i.zoomMin-(e&&i.zoomMin?1:0),a=i.zoomMax-(e&&i.zoomMax?1:0),l={extent:kp({xmin:r[1],ymin:r[0],xmax:r[3],ymax:r[2],spatialReference:ap.WGS84}),attribution:n.attribution||"",score:null!=i.score?i.score:100,id:t};for(let t=o;t<=a;t++)s[t]=s[t]||[],s[t].push(l)}}return s.maxKey=Math.max.apply(null,Object.keys(s)),s}_getDynamicAttribution(t,e,i){const{extent:s,scale:n}=e;let r=i.tileInfo.scaleToZoom(n);if(r=Math.min(t.maxKey,Math.round(r)),!s||null==r||r<=-1)return"";const o=t[r],a=Mp(s.center.clone().normalize(),e.spatialReference),l={};return o?o.filter((t=>{const e=!l[t.id]&&a&&Pp(t.extent,a);return e&&(l[t.id]=!0),e})).sort(((t,e)=>e.score-t.score||t.objectId-e.objectId)).map((t=>t.attribution)).join(", "):""}};e([oe({readOnly:!0,type:qo})],XZ.prototype,"items",void 0),e([oe({readOnly:!0})],XZ.prototype,"state",null),e([oe()],XZ.prototype,"view",void 0),XZ=e([si("esri.widgets.Attribution.AttributionViewModel")],XZ);const tQ=XZ;let eQ=class extends Dc{constructor(t,e){super(t,e),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this.iconClass="esri-icon-description",this.itemDelimiter=" | ",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new tQ}initialize(){this.own(ca(this,"viewModel.items","change",(()=>this.scheduleRender())))}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((t,e)=>(-1===t.indexOf(e.text)&&t.push(e.text),t)),[]).join(this.itemDelimiter)}render(){return Bc("div",{bind:this,class:this.classes("esri-attribution esri-widget",{"esri-attribution--open":this._isOpen}),onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return Bc("div",{class:"esri-attribution__powered-by"},"Powered by"," ",Bc("a",{class:"esri-attribution__link",href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const t=this._isOpen,e=this._isInteractive,i=e?0:-1,{attributionText:s}=this,n=e?"button":void 0;return Bc("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes("esri-attribution__sources",{"esri-attribution__sources--open":t,"esri-interactive":e}),innerHTML:s,role:n,tabIndex:i})}_afterSourcesNodeCreate(t){this._prevSourceNodeHeight=t.clientWidth}_afterSourcesNodeUpdate(t){let e=!1;const{clientHeight:i,clientWidth:s,scrollWidth:n}=t,r=n>=s,o=this._attributionTextOverflowed!==r;if(this._attributionTextOverflowed=r,o&&(e=!0),this._isOpen){const t=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,t&&(this._isOpen=!1,e=!0)}e&&this.scheduleRender()}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen)}};e([oe()],eQ.prototype,"_isOpen",void 0),e([oe()],eQ.prototype,"_isInteractive",null),e([oe()],eQ.prototype,"_attributionTextOverflowed",void 0),e([oe()],eQ.prototype,"_prevSourceNodeHeight",void 0),e([oe({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],eQ.prototype,"attributionText",null),e([oe()],eQ.prototype,"iconClass",void 0),e([oe()],eQ.prototype,"itemDelimiter",void 0),e([oe({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],eQ.prototype,"label",void 0),e([oe(),zc("esri/widgets/Attribution/t9n/Attribution")],eQ.prototype,"messages",void 0),e([ue("viewModel.view")],eQ.prototype,"view",void 0),e([oe({type:tQ})],eQ.prototype,"viewModel",void 0),e([Vc()],eQ.prototype,"_toggleState",null),eQ=e([si("esri.widgets.Attribution")],eQ);const iQ=eQ;let sQ=class extends(jO(jo)){constructor(t){super(t),this._handles=new Wo,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this)}initialize(){this._handles.add(Xo(this,"view",this._updateRotationWatcher))}destroy(){this._handles.destroy(),this._handles=null,this.view=null}get canShowNorth(){const t=this.get("view.spatialReference");return!(!t||!t.isWebMercator&&!t.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const t={};"2d"===this.view.type?t.rotation=0:t.heading=0,this.callGoTo({target:t})}_updateForRotation(t){null!=t&&(this.orientation={z:t})}_updateForCamera(t){t&&(this.orientation={x:0,y:0,z:-t.heading})}_updateRotationWatcher(t){this._handles.removeAll(),t&&this._handles.add("2d"===t.type?Xo(this,"view.rotation",this._updateForRotation):Xo(this,"view.camera",this._updateForCamera))}};e([oe({readOnly:!0})],sQ.prototype,"canShowNorth",null),e([oe()],sQ.prototype,"orientation",void 0),e([oe({readOnly:!0})],sQ.prototype,"state",null),e([oe()],sQ.prototype,"view",void 0),sQ=e([si("esri.widgets.CompassViewModel")],sQ);const nQ=sQ;let rQ=class extends Dc{constructor(t,e){super(t,e),this.goToOverride=null,this.iconClass="esri-icon-locate-circled",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new nQ}reset(){return this.viewModel.reset()}render(){const{orientation:t,state:e}=this.viewModel,i="disabled"===e,s="compass"==("rotation"===e?"rotation":"compass"),n=i?-1:0,r={"esri-disabled":i,"esri-interactive":!i},o={"esri-icon-compass":s,"esri-icon-dial":!s},{messages:a}=this;return Bc("div",{bind:this,class:this.classes("esri-compass esri-widget--button esri-widget",r),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:n,"aria-label":a.reset,title:a.reset},Bc("span",{"aria-hidden":"true",class:this.classes("esri-compass__icon",o),styles:this._toRotationTransform(t)}),Bc("span",{class:"esri-icon-font-fallback-text"},a.reset))}_reset(){this.viewModel.reset()}_toRotationTransform(t){return{transform:`rotateZ(${t.z}deg)`}}};e([ue("viewModel.goToOverride")],rQ.prototype,"goToOverride",void 0),e([oe()],rQ.prototype,"iconClass",void 0),e([oe({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],rQ.prototype,"label",void 0),e([oe(),zc("esri/widgets/Compass/t9n/Compass")],rQ.prototype,"messages",void 0),e([ue("viewModel.view")],rQ.prototype,"view",void 0),e([oe({type:nQ})],rQ.prototype,"viewModel",void 0),e([Vc()],rQ.prototype,"_reset",null),rQ=e([si("esri.widgets.Compass")],rQ);const oQ=rQ;let aQ=class extends jo{constructor(t){super(t),this._handles=new Wo,this.navigationMode="pan",this.view=null}initialize(){this._handles.add(ea(this,"view.inputManager",this._setNavigationMode.bind(this)))}destroy(){this._handles.destroy(),this._handles=null,this.view=null}get state(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode())}_setNavigationMode(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate"}};e([oe({readOnly:!0})],aQ.prototype,"state",null),e([oe()],aQ.prototype,"navigationMode",void 0),e([oe()],aQ.prototype,"view",void 0),aQ=e([si("esri.widgets.NavigationToggleViewModel")],aQ);const lQ=aQ,uQ="esri-navigation-toggle__button esri-widget--button";let cQ=class extends Dc{constructor(t,e){super(t,e),this.iconClass="esri-icon-pan2",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new lQ}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t)}toggle(){return this.viewModel.toggle()}render(){const t="disabled"===this.get("viewModel.state"),e="pan"===this.get("viewModel.navigationMode"),i={"esri-navigation-toggle__button--active":e},s={"esri-navigation-toggle__button--active":!e},n=t?-1:0,r=this.messages.toggle;return Bc("div",{bind:this,class:this.classes("esri-navigation-toggle esri-widget",{"esri-disabled":t,"esri-navigation-toggle--horizontal":"horizontal"===this.layout}),onclick:this._toggle,onkeydown:this._toggle,tabIndex:n,"aria-label":r,title:r},Bc("div",{class:this.classes(uQ,"esri-navigation-toggle__button--pan",i)},Bc("span",{class:"esri-icon-pan"})),Bc("div",{class:this.classes(uQ,"esri-navigation-toggle__button--rotate",s)},Bc("span",{class:"esri-icon-rotate"})))}_toggle(){this.toggle()}};e([oe()],cQ.prototype,"iconClass",void 0),e([oe({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],cQ.prototype,"label",void 0),e([oe({value:"vertical"})],cQ.prototype,"layout",null),e([oe(),zc("esri/widgets/NavigationToggle/t9n/NavigationToggle")],cQ.prototype,"messages",void 0),e([ue("viewModel.view")],cQ.prototype,"view",void 0),e([oe({type:lQ})],cQ.prototype,"viewModel",void 0),e([Vc()],cQ.prototype,"_toggle",null),cQ=e([si("esri.widgets.NavigationToggle")],cQ);const hQ=cQ;let dQ=class extends Dc{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title=""}render(){const t=this.enabled?0:-1,e={[this.iconClass]:!!this.iconClass};return Bc("div",{bind:this,class:this.classes("esri-widget--button esri-widget",{"esri-disabled":!this.enabled,"esri-interactive":this.enabled}),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:t,title:this.title},Bc("span",{"aria-hidden":"true",role:"presentation",class:this.classes("esri-icon",e)}),Bc("span",{class:"esri-icon-font-fallback-text"},this.title))}_triggerAction(){this.action.call(this)}};e([oe()],dQ.prototype,"action",void 0),e([oe()],dQ.prototype,"enabled",void 0),e([oe()],dQ.prototype,"iconClass",void 0),e([oe()],dQ.prototype,"title",void 0),e([Vc()],dQ.prototype,"_triggerAction",null),dQ=e([si("esri.widgets.IconButton")],dQ);const pQ=dQ;let fQ=class extends jo{get canZoomIn(){if(!this.get("view.ready"))return!1;const t=this.get("view.animation.target.scale")||this.get("view.scale"),e=this.get("view.constraints.effectiveMaxScale");return 0===e||t>e}get canZoomOut(){if(!this.get("view.ready"))return!1;const t=this.get("view.animation.target.scale")||this.get("view.scale"),e=this.get("view.constraints.effectiveMinScale");return 0===e||t<e}};e([oe({readOnly:!0})],fQ.prototype,"canZoomIn",null),e([oe({readOnly:!0})],fQ.prototype,"canZoomOut",null),e([oe()],fQ.prototype,"view",void 0),fQ=e([si("esri.widgets.Zoom.ZoomConditions2D")],fQ);const yQ=fQ;let mQ=class extends jo{get canZoomIn(){return!!this.get("view.ready")}get canZoomOut(){return!!this.get("view.ready")}};e([oe({readOnly:!0})],mQ.prototype,"canZoomIn",null),e([oe({readOnly:!0})],mQ.prototype,"canZoomOut",null),e([oe()],mQ.prototype,"view",void 0),mQ=e([si("esri.widgets.Zoom.ZoomConditions3D")],mQ);const gQ=mQ;let vQ=class extends jo{constructor(t){super(t),this.canZoomIn=!1,this.canZoomOut=!1}destroy(){this.view=null}get state(){return this.get("view.ready")?"ready":"disabled"}set view(t){t?"2d"===t.type?this._zoomConditions=new yQ({view:t}):"3d"===t.type&&(this._zoomConditions=new gQ({view:t})):this._zoomConditions=null,this._set("view",t)}zoomIn(){if(!this.canZoomIn)return;const t=this.view;"2d"===t.type?t.mapViewNavigation.zoomIn():ss(t.goTo({zoomFactor:2}))}zoomOut(){if(!this.canZoomOut)return;const t=this.view;"2d"===t.type?t.mapViewNavigation.zoomOut():ss(t.goTo({zoomFactor:.5}))}};e([oe()],vQ.prototype,"_zoomConditions",void 0),e([oe({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],vQ.prototype,"canZoomIn",void 0),e([oe({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],vQ.prototype,"canZoomOut",void 0),e([oe({readOnly:!0})],vQ.prototype,"state",null),e([oe()],vQ.prototype,"view",null),vQ=e([si("esri.widgets.Zoom.ZoomViewModel")],vQ);const wQ=vQ;let bQ=class extends Dc{constructor(t,e){super(t,e),this.iconClass="esri-icon-zoom-in-magnifying-glass",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new wQ}initialize(){this._zoomInButton=new pQ({action:this.zoomIn.bind(this),iconClass:"esri-icon-plus"}),this._zoomOutButton=new pQ({action:this.zoomOut.bind(this),iconClass:"esri-icon-minus"})}destroy(){this._zoomInButton.destroy(),this._zoomOutButton.destroy(),this._zoomInButton=null,this._zoomOutButton=null}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t)}render(){const t=this.viewModel,e={"esri-zoom--horizontal":"horizontal"===this.layout};return this._zoomInButton.enabled="ready"===t.state&&t.canZoomIn,this._zoomOutButton.enabled="ready"===t.state&&t.canZoomOut,this._zoomInButton.title=this.messages.zoomIn,this._zoomOutButton.title=this.messages.zoomOut,Bc("div",{class:this.classes("esri-zoom esri-widget",e)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};e([oe()],bQ.prototype,"iconClass",void 0),e([oe({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],bQ.prototype,"label",void 0),e([oe({value:"vertical"})],bQ.prototype,"layout",null),e([oe(),zc("esri/widgets/Zoom/t9n/Zoom")],bQ.prototype,"messages",void 0),e([ue("viewModel.view")],bQ.prototype,"view",void 0),e([oe({type:wQ})],bQ.prototype,"viewModel",void 0),bQ=e([si("esri.widgets.Zoom")],bQ);const MQ=bQ,SQ="esri.views.ui.DefaultUI";ct.getLogger(SQ);let xQ=class extends ZZ{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-leading","navigation-toggle":"top-leading",zoom:"top-leading"},this.components=[]}initialize(){this._handles.add([Xo(this,"components",this._componentsWatcher.bind(this)),Xo(this,"view",this._updateViewAwareWidgets.bind(this))])}_add(t,e,i,s){if("string"==typeof t&&this._defaultPositionLookup[t]){if(this._find(t))return;t=this._createComponent(t)}super._add(t,e,i,s)}_removeComponents(t){t.forEach((t=>{const e=this._find(t);e&&(this.remove(e),e.destroy())}))}_updateViewAwareWidgets(t){this.components.forEach((e=>{const i=this._find(e),s=i&&i.widget;(function(t){return t&&void 0!==t.view})(s)&&(s.view=t)}))}_componentsWatcher(t,e){this._removeComponents(e),this._addComponents(t),this._adjustPadding(t)}_adjustPadding(t){if(-1===t.indexOf("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t}}_addComponents(t){this.initialized&&t.forEach((t=>this.add(this._createComponent(t),this._defaultPositionLookup[t])))}_createComponent(t){const e=this._createWidget(t);if(e)return new zZ({id:t,node:e})}_createWidget(t){return"attribution"===t?this._createAttribution():"compass"===t?this._createCompass():"navigation-toggle"===t?this._createNavigationToggle():"zoom"===t?this._createZoom():void 0}_createAttribution(){return new iQ({view:this.view})}_createCompass(){return new oQ({view:this.view})}_createNavigationToggle(){return new hQ({view:this.view})}_createZoom(){return new MQ({view:this.view})}};e([oe()],xQ.prototype,"components",void 0),xQ=e([si(SQ)],xQ);const kQ=xQ;let IQ=class extends kQ{constructor(t){super(t),this.components=["attribution","zoom"]}};e([oe()],IQ.prototype,"components",void 0),IQ=e([si("esri.views.ui.2d.DefaultUI2D")],IQ);const jQ=IQ,_Q=ct.getLogger("esri.views.MapView");let TQ,OQ,AQ,FQ,CQ,PQ;function EQ(t,e,i){if(t)if(Array.isArray(t)||qo.isCollection(t)){if(0===t.length)return;t.forEach((t=>EQ(t,e,i)))}else!function(t){return t instanceof hj}(t)?i.add(t):e.add(t)}let RQ=class extends(hC(SG(TJ))){constructor(t){super(t),this._magnifierView=null,this._stage=null,this._resolveWhenReady=[],this.rootLayerViews=new nA({getCollections:()=>{var t,e;return[null==(t=this.basemapView)?void 0:t.baseLayerViews,this.layerViews,null==(e=this.basemapView)?void 0:e.referenceLayerViews]},getChildrenFunction:()=>null}),this.floors=new qo,this.graphicsView=null,this.highlightOptions=new MZ,this.inputManager=new vZ({view:this}),this.mapViewNavigation=null,this.supersampleScreenshotsEnabled=!1,this.ui=new jQ,this.rendering=!1,aC()}destroy(){this.rootLayerViews.destroy(),this.inputManager.destroy(),this._set("inputManager",null)}get background(){return this.get("map.initialViewProperties.background")||null}set background(t){void 0===t?this._clearOverride("background"):this._override("background",t)}get textureManager(){return this._stage.painter.textureManager}get navigating(){return!(!this.mapViewNavigation||!this.mapViewNavigation.interacting)}toMap(t){if(dU(t)){const e=hU(this,t);return super.toMap(e)}return super.toMap(t)}hitTest(t,e){const i=dU(t)?hU(this,t):t;if(!this.ready||isNaN(i.x)||isNaN(i.y))return Promise.resolve({screenPoint:i,results:[]});const s=this.toMap(i),n=[this.graphicsView];n.push.apply(n,this.allLayerViews.toArray().reverse());const r=new Set,o=new Set,a=new Set,l=new Set;return e&&(EQ(e&&e.include,r,a),EQ(e&&e.exclude,o,l)),Promise.all(n.map((t=>!t||!t.hitTest||a.size>0&&!t.layer||a.size>0&&t.layer&&!a.has(t.layer)||l.size>0&&t.layer&&l.has(t.layer)?null:t.hitTest(i.x,i.y)))).then((t=>({screenPoint:i,results:t.filter((t=>null!=t&&(!(r.size>0)||r.has(t))&&(!(o.size>0)||!o.has(t)))).map((t=>({mapPoint:s,graphic:t})))})))}takeScreenshot(t){if(t=t||{},!this.ready)return Promise.reject("Map view cannot be used before it is ready");const e=this.supersampleScreenshotsEnabled?Math.min(4,function(t,e){return e/Math.max(t[0],t[1])}(this.size,Math.min(4096,this._stage.context.parameters.maxTextureSize))):1;let i;t.layers?(i=[],t.layers.forEach((t=>{const e=this.allLayerViews.find((e=>e.layer.id===t.id));e&&"container"in e&&e.container&&i.push(e.container)}))):i=this._stage.children;const{format:s,quality:n}=function(t,e){const i=function(t){switch(t){case"png":case"jpg":case"jpeg":return t;default:return AZ}}(t);return{format:i,quality:od(null!=e?e:FZ[i],0,100)}}(t.format,t.quality),r=function(t,e,i,s,n,r,o,a){let l;t.ignorePadding&&(s={left:0,right:0,top:0,bottom:0}),null!=t.width&&null!=t.height?l=[t.width,t.height]:null==t.width&&null!=t.height?l=[t.height,t.height]:null!=t.width&&null==t.height?l=[t.width,t.width]:null==t.width&&null==t.height&&(l=null);const u=i[0]-(s.left+s.right),c=i[1]-(s.top+s.bottom);let h,d,p=t.area||{x:0,y:0,width:u,height:c};if(l){const t=l[0]/l[1];if(t>u/c){const e=p.width/t;p={x:p.x,y:Math.round(p.y+(p.height-e)/2),width:p.width,height:Math.round(e)}}else{const e=p.height*t;p={x:Math.round(p.x+(p.width-e)/2),y:p.y,width:Math.round(e),height:p.height}}}else l=[p.width,p.height];return l[0]>p.width?(h=Math.min(l[0]/p.width,e),d=l[0]/p.width/h):(h=1,d=l[0]/p.width),{resolutionScale:h,cropArea:{x:Math.round((p.x+s.left)*h),y:Math.round((p.y+s.top)*h),width:Math.round(p.width*h),height:Math.round(p.height*h)},outputScale:d,format:n,quality:r,children:o,rotation:a}}(t,e,this.size,this.padding,s,n,i,t.rotation);return this._stage.takeScreenshot(r)}on(t,e,i,s){return this.inputManager&&this.viewEvents.on(t,e,i,s)||super.on(t,e)}hasEventListener(t){return super.hasEventListener(t)||this.viewEvents.hasHandler(t)}whenLayerView(t){return super.whenLayerView(t)}graphicChanged(t){this.graphicsView&&this.graphicsView.graphicUpdateHandler(t)}whenReady(){return new Promise((t=>{this.ready?t(this):this._resolveWhenReady.push(t)}))}forceDOMReadyCycle(){this.forceReadyCycle()}validate(){let t=function(t){t={...VZ,...t};const e=DZ();return e.available?t.checkMajorWebPerformanceCaveat&&e.majorPerformanceCaveat?new Ve("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):e.supportsHighPrecisionFragment?e.supportsVertexShaderSamplers?e.supportsElementIndexUint?e.supportsStandardDerivatives?e.supportsInstancedArrays?null:new Ve("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported."):new Ve("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported."):new Ve("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported."):new Ve("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new Ve("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new Ve("webgl:required","WebGL is required but not supported.")}({checkMajorWebPerformanceCaveat:!1});return l("safari")&&l("safari")<9&&(t=new Ve("mapview:browser-not-supported","This browser is not supported by MapView (Safari < 9)",{type:"safari",requiredVersion:9,detectedVersion:l("safari")})),u(t)?(_Q.warn("#validate()",t.message),Promise.reject(t)):async function(){const[,{GraphicsView2D:t,GraphicContainer:e,LabelManager:i,MapViewNavigation:s,MagnifierView2D:n,Stage:r}]=await Promise.all([import("./p-053d7623.js"),import("./p-b8c4e78e.js")]);OQ=t,AQ=e,FQ=i,CQ=s,PQ=n,TQ=r}()}_startup(){this.timeline.begin("MapView Startup"),super._startup(),this.graphics.owner=this;const t=new TQ(this.surface,{canvas:this.renderCanvas,supersampleScreenshots:this.supersampleScreenshotsEnabled,contextOptions:{disabledExtensions:this.deactivatedWebGLExtensions,debugWebGLExtensions:this.debugWebGLExtensions},renderingOptions:this.renderingOptions,timeline:this.timeline}),e=new OQ({view:this,graphics:this.graphics,requestUpdateCallback:()=>this.requestUpdate(),container:new AQ(this.featuresTilingScheme)}),i=new CQ({view:this,animationManager:this.animationManager}),s=new FQ({view:this});this._magnifierView=new PQ,this._magnifierView.magnifier=this.magnifier,this._stage=t,this.frameTask.graphicsView=e,this._set("graphicsView",e),this._set("mapViewNavigation",i),this._set("labelManager",s),this.handles.add([this.rootLayerViews.on("change",(()=>this._updateStageChildren())),t.on("post-render",(()=>this._set("rendering",t.renderRequested))),t.on("will-render",(()=>this._set("rendering",t.renderRequested))),t.on("webgl-error",(t=>this.fatalError=t.error)),Xo(this,"stationary",(e=>t.stationary=e),!0),Xo(this,"state.id",(()=>t.state=this.state),!0),Xo(this,"background",(e=>{t.background=e,this._magnifierView.background=e}),!0),Xo(this,"magnifier",(t=>this._magnifierView.magnifier=t),!0),Xo(this,"renderingOptions",(e=>t.renderingOptions=e),!0),Xo(this,"highlightOptions",(()=>t.highlightOptions=this.highlightOptions),!0)],"map-view"),t.state=this.state,this._updateStageChildren();const n=this._resolveWhenReady;this._resolveWhenReady=[],n.forEach((t=>t(this))),this.timeline.end("MapView Startup")}_teardown(){this.handles.remove("map-view"),this.layerViewManager.clear(),this.labelManager.destroy(),this._magnifierView.destroy(),this._stage.destroy(),this.graphicsView.destroy(),this.mapViewNavigation.destroy(),this._stage=null,this._set("graphicsView",null),this._magnifierView=null,this._set("labelManager",null),this._set("mapViewNavigation",null),this.graphics.owner=null,super._teardown()}_updateStageChildren(){this._stage.removeAllChildren(),this.rootLayerViews.forEach((t=>{this._stage.addChild(t.container)})),this._stage.addChild(this.graphicsView.container),this._stage.addChild(this._magnifierView)}};e([oe({type:mF})],RQ.prototype,"background",null),e([oe()],RQ.prototype,"floors",void 0),e([oe()],RQ.prototype,"graphicsView",void 0),e([oe({type:MZ})],RQ.prototype,"highlightOptions",void 0),e([oe({readOnly:!0})],RQ.prototype,"inputManager",void 0),e([oe({readOnly:!0})],RQ.prototype,"textureManager",null),e([oe({readOnly:!0})],RQ.prototype,"mapViewNavigation",void 0),e([oe({type:Boolean})],RQ.prototype,"navigating",null),e([oe({type:Boolean,constructOnly:!0})],RQ.prototype,"supersampleScreenshotsEnabled",void 0),e([oe({type:jQ})],RQ.prototype,"ui",void 0),e([oe({readOnly:!0})],RQ.prototype,"rendering",void 0),e([oe({constructOnly:!0})],RQ.prototype,"renderCanvas",void 0),e([oe({constructOnly:!0})],RQ.prototype,"deactivatedWebGLExtensions",void 0),e([oe({constructOnly:!0})],RQ.prototype,"debugWebGLExtensions",void 0),RQ=e([si("esri.views.MapView")],RQ);const LQ=RQ;export{ca as $,Ab as A,qo as B,qM as C,aT as D,ps as E,la as F,ta as G,$n as H,OT as I,Rn as J,sO as K,Ai as L,iO as M,p as N,ua as O,nO as P,jk as Q,_n as R,Oi as S,rs as T,Xo as U,hm as V,u as W,Gy as X,yi as Y,ra as Z,Ol as _,oa as a,UO as a$,wu as a0,cm as a1,Ni as a2,wO as a3,ba as a4,qI as a5,Vd as a6,Ve as a7,of as a8,DS as a9,Gc as aA,Cl as aB,Nl as aC,Dl as aD,ot as aE,qi as aF,BA as aG,is as aH,Vs as aI,XA as aJ,Av as aK,Sd as aL,WA as aM,uS as aN,xd as aO,dF as aP,K as aQ,Md as aR,pF as aS,Rt as aT,DA as aU,mF as aV,Jo as aW,Fn as aX,_O as aY,Ad as aZ,P as a_,qf as aa,H as ab,Fp as ac,ap as ad,Tt as ae,SO as af,xO as ag,MO as ah,IO as ai,hj as aj,hr as ak,l as al,kp as am,it as an,Qv as ao,jO as ap,To as aq,mb as ar,lr as as,zm as at,Nb as au,bO as av,ia as aw,us as ax,lj as ay,Ms as az,zc as b,eh as b$,Ip as b0,aA as b1,lA as b2,lF as b3,LO as b4,ln as b5,hn as b6,jn as b7,_A as b8,LQ as b9,H_ as bA,Yg as bB,Z_ as bC,Tw as bD,Iw as bE,X_ as bF,J_ as bG,i as bH,q$ as bI,CZ as bJ,q as bK,B as bL,g as bM,ad as bN,fq as bO,Dq as bP,gq as bQ,Yi as bR,qE as bS,Xi as bT,Hi as bU,Qi as bV,IH as bW,Ji as bX,tq as bY,oH as bZ,O as b_,ny as ba,iy as bb,dO as bc,yO as bd,cO as be,pO as bf,aO as bg,fO as bh,Pn as bi,OM as bj,IM as bk,jM as bl,XM as bm,hx as bn,SS as bo,ey as bp,Hf as bq,DT as br,WT as bs,$T as bt,sw as bu,cv as bv,zT as bw,Q_ as bx,Wj as by,wn as bz,Wc as c,o$ as c$,mq as c0,YU as c1,IJ as c2,Qr as c3,zi as c4,nH as c5,IZ as c6,SZ as c7,xZ as c8,yh as c9,_f as cA,Kp as cB,Jd as cC,OE as cD,AE as cE,CE as cF,Yd as cG,ag as cH,_L as cI,gf as cJ,vL as cK,NL as cL,LL as cM,mL as cN,mg as cO,BE as cP,PE as cQ,rJ as cR,gg as cS,zE as cT,lg as cU,DZ as cV,pg as cW,fg as cX,Ki as cY,mf as cZ,r$ as c_,od as ca,ZS as cb,fC as cc,Qz as cd,pm as ce,Xc as cf,wh as cg,kh as ch,gh as ci,Xq as cj,fm as ck,Eq as cl,eq as cm,Zq as cn,Cq as co,Wq as cp,Gq as cq,XU as cr,Qq as cs,ys as ct,kn as cu,Yf as cv,Kf as cw,Qf as cx,ty as cy,Xf as cz,oe as d,oi as d$,n$ as d0,JW as d1,QW as d2,KW as d3,aH as d4,XW as d5,YW as d6,mO as d7,uO as d8,ug as d9,xk as dA,P_ as dB,jL as dC,PL as dD,TL as dE,AL as dF,HE as dG,qL as dH,zL as dI,G_ as dJ,b as dK,M as dL,O$ as dM,_ as dN,tH as dO,SL as dP,ML as dQ,HW as dR,S as dS,Nz as dT,at as dU,yT as dV,cy as dW,pT as dX,fT as dY,$R as dZ,$E as d_,gr as da,dg as db,ld as dc,fs as dd,Sp as de,xp as df,sp as dg,Hd as dh,bp as di,qB as dj,JB as dk,FH as dl,x as dm,BL as dn,OL as dp,dm as dq,y as dr,cT as ds,t$ as dt,e$ as du,i$ as dv,l_ as dw,dT as dx,uy as dy,_k as dz,e,Tg as e$,Mn as e0,Q as e1,rC as e2,zt as e3,V as e4,$D as e5,XD as e6,lV as e7,w as e8,Gs as e9,hf as eA,vg as eB,W as eC,Rs as eD,Ks as eE,$s as eF,Hs as eG,tn as eH,En as eI,ay as eJ,sm as eK,Vx as eL,$x as eM,Ay as eN,WE as eO,np as eP,bn as eQ,pi as eR,Ag as eS,$L as eT,wg as eU,PT as eV,zy as eW,a_ as eX,o_ as eY,v as eZ,m as e_,ED as ea,rx as eb,mA as ec,OG as ed,F as ee,io as ef,Dr as eg,BP as eh,bj as ei,gj as ej,vj as ek,wj as el,sn as em,kj as en,Nn as eo,k as ep,nn as eq,I as er,Tn as es,hg as et,Pp as eu,Mp as ev,UB as ew,cg as ex,es as ey,FT as ez,Hc as f,RS as f$,Pg as f0,xg as f1,YG as f2,h as f3,Mg as f4,KV as f5,YV as f6,XV as f7,Df as f8,GS as f9,hd as fA,aM as fB,lM as fC,oM as fD,nM as fE,Ch as fF,eW as fG,rM as fH,XB as fI,fM as fJ,Nh as fK,pM as fL,vS as fM,th as fN,bS as fO,wS as fP,Kd as fQ,tp as fR,ip as fS,WW as fT,ZW as fU,Ph as fV,mp as fW,eH as fX,sH as fY,VS as fZ,NS as f_,Zd as fa,GL as fb,iL as fc,wL as fd,pL as fe,Gp as ff,ef as fg,Ep as fh,j as fi,L as fj,nJ as fk,E as fl,bh as fm,Th as fn,C as fo,$ as fp,vh as fq,Oh as fr,Ah as fs,dd as ft,Dh as fu,Mh as fv,Ih as fw,cd as fx,rd as fy,Gh as fz,c as g,BB as g$,ph as g0,zh as g1,Uh as g2,Hh as g3,Xh as g4,td as g5,Qh as g6,Kh as g7,Yh as g8,id as g9,wR as gA,fR as gB,eR as gC,AR as gD,RL as gE,EF as gF,$_ as gG,z_ as gH,os as gI,YR as gJ,XR as gK,sF as gL,JE as gM,hp as gN,ss as gO,zH as gP,kJ as gQ,CL as gR,ZE as gS,G as gT,Eh as gU,Yx as gV,lk as gW,LB as gX,zB as gY,GB as gZ,HB as g_,sd as ga,$h as gb,fh as gc,CT as gd,tS as ge,T as gf,PR as gg,SE as gh,OR as gi,KE as gj,EL as gk,TR as gl,CR as gm,yg as gn,ns as go,KM as gp,kV as gq,na as gr,IL as gs,$y as gt,By as gu,Wy as gv,Yy as gw,fd as gx,bR as gy,oo as gz,Rj as h,iM as h$,z as h0,yn as h1,mn as h2,Jf as h3,Ar as h4,ZU as h5,HH as h6,tJ as h7,up as h8,jv as h9,Ig as hA,Rg as hB,Vg as hC,tF as hD,nc as hE,Cu as hF,Eu as hG,sc as hH,rc as hI,qu as hJ,yf as hK,Wi as hL,as as hM,ls as hN,tf as hO,Bi as hP,cs as hQ,pN as hR,SR as hS,TE as hT,ev as hU,Xg as hV,kZ as hW,kt as hX,KB as hY,en as hZ,lh as h_,Zo as ha,LH as hb,QD as hc,HD as hd,gy as he,by as hf,Oy as hg,ky as hh,jy as hi,Iy as hj,_y as hk,vy as hl,wy as hm,Xy as hn,Ty as ho,_v as hp,PG as hq,zq as hr,Cg as hs,Tf as ht,rH as hu,fv as hv,kT as hw,hT as hx,MT as hy,ST as hz,si as i,Wx as i$,zD as i0,vV as i1,gV as i2,lx as i3,pz as i4,H$ as i5,ex as i6,oT as i7,sx as i8,C$ as i9,yy as iA,b$ as iB,nx as iC,p$ as iD,L$ as iE,ux as iF,rT as iG,ix as iH,x$ as iI,I$ as iJ,ry as iK,hs as iL,GR as iM,NR as iN,LR as iO,le as iP,gt as iQ,Uj as iR,bk as iS,YT as iT,jj as iU,XT as iV,r_ as iW,Kj as iX,nT as iY,Lt as iZ,Dx as i_,Ie as ia,TO as ib,jm as ic,Qo as id,VD as ie,nA as ig,dx as ih,ax as ii,px as ij,iF as ik,eF as il,rF as im,oF as io,tv as ip,IA as iq,bA as ir,Gt as is,Qd as it,ox as iu,oV as iv,GD as iw,KD as ix,IV as iy,py as iz,bd as j,yM as j$,B_ as j0,nF as j1,ae as j2,br as j3,on as j4,nv as j5,an as j6,ie as j7,ov as j8,ZB as j9,sM as jA,_h as jB,tM as jC,Fh as jD,TA as jE,ed as jF,HM as jG,Vh as jH,Er as jI,vq as jJ,sh as jK,md as jL,cx as jM,aF as jN,Ed as jO,$d as jP,MS as jQ,f as jR,$V as jS,ly as jT,WV as jU,jh as jV,U as jW,Dn as jX,ud as jY,jg as jZ,_g as j_,Ld as ja,lt as jb,vt as jc,HP as jd,V$ as je,uE as jf,Mr as jg,CG as jh,Zf as ji,IG as jj,rt as jk,pn as jl,PI as jm,da as jn,OV as jo,w$ as jp,mm as jq,uT as jr,yx as js,fx as jt,Oe as ju,Hb as jv,YA as jw,Zr as jx,rn as jy,Ds as jz,__ as k,Yb as k0,kg as k1,ih as k2,Og as k3,xh as k4,un as k5,uM as k6,dt as k7,dj as k8,gE as k9,IE as ka,uh as kb,d as kc,sr as kd,_j as ke,f_ as kf,RR as kg,zR as kh,fz as ki,VT as l,Ri as m,Bc as n,ue as o,jo as p,NT as q,qT as r,ct as s,Vc as t,Wo as u,ri as v,BT as w,Ub as x,Eb as y,Dc as z}