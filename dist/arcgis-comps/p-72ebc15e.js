import{z as r,A as n,a as t,Z as e,J as u,al as i,V as o}from"./p-d9c4b72e.js";import{hN as f,hP as c,hM as s}from"./p-c8bc3433.js";import{WhereClause as a}from"./p-b4d5c79c.js";import"./p-adb44ea0.js";import"./p-a805321e.js";import"./p-96687495.js";import"./p-84bf99cb.js";function m(r,e,c,s,m,j){if(1===s.length){if(t(s[0]))return f(i(r,s[0],o(s[1],-1)));if(u(s[0]))return f(i(r,s[0].toArray(),o(s[1],-1)))}else if(2===s.length){if(t(s[0]))return f(i(r,s[0],o(s[1],-1)));if(u(s[0]))return f(i(r,s[0].toArray(),o(s[1],-1)));if(n(s[0]))return s[0].load().then((n=>p(a.create(s[1],n.getFieldsIndex()),j,m).then((n=>s[0].calculateStatistic(r,n,o(s[2],1e3),e.abortSignal)))))}else if(3===s.length&&n(s[0]))return s[0].load().then((n=>p(a.create(s[1],n.getFieldsIndex()),j,m).then((n=>s[0].calculateStatistic(r,n,o(s[2],1e3),e.abortSignal)))));return f(i(r,s,-1))}function p(r,n,t){try{const e=r.getVariables();if(e.length>0){const u=[];for(let r=0;r<e.length;r++)u.push(n.evaluateIdentifier(t,{name:e[r]}));return c(u).then((n=>{const t={};for(let r=0;r<e.length;r++)t[e[r]]=n[r];return r.parameters=t,r}))}return f(r)}catch(r){return s(r)}}function j(i){"async"===i.mode&&(i.functions.stdev=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("stdev",n,0,e,r,i)}))},i.functions.variance=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("variance",n,0,e,r,i)}))},i.functions.average=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("mean",n,0,e,r,i)}))},i.functions.mean=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("mean",n,0,e,r,i)}))},i.functions.sum=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("sum",n,0,e,r,i)}))},i.functions.min=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("min",n,0,e,r,i)}))},i.functions.max=function(r,n){return i.standardFunctionAsync(r,n,(function(n,t,e){return m("max",n,0,e,r,i)}))},i.functions.count=function(o,f){return i.standardFunctionAsync(o,f,(function(i,o,f){if(r(f,1,1),n(f[0]))return f[0].count(i.abortSignal);if(t(f[0])||e(f[0]))return f[0].length;if(u(f[0]))return f[0].length();throw new Error("Invalid Parameters for Count")}))})}export{j as registerFunctions}