import"./p-fd064341.js";import"./p-c8bc3433.js";import{o as t}from"./p-30eee135.js";import{r as s}from"./p-2c46c687.js";import"./p-84bf99cb.js";import"./p-47e1bd73.js";import"./p-a6945989.js";import"./p-60f5af83.js";import"./p-b392deaf.js";import"./p-4414d64f.js";import"./p-a617738c.js";import"./p-be58da65.js";import"./p-17a8cfc0.js";import"./p-8fd94488.js";import"./p-feee221d.js";import"./p-97ec6ae5.js";class i{constructor(){this._size=[0,0],this._programDesc={vsPath:"post-processing/pp",fsPath:"post-processing/filterEffect",attributes:new Map([["a_position",0]])}}dispose(){this._layerFBOTexture&&(this._layerFBOTexture.dispose(),this._layerFBOTexture=null)}draw(t,s,i){const{width:p,height:e}=s;this._createOrResizeResources(t,p,e);const{context:o,painter:r}=t,{materialManager:a}=r,c=this._programDesc,h=this._quad,m=i.colorMatrix;h.bind();const n=this._layerFBOTexture;o.bindFramebuffer(s),s.copyToTexture(0,0,p,e,0,0,n),o.setBlendingEnabled(!1),o.setStencilTestEnabled(!1);const f=a.getProgram(t,c);o.useProgram(f),o.bindTexture(n,2),f.setUniformMatrix4fv("u_coefficients",m),f.setUniform1i("u_colorTexture",2),h.draw(),o.setBlendingEnabled(!0),o.setBlendFunction(1,771),o.setStencilTestEnabled(!0),h.unbind()}_createOrResizeResources(i,p,e){const{context:o}=i;this._layerFBOTexture&&this._size[0]===p&&this._size[1]===e||(this._size[0]=p,this._size[1]=e,this._layerFBOTexture?this._layerFBOTexture.resize(p,e):this._layerFBOTexture=new t(o,{target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071,samplingMode:9729,flipped:!1,width:p,height:e}),this._quad||(this._quad=new s(o,[-1,-1,1,-1,-1,1,1,1])))}}export{i as Colorize}