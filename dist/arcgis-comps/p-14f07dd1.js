import{ay as e,aA as t,s,t as i,e as r,d as n,i as o,p as l,c as a,j as u,o as c,z as h,af as d,l as p,aB as g,aC as m,M as f,y as v,aD as y,a1 as w,_,A as b,H as S,D as x,aE as k,a0 as j,ah as M,Q as I,V as R,at as T,K as P,a8 as C,ad as $,S as E,r as A,u as L,m as F,$ as N,a as D,F as O,T as B,P as K,k as z,aF as G,G as U,g as V,aG as H,aH as W}from"./p-e58503d5.js";import{i as Z,m as Y}from"./p-5d962998.js";import{f as q}from"./p-78a21eae.js";import{t as Q}from"./p-b8beb0d3.js";import{h as J}from"./p-54330161.js";import{M as X}from"./p-93765525.js";import{n as ee,m as te,S as se,c as ie}from"./p-8bc9b36a.js";import{B as re}from"./p-efbca0ca.js";import{e as ne}from"./p-ca657fcf.js";import{r as oe}from"./p-8747982c.js";import{H as le}from"./p-01e5a461.js";import{v as ae}from"./p-b79fcce3.js";import{c as ue}from"./p-fd584619.js";import{e as ce,n as he,r as de}from"./p-7ca40eac.js";import{l as pe}from"./p-a87cccba.js";import"./p-181bf7a5.js";import"./p-5400b397.js";import{a as ge,n as me}from"./p-2e37d910.js";import{e as fe}from"./p-b312c1fd.js";import{t as ve}from"./p-2a99994a.js";const ye=new Map([["ar",()=>import("./p-16ad0dfc.js").then((function(e){return e.a}))],["ar-dz",()=>import("./p-fddcd709.js").then((function(e){return e.a}))],["ar-kw",()=>import("./p-f2eb256f.js").then((function(e){return e.a}))],["ar-ly",()=>import("./p-ef9c1745.js").then((function(e){return e.a}))],["ar-ma",()=>import("./p-70d5b5e7.js").then((function(e){return e.a}))],["ar-sa",()=>import("./p-b08bfdee.js").then((function(e){return e.a}))],["ar-tn",()=>import("./p-1f936ce5.js").then((function(e){return e.a}))],["bg",()=>import("./p-60e2f38d.js").then((function(e){return e.b}))],["bs",()=>import("./p-7533b6f6.js").then((function(e){return e.b}))],["ca",()=>import("./p-aa59352a.js").then((function(e){return e.c}))],["cs",()=>import("./p-e772d6a7.js").then((function(e){return e.c}))],["da",()=>import("./p-05d9f8a8.js").then((function(e){return e.d}))],["de",()=>import("./p-1d1b4db5.js").then((function(e){return e.d}))],["de-at",()=>import("./p-f145baa0.js").then((function(e){return e.d}))],["de-ch",()=>import("./p-c7f14494.js").then((function(e){return e.d}))],["el",()=>import("./p-3164b877.js").then((function(e){return e.e}))],["en-au",()=>import("./p-1b7d1fa0.js").then((function(e){return e.e}))],["en-ca",()=>import("./p-883cd024.js").then((function(e){return e.e}))],["en-gb",()=>import("./p-5695c7c3.js").then((function(e){return e.e}))],["en-ie",()=>import("./p-74ccf621.js").then((function(e){return e.e}))],["en-il",()=>import("./p-a7894fbd.js").then((function(e){return e.e}))],["en-in",()=>import("./p-b57f6b3f.js").then((function(e){return e.e}))],["en-nz",()=>import("./p-8998d11f.js").then((function(e){return e.e}))],["en-sg",()=>import("./p-0b53bd5a.js").then((function(e){return e.e}))],["es",()=>import("./p-0dfad8bb.js").then((function(e){return e.e}))],["es-do",()=>import("./p-165fded9.js").then((function(e){return e.e}))],["es-mx",()=>import("./p-f47bb649.js").then((function(e){return e.e}))],["es-us",()=>import("./p-80b45d34.js").then((function(e){return e.e}))],["et",()=>import("./p-58ffe049.js").then((function(e){return e.e}))],["fi",()=>import("./p-d8d5f619.js").then((function(e){return e.f}))],["fr",()=>import("./p-436cddcc.js").then((function(e){return e.f}))],["fr-ca",()=>import("./p-3e14b775.js").then((function(e){return e.f}))],["fr-ch",()=>import("./p-2a5453c8.js").then((function(e){return e.f}))],["he",()=>import("./p-d9e2d38c.js").then((function(e){return e.h}))],["hr",()=>import("./p-c3f81f1a.js").then((function(e){return e.h}))],["hu",()=>import("./p-3c5ac128.js").then((function(e){return e.h}))],["id",()=>import("./p-aa380459.js").then((function(e){return e.i}))],["it",()=>import("./p-c65ead0f.js").then((function(e){return e.i}))],["it-ch",()=>import("./p-bf225600.js").then((function(e){return e.i}))],["ja",()=>import("./p-d855464d.js").then((function(e){return e.j}))],["ko",()=>import("./p-f8aa4459.js").then((function(e){return e.k}))],["lt",()=>import("./p-818ade0e.js").then((function(e){return e.l}))],["lv",()=>import("./p-dd2baee3.js").then((function(e){return e.l}))],["nb",()=>import("./p-ddd76888.js").then((function(e){return e.n}))],["nl",()=>import("./p-94aa0e97.js").then((function(e){return e.n}))],["nl-be",()=>import("./p-16504064.js").then((function(e){return e.n}))],["pl",()=>import("./p-b713a179.js").then((function(e){return e.p}))],["pt",()=>import("./p-d445ea0e.js").then((function(e){return e.p}))],["pt-br",()=>import("./p-597bb6cb.js").then((function(e){return e.p}))],["ro",()=>import("./p-583ecb0d.js").then((function(e){return e.r}))],["ru",()=>import("./p-7080e406.js").then((function(e){return e.r}))],["sk",()=>import("./p-0ac329e3.js").then((function(e){return e.s}))],["sl",()=>import("./p-4b99f69e.js").then((function(e){return e.s}))],["sr",()=>import("./p-c92569dc.js").then((function(e){return e.s}))],["sr-cyrl",()=>import("./p-aa9f2c13.js").then((function(e){return e.s}))],["sv",()=>import("./p-f56cf98c.js").then((function(e){return e.s}))],["th",()=>import("./p-fa14e344.js").then((function(e){return e.t}))],["tr",()=>import("./p-56edeb19.js").then((function(e){return e.t}))],["uk",()=>import("./p-9a1fd51c.js").then((function(e){return e.u}))],["vi",()=>import("./p-297751d0.js").then((function(e){return e.v}))],["zh-cn",()=>import("./p-be50ac5d.js").then((function(e){return e.z}))],["zh-hk",()=>import("./p-7a679e40.js").then((function(e){return e.z}))],["zh-mo",()=>import("./p-ef5f474a.js").then((function(e){return e.z}))],["zh-tw",()=>import("./p-5d95a118.js").then((function(e){return e.z}))]]);async function we(t=e()){const s=(await import("./p-608e235f.js").then((function(e){return e.m}))).default;t=t.toLowerCase();let i=ye.has(t);if(!i){const e=t.split("-");e.length>1&&ye.has(e[0])&&(t=e[0],i=!0)}return i?await ye.get(t)():t="en",t!==s.locale()&&s.locale(t),s}function _e(e){const t=[/٠/g,/١/g,/٢/g,/٣/g,/٤/g,/٥/g,/٦/g,/٧/g,/٨/g,/٩/g];for(let s=0;s<10;s++)e=e.replace(t[s],s.toString());return Number(e)}function be(e){return new s(`could not parse date input, expecting the following format: ${i(Date.now(),e)}`)}let Se=class extends l{constructor(){super(...arguments),this.state="ready",this.value=new Date}};r([n()],Se.prototype,"state",void 0),r([n()],Se.prototype,"value",void 0),Se=r([o("esri.widgets.support.MomentElementViewModel")],Se);const xe=Se;let ke=class extends xe{constructor(e){super(e)}};ke=r([o("esri.widgets.support.DatePickerViewModel")],ke);const je=ke,Me="esri-date-picker__week-item",Ie="esri-date-picker__day-item",Re="esri-date-picker__year-picker-item",Te={year:"numeric",month:"2-digit",day:"2-digit"},Pe=[" ","ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Enter","Home","PageDown","PageUp"],Ce="esri.widgets.support.DatePicker",$e=a.getLogger(Ce);let Ee=class extends h{constructor(e,t){super(e,t),this._activeDate=null,this._calendarNode=null,this._calendarPopover=new q({owner:this,placement:"bottom-start",anchorElement:()=>this._rootNode,renderContentFunction:this._renderCalendar}),this._inputOrButtonNode=null,this._isOpen=!1,this._requestDayPickerFocusOnCreate=!1,this._rootNode=null,this.dateInputEnabled=!1,this.label=void 0,this.messages=null,this.value=null,this.commitOnMonthChange=!1,this.viewModel=new je,this._toggle=this._toggle.bind(this)}initialize(){this.own(Z((()=>{var e;return{viewModel:this.viewModel,value:null==(e=this.viewModel)?void 0:e.value}}),(({viewModel:e,value:t})=>{this.destroyed||!e||d(this.onChange)||this.onChange(t)}),Y))}async loadLocale(){this._moment=await we(),this._isOpen&&(this._activeDate=this._moment(this._activeDate.toDate()))}destroy(){this._calendarPopover.destroy()}render(){return p("div",{afterCreate:g,bind:this,class:this.classes("esri-date-picker","esri-widget"),"data-node-ref":"_rootNode"},this.dateInputEnabled?this.renderInputAndButtonMode():this.renderButtonOnlyMode())}renderButtonOnlyMode(){const e=i(this.viewModel.value,Te),{_isOpen:t,messages:s}=this;return p("div",{afterCreate:g,"aria-controls":t?this._getCalendarId():null,"aria-expanded":t.toString(),"aria-haspopup":"true","aria-label":s.setDate,"aria-pressed":t.toString(),bind:this,class:this.classes("esri-widget--button","esri-select","esri-date-picker__calendar-toggle"),"data-node-ref":"_inputOrButtonNode",onclick:this._toggle,onkeydown:this._handleDateButtonKeyDown,role:"button",tabIndex:0},p("span",{class:"esri-date-picker__date"},e))}renderInputAndButtonMode(){const e=i(this.viewModel.value,Te),{_isOpen:t,messages:s}=this;return p("div",{class:this.classes("esri-date-picker__input")},p("input",{afterCreate:g,"data-node-ref":"_inputOrButtonNode","aria-controls":t?this._getCalendarId():null,"aria-haspopup":"true","aria-label":s.setDate,bind:this,class:this.classes("esri-date-picker__text-input","esri-input"),key:"date-input",onblur:this._handleDateInputBlur,onclick:this._handleDateInputClick,onkeydown:this._handleDateInputKeyDown,type:"text",value:e}),p("span",{"aria-hidden":"true",class:this.classes("esri-date-picker__icon--leading","esri-icon-calendar")}))}_handleDateInputClick(){this._open(this.viewModel.value,!1)}_handleDateInputKeyDown(e){const{key:t}=e;this._isOpen?"Enter"===t?this._handleDateText(e):"Escape"===t&&this._close():"ArrowDown"===t&&(this._open(this.viewModel.value),e.preventDefault())}_handleDateButtonKeyDown(e){const{key:t,shiftKey:s}=e;this._isOpen&&"Tab"===t&&s?this._close():m(t)&&this._toggle()}_handleDateInputBlur(e){this._isOpen||this._handleDateText(e)}_handleDateText(e){const s=e.currentTarget;let r;try{r=function(e,s){const i=t(s),r=Date.now(),n=i.formatToParts(r),o=new Set;n.filter((({type:e})=>"literal"===e)).forEach((({value:e})=>o.add(e)));let l=0;const a={};for(;n.length>0;){const{type:t,value:s}=n.shift();for(let i=0;i<s.length;i++,l++){const s=e.charAt(l);if(o.has(s)){l++;break}if("literal"===t)break;a[t]||(a[t]=[]),a[t].push(s)}}const u={};try{u.day=_e(a.day.join("")),u.month=_e(a.month.join(""))-1,u.year=_e((a.year||a.relatedYear).join(""))}catch(e){throw be(s)}if(isNaN(u.day)||isNaN(u.month)||isNaN(u.year))throw be(s);return u}(s.value,Te)}catch(e){return $e.warn(e),void(s.value=i(this.viewModel.value,Te))}const n=this._moment(r);n.isValid()?(this.viewModel.value=n.toDate(),this._activeDate=n):s.value=i(this.viewModel.value,Te)}_handleDatePickerKeydown(e){"Escape"===f(e)&&(this._close(),e.preventDefault(),e.stopPropagation())}_renderCalendar(){const e=this._activeDate,t=this._moment(this.viewModel.value);return p("div",{afterCreate:g,bind:this,class:this.classes("esri-date-picker__calendar","esri-widget"),"data-node-ref":"_calendarNode",id:this._getCalendarId(),key:"esri-date-picker__calendar",onkeydown:this._handleDatePickerKeydown},this._renderMonthPicker(e),this._renderDayPicker(e,t),this._renderYearPicker(e))}_getCalendarId(){return`date-picker__calendar--${this.id}`}_renderMonthPicker(e){const t=v(this.container),s=t?"esri-icon-right":"esri-icon-left",i=t?"esri-icon-left":"esri-icon-right",r=this._moment.months().map(((t,s)=>{const i=e.month()===s;return p("option",{selected:i},t)})),{messages:n}=this;return p("div",{class:"esri-date-picker__month-picker"},p("div",{"aria-label":n.goToPreviousMonth,bind:this,class:"esri-widget--button",onclick:this._setPreviousMonth,onkeydown:this._handlePreviousMonthKeyDown,role:"button",tabIndex:0,title:n.goToPreviousMonth},p("span",{"aria-hidden":"true",class:s})),p("select",{"aria-live":"assertive","aria-label":n.selectMonth,bind:this,class:this.classes("esri-date-picker__month-dropdown","esri-select"),id:`${this.id}__month-picker`,onchange:this._setMonth,onkeydown:this._setMonth,title:n.selectMonth},r),p("div",{"aria-label":n.goToNextMonth,bind:this,class:"esri-widget--button",onclick:this._setNextMonth,onkeydown:this._setNextMonth,role:"button",tabIndex:0,title:n.goToNextMonth},p("span",{"aria-hidden":"true",class:i})))}_renderDayPicker(e,t){const s=e.clone().day(this._moment.localeData().firstDayOfWeek()),i=this._getWeekLabels(s),r=this._getDayId(e),n=this._renderMonth(e,t);return p("div",{afterCreate:this._handleDayPickerCreate,"aria-activedescendant":r,"aria-labelledby":`${this.id}__month-picker ${this.id}__selected-year`,bind:this,class:"esri-date-picker__day-picker",id:`${this.id}__day-picker`,onkeydown:this._handleDayPickerKeydown,role:"grid",tabIndex:0},p("div",{class:Me,role:"row"},i.map((e=>p("div",{"aria-label":e.name,class:this.classes(Ie,"esri-date-picker__day-item--header"),role:"columnheader",title:e.name},e.abbr)))),n)}_getDayId(e){return`${this.id}__${i(e.valueOf(),Te)}`}_handleDayPickerCreate(e){this._requestDayPickerFocusOnCreate&&(this._requestDayPickerFocusOnCreate=!1,e.focus())}_getWeekLabels(e){const t=[],s={weekday:"long"},r={weekday:"narrow"};for(let n=0;n<7;n++)t.push({name:i(e.valueOf(),s),abbr:i(e.valueOf(),r)}),e.add(1,"day");return t}_handleDayPickerKeydown(e){const{ctrlKey:t,shiftKey:s}=e,i=f(e),r=this._activeDate;-1!==Pe.indexOf(i)&&("ArrowLeft"===i?r.subtract(1,"day"):"ArrowRight"===i?r.add(1,"day"):"ArrowUp"===i?r.subtract(1,"week"):"ArrowDown"===i?r.add(1,"week"):"PageUp"===i?r.subtract(1,s?"year":"month"):"PageDown"===i?r.add(1,s?"year":"month"):"Home"===i?r.startOf(t?"year":"month"):"End"===i?r.endOf(t?"year":"month"):m(i)&&(this.viewModel.value=r.toDate(),this._close()),e.preventDefault(),e.stopPropagation())}_renderMonth(e,t){const s=this._moment(),i=e.clone().startOf("month"),r=e.clone().endOf("month"),n=i.clone().subtract(i.weekday(),"day"),o=[];for(let l=0;l<6;l++){const l=[];for(let o=0;o<7;o++){const o=n.date(),a=n.isSame(e,"day"),u=n.isSame(t,"day"),c=this._getDayId(n),h={"esri-date-picker__day-item--nearby-month":!n.isBetween(i,r,null,"[]"),"esri-date-picker__day-item--today":n.isSame(s,"day"),"esri-date-picker__day-item--active":a,"esri-date-picker__day-item--selected":u};l.push(p("div",{"aria-label":o.toString(),"aria-selected":a.toString(),bind:this,class:this.classes(Ie,h),"data-iso-date":n.toISOString(),id:c,onclick:this._handleSelectedDate,onkeydown:this._handleSelectedDate,role:"gridcell"},o)),n.add(1,"day")}o.push(p("div",{class:Me,role:"row"},l))}return o}_renderYearPicker(e){const t={year:"numeric"},s=e.clone(),r=i(s.valueOf(),t),n=i(s.add(1,"year").valueOf(),t),o=i(s.subtract(2,"year").valueOf(),t),{messages:l}=this;return p("div",{class:"esri-date-picker__year-picker"},p("div",{"aria-label":l.goToPreviousYear,bind:this,class:Re,onclick:this._setPreviousYear,onkeydown:this._setPreviousYear,tabIndex:0,title:l.goToPreviousYear},o),p("div",{class:this.classes(Re,"esri-date-picker__year-picker-item--selected"),id:`${this.id}__selected-year`},r),p("div",{"aria-label":l.goToNextYear,bind:this,class:Re,onclick:this._setNextYear,onkeydown:this._handleNextYearKeyDown,tabIndex:0,title:l.goToNextYear},n))}_toggle(){this._isOpen?this._close():this._open(this.viewModel.value)}_setMonth(e){this._activeDate.month(e.target.value),this.commitOnMonthChange&&(this.viewModel.value=this._activeDate.toDate())}_close(e=!0){this._activeDate=null,this._isOpen=!1,this._calendarPopover.open=!1,this.pageClickHandler.pause(),e&&this._inputOrButtonNode.focus()}_open(e,t=!0){this._activeDate=this._moment(e),this._isOpen=!0,this._calendarPopover.open=!0,this._requestDayPickerFocusOnCreate=t,this.pageClickHandler||(this.pageClickHandler=y(document,"click",(({target:e})=>{var t,s;(null==(t=this._calendarNode)?void 0:t.contains(e))||(null==(s=this._rootNode)?void 0:s.contains(e))||this._close()})),this.own(this.pageClickHandler)),this.pageClickHandler.resume()}_setPreviousMonth(){this._activeDate.subtract(1,"month"),this.commitOnMonthChange&&(this.viewModel.value=this._activeDate.toDate())}_handlePreviousMonthKeyDown(e){if("Tab"===e.key&&e.shiftKey)return e.preventDefault(),void this._close();m(e.key)&&this._setPreviousMonth()}_setNextMonth(){this._activeDate.add(1,"month"),this.commitOnMonthChange&&(this.viewModel.value=this._activeDate.toDate())}_setPreviousYear(){this._activeDate.subtract(1,"year")}_setNextYear(){this._activeDate.add(1,"year")}_handleNextYearKeyDown(e){if("Tab"===e.key&&!e.shiftKey)return e.preventDefault(),void this._close();m(e.key)&&this._setNextYear()}_handleSelectedDate(e){this.viewModel.value=this._moment(e.target.getAttribute("data-iso-date")).toDate(),this._close()}};r([n()],Ee.prototype,"dateInputEnabled",void 0),r([n({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Ee.prototype,"label",void 0),r([n(),u("esri/widgets/support/t9n/DatePicker")],Ee.prototype,"messages",void 0),r([c("viewModel.value")],Ee.prototype,"value",void 0),r([n()],Ee.prototype,"commitOnMonthChange",void 0),r([n({type:je})],Ee.prototype,"viewModel",void 0),r([n()],Ee.prototype,"onChange",void 0),r([Q()],Ee.prototype,"_setNextMonth",null),r([Q()],Ee.prototype,"_setPreviousYear",null),r([Q()],Ee.prototype,"_handleSelectedDate",null),Ee=r([o(Ce)],Ee);const Ae=Ee;let Le=class extends xe{constructor(e){super(e)}};Le=r([o("esri.widgets.support.TimePickerViewModel")],Le);const Fe=Le,Ne={hour:"numeric",minute:"numeric"},De=["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","Tab"];function Oe(e){return i(e.valueOf(),Ne).indexOf(" ")>-1}let Be=class extends h{constructor(e,t){super(e,t),this._activeTime=null,this.label=void 0,this.messages=null,this.value=null,this.viewModel=new Fe}async loadLocale(){this._moment=await we()}render(){const e=this._activeTime||this.viewModel.value;return p("div",{class:"esri-time-picker esri-widget"},p("input",{afterUpdate:this._handleInputUpdate,"aria-label":this.messages.inputTitle,bind:this,class:this.classes("esri-time-picker__input","esri-input"),onblur:this._handleInputBlur,onfocus:this._handleInputFocus,onkeydown:this._handleInputKeydown,oninput:this._handleInputKeydown,onclick:this._handleInputClick,onpaste:this._handleInputPaste,onwheel:this._handleInputWheel,value:i(e.valueOf(),Ne)}))}_handleInputBlur(){this._activeTime.isValid()&&(this.viewModel.value=this._activeTime.toDate()),this._activeTime=null,this._activePart=null}_handleInputUpdate(e){this._selectPart(e,this._activePart)}_selectPart(e,t){const s=this._activeTime;if(!s)return;const r=i(s.valueOf(),Ne),n=r.indexOf(":");if("hours"===t)return void e.setSelectionRange(0,n);const o=n+1,l=o+2;"minutes"!==t?"meridiem"!==t||e.setSelectionRange(l+1,r.length):e.setSelectionRange(o,l)}_handleInputFocus(e){this._activePart="hours",this._activeTime=this._moment(this.viewModel.value).startOf("minute"),this._selectPart(e.target,"hours")}_caretIndexToPartName(e){const t=this._activeTime.format("LT"),s=t.indexOf(":"),i=t.indexOf(" ");return e<=s?"hours":e>s&&e<=i?"minutes":"meridiem"}_handleInputKeydown(e){const{ctrlKey:t,metaKey:s,shiftKey:i}=e,r=f(e),n=this._activeTime,o=this._activePart,l=/\d/.test(r),a=/^a|p$/i.test(r),u=s||t;if(De.indexOf(r)>-1||l||"meridiem"===o&&a&&!u){if("ArrowLeft"===r)this._activePart=this._prevPart();else if("ArrowRight"===r)this._activePart=this._nextPart();else if("Tab"===r){const e=i?this._prevPart():this._nextPart();if(e===this._activePart)return;this._activePart=e}else if("ArrowUp"===r)this._shift("up",n,o);else if("ArrowDown"===r)this._shift("down",n,o);else if(l)this._setTime(n,o,Number(r));else if(a){const e=r.toLowerCase(),t=n.hour();("a"===e&&t>=12||"p"===e&&t<12)&&this._shift("up",n,o)}e.preventDefault(),e.stopImmediatePropagation()}else u||(e.preventDefault(),e.stopImmediatePropagation())}_handleInputClick(e){const t=e.target;this._activePart=null,this.renderNow(),this._activePart=this._caretIndexToPartName(t.selectionStart)}_getOrderedParts(){return Oe(this._activeTime)?["hours","minutes","meridiem"]:["hours","minutes"]}_prevPart(){const e=this._getOrderedParts(),t=e.indexOf(this._activePart)-1;return e[Math.max(t,0)]}_nextPart(){const e=this._getOrderedParts(),t=e.indexOf(this._activePart)+1;return e[Math.min(t,e.length-1)]}_setTime(e,t,s){if("hours"===t){const t=Oe(e)?12:24,i=""+e.hour()%t,r=s,n=Number(`${i}${s}`);2===i.length||n>t?e.hour(r):n<=t&&e.hour(n)}else if("minutes"===t){const t=59,i=`${e.minute()}`,r=s,n=Number(`${i}${s}`);2===i.length||n>t?e.minute(r):n<t&&e.minute(n)}}_handleInputPaste(e){const t=e.clipboardData.getData("text/plain"),s=this._moment(t);s.isValid()&&(this._activeTime=s),e.preventDefault(),e.stopImmediatePropagation()}_handleInputWheel(e){this._shift(e.deltaY<0?"up":"down",this._activeTime,this._activePart)}_shift(e,t,s){e&&t&&s&&t["up"===e?"add":"subtract"]("meridiem"===s?12:1,"hours"===s?"hour":"minutes"===s?"minute":"hours")}};r([n({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],Be.prototype,"label",void 0),r([n(),u("esri/widgets/support/t9n/TimePicker")],Be.prototype,"messages",void 0),r([c("viewModel.value")],Be.prototype,"value",void 0),r([n({type:Fe})],Be.prototype,"viewModel",void 0),Be=r([o("esri.widgets.support.TimePicker")],Be);const Ke=Be;let ze=class extends(oe(w)){constructor(e){super(e),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suggestionsEnabled=null,this.suffix="",this.withinViewEnabled=!1,this.zoomScale=null}};r([n()],ze.prototype,"autoNavigate",void 0),r([n()],ze.prototype,"filter",void 0),r([n()],ze.prototype,"getResults",void 0),r([n()],ze.prototype,"getSuggestions",void 0),r([n()],ze.prototype,"maxResults",void 0),r([n()],ze.prototype,"maxSuggestions",void 0),r([n()],ze.prototype,"minSuggestCharacters",void 0),r([n()],ze.prototype,"outFields",void 0),r([n()],ze.prototype,"placeholder",void 0),r([n()],ze.prototype,"popupEnabled",void 0),r([n()],ze.prototype,"popupTemplate",void 0),r([n()],ze.prototype,"prefix",void 0),r([n()],ze.prototype,"resultGraphicEnabled",void 0),r([n()],ze.prototype,"resultSymbol",void 0),r([n()],ze.prototype,"suggestionsEnabled",void 0),r([n()],ze.prototype,"suffix",void 0),r([n()],ze.prototype,"withinViewEnabled",void 0),r([n()],ze.prototype,"zoomScale",void 0),ze=r([o("esri.widgets.Search.SearchSource")],ze);const Ge=ze,Ue=a.getLogger("esri.widgets.Search.support.geometryUtils");function Ve(e,t){var i,r;if(!t)return Ue.error("missing-parameter: view is missing."),Promise.reject(new s("searchgeometryutils:missing-parameter","view is missing."));if(!e)return Ue.error("missing-parameter: point is missing."),Promise.reject(new s("searchgeometryutils:missing-parameter","point is missing."));if(e.hasZ||"2d"===t.type)return Promise.resolve(e);const n=null==t||null==(i=t.map)?void 0:i.ground;return n&&n.layers.length?n.queryElevation(e,{cache:null==(r=t.basemapTerrain)?void 0:r.elevationQueryCache}).then((e=>e.geometry)):Promise.resolve(e)}function He(e){if(d(e))return null;switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":return e.getPoint(0);case"polyline":return e.getPoint(0,0)}return null}function We(e,t,s){return d(e)?null:"extent"===e.type?e:"multipoint"===e.type||"polygon"===e.type||"polyline"===e.type?e.extent:"point"===e.type?Ye(e,t,s):void 0}function Ze(e,t,s){return d(e)||d(t)?null:Ye(e.center,t,s)}function Ye(e,t,s){const i=e.hasZ?e.z:void 0;return t&&t.map?(s?ue(t,s):t.extent).clone().centerAt(e).set({zmax:i,zmin:i}):new _({xmin:e.x-.25,ymin:e.y-.25,xmax:e.x+.25,ymax:e.y+.25,spatialReference:e.spatialReference,zmin:i,zmax:i})}const qe=/https?:\/\/services.*\.arcgis\.com/i,Qe=/(?:\{([^}]+)\})/g,Je=a.getLogger("esri.widgets.Search.support.layerSearchUtils");function Xe(e,t){const{filter:s,withinViewEnabled:i}=e,r=t&&t.extent;return s&&s.geometry||(i&&r?r:void 0)}function et(e){return e&&-1!==e.indexOf("*")}async function tt(e){e&&await e.load()}function st(e){var t,s,i;return null!=(t=null==e||null==(s=e.capabilities)||null==(i=s.query)?void 0:i.supportsPagination)&&t}function it(e){return e.displayField||e.layer.displayField||function(e){var t,s,i,r;return null!=(t=null==e||null==(s=e.fieldsIndex)||null==(i=s.fields)||null==(r=i.find((e=>"string"===e.type)))?void 0:r.name)?t:""}(e.layer)}function rt(e,t){return!(!e||!t)&&t.every((t=>nt(e,t)))}function nt(e,t){return!!e.getField(t)}function ot(e){return e.replace(/\'/g,"''")}function lt(e,t){const s=t&&t.where;return s?`(${e}) AND (${s})`:e}function at({searchTerm:e,layer:t,searchFields:s,filter:i,exactMatch:r,type:n}){const{definitionExpression:o,url:l}=t;let a="";return e&&s&&s.forEach((s=>{const o=t.getField(s),u="function"==typeof t.getFieldDomain&&t.getFieldDomain(s),c=(u&&"coded-value"===u.type?function(e,t,s){let i=null;const{codedValues:r}=e;return r&&r.some((e=>{const r=e.name,n=s?r:r.toLowerCase();return(s?t:t.toLowerCase())===n&&(i=e.code.toString(),!0)})),i}(u,e,r):null)||e||null;if(null!==c){const e=function({currentTerm:e,field:t,filter:s,exactMatch:i,url:r,type:n}){const o=t.type,l=t.name;if("string"===o||"date"===o||"global-id"===o){const t=qe.test(r),o=t&&function(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return!0;return!1}(e)?"N":"";if(i&&"search"===n)return lt(`${l} = ${o}'${e}'`,s);const a=t?l:`UPPER(${l})`,u=t?e:e.toUpperCase();return lt(`${a} LIKE ${o}${i?`'${u}%'`:`'%${u}%'`}`,s)}if("oid"===o||"small-integer"===o||"integer"===o||"single"===o||"double"===o){const t=Number(e);return isNaN(t)?null:lt(`${l} = ${t}`,s)}return lt(`${l} = ${e}`,s)}({currentTerm:c,field:o,filter:i,exactMatch:r,url:l,type:n});e&&(a+=function(e,t){return e?` OR (${t})`:`(${t})`}(a,e))}})),o?`(${o}) AND (${a})`:a}function ut(e,t,s){const r=e.sourceLayer,{attributes:n}=e,o="function"==typeof r.getFieldDomain&&r.getFieldDomain(s);if(t)return S(t,n);if(s&&n){const e=r.getField(s),t=function(e,t){return e[Object.keys(e).find((e=>e.toLowerCase()===t.toLowerCase()))]}(n,s);return null==t?"":o&&"coded-value"===o.type?function(e,t){let s=null;const{codedValues:i}=e;return i&&i.length&&i.some((e=>e.code===t&&(s=e.name,!0))),s}(o,t):"date"===(null==e?void 0:e.type)?i(new Date(t)):"number"==typeof t?t.toString():"string"!=typeof t?"":t.trim()}return""}function ct(e,t,s,i,r,n,o){return e.features.map((e=>function(e,t,s,i,r,n,o){const l=e.clone(),a=e.sourceLayer,u=a&&a.objectIdField,c=u&&e.attributes[u],h=ut(e,s.searchTemplate,r),d=We(l.geometry,t,n),p="number"==typeof o?Ze(x(d),t,o):d,g=e.clone();return b(p)&&(g.geometry=ae.fromExtent(p)),{extent:p,target:g,feature:l,key:c,name:h,sourceIndex:i}}(e,t,s,i,r,n,o)))}var ht;let dt=ht=class extends Ge{constructor(e){super(e),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,t)=>function(e,t){const{exactMatch:i=!1,location:r,maxResults:n,spatialReference:o,source:l,sourceIndex:a,suggestResult:u,view:c}=e,{layer:h,filter:d,zoomScale:p}=l,g=c&&c.scale,m=Xe(l,c),f=t&&t.signal;return tt(h).then((()=>{const e=h.popupTemplate;return e?e.getRequiredFields(h.fieldsIndex):null})).then((e=>{var t,v;const{objectIdField:y,returnZ:w}=h,_=it(l);if(!nt(h,_))throw Je.error("invalid-field: displayField is invalid."),new s("getResults():invalid-field","displayField is invalid.");const b=l.outFields||(e&&e.length?e:[_]),S=et(b);if(-1!==b.indexOf(y)||S||b.push(y),!S&&!rt(h,b))throw Je.error("invalid-field: outField is invalid."),new s("getResults():invalid-field","outField is invalid.");const x=h.createQuery(),{orderByFields:k}=l;if(k&&(x.orderByFields=k),o){x.outSpatialReference=o;const e=1/le(o);e&&(x.maxAllowableOffset=e)}const j="mesh"===h.geometryType||"multipatch"===h.geometryType,M=(null==(t=h.capabilities)||null==(v=t.data)?void 0:v.supportsZ)&&!j;if(x.returnZ=M&&!1!==w,x.returnGeometry=!0,x.multipatchOption=j?"xyFootprint":null,b&&(x.outFields=b),r)x.geometry=r;else if(u.key)x.objectIds=[u.key];else{const e=l.searchFields||[_];if(!rt(h,e))throw Je.error("invalid-field: search field is invalid."),new s("getResults():invalid-field","search field is invalid.");if(st(h)&&(x.num=n),m&&(x.geometry=m),!u.text.trim())return[];const{prefix:t="",suffix:r=""}=l,o=at({searchTerm:ot(`${t}${u.text}${r}`),layer:h,searchFields:e,filter:d,exactMatch:i,type:"search"});if(!o)return[];x.where=o}return h.queryFeatures(x,{signal:f}).then((e=>ct(e,c,l,a,_,g,p)))}))}({source:this,...e},t),this.getSuggestions=(e,t)=>function(e,t){const{source:i,spatialReference:r,view:n,suggestTerm:o,maxSuggestions:l,sourceIndex:a,exactMatch:u}=e,{layer:c,filter:h}=i,d=t&&t.signal,p=Xe(i,n);return tt(c).then((()=>{if(!st(c))return[];const e=it(i),t=i.searchFields||[e],n=[];i.suggestionTemplate?i.suggestionTemplate.replace(Qe,((e,t)=>(n.push(t),e))):n.push(e);const g=et(n);-1!==n.indexOf(c.objectIdField)||g||n.push(c.objectIdField);const m=nt(c,e),f=g||rt(c,n),v=rt(c,t);if(!m)throw Je.error("invalid-field: displayField is invalid."),new s("getSuggestions():invalid-field","displayField is invalid.");if(!f)throw Je.error("invalid-field: outField is invalid."),new s("getSuggestions():invalid-field","outField is invalid.");if(!v)throw Je.error("invalid-field: search field is invalid."),new s("getSuggestions():invalid-field","search field is invalid.");const y=c.createQuery(),{orderByFields:w}=i;if(w&&(y.orderByFields=w),y.outSpatialReference=r,y.returnGeometry=!1,y.num=l,y.outFields=n,p&&(y.geometry=p),!o.trim())return[];const{prefix:_="",suffix:b=""}=i,S=at({searchTerm:ot(`${_}${o}${b}`),layer:c,searchFields:t,filter:h,exactMatch:u,type:"suggest"});return S?(y.where=S,c.queryFeatures(y,{signal:d}).then((t=>function(e,t,s,i){return e.features.map((e=>function(e,t,s,i){const r=e.sourceLayer,{attributes:n}=e,{objectIdField:o}=r,l=n[o];return{text:ut(e,t.suggestionTemplate,i),key:l,sourceIndex:s}}(e,t,s,i)))}(t,i,a,e)))):[]}))}({source:this,...e},t)}set layer(e){this._set("layer",e),e&&e.load().catch((()=>{}))}get name(){return this._getLayerTitle()||""}set name(e){void 0!==e?this._override("name",e):this._clearOverride("name")}clone(){return new ht({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?x(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?x(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){var e,t;return null!=(e=null==(t=this.layer.fieldsIndex.fields.find((e=>"string"===e.type)))?void 0:t.name)?e:""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:e,searchFields:t}=this;return e.loaded?`: ${(t||[this._getDisplayField()]).map((t=>{const s=e.getField(t);return s&&s.alias||t})).join(", ")}`:""}_getLayerTitle(){const{layer:e}=this;if(!e)return;const{title:t}=e;return t?`${t}${this._getSearchFieldsString()}`:void 0}};r([n({json:{read:{source:"field.name"},write:{target:"field.name"}}})],dt.prototype,"displayField",void 0),r([n({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],dt.prototype,"exactMatch",void 0),r([n({value:null})],dt.prototype,"layer",null),r([n()],dt.prototype,"name",null),r([n({type:[String],json:{write:!0}})],dt.prototype,"orderByFields",void 0),r([n()],dt.prototype,"searchFields",void 0),r([n()],dt.prototype,"searchTemplate",void 0),r([n()],dt.prototype,"suggestionTemplate",void 0),dt=ht=r([o("esri.widgets.Search.LayerSearchSource")],dt);const pt=dt;let gt=class extends w{constructor(e){super(e),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null}};r([n({type:String,json:{write:!0}})],gt.prototype,"address",void 0),r([n({type:Object,json:{write:!0}})],gt.prototype,"attributes",void 0),r([n({type:_,json:{write:!0}})],gt.prototype,"extent",void 0),r([n({type:k,json:{write:!0}})],gt.prototype,"location",void 0),r([n({type:Number,json:{write:!0}})],gt.prototype,"score",void 0),gt=r([o("esri.rest.support.AddressCandidate")],gt);const mt=gt,ft={type:String,json:{read:{source:"token"},write:{target:"token"}}};let vt=class extends w{constructor(e){super(e),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null}};r([n({type:Object,json:{write:!0}})],vt.prototype,"address",void 0),r([n(ft)],vt.prototype,"apiKey",void 0),r([n({type:[String],json:{read:{source:"category",reader:e=>e?e.split(","):null},write:{target:"category",writer:(e,t)=>{t.category=e?e.join(","):null}}}})],vt.prototype,"categories",void 0),r([n({type:String,json:{write:!0}})],vt.prototype,"countryCode",void 0),r([n({type:Boolean,json:{write:!0}})],vt.prototype,"forStorage",void 0),r([n({type:k,json:{write:{writer:(e,t)=>{t.location=e?e.clone().normalize():null}}}})],vt.prototype,"location",void 0),r([n({type:String,json:{write:!0}})],vt.prototype,"locationType",void 0),r([n({type:String,json:{write:!0}})],vt.prototype,"magicKey",void 0),r([n({type:Number,json:{write:!0}})],vt.prototype,"maxLocations",void 0),r([n({type:[String],json:{write:{writer:(e,t)=>{t.outFields=e?e.join(","):null}}}})],vt.prototype,"outFields",void 0),r([n({type:j,json:{read:{source:"outSR"},write:{target:"outSR"}}})],vt.prototype,"outSpatialReference",void 0),r([n({type:_,json:{write:{writer:(e,t)=>{const s=e?e.shiftCentralMeridian():null;t.searchExtent=s}}}})],vt.prototype,"searchExtent",void 0),vt=r([o("esri.rest.support.AddressToLocationsParameters")],vt),vt.from=M(vt);const yt=vt;async function wt(e,t,s){t=yt.from(t);const i=ce(e),{address:r,...n}=t.toJSON(),o={...r,...n,f:"json"},l=he({...i.query,...o}),a=de(l,s);return I(`${i.path}/findAddressCandidates`,a).then(_t)}function _t({data:e}){if(!e)return[];const{candidates:t,spatialReference:s}=e;return t?t.map((e=>{if(!e)return;const{extent:t,location:i}=e,r=!t||(n=t)&&"number"==typeof n.xmin&&"number"==typeof n.ymin&&"number"==typeof n.xmax&&"number"==typeof n.ymax;var n;return function(e){return e&&"number"==typeof e.x&&"number"==typeof e.y}(i)&&r?(t&&(t.spatialReference=s),i.spatialReference=s,mt.fromJSON(e)):void 0})):[]}let bt=class extends w{constructor(e){super(e),this.addresses=null,this.categories=null,this.countryCode=null,this.locationType=null,this.outSpatialReference=null}};r([n({type:[Object],json:{read:{reader:e=>e&&e.records?e.records.map((e=>e.attributes)):null},write:{writer:(e,t)=>{const s=[];Array.isArray(e)&&e.forEach((e=>{s.push({attributes:e})})),t.addresses={records:s}}}}})],bt.prototype,"addresses",void 0),r([n({type:[String],json:{read:{source:"category",reader:e=>e?e.split(","):null},write:{target:"category",writer:(e,t)=>{t.category=e?e.join(","):null}}}})],bt.prototype,"categories",void 0),r([n({type:String,json:{read:{source:"sourceCountry"},write:{target:"sourceCountry"}}})],bt.prototype,"countryCode",void 0),r([n({type:String,json:{write:!0}})],bt.prototype,"locationType",void 0),r([n({type:j,json:{read:{source:"outSR"},write:{target:"outSR"}}})],bt.prototype,"outSpatialReference",void 0),bt=r([o("esri.rest.support.AddressesToLocationsParameters")],bt),bt.from=M(bt);const St=bt;function xt(e){const{data:t}=e;if(!t)return[];const{locations:s,spatialReference:i}=t;return s?s.map((e=>{const{location:t}=e;return t&&(t.spatialReference=i),mt.fromJSON(e)})):[]}let kt=class extends w{constructor(e){super(e),this.apiKey=null,this.location=null,this.locationType=null,this.outSpatialReference=null}};r([n(ft)],kt.prototype,"apiKey",void 0),r([n({type:k,json:{write:{writer:(e,t)=>{const s=e?e.clone().normalize():null;t.location=void 0!==s?s:null}}}})],kt.prototype,"location",void 0),r([n({type:String,json:{write:!0}})],kt.prototype,"locationType",void 0),r([n({type:j,json:{read:{source:"outSR"},write:{target:"outSR"}}})],kt.prototype,"outSpatialReference",void 0),kt=r([o("esri.rest.support.LocationToAddressParameters")],kt),kt.from=M(kt);const jt=kt;async function Mt(e,t,s){t=jt.from(t);const i=ce(e),r={...t.toJSON(),f:"json"},n=he({...i.query,...r}),o=de(n,s);return I(`${i.path}/reverseGeocode`,o).then(It)}function It({data:e}){if(!e)return;const{address:t,location:s}=e;return mt.fromJSON({address:t&&t.Match_addr||"",attributes:t||{},location:s,score:100})}let Rt=class extends w{constructor(e){super(e),this.isCollection=null,this.magicKey=null,this.text=null}};r([n({type:Boolean,json:{write:!0}})],Rt.prototype,"isCollection",void 0),r([n({type:String,json:{write:!0}})],Rt.prototype,"magicKey",void 0),r([n({type:String,json:{write:!0}})],Rt.prototype,"text",void 0),Rt=r([o("esri.rest.support.SuggestionCandidate")],Rt);const Tt=Rt;let Pt=class extends w{constructor(e){super(e),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null}};r([n(ft)],Pt.prototype,"apiKey",void 0),r([n({type:[String],json:{read:{source:"category",reader:e=>e?e.split(","):null},write:{target:"category",writer:(e,t)=>{t.category=e?e.join(","):null}}}})],Pt.prototype,"categories",void 0),r([n({type:String,json:{write:!0}})],Pt.prototype,"countryCode",void 0),r([n({type:k,json:{write:{writer:(e,t)=>{t.location=e?e.clone().normalize():null}}}})],Pt.prototype,"location",void 0),r([n({type:Number,json:{write:!0}})],Pt.prototype,"maxSuggestions",void 0),r([n({type:j,json:{read:{source:"outSR"},write:{target:"outSR"}}})],Pt.prototype,"outSpatialReference",void 0),r([n({type:_,json:{write:{writer:(e,t)=>{const s=e?e.shiftCentralMeridian():null;t.searchExtent=JSON.stringify(s)}}}})],Pt.prototype,"searchExtent",void 0),r([n({type:String,json:{write:!0}})],Pt.prototype,"text",void 0),Pt=r([o("esri.rest.support.SuggestLocationsParameters")],Pt),Pt.from=M(Pt);const Ct=Pt;async function $t(e,t,s){const i=ce(e),r={...(t=Ct.from(t)).toJSON(),f:"json"},n=he({...i.query,...r}),o=de(n,s);return I(`${i.path}/suggest`,o).then(Et)}function Et(e){const{data:t}=e;if(!t)return[];const{suggestions:s}=t;return s?s.map((e=>new Tt(e))):[]}let At=class extends pe{constructor(e){super(e),this.outSpatialReference=null,this.url=null}addressToLocations(e,t){!e.outSpatialReference&&this.outSpatialReference&&(e.outSpatialReference=this.outSpatialReference);const s={...this.requestOptions,...t};return wt(this.url,e,s)}suggestLocations(e,t){const s={...this.requestOptions,...t};return $t(this.url,e,s)}addressesToLocations(e,t){!e.outSpatialReference&&this.outSpatialReference&&(e.outSpatialReference=this.outSpatialReference);const s={...this.requestOptions,...t};return async function(e,t,s){t=St.from(t);const i=ce(e),r={...t.toJSON(),f:"json"},n=he({...i.query,...r}),o=de(n,s);return I(`${i.path}/geocodeAddresses`,o).then(xt)}(this.url,e,s)}locationToAddress(e,t){!e.outSpatialReference&&this.outSpatialReference&&(e.outSpatialReference=this.outSpatialReference);const s={...this.requestOptions,...t};return Mt(this.url,e,s)}};r([n({type:j})],At.prototype,"outSpatialReference",void 0),r([n()],At.prototype,"url",void 0),At=r([o("esri.tasks.Locator")],At);const Lt=At;function Ft(e){const t=null==e?void 0:e.scale;return"number"==typeof t&&t<=3e5?e.get("extent.center"):null}function Nt(e){return!!e&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi.test(e)}const Dt="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";function Ot(e,t){const{filter:s,withinViewEnabled:i}=e,r=t&&t.extent;return We(s&&s.geometry,t,t&&t.scale)||(i&&r?r:void 0)}function Bt(e,t){return e.filter(Boolean).map((e=>function(e,t){const{key:s,scale:i,sourceIndex:r,view:n,zoomScale:o,defaultZoomScale:l}=t,{attributes:a,extent:u,location:c,address:h}=e,d=new J({geometry:c,attributes:a}),p=u||c,g=We(p,n,i),m="number"==typeof o?Ze(g,n,o):"number"==typeof l&&"point"===p.type?Ze(g,n,l):g,f=h||(c?`${c.x},${c.y}`:""),v=d.clone();return b(m)&&(v.geometry=ae.fromExtent(m)),{extent:m,feature:d,target:v,key:s,name:f,sourceIndex:r}}(e,t)))}var Kt;const zt="esri.widgets.Search.LocatorSearchSource",Gt=a.getLogger(zt);let Ut=Kt=class extends Ge{constructor(e){super(e),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(e,t)=>function(e,t){return e.location?function(e,t){const{source:s,spatialReference:i,location:r,sourceIndex:n,view:o}=e,{apiKey:l,url:a,zoomScale:u,defaultZoomScale:c}=s,h=o&&o.scale,d=t&&t.signal,p=new jt;return p.location=r,l&&(p.apiKey=l),i&&(p.outSpatialReference=i),Mt(a,p,{signal:d}).then((e=>Bt([e],{sourceIndex:n,scale:h,view:o,zoomScale:u,defaultZoomScale:c})))}(e,t):function(e,t){const{source:s,suggestResult:i,spatialReference:r,view:n,maxResults:o,sourceIndex:l}=e,a=s&&s.zoomScale,u=s&&s.defaultZoomScale;if(!i.text.trim())return Promise.resolve(null);const c=`${!i.key&&s.prefix?s.prefix:""}${i.text}${!i.key&&s.suffix?s.suffix:""}`,h=new yt,{apiKey:d,url:p}=s,g=n&&n.scale,m=Ot(s,n),f=t&&t.signal;if(d&&(h.apiKey=d),!p)return Promise.resolve(null);s.categories&&(h.categories=s.categories),s.locationType&&(h.locationType=s.locationType),r&&(h.outSpatialReference=r);const v=Ft(n);v&&(h.location=v),h.maxLocations=o,m&&(h.searchExtent=R(m)),s.countryCode&&(h.countryCode=s.countryCode);const{key:y}=i,w=`${y}`;return y&&(h.magicKey=w),h.address={},h.address[s.singleLineFieldName||"Single Line Input"]=c,s.outFields&&(h.outFields=s.outFields),wt(p,h,{signal:f}).then((e=>Bt(e,{key:w,scale:g,sourceIndex:l,view:n,zoomScale:a,defaultZoomScale:u})))}(e,t)}({source:this,...e},t),this.getSuggestions=(e,t)=>function(e,t){const{source:s,spatialReference:i,view:r,suggestTerm:n,maxSuggestions:o,sourceIndex:l}=e,a=new Ct,{apiKey:u,url:c}=s,h=Ot(s,r),d=t&&t.signal;if(!c)return Promise.resolve(null);u&&(a.apiKey=u),s.categories&&(a.categories=s.categories),i&&(a.outSpatialReference=i);const p=Ft(r);if(p&&(a.location=p),!n.trim())return Promise.resolve(null);const{prefix:g="",suffix:m=""}=s;return a.text=`${g}${n}${m}`,h&&(a.searchExtent=R(h)),a.maxSuggestions=o,s.countryCode&&(a.countryCode=s.countryCode),$t(c,a,{signal:d}).then((e=>function(e,t){return e.map((e=>function(e,t){return{text:e.text,key:e.magicKey,sourceIndex:t}}(e,t)))}(e,l)))}({source:this,...e},t)}set locator(e){T(Gt,"locator",{replacement:"url",version:"4.22"}),this._set("url",e.url),this._set("locator",e)}get locator(){return T(Gt,"locator",{replacement:"url",version:"4.22"}),this._get("locator")}clone(){return new Kt({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?x(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?x(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,locator:this.locator,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};r([n()],Ut.prototype,"apiKey",void 0),r([n()],Ut.prototype,"categories",void 0),r([n()],Ut.prototype,"countryCode",void 0),r([n({json:{write:!0}})],Ut.prototype,"defaultZoomScale",void 0),r([n({type:Lt,json:{read:!1,write:!1}})],Ut.prototype,"locator",null),r([n()],Ut.prototype,"locationType",void 0),r([n({json:{write:!0}})],Ut.prototype,"name",void 0),r([n({json:{write:!0}})],Ut.prototype,"placeholder",void 0),r([n()],Ut.prototype,"searchTemplate",void 0),r([n({json:{write:!0}})],Ut.prototype,"singleLineFieldName",void 0),r([n({json:{read:{source:"suggest"},write:{target:"suggest"}}})],Ut.prototype,"suggestionsEnabled",void 0),r([n({json:{write:!0}})],Ut.prototype,"url",void 0),r([n({json:{write:!0}})],Ut.prototype,"zoomScale",void 0),Ut=Kt=r([o(zt)],Ut);const Vt=Ut,Ht=a.getLogger("esri.widgets.support.geolocationUtils"),Wt={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function Zt(){return function(){const e=P("esri-geolocation");return e||Ht.warn("geolocation-unsupported","Geolocation unsupported."),e}()&&function(){const e=window.isSecureContext;return e||Ht.warn("insecure-context","Geolocation requires a secure origin."),e}()}function Yt(e,t){return e.hasOwnProperty(t)&&null!=e[t]&&""!==e[t]}const qt="esri.widgets.Search.SearchViewModel",Qt=a.getLogger(qt),Jt="highlight",Xt=E.ofType({key:e=>e.layer?"layer":"locator",base:Ge,typeMap:{layer:pt,locator:Vt}}),es=j.WGS84,ts=/<(?:.|\s)*?>/g;let ss=class extends(fe(A.EventedMixin(l))){constructor(e){super(e),this._handles=new L,this._gotoController=null,this._searching=null,this.autoNavigate=!0,this.autoSelect=!0,this.defaultPopupTemplate=null,this.defaultSources=new Xt,this.defaultSymbols={point:new ee({url:F(P("trident")?"esri/images/search/search-symbol-32.png":"esri/images/search/search-symbol-32.svg"),size:24,width:24,height:24}),polyline:new te({color:[130,130,130,1],width:2}),polygon:new se({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=re.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new Xt,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null}initialize(){const e=async()=>{const e=await U("esri/widgets/Search/t9n/Search");this.messages=e,this.defaultPopupTemplate=new X({title:e.searchResult,content:"{Match_addr}"})};e(),this._handles.add([N(this,["defaultSources","sources"],"change",(()=>this.notifyChange("allSources"))),D(this,["includeDefaultSources","view","portal"],(()=>this._update())),O(e)])}destroy(){this._abortGoTo(),this.clearGraphics(),this._handles.destroy(),this._handles=null}get activeSource(){return this.allSources.getItemAt(this.activeSourceIndex)||null}get activeSourceIndex(){return 1!==this.allSources.length&&this.searchAllEnabled?-1:0}set activeSourceIndex(e){void 0!==e?this._override("activeSourceIndex",e):this._clearOverride("activeSourceIndex")}get allPlaceholder(){var e;return null==(e=this.messages)?void 0:e.allPlaceholder}set allPlaceholder(e){e?this._override("allPlaceholder",e):this._clearOverride("allPlaceholder")}get allSources(){const{sources:e,defaultSources:t,includeDefaultSources:s}=this,i="function"==typeof s?s.call(null,{sources:e,defaultSources:t}):s?t.concat(e):e,r=this._get("allSources")||new Xt;return r.removeAll(),r.addMany(i.filter(Boolean)),r}get defaultSymbol(){return T(Qt,"defaultSymbol",{replacement:"defaultSymbols",version:"4.22"}),this._get("defaultSymbol")}set defaultSymbol(e){T(Qt,"defaultSymbol",{replacement:"defaultSymbols",version:"4.22"}),this._set("defaultSymbol",e)}get locationEnabled(){return this._get("locationEnabled")||Zt()}set locationEnabled(e){if(void 0===e)return void this._clearOverride("locationEnabled");const t=Zt();if(e&&!t){const e=new s("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});Qt.error(e)}this._override("locationEnabled",e&&t)}get placeholder(){const{allSources:e,activeSourceIndex:t,allPlaceholder:s}=this;if(-1===t)return s;const i=e.getItemAt(t);return i?i.placeholder:""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),""===e&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":0===this.allSources.length?"disabled":"ready"}get updating(){return null!=this._updatingPromise}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight(),this._closePopup(),this.view&&this.view.graphics.remove(this.resultGraphic),this._set("resultGraphic",null)}search(e,t){this.emit("search-start"),this.clearGraphics();const s=this._createSuggestionForSearch(e),i=this.when().then((()=>this._getResultsFromSources(s,t).then((e=>{var i;if(null!=(i=R(null==t?void 0:t.signal))&&i.aborted)return null;const r={activeSourceIndex:this.activeSourceIndex,searchTerm:s.text,numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(r,e,s);const n=this._getFirstResult(r.results),o=(s.location&&n?n.name:s.text).replace(ts,"");return this._set("searchTerm",o),(s.key&&"number"==typeof s.sourceIndex||s.location)&&this._set("selectedSuggestion",s),this._set("results",r.results),this._set("resultCount",r.results.reduce(((e,t)=>e+t.results.length),0)),this.emit("search-complete",r),this._selectFirstResult(n).then((()=>r))})))).then((e=>(this._clearSearching(),e)),(e=>{throw this._clearSearching(),e}));return this._searching=i,this.notifyChange("state"),i}searchNearby(e){if(!this.locationEnabled){const e=new s("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});return Qt.error(e),Promise.reject(e)}const t=function(e){return e||(e=Wt),new Promise(((t,i)=>{setTimeout((()=>i(new s("geolocation:timeout","getting the current geolocation position timed out"))),15e3),navigator.geolocation.getCurrentPosition(t,i,e)}))}().then((t=>function(e,t){const{position:i,view:r}=e;return function(e,t,i){if(!t)return Promise.resolve(e);const r=t.spatialReference;return r.isWGS84?Promise.resolve(e):r.isWebMercator?Promise.resolve(C(e)):function(e){if($.geometryServiceUrl)return Promise.resolve($.geometryServiceUrl);const t=re.getDefault();return t.load(e).catch((()=>{})).then((()=>t.get("helperServices.geometry.url")))}(i).then((t=>{if(!t)throw new s("geometry-service:missing-url","Geometry service URL is missing");const n=new ge({geometries:[e],outSpatialReference:r});return me(t,n,i).then((e=>e[0]))}))}(function(e){const t=e&&e.coords;return t?new k({longitude:t.longitude,latitude:t.latitude,z:t.altitude||null,spatialReference:{wkid:4326}}):null}(function(e){const t=e&&e.coords||{};return e?{coords:{accuracy:t.accuracy,altitude:t.altitude,altitudeAccuracy:t.altitudeAccuracy,heading:t.heading,latitude:t.latitude,longitude:t.longitude,speed:t.speed},timestamp:e.timestamp}:e}(i)),r,t)}({position:t,view:this.view},e))).then((t=>this.search(t,e)));return this._searching=t,this.notifyChange("state"),t.catch((()=>{})).then((()=>this._clearSearching())),t}select(e){if(this.clearGraphics(),!e){const t=new s("select:missing-parameter","Cannot select without a searchResult.",{searchResult:e});return Qt.error(t),Promise.reject(t)}const{view:t}=this,i=Yt(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),r=this.allSources.getItemAt(i);if(!r){const e=new s("select:missing-source","Cannot select without a source.",{source:r});return Qt.error(e),Promise.reject(e)}const n=r instanceof pt?this._getLayerSourcePopupTemplate(r):r.popupTemplate,o=r.resultSymbol||this._getDefaultSymbol(e),l=Yt(r,"resultGraphicEnabled")?r.resultGraphicEnabled:this.resultGraphicEnabled,a=Yt(r,"autoNavigate")?r.autoNavigate:this.autoNavigate,u=Yt(r,"popupEnabled")?r.popupEnabled:this.popupEnabled,c=u?n||this.popupTemplate||this.defaultPopupTemplate:null,{feature:h}=e;if(!h){const e=new s("select:missing-feature","Cannot select without a feature.",{feature:h});return Qt.error(e),Promise.reject(e)}const{attributes:d,geometry:p,layer:g,sourceLayer:m}=h,f=He(p),v={layerViewQuery:this._getLayerView(h),elevationQuery:t&&b(f)?Ve(f,t).catch((()=>f)):Promise.resolve(f)};return B(v).then((s=>{const n=s.layerViewQuery.value,f=s.elevationQuery.value;o instanceof ie&&(o.text=e.name);const v=t&&a?e.target||e.extent:null;return(b(v)?this._goToSearchResult(v):Promise.resolve()).then((()=>{var s;const a=n?h:new J({geometry:p,symbol:o,attributes:d,layer:g,sourceLayer:m,popupTemplate:c}),v=u&&(null==(s=this.view)?void 0:s.popup),y=v&&a.getEffectivePopupTemplate(v.defaultPopupTemplateEnabled);return y&&t.popup.open({features:[a],location:f}),n&&ne(n)&&!y&&this._highlightFeature({graphic:a,layerView:n}),!n&&l&&t&&t.graphics.push(a),this._set("selectedResult",e),this._set("resultGraphic",a),this.emit("select-result",{result:e,source:r,sourceIndex:i}),e}))}))}suggest(e,t,s){const i=e||this.searchTerm;return this.emit("suggest-start",{searchTerm:i}),this._suggestTimer(t,s).then((()=>this._suggestImmediate(i,s).then((e=>(this._set("suggestions",e.results),this._set("suggestionCount",e.results.reduce(((e,t)=>e+t.results.length),0)),this.emit("suggest-complete",e),e)))))}async when(){await K(this,"updating")}async _update(){const{portal:e,view:t}=this;if(this.includeDefaultSources){const s=this._updatingPromise=B([null==e?void 0:e.load(),null==t?void 0:t.when()]);if(this.destroyed)return;if(this.notifyChange("updating"),await s,s!==this._updatingPromise)return}this._updatingPromise=null,this.notifyChange("updating");const s=z(this,"messages");this.destroyed||(this._handles.add(s),await s,this._updateDefaultSources())}_clearSearching(){this._searching=null,this.notifyChange("state")}_convertHelperServices(){var e,t;const s=null==(e=this.portal)||null==(t=e.helperServices)?void 0:t.geocode;return s?s.map((e=>{if(!1===e.placefinding)return;const t=$.apiKey&&Nt(e.url)?{url:Dt}:null,s=Vt.fromJSON({...e,...t}),i=s.url;return(Nt(i)||function(e){return!!e&&/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/gi.test(e)}(i)||function(e){return!!e&&/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi.test(e)}(i))&&s.set({singleLineFieldName:"SingleLine",outFields:s.outFields||["Addr_type","Match_addr","StAddr","City"],placeholder:s.placeholder||this.messages.placeholder,defaultZoomScale:"number"==typeof s.defaultZoomScale?s.defaultZoomScale:2500}),s.singleLineFieldName?s:void 0})).filter(Boolean):[]}_getLayerSources(e,t){var s;const i=null==(s=this.view)?void 0:s.map;return e.map((e=>{const s=i.findLayerById(e.id);if(!s)return;const r=this._getLayerJSON(e),n=pt.fromJSON(r);return n.placeholder=t,this._getLayer(s,r).then((e=>{n.layer=e})),n})).filter(Boolean).toArray()}_getTableSources(e,t){var s;const i=null==(s=this.view)?void 0:s.map;return e.map((e=>{const s=i.findTableById(e.id);if(!s)return;const r=this._getLayerJSON(e),n=pt.fromJSON(r);return n.placeholder=t,this._getLayer(s,r).then((e=>{n.layer=e})),n})).filter(Boolean).toArray()}_convertApplicationProperties(){var e,t,s;const i=null==(e=this.view)?void 0:e.map,r=null==i||null==(t=i.applicationProperties)||null==(s=t.viewing)?void 0:s.search;if(!r)return[];const{enabled:n,hintText:o,layers:l,tables:a}=r;return n?[...this._getLayerSources(l,o),...this._getTableSources(a,o)]:[]}_getSubLayer(e,t){return e.load().then((()=>{if(!e.allSublayers)return Promise.reject();const s=e.allSublayers.find((e=>e.id===t.subLayer));return s?s.createFeatureLayer():Promise.reject()}))}async _getBuildingSubLayer(e,t){await e.load();const s=e.allSublayers.find((e=>e.id===t.subLayer));return"building-component"!==(null==s?void 0:s.type)?Promise.reject():(await s.load(),null==s.associatedLayer?Promise.reject():(await s.associatedLayer.load(),s))}_getLayer(e,t){return"feature"===e.type||"scene"===e.type||"csv"===e.type||"geojson"===e.type||"ogc-feature"===e.type?Promise.resolve(e):"map-image"===e.type?this._getSubLayer(e,t).catch((()=>{const t=new s("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return Qt.error(t),null})):"building-scene"===e.type?this._getBuildingSubLayer(e,t):Promise.resolve(null)}_getLayerJSON(e){return"function"==typeof e.toJSON?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:t}=this;e.removeAll(),t&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()]),this.notifyChange("allSources")}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear")}_closePopup(){var e;const t=null==(e=this.view)?void 0:e.popup,{resultGraphic:s}=this;if(!t||!s)return;const{selectedFeature:i}=t;i&&i===s&&t.close()}_suggestTimer(e,t){return G(null!=e?e:this.suggestionDelay,null,t&&t.signal)}_createLocationForSearch(e){return e instanceof J?He(e.geometry):e instanceof k?e:Array.isArray(e)&&2===e.length?new k({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&Yt(e,"key")&&Yt(e,"text")&&Yt(e,"sourceIndex"))return e;const t=this._createLocationForSearch(e),s="string"==typeof e?e:this.searchTerm,{selectedSuggestion:i,selectedResult:r}=this,n=!e&&i&&r;return n&&i.key===r.key&&i.sourceIndex===r.sourceIndex||n&&i.location?i:{location:R(t),text:t?"":s,sourceIndex:null,key:null}}_getFirstResult(e){let t=null;return e&&e.some((e=>{const{results:s}=e,i=s[0],r=!!i;return r&&(t=i),r})),t}_selectFirstResult(e){return this.autoSelect&&e?this.select(e):Promise.resolve(null)}_suggestImmediate(e,t){return this.when().then((()=>this._getSuggestionsFromSources(e,t))).then((s=>{var i;if(null!=(i=R(null==t?void 0:t.signal))&&i.aborted)return null;const r={activeSourceIndex:this.activeSourceIndex,searchTerm:e,numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(r,s),r}))}_formatSourceResponse(e,t,s){const i=t&&t.value||[],r=t&&t.error,n=this.allSources.getItemAt(s);r?(e.errors.push({sourceIndex:s,source:n,error:r}),Qt.error(r),e.numErrors++):(e.results.push({sourceIndex:s,source:n,results:i}),e.numResults+=i.length)}_formatResponse(e,t,s){if(t)if(-1===e.activeSourceIndex){const i=s&&Yt(s,"sourceIndex")&&-1!==s.sourceIndex?s.sourceIndex:void 0;t.forEach(((t,s)=>{this._formatSourceResponse(e,t,void 0!==i?i:s)}))}else this._formatSourceResponse(e,t[0],e.activeSourceIndex)}_getResultsFromSources(e,t){const{allSources:i}=this,r=!e.location&&Yt(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,n=[];if(!i.length){const e=new s("search:no-sources-defined","At least one source is required.",{allSources:i});return Qt.error(e),Promise.reject(e)}return-1===r?i.forEach(((s,i)=>{n.push(this._getResultsFromSource(e,i,t))})):n.push(this._getResultsFromSource(e,r,t)),B(n)}_getSuggestionsFromSources(e,t){const{allSources:i,activeSourceIndex:r}=this,n=[];if(!i.length){const e=new s("suggest:no-sources-defined","At least one source is required.",{allSources:i});return Qt.error(e),Promise.reject(e)}return-1===r?i.forEach(((s,i)=>{n.push(this._getSuggestionsFromSource(e,i,t))})):n.push(this._getSuggestionsFromSource(e,r,t)),B(n)}_getResultsFromSource(e,t,s){var i;const r=this.allSources.getItemAt(t),{location:n=null}=e,o=(null==(i=this.view)?void 0:i.spatialReference)||es,l=Yt(r,"maxResults")?r.maxResults:this.maxResults,a=!!(r instanceof pt&&Yt(r,"exactMatch"))&&r.exactMatch,{view:u}=this;return r.getResults({view:u,sourceIndex:t,location:n,suggestResult:e,spatialReference:o,exactMatch:a,maxResults:l},s)}_getSuggestionsFromSource(e,t,s){const i=this.allSources.getItemAt(t),r=Yt(i,"suggestionsEnabled")?i.suggestionsEnabled:this.suggestionsEnabled,n=e.length,o=Yt(i,"minSuggestCharacters")?i.minSuggestCharacters:this.minSuggestCharacters;if(r&&e.trim()&&n>=o){var l;const r=(null==(l=this.view)?void 0:l.spatialReference)||es,n=Yt(i,"maxSuggestions")?i.maxSuggestions:this.maxSuggestions,{view:o}=this,a=!!(i instanceof pt&&Yt(i,"exactMatch"))&&i.exactMatch;return i.getSuggestions({view:o,sourceIndex:t,suggestTerm:e,spatialReference:r,maxSuggestions:n,exactMatch:a},s)}return Promise.resolve(null)}_getLayerSourcePopupTemplate(e){const{layer:t}=e;if(t)return Yt(e,"popupTemplate")?e.popupTemplate:t.popupTemplate}_getSourceIndexOfResult(e){let t=null;return this.results.some((s=>s.results.some((i=>i===e&&(t=s.sourceIndex,!0))))),t}async _goToSearchResult(e){const t=!!e;this._abortGoTo();const s=new AbortController;this._gotoController=s;const i={target:{target:e},options:{animate:t,signal:s.signal}};await this.callGoTo(i),this._gotoController=null}_getDefaultSymbol(e){var t;const{defaultSymbols:s}=this,i=null==(t=e.feature)?void 0:t.geometry;if(!b(i))return null;const r=this._get("defaultSymbol");if(r&&("point"===i.type||"multipoint"===i.type))return r;switch(i.type){case"point":case"multipoint":return s.point;case"polyline":return s.polyline;case"extent":case"polygon":return s.polygon;default:return null}}_removeHighlight(){this._handles.remove(Jt)}async _getLayerView(e){const{view:t}=this;if(!e||!t||"building-component"===e.layer.type||"subtype-sublayer"===e.layer.type)return Promise.resolve(null);const{layer:s}=e;return await t.when(),t.whenLayerView(s)}_highlightFeature(e){const{graphic:t,layerView:s}=e,{attributes:i,layer:r}=t,{objectIdField:n}=r,o=s.highlight(i&&i[n]||t);this._handles.add(o,Jt)}};ss.ALL_INDEX=-1,r([n({readOnly:!0,value:null})],ss.prototype,"activeSource",null),r([n()],ss.prototype,"activeSourceIndex",null),r([n()],ss.prototype,"allPlaceholder",null),r([n({readOnly:!0,dependsOn:["defaultSources.length","sources.length","includeDefaultSources"]})],ss.prototype,"allSources",null),r([n()],ss.prototype,"autoNavigate",void 0),r([n()],ss.prototype,"autoSelect",void 0),r([n()],ss.prototype,"defaultPopupTemplate",void 0),r([n({readOnly:!0})],ss.prototype,"defaultSources",void 0),r([n()],ss.prototype,"defaultSymbol",null),r([n()],ss.prototype,"defaultSymbols",void 0),r([n()],ss.prototype,"includeDefaultSources",void 0),r([n()],ss.prototype,"locationEnabled",null),r([n()],ss.prototype,"maxInputLength",void 0),r([n()],ss.prototype,"maxResults",void 0),r([n()],ss.prototype,"maxSuggestions",void 0),r([n()],ss.prototype,"messages",void 0),r([n()],ss.prototype,"minSuggestCharacters",void 0),r([n({readOnly:!0})],ss.prototype,"placeholder",null),r([n()],ss.prototype,"popupEnabled",void 0),r([n({type:X})],ss.prototype,"popupTemplate",void 0),r([n({type:re})],ss.prototype,"portal",void 0),r([n()],ss.prototype,"resultCount",void 0),r([n()],ss.prototype,"resultGraphicEnabled",void 0),r([n({readOnly:!0})],ss.prototype,"resultGraphic",void 0),r([n({readOnly:!0})],ss.prototype,"results",void 0),r([n({readOnly:!0})],ss.prototype,"selectedSuggestion",void 0),r([n()],ss.prototype,"searchAllEnabled",void 0),r([n({readOnly:!0})],ss.prototype,"selectedResult",void 0),r([n()],ss.prototype,"searchTerm",null),r([n({type:Xt})],ss.prototype,"sources",void 0),r([n({readOnly:!0,dependsOn:["allSources.length","updating"]})],ss.prototype,"state",null),r([n()],ss.prototype,"suggestionDelay",void 0),r([n()],ss.prototype,"suggestionCount",void 0),r([n({readOnly:!0})],ss.prototype,"suggestions",void 0),r([n()],ss.prototype,"suggestionsEnabled",void 0),r([n({readOnly:!0})],ss.prototype,"updating",null),r([n()],ss.prototype,"view",void 0),r([n()],ss.prototype,"clear",null),ss=r([o(qt)],ss);const is=ss;let rs=class extends h{constructor(e,t){super(e,t),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null}render(){return p("div",{class:"esri-search-result-renderer esri-widget"},p("div",{key:"esri-search-renderer__container",class:this.classes("esri-search-result-renderer__more-results",{"esri-search-result-renderer__more-results--show-more-results":this.showMoreResultsOpen})},this.renderSearchResultName(),this.renderMoreResults()))}renderMoreResults(){return p("div",{key:"esri-search-renderer__more-results"},this.renderMoreResultsButton(),this.renderMoreResultsLists())}renderSearchResultName(){var e;const t=null==(e=this.viewModel)?void 0:e.selectedResult;return p("div",{key:"esri-search-renderer__result-name",class:"esri-search-result-renderer__more-results-item"},t&&t.name||"")}renderMoreResultsLists(){var e;const t=null==(e=this.viewModel)?void 0:e.results,{resultCount:s}=this.viewModel;if(s<2)return null;const i=t.map((e=>this.renderMoreResultsList(e)));return p("div",{key:"esri-search-renderer__more-results-container",class:"esri-search-result-renderer__more-results-list"},i)}renderMoreResultsButton(){const{messages:e}=this,{resultCount:t}=this.viewModel;return t<2?null:p("div",{key:"esri-search-renderer__more-results-button",class:"esri-search-result-renderer__more-results-item"},p("a",{class:"esri-widget__anchor",href:"#",bind:this,onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults))}renderMoreResultsHeader(e,t){return p("div",{key:`esri-search-result-renderer__header-${t}`,class:"esri-search-result-renderer__more-results-list-header"},e)}renderMoreResultsList(e){var t,s;const{results:i}=e,r=i.length,n=!!r,o=null==(t=this.viewModel)?void 0:t.selectedResult,l=1===r&&i[0]===o,a=this._getSourceName(e.source,e.sourceIndex),u=(null==(s=this.viewModel)?void 0:s.results.length)>1&&!l?this.renderMoreResultsHeader(a,e.sourceIndex):null,c=n&&i.map(((e,t)=>this.renderMoreResultsListItem(e,t))),h=n&&!l?p("ul",{key:`esri-search-result-renderer__list-${e.sourceIndex}`},c):null;return n?p("div",{key:`esri-search-result-renderer__results-${e.sourceIndex}`},u,h):null}renderMoreResultsListItem(e,t){return e!==this.get("viewModel.selectedResult")?p("li",{key:`esri-search-result-renderer__list-item-${t}`},p("a",{class:"esri-widget__anchor",href:"#",tabindex:"0",bind:this,"data-result":e,onclick:this._selectResultClick,onkeydown:this._selectResultClick},e.name)):null}_showMoreResultsClick(e){e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const t=this.get("viewModel.view.popup");t&&t.reposition()}_selectResultClick(e){e.preventDefault(),this.viewModel&&this.viewModel.select(e.currentTarget["data-result"])}_getSourceName(e,t){return t===is.ALL_INDEX?this.messages.all:e.name}};r([n(),u("esri/widgets/Search/t9n/Search")],rs.prototype,"messages",void 0),r([n()],rs.prototype,"showMoreResultsOpen",void 0),r([n()],rs.prototype,"viewModel",void 0),r([Q()],rs.prototype,"_showMoreResultsClick",null),r([Q()],rs.prototype,"_selectResultClick",null),rs=r([o("esri.widgets.Search.SearchResultRenderer")],rs);const ns=rs,os="esri-widget--button",ls="esri-menu__list-item",as=/<[a-z/][\s\S]*>/i;let us=class extends h{constructor(e,t){super(e,t),this._activeMenuItemIndex=-1,this._handles=new L,this._inputNode=null,this._menuItemCount=0,this._sourceMenuButtonNode=null,this._sourceListNode=null,this._suggestionListNode=null,this._searchResultRenderer=new ns,this._locateFailed=null,this._container=null,this.activeMenu="none",this.activeSource=null,this.activeSourceIndex=null,this.allPlaceholder=null,this.allSources=null,this.autoNavigate=null,this.autoSelect=null,this.defaultSources=null,this.disabled=!1,this.goToOverride=null,this.iconClass="esri-icon-search",this.includeDefaultSources=null,this.label=void 0,this.locationEnabled=null,this.maxResults=null,this.maxSuggestions=null,this.messages=null,this.messagesCommon=null,this.minSuggestCharacters=null,this.popupEnabled=null,this.popupTemplate=null,this.portal=null,this.resultGraphic=null,this.resultGraphicEnabled=null,this.results=null,this.searchAllEnabled=null,this.searchTerm=null,this.selectedResult=null,this.sources=null,this.suggestions=null,this.suggestionsEnabled=null,this.view=null,this.viewModel=new is,this._clearActiveMenu=()=>{this.activeMenu="none"},this._removeActiveMenu=e=>{var t;const s=e.relatedTarget;s&&null!=(t=this._container)&&t.contains(s)||this._clearActiveMenu()},this.own(V(this,"searchTerm",(e=>{(e&&"warning"===this.activeMenu||!e&&!this.get("viewModel.selectedSuggestion.location"))&&this._clearActiveMenu()})),N(this,"viewModel.allSources","change",(()=>this._watchSourceChanges())),D(this,"activeMenu",(()=>this._resetActiveMenuItemIndex())),D(this,"viewModel.defaultPopupTemplate",(e=>{e&&(e.content=this._renderSearchResultsContent.bind(this))})))}destroy(){this._handles.destroy(),this._handles=null,this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer&&(this._searchResultRenderer.viewModel=null,this._searchResultRenderer.destroy(),this._searchResultRenderer=null)}get displayedSearchTerm(){return`${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}clear(){}focus(){var e;null==(e=this._inputNode)||e.focus(),this.emit("search-focus")}blur(){var e;null==(e=this._inputNode)||e.blur(),this.emit("search-blur")}search(e){this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();const t=new AbortController,{signal:s}=t;return this._searchController=t,this.viewModel.search(e,{signal:s}).catch((e=>{if(this._searchController===t)return this._clearActiveMenu(),this._searchController=null,e})).then((e=>{if(this._searchController===t)return this.activeMenu=e.numResults?"none":"warning",this._searchController=null,e}))}suggest(e){this._cancelSuggest();const t=new AbortController,{signal:s}=t;return this._suggestController=t,this.viewModel.suggest(e,null,{signal:s}).then((e=>{if(this._suggestController===t)return this._suggestController=null,e.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),e})).catch((()=>{if(this._suggestController===t)return this._suggestController=null,null}))}render(){const{state:e}=this.viewModel;return p("div",{class:this.classes("esri-search esri-widget",{"esri-disabled":"disabled"===e,"esri-widget--disabled":this.disabled})},"loading"===e?this.renderLoader():this.renderContainer())}renderSubmitButton(){const{messages:e}=this;return p("button",{"aria-label":e.searchButtonTitle,bind:this,class:this.classes("esri-search__submit-button",os),key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:e.searchButtonTitle},p("span",{"aria-hidden":"true",class:"esri-icon-search"}))}renderWarningMenu(){return p("div",{key:"esri-search__error-menu",class:this.classes("esri-menu","esri-search__warning-menu")},p("div",{class:"esri-search__warning-body"},this.renderWarning()))}renderSourceMenuButton(){const{messages:e,activeMenu:t,sourceMenuId:s,sourceMenuButtonId:i}=this,{activeSourceIndex:r,allSources:n}=this.viewModel;return n.length>1?p("button",{id:i,key:"esri-search__source-menu-button",bind:this,"aria-label":e.searchIn,title:e.searchIn,"aria-haspopup":"true","aria-expanded":("source"===t).toString(),"aria-controls":s,class:this.classes("esri-search__sources-button",os),onclick:this._handleSourcesMenuToggleClick,onfocus:this._clearActiveMenu,afterCreate:g,"data-node-ref":"_sourceMenuButtonNode"},p("span",{"aria-hidden":"true",class:"esri-icon-down-arrow esri-search__sources-button--down"}),p("span",{"aria-hidden":"true",class:"esri-icon-up-arrow esri-search__sources-button--up"}),p("span",{class:"esri-search__source-name"},this._getSourceName(r))):null}renderSourcesList(){const{allSources:e,searchAllEnabled:t}=this.viewModel,{_activeMenuItemIndex:s,activeMenu:i,sourceMenuId:r,sourceMenuButtonId:n}=this,o="source"===i&&s>-1?this._buildId("source-item",s):null;return e.length>1?p("ul",{"aria-activedescendant":o,"aria-labelledby":n,id:r,role:"menu",bind:this,afterCreate:g,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,"data-node-ref":"_sourceListNode",class:"esri-menu__list",tabIndex:-1},t?this.renderSource(is.ALL_INDEX):null,e.map(((e,t)=>this.renderSource(t))).toArray()):null}renderSourcesMenu(){const{allSources:e}=this.viewModel;return e.length>1?p("div",{key:"esri-search__source-menu",class:this.classes("esri-menu","esri-search__sources-menu")},this.renderSourcesList()):null}renderLoader(){const{messages:e,messagesCommon:t}=this;return p("div",{class:"esri-widget__loader",key:"base-loader"},p("span",{"aria-hidden":"true",class:"esri-widget__loader-animation"}),p("span",{class:"esri-icon-font-fallback-text"},e.searchButtonTitle),p("span",{class:"esri-widget__loader-text"},t.loading))}renderContainer(){const{allSources:e,state:t}=this.viewModel,{activeMenu:s}=this;return p("div",{tabIndex:-1,afterCreate:e=>{this._container=e,e.addEventListener("focusout",this._removeActiveMenu)},afterRemoved:e=>{e.removeEventListener("focusout",this._removeActiveMenu)},class:this.classes({"esri-search--multiple-sources":e.length>1,"esri-search--loading":"loading"===t,"esri-search--searching":"searching"===t,"esri-search--warning":"warning"===s,"esri-search--sources":"source"===s,"esri-search--show-suggestions":"suggestion"===s},"esri-search__container"),key:"base-container"},this.renderSourceMenuButton(),this.renderSourcesMenu(),this.renderInputContainer(),this.renderSubmitButton(),this.renderWarningMenu())}renderClearButton(){return this.searchTerm?p("button",{bind:this,class:this.classes("esri-search__clear-button",os),key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle},p("span",{"aria-hidden":"true",class:"esri-icon-close"})):null}renderLocationGroup(){const{messages:e,locationEnabled:t,displayedSearchTerm:s}=this,i="suggestion"===this.activeMenu&&0===this._activeMenuItemIndex;return t&&!s?p("ul",{role:"group",key:"esri-search__suggestion-list-current-location",class:this.classes("esri-menu__list","esri-search__suggestions-list","esri-search__suggestions-list--current-location")},p("li",{bind:this,"data-current-location-item":!0,onclick:this._handleUseCurrentLocationClick,id:this._buildId("suggestion-item",0),"aria-selected":("suggestion"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),role:"option",class:this.classes(ls,i?"esri-menu__list-item--focus":null)},p("span",{"aria-hidden":"true",class:"esri-icon-locate-circled"})," ",e.useCurrentLocation)):null}renderInput(){const{activeMenu:e,locationEnabled:t,displayedSearchTerm:s,messages:i,suggestionsMenuId:r,inputId:n,_activeMenuItemIndex:o}=this,{maxInputLength:l,placeholder:a,searchTerm:u,suggestionCount:c}=this.viewModel,h=!((!t||s)&&!c),d="suggestion"===e&&o>-1?this._buildId("suggestion-item",o):null;return p("input",{"aria-activedescendant":d,"aria-autocomplete":"list","aria-expanded":(h&&"suggestion"===e).toString(),"aria-controls":h?r:null,"aria-haspopup":"listbox","aria-label":i.searchButtonTitle,bind:this,placeholder:a,maxlength:l,autocomplete:"off",type:"text",class:this.classes("esri-input","esri-search__input"),value:u,id:n,role:"combobox",onkeyup:this._handleInputKeyup,onclick:this._openSuggestionMenu,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:g,"data-node-ref":"_inputNode",onfocus:this.focus,onblur:this.blur,title:u?"":a})}renderForm(){return p("form",{key:"esri-search__form",bind:this,class:"esri-search__form",onsubmit:this._formSubmit,role:"search"},this.renderInput())}renderSuggestList(e){const{sourceIndex:t}=e,s=e.results;return e.results.length?p("ul",{role:"group",key:`esri-search__suggestion-list-${t}`,class:this.classes("esri-menu__list","esri-search__suggestions-list")},s.map((e=>this.renderSuggestion(e,this._menuItemCount++)))):null}renderSuggestionsGroup(){const{suggestions:e}=this.viewModel;return e?e.map((e=>[this.renderSuggestionHeader(e),this.renderSuggestList(e)])):null}renderSuggestionsMenu(){const{displayedSearchTerm:e,locationEnabled:t,suggestionsMenuId:s,inputId:i}=this,{suggestionCount:r}=this.viewModel,n=t&&!e||r;return this._menuItemCount=0,n?p("div",{id:s,key:"esri-search__suggestions-menu",class:this.classes("esri-menu","esri-search__suggestions-menu"),role:"listbox","aria-labelledby":i,bind:this,afterCreate:g,"data-node-ref":"_suggestionListNode"},this.renderLocationGroup(),this.renderSuggestionsGroup()):null}renderInputContainer(){return p("div",{key:"esri-search__input-container",class:"esri-search__input-container"},this.renderForm(),this.renderSuggestionsMenu(),this.renderClearButton())}renderSuggestionHeader(e){const{allSources:t,activeSourceIndex:s}=this.viewModel,{sourceIndex:i}=e;return e.results.length&&t.length>1&&s===is.ALL_INDEX?p("div",{key:`esri-search__suggestion-header-${i}`,class:"esri-menu__header"},this._getSourceName(i)):null}renderSuggestion(e,t){const{_activeMenuItemIndex:s,messages:i}=this,{searchTerm:r}=this.viewModel;if(r){const{text:n}=e,o=n||i.untitledResult,l=as.test(o),a=[];if(l)a.push(p("div",{innerHTML:o}));else{const e=this._splitResult(o,r),t=r.toLowerCase();e.forEach(((e,s)=>{e&&e.length&&(e.toLowerCase()===t?a.push(p("strong",{key:s},e)):a.push(e))}))}const u="suggestion"===this.activeMenu&&s===t;return p("li",{bind:this,id:this._buildId("suggestion-item",t),"aria-selected":("suggestion"===this.activeMenu&&this._activeMenuItemIndex===t).toString(),onclick:this._handleSuggestionClick,key:`esri-search__suggestion_${t}`,"data-suggestion":e,role:"option",class:this.classes(ls,u?"esri-menu__list-item--focus":null)},a)}}renderSource(e){const{activeSourceIndex:t,searchAllEnabled:s}=this.viewModel,i={"esri-menu__list-item--active":e===t,"esri-menu__list-item--focus":"source"===this.activeMenu&&e===(s?this._activeMenuItemIndex-1:this._activeMenuItemIndex)};return p("li",{bind:this,key:`esri-search__source-${e}`,id:this._buildId("source-item",s?e+1:e),"aria-checked":(e===t).toString(),onclick:this._handleSourceClick,"data-source-index":e,role:"menuitemradio",class:this.classes("esri-search__source",ls,i)},this._getSourceName(e))}renderNoResultsWarning(e){const{messages:t}=this,s=e?S(t.noResultsFoundForValue,{value:`"${e}"`}):t.noResultsFound;return p("div",{key:"esri-search__no_results"},p("div",{class:"esri-search__warning-header"},t.noResults),p("div",{class:"esri-search__warning-text"},s))}renderEmptySearchWarning(){const{messages:e}=this;return p("div",{key:"esri-search__empty-search"},p("span",{"aria-hidden":"true",class:"esri-icon-notice-triangle"}),p("span",{class:"esri-search__no-value-text"},e.emptyValue))}renderLocateWarning(){const{messages:e}=this;return p("div",{key:"esri-search__locate-error"},p("span",{"aria-hidden":"true",class:"esri-icon-notice-triangle"}),p("span",{class:"esri-search__no-value-text"},e.locateError))}renderWarning(){var e;const{displayedSearchTerm:t,_locateFailed:s}=this,{viewModel:i}=this;return s?this.renderLocateWarning():null!=(e=i.selectedSuggestion)&&e.location||t?this.renderNoResultsWarning(t):this.renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1}_buildId(e,t){return`${this.id}-${e}${void 0===t?"":`-${t}`}`}_watchSourceChanges(){const{_handles:e,viewModel:{allSources:t}}=this,s="sources";e.remove(s),t.forEach((t=>e.add(V(t,"name",(()=>this.scheduleRender())),s)))}_handleSourcesMenuToggleClick(){var e;this.activeMenu="source"===this.activeMenu?"none":"source",this.renderNow(),"source"===this.activeMenu&&(null==(e=this._sourceListNode)||e.focus())}_handleClearButtonClick(){this.viewModel.clear(),this._focus()}_handleSearchButtonClick(){this.search()}_handleSuggestionClick(e){const t=e.currentTarget["data-suggestion"];t&&(this._focus(),this.search(t))}_handleUseCurrentLocationClick(){this._useCurrentLocation()}_useCurrentLocation(){this._focus("none"),this._cancelSuggest(),this._cancelSearch();const e=new AbortController,{signal:t}=e;this._searchController=e,this.viewModel.searchNearby({signal:t}).catch((()=>{this._locateFailed=!0,this.activeMenu="warning"})).then((()=>{this._searchController=null}))}_handleSourceClick(e){this._setSourceFromMenuItem(e.currentTarget)}_setSourceFromMenuItem(e){var t;e&&(this.viewModel.activeSourceIndex=e["data-source-index"],this._clearActiveMenu(),null==(t=this._sourceMenuButtonNode)||t.focus())}_cancelSuggest(){this._suggestController&&(this._suggestController.abort(),this._suggestController=null)}_cancelSearch(){this._searchController&&(this._searchController.abort(),this._searchController=null),this._locateFailed=!1}_handleInputKeyup(e){var t;const s=f(e);if(e.ctrlKey||e.metaKey||"Copy"===s||"ArrowLeft"===s||"ArrowRight"===s||"Shift"===s)return;if("Tab"===s||"Escape"===s||e.shiftKey&&"Tab"===s)return this._cancelSuggest(),void("Escape"===s&&this._clearActiveMenu());const i="Home"===s||"End"===s||"ArrowUp"===s||"ArrowDown"===s;if("Enter"===s&&this._activeMenuItemIndex<0)return void this._cancelSuggest();const r=null==(t=this._suggestionListNode)?void 0:t.getElementsByTagName("li");if(null!=r&&r.length){if("suggestion"!==this.activeMenu&&this._openSuggestionMenu(),i)return e.preventDefault(),this._cancelSuggest(),void this.handleItemNavigation(s,r,this._suggestionListNode);const t=r[this._activeMenuItemIndex];if("Enter"===s&&t){const e=t["data-suggestion"];return void(e?(this._focus(),this.search(e)):t["data-current-location-item"]&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest()}handleItemNavigation(e,t,s){const i=this._activeMenuItemIndex;"Home"===e&&(this._activeMenuItemIndex=0),"End"===e&&(this._activeMenuItemIndex=t.length-1),"ArrowUp"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?t.length-1:this._activeMenuItemIndex-1),"ArrowDown"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex===t.length-1?0:this._activeMenuItemIndex+1),i!==this._activeMenuItemIndex&&H(t[this._activeMenuItemIndex],s)}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0)}_openSuggestionMenu(){this.activeMenu="suggestion"}_handleInputPaste(e){const t=e.target;this.viewModel.searchTerm!==t.value&&(this.viewModel.searchTerm=t.value),this.viewModel.searchTerm&&this.suggest()}_handleSourceMenuKeydown(e){const t=f(e);if(m(t)){e.preventDefault();const t=this._sourceListNode.getElementsByTagName("li")[this._activeMenuItemIndex];this._setSourceFromMenuItem(t)}else"ArrowUp"!==t&&"ArrowDown"!==t&&"End"!==t&&"Home"!==t||e.preventDefault()}_handleSourceMenuKeyup(e){var t;const s=f(e),i="ArrowUp"===s||"ArrowDown"===s||"End"===s||"Home"===s;var r;if(i&&e.preventDefault(),"Escape"===s)return this._clearActiveMenu(),void(null==(r=this._sourceMenuButtonNode)||r.focus());const n=null==(t=this._sourceListNode)?void 0:t.getElementsByTagName("li");return n&&0!==n.length&&i?("source"!==this.activeMenu&&(this.activeMenu="source"),void this.handleItemNavigation(s,n,this._sourceListNode.parentElement)):void 0}_focus(e){this.focus(),e&&(this.activeMenu=e)}_formSubmit(e){e.preventDefault(),-1===this._activeMenuItemIndex&&this.search()}_getSourceName(e){const{messages:t}=this,s=this.viewModel,{allSources:i}=s,r=i.getItemAt(e);return e===is.ALL_INDEX?t.all:r&&r.name||t.untitledSource}_splitResult(e,t){const s=W(t);return e.replace(new RegExp(`(^|)(${s})(|$)`,"ig"),"$1|$2|$3").split("|")}_renderSearchResultsContent(){return this._searchResultRenderer.showMoreResultsOpen=!1,this._searchResultRenderer.viewModel=this.viewModel,this._searchResultRenderer}};r([n()],us.prototype,"_activeMenuItemIndex",void 0),r([n()],us.prototype,"displayedSearchTerm",null),r([n({readOnly:!0})],us.prototype,"inputId",null),r([n({readOnly:!0})],us.prototype,"suggestionsMenuId",null),r([n({readOnly:!0})],us.prototype,"sourceMenuId",null),r([n({readOnly:!0})],us.prototype,"sourceMenuButtonId",null),r([n()],us.prototype,"activeMenu",void 0),r([c("viewModel.activeSource")],us.prototype,"activeSource",void 0),r([c("viewModel.activeSourceIndex")],us.prototype,"activeSourceIndex",void 0),r([c("viewModel.allPlaceholder")],us.prototype,"allPlaceholder",void 0),r([c("viewModel.allSources")],us.prototype,"allSources",void 0),r([c("viewModel.autoNavigate")],us.prototype,"autoNavigate",void 0),r([c("viewModel.autoSelect")],us.prototype,"autoSelect",void 0),r([c("viewModel.defaultSources")],us.prototype,"defaultSources",void 0),r([n()],us.prototype,"disabled",void 0),r([c("viewModel.goToOverride")],us.prototype,"goToOverride",void 0),r([n()],us.prototype,"iconClass",void 0),r([c("viewModel.includeDefaultSources")],us.prototype,"includeDefaultSources",void 0),r([n({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],us.prototype,"label",void 0),r([c("viewModel.locationEnabled")],us.prototype,"locationEnabled",void 0),r([c("viewModel.maxResults")],us.prototype,"maxResults",void 0),r([c("viewModel.maxSuggestions")],us.prototype,"maxSuggestions",void 0),r([n(),u("esri/widgets/Search/t9n/Search")],us.prototype,"messages",void 0),r([n(),u("esri/t9n/common")],us.prototype,"messagesCommon",void 0),r([c("viewModel.minSuggestCharacters")],us.prototype,"minSuggestCharacters",void 0),r([c("viewModel.popupEnabled")],us.prototype,"popupEnabled",void 0),r([c("viewModel.popupTemplate")],us.prototype,"popupTemplate",void 0),r([c("viewModel.portal")],us.prototype,"portal",void 0),r([c("viewModel.resultGraphic")],us.prototype,"resultGraphic",void 0),r([c("viewModel.resultGraphicEnabled")],us.prototype,"resultGraphicEnabled",void 0),r([c("viewModel.results")],us.prototype,"results",void 0),r([c("viewModel.searchAllEnabled")],us.prototype,"searchAllEnabled",void 0),r([c("viewModel.searchTerm")],us.prototype,"searchTerm",void 0),r([c("viewModel.selectedResult")],us.prototype,"selectedResult",void 0),r([c("viewModel.sources")],us.prototype,"sources",void 0),r([c("viewModel.suggestions")],us.prototype,"suggestions",void 0),r([c("viewModel.suggestionsEnabled")],us.prototype,"suggestionsEnabled",void 0),r([c("viewModel.view")],us.prototype,"view",void 0),r([ve(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),n({type:is})],us.prototype,"viewModel",void 0),r([c("viewModel.clear")],us.prototype,"clear",null),us=r([o("esri.widgets.Search")],us);const cs=us;export{Nt as S,Ke as f,ft as t,Dt as w,Ae as x,cs as y}