import{b6 as i,e as t,d as e,a3 as s,i as r,A as o}from"./p-e58503d5.js";import{n as p}from"./p-9b7a2176.js";import{l as a}from"./p-d208934e.js";import{b as h}from"./p-3e39c093.js";import{i as l}from"./p-a24f7752.js";import{y as d}from"./p-1ab449fc.js";import{w as n}from"./p-e44bd0a6.js";import{s as m}from"./p-c6970847.js";import{c,p as b}from"./p-37058f88.js";import{y as j}from"./p-4d17d2cd.js";import"./p-53bb6ab4.js";import"./p-e654504b.js";import"./p-efbca0ca.js";import"./p-b79fcce3.js";import"./p-8747982c.js";import"./p-74de0937.js";import"./p-fb38a9d0.js";import"./p-ccdb8e80.js";import"./p-d3105731.js";import"./p-7a5bfd29.js";import"./p-8a919d07.js";import"./p-a6c8fb32.js";import"./p-765e6c28.js";import"./p-6b2eb7a7.js";import"./p-01e5a461.js";import"./p-0eb619a6.js";let u=class extends(l(m(d(n(c(b(a(h)))))))){constructor(i){super(i),this._visibilityHandles={},this.fullExtent=void 0,this.operationalLayerType="GroupLayer",this.spatialReference=void 0,this.type="group",this._visibilityWatcher=this._visibilityWatcher.bind(this)}initialize(){this._enforceVisibility(this.visibilityMode,this.visible),this.watch("visible",this._visibleWatcher.bind(this),!0)}_writeLayers(i,t,e,s){const r=[];if(!i)return r;i.forEach((i=>{const t=j(i,s.webmap?s.webmap.getLayerJSONFromResourceInfo(i):null,s);o(t)&&t.layerType&&r.push(t)})),t.layers=r}set portalItem(i){this._set("portalItem",i)}set visibilityMode(i){const t=this._get("visibilityMode")!==i;this._set("visibilityMode",i),t&&this._enforceVisibility(i,this.visible)}load(i){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Service","Feature Collection","Scene Service"]},i)),Promise.resolve(this)}loadAll(){return p(this,(i=>{i(this.layers)}))}layerAdded(i){i.visible&&"exclusive"===this.visibilityMode?this._turnOffOtherLayers(i):"inherited"===this.visibilityMode&&(i.visible=this.visible),this._visibilityHandles[i.uid]=i.watch("visible",this._visibilityWatcher,!0)}layerRemoved(i){const t=this._visibilityHandles[i.uid];t&&(t.remove(),delete this._visibilityHandles[i.uid]),this._enforceVisibility(this.visibilityMode,this.visible)}_turnOffOtherLayers(i){this.layers.forEach((t=>{t!==i&&(t.visible=!1)}))}_enforceVisibility(t,e){if(!i(this).initialized)return;const s=this.layers;let r=s.find((i=>i.visible));switch(t){case"exclusive":s.length&&!r&&(r=s.getItemAt(0),r.visible=!0),this._turnOffOtherLayers(r);break;case"inherited":s.forEach((i=>{i.visible=e}))}}_visibleWatcher(i){"inherited"===this.visibilityMode&&this.layers.forEach((t=>{t.visible=i}))}_visibilityWatcher(i,t,e,s){const r=s;switch(this.visibilityMode){case"exclusive":i?this._turnOffOtherLayers(r):this._isAnyLayerVisible()||(r.visible=!0);break;case"inherited":r.visible=this.visible}}_isAnyLayerVisible(){return this.layers.some((i=>i.visible))}};t([e()],u.prototype,"fullExtent",void 0),t([e({json:{read:!1,write:{ignoreOrigin:!0}}})],u.prototype,"layers",void 0),t([s("layers")],u.prototype,"_writeLayers",null),t([e({type:["GroupLayer"]})],u.prototype,"operationalLayerType",void 0),t([e({json:{origins:{"web-document":{read:!1,write:!1}}}})],u.prototype,"portalItem",null),t([e()],u.prototype,"spatialReference",void 0),t([e({json:{read:!1},readOnly:!0,value:"group"})],u.prototype,"type",void 0),t([e({type:["independent","inherited","exclusive"],value:"independent",json:{write:!0,origins:{"web-map":{read:!1,write:!1}}}})],u.prototype,"visibilityMode",null),u=t([r("esri.layers.GroupLayer")],u);const y=u;export default y;