import{u as n}from"./p-ea916a39.js";import{g as t}from"./p-b79fcce3.js";import{d9 as e,bw as s,ci as i}from"./p-e58503d5.js";import{l as m,f as o,s as r,c as f,y as x}from"./p-c048b814.js";import{r as c,i as a,s as u}from"./p-c1cd5521.js";function l(n){if(!n)return null;let l=null;const p=n.spatialReference,h=s(p);if(!h)return"toJSON"in n?n.toJSON():n;const I=i(p)?102100:4326,b=c[I].maxX,g=c[I].minX,w=c[I].plus180Line,J=c[I].minus180Line;let N;const O="toJSON"in n?n.toJSON():n;if(m(O))N=d(O,b,g);else if(o(O))O.points=O.points.map((n=>d(n,b,g))),N=O;else if(r(O))N=y(O,h);else if(f(O)||x(O)){const n=M;t(n,O);const s={xmin:n[0],ymin:n[1],xmax:n[2],ymax:n[3]},i=a(s.xmin,g)*(2*b),m=0===i?O:function(n,t){const e=u(n);for(const n of e)for(const e of n)e[0]+=t;return n}(O,i);s.xmin+=i,s.xmax+=i,e(s,w)&&s.xmax!==b||e(s,J)&&s.xmin!==g?l=m:N=m}else N=O;return null!==l?(new j).cut(l,b):N}function y(n,t){if(!t)return n;const e=function(n,t){const e=[],{ymin:s,ymax:i}=n,m=n.xmax-n.xmin,o=n.xmin,r=n.xmax;let f;const[x,c]=t.valid;f=p(n.xmin,t);const a=f.x,u=f.frameId;f=p(n.xmax,t);const l=f.x,y=f.frameId,d=a===l&&m>0;if(m>2*c){const n={xmin:o<r?a:l,ymin:s,xmax:c,ymax:i},t={xmin:x,ymin:s,xmax:o<r?l:a,ymax:i},m={xmin:0,ymin:s,xmax:c,ymax:i},f={xmin:x,ymin:s,xmax:0,ymax:i},d=[],p=[];h(n,m)&&d.push(u),h(n,f)&&p.push(u),h(t,m)&&d.push(y),h(t,f)&&p.push(y);for(let n=u+1;n<y;n++)d.push(n),p.push(n);e.push({extent:n,frameIds:[u]},{extent:t,frameIds:[y]},{extent:m,frameIds:d},{extent:f,frameIds:p})}else a>l||d?e.push({extent:{xmin:a,ymin:s,xmax:c,ymax:i},frameIds:[u]},{extent:{xmin:x,ymin:s,xmax:l,ymax:i},frameIds:[y]}):e.push({extent:{xmin:a,ymin:s,xmax:l,ymax:i},frameIds:[u]});return e}(n,t).map((n=>n.extent));return e.length<2?e[0]||n:e.length>2?(n.xmin=t.valid[0],n.xmax=t.valid[1],n):{rings:e.map((n=>[[n.xmin,n.ymin],[n.xmin,n.ymax],[n.xmax,n.ymax],[n.xmax,n.ymin],[n.xmin,n.ymin]]))}}function d(n,t,e){if(Array.isArray(n)){const s=n[0];if(s>t){const e=a(s,t);n[0]=s+e*(-2*t)}else if(s<e){const t=a(s,e);n[0]=s+t*(-2*e)}}else{const s=n.x;if(s>t){const e=a(s,t);n.x+=e*(-2*t)}else if(s<e){const t=a(s,e);n.x+=t*(-2*e)}}return n}function p(n,t){const[e,s]=t.valid,i=2*s;let m,o=0;return n>s?(m=Math.ceil(Math.abs(n-s)/i),n-=m*i,o=m):n<e&&(m=Math.ceil(Math.abs(n-e)/i),n+=m*i,o=-m),{x:n,frameId:o}}function h(n,t){const{xmin:e,ymin:s,xmax:i,ymax:m}=t;return I(n,e,s)&&I(n,e,m)&&I(n,i,m)&&I(n,i,s)}function I(n,t,e){return t>=n.xmin&&t<=n.xmax&&e>=n.ymin&&e<=n.ymax}class j{cut(n,t){let e;if(n.rings)this.closed=!0,e=n.rings,this.minPts=4;else{if(!n.paths)return null;this.closed=!1,e=n.paths,this.minPts=2}const s=e.length,i=-2*t;for(let n=0;n<s;n++){const t=e[n];if(t&&t.length>=this.minPts){const n=[];for(const e of t)n.push([e[0]+i,e[1]]);e.push(n)}}return this.closed?n.rings=e:n.paths=e,n}}const M=n();export{l as u}