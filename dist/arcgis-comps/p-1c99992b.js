import{d as n,e as t,u as r,z as o,c as i,i as u,r as c,g as e}from"./p-2f398ed1.js";import{s as f,c as s}from"./p-3c70d22f.js";import{b as a,n as p}from"./p-d3105731.js";function h(n){return n?{origin:a(n.origin),vector:a(n.vector)}:{origin:p(),vector:p()}}function l(n,t=h()){return M(n.origin,n.vector,t)}function M(n,t,r=h()){return c(r.origin,n),c(r.vector,t),r}function m(n,t,r=h()){return c(r.origin,n),i(r.vector,t,n),r}function d(r,u){const c=i(s.get(),u,r.origin),e=o(r.vector,c),f=o(r.vector,r.vector),a=t(e/f,0,1),p=i(s.get(),n(s.get(),r.vector,a),c);return o(p,p)}function g(t,o,i){return r(i,t.origin,n(i,t.vector,o))}function v(c,e,f,a,p){const{vector:h,origin:l}=c,M=i(s.get(),e,l),m=o(h,M)/u(h);return n(p,h,t(m,f,a)),r(p,p,c.origin)}function j(n,t){if(B(n,function(n,t){const r=w.get();return r.origin=n,r.vector=t,r}(t.origin,t.direction),!1,b)){const{tA:t,pB:o,distance2:i}=b;if(t>=0&&t<=1)return i;if(t<0)return e(n.origin,o);if(t>1)return e(r(s.get(),n.origin,n.vector),o)}return null}function A(n,t,r){return!!B(n,t,!0,b)&&(c(r,b.pA),!0)}function B(n,o,i,u){const c=1e-6,f=n.origin,a=r(s.get(),f,n.vector),p=o.origin,h=r(s.get(),p,o.vector),l=s.get(),M=s.get();if(l[0]=f[0]-p[0],l[1]=f[1]-p[1],l[2]=f[2]-p[2],M[0]=h[0]-p[0],M[1]=h[1]-p[1],M[2]=h[2]-p[2],Math.abs(M[0])<c&&Math.abs(M[1])<c&&Math.abs(M[2])<c)return!1;const m=s.get();if(m[0]=a[0]-f[0],m[1]=a[1]-f[1],m[2]=a[2]-f[2],Math.abs(m[0])<c&&Math.abs(m[1])<c&&Math.abs(m[2])<c)return!1;const d=l[0]*M[0]+l[1]*M[1]+l[2]*M[2],g=M[0]*m[0]+M[1]*m[1]+M[2]*m[2],v=l[0]*m[0]+l[1]*m[1]+l[2]*m[2],j=M[0]*M[0]+M[1]*M[1]+M[2]*M[2],A=(m[0]*m[0]+m[1]*m[1]+m[2]*m[2])*j-g*g;if(Math.abs(A)<c)return!1;let B=(d*g-v*j)/A,b=(d+g*B)/j;i&&(B=t(B,0,1),b=t(b,0,1));const w=s.get(),x=s.get();return w[0]=f[0]+B*m[0],w[1]=f[1]+B*m[1],w[2]=f[2]+B*m[2],x[0]=p[0]+b*M[0],x[1]=p[1]+b*M[1],x[2]=p[2]+b*M[2],u.tA=B,u.tB=b,u.pA=w,u.pB=x,u.distance2=e(w,x),!0}const b={tA:0,tB:0,pA:p(),pB:p(),distance2:0},w=new f((()=>({origin:null,vector:null})));export{v as A,j as B,d as b,l as h,g as j,A as k,m as l,M as m,h as v}