import{Z as e,be as r,A as n,bf as s,ak as t,bg as u,bh as i}from"./p-e58503d5.js";import{p as c}from"./p-8a919d07.js";const l={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer"},o=Object.values(l),a=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${o.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),f=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^\\/\\n]+)\\/(${o.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),v=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function m(e){return!!a.test(e)}function p(r){const n=e(r),s=n.path.match(a)||n.path.match(f);if(!s)return null;const[,t,u,i,c]=s,o=u.indexOf("/");return{title:S(-1!==o?u.slice(o+1):u),serverType:l[i.toLowerCase()],sublayer:null!=c&&""!==c?parseInt(c,10):null,url:{path:t}}}function g(r){const n=e(r).path.match(v);return n?{serviceUrl:n[1],sublayerId:Number(n[2])}:null}function S(e){return(e=e.replace(/\s*[/_]+\s*/g," "))[0].toUpperCase()+e.slice(1)}function b(e,r){const s=[];if(e){const r=p(e);n(r)&&r.title&&s.push(r.title)}if(r){const e=S(r);s.push(e)}if(2===s.length){if(-1!==s[0].toLowerCase().indexOf(s[1].toLowerCase()))return s[0];if(-1!==s[1].toLowerCase().indexOf(s[0].toLowerCase()))return s[1]}return s.join(" - ")}function d(e){if(!e)return!1;const r=-1!==(e=e.toLowerCase()).indexOf(".arcgis.com/"),n=-1!==e.indexOf("//services")||-1!==e.indexOf("//tiles")||-1!==e.indexOf("//features");return r&&n}function y(e,n){return e?s(r(e,n)):e}function w(t){let{url:u}=t;if(!u)return{url:u};u=r(u,t.logger);const i=e(u),c=p(i.path);let l;if(n(c))null!=c.sublayer&&null==t.layer.layerId&&(l=c.sublayer),u=c.url.path;else if(t.nonStandardUrlAllowed){const e=g(i.path);n(e)&&(u=e.serviceUrl,l=e.sublayerId)}return{url:s(u),layerId:l}}function h(e,r,n,s,u){c(r,s,"url",u),s.url&&null!=e.layerId&&(s.url=t(s.url,n,e.layerId.toString()))}function I(e){if(!e)return!1;const r=e.toLowerCase(),n=-1!==r.indexOf("/services/"),s=-1!==r.indexOf("/mapserver/wmsserver"),t=-1!==r.indexOf("/imageserver/wmsserver"),u=-1!==r.indexOf("/wmsserver");return n&&(s||t||u)}function j(e){if(!e)return!1;const r=new u(i(e)).authority.toLowerCase();return"server.arcgisonline.com"===r||"services.arcgisonline.com"===r}export{h as C,j as L,w as O,I as S,p as d,y as g,b as h,g as m,m as p,S as w,d as y}