'use strict';

const request = require('./messageBundle-8be88d04.js');
const HandleOwner = require('./HandleOwner-9c4c158c.js');
const mathUtils = require('./mathUtils-af6066f0.js');
const unitUtils = require('./unitUtils-083cb8d0.js');
const Graphic = require('./Graphic-0aff6059.js');
const executeQueryJSON = require('./executeQueryJSON-3f84e897.js');
const TopFeaturesQuery = require('./TopFeaturesQuery-92caa731.js');
const opacityUtils = require('./opacityUtils-f2e4b347.js');
const PopupTemplate = require('./PopupTemplate-a0b855f8.js');
const Heading = require('./Heading-d7c5e432.js');
const widget = require('./widget-b8f4aeaf.js');
const Query = require('./Query-354911d3.js');
const QueryTask = require('./QueryTask-3b24eec5.js');
const FeatureLayer = require('./FeatureLayer-68e51b64.js');
require('./geometry-ef17530a.js');
const SimpleLineSymbol = require('./symbols-29b793e5.js');
const Layer = require('./Layer-31cde361.js');
const utils = require('./utils-71e85012.js');
const Queue = require('./Queue-1713f2e9.js');
const layerViewUtils = require('./layerViewUtils-96bae70b.js');
const GoTo = require('./GoTo-be01affb.js');
const accessibleHandler = require('./accessibleHandler-652e5d90.js');
const vmEvent = require('./vmEvent-9b257013.js');
const screenUtils = require('./screenUtils-d911ae62.js');

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let c$f=null;function u$7(e,t){return Math.floor(Math.random()*(t-e+1)+e)}function y$8(e,t,l){const{backgroundColor:r,outline:i,dotSize:a}=e,n=l&&l.swatchSize||22,o=.8,s=Math.round(n*n/a**2*o),y=window.devicePixelRatio,p=document.createElement("canvas"),h=n*y;p.width=h,p.height=h,p.style.width=p.width/y+"px",p.style.height=p.height/y+"px";const b=p.getContext("2d");if(r&&(b.fillStyle=r.toCss(!0),b.fillRect(0,0,h,h),b.fill()),b.fillStyle=t.toCss(!0),c$f&&c$f.length/2===s)for(let u=0;u<2*s;u+=2){const e=c$f[u],t=c$f[u+1];b.fillRect(e,t,a*y,a*y),b.fill();}else {c$f=[];for(let e=0;e<2*s;e+=2){const e=u$7(0,h),t=u$7(0,h);c$f.push(e,t),b.fillRect(e,t,a*y,a*y),b.fill();}}i&&(i.color&&(b.strokeStyle=i.color.toCss(!0)),b.lineWidth=i.width,b.strokeRect(0,0,h,h));const f=new Image(n,n);return f.src=p.toDataURL(),f.style.filter=l.effect,f}function p$c(e,t={}){const l=24,r=75,i="horizontal"===t.align,a=i?r:l,n=i?l:r,{width:o=a,height:s=n,gradient:c=!0}=t,u=window.devicePixelRatio,y=o*u,p=s*u,h=document.createElement("canvas");h.width=y,h.height=p,h.style.width=`${o}px`,h.style.height=`${s}px`;const b=h.getContext("2d"),f=i?y:0,d=i?0:p;if(c){const t=b.createLinearGradient(0,0,f,d),l=e.length,r=1===l?0:1/(l-1);e.forEach(((e,l)=>t.addColorStop(l*r,e.toString()))),b.fillStyle=t,b.fillRect(0,0,y,p);}else {const t=i?y/e.length:y,l=i?p:p/e.length;let r=0,a=0;for(const n of e)b.fillStyle=n.toString(),b.fillRect(r,a,t,l),r=i?r+t:0,a=i?0:a+l;}const m=document.createElement("div");return m.style.width=`${o}px`,m.style.height=`${s}px`,m.style.filter=null==t?void 0:t.effect,m.appendChild(h),m}async function h$5(e,t){switch(e.type){case"web-style":{const{previewWebStyleSymbol:l}=await Promise.resolve().then(function () { return require('./previewWebStyleSymbol-7f050811.js'); });return l(e,h$5,t)}case"label-3d":case"line-3d":case"mesh-3d":case"point-3d":case"polygon-3d":{const{previewSymbol3D:l}=await Promise.resolve().then(function () { return require('./previewSymbol3D-65938e67.js'); });return l(e,t)}case"simple-marker":case"simple-line":case"simple-fill":case"picture-marker":case"picture-fill":case"text":{const{previewSymbol2D:l}=await Promise.resolve().then(function () { return require('./previewSymbol2D-5cdab756.js'); });return l(e,t)}case"cim":{const{previewCIMSymbol:l}=await Promise.resolve().then(function () { return require('./previewCIMSymbol-d30827a8.js'); });return l(e,t)}default:return}}function b$4(e){return e&&"opacity"in e?e.opacity*b$4(e.parent):1}async function f$8(o,s){var c,u;if(!o)return;const y=o.sourceLayer,p=null!=(c=request.r(s)&&null!=(u=s.useSourceLayer)&&u?y:o.layer)?c:y,h=b$4(p);if(request.r(o.symbol)&&(!request.r(s)||!0!==s.ignoreGraphicSymbol)){const t="web-style"===o.symbol.type?await o.symbol.fetchSymbol(request.r(s)?s.abortOptions:null):o.symbol.clone();return utils.v(t,null,h),t}const f=request.r(s)&&s.renderer||p&&"renderer"in p&&p.renderer;let d=f&&"getSymbolAsync"in f?await f.getSymbolAsync(o,s):null;if(!d)return;if(d="web-style"===d.type?await d.fetchSymbol(request.r(s)?s.abortOptions:null):d.clone(),!("visualVariables"in f)||!f.visualVariables||!f.visualVariables.length)return utils.v(d,null,h),d;if("arcadeRequiredForVisualVariables"in f&&f.arcadeRequiredForVisualVariables&&(request.t$1(s)||request.t$1(s.arcade))){const e={...request.e$2(s)};e.arcade=await opacityUtils.a(),s=e;}const m=await Promise.resolve().then(function () { return require('./visualVariableUtils-1740874b.js'); }),g=[],w=[],S=[],v=[];for(const e of f.visualVariables)switch(e.type){case"color":g.push(e);break;case"opacity":w.push(e);break;case"rotation":v.push(e);break;case"size":e.target||S.push(e);}const V=!!g.length&&g[g.length-1],x=V?m.getColor(V,o,s):null,R=!!w.length&&w[w.length-1];let C=R?m.getOpacity(R,o,s):null;if(null!=h&&(C=null!=C?C*h:h),utils.v(d,x,C),S.length){const e=m.getAllSizes(S,o,s);await utils.M(d,e);}for(const e of v)utils.q(d,m.getRotationAngle(e,o,s),e.axis);return d}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let c$e=class extends request.p{constructor(){super(...arguments),this.items=new request.S,this._watchUpdatingTracking=new HandleOwner.l,this._callbacks=new Map,this._projector=request.i$4(),this._hiddenProjector=request.i$4();}get needsRender(){return this.items.length>0}initialize(){const t=document.createElement("div");t.className="esri-overlay-surface",this._set("surface",t),this._hiddenSurface=document.createElement("div"),this._hiddenSurface.setAttribute("style","visibility: hidden;"),t.appendChild(this._hiddenSurface),this._watchUpdatingTracking.addOnCollectionChange(this.items,(t=>{for(const e of t.added){const t=()=>e.render();this._callbacks.set(e,t),this._projector.append(this.surface,t);}for(const e of t.removed){const t=this._projector.detach(this._callbacks.get(e));this.surface.removeChild(t.domNode),this._callbacks.delete(e);}}));}addItem(t){this.items.add(t);}removeItem(t){this.items.remove(t);}destroy(){this.items.removeAll(),this._callbacks.forEach((t=>this._projector.detach(t))),this._callbacks=null,this._projector=null,this._watchUpdatingTracking.destroy();}render(){this._projector.renderNow();}computeBoundingRect(t){const e=this._hiddenSurface,r=this._hiddenProjector;let o=null;const s=()=>(o=t.render(),o);r.append(e,s),r.renderNow();const i={left:0,top:0,right:0,bottom:0};if(o&&o.domNode){const t=o.domNode.getBoundingClientRect();i.left=t.left,i.top=t.top,i.right=t.right,i.bottom=t.bottom;}for(r.detach(s);e.firstChild;)e.removeChild(e.firstChild);return i}overlaps(t,e){const r=this.computeBoundingRect(t),o=this.computeBoundingRect(e);return Math.max(r.left,o.left)<=Math.min(r.right,o.right)&&Math.max(r.top,o.top)<=Math.min(r.bottom,o.bottom)}get hasVisibleItems(){return this.items.some((t=>t.visible))}renderCanvas(t){if(!this.items.some((t=>t.visible)))return;const e=t.getContext("2d");e.save(),e.font=`10px ${getComputedStyle(this.surface).fontFamily}`,this.items.forEach((t=>{e.save(),t.renderCanvas(e),e.restore();})),e.restore();}};request.e([request.d({readOnly:!0})],c$e.prototype,"surface",void 0),request.e([request.d({readOnly:!0})],c$e.prototype,"items",void 0),request.e([request.d({readOnly:!0})],c$e.prototype,"needsRender",null),request.e([request.d({readOnly:!0})],c$e.prototype,"_watchUpdatingTracking",void 0),request.e([request.d({readOnly:!0,aliasOf:"_watchUpdatingTracking.updating"})],c$e.prototype,"updating",void 0),c$e=request.e([request.i("esri.views.overlay.ViewOverlay")],c$e);const n$8=c$e;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function e$5(e,t,l,n){let u=null,a=1e3;"number"==typeof t?(a=t,n=l):(u=null!=t?t:null,a=l);let o,p=0;const r=()=>{p=0,e.apply(n,o);},c=(...e)=>{u&&u.apply(n,e),o=e,a?p||(p=setTimeout(r,a)):r();};return c.remove=()=>{p&&(clearTimeout(p),p=0);},c.forceUpdate=()=>{p&&(clearTimeout(p),r());},c.hasPendingUpdates=()=>!!p,c}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function a$4(t,n,i){return t.units[n][i]}function f$7(t,n,i,r=2,o="abbr"){return `${request.m(n,{minimumFractionDigits:r,maximumFractionDigits:r})} ${a$4(t,i,o)}`}function b$3(t,n,o,u=2,e="abbr"){const s=unitUtils.E(n,o);return f$7(t,unitUtils.D(n,o,s),s,u,e)}function l$7(t,n,i,u=2,e="abbr"){const s=unitUtils.N(n,i);return f$7(t,unitUtils.D(n,i,s),s,u,e)}function g$7(t,n,i,o=2,e="abbr"){const s=unitUtils.O(n,i);return f$7(t,unitUtils.D(n,i,s),s,o,e)}function F$2(t,n,i,o=2,u="abbr"){const s=unitUtils.F(n,i);return f$7(t,unitUtils.D(n,i,s),s,o,u)}function d$5(t,n,i=2){let o=unitUtils.D(t,n,"degrees"),u=o-Math.floor(o);o-=u,u*=60;let e=u-Math.floor(u);return u-=e,e*=60,`${o.toFixed()}Â° ${u.toFixed()}' ${e.toFixed(i)}"`}const D$3=["B","kB","MB","GB","TB"];function M$2(i,r){let o=0===r?0:Math.floor(Math.log(r)/Math.log(1024));o=mathUtils.e(o,0,D$3.length-1);const u=request.m(r/1024**o,{maximumFractionDigits:2});return request.r$8(i.units.bytes[D$3[o]],{fileSize:u})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$d="esri.widgets.Feature.support.featureUtils",d$4=request.s$1.getLogger(c$d),p$b=/href=(""|'')/gi,m$5=/(\{([^\{\r\n]+)\})/g,y$7=/\'/g,g$6=/^\s*expression\//i,h$4=/(\n)/gi,b$2=/[\u00A0-\u9999<>\&]/gim,F$1=/href\s*=\s*(?:\"([^\"]+)\"|\'([^\']+)\')/gi,I$3=/^(?:mailto:|tel:)/,w$4="relationships/",N$2=request.S$1("short-date-short-time");function x(e){if(!request.t$1(e))return e.get("sourceLayer")||e.get("layer")}async function E$1(e,t){return "function"==typeof e?e.call(null,t):e}function v$4(e=""){if(e)return !I$3.test(e.trim().toLowerCase())}function j$1(e){return !!e&&g$6.test(e)}function T$3(e,t){if(!j$1(t)||!e)return null;const r=t.replace(g$6,"").toLowerCase();let n;return e.some((e=>e.name.toLowerCase()===r&&(n=e,!0))),n}function C(e,t){const r=T$3(t,null==e?void 0:e.fieldName);return r?r.title||null:e?e.label||e.fieldName:null}function q$2(e,t){const r=t.get(e.toLowerCase());return `{${r&&r.fieldName||e}}`}function D$2(e){return e.replace(p$b,"")}function R$2(e,t){const r=M$1(t,e);return r?r.name:e}function L$1(e,t){return e&&e.map((e=>R$2(e,t)))}function M$1(e,t){return e&&"function"==typeof e.getField?e.getField(t):null}function U$3(e){return `${e}`.trim()}function $$1({attributes:e,globalAttributes:t,layer:r,text:n,expressionAttributes:i,fieldInfoMap:o}){return n?A$2({formattedAttributes:t,template:P$1(n,{...t,...i,...e},r),fieldInfoMap:o}):""}function A$2({formattedAttributes:e,template:t,fieldInfoMap:r}){return U$3(D$2(request.r$8(request.r$8(t,(e=>q$2(e,r))),e)))}function O$1(e,t,r=!1){const n=t[e];if("string"==typeof n){const i="%27",o=(r?encodeURIComponent(n):n).replace(y$7,i);t[e]=o;}}function S$3(e,t=!1){const r={...e};return Object.keys(r).forEach((e=>O$1(e,r,t))),r}function G$2(e,t,r){const i=(t=U$3(t))&&"{"!==t[0];return request.r$8(e,S$3(r,i))}function k(e,t){return e.replace(m$5,((e,r,n)=>{const i=M$1(t,n);return i?`{${i.name}}`:r}))}function P$1(e,t,r){const n=k(e,r);return n?n.replace(F$1,((e,r,n)=>G$2(e,r||n,t))):n}function _$3(e,t){if("string"==typeof e&&t&&null==t.dateFormat&&(null!=t.places||null!=t.digitSeparator)){const t=Number(e);if(!isNaN(t))return t}return e}function z$1(e){return "feature"===(null==e?void 0:e.type)}function H(e){return "map-image"===(null==e?void 0:e.type)}function Q$1(e){return !(null==e||!e.layer)}function Z(e,t){const r=t.fieldInfos,n=t.fieldName,i=B$4(r,n),o=null==i?void 0:i.clone(),l=t.preventPlacesFormatting,f=t.layer,c=M$1(f,n);if(o&&"date"===(null==c?void 0:c.type)){const e=o.format||new PopupTemplate.u;e.dateFormat=e.dateFormat||"short-date-short-time",e.dateTimeFormatOptions=z$1(f)&&f.datesInUnknownTimezone||Q$1(f)&&H(f.layer)&&f.layer.datesInUnknownTimezone?{timeZone:"UTC"}:null,o.format=e;}const d=o&&o.format;return "string"==typeof(e=_$3(e,d))||null==e||null==d?e:l?request.m(e,{...request.u$1(d),minimumFractionDigits:0,maximumFractionDigits:20}):d.format(e)}function B$4(e,t){if(!e||!e.length||!t)return;const r=t.toLowerCase();let n;return e.some((e=>!(!e.fieldName||e.fieldName.toLowerCase()!==r)&&(n=e,!0))),n}function J({fieldName:e,graphic:t,layer:r}){if(ae(e))return null;if(!r||"function"!=typeof r.getFeatureType)return null;const{typeIdField:n}=r;if(!n||e!==n)return null;const i=r.getFeatureType(t);return i?i.name:null}function K({fieldName:e,value:t,graphic:r,layer:n}){if(ae(e))return null;if(!n||"function"!=typeof n.getFieldDomain)return null;const i=n.getFieldDomain(e,{feature:r});return i&&"coded-value"===i.type?i.getName(t):null}function V$1(e,t){const{creatorField:r,creationDateField:n,editorField:o,editDateField:a}=e;if(!t)return;const u=t[a];if("number"==typeof u){const e=t[o];return {type:"edit",date:request.L$1(u,N$2),user:e}}const l=t[n];if("number"==typeof l){const e=t[r];return {type:"create",date:request.L$1(l,N$2),user:e}}return null}function W(e,t){const r=new Map;return e&&e.forEach((e=>{const n=R$2(e.fieldName,t);e.fieldName=n,r.set(n.toLowerCase(),e);})),r}function X(e){const t=[];if(!e)return t;const{fieldInfos:r,content:n}=e;return r&&t.push(...r),n&&Array.isArray(n)?(n.forEach((e=>{if("fields"===e.type){const r=e&&e.fieldInfos;r&&t.push(...r);}})),t):t}function Y(e){return e.replace(b$2,(e=>`&#${e.charCodeAt(0)};`))}function ee(e){return "string"==typeof e?e.replace(h$4,'<br class="esri-text-new-line" />'):e}function te(e){const{value:t,fieldName:r,fieldInfos:n,fieldInfoMap:o,layer:a,graphic:u}=e;if(null==t)return "";const l=K({fieldName:r,value:t,graphic:u,layer:a});if(l)return l;const s=J({fieldName:r,graphic:u,layer:a});if(s)return s;if(o.get(r.toLowerCase()))return Z(t,{fieldInfos:n,fieldName:r,layer:a});const f=a&&a.fieldsIndex;return f&&f.isDateField(r)?request.L$1(t,N$2):ee(t)}function re({fieldInfos:e,attributes:t,layer:r,graphic:n,fieldInfoMap:i,relatedInfos:o}){const a={};return null==o||o.forEach((e=>se(a,e))),Object.keys(t).forEach((o=>{const u=t[o];a[o]=te({fieldName:o,fieldInfos:e,fieldInfoMap:i,layer:r,value:u,graphic:n});})),a}async function ne(e,t){var r,n;const{layer:i,graphic:o,outFields:a,objectIds:u,returnGeometry:l,spatialReference:s}=e,f=u[0];if("number"!=typeof f&&"string"!=typeof f){const e="Could not query required fields for the specified feature. The feature's ID is invalid.",t={layer:i,graphic:o,objectId:f,requiredFields:a};return d$4.warn(e,t),null}if(null==(r=i.capabilities)||null==(n=r.operations)||!n.supportsQuery){const e="The specified layer cannot be queried. The following fields will not be available.",t={layer:i,graphic:o,requiredFields:a,returnGeometry:l};return d$4.warn(e,t),null}const c=i.createQuery();c.objectIds=u,c.outFields=null!=a&&a.length?a:[i.objectIdField],c.returnGeometry=!!l,c.returnZ=!!l,c.returnM=!!l,c.outSpatialReference=s;return (await i.queryFeatures(c,t)).features[0]}async function ie(e){var t;if(null==(t=e.expressionInfos)||!t.length)return !1;const r=await opacityUtils.a(),{arcadeUtils:{hasGeometryFunctions:n}}=r;return n(e)}async function oe({graphic:e,popupTemplate:t,layer:r,spatialReference:n},i){if(!r||!t)return;if("function"==typeof r.load&&await r.load(i),!e.attributes)return;const o=e.attributes[r.objectIdField];if(null==o)return;const a=[o],u=await t.getRequiredFields(r.fieldsIndex),s=opacityUtils.ce(u,e),f=s?[]:u,c=t.returnGeometry||await ie(t);if(s&&!c)return;const d=await ne({layer:r,graphic:e,outFields:f,objectIds:a,returnGeometry:c,spatialReference:n},i);d&&(d.geometry&&(e.geometry=d.geometry),d.attributes&&(e.attributes={...e.attributes,...d.attributes}));}function ae(e=""){return !!e&&-1!==e.indexOf(w$4)}function ue(e){return e?`${w$4}${e.layerId}/${e.fieldName}`:""}function le({attributes:e,graphic:t,relatedInfo:r}){e&&t&&r&&Object.keys(t.attributes).forEach((n=>{const i=ue({layerId:r.relation.id.toString(),fieldName:n});e[i]=t.attributes[n];}));}function se(e,t){e&&t&&(t.relatedFeatures&&t.relatedFeatures&&t.relatedFeatures.forEach((r=>le({attributes:e,graphic:r,relatedInfo:t}))),t.relatedStatsFeatures&&t.relatedStatsFeatures&&t.relatedStatsFeatures.forEach((r=>le({attributes:e,graphic:r,relatedInfo:t}))));}const fe=e=>{if(!e)return !1;const t=e.toUpperCase();return t.indexOf("CURRENT_TIMESTAMP")>-1||t.indexOf("CURRENT_DATE")>-1||t.indexOf("CURRENT_TIME")>-1},ce=({layer:e,method:t,query:n,definitionExpression:i})=>{var o,a;if(null==(o=e.capabilities)||null==(a=o.query)||!a.supportsCacheHint||"attachments"===t)return;const u=request.r(n.where)&&n.where,l=request.r(n.geometry)&&n.geometry;fe(i)||fe(u)||"extent"===(null==l?void 0:l.type)||"tile"===n.resultType||(n.cacheHint=!0);},de=({query:e,layer:t,method:r})=>{ce({layer:t,method:r,query:e,definitionExpression:`${t.definitionExpression} ${t.serviceDefinitionExpression}`});},pe=({queryPayload:e,layer:t,method:r})=>{ce({layer:t,method:r,query:e,definitionExpression:`${t.definitionExpression} ${t.serviceDefinitionExpression}`});};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const p$a={editing:!1,operations:{add:!0,update:!0,delete:!0}},u$6=request.S.ofType(executeQueryJSON.l),y$6="graphic.layer.capabilities.operations.supportsResizeAttachments";let f$6=class extends HandleOwner.d{constructor(t){super(t),this._getAttachmentsPromise=null,this._attachmentLayer=null,this.abilities={...p$a},this.activeAttachmentInfo=null,this.attachmentInfos=new u$6,this.graphic=null,this.mode="view",this.handles.add([request.i$1(this,"graphic",(()=>this._graphicChanged()))]);}destroy(){this._attachmentLayer=null,this.graphic=null;}castAbilities(t){return {...p$a,...t}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){return this.get(y$6)||!1}async getAttachments(){const{_attachmentLayer:t,attachmentInfos:e}=this;if(!t||"function"!=typeof t.queryAttachments)throw new request.s("invalid-layer","getAttachments(): A valid layer is required.");const a=this._getFeatureId(),n=new TopFeaturesQuery.u({objectIds:[a],returnMetadata:!0}),r=[],s=t.queryAttachments(n).then((t=>t[a]||r)).catch((()=>r));this._getAttachmentsPromise=s,this.notifyChange("state");const o=await s;return e.removeAll(),o.length&&e.addMany(o),this._getAttachmentsPromise=null,this.notifyChange("state"),o}async addAttachment(t){const{_attachmentLayer:e,attachmentInfos:a,graphic:n,abilities:r}=this;if(!t)throw new request.s("invalid-attachment","addAttachment(): An attachment is required.",{attachment:t});if(!r.operations.add)throw new request.s("invalid-abilities","addAttachment(): add abilities are required.");if(!e||"function"!=typeof e.addAttachment)throw new request.s("invalid-layer","addAttachment(): A valid layer is required.");const s=e.addAttachment(n,t).then((t=>this._queryAttachment(t.objectId))),o=await s;return a.add(o),o}async deleteAttachment(t){const{_attachmentLayer:e,attachmentInfos:a,graphic:n,abilities:r}=this;if(!t)throw new request.s("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:t});if(!r.operations.delete)throw new request.s("invalid-abilities","deleteAttachment(): delete abilities are required.");if(!e||"function"!=typeof e.deleteAttachments)throw new request.s("invalid-layer","deleteAttachment(): A valid layer is required.");const s=e.deleteAttachments(n,[t.id]).then((()=>t)),o=await s;return a.remove(o),o}async updateAttachment(t,e=this.activeAttachmentInfo){const{_attachmentLayer:a,attachmentInfos:n,graphic:r,abilities:s}=this;if(!t)throw new request.s("invalid-attachment","updateAttachment(): An attachment is required.",{attachment:t});if(!e)throw new request.s("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:e});if(!s.operations.update)throw new request.s("invalid-abilities","updateAttachment(): Update abilities are required.");const o=n.findIndex((t=>t===e));if(!a||"function"!=typeof a.updateAttachment)throw new request.s("invalid-layer","updateAttachment(): A valid layer is required.");const c=a.updateAttachment(r,e.id,t).then((t=>this._queryAttachment(t.objectId))),h=await c;return n.splice(o,1,h),h}async _queryAttachment(t){if(!t)throw new request.s("invalid-attachment-id","Could not query attachment.");const{_attachmentLayer:e}=this,a=this._getFeatureId(),n=new TopFeaturesQuery.u({objectIds:[a],attachmentsWhere:`AttachmentId=${t}`,returnMetadata:!0});return e.queryAttachments(n).then((t=>t[a][0]))}_getFeatureId(){const{_attachmentLayer:t,graphic:e}=this;if(!t||!e)return null;const{objectIdField:a}=t,{attributes:i}=e;return i&&i[a]}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch((()=>{})));}_setAttachmentLayer(){const{graphic:t}=this,e=x(t);this._attachmentLayer=e?"scene"===e.type&&request.r(e.associatedLayer)?e.associatedLayer:e:null;}};request.e([request.d()],f$6.prototype,"abilities",void 0),request.e([request.c("abilities")],f$6.prototype,"castAbilities",null),request.e([request.d()],f$6.prototype,"activeAttachmentInfo",void 0),request.e([request.d({readOnly:!0,type:u$6})],f$6.prototype,"attachmentInfos",void 0),request.e([request.d({type:Graphic.h})],f$6.prototype,"graphic",void 0),request.e([request.d()],f$6.prototype,"mode",void 0),request.e([request.d({readOnly:!0})],f$6.prototype,"state",null),request.e([request.d({readOnly:!0})],f$6.prototype,"supportsResizeAttachments",null),f$6=request.e([request.i("esri.widgets.Attachments.AttachmentsViewModel")],f$6);const A$1=f$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function e$4(i){const e=i.toLowerCase();return "image/bmp"===e||"image/emf"===e||"image/exif"===e||"image/gif"===e||"image/x-icon"===e||"image/jpeg"===e||"image/png"===e||"image/tiff"===e||"image/x-wmf"===e}function p$9(e){const p=request.a$1("esri/themes/base/images/files/");return e?"text/plain"===e?`${p}text-32.svg`:"application/pdf"===e?`${p}pdf-32.svg`:"text/csv"===e?`${p}csv-32.svg`:"application/gpx+xml"===e?`${p}gpx-32.svg`:"application/x-dwf"===e?`${p}cad-32.svg`:"application/postscript"===e||"application/json"===e||"text/xml"===e||"model/vrml"===e?`${p}code-32.svg`:"application/x-zip-compressed"===e||"application/x-7z-compressed"===e||"application/x-gzip"===e||"application/x-tar"===e||"application/x-gtar"===e||"application/x-bzip2"===e||"application/gzip"===e||"application/x-compress"===e||"application/x-apple-diskimage"===e||"application/x-rar-compressed"===e||"application/zip"===e?`${p}zip-32.svg`:-1!==e.indexOf("image/")?`${p}image-32.svg`:-1!==e.indexOf("audio/")?`${p}sound-32.svg`:-1!==e.indexOf("video/")?`${p}video-32.svg`:-1!==e.indexOf("msexcel")||-1!==e.indexOf("ms-excel")||-1!==e.indexOf("spreadsheetml")?`${p}excel-32.svg`:-1!==e.indexOf("msword")||-1!==e.indexOf("ms-word")||-1!==e.indexOf("wordprocessingml")?`${p}word-32.svg`:-1!==e.indexOf("powerpoint")||-1!==e.indexOf("presentationml")?`${p}report-32.svg`:`${p}generic-32.svg`:`${p}generic-32.svg`}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const f$5={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},v$3={base:"esri-attachments",loaderContainer:"esri-attachments__loader-container",loader:"esri-attachments__loader",fadeIn:"esri-attachments--fade-in",container:"esri-attachments__container",containerList:"esri-attachments__container--list",containerPreview:"esri-attachments__container--preview",actions:"esri-attachments__actions",deleteButton:"esri-attachments__delete-button",addAttachmentButton:"esri-attachments__add-attachment-button",errorMessage:"esri-attachments__error-message",items:"esri-attachments__items",item:"esri-attachments__item",itemButton:"esri-attachments__item-button",itemMask:"esri-attachments__item-mask",itemMaskIcon:"esri-attachments__item-mask--icon",itemImage:"esri-attachments__image",itemImageResizable:"esri-attachments__image--resizable",itemLabel:"esri-attachments__label",itemFilename:"esri-attachments__filename",itemChevronIcon:"esri-attachments__item-chevron-icon",itemLink:"esri-attachments__item-link",itemLinkOverlay:"esri-attachments__item-link-overlay",itemLinkOverlayIcon:"esri-attachments__item-link-overlay-icon",itemEditIcon:"esri-attachments__item-edit-icon",itemAddIcon:"esri-attachments__item-add-icon",itemAddButton:"esri-attachments__item-add-button",formNode:"esri-attachments__form-node",fileFieldset:"esri-attachments__file-fieldset",fileLabel:"esri-attachments__file-label",fileName:"esri-attachments__file-name",fileInput:"esri-attachments__file-input",metadata:"esri-attachments__metadata",metadataFieldset:"esri-attachments__metadata-fieldset",progressBar:"esri-attachments__progress-bar",esriWidget:"esri-widget",esriButton:"esri-button",buttonDisabled:"esri-button--disabled",esriButtonSecondary:"esri-button--secondary",esriButtonTertiary:"esri-button--tertiary",esriButtonThird:"esri-button--third",esriButtonSmall:"esri-button--small",esriButtonHalf:"esri-button--half",empty:"esri-widget__content--empty",iconExternalLink:"esri-icon-link-external",iconEdit:"esri-icon-edit",iconRight:"esri-icon-right",iconLeft:"esri-icon-left",iconPlus:"esri-icon-plus"},y$5=window.CSS;let B$3=class extends request.z{constructor(t,e){super(t,e),this.abilities=null,this.displayType="auto",this.graphic=null,this.label=void 0,this.messages=null,this.messagesUnits=null,this.selectedFile=null,this.submitting=!1,this.viewModel=new A$1,this.visibleElements={...f$5},this._supportsImageOrientation=y$5&&y$5.supports&&y$5.supports("image-orientation","from-image"),this._addAttachmentForm=null,this._updateAttachmentForm=null;}initialize(){this.own(request.$(this,"viewModel.attachmentInfos","change",(()=>this.scheduleRender())),request.i$1(this,"viewModel.mode",(()=>this._modeChanged())));}get effectiveDisplayType(){return "auto"===this.displayType?this.viewModel.supportsResizeAttachments?"preview":"list":this.displayType}castVisibleElements(t){return {...f$5,...t}}addAttachment(){const{_addAttachmentForm:t,viewModel:s}=this;return this._set("submitting",!0),this._set("error",null),s.addAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),s.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new request.s("attachments:add-attachment",this.messages.addErrorMessage,t)),t}))}deleteAttachment(t){const{viewModel:s}=this;return this._set("submitting",!0),this._set("error",null),s.deleteAttachment(t).then((t=>(this._set("submitting",!1),this._set("error",null),s.mode="view",t))).catch((t=>{throw this._set("submitting",!1),this._set("error",new request.s("attachments:delete-attachment",this.messages.deleteErrorMessage,t)),t}))}updateAttachment(){const{viewModel:t}=this,{_updateAttachmentForm:s}=this;return this._set("submitting",!0),this._set("error",null),t.updateAttachment(s).then((e=>(this._set("submitting",!1),this._set("error",null),t.mode="view",e))).catch((t=>{throw this._set("submitting",!1),this._set("error",new request.s("attachments:update-attachment",this.messages.updateErrorMessage,t)),t}))}render(){const{submitting:t,viewModel:e}=this,{state:s}=e;return request.n$1("div",{class:this.classes(v$3.base,v$3.esriWidget)},t?this.renderProgressBar():null,"loading"===s?this.renderLoading():this.renderAttachments(),this.renderErrorMessage())}renderErrorMessage(){const{error:t,visibleElements:e}=this;return t&&e.errorMessage?request.n$1("div",{key:"error-message",class:v$3.errorMessage},t.message):null}renderAttachments(){const{mode:t,activeAttachmentInfo:e}=this.viewModel;return "add"===t?this.renderAddForm():"edit"===t?this.renderDetailsForm(e):this.renderAttachmentContainer()}renderLoading(){return request.n$1("div",{class:v$3.loaderContainer,key:"loader"},request.n$1("div",{class:v$3.loader}))}renderProgressBar(){return this.visibleElements.progressBar?request.n$1("div",{class:v$3.progressBar,key:"progress-bar"}):null}renderAddForm(){const{submitting:t,selectedFile:e}=this,s=t||!e,i=this.visibleElements.cancelAddButton?request.n$1("button",{type:"button",bind:this,disabled:t,onclick:this._cancelForm,class:this.classes(v$3.esriButton,v$3.esriButtonTertiary,v$3.esriButtonSmall,v$3.esriButtonHalf,t&&v$3.buttonDisabled)},this.messages.cancel):null,a=this.visibleElements.addSubmitButton?request.n$1("button",{type:"submit",disabled:s,class:this.classes(v$3.esriButton,v$3.esriButtonSecondary,v$3.esriButtonSmall,v$3.esriButtonHalf,{[v$3.buttonDisabled]:s})},this.messages.add):null,n=e?request.n$1("span",{key:"file-name",class:v$3.fileName},e.name):null,r=request.n$1("form",{bind:this,afterCreate:request.g$2,afterRemoved:request.p$4,"data-node-ref":"_addAttachmentForm",onsubmit:this._submitAddAttachment},request.n$1("fieldset",{class:v$3.fileFieldset},n,request.n$1("label",{class:this.classes(v$3.fileLabel,v$3.esriButton,v$3.esriButtonSecondary)},e?this.messages.changeFile:this.messages.selectFile,request.n$1("input",{class:v$3.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))),a,i);return request.n$1("div",{key:"add-form-container",class:v$3.formNode},r)}renderDetailsForm(t){const{visibleElements:e,viewModel:i,selectedFile:a,submitting:n}=this,{contentType:r,size:o,url:l}=t,{abilities:m}=i,d=n||!a,c=m.editing&&m.operations.delete&&e.deleteButton?request.n$1("button",{key:"delete-button",type:"button",disabled:n,bind:this,onclick:e=>this._submitDeleteAttachment(e,t),class:this.classes(v$3.esriButton,v$3.esriButtonSmall,v$3.esriButtonTertiary,v$3.deleteButton,{[v$3.buttonDisabled]:n})},this.messages.delete):null,h=m.editing&&m.operations.update&&e.updateButton?request.n$1("button",{disabled:d,key:"update-button",type:"submit",class:this.classes(v$3.esriButton,v$3.esriButtonSmall,v$3.esriButtonThird,{[v$3.buttonDisabled]:d})},this.messages.update):null,b=this.visibleElements.cancelUpdateButton?request.n$1("button",{disabled:n,key:"cancel-button",type:"button",bind:this,onclick:this._cancelForm,class:this.classes(v$3.esriButton,v$3.esriButtonSmall,v$3.esriButtonTertiary,v$3.esriButtonThird,{[v$3.buttonDisabled]:n})},this.messages.cancel):null,g=a?request.n$1("span",{key:"file-name",class:v$3.fileName},a.name):null,f=m.editing&&m.operations.update?request.n$1("fieldset",{key:"file",class:v$3.fileFieldset},g,request.n$1("label",{class:this.classes(v$3.fileLabel,v$3.esriButton,v$3.esriButtonSecondary)},this.messages.changeFile,request.n$1("input",{class:v$3.fileInput,type:"file",name:"attachment",bind:this,onchange:this._handleFileInputChange}))):null,y=request.n$1("fieldset",{key:"size",class:v$3.metadataFieldset},request.n$1("label",null,M$2(this.messagesUnits,o))),B=request.n$1("fieldset",{key:"content-type",class:v$3.metadataFieldset},request.n$1("label",null,r)),A=request.n$1("form",{bind:this,afterCreate:request.g$2,afterRemoved:request.p$4,"data-node-ref":"_updateAttachmentForm",onsubmit:this._submitUpdateAttachment},request.n$1("div",{class:v$3.metadata},y,B),f,request.n$1("div",{class:v$3.actions},c,b,h));return request.n$1("div",{key:"edit-form-container",class:v$3.formNode},request.n$1("a",{class:v$3.itemLink,href:l,rel:"noreferrer",target:"_blank"},this.renderImageMask({attachmentInfo:t,size:400}),request.n$1("div",{class:v$3.itemLinkOverlay},request.n$1("span",{class:v$3.itemLinkOverlayIcon},request.n$1("svg",{xmlns:"http://www.w3.org/2000/svg",width:"32",height:"32",viewBox:"0 0 32 32"},request.n$1("path",{d:"M28 13h1v16H3V3h16v1H4v24h24zm-5-9h4.293L15.646 15.638l.707.707L28 4.707V9h1V3h-6z"}),request.n$1("path",{fill:"none",d:"M0 0h32v32H0z"}))))),A)}renderImageMask({attachmentInfo:t,size:e}){const{supportsResizeAttachments:s}=this.viewModel,{contentType:i,name:a,url:n}=t,r=s&&e$4(i),o=this._getCSSTransform(t,r),l=o?{transform:o,"image-orientation":"none"}:{},m=-1===n.indexOf("?")?"?":"&",d=r?`${n}${m}w=${e}`:p$9(i),u={[v$3.itemMaskIcon]:!r},p={[v$3.itemImageResizable]:s};return request.n$1("div",{class:this.classes(u,v$3.itemMask)},request.n$1("img",{styles:l,alt:a,src:d,class:this.classes(p,v$3.itemImage)}))}renderAttachmentInfo({attachmentInfo:t,displayType:e}){const{viewModel:s}=this,{abilities:i}=s,{name:a,url:n}=t,r=this.renderImageMask({attachmentInfo:t,size:"list"===e?48:400}),o=i.editing?request.n$1("span",{"aria-hidden":"true",class:this.classes(v$3.itemChevronIcon,request.d$3(this.container)?v$3.iconLeft:v$3.iconRight)}):null,l=[r,request.n$1("label",{class:v$3.itemLabel},request.n$1("span",{class:v$3.itemFilename},a||this.messages.noTitle),o)],m=i.editing?request.n$1("button",{key:"details-button",bind:this,class:v$3.itemButton,title:this.messages.attachmentDetails,"aria-label":this.messages.attachmentDetails,"data-attachment-info-id":t.id,onclick:()=>this._startEditAttachment(t),type:"button"},l):request.n$1("a",{key:"details-link",class:v$3.itemButton,href:n,target:"_blank"},l);return request.n$1("li",{class:v$3.item,key:t},m)}renderAttachmentContainer(){const{effectiveDisplayType:t,viewModel:e,visibleElements:s}=this,{attachmentInfos:i,abilities:a}=e,n=i&&i.length,r={[v$3.containerList]:"preview"!==t,[v$3.containerPreview]:"preview"===t},o=a.editing&&a.operations.add&&s.addButton?request.n$1("button",{bind:this,onclick:()=>this._startAddAttachment(),class:this.classes(v$3.esriButton,v$3.esriButtonTertiary,v$3.addAttachmentButton),type:"button"},request.n$1("span",{"aria-hidden":"true",class:this.classes(v$3.itemAddIcon,v$3.iconPlus)}),this.messages.add):null,l=n?request.n$1("ul",{class:v$3.items},i.toArray().map((e=>this.renderAttachmentInfo({attachmentInfo:e,displayType:t})))):request.n$1("div",{class:v$3.empty},this.messages.noAttachments);return request.n$1("div",{key:"attachments-container",class:this.classes(v$3.container,r)},l,o)}_modeChanged(){this._set("error",null),this._set("selectedFile",null);}_handleFileInputChange(t){const e=t.target,s=e&&e.files&&e.files.item(0);this._set("selectedFile",s);}_submitDeleteAttachment(t,e){t.preventDefault(),this.deleteAttachment(e);}_submitAddAttachment(t){t.preventDefault(),this.addAttachment();}_submitUpdateAttachment(t){t.preventDefault(),this.updateAttachment();}_startEditAttachment(t){const{viewModel:e}=this;e.activeAttachmentInfo=t,e.mode="edit";}_startAddAttachment(){this.viewModel.mode="add";}_cancelForm(t){t.preventDefault(),this.viewModel.mode="view";}_getCSSTransform(t,e){const{orientationInfo:s}=t;return !this._supportsImageOrientation&&e&&s?[s.rotation?`rotate(${s.rotation}deg)`:"",s.mirrored?"scaleX(-1)":""].join(" "):""}};request.e([request.o("viewModel.abilities")],B$3.prototype,"abilities",void 0),request.e([request.d()],B$3.prototype,"displayType",void 0),request.e([request.d({readOnly:!0})],B$3.prototype,"effectiveDisplayType",null),request.e([request.o("viewModel.graphic")],B$3.prototype,"graphic",void 0),request.e([request.d({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],B$3.prototype,"label",void 0),request.e([request.d(),request.e$1("esri/widgets/Attachments/t9n/Attachments")],B$3.prototype,"messages",void 0),request.e([request.d(),request.e$1("esri/core/t9n/Units")],B$3.prototype,"messagesUnits",void 0),request.e([request.d({readOnly:!0})],B$3.prototype,"selectedFile",void 0),request.e([request.d({readOnly:!0})],B$3.prototype,"submitting",void 0),request.e([request.d({readOnly:!0})],B$3.prototype,"error",void 0),request.e([request.d({type:A$1})],B$3.prototype,"viewModel",void 0),request.e([request.d()],B$3.prototype,"visibleElements",void 0),request.e([request.c("visibleElements")],B$3.prototype,"castVisibleElements",null),B$3=request.e([request.i("esri.widgets.Attachments")],B$3);const A=B$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let o$4=class extends A$1{constructor(t){super(t),this.description=null,this.title=null;}};request.e([request.d()],o$4.prototype,"description",void 0),request.e([request.d()],o$4.prototype,"title",void 0),o$4=request.e([request.i("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],o$4);const c$c=o$4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const p$8={base:"esri-feature-element-info",title:"esri-feature-element-info__title",description:"esri-feature-element-info__description"};let n$7=class extends request.z{constructor(e,t){super(e,t),this.description=null,this.headingLevel=2,this.title=null;}render(){return request.n$1("div",{class:p$8.base},this.renderTitle(),this.renderDescription())}renderTitle(){const{title:e}=this;return e?request.n$1(Heading.s,{level:this.headingLevel,class:p$8.title},e):null}renderDescription(){const{description:e}=this;return e?request.n$1("div",{key:"description",class:p$8.description},e):null}};request.e([request.d()],n$7.prototype,"description",void 0),request.e([request.d()],n$7.prototype,"headingLevel",void 0),request.e([request.d()],n$7.prototype,"title",void 0),n$7=request.e([request.i("esri.widgets.Feature.support.FeatureElementInfo")],n$7);const c$b=n$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const d$3={base:"esri-feature-attachments"};let c$a=class extends request.z{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attachmentsWidget=new A,this.description=null,this.displayType=null,this.graphic=null,this.headingLevel=2,this.title=null,this.viewModel=new c$c;}initialize(){this._featureElementInfo=new c$b,request.i$1(this,["viewModel.description","viewModel.title","headingLevel"],(()=>this._setupFeatureElementInfo())),request.i$1(this,"viewModel.graphic",(e=>this.attachmentsWidget.graphic=e));}destroy(){this.attachmentsWidget.destroy(),this._featureElementInfo.destroy();}render(){var e;const{attachmentsWidget:t}=this;return request.n$1("div",{class:d$3.base},null==(e=this._featureElementInfo)?void 0:e.render(),null==t?void 0:t.render())}_setupFeatureElementInfo(){const{description:e,title:t,headingLevel:o}=this;this._featureElementInfo.set({description:e,title:t,headingLevel:o});}};request.e([request.d({readOnly:!0})],c$a.prototype,"attachmentsWidget",void 0),request.e([request.o("viewModel.description")],c$a.prototype,"description",void 0),request.e([request.o("attachmentsWidget.displayType")],c$a.prototype,"displayType",void 0),request.e([request.o("viewModel.graphic")],c$a.prototype,"graphic",void 0),request.e([request.d()],c$a.prototype,"headingLevel",void 0),request.e([request.o("viewModel.title")],c$a.prototype,"title",void 0),request.e([request.d({type:c$c})],c$a.prototype,"viewModel",void 0),c$a=request.e([request.i("esri.widgets.Feature.FeatureAttachments")],c$a);const m$4=c$a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let n$6=class extends(HandleOwner.a(request.p)){constructor(t){super(t),this._loadingPromise=null,this.created=null,this.creator=null,this.destroyer=null,this.graphic=null,this.handles.add(request.i$1(this,"creator",(t=>{this._destroyContent(),this._createContent(t);})));}destroy(){this._destroyContent();}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const{created:t,graphic:r,destroyer:e}=this;t&&(E$1(e,{graphic:r}).catch((()=>null)),this._set("created",null));}async _createContent(t){const{graphic:r}=this,e=E$1(t,{graphic:r}).catch((()=>null));this._loadingPromise=e,this.notifyChange("state");const o=await e;e===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",o));}};request.e([request.d({readOnly:!0})],n$6.prototype,"created",void 0),request.e([request.d()],n$6.prototype,"creator",void 0),request.e([request.d()],n$6.prototype,"destroyer",void 0),request.e([request.d({type:Graphic.h})],n$6.prototype,"graphic",void 0),request.e([request.d({readOnly:!0})],n$6.prototype,"state",null),n$6=request.e([request.i("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],n$6);const p$7=n$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$9={base:"esri-feature-content",loaderContainer:"esri-feature-content__loader-container",loader:"esri-feature-content__loader"};let l$6=class extends request.z{constructor(e,r){super(e,r),this.creator=null,this.graphic=null,this.viewModel=null,this._addTargetToAnchors=e=>{Array.from(e.querySelectorAll("a")).forEach((e=>{v$4(e.href)&&!e.hasAttribute("target")&&e.setAttribute("target","_blank");}));};}renderLoading(){return request.n$1("div",{class:c$9.loaderContainer,key:"loader"},request.n$1("div",{class:c$9.loader}))}renderCreated(){var e;const r=null==(e=this.viewModel)?void 0:e.created;return r?r instanceof HTMLElement?request.n$1("div",{key:r,bind:r,afterCreate:this._attachToNode}):widget.e(r)?request.n$1("div",{key:r},!r.destroyed&&r.render()):request.n$1("div",{key:r,innerHTML:r,afterCreate:this._addTargetToAnchors}):null}render(){var e;const r=null==(e=this.viewModel)?void 0:e.state;return request.n$1("div",{class:c$9.base},"loading"===r?this.renderLoading():this.renderCreated())}_attachToNode(e){const r=this;e.appendChild(r);}};request.e([request.o("viewModel.creator")],l$6.prototype,"creator",void 0),request.e([request.o("viewModel.graphic")],l$6.prototype,"graphic",void 0),request.e([request.d({type:p$7})],l$6.prototype,"viewModel",void 0),l$6=request.e([request.i("esri.widgets.Feature.FeatureContent")],l$6);const p$6=l$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let l$5=class extends request.p{constructor(o){super(o),this.attributes=null,this.expressionInfos=null,this.description=null,this.fieldInfos=null,this.title=null;}get formattedFieldInfos(){const{expressionInfos:o,fieldInfos:e}=this,s=[];return null==e||e.forEach((e=>{if(!(!e.hasOwnProperty("visible")||e.visible))return;const t=e.clone();t.label=C(t,o),s.push(t);})),s}};request.e([request.d()],l$5.prototype,"attributes",void 0),request.e([request.d({type:[PopupTemplate.i]})],l$5.prototype,"expressionInfos",void 0),request.e([request.d()],l$5.prototype,"description",void 0),request.e([request.d({type:[PopupTemplate.c$2]})],l$5.prototype,"fieldInfos",void 0),request.e([request.d({readOnly:!0})],l$5.prototype,"formattedFieldInfos",null),request.e([request.d()],l$5.prototype,"title",void 0),l$5=request.e([request.i("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],l$5);const n$5=l$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const s$3=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];function a$3(e){let a=null;return s$3.some((s=>(s.pattern.test(e)&&(a=s),!!a))),a}function p$5(s,p){if("string"!=typeof p||!p)return p;const r=a$3(p);if(!r)return p;const t=p.match(r.pattern),n=t&&t[2],l=request.r$8(request.r$8(r.label,{messages:s,hierPart:n}),{appName:r.appName}),i=r.target?` target="${r.target}"`:"",o="_blank"===r.target?' rel="noreferrer"':"";return p.replace(r.pattern,`<a${i} href="$1"${o}>${l}</a>`)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const f$4={base:"esri-feature-fields",fieldHeader:"esri-feature-fields__field-header",fieldData:"esri-feature-fields__field-data",fieldDataDate:"esri-feature-fields__field-data--date",esriTable:"esri-widget__table"};let u$5=class extends request.z{constructor(e,t){super(e,t),this._featureElementInfo=null,this.attributes=null,this.description=null,this.expressionInfos=null,this.fieldInfos=null,this.title=null,this.viewModel=new n$5,this.messages=null,this.messagesURIUtils=null;}initialize(){this._featureElementInfo=new c$b,request.i$1(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo()));}destroy(){this._featureElementInfo.destroy();}renderFieldInfo(e,t){const{attributes:s}=this.viewModel,r=e.fieldName,i=e.label||r,o=s?null==s[r]?"":s[r]:"",l=!(!e.format||!e.format.dateFormat),a="number"==typeof o&&!l?this._forceLTR(o):p$5(this.messagesURIUtils,o),n={[f$4.fieldDataDate]:l};return request.n$1("tr",{key:`fields-element-info-row-${r}-${t}`},request.n$1("th",{key:`fields-element-info-row-header-${r}-${t}`,class:f$4.fieldHeader,innerHTML:i}),request.n$1("td",{key:`fields-element-info-row-data-${r}-${t}`,class:this.classes(f$4.fieldData,n),innerHTML:a}))}renderFields(){const{formattedFieldInfos:e}=this.viewModel;return null!=e&&e.length?request.n$1("table",{class:f$4.esriTable,summary:this.messages.fieldsSummary},request.n$1("tbody",null,e.map(((e,t)=>this.renderFieldInfo(e,t))))):null}render(){var e;return request.n$1("div",{class:f$4.base},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderFields())}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t});}_forceLTR(e){return `&lrm;${e}`}};request.e([request.o("viewModel.attributes")],u$5.prototype,"attributes",void 0),request.e([request.o("viewModel.description")],u$5.prototype,"description",void 0),request.e([request.o("viewModel.expressionInfos")],u$5.prototype,"expressionInfos",void 0),request.e([request.o("viewModel.fieldInfos")],u$5.prototype,"fieldInfos",void 0),request.e([request.o("viewModel.title")],u$5.prototype,"title",void 0),request.e([request.d({type:n$5})],u$5.prototype,"viewModel",void 0),request.e([request.d(),request.e$1("esri/widgets/Feature/t9n/Feature")],u$5.prototype,"messages",void 0),request.e([request.d(),request.e$1("esri/widgets/support/t9n/uriUtils")],u$5.prototype,"messagesURIUtils",void 0),u$5=request.e([request.i("esri.widgets.Feature.FeatureFields")],u$5);const m$3=u$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$8="esri.widgets.Feature.support.relatedFeatureUtils",d$2=request.s$1.getLogger(c$8),f$3=new Map;function p$4(e){if(!ae(e))return null;const[t,r]=e.split("/").slice(1);return {layerId:t,fieldName:r}}function m$2(e,t){if(!t.relationships)return null;let r=null;const{relationships:s}=t;return s.some((t=>t.id===parseInt(e,10)&&(r=t,!0))),r}function y$4({originRelationship:e,relationships:t,layerId:r}){let s;return t&&t.some((t=>(`${t.relatedTableId}`===r&&t.id===e.id&&(s=t),!!s))),s}function F(e,t){const r=t.toLowerCase();for(const s in e)if(s.toLowerCase()===r)return e[s];return null}function h$3(e,t){const r=m$2(e,t);if(!r)return;const s=`${t.url}/${r.relatedTableId}`;return {url:s,queryTask:new QueryTask.Q({url:s,sourceSpatialReference:t.spatialReference}),relation:r,relatedFields:[],outStatistics:[]}}function I$2(e,t){if(!t)return;if(!e)return;const{features:r,statsFeatures:s}=e,i=r&&r.value;t.relatedFeatures=i?i.features:[];const o=s&&s.value;t.relatedStatsFeatures=o?o.features:[];}function w$3(e,t,r,s){const i=new TopFeaturesQuery.l;return i.outFields=["*"],i.relationshipId="number"==typeof t.id?t.id:parseInt(t.id,10),i.objectIds=[e.attributes[r.objectIdField]],r.queryRelatedFeatures(i,s)}function b$1(e,t,r){let s=0;const i=[];for(;s<t.length;)i.push(`${e} IN (${t.slice(s,r+s)})`),s+=r;return i.join(" OR ")}async function j(e,t,r,n){const a=r.layerId.toString(),{layerInfo:l,queryTask:u,relation:c,relatedFields:d,outStatistics:f}=t,p=y$4({originRelationship:c,relationships:l.relationships,layerId:a});if(p.relationshipTableId&&p.keyFieldInRelationshipTable){const t=(await w$3(e,p,r,n))[e.attributes[r.objectIdField]];if(!t)return null;const i=t.features.map((e=>e.attributes[l.objectIdField]));if((null==f?void 0:f.length)>0&&l.supportsStatistics){const e=new Query.b;e.where=b$1(l.objectIdField,i,1e3),e.outFields=d,e.outStatistics=f;const r={features:Promise.resolve(t),statsFeatures:u.execute(e)};return request.T(r)}}const m=null==p?void 0:p.keyField;if(m){const r=opacityUtils.B(q$1(l.fields,m)),a=F(e.attributes,c.keyField),d=r?`${m}=${a}`:`${m}='${a}'`,f=u.execute(new Query.b({where:d,outFields:t.relatedFields}),n),p=t.outStatistics&&t.outStatistics.length>0&&l.supportsStatistics?u.execute(new Query.b({where:d,outFields:t.relatedFields,outStatistics:t.outStatistics}),n):null,y={features:f};return p&&(y.statsFeatures=p),request.T(y)}return null}function g$5(t,r){return request.E(t,{query:{f:"json"},signal:r&&r.signal})}function S$2({relatedInfos:e,layer:r},i){const o={};return e.forEach(((e,s)=>{const{relation:n}=e;if(!n){const e=new request.s("relation-required","A relation is required on a layer to retrieve related records.");throw d$2.error(e),e}const{relatedTableId:a}=n;if("number"!=typeof a){const e=new request.s("A related table ID is required on a layer to retrieve related records.");throw d$2.error(e),e}const l=`${r.url}/${a}`,u=f$3.get(l),c=u||g$5(l,i);u||f$3.set(l,c),o[s]=c;})),request.T(o)}function T$2({graphic:e,relatedInfos:t,layer:r},i){const o={};return t.forEach(((t,s)=>{t.layerInfo&&(o[s]=j(e,t,r,i));})),request.T(o)}function $({relatedInfo:e,fieldName:t,fieldInfo:r}){if(e.relatedFields.push(t),r.statisticType){const s=new Query.m({statisticType:r.statisticType,onStatisticField:t,outStatisticFieldName:t});e.outStatistics.push(s);}}function q$1(e,t){if(null!=e){t=t.toLowerCase();for(const r of e)if(r&&r.name.toLowerCase()===t)return r}return null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let y$3=class extends request.p{constructor(t){super(t),this.activeMediaInfoIndex=0,this.attributes=null,this.description=null,this.fieldInfoMap=null,this.formattedAttributes=null,this.expressionAttributes=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null;}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(t){this._setContentElementMedia(t);}next(){this._pageContentElementMedia(1);}previous(){this._pageContentElementMedia(-1);}_setContentElementMedia(t){const{formattedMediaInfoCount:e}=this,o=(t+e)%e;this.activeMediaInfoIndex=o;}_pageContentElementMedia(t){const{activeMediaInfoIndex:e}=this,o=e+t;this._setContentElementMedia(o);}_formatMediaInfos(){const{attributes:t,mediaInfos:e,formattedAttributes:o,expressionAttributes:i,fieldInfoMap:r,layer:a}=this;return null==e?void 0:e.map((e=>{if(!e)return null;if(e.title=$$1({attributes:t,fieldInfoMap:r,globalAttributes:o,expressionAttributes:i,layer:a,text:e.title}),e.caption=$$1({attributes:t,fieldInfoMap:r,globalAttributes:o,expressionAttributes:i,layer:a,text:e.caption}),e.altText=$$1({attributes:t,fieldInfoMap:r,globalAttributes:o,expressionAttributes:i,layer:a,text:e.altText}),"image"===e.type){const{value:t}=e;return this._setImageValue({value:t,formattedAttributes:o,layer:a}),e.value.sourceURL?e:void 0}if("pie-chart"===e.type||"line-chart"===e.type||"column-chart"===e.type||"bar-chart"===e.type){const{value:i}=e;return this._setChartValue({value:i,chartType:e.type,attributes:t,formattedAttributes:o,layer:a}),e}return null})).filter(Boolean)}_setImageValue(t){const{fieldInfoMap:e}=this,{value:o,formattedAttributes:i,layer:r}=t,{linkURL:a,sourceURL:s}=o;if(s){const t=k(s,r);o.sourceURL=A$2({formattedAttributes:i,template:t,fieldInfoMap:e});}if(a){const t=k(a,r);o.linkURL=A$2({formattedAttributes:i,template:t,fieldInfoMap:e});}}_setChartValue(t){const{value:e,attributes:o,formattedAttributes:i,chartType:r,layer:a}=t,{popupTemplate:s,relatedInfos:l}=this,{fields:n,normalizeField:f}=e;e.fields=L$1(n,a),f&&(e.normalizeField=R$2(f,a));if(!n.some((t=>!!(null!=i[t]||ae(t)&&l.size))))return;const m=null==s?void 0:s.fieldInfos;n.forEach((t=>{if(ae(t))return void(e.series=[...e.series,...this._getRelatedChartInfos({fieldInfos:m,fieldName:t,formattedAttributes:i,chartType:r,value:e})]);const a=this._getChartOption({value:e,attributes:o,chartType:r,formattedAttributes:i,fieldName:t,fieldInfos:m});e.series.push(a);}));}_getRelatedChartInfos(t){var e;const{fieldInfos:o,fieldName:i,formattedAttributes:r,chartType:a,value:s}=t,l=[],n=p$4(i),{layerId:d,fieldName:p}=n,u=null==(e=this.relatedInfos)?void 0:e.get(d.toString());if(!u)return l;const{relatedFeatures:f,relation:m}=u;if(!m||!f)return l;const{cardinality:c}=m;f.forEach((t=>{const{attributes:e}=t;e&&Object.keys(e).forEach((t=>{t===p&&l.push(this._getChartOption({value:s,attributes:e,formattedAttributes:r,fieldName:i,chartType:a,relatedFieldName:t,fieldInfos:o}));}));}));return "one-to-many"===c||"many-to-many"===c?l:[l[0]]}_getTooltip({label:t,value:e,chartType:o}){return "pie-chart"===o?t:`${t}: ${e}`}_getChartOption(t){var e;const{value:o,attributes:i,formattedAttributes:s,fieldName:l,relatedFieldName:n,fieldInfos:d,chartType:y}=t,{layer:I}=this,{normalizeField:v,tooltipField:b}=o,M=v?ae(v)?i[p$4(v).fieldName]:i[v]:null,g=n&&void 0!==i[n]?i[n]:void 0!==i[l]?i[l]:s[l],A=void 0===g?null:g&&M?g/M:g,_=new PopupTemplate.c$4({value:A});if(ae(l)){const t=p$4(l),e=p$4(b),o=e?e.fieldName:null,r=Z(A,{fieldInfos:d,fieldName:n,layer:I,preventPlacesFormatting:!!M}),a=t?t.label||t.fieldName:n,s=o&&void 0!==i[o]?i[o]:a;return _.tooltip=this._getTooltip({label:s,value:r,chartType:y}),_}const x=B$4(d,l),T=R$2(l,I),C$1=b&&void 0!==s[b]?s[b]:C(x||new PopupTemplate.c$2({fieldName:T}),null==(e=this.popupTemplate)?void 0:e.expressionInfos),F=s[T];return _.tooltip=this._getTooltip({label:C$1,value:F,chartType:y}),_}};request.e([request.d()],y$3.prototype,"activeMediaInfoIndex",void 0),request.e([request.d({readOnly:!0})],y$3.prototype,"activeMediaInfo",null),request.e([request.d()],y$3.prototype,"attributes",void 0),request.e([request.d()],y$3.prototype,"description",void 0),request.e([request.d()],y$3.prototype,"fieldInfoMap",void 0),request.e([request.d()],y$3.prototype,"formattedAttributes",void 0),request.e([request.d()],y$3.prototype,"expressionAttributes",void 0),request.e([request.d({readOnly:!0})],y$3.prototype,"formattedMediaInfos",null),request.e([request.d()],y$3.prototype,"layer",void 0),request.e([request.d({readOnly:!0})],y$3.prototype,"formattedMediaInfoCount",null),request.e([request.d()],y$3.prototype,"mediaInfos",void 0),request.e([request.d()],y$3.prototype,"popupTemplate",void 0),request.e([request.d()],y$3.prototype,"relatedInfos",void 0),request.e([request.d()],y$3.prototype,"title",void 0),y$3=request.e([request.i("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],y$3);const I$1=y$3;

var f$2=["#ffffff","#858585","#ffbebe","#ffebbe","#ffebaf","#ffffbe","#e9ffbe","#d3ffbe","#beffe8","#bee8ff","#bed2ff","#e8beff","#ffbee8","#ebebeb","#707070","#ff7f7f","#ffa77f","#ffd37f","#ffff73","#d1ff73","#a3ff73","#73ffdf","#73dfff","#73b2ff","#df73ff","#ff73df","#d6d6d6","#5c5c5c","#ff0000","#ff5500","#ffaa00","#ffff00","#aaff00","#55ff00","#00ffc5","#00c5ff","#0070ff","#c500ff","#ff00c5","#c2c2c2","#474747","#e60000","#e64c00","#e69800","#e6e600","#98e600","#4ce600","#00e6a9","#00a9e6","#005ce6","#a900e6","#e600a9","#adadad","#242424","#a80000","#a83800","#a87000","#a8a800","#70a800","#38a800","#00a884","#0084a8","#004da8","#8400a8","#a80084","#999999","#1a1a1a","#730000","#732600","#734c00","#737300","#4c7300","#267300","#00734c","#004c73","#002673","#4c0073","#73004"],b=[].concat(f$2.slice(30,39),f$2.slice(28,30).reverse()),e$3=[{name:"default",colors:b},{name:"cat-dark",colors:["#ed5151","#149ece","#a7c636","#9e559c","#fc921f","#ffde3e","#f789d8","#b7814a","#3caf99","#6b6bd6","#b54779","#7f7f7f"]},{name:"tropical-bliss",colors:["#fce138","#ff9399","#fcd27e","#f1983c","#a553b7","#b1a9d0","#6ecffc","#4c81cd","#fc6f84","#fc3e5a","#6af689","#48885c"]},{name:"desert-blooms",colors:["#102432","#144d59","#ffc730","#ed9310","#a64f1b","#661510","#d9351a","#b31515","#4a0932","#8c213f","#18382e","#2c6954"]},{name:"under-the-sea",colors:["#bf9727","#607100","#00734c","#704489","#01acca","#024e76","#f09100","#ea311f","#c6004b","#7570b3","#666666","#333333"]},{name:"vibrant-rainbow",colors:["#fffb00","#f5cb11","#9fd40c","#46e39c","#32b8a6","#7ff2fa","#ac08cc","#dd33ff","#eb7200","#e8a784","#bf2e2e","#6c7000"]},{name:"ocean-bay",colors:["#191921","#11495c","#78b1c2","#454f4b","#8f8f82","#9be0c0","#87b051","#f7ec88","#ebdcc1","#dbb658","#c43541","#75351e"]},{name:"prairie-summer",colors:["#332424","#751555","#d47013","#d68989","#211173","#82aad6","#7bfaeb","#6ec9a8","#6b6408","#eada40","#ccc54a","#1fc235"]},{name:"pastel-chalk",colors:["#fffd99","#f5e6a4","#c1d48c","#b8e3d0","#a0b8b5","#cbf7fa","#d791f2","#dfc1eb","#f2b983","#e8c4b2","#bf8e8e","#94995c"]},{name:"seq-yellow-orange-red-bright",colors:["#910000","#b1260b","#c0370f","#e05919","#ef6a1d","#ff7b22","#ffa143","#ffb454","#ffda74","#ffed85"]},{name:"seq-reds-bright",colors:["#57453b","#7b4238","#9f4036","#c23d33","#d7483c","#ec5244","#f3696c","#f9816c","#ffc4ae","#fff0dc"]},{name:"seq-purples-bright",colors:["#4e465c","#5a4a78","#695291","#775baa","#8663c3","#946bdc","#aa89e8","#c1a6f3","#d7c4ff","#e6e1ff"]},{name:"seq-blues-bright",colors:["#404d54","#435c6c","#48799d","#4b88b6","#4d96ce","#50a5e7","#74bbed","#98d0f3","#bce6f9","#e6faff"]},{name:"seq-greens-bright",colors:["#39544c","#386757","#368165","#359b73","#33b581","#4bc392","#64d2a2","#7ce0b3","#cbf6d9","#f4ffea"]},{name:"seq-browns-bright",colors:["#524834","#715b38","#8f6e3c","#ae8140","#cc9444","#eba748","#eeb664","#f0c47f","#f9e0b7","#fff8eb"]}];

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const n$4="en-us",h$2=new Map([["ar",()=>Promise.resolve().then(function () { return require('./ar-71e16451.js'); }).then((t=>t.a))],["bs-ba",()=>Promise.resolve().then(function () { return require('./bs_BA-927d15df.js'); }).then((t=>t.b))],["ca-es",()=>Promise.resolve().then(function () { return require('./ca_ES-ac151805.js'); }).then((t=>t.c))],["cs-cz",()=>Promise.resolve().then(function () { return require('./cs_CZ-0c5e63d7.js'); }).then((t=>t.c))],["da-dk",()=>Promise.resolve().then(function () { return require('./da_DK-a0382080.js'); }).then((t=>t.d))],["de-de",()=>Promise.resolve().then(function () { return require('./de_DE-b37536a1.js'); }).then((t=>t.d))],["de-ch",()=>Promise.resolve().then(function () { return require('./de_CH-5d14f9c6.js'); }).then((t=>t.d))],["el-gr",()=>Promise.resolve().then(function () { return require('./el_GR-7bd6ac59.js'); }).then((t=>t.e))],["en-us",()=>Promise.resolve().then(function () { return require('./en_US-e5f1a478.js'); }).then((t=>t.e))],["en-ca",()=>Promise.resolve().then(function () { return require('./en_CA-0ea5d45f.js'); }).then((t=>t.e))],["es-es",()=>Promise.resolve().then(function () { return require('./es_ES-92ee8108.js'); }).then((t=>t.e))],["et-ee",()=>Promise.resolve().then(function () { return require('./et_EE-c98eeccb.js'); }).then((t=>t.e))],["fi-fi",()=>Promise.resolve().then(function () { return require('./fi_FI-f8111a31.js'); }).then((t=>t.f))],["fr-fr",()=>Promise.resolve().then(function () { return require('./fr_FR-c14d5e61.js'); }).then((t=>t.f))],["he-il",()=>Promise.resolve().then(function () { return require('./he_IL-ddfebad4.js'); }).then((t=>t.h))],["hr-hr",()=>Promise.resolve().then(function () { return require('./hr_HR-cd1d25c8.js'); }).then((t=>t.h))],["hu-hu",()=>Promise.resolve().then(function () { return require('./hu_HU-5c08dc35.js'); }).then((t=>t.h))],["id-id",()=>Promise.resolve().then(function () { return require('./id_ID-779f7957.js'); }).then((t=>t.i))],["it-it",()=>Promise.resolve().then(function () { return require('./it_IT-13040fcc.js'); }).then((t=>t.i))],["ja-jp",()=>Promise.resolve().then(function () { return require('./ja_JP-0a2aba13.js'); }).then((t=>t.j))],["ko-kr",()=>Promise.resolve().then(function () { return require('./ko_KR-93d2fe3f.js'); }).then((t=>t.k))],["lt-lt",()=>Promise.resolve().then(function () { return require('./lt_LT-692bcde0.js'); }).then((t=>t.l))],["lv-lv",()=>Promise.resolve().then(function () { return require('./lv_LV-9c3d5ce8.js'); }).then((t=>t.l))],["nb-no",()=>Promise.resolve().then(function () { return require('./nb_NO-e6000375.js'); }).then((t=>t.n))],["nl-nl",()=>Promise.resolve().then(function () { return require('./nl_NL-0fcb937e.js'); }).then((t=>t.n))],["pl-pl",()=>Promise.resolve().then(function () { return require('./pl_PL-70bbaf97.js'); }).then((t=>t.p))],["pt-br",()=>Promise.resolve().then(function () { return require('./pt_BR-0d6d2b91.js'); }).then((t=>t.p))],["pt-pt",()=>Promise.resolve().then(function () { return require('./pt_PT-9959064c.js'); }).then((t=>t.p))],["ro-ro",()=>Promise.resolve().then(function () { return require('./ro_RO-119405df.js'); }).then((t=>t.r))],["ru-ru",()=>Promise.resolve().then(function () { return require('./ru_RU-7fb18039.js'); }).then((t=>t.r))],["sk-sk",()=>Promise.resolve().then(function () { return require('./sk_SK-cca7be8f.js'); }).then((t=>t.s))],["sl-sl",()=>Promise.resolve().then(function () { return require('./sl_SL-673ac864.js'); }).then((t=>t.s))],["sr-rs",()=>Promise.resolve().then(function () { return require('./sr_RS-bd2c021e.js'); }).then((t=>t.s))],["sv-se",()=>Promise.resolve().then(function () { return require('./sv_SE-003e4524.js'); }).then((t=>t.s))],["th-th",()=>Promise.resolve().then(function () { return require('./th_TH-f840d639.js'); }).then((t=>t.t))],["tr-tr",()=>Promise.resolve().then(function () { return require('./tr_TR-3195262b.js'); }).then((t=>t.t))],["uk-ua",()=>Promise.resolve().then(function () { return require('./uk_UA-7f6bef1d.js'); }).then((t=>t.u))],["vi-vn",()=>Promise.resolve().then(function () { return require('./vi_VN-02a585ce.js'); }).then((t=>t.v))],["zh-cn",()=>Promise.resolve().then(function () { return require('./zh_Hans-d90cdc7d.js'); }).then((t=>t.z))],["zh-hk",()=>Promise.resolve().then(function () { return require('./zh_Hant-9f98acd5.js'); }).then((t=>t.z))],["zh-tw",()=>Promise.resolve().then(function () { return require('./zh_Hant-9f98acd5.js'); }).then((t=>t.z))]]);function e$2(t){const s=t.split("-")[0].toLowerCase();let n=null;for(const e of h$2.keys())if(e.startsWith(s)){n=e;break}return n}function r$1(t){return t?h$2.has(t.toLowerCase())?t.toLowerCase():e$2(t)||n$4:n$4}let o$3,i$4;async function c$7(t=request.i$6()){if(t=r$1(t),o$3&&t===i$4)return o$3;o$3=Promise.resolve().then(function () { return require('./index-00804480.js'); }).then((t=>t.i)),i$4=t;try{const[s,n]=await Promise.all([o$3,h$2.get(i$4)()]);i$4===t&&(s.am4core.options.defaultLocale=n.default),s.am4core.options.suppressWarnings=!0,s.am4core.options.autoDispose=!0;}catch{return o$3=null,i$4=null,null}return o$3}function u$4(s,n="default"){const h=e$3.find((t=>t.name===n));return h?h.colors.map((t=>s.color(t))):null}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const v$2={base:"esri-feature-media",mediaContainer:"esri-feature-media__container",mediaItemContainer:"esri-feature-media__item-container",mediaItem:"esri-feature-media__item",mediaItemTitle:"esri-feature-media__item-title",mediaItemCaption:"esri-feature-media__item-caption",mediaPrevious:"esri-feature-media__previous",mediaPreviousIconLTR:"esri-feature-media__previous-icon",mediaPreviousIconRTL:"esri-feature-media__previous-icon--rtl",mediaNext:"esri-feature-media__next",mediaNextIconLTR:"esri-feature-media__next-icon",mediaNextIconRTL:"esri-feature-media__next-icon--rtl",mediaChart:"esri-feature-media__chart",mediaButton:"esri-feature-media__button",mediaIcon:"esri-feature-media__icon",iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow"},_$2=.05,I=.95,M=15;let w$2=class extends request.z{constructor(e,t){super(e,t),this._refreshTimer=null,this._refreshIntervalInfo=null,this._featureElementInfo=null,this.attributes=null,this.activeMediaInfoIndex=null,this.description=null,this.fieldInfoMap=null,this.layer=null,this.mediaInfos=null,this.popupTemplate=null,this.relatedInfos=null,this.title=null,this.viewModel=new I$1,this.messages=null;}initialize(){this._featureElementInfo=new c$b,this.own(request.i$1(this,["viewModel.activeMediaInfo","viewModel.activeMediaInfoIndex"],(()=>this._setupMediaRefreshTimer())),request.i$1(this,["viewModel.description","viewModel.title"],(()=>this._setupFeatureElementInfo())));}destroy(){this._clearMediaRefreshTimer(),this._featureElementInfo.destroy();}render(){var e;return request.n$1("div",{bind:this,class:v$2.base,onkeyup:this._handleMediaKeyup},null==(e=this._featureElementInfo)?void 0:e.render(),this.renderMedia())}renderMedia(){const{formattedMediaInfoCount:e}=this.viewModel;return e?request.n$1("div",{key:"media-element-container",class:v$2.mediaContainer},this.renderMediaPageButton("previous"),this.renderMediaInfo(),this.renderMediaPageButton("next")):null}renderImageMediaInfo(e){const{_refreshIntervalInfo:t}=this,{activeMediaInfoIndex:i,formattedMediaInfoCount:r}=this.viewModel,{value:a,refreshInterval:o,altText:s,title:n,type:l}=e,{sourceURL:c,linkURL:m}=a,u=v$4(m)?"_blank":"_self",h="_blank"===u?"noreferrer":"",p=o?t:null,v=p?p.timestamp:0,_=p?p.sourceURL:c,I=request.n$1("img",{alt:s||n,key:`media-${l}-${i}-${r}-${v}`,src:_}),M=m?request.n$1("a",{title:n,href:m,rel:h,target:u},I):null;return M||I}renderChartMediaInfo(e){const{activeMediaInfoIndex:t,formattedMediaInfoCount:i}=this.viewModel;return request.n$1("div",{key:`media-${e.type}-${t}-${i}`,bind:this,class:v$2.mediaChart,afterCreate:this._getChartDependencies})}renderMediaInfoType(){const{activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this.renderImageMediaInfo(e):-1!==e.type.indexOf("chart")?this.renderChartMediaInfo(e):null:null}renderMediaInfo(){const{activeMediaInfo:e}=this.viewModel;if(!e)return null;const t=e.title?request.n$1("div",{key:"media-title",class:v$2.mediaItemTitle,innerHTML:e.title}):null,i=e.caption?request.n$1("div",{key:"media-caption",class:v$2.mediaItemCaption,innerHTML:e.caption}):null;return request.n$1("div",{key:"media-container",class:v$2.mediaItemContainer},request.n$1("div",{key:"media-item-container",class:v$2.mediaItem},this.renderMediaInfoType()),t,i)}renderMediaPageButton(e){if(this.viewModel.formattedMediaInfoCount<2)return null;const t="previous"===e,i=t?this.messages.previous:this.messages.next,r=t?this.classes(v$2.mediaButton,v$2.mediaPrevious):this.classes(v$2.mediaButton,v$2.mediaNext),a=t?this.classes(v$2.mediaIcon,v$2.mediaPreviousIconLTR,v$2.iconLeftTriangleArrow):this.classes(v$2.mediaIcon,v$2.mediaNextIconLTR,v$2.iconRightTriangleArrow),o=t?this.classes(v$2.mediaIcon,v$2.mediaPreviousIconRTL,v$2.iconRightTriangleArrow):this.classes(v$2.mediaIcon,v$2.mediaNextIconRTL,v$2.iconLeftTriangleArrow),s=t?"media-previous":"media-next",n=t?this._previous:this._next;return request.n$1("button",{type:"button",key:s,title:i,"aria-label":i,tabIndex:0,class:r,bind:this,onclick:n},request.n$1("span",{"aria-hidden":"true",class:a}),request.n$1("span",{"aria-hidden":"true",class:o}))}_setupFeatureElementInfo(){const{description:e,title:t}=this;this._featureElementInfo.set({description:e,title:t});}_next(){this.viewModel.next();}_previous(){this.viewModel.previous();}async _getChartDependencies(e){const t=await c$7(),{activeMediaInfo:i}=this.viewModel;this._renderChart({chartDiv:e,mediaInfo:i,chartsModule:t});}_handleMediaKeyup(e){const i=request.i$2(e);"ArrowLeft"===i&&(e.stopPropagation(),this.viewModel.previous()),"ArrowRight"===i&&(e.stopPropagation(),this.viewModel.next());}_renderChart(e){const{chartsModule:t,chartDiv:i,mediaInfo:r}=e,{value:a,type:o}=r,{am4core:s}=t,n=u$4(s);function l(e){e instanceof s.ColorSet&&n&&(e.list=n);}request.E$3()&&s.useTheme(t.am4themes_dark),s.useTheme(t.am4themes_animated),s.useTheme(l);const d="pie-chart"===o?this._createPieChart(e):this._createXYChart(e);i.setAttribute("aria-label",r.altText||r.title),d.data=a.series.map((e=>({tooltip:e.tooltip,value:e.value}))).filter((e=>"pie-chart"!==o||e.value>0));}_customizeChartTooltip(e,t){e.label.wrap=!0,e.label.maxWidth=200,e.autoTextColor=!1,e.getFillFromObject=!1,e.label.fill=t.color("#ffffff"),e.background.fill=t.color({r:0,g:0,b:0,a:.7});}_createPieChart(e){const{chartDiv:t,chartsModule:i}=e,{am4core:r,am4charts:a}=i,o=r.create(t,a.PieChart);o.rtl=request.d$3(this.container);const s=o.series.push(new a.PieSeries);return s.labels.template.disabled=!0,s.ticks.template.disabled=!0,s.dataFields.value="value",s.dataFields.category="tooltip",this._customizeChartTooltip(s.tooltip,r),o}_getMinSeriesValue(e){let t=0;return e.forEach((e=>t=Math.min(e.value,t))),t}_createColumnChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.xAxes.push(new s.CategoryAxis);n.dataFields.category="tooltip",n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dy=-n.tooltip.contentHeight;}));const l=e.yAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_$2,l.renderer.maxLabelPosition=I,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.ColumnSeries);c.dataFields.valueY="value",c.dataFields.categoryX="tooltip",e.cursor=new s.XYCursor,a.series.length>M&&(e.scrollbarX=new o.Scrollbar);}_createBarChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.yAxes.push(new s.CategoryAxis);n.dataFields.category="tooltip",n.renderer.inversed=!0,n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dx=n.tooltip.contentWidth;}));const l=e.xAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_$2,l.renderer.maxLabelPosition=I,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.ColumnSeries);c.dataFields.valueX="value",c.dataFields.categoryY="tooltip",e.cursor=new s.XYCursor,a.series.length>M&&(e.scrollbarY=new o.Scrollbar);}_createLineChart(e,t){const{chartsModule:i,mediaInfo:r}=t,{value:a}=r,{am4core:o,am4charts:s}=i,n=e.xAxes.push(new s.CategoryAxis);n.dataFields.category="tooltip",n.renderer.labels.template.disabled=!0,this._customizeChartTooltip(n.tooltip,o),n.tooltip.events.on("sizechanged",(()=>{n.tooltip.dy=-n.tooltip.contentHeight;}));const l=e.yAxes.push(new s.ValueAxis),d=l.renderer.labels.template;l.renderer.minLabelPosition=_$2,l.renderer.maxLabelPosition=I,l.min=this._getMinSeriesValue(a.series),this._customizeChartTooltip(l.tooltip,o),d.wrap=!0;const c=e.series.push(new s.LineSeries);c.dataFields.categoryX="tooltip",c.dataFields.valueY="value",e.cursor=new s.XYCursor,a.series.length>M&&(e.scrollbarX=new o.Scrollbar);}_createXYChart(e){const{chartDiv:t,chartsModule:i,mediaInfo:r}=e,{type:a}=r,{am4core:o,am4charts:s}=i,n=o.create(t,s.XYChart);return n.rtl=request.d$3(this.container),"column-chart"===a&&this._createColumnChart(n,e),"bar-chart"===a&&this._createBarChart(n,e),"line-chart"===a&&this._createLineChart(n,e),n}_clearMediaRefreshTimer(){const{_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null);}_updateMediaInfoTimestamp(e){const t=Date.now();this._refreshIntervalInfo={timestamp:t,sourceURL:this._getImageSource(e,t)},this.scheduleRender();}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();const{activeMediaInfo:e}=this.viewModel;e&&"image"===e.type&&e.refreshInterval&&this._setRefreshTimeout(e);}_setRefreshTimeout(e){const{refreshInterval:t,value:i}=e;if(!t)return;const r=6e4*t;this._updateMediaInfoTimestamp(i.sourceURL);const a=setInterval((()=>{this._updateMediaInfoTimestamp(i.sourceURL);}),r);this._refreshTimer=a;}_getImageSource(e,t){const i=-1!==e.indexOf("?")?"&":"?",[r,a=""]=e.split("#");return `${r}${i}timestamp=${t}${a?"#":""}${a}`}};request.e([request.o("viewModel.attributes")],w$2.prototype,"attributes",void 0),request.e([request.o("viewModel.activeMediaInfoIndex")],w$2.prototype,"activeMediaInfoIndex",void 0),request.e([request.o("viewModel.description")],w$2.prototype,"description",void 0),request.e([request.o("viewModel.fieldInfoMap")],w$2.prototype,"fieldInfoMap",void 0),request.e([request.o("viewModel.layer")],w$2.prototype,"layer",void 0),request.e([request.o("viewModel.mediaInfos")],w$2.prototype,"mediaInfos",void 0),request.e([request.o("viewModel.popupTemplate")],w$2.prototype,"popupTemplate",void 0),request.e([request.o("viewModel.relatedInfos")],w$2.prototype,"relatedInfos",void 0),request.e([request.o("viewModel.title")],w$2.prototype,"title",void 0),request.e([request.d({type:I$1})],w$2.prototype,"viewModel",void 0),request.e([request.d(),request.e$1("esri/widgets/Feature/t9n/Feature")],w$2.prototype,"messages",void 0),w$2=request.e([request.i("esri.widgets.Feature.FeatureMedia")],w$2);const g$4=w$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class e$1{constructor(e,a){this.preLayerQueryCallback=e,this.preRequestCallback=a,this.preLayerQueryCallback||(this.preLayerQueryCallback=e=>{}),this.preRequestCallback||(this.preLayerQueryCallback=e=>{});}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const o$2=["$datastore","$map","$layer","$aggregatedfeatures"],n$3="esri.widgets.Feature.support.arcadeFeatureUtils",c$6=request.s$1.getLogger(n$3);function p$3(e){return `<ul class="esri-widget__list">${e.map((e=>`<li>${"string"==typeof e?ee(Y(e)):e}</li>`)).join("")}</ul>`}function l$4(e){return `<table class="esri-widget__table">${e.keys().map((r=>{const t=e.field(r);return `<tr><th>${r}</th><td>${"string"==typeof t?ee(Y(t)):t}</td></tr>`})).join("")}</table>`}function u$3({aggregatedFeatures:e,arcadeUtils:r,featureSetVars:t,context:i,viewInfo:s,map:o,graphic:n,interceptor:c}){t.forEach((t=>{const p=t.toLowerCase(),l={map:o,spatialReference:s.sr,interceptor:c};if("$map"===p&&(i.vars[p]=r.convertMapToFeatureSetCollection(l)),"$layer"===p&&(i.vars[p]=r.convertFeatureLayerToFeatureSet({layer:n.sourceLayer,spatialReference:s.sr,interceptor:c})),"$datastore"===p&&(i.vars[p]=r.convertServiceUrlToWorkspace({url:n.sourceLayer.url,spatialReference:s.sr,interceptor:c})),"$aggregatedfeatures"===p){const t=n.layer,{fields:o,objectIdField:l,geometryType:u,spatialReference:f,displayField:d}=t,g=new FeatureLayer.Ge({fields:o,objectIdField:l,geometryType:u,spatialReference:f,displayField:d,..."feature"===t.type?{templates:t.templates,typeIdField:t.typeIdField,types:t.types}:null,source:e});i.vars[p]=r.convertFeatureLayerToFeatureSet({layer:g,spatialReference:s.sr,interceptor:c});}}));}function f$1(){return Promise.resolve().then(function () { return require('./arcadeUtils-86f086c4.js'); }).then(function (n) { return n.arcadeUtils; })}async function d$1({graphic:e,view:r}){const{isAggregate:t,layer:a}=e;if(!t||!a||"2d"!==(null==r?void 0:r.type))return [];const i=await r.whenLayerView(a);if(!i.createQuery||!i.queryFeatures)return [];const s=i.createQuery();s.aggregateIds=[e.getObjectId()];const{features:o}=await i.queryFeatures(s);return o}async function g$3({expressionAttributes:e,info:r,arcadeUtils:a,interceptor:n,spatialReference:f,map:g,graphic:y,view:m}){const w=`expression/${r.name}`,F=a.createSyntaxTree(r.expression),v=o$2.filter((e=>a.hasVariable(F,e))),[h]=await request.s$11([d$1({graphic:y,view:m}),a.loadScriptDependencies(F,!0,v)]),x=a.getViewInfo({spatialReference:f}),$=a.createExecContext(y,x);$.interceptor=n,$.useAsync=!0,u$3({aggregatedFeatures:h,arcadeUtils:a,featureSetVars:v,context:$,viewInfo:x,map:g,graphic:y,interceptor:n});const I=a.createFunction(F,$),j=await a.executeAsyncFunction(I,$).catch((e=>c$6.error("arcade-execution-error",{error:e,graphic:y,expressionInfo:r})));e[w]="string"==typeof j?ee(Y(j)):Array.isArray(j)?p$3(j):j&&"esri.arcade.Dictionary"===j.declaredClass?l$4(j):j;}async function y$2({popupTemplate:e,spatialReference:t,graphic:a,interceptor:i,map:s,view:o}){const n=e.expressionInfos,c=[],p={};if(!n||!n.length)return p;const l=await f$1();for(const r of n)c.push(g$3({expressionAttributes:p,info:r,arcadeUtils:l,interceptor:i,spatialReference:t,map:s,graphic:a,view:o}));return await request.T(c),p}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var U$2;const N$1=1,q="esri.widgets.FeatureViewModel",D$1=request.s$1.getLogger(q),Q={attachmentsContent:!0,customContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0};let B$2=U$2=class extends request.p{constructor(e){super(e),this._handles=new request.u,this._error=null,this._featureAbortController=null,this.graphicChangedThrottled=e$5(this.graphicChanged,N$1,this),this._expressionAttributes=null,this.abilities={...Q},this.content=null,this.contentViewModels=[],this.defaultPopupTemplateEnabled=!1,this.formattedAttributes=null,this.lastEditInfo=null,this.relatedInfos=new Map,this.title="",this.view=null,this._isAllowedContentType=e=>{const{abilities:t}=this;return "attachments"===e.type&&t.attachmentsContent||"custom"===e.type&&t.customContent||"fields"===e.type&&t.fieldsContent||"media"===e.type&&t.mediaContent||"text"===e.type&&t.textContent},this._handles.add(request.i$1(this,["graphic","_effectivePopupTemplate","abilities"],(()=>this.graphicChangedThrottled())));}destroy(){this._clear(),this._cancelFeatureQuery(),this._error=null,this._handles.destroy(),this._handles=null,this.graphic=null,this._destroyContentViewModels(),this.relatedInfos.clear();}get _effectivePopupTemplate(){return request.r(this.graphic)?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return W(X(this._effectivePopupTemplate),this._sourceLayer)}get _sourceLayer(){return x(this.graphic)}castAbilities(e){return {...Q,...e}}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(e){this._set("graphic",e?e.clone():null);}get spatialReference(){return this.get("view.spatialReference")||null}set spatialReference(e){void 0!==e?this._override("spatialReference",e):this._clearOverride("spatialReference");}get map(){return this.get("view.map")||null}set map(e){void 0!==e?this._override("map",e):this._clearOverride("map");}get waitingForContent(){return !!this._featureAbortController}setActiveMedia(e,t){const r=this.contentViewModels[e];r instanceof I$1&&r.setActiveMedia(t);}nextMedia(e){const t=this.contentViewModels[e];t instanceof I$1&&t.next();}previousMedia(e){const t=this.contentViewModels[e];t instanceof I$1&&t.previous();}_clear(){this._set("title",""),this._set("content",null),this._set("formattedAttributes",null);}async graphicChanged(){this._cancelFeatureQuery(),this._error=null,this._clear();const{graphic:e}=this;if(!e)return;const t=new AbortController;this._featureAbortController=t;try{await this._queryFeature({signal:t.signal});}catch(r){request.d$1(r)||(this._error=r,D$1.error("error","The popupTemplate could not be displayed for this feature.",{error:r,graphic:e,popupTemplate:this._effectivePopupTemplate}));}this._featureAbortController===t&&(this._featureAbortController=null);}_cancelFeatureQuery(){const{_featureAbortController:e}=this;e&&e.abort(),this._featureAbortController=null;}_compileContent(e){if(this._destroyContentViewModels(),this.graphic)return Array.isArray(e)?e.filter(this._isAllowedContentType).map(((e,t)=>"attachments"===e.type?this._compileAttachments(e,t):"custom"===e.type?this._compileCustom(e,t):"fields"===e.type?this._compileFields(e,t):"media"===e.type?this._compileMedia(e,t):"text"===e.type?this._compileText(e,t):void 0)):"string"==typeof e?this._compileText(new PopupTemplate.c$5({text:e}),0).text:e}_destroyContentViewModels(){this.contentViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("contentViewModels",[]);}_compileAttachments(e,t){const{graphic:r}=this,{description:i,title:o}=e;return this.contentViewModels[t]=new c$c({graphic:r,...this._compileTitleAndDesc({title:o,description:i})}),e}_compileCustom(e,t){const{graphic:r}=this,{creator:i,destroyer:o}=e;return this.contentViewModels[t]=new p$7({graphic:r,creator:i,destroyer:o}),e}_compileTitleAndDesc({title:e,description:t}){const{_fieldInfoMap:r,_sourceLayer:i,graphic:o,formattedAttributes:s,_expressionAttributes:a}=this,{attributes:n}=o,l=s.global;return {title:$$1({attributes:n,fieldInfoMap:r,globalAttributes:l,expressionAttributes:a,layer:i,text:e}),description:$$1({attributes:n,fieldInfoMap:r,globalAttributes:l,expressionAttributes:a,layer:i,text:t})}}_compileFields(e,t){const{_effectivePopupTemplate:r,formattedAttributes:i}=this,o=e.clone(),s={...i.global,...i.content[t]},a=(null==e?void 0:e.fieldInfos)||(null==r?void 0:r.fieldInfos),n=null==a?void 0:a.filter((({fieldName:e})=>j$1(e)||ae(e)||s.hasOwnProperty(e))),l=null==r?void 0:r.expressionInfos,{description:p,title:c}=o,d=new n$5({attributes:s,expressionInfos:l,fieldInfos:n,...this._compileTitleAndDesc({title:c,description:p})});return this.contentViewModels[t]=d,o.fieldInfos=d.formattedFieldInfos.slice(0),o}_compileMedia(e,t){const{graphic:r,_fieldInfoMap:i,_effectivePopupTemplate:o,relatedInfos:s,_sourceLayer:a,_expressionAttributes:n}=this,{attributes:l}=r,p=this.formattedAttributes.global,c=e.clone(),{description:d,mediaInfos:u,title:f}=c,h=new I$1({activeMediaInfoIndex:c.activeMediaInfoIndex||0,attributes:l,layer:a,fieldInfoMap:i,formattedAttributes:p,expressionAttributes:n,mediaInfos:u,popupTemplate:o,relatedInfos:s,...this._compileTitleAndDesc({title:f,description:d})});return c.mediaInfos=h.formattedMediaInfos.slice(0),this.contentViewModels[t]=h,c}_compileText(e,t){const r=e.clone(),{graphic:i,_fieldInfoMap:o,_sourceLayer:s,_expressionAttributes:a}=this;if(r&&r.text){const{attributes:e}=i,t=this.formattedAttributes.global;r.text=$$1({attributes:e,fieldInfoMap:o,globalAttributes:t,expressionAttributes:a,layer:s,text:r.text});}return this.contentViewModels[t]=new p$7({graphic:i,creator:r.text}),r}_compileLastEditInfo(){const{_effectivePopupTemplate:e,_sourceLayer:t,graphic:r}=this;if(!e)return;const{lastEditInfoEnabled:i}=e,o=null==t?void 0:t.editFieldsInfo;return i&&o?V$1(o,r.attributes):void 0}_compileTitle(e){const{_fieldInfoMap:t,_sourceLayer:r,graphic:i,_expressionAttributes:o}=this,{attributes:s}=i,a=this.formattedAttributes.global;return $$1({attributes:s,fieldInfoMap:t,globalAttributes:a,expressionAttributes:o,layer:r,text:e})}async _getTitle(){const{_effectivePopupTemplate:e,graphic:t}=this,r=null==e?void 0:e.title;return E$1(r,{graphic:t})}async _getContent(){const{_effectivePopupTemplate:e,graphic:t}=this,r=null==e?void 0:e.content;return E$1(r,{graphic:t})}async _queryFeature(e){const{_featureAbortController:t,_sourceLayer:r,graphic:i,_effectivePopupTemplate:o,spatialReference:s,map:a,view:n}=this,{content:{value:p},title:{value:c}}=await request.T({content:this._getContent(),title:this._getTitle()});if(t!==this._featureAbortController||!i)return;await oe({graphic:i,popupTemplate:o,layer:r,spatialReference:s},e);const{expressionAttributes:{value:d}}=await request.T({checkForRelatedFeatures:this._checkForRelatedFeatures(e),expressionAttributes:y$2({popupTemplate:this._effectivePopupTemplate,spatialReference:s,graphic:i,map:a,interceptor:U$2.interceptor,view:n})});t===this._featureAbortController&&i&&(this._expressionAttributes=d,this._set("formattedAttributes",this._createFormattedAttributes(p,d)),this._set("title",this._compileTitle(c)),this._set("lastEditInfo",this._compileLastEditInfo()||null),this._set("content",this._compileContent(p)||null));}_createFormattedAttributes(e,t){const{_effectivePopupTemplate:r,graphic:i,relatedInfos:o,_sourceLayer:s,_fieldInfoMap:a}=this,n=null==r?void 0:r.fieldInfos,l={...i.attributes,...t},p={global:re({fieldInfos:n,graphic:i,attributes:l,layer:s,fieldInfoMap:a,relatedInfos:o}),content:[]};return Array.isArray(e)&&e.forEach(((e,t)=>{"fields"===e.type&&e.fieldInfos&&(p.content[t]=re({fieldInfos:e.fieldInfos,graphic:i,attributes:l,layer:s,fieldInfoMap:a,relatedInfos:o}));})),p}_checkForRelatedFeatures(e){const{graphic:t,_effectivePopupTemplate:r}=this;return this._queryRelatedInfos(t,X(r),e)}async _queryRelatedInfos(e,t,r){const{relatedInfos:i,_sourceLayer:o}=this;i.clear();const s=request.r(o.associatedLayer)?await o.associatedLayer.load(r):o;if(!s)return;const n=t.filter((e=>e&&ae(e.fieldName)));if(!n||!n.length)return;t.forEach((e=>this._configureRelatedInfo(e,s)));const l=await S$2({relatedInfos:i,layer:s},r);Object.keys(l).forEach((e=>{var t;const r=i.get(e.toString()),o=null==(t=l[e])?void 0:t.value;r&&o&&(r.layerInfo=o.data);}));const p=await T$2({graphic:e,relatedInfos:i,layer:s},r);Object.keys(p).forEach((e=>{var t;I$2(null==(t=p[e])?void 0:t.value,i.get(e.toString()));}));}_configureRelatedInfo(e,t){const{relatedInfos:r}=this,i=p$4(e.fieldName);if(!i)return;const{layerId:o,fieldName:s}=i;if(!o)return;const a=r.get(o.toString())||h$3(o,t);a&&($({relatedInfo:a,fieldName:s,fieldInfo:e}),this.relatedInfos.set(o,a));}};B$2.interceptor=new e$1(de,pe),request.e([request.d()],B$2.prototype,"_error",void 0),request.e([request.d()],B$2.prototype,"_featureAbortController",void 0),request.e([request.d({readOnly:!0})],B$2.prototype,"_effectivePopupTemplate",null),request.e([request.d({readOnly:!0})],B$2.prototype,"_fieldInfoMap",null),request.e([request.d({readOnly:!0})],B$2.prototype,"_sourceLayer",null),request.e([request.d()],B$2.prototype,"abilities",void 0),request.e([request.c("abilities")],B$2.prototype,"castAbilities",null),request.e([request.d({readOnly:!0})],B$2.prototype,"content",void 0),request.e([request.d({readOnly:!0})],B$2.prototype,"contentViewModels",void 0),request.e([request.d({type:Boolean})],B$2.prototype,"defaultPopupTemplateEnabled",void 0),request.e([request.d({readOnly:!0})],B$2.prototype,"state",null),request.e([request.d({readOnly:!0})],B$2.prototype,"formattedAttributes",void 0),request.e([request.d({type:Graphic.h,value:null})],B$2.prototype,"graphic",null),request.e([request.d({readOnly:!0})],B$2.prototype,"lastEditInfo",void 0),request.e([request.d()],B$2.prototype,"relatedInfos",void 0),request.e([request.d()],B$2.prototype,"spatialReference",null),request.e([request.d({readOnly:!0})],B$2.prototype,"title",void 0),request.e([request.d()],B$2.prototype,"map",null),request.e([request.d({readOnly:!0})],B$2.prototype,"waitingForContent",null),request.e([request.d()],B$2.prototype,"view",void 0),B$2=U$2=request.e([request.i(q)],B$2);const G$1=B$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const i$3=i=>{let c=class extends i{constructor(){super(...arguments),this.renderNodeContent=e=>widget.e(e)&&!e.destroyed?request.n$1("div",{key:e},e.render()):e instanceof HTMLElement?request.n$1("div",{key:e,bind:e,afterCreate:this._attachToNode}):widget.t(e)?request.n$1("div",{key:e,bind:e.domNode,afterCreate:this._attachToNode}):null;}_attachToNode(e){const r=this;e.appendChild(r);}};return c=request.e([request.i("esri.widgets.Feature.ContentMixin")],c),c};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const g$2={iconText:"esri-icon-font-fallback-text",iconLoading:"esri-icon-loading-indicator esri-rotating",esriTable:"esri-widget__table",esriWidget:"esri-widget",base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container",spinner:"esri-feature__loading-spinner"},y$1={title:!0,content:!0,lastEditedInfo:!0};let _$1=class extends(i$3(request.z)){constructor(e,t){super(e,t),this._contentWidgets=[],this.graphic=null,this.defaultPopupTemplateEnabled=!1,this.headingLevel=2,this.label=void 0,this.messages=null,this.messagesCommon=null,this.messagesURIUtils=null,this.spatialReference=null,this.title=null,this.visibleElements={...y$1},this.map=null,this.view=null,this.viewModel=new G$1;}initialize(){this.own(request.i$1(this,"viewModel.contentViewModels",(()=>this._setupContentWidgets())));}loadDependencies(){return Promise.resolve().then(function () { return require('./calcite-notice-755c917e.js'); })}destroy(){this._destroyContentWidgets();}castVisibleElements(e){return {...y$1,...e}}render(){const{state:e}=this.viewModel,t=request.n$1("div",{class:g$2.container,key:"container"},this.renderTitle(),"error"===e?this.renderError():"loading"===e?this.renderLoading():this.renderContentContainer());return request.n$1("div",{class:this.classes(g$2.base,g$2.esriWidget)},t)}setActiveMedia(e,t){this.viewModel.setActiveMedia(e,t);}nextMedia(e){this.viewModel.nextMedia(e);}previousMedia(e){this.viewModel.previousMedia(e);}renderError(){const{messagesCommon:e,messages:t,visibleElements:i}=this;return request.n$1("calcite-notice",{active:!0,color:"red",icon:"exclamation-mark-circle",scale:"s"},i.title?request.n$1("div",{key:"error-title",slot:"title"},e.errorMessage):null,request.n$1("div",{key:"error-message",slot:"message"},t.loadingError))}renderLoading(){return request.n$1("div",{key:"loading-container",class:g$2.loadingSpinnerContainer},request.n$1("span",{class:this.classes(g$2.iconLoading,g$2.spinner)}))}renderContentContainer(){const{visibleElements:e}=this;return e.content?request.n$1("div",{class:g$2.main},[this.renderContent(),this.renderLastEditInfo()]):null}renderTitle(){const{visibleElements:e,title:t}=this;return e.title?request.n$1(Heading.s,{level:this.headingLevel,class:g$2.title,innerHTML:t}):null}renderContent(){const e=this.viewModel.content,t="content";if(!e)return null;if(Array.isArray(e))return e.length?request.n$1("div",{key:`${t}-content-elements`},e.map(this.renderContentElement,this)):null;if("string"==typeof e){const e=this._contentWidgets[0];return !e||e.destroyed?null:request.n$1("div",{key:`${t}-content`},e.render())}return this.renderNodeContent(e)}renderContentElement(e,t){const{visibleElements:i}=this;if("boolean"!=typeof i.content&&!i.content[e.type])return null;switch(e.type){case"attachments":return this.renderAttachments(t);case"custom":return this.renderCustom(e,t);case"fields":return this.renderFields(t);case"media":return this.renderMedia(t);case"text":return this.renderText(e,t);default:return null}}renderAttachments(e){const t=this._contentWidgets[e];if(!t||t.destroyed)return null;const{state:i,attachmentInfos:s}=t.viewModel;return "loading"===i||s.length>0?request.n$1("div",{key:this._buildKey("attachments-element",e),class:this.classes(g$2.contentElement)},t.render()):null}renderCustom(e,t){const{creator:i}=e,s=this._contentWidgets[t];return !s||s.destroyed?null:i?request.n$1("div",{key:this._buildKey("custom-element",t),class:g$2.contentElement},s.render()):null}renderFields(e){const t=this._contentWidgets[e];return !t||t.destroyed?null:request.n$1("div",{key:this._buildKey("fields-element",e),class:g$2.contentElement},t.render())}renderMedia(e){const t=this._contentWidgets[e];return !t||t.destroyed?null:request.n$1("div",{key:this._buildKey("media-element",e),class:g$2.contentElement},t.render())}renderLastEditInfo(){const{visibleElements:e,messages:t}=this,{lastEditInfo:i}=this.viewModel;if(!i||!e.lastEditedInfo)return null;const{date:s,user:n}=i,r="edit"===i.type?n?t.lastEditedByUser:t.lastEdited:n?t.lastCreatedByUser:t.lastCreated,o=request.s$2(r,{date:s,user:n});return request.n$1("div",{key:"edit-info-element",class:this.classes(g$2.lastEditedInfo,g$2.contentElement)},o)}renderText(e,t){const i=e.text,s=this._contentWidgets[t];return !s||s.destroyed?null:i?request.n$1("div",{key:this._buildKey("text-element",t),class:this.classes(g$2.contentElement,g$2.text)},s.render()):null}_buildKey(e,...t){return `${e}__${this.get("viewModel.graphic.uid")||"0"}-${t.join("-")}`}_destroyContentWidgets(){this._contentWidgets.forEach((e=>{e.viewModel=null,e&&!e.destroyed&&e.destroy();})),this._contentWidgets=[];}_setupContentWidgets(){this._destroyContentWidgets();const{headingLevel:e,visibleElements:t}=this,i=this.get("viewModel.content"),{contentViewModels:s}=this.viewModel;if(Array.isArray(i))i.forEach(((i,n)=>{"attachments"===i.type&&(this._contentWidgets[n]=new m$4({displayType:i.displayType,headingLevel:t.title?e+1:e,viewModel:s[n]})),"fields"===i.type&&(this._contentWidgets[n]=new m$3({viewModel:s[n]})),"media"===i.type&&(this._contentWidgets[n]=new g$4({viewModel:s[n]})),"text"===i.type&&(this._contentWidgets[n]=new p$6({viewModel:s[n]})),"custom"===i.type&&(this._contentWidgets[n]=new p$6({viewModel:s[n]}));}),this);else {const e=s[0];e&&!e.destroyed&&(this._contentWidgets[0]=new p$6({viewModel:e}));}this.scheduleRender();}};request.e([request.o("viewModel.graphic")],_$1.prototype,"graphic",void 0),request.e([request.o("viewModel.defaultPopupTemplateEnabled")],_$1.prototype,"defaultPopupTemplateEnabled",void 0),request.e([request.d()],_$1.prototype,"headingLevel",void 0),request.e([request.d({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],_$1.prototype,"label",void 0),request.e([request.d(),request.e$1("esri/widgets/Feature/t9n/Feature")],_$1.prototype,"messages",void 0),request.e([request.d(),request.e$1("esri/t9n/common")],_$1.prototype,"messagesCommon",void 0),request.e([request.d(),request.e$1("esri/widgets/support/t9n/uriUtils")],_$1.prototype,"messagesURIUtils",void 0),request.e([request.o("viewModel.spatialReference")],_$1.prototype,"spatialReference",void 0),request.e([request.o("viewModel.title")],_$1.prototype,"title",void 0),request.e([request.d()],_$1.prototype,"visibleElements",void 0),request.e([request.c("visibleElements")],_$1.prototype,"castVisibleElements",null),request.e([request.o("viewModel.map")],_$1.prototype,"map",void 0),request.e([request.o("viewModel.view")],_$1.prototype,"view",void 0),request.e([request.d({type:G$1})],_$1.prototype,"viewModel",void 0),_$1=request.e([request.i("esri.widgets.Feature")],_$1);const w$1=_$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let c$5=class extends request.n$2.EventedAccessor{constructor(e){super(e),this._anchorHandles=new request.u,this.location=null,this.screenLocation=null,this.screenLocationEnabled=!1,this.view=null,this._anchorHandles.add([request.f(this,["screenLocationEnabled","location","view.size","view.stationary"],(()=>this._updateScreenPointAndHandle())),request.f(this,["view","view.ready"],(()=>this._wireUpView()))]);}destroy(){this.view=null,this._anchorHandles&&this._anchorHandles.destroy(),this._anchorHandles=null,this._viewpointHandle=null;}_wireUpView(){const e="view";this._anchorHandles.remove(e),this._viewpointHandle=null;if(!this.get("view.ready"))return;this._setScreenLocation();const{view:t}=this,o="3d"===t.type?"camera":"viewpoint",i=request.O(t,o,(()=>this._viewpointChange()));this._anchorHandles.add(i,e),this._viewpointHandle=i,this._toggleWatchingViewpoint();}_viewpointChange(){this._setScreenLocation(),this.emit("view-change");}_updateScreenPointAndHandle(){this._setScreenLocation(),this._toggleWatchingViewpoint();}_toggleWatchingViewpoint(){const{_viewpointHandle:e,location:t,screenLocationEnabled:o}=this;if(!e)return;t&&o?e.resume():e.pause();}_setScreenLocation(){const{location:e,view:t,screenLocationEnabled:o}=this,n=this.get("view.ready"),s=o&&n&&request.r(e)?t.toScreen(e):null;this._set("screenLocation",s);}};request.e([request.d()],c$5.prototype,"location",void 0),request.e([request.d({readOnly:!0})],c$5.prototype,"screenLocation",void 0),request.e([request.d()],c$5.prototype,"screenLocationEnabled",void 0),request.e([request.d()],c$5.prototype,"view",void 0),c$5=request.e([request.i("esri.widgets.support.AnchorElementViewModel")],c$5);const l$3=c$5;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const t$4="esri.widgets.CompassViewModel";let p$2=class extends l$3{constructor(s){super(s),this.visible=!1;}};request.e([request.d()],p$2.prototype,"visible",void 0),p$2=request.e([request.i(t$4)],p$2);const c$4=p$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$3={base:"esri-spinner",spinnerStart:"esri-spinner--start",spinnerFinish:"esri-spinner--finish"};let h$1=class extends request.z{constructor(i,s){super(i,s),this._animationDelay=500,this._animationPromise=null,this.location=null,this.view=null,this.viewModel=new c$4,this.visible=!1;}initialize(){this.own([request.f(this,"visible",(i=>this._visibleChange(i)))]);}destroy(){this._animationPromise=null;}show(i){const{location:s,promise:e}=i;s&&(this.viewModel.location=s),this.visible=!0;const o=()=>this.hide();e&&e.catch((()=>{})).then(o);}hide(){this.visible=!1;}render(){const{visible:i}=this,{screenLocation:s}=this.viewModel,e=!!s,o=i&&e,t=!i&&e,r={[c$3.spinnerStart]:o,[c$3.spinnerFinish]:t},n=this._getPositionStyles();return request.n$1("div",{class:this.classes(c$3.base,r),styles:n})}_visibleChange(i){if(i)return void(this.viewModel.screenLocationEnabled=!0);const s=request.L$2(this._animationDelay);this._animationPromise=s,s.catch((()=>{})).then((()=>{this._animationPromise===s&&(this.viewModel.screenLocationEnabled=!1,this._animationPromise=null);}));}_getPositionStyles(){const{screenLocation:i,view:e}=this.viewModel;if(!e||request.t$1(i))return {};const{padding:o}=e;return {left:i.x-o.left+"px",top:i.y-o.top+"px"}}};request.e([request.o("viewModel.location")],h$1.prototype,"location",void 0),request.e([request.o("viewModel.view")],h$1.prototype,"view",void 0),request.e([request.d({type:c$4})],h$1.prototype,"viewModel",void 0),request.e([request.o("viewModel.visible")],h$1.prototype,"visible",void 0),h$1=request.e([request.i("esri.widgets.Spinner")],h$1);const m$1=h$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const t$3=request.s$3("mac")?"Meta":"Ctrl",o$1={8:"Backspace",9:"Tab",13:"Enter",27:"Escape",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete"};for(let s=48;s<58;s++)o$1[s]=String.fromCharCode(s);for(let s=1;s<25;s++)o$1[111+s]=`F${s}`;for(let s=65;s<91;s++)o$1[s]=[String.fromCharCode(s+32),String.fromCharCode(s)];function a$2(e){if(void 0!==e.key)return request.i$2(e);const t=o$1[e.keyCode];return Array.isArray(t)?e.shiftKey?t[1]:t[0]:t}function n$2(r){switch(r){case"Ctrl":case"Alt":case"Shift":case"Meta":case"Primary":return !0}return !1}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class e{constructor(e,t=[]){this.eventType=e,this.keyModifiers=t;}matches(e){if(e.type!==this.eventType)return !1;if(0===this.keyModifiers.length)return !0;const t=e.modifiers;for(const i of this.keyModifiers)if(!t.has(i))return !1;return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const n$1=request.s$1.getLogger("esri.views.input.InputHandler");class i$2{constructor(e){this._manager=null,this._incoming={},this._outgoing={},this._incomingEventMatches=null,this._incomingEventTypes=null,this._outgoingEventTypes=null,this._hasSideEffects=e;}get incomingEventMatches(){if(!this._incomingEventMatches){this._incomingEventMatches=[];for(const e in this._incoming){const t=this._incoming[e];for(const e of t)this._incomingEventMatches.push(e.match);}}return this._incomingEventMatches}get incomingEventTypes(){return this._incomingEventTypes||(this._incomingEventTypes=this.incomingEventMatches.map((e=>e.eventType))),this._incomingEventTypes}get outgoingEventTypes(){return this._outgoingEventTypes||(this._outgoingEventTypes=Object.keys(this._outgoing)),this._outgoingEventTypes}get hasSideEffects(){return this._hasSideEffects}get hasPendingInputs(){return !1}onInstall(e){this._manager?n$1.error("This InputHandler has already been registered with an InputManager"):(e.setEventCallback((e=>this._handleEvent(e))),e.setUninstallCallback((()=>this._onUninstall())),this._manager=e);}onUninstall(){}registerIncoming(e$1,n,i){let a;"function"==typeof n?(i=n,a=[]):a=n||[];const o="string"==typeof e$1?new e(e$1,a):e$1,h=()=>{this._incomingEventTypes=null,this._incomingEventMatches=null;},r=e=>{const t=this._incoming[e.match.eventType];if(t){const n=t.indexOf(e);t.splice(n,1),h(),this._manager&&this._manager.updateDependencies();}},g=new s$2(o,i,{onPause:r,onRemove:r,onResume:e=>{const t=this._incoming[e.match.eventType];t&&-1===t.indexOf(e)&&(t.push(e),h(),this._manager&&this._manager.updateDependencies());}});let c=this._incoming[o.eventType];return c||(c=[],this._incoming[o.eventType]=c),c.push(g),h(),this._manager&&this._manager.updateDependencies(),g}registerOutgoing(e){if(this._outgoing[e])throw Error("There is already a callback registered for this outgoing InputEvent: "+e);const t=new a$1(e,{onEmit:(e,t,n,i)=>{this._manager.emit(e.eventType,t,n,i);},onRemove:e=>{delete this._outgoing[e.eventType],this._manager.updateDependencies();}});return this._outgoing[e]=t,this._outgoingEventTypes=null,this._manager&&this._manager.updateDependencies(),t}startCapturingPointer(e){this._manager.setPointerCapture(e,!0);}stopCapturingPointer(e){this._manager.setPointerCapture(e,!1);}refreshHasPendingInputs(){this._manager.refreshHasPendingInputs();}_onUninstall(){this._manager?(this.onUninstall(),this._manager=null):n$1.error("This InputHandler is not registered with an InputManager");}_handleEvent(e){const t=this._incoming[e.type];if(t)for(const n of t)if(n.match.matches(e)&&(n.callback(e),e.shouldStopPropagation()))break}}class s$2{constructor(e,t,n){this.match=e,this._callback=t,this._handler=n;}pause(){this._handler.onPause(this);}resume(){this._handler.onResume(this);}remove(){this._handler.onRemove(this);}get callback(){return this._callback}}class a$1{constructor(e,t){this.eventType=e,this._removed=!1,this._handler=t;}emit(e,t,n){this._removed||this._handler.onEmit(this,e,t,n);}remove(){this._removed=!0,this._handler.onRemove(this);}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class t$2 extends i$2{constructor(e){super(!0),this._onChange=e,this._value="mouse",this.registerIncoming("pointer-down",(e=>{const t="touch"===e.data.native.pointerType;this._setValue(t?"touch":"mouse");})),this._moveHandler=this.registerIncoming("pointer-move",(e=>{const t="touch"===e.data.native.pointerType;this._setValue(t?"touch":"mouse");})),this._moveHandler.pause();}_setValue(e){e!==this._value&&("touch"===e?this._moveHandler.resume():this._moveHandler.pause(),this._value=e,this._onChange(e));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const h=request.s$1.getLogger("esri.views.input.InputManager");exports.d=class extends request.p{constructor(e){super(e),this._pointerCaptures=new Map,this._nameToGroup={},this._handlers=[],this._currentPropagation=null,this._updateDependenciesAfterPropagation=!1,this._sourceEvents=new Set,this._keyModifiers=new Set,this._activeKeyModifiers=new Set,this._stoppedPropagationEventIds=new Set,this.primaryKey=t$3,this.latestPointerType="mouse",this.test={timestamp:void 0,hasCurrentPropagation:()=>!!this._currentPropagation};}initialize(){this.eventSource.onEventReceived=this._onEventReceived.bind(this),this._installRecognizers();}destroy(){const e=Object.keys(this._nameToGroup);for(const t of e)this.uninstallHandlers(t);this.eventSource=null,this._currentPropagation=null;}get hasPendingInputs(){return this._handlers.some((e=>e.handler.hasPendingInputs))}installHandlers(e,t,r=u$2.INTERNAL){if(this._nameToGroup[e])return void h.error("There is already an InputHandler group registered under the name `"+e+"`");if(0===t.length)return void h.error("Can't register a group of zero handlers");const i={name:e,handlers:t.map((e=>({handler:e,active:!0,removed:!1,priorityIndex:0,groupPriority:r,eventCallback:null,uninstallCallback:null})))};this._nameToGroup[e]=i;for(let n=i.handlers.length-1;n>=0;n--){const e=i.handlers[n];this._handlers.push(e),e.handler.onInstall({updateDependencies:()=>{this.updateDependencies();},emit:(t,r,i,n,s)=>{this._emitInputEvent(e.priorityIndex+1,t,r,i,s,n);},setPointerCapture:(t,r)=>{this._setPointerCapture(i,e,t,r);},setEventCallback:t=>{e.eventCallback=t;},setUninstallCallback:t=>{e.uninstallCallback=t;},refreshHasPendingInputs:()=>{this.notifyChange("hasPendingInputs");}});}this.updateDependencies();}uninstallHandlers(e){const t=this._nameToGroup[e];t?(t.handlers.forEach((e=>{e.removed=!0,e.uninstallCallback();})),delete this._nameToGroup[e],this._currentPropagation?this._currentPropagation.needsHandlerGarbageCollect=!0:this._garbageCollectRemovedHandlers()):h.error("There is no InputHandler group registered under the name `"+e+"`");}hasHandlers(e){return void 0!==this._nameToGroup[e]}updateDependencies(){if(this._currentPropagation)return void(this._updateDependenciesAfterPropagation=!0);this._updateDependenciesAfterPropagation=!1;const e=new Set,t=new Set;this._handlersPriority=[];for(let r=this._handlers.length-1;r>=0;r--){const e=this._handlers[r];e.priorityIndex=r,this._handlersPriority.push(e);}this._handlersPriority=this._sortHandlersPriority(this._handlersPriority);for(let r=this._handlersPriority.length-1;r>=0;r--){const i=this._handlersPriority[r];i.priorityIndex=r;let n=i.handler.hasSideEffects;if(!n)for(const t of i.handler.outgoingEventTypes)if(e.has(t)){n=!0;break}if(n)for(const r of i.handler.incomingEventMatches){e.add(r.eventType);for(const e of r.keyModifiers)n$2(e)||t.add(e);}i.active=n;}this._sourceEvents=e,this._keyModifiers=t,this._pointerCaptures.size>0&&this._sourceEvents.add("pointer-capture-lost"),this._keyModifiers.size>0&&(this._sourceEvents.add("key-down"),this._sourceEvents.add("key-up")),this.eventSource&&(this.eventSource.activeEvents=this._sourceEvents);}_setLatestPointerType(e){this._set("latestPointerType",e);}_onEventReceived(e,t){if("pointer-capture-lost"===e){const e=t;this._pointerCaptures.delete(e.native.pointerId);}this._updateKeyModifiers(e,t);const r=null!=this.test.timestamp?this.test.timestamp:t.native?t.native.timestamp:void 0,i=t.native?t.native.cancelable:void 0;this._emitInputEventFromSource(e,t,r,i);}_updateKeyModifiers(e,t){if(!t)return;let r=!1;const i=()=>{if(!r){const e=new Set;this._activeKeyModifiers.forEach((t=>{e.add(t);})),this._activeKeyModifiers=e,r=!0;}},n=(e,t)=>{t&&!this._activeKeyModifiers.has(e)?(i(),this._activeKeyModifiers.add(e)):!t&&this._activeKeyModifiers.has(e)&&(i(),this._activeKeyModifiers.delete(e));};if("key-down"===e||"key-up"===e){const r=t.key;this._keyModifiers.has(r)&&n(r,"key-down"===e);}const s=t.native;n("Alt",!(!s||!s.altKey)),n("Ctrl",!(!s||!s.ctrlKey)),n("Shift",!(!s||!s.shiftKey)),n("Meta",!(!s||!s.metaKey)),n("Primary",this._activeKeyModifiers.has(this.primaryKey));}_installRecognizers(){this._latestPointerTypeHandler=new t$2((e=>this._setLatestPointerType(e))),this.recognizers.length>0&&this.installHandlers("default",this.recognizers,u$2.INTERNAL),this.installHandlers("input-manager-logic",[this._latestPointerTypeHandler],u$2.INTERNAL);}_setPointerCapture(e,t,r,i){const n=e.name+"-"+t.priorityIndex,s=this._pointerCaptures.get(r.pointerId)||new Set;this._pointerCaptures.set(r.pointerId,s),i?(s.add(n),1===s.size&&this.eventSource&&this.eventSource.setPointerCapture(r,!0)):s.has(n)&&(s.delete(n),0===s.size&&(this._pointerCaptures.delete(r.pointerId),this.eventSource&&this.eventSource.setPointerCapture(r,!1)));}_garbageCollectRemovedHandlers(){this._handlers=this._handlers.filter((e=>!e.removed)),this.updateDependencies();}_emitInputEventFromSource(e,t,r,i){this._emitInputEvent(0,e,t,r,i);}_emitInputEvent(e,t,r,i,n,s){const o=void 0!==i?i:this._currentPropagation?this._currentPropagation.timestamp:performance.now(),a=void 0!==n&&n,p={event:new l$2(t,r,o,s||this._activeKeyModifiers,a),priorityIndex:e};this._currentPropagation?this._currentPropagation.events.push(p):this._doNewPropagation(p);}_doNewPropagation(e){this._currentPropagation={events:new Queue.e,currentHandler:null,needsHandlerGarbageCollect:!1,timestamp:e.event.timestamp},this._currentPropagation.events.push(e),this._continuePropagation();}_continuePropagation(){const e=this._currentPropagation;if(e){for(;this._currentPropagation.events.length>0;){const{event:t,priorityIndex:r}=this._currentPropagation.events.pop(),i=t.data&&t.data.eventId;if(!(null!=i&&this._stoppedPropagationEventIds.has(i)))for(e.currentHandler=this._handlersPriority[r];e.currentHandler;){if(e.currentHandler.removed)e.needsHandlerGarbageCollect=!0;else {if(e.currentHandler.active&&!t.shouldStopPropagation()&&e.currentHandler.eventCallback(t),t.shouldStopPropagation()){null!=i&&this._stoppedPropagationEventIds.add(i);break}if(t.shouldPausePropagation((()=>this._continuePropagation())))return void this._pausePropagation({event:t,priorityIndex:e.currentHandler.priorityIndex+1})}e.currentHandler=this._handlersPriority[e.currentHandler.priorityIndex+1];}}e.needsHandlerGarbageCollect&&this._garbageCollectRemovedHandlers(),this.hasPendingInputs||this._stoppedPropagationEventIds.clear(),this._currentPropagation=null,this._updateDependenciesAfterPropagation&&this.updateDependencies();}}_pausePropagation(e){const t=new Queue.e;for(t.push(e);this._currentPropagation.events.length;)t.push(this._currentPropagation.events.pop());this._currentPropagation.events=t,this._currentPropagation.currentHandler=null;}_compareHandlerPriority(e,t){if(e.handler.hasSideEffects!==t.handler.hasSideEffects)return e.handler.hasSideEffects?1:-1;if(e.groupPriority!==t.groupPriority)return e.groupPriority>t.groupPriority?-1:1;for(const r of e.handler.incomingEventMatches)for(const e of t.handler.incomingEventMatches){if(r.eventType!==e.eventType)continue;const t=r.keyModifiers.filter((t=>-1!==e.keyModifiers.indexOf(t)));if(t.length===r.keyModifiers.length!==(t.length===e.keyModifiers.length))return r.keyModifiers.length>e.keyModifiers.length?-1:1}return e.priorityIndex>t.priorityIndex?-1:1}_sortHandlersPriority(e){const t=[];for(const r of e){let e=0;for(;e<t.length&&this._compareHandlerPriority(r,t[e])>=0;)e++;t.splice(e,0,r);}return t}get debug(){const e=e=>{const t=this._setPointerCapture;this._setPointerCapture=()=>{},e(),this._setPointerCapture=t;};return {injectEvent:(t,r)=>{e((()=>{this._onEventReceived(t,r);}));},disablePointerCapture:e}}};request.e([request.d({readOnly:!0})],exports.d.prototype,"hasPendingInputs",null),request.e([request.d()],exports.d.prototype,"eventSource",void 0),request.e([request.d()],exports.d.prototype,"recognizers",void 0),request.e([request.d({readOnly:!0})],exports.d.prototype,"latestPointerType",void 0),exports.d=request.e([request.i("esri.views.input.InputManager")],exports.d);class l$2{constructor(e,t,r,i,n){this.type=e,this.data=t,this.timestamp=r,this.modifiers=i,this.cancelable=n,this._propagationState=0,this._resumeCallback=null;}stopPropagation(){this._propagationState|=1;}shouldStopPropagation(){return 0!=(1&this._propagationState)}async(e){this._propagationState|=2;const t=(e,t)=>{this._propagationState&=-3;const r=this._resumeCallback;if(this._resumeCallback=null,r&&r(),t)throw e;return e};return ("function"==typeof e?e():e).then((e=>t(e,!1)),(e=>t(e,!0)))}shouldPausePropagation(e){return !!(2&this._propagationState)&&(this._resumeCallback=e,!0)}preventDefault(){this.data.native.preventDefault();}}const u$2={DEFAULT:0,TOOL:-1,WIDGET:-2,INTERNAL:-3};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const s$1={iconZoom:"esri-icon-zoom-in-magnifying-glass",iconTrash:"esri-icon-trash",iconBrowseClusteredFeatures:"esri-icon-table"},o=new PopupTemplate.a({id:"zoom-to-feature",title:"{messages.zoom}",className:s$1.iconZoom}),t$1=new PopupTemplate.a({id:"remove-selected-feature",title:"{messages.remove}",className:s$1.iconTrash}),r=new PopupTemplate.a({id:"zoom-to-clustered-features",title:"{messages.zoom}",className:s$1.iconZoom}),i$1=new PopupTemplate.a({id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:s$1.iconBrowseClusteredFeatures});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const a="esri.widgets.Popup.PopupViewModel",s=request.s$1.getLogger(a),c$2=function(t){const{event:a,view:s}=t,{action:c}=a,u=s&&s.popup;if(!c)return Promise.reject(new request.s("trigger-action:missing-arguments","Event has no action"));if(!u)return Promise.reject(new request.s("trigger-action:missing-arguments","view.popup is missing"));const{disabled:d,id:w}=c;if(!w)return Promise.reject(new request.s("trigger-action:invalid-action","action.id is missing"));if(d)return Promise.reject(new request.s("trigger-action:invalid-action","Action is disabled"));if(w===o.id)return l$1(u.viewModel);if(w===r.id)return g$1(u.viewModel);if(w===i$1.id)return u.featureMenuOpen=!u.featureMenuOpen,u.viewModel.browseClusterEnabled=!u.viewModel.browseClusterEnabled,Promise.resolve();if(u.viewModel.browseClusterEnabled=!1,w===t$1.id){u.close();const{selectedFeature:t}=u;if(!t)return Promise.reject(new request.s(`trigger-action:${t$1.id}`,"selectedFeature is required",{selectedFeature:t}));const{sourceLayer:r}=t;return r?r.remove(t):s.graphics.remove(t),Promise.resolve()}return Promise.resolve()};function u$1(e){const{selectedFeature:t,location:r,view:i}=e;if(!i)return null;if("3d"===i.type)return t||r;return e.get("selectedFeature.geometry")||r}function d(t,r){if("3d"!==(null==r?void 0:r.type)||!t||"esri.Graphic"!==t.declaredClass)return !0;const i=r.getViewForGraphic(t);if(i&&"whenGraphicBounds"in i){let r=!1;return i.whenGraphicBounds(t,{useViewElevation:!0}).then((e=>{r=!e||!e.boundingBox||e.boundingBox[0]===e.boundingBox[3]&&e.boundingBox[1]===e.boundingBox[4]&&e.boundingBox[2]===e.boundingBox[5];})).catch((()=>{const r=new request.s("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:t});s.error(r);})),r}return !0}async function l$1(t){const{location:i,selectedFeature:o$1,view:n,zoomFactor:a}=t,c=u$1(t);if(!c){const t=new request.s("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",{target:c,view:n});return s.error(t),Promise.reject(t)}const l=n.scale/a,g=t.get("selectedFeature.geometry")||i,w=g&&"point"===g.type&&d(o$1,n);o.active=!0,o.disabled=!0,await t.view.goTo({target:c,scale:w?l:void 0}),o.active=!1,o.disabled=!1,t.zoomToLocation=null,w&&(t.location=g);}async function g$1(t){const{selectedFeature:r$1,view:o}=t;if("2d"!==(null==o?void 0:o.type)){const t=new request.s("zoomToCluster:invalid-view","View must be 2d MapView.",{view:o});throw s.error(t),t}if(!r$1.isAggregate){const t=new request.s("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r$1});throw s.error(t),t}const n=r$1.sourceLayer,a=await o.whenLayerView(n),c=a.createQuery();c.aggregateIds=[r$1.getObjectId()],r.active=!0,r.disabled=!0;const{extent:u}=await a.queryExtent(c);await o.goTo({target:u}),r.active=!1,r.disabled=!1;}async function w(t){const{selectedFeature:r,view:i}=t;if("2d"!==(null==i?void 0:i.type)){const t=new request.s("displayClusterExtent:invalid-view","View must be 2d MapView.",{view:i});throw s.error(t),t}if(!r.isAggregate){const t=new request.s("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r});throw s.error(t),t}const o=r.sourceLayer,n=await i.whenLayerView(o),a=n.createQuery();a.aggregateIds=[r.getObjectId()];const{extent:c}=await n.queryExtent(a);t.selectedClusterBoundaryFeature.geometry=c,i.graphics.add(t.selectedClusterBoundaryFeature);}async function v$1(t){const{selectedFeature:r,view:i}=t;if("2d"!==(null==i?void 0:i.type)){const t=new request.s("browseAggregateFeatures:invalid-view","View must be 2d MapView.",{view:i});throw s.error(t),t}if(!r.isAggregate){const t=new request.s("browseAggregateFeatures:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:r});throw s.error(t),t}const n=r.sourceLayer,a=await i.whenLayerView(n),c=a.createQuery();c.aggregateIds=[r.getObjectId()],i$1.active=!0,i$1.disabled=!0;const{features:u}=await a.queryFeatures(c);i$1.active=!1,i$1.disabled=!1,i.popup.open({features:[r].concat(u),featureMenuOpen:!0});}function p$1(e){e.features=e.features.filter((e=>e.isAggregate));}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const T$1=request.S.ofType({key:"type",defaultKeyValue:"button",base:PopupTemplate.c,typeMap:{button:PopupTemplate.a,toggle:PopupTemplate.a$1}}),S$1=()=>[o.clone()],B$1=()=>[r.clone(),i$1.clone()],R$1="esri.widgets.Popup.PopupViewModel",G=request.s$1.getLogger(R$1);let z=class extends(GoTo.e(l$3)){constructor(e){super(e),this._handles=new request.u,this._pendingPromises=new Set,this._fetchFeaturesController=null,this._selectedClusterFeature=null,this.featurePage=null,this.actions=new T$1,this.defaultPopupTemplateEnabled=!1,this.autoCloseEnabled=!1,this.autoOpenEnabled=!0,this.browseClusterEnabled=!1,this.content=null,this.featuresPerPage=20,this.featureViewModelAbilities=null,this.featureViewModels=[],this.highlightEnabled=!0,this.includeDefaultActions=!0,this.selectedClusterBoundaryFeature=new Graphic.h({symbol:new SimpleLineSymbol.S({outline:{width:1.5,color:"cyan"},style:"none"})}),this.title=null,this.updateLocationEnabled=!1,this.view=null,this.visible=!1,this.zoomFactor=4,this.zoomToLocation=null;}get isLoadingFeature(){return this.featureViewModels.some((e=>e.waitingForContent))}initialize(){this._handles.add([request.i$1(this,["autoOpenEnabled","view"],(()=>this._autoOpenEnabledChange())),this.on("view-change",(()=>this._autoClose())),request.f(this,["highlightEnabled","selectedFeature","visible","view"],(()=>this._highlightFeature())),request.f(this,"view.animation.state",(e=>this._animationStateChange(e))),request.f(this,"location",(e=>this._locationChange(e))),request.f(this,"selectedFeature",(e=>this._selectedFeatureChange(e))),request.f(this,["selectedFeatureIndex","featureCount","featuresPerPage"],(()=>this._selectedFeatureIndexChange())),request.f(this,["featurePage","selectedFeatureIndex","featureCount","featuresPerPage, featureViewModels"],(()=>this._setGraphicOnFeatureViewModels())),request.f(this,"featureViewModels",(()=>this._featureViewModelsChange())),this.on("trigger-action",(e=>c$2({event:e,view:this.view}))),request.h$1(this,"waitingForResult",(()=>this._waitingForResultChange()),!0),request.f(this,["features","view","view.map","view.spatialReference"],(()=>this._updateFeatureVMs())),request.f(this,["view.scale"],this._viewScaleChange),request.h$1(this,"visible",(()=>this.browseClusterEnabled=!1)),request.f(this,"browseClusterEnabled",(e=>e?this.enableClusterBrowsing():this.disableClusterBrowsing()))]);}destroy(){this._cancelFetchingFeatures(),this._handles.destroy(),this._handles=null,this._pendingPromises.clear(),this.browseClusterEnabled=!1,this.view=null;}get active(){return !(!this.visible||this.waitingForResult)}get allActions(){const e=this._get("allActions")||new T$1;e.removeAll();const{actions:t,defaultActions:s,defaultPopupTemplateEnabled:i,includeDefaultActions:o,selectedFeature:r}=this,n=o?s.concat(t):t,a=r&&("function"==typeof r.getEffectivePopupTemplate&&r.getEffectivePopupTemplate(i)||r.popupTemplate),l=a&&a.actions,u=a&&a.overwriteActions?l:l?l.concat(n):n;return u&&u.filter(Boolean).forEach((t=>e.add(t))),e}get defaultActions(){var e;const t=this._get("defaultActions")||new T$1;return t.removeAll(),t.addMany(null!=(e=this.selectedFeature)&&e.isAggregate?B$1():S$1()),t}get featureCount(){return this.features.length}get features(){return this._get("features")||[]}set features(e){const t=e||[];this._set("features",t);const{pendingPromisesCount:s,promiseCount:i,selectedFeatureIndex:o}=this,r=i&&t.length;r&&s&&-1===o?this.selectedFeatureIndex=0:r&&-1!==o||(this.selectedFeatureIndex=t.length?0:-1);}get location(){return this._get("location")||null}set location(e){const t=this.get("view.spatialReference.isWebMercator");e&&e.get("spatialReference.isWGS84")&&t&&(e=request.R(e)),this._set("location",e);}get pendingPromisesCount(){return this._pendingPromises.size}get waitingForResult(){return !(!(!!this._fetchFeaturesController||this.pendingPromisesCount>0)||0!==this.featureCount)}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(e){if(this._pendingPromises.clear(),this.features=[],!Array.isArray(e)||!e.length)return this._set("promises",[]),void this.notifyChange("pendingPromisesCount");this._set("promises",e),(e=e.slice(0)).forEach((e=>{this._pendingPromises.add(e);const t=t=>{this._pendingPromises.has(e)&&this._updateFeatures(t),this._updatePendingPromises(e);},s=()=>this._updatePendingPromises(e);e.then(t,s);})),this.notifyChange("pendingPromisesCount");}get selectedFeature(){const{features:e,selectedFeatureIndex:t}=this;if(-1===t)return null;return e[t]||null}get selectedFeatureIndex(){const e=this._get("selectedFeatureIndex");return "number"==typeof e?e:-1}set selectedFeatureIndex(e){const{featureCount:t}=this;e=isNaN(e)||e<-1||!t?-1:(e+t)%t,this._set("selectedFeatureIndex",e);}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||null}get state(){return this.get("view.ready")?"ready":"disabled"}centerAtLocation(){const{view:e}=this,t=u$1(this);if(!t){const s=new request.s("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:t,view:e});return G.error(s),Promise.reject(s)}return this.callGoTo({target:{target:t,scale:e.scale}})}clear(){this.set({promises:[],features:[],content:null,title:null,location:null});}fetchFeatures(e,t){const{view:s}=this;if(!s||!e){const t=new request.s("fetch-features:invalid-screenpoint-or-view","Cannot fetch features without a screenPoint and view.",{screenPoint:e,view:s});return G.error(t),Promise.reject(t)}return s.fetchPopupFeatures(e,{event:t&&t.event,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:t&&t.signal})}open(e){const t={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...e,visible:!0},{fetchFeatures:s}=t;delete t.fetchFeatures,s&&this._setFetchFeaturesPromises(t.location),this.set(t);}triggerAction(e){const t=this.allActions.getItemAt(e);t&&!t.disabled&&this.emit("trigger-action",{action:t});}next(){return this.selectedFeatureIndex=this.selectedFeatureIndex+1,this}previous(){return this.selectedFeatureIndex=this.selectedFeatureIndex-1,this}disableClusterBrowsing(){p$1(this),this._clearBrowsedClusterGraphics();}async enableClusterBrowsing(){await w(this),await v$1(this);}_animationStateChange(e){this.zoomToLocation||(o.disabled="waiting-for-target"===e);}_clearBrowsedClusterGraphics(){var e;const t=null==(e=this.view)?void 0:e.graphics;t&&(t.remove(this.selectedClusterBoundaryFeature),t.remove(this._selectedClusterFeature)),this._selectedClusterFeature=null,this.selectedClusterBoundaryFeature.geometry=null;}_viewScaleChange(){var e;(null!=(e=this.selectedFeature)&&e.isAggregate||this.browseClusterEnabled)&&(this.browseClusterEnabled=!1,this.visible=!1);}_locationChange(e){const{selectedFeature:t,updateLocationEnabled:s}=this;s&&e&&(!t||t.geometry)&&this.centerAtLocation();}_selectedFeatureIndexChange(){this.featurePage=this.featureCount>1?Math.floor(this.selectedFeatureIndex/this.featuresPerPage)+1:null;}_featureViewModelsChange(){this.featurePage=this.featureCount>1?1:null;}_setGraphicOnFeatureViewModels(){const{features:e,featureCount:t,featurePage:s,featuresPerPage:i,featureViewModels:o}=this;if(null===s)return;const r=((s-1)*i+t)%t,n=r+i;o.slice(r,n).forEach(((t,s)=>{t&&!t.graphic&&(t.graphic=e[r+s]);}));}async _selectedFeatureChange(e){if(!e)return;const{location:t,updateLocationEnabled:s,view:i}=this;if(this.browseClusterEnabled){if(this._selectedClusterFeature&&(i.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),e.isAggregate)return;return e.symbol=await f$8(e),this._selectedClusterFeature=e,void i.graphics.add(this._selectedClusterFeature)}!s&&t||!e.geometry?s&&!e.geometry&&this.centerAtLocation().then((()=>{this.location=i.center.clone();})):this.location=request.e$2(this._getPointFromGeometry(e.geometry));}_waitingForResultChange(){!this.featureCount&&this.promises&&(this.visible=!1);}_setFetchFeaturesPromises(e){return this._fetchFeaturesWithController(this._getScreenPoint(e||this.location)).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:s}=e,i=Promise.resolve(t),o=s.map((e=>e.promise));this.promises=[i,...o];}))}_destroyFeatureVMs(){this.featureViewModels.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",[]);}_updateFeatureVMs(){const{selectedFeature:e,features:t,featureViewModels:s}=this;if(null!=e&&e.isAggregate||(this.browseClusterEnabled=!1),this._destroyFeatureVMs(),!t||!t.length)return;const i=s.slice(0),o=[];t.forEach(((t,s)=>{if(!t)return;let r=null;if(i.some(((e,s)=>(e&&e.graphic===t&&(r=e,i.splice(s,1)),!!r))),r)o[s]=r;else {var n,a;const i=new G$1({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:null==(n=this.view)?void 0:n.spatialReference,graphic:t===e?t:null,map:null==(a=this.view)?void 0:a.map,view:this.view});o[s]=i;}})),i.forEach((e=>e&&!e.destroyed&&e.destroy())),this._set("featureViewModels",o);}_getScreenPoint(e){const{view:t}=this;return t&&e&&"function"==typeof t.toScreen?t.toScreen(e):null}_autoOpenEnabledChange(){const e="auto-fetch-features",{_handles:t,autoOpenEnabled:s}=this;if(t.remove(e),s&&this.view){const s=this.view.on("click",(e=>{"mouse"===e.pointerType&&0!==e.button||this._fetchFeaturesAndOpen(e);}),u$2.WIDGET);t.add(s,e);}}_cancelFetchingFeatures(){const e=this._fetchFeaturesController;e&&e.abort(),this._fetchFeaturesController=null,this.notifyChange("waitingForResult");}_fetchFeaturesWithController(e,t){this._cancelFetchingFeatures();const s=new AbortController,{signal:i}=s;this._fetchFeaturesController=s,this.notifyChange("waitingForResult");const o=this.fetchFeatures(e,{signal:i,event:t});return o.catch((()=>{})).then((()=>{this._fetchFeaturesController=null,this.notifyChange("waitingForResult");})),o}_fetchFeaturesAndOpen(e){const{screenPoint:t,mapPoint:s}=e,{view:i}=this;this._fetchFeaturesWithController(t,e).then((e=>{const{clientOnlyGraphics:t,promisesPerLayerView:o,location:r}=e,n=[Promise.resolve(t),...o.map((e=>e.promise))];return i.popup.open({location:r||s,promises:n}),e}));}_updatePendingPromises(e){e&&this._pendingPromises.has(e)&&(this._pendingPromises.delete(e),this.notifyChange("pendingPromisesCount"));}_autoClose(){this.autoCloseEnabled&&(this.visible=!1);}_getPointFromGeometry(e){return request.t$1(e)?null:"point"===e.type?e:"extent"===e.type?e.center:"polygon"===e.type?e.centroid:"multipoint"===e.type||"polyline"===e.type?e.extent.center:null}async _getLayerView(e,t){return await e.when(),e.whenLayerView(t)}async _highlightFeature(){const e="highlight";this._handles.remove(e);const{selectedFeature:t,highlightEnabled:s,view:i,visible:o}=this;if(!(t&&i&&s&&o))return;let{layer:r,sourceLayer:n}=t;if("map-notes"!==(null==n?void 0:n.type)&&"subtype-group"!==(null==n?void 0:n.type)||(r=n),!(r&&r instanceof Layer.b))return;const a=this._getLayerView(i,r);this._highlightPromise=a;const l=await a;if(!(l&&layerViewUtils.e(l)&&this._highlightPromise===a&&this.selectedFeature&&this.highlightEnabled&&this.visible))return;const u="objectIdField"in r&&r.objectIdField,h=t.attributes,c=h&&u&&h[u],p=l.highlight(c||t);this._handles.add(p,e);}_updateFeatures(e){const{features:t}=this;if(!e||!e.length)return;if(!t.length)return void(this.features=e);const s=e.filter((e=>-1===t.indexOf(e)));this.features=t.concat(s);}};request.e([request.d()],z.prototype,"featurePage",void 0),request.e([request.d()],z.prototype,"isLoadingFeature",null),request.e([request.d({type:T$1})],z.prototype,"actions",void 0),request.e([request.d({readOnly:!0})],z.prototype,"active",null),request.e([request.d({readOnly:!0})],z.prototype,"allActions",null),request.e([request.d({type:Boolean})],z.prototype,"defaultPopupTemplateEnabled",void 0),request.e([request.d()],z.prototype,"autoCloseEnabled",void 0),request.e([request.d()],z.prototype,"autoOpenEnabled",void 0),request.e([request.d()],z.prototype,"browseClusterEnabled",void 0),request.e([request.d()],z.prototype,"content",void 0),request.e([request.d({type:T$1,readOnly:!0})],z.prototype,"defaultActions",null),request.e([request.d({readOnly:!0})],z.prototype,"featureCount",null),request.e([request.d()],z.prototype,"features",null),request.e([request.d()],z.prototype,"featuresPerPage",void 0),request.e([request.d()],z.prototype,"featureViewModelAbilities",void 0),request.e([request.d({readOnly:!0})],z.prototype,"featureViewModels",void 0),request.e([request.d()],z.prototype,"highlightEnabled",void 0),request.e([request.d()],z.prototype,"includeDefaultActions",void 0),request.e([request.d({type:request.b$2})],z.prototype,"location",null),request.e([request.d({readOnly:!0})],z.prototype,"pendingPromisesCount",null),request.e([request.d({readOnly:!0})],z.prototype,"selectedClusterBoundaryFeature",void 0),request.e([request.d({readOnly:!0})],z.prototype,"waitingForResult",null),request.e([request.d({readOnly:!0})],z.prototype,"promiseCount",null),request.e([request.d()],z.prototype,"promises",null),request.e([request.d({value:null,readOnly:!0})],z.prototype,"selectedFeature",null),request.e([request.d({value:-1})],z.prototype,"selectedFeatureIndex",null),request.e([request.d({readOnly:!0})],z.prototype,"selectedFeatureViewModel",null),request.e([request.d({readOnly:!0})],z.prototype,"state",null),request.e([request.d()],z.prototype,"title",void 0),request.e([request.d()],z.prototype,"updateLocationEnabled",void 0),request.e([request.d()],z.prototype,"view",void 0),request.e([request.d()],z.prototype,"visible",void 0),request.e([request.d()],z.prototype,"zoomFactor",void 0),request.e([request.d()],z.prototype,"zoomToLocation",void 0),request.e([request.d()],z.prototype,"centerAtLocation",null),z=request.e([request.i(R$1)],z);const U$1=z;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const O="selected-index",N=0,B="popup-spinner",T={iconLeftTriangleArrow:"esri-icon-left-triangle-arrow",iconRightTriangleArrow:"esri-icon-right-triangle-arrow",iconDockToTop:"esri-icon-maximize",iconDockToBottom:"esri-icon-dock-bottom",iconDockToLeft:"esri-icon-dock-left",iconDockToRight:"esri-icon-dock-right",iconClose:"esri-icon-close",iconUndock:"esri-icon-minimize",iconCheckMark:"esri-icon-check-mark",iconLoading:"esri-icon-loading-indicator",iconDefaultAction:"esri-icon-default-action",iconActionsMenu:"esri-icon-handle-horizontal",rotating:"esri-rotating",base:"esri-popup",widget:"esri-widget",main:"esri-popup__main-container",loadingContainer:"esri-popup__loading-container",isCollapsible:"esri-popup--is-collapsible",isCollapsed:"esri-popup--is-collapsed",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",isFeatureMenuOpen:"esri-popup--feature-menu-open",isActionsMenuOpen:"esri-popup--actions-menu-open",hasFeatureUpdated:"esri-popup--feature-updated",header:"esri-popup__header",headerButtons:"esri-popup__header-buttons",headerContainer:"esri-popup__header-container",headerContainerButton:"esri-popup__header-container--button",headerTitle:"esri-popup__header-title",content:"esri-popup__content",footer:"esri-popup__footer",footerHasPagination:"esri-popup__footer--has-pagination",footerHasActions:"esri-popup__footer--has-actions",footerHasActionsMenu:"esri-popup__footer--has-actions-menu",button:"esri-popup__button",buttonDisabled:"esri-popup__button--disabled",buttonDock:"esri-popup__button--dock",icon:"esri-popup__icon",iconDock:"esri-popup__icon--dock-icon",inlineActionsContainer:"esri-popup__inline-actions-container",actionsMenuButton:"esri-popup__actions-menu-button",actions:"esri-popup__actions",action:"esri-popup__action",actionImage:"esri-popup__action-image",actionText:"esri-popup__action-text",actionToggle:"esri-popup__action-toggle",actionToggleOn:"esri-popup__action-toggle--on",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction",navigation:"esri-popup__navigation",paginationPrevious:"esri-popup__pagination-previous",paginationNext:"esri-popup__pagination-next",paginationPreviousIconLTR:"esri-popup__pagination-previous-icon",paginationPreviousIconRTL:"esri-popup__pagination-previous-icon--rtl",paginationNextIconLTR:"esri-popup__pagination-next-icon",paginationNextIconRTL:"esri-popup__pagination-next-icon--rtl",featureMenu:"esri-popup__feature-menu",featureMenuList:"esri-popup__feature-menu-list",featureMenuItem:"esri-popup__feature-menu-item",featureMenuViewport:"esri-popup__feature-menu-viewport",featureMenuHeader:"esri-popup__feature-menu-header",featureMenuNote:"esri-popup__feature-menu-note",featureMenuSelected:"esri-popup__feature-menu-item--selected",featureMenuButton:"esri-popup__feature-menu-button",featureMenuTitle:"esri-popup__feature-menu-title",featureMenuObserver:"esri-popup__feature-menu-observer",featureMenuLoader:"esri-popup__feature-menu-loader",collapseButton:"esri-popup__collapse-button"},D={buttonEnabled:!0,position:"auto",breakpoint:{width:544}},E="esri-popup";function P(e,t){return void 0===t?`${E}__${e}`:`${E}__${e}-${t}`}const L="esri.widgets.Popup",S=request.s$1.getLogger(L),V={closeButton:!0,featureNavigation:!0};let R=class extends(i$3(request.z)){constructor(e,t){super(e,t),this._blurClose=!1,this._blurContainer=!1,this._containerNode=null,this._mainContainerNode=null,this._featureMenuNode=null,this._actionsMenuNode=null,this._focusClose=!1,this._focusContainer=!1,this._focusDockButton=!1,this._focusFeatureMenuButton=!1,this._focusActionsMenuButton=!1,this._focusFirstFeature=!1,this._focusFirstAction=!1,this._handles=new request.u,this._pointerOffsetInPx=16,this._spinner=null,this._feature=null,this._featureMenuIntersectionObserverCallback=([e])=>{null!=e&&e.isIntersecting&&this.viewModel.featurePage++;},this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback),this._displaySpinnerThrottled=e$5((()=>this._displaySpinner()),N),this.actions=null,this.alignment="auto",this.autoCloseEnabled=null,this.autoOpenEnabled=null,this.defaultPopupTemplateEnabled=null,this.content=null,this.collapsed=!1,this.collapseEnabled=!0,this.dockEnabled=!1,this.featureCount=null,this.featureMenuOpen=!1,this.features=null,this.goToOverride=null,this.headingLevel=2,this.highlightEnabled=null,this.location=null,this.label=void 0,this.maxInlineActions=3,this.messages=null,this.messagesCommon=null,this.promises=null,this.selectedFeature=null,this.selectedFeatureIndex=null,this.spinnerEnabled=!0,this.title=null,this.updateLocationEnabled=null,this.view=null,this.viewModel=new U$1,this.visible=null,this.visibleElements={...V},this._addSelectedFeatureIndexHandle(),this.own([request.f(this,"viewModel.screenLocation",(()=>this._positionContainer())),request.f(this,["viewModel.active","dockEnabled"],(()=>this._toggleScreenLocationEnabled())),request.f(this,"viewModel.screenLocation",((e,t)=>{!!e!=!!t&&this.reposition();})),request.f(this,["viewModel.view.padding","viewModel.view.size","viewModel.active","viewModel.location","alignment"],(()=>this.reposition())),request.f(this,"spinnerEnabled",(e=>this._spinnerEnabledChange(e))),request.f(this,"viewModel.view.size",((e,t)=>this._updateDockEnabledForViewSize(e,t))),request.f(this,"viewModel.view",((e,t)=>this._viewChange(e,t))),request.f(this,"viewModel.view.ready",((e,t)=>this._viewReadyChange(e,t))),request.f(this,["viewModel.waitingForResult","viewModel.location"],(()=>{this._hideSpinner(),this._displaySpinnerThrottled();})),request.f(this,["selectedFeatureWidget.viewModel.title","selectedFeatureWidget.viewModel.state"],(()=>this._setTitleFromFeatureWidget())),request.f(this,["selectedFeatureWidget.viewModel.content","selectedFeatureWidget.viewModel.state"],(()=>this._setContentFromFeatureWidget())),request.h$1(this,"collapsed",(()=>{var e,t;"xsmall"===(null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint)&&this.viewModel.active&&this.collapseEnabled&&this.viewModel.centerAtLocation();})),request.$(this,"viewModel.allActions","change",(()=>this._watchActions())),request.i$1(this,"viewModel.allActions",(()=>this._watchActions())),request.f(this,"viewModel.featureViewModels",(()=>this._featureMenuViewportScrollTop()))]);}destroy(){var e,t;this._destroySelectedFeatureWidget(),this._destroySpinner(),null==(e=this._handles)||e.destroy(),this._unobserveFeatureMenuObserver(),null==(t=this._featureMenuIntersectionObserver)||t.disconnect(),this._handles=null;}get actionsMenuId(){return `${this.id}-actions-menu`}get actionsMenuButtonId(){return `${this.id}-actions-menu-button`}get featureMenuId(){return `${this.id}-feature-menu`}get titleId(){return `${this.id}-popup-title`}get contentId(){return `${this.id}-popup-content`}get hasContent(){var e,t,i,o,n,s,r;return !!(this.selectedFeatureWidget?(null==(e=this.selectedFeatureWidget)||null==(t=e.viewModel)?void 0:t.waitingForContent)||"error"===(null==(i=this.selectedFeatureWidget)||null==(o=i.viewModel)?void 0:o.state)||(null==(n=this.selectedFeatureWidget)||null==(s=n.viewModel)?void 0:s.content):null==(r=this.viewModel)?void 0:r.content)}get featureNavigationVisible(){return this.viewModel.active&&this.viewModel.featureCount>1&&this.visibleElements.featureNavigation}get collapsible(){return !!(this.collapseEnabled&&this.viewModel.title&&this.hasContent)}get featureMenuVisible(){return this.featureNavigationVisible&&this.featureMenuOpen}get contentCollapsed(){return this.collapsible&&!this.featureMenuVisible&&this.collapsed}get dividedActions(){return this._divideActions()}set actionsMenuOpen(e){this._set("actionsMenuOpen",!!e);}get actionsMenuOpen(){return !!this.viewModel.active&&this._get("actionsMenuOpen")}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||D}set dockOptions(e){const t={...D},i=this.get("viewModel.view.breakpoints"),o={};i&&(o.width=i.xsmall,o.height=i.xsmall);const n={...t,...e},s={...t.breakpoint,...o},{breakpoint:r}=n;!0===r?n.breakpoint=s:"object"==typeof r&&(n.breakpoint={...s,...r}),this._set("dockOptions",n),this._setCurrentDockPosition(),this.reposition();}get selectedFeatureWidget(){const{_feature:e,visibleElements:t,headingLevel:i}=this,{selectedFeatureViewModel:o}=this.viewModel,n={...t,title:!1};return o?(e?(e.viewModel=o,e.visibleElements=n):this._feature=new w$1({headingLevel:i+1,viewModel:o,visibleElements:n}),this._feature):null}castVisibleElements(e){return {...V,...e}}blur(){const{active:e}=this.viewModel;e||S.warn("Popup can only be blurred when currently active."),this.visibleElements.closeButton?this._blurClose=!0:this._blurContainer=!0,this.scheduleRender();}clear(){this.viewModel.clear();}close(){this.visible=!1;}fetchFeatures(e,t){return this.viewModel.fetchFeatures(e,t)}focus(){const{active:e}=this.viewModel;e||S.warn("Popup can only be focused when currently active."),this.visibleElements.closeButton?this._focusClose=!0:this._focusContainer=!0,this.scheduleRender();}next(){return this.viewModel.next()}open(e){var t,i;this._handles.remove(O);const o=!!e&&!!e.featureMenuOpen,n=!!e&&!!e.actionsMenuOpen,s={collapsed:!!e&&!!e.collapsed,actionsMenuOpen:n,featureMenuOpen:o};"xsmall"===(null==(t=this.viewModel)||null==(i=t.view)?void 0:i.widthBreakpoint)&&(s.collapsed=!0),this.set(s),this.viewModel.open(e),this._addSelectedFeatureIndexHandle();}previous(){return this.viewModel.previous()}reposition(){this.renderNow(),this._positionContainer(),this._setCurrentAlignment();}triggerAction(e){this.viewModel.triggerAction(e);}render(){var e,t,i,o;const{actionsMenuOpen:n,dockEnabled:s,featureMenuVisible:r,dividedActions:a,currentAlignment:l,currentDockPosition:u}=this,{active:c}=this.viewModel,{menuActions:d}=a,p=c&&d.length>1&&n,h=c&&s,g=c&&!s,_=null==(e=this.selectedFeature)||null==(t=e.layer)?void 0:t.title,f=null==(i=this.selectedFeature)||null==(o=i.layer)?void 0:o.id,v={[T.alignTopCenter]:"top-center"===l,[T.alignBottomCenter]:"bottom-center"===l,[T.alignTopLeft]:"top-left"===l,[T.alignBottomLeft]:"bottom-left"===l,[T.alignTopRight]:"top-right"===l,[T.alignBottomRight]:"bottom-right"===l,[T.isDocked]:h,[T.shadow]:g,[T.isDockedTopLeft]:"top-left"===u,[T.isDockedTopCenter]:"top-center"===u,[T.isDockedTopRight]:"top-right"===u,[T.isDockedBottomLeft]:"bottom-left"===u,[T.isDockedBottomCenter]:"bottom-center"===u,[T.isDockedBottomRight]:"bottom-right"===u,[T.isFeatureMenuOpen]:r,[T.isActionsMenuOpen]:p};return request.n$1("div",{class:this.classes(T.base,v),role:"presentation","data-layer-title":_,"data-layer-id":f,bind:this,afterCreate:this._positionContainer,afterUpdate:this._positionContainer},c?[this.renderMainContainer(),this.renderPointer()]:null)}renderLoadingIcon(){return request.n$1("span",{"aria-hidden":"true",class:this.classes(T.icon,T.iconLoading,T.rotating)})}renderNavigationLoading(){const{messagesCommon:e}=this;return this.viewModel.pendingPromisesCount?request.n$1("div",{key:P("loading-container"),role:"presentation",class:T.loadingContainer,"aria-label":e.loading,title:e.loading},this.renderLoadingIcon()):null}renderPreviousIcon(){const e=request.d$3(this.container),t={[T.iconRightTriangleArrow]:e,[T.paginationPreviousIconRTL]:e,[T.iconLeftTriangleArrow]:!e,[T.paginationPreviousIconLTR]:!e};return request.n$1("span",{"aria-hidden":"true",class:this.classes(T.icon,t)})}renderPreviousButton(){const{messages:e}=this;return request.n$1("div",{role:"button",tabIndex:0,bind:this,onclick:this._previous,onkeydown:this._previous,class:this.classes(T.button,T.paginationPrevious),"aria-label":e.previous,title:e.previous},this.renderPreviousIcon())}renderNextIcon(){const e=request.d$3(this.container),t={[T.iconLeftTriangleArrow]:e,[T.paginationNextIconRTL]:e,[T.iconRightTriangleArrow]:!e,[T.paginationNextIconLTR]:!e};return request.n$1("span",{"aria-hidden":"true",class:this.classes(T.icon,t)})}renderNextButton(){const{messages:e}=this;return request.n$1("div",{role:"button",tabIndex:0,bind:this,onclick:this._next,onkeydown:this._next,class:this.classes(T.button,T.paginationNext),"aria-label":e.next,title:e.next},this.renderNextIcon())}renderFeatureMenuButton(){const{featureMenuOpen:e,featureMenuId:t,messagesCommon:i}=this,{featureCount:o,selectedFeatureIndex:n}=this.viewModel;return request.n$1("div",{role:"button",tabIndex:0,bind:this,onclick:this._toggleFeatureMenu,onkeydown:this._toggleFeatureMenu,afterCreate:this._focusFeatureMenuButtonNode,afterUpdate:this._focusFeatureMenuButtonNode,class:this.classes(T.button,T.featureMenuButton),"aria-haspopup":"true","aria-controls":t,"aria-expanded":e.toString(),"aria-label":i.menu,title:i.menu},this._getPageText(o,n))}renderNavigationButtons(){return this.featureNavigationVisible?[this.renderPreviousButton(),this.renderNavigationLoading()||this.renderFeatureMenuButton(),this.renderNextButton()]:null}renderDockIcon(){const{dockEnabled:e}=this,t=this._wouldDockTo(),i={[T.iconUndock]:e,[T.iconDock]:!e,[T.iconDockToRight]:!e&&("top-right"===t||"bottom-right"===t),[T.iconDockToLeft]:!e&&("top-left"===t||"bottom-left"===t),[T.iconDockToTop]:!e&&"top-center"===t,[T.iconDockToBottom]:!e&&"bottom-center"===t};return request.n$1("span",{"aria-hidden":"true",class:this.classes(i,T.icon)})}renderDockButton(){var e,t,i;const{dockEnabled:o,messages:n}=this,s=null==(e=this.viewModel)||null==(t=e.view)?void 0:t.widthBreakpoint,r=o?n.undock:n.dock;return "xsmall"!==s&&null!=(i=this.dockOptions)&&i.buttonEnabled?request.n$1("div",{role:"button","aria-label":r,title:r,tabIndex:0,bind:this,onclick:this._toggleDockEnabled,onkeydown:this._toggleDockEnabled,afterCreate:this._focusDockButtonNode,afterUpdate:this._focusDockButtonNode,class:this.classes(T.button,T.buttonDock)},this.renderDockIcon()):null}renderTitle(){const{title:e}=this.viewModel,{titleId:t,collapsible:i,contentCollapsed:o,messagesCommon:n}=this,s={[T.headerContainerButton]:i},r=request.n$1(Heading.s,{level:this.headingLevel,class:T.headerTitle,innerHTML:e}),a=i?request.n$1("button",{key:`${e}--collapsible`,id:t,title:o?n.expand:n.collapse,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(T.headerContainer,s),"aria-expanded":o?"false":"true",onclick:this._toggleCollapsed},r):request.n$1("div",{key:e,id:t,bind:this,enterAnimation:this._createFeatureUpdatedAnimation(),class:this.classes(T.headerContainer,s)},r);return e?a:null}renderCloseIcon(){return request.n$1("span",{"aria-hidden":"true",class:this.classes(T.icon,T.iconClose)})}renderCloseButton(){const{visibleElements:e,messagesCommon:t}=this;return e.closeButton?request.n$1("div",{role:"button",tabIndex:0,bind:this,onclick:this._close,onkeydown:this._close,class:T.button,"aria-label":t.close,title:t.close,afterCreate:this._closeButtonNodeUpdated,afterUpdate:this._closeButtonNodeUpdated},this.renderCloseIcon()):null}renderHeader(){return request.n$1("header",{class:T.header},this.renderTitle(),request.n$1("div",{class:T.headerButtons},this.renderDockButton(),this.renderCloseButton()))}renderContentContainer(){const{contentId:e,hasContent:t,contentCollapsed:i}=this,{content:o}=this.viewModel;return t&&!i?request.n$1("article",{key:o,enterAnimation:this._createFeatureUpdatedAnimation(),id:e,class:T.content},this.renderContent()):null}renderActionsMenuButton(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:o,messagesCommon:n}=this,s=i?n.close:n.open,{menuActions:r}=o;return r.length?request.n$1("div",{key:P("actions-menu-button"),class:this.classes(T.button,T.actionsMenuButton),role:"button",id:t,"aria-haspopup":"true","aria-controls":i?e:null,tabIndex:0,bind:this,onclick:this._toggleActionsMenu,onkeydown:this._toggleActionsMenu,afterCreate:this._focusActionsMenuButtonNode,afterUpdate:this._focusActionsMenuButtonNode,"aria-label":s,title:s},request.n$1("span",{"aria-hidden":"true",class:T.iconActionsMenu})):null}renderMenuActions(){const{actionsMenuId:e,actionsMenuButtonId:t,actionsMenuOpen:i,dividedActions:o}=this,{menuActions:n,inlineActions:s}=o;return n.length&&i?request.n$1("ul",{id:e,role:"menu","aria-labelledby":t,key:P("actions"),class:T.actions,bind:this,onkeyup:this._handleActionMenuKeyup,afterCreate:this._actionsMenuNodeUpdated,afterUpdate:this._actionsMenuNodeUpdated},n.toArray().map(((e,t)=>this.renderAction({action:e,index:t+s.length,type:"menu-item"})))):null}renderInlineActions(){const{inlineActions:e}=this.dividedActions;return !!e.length&&e.toArray().map(((e,t)=>this.renderAction({action:e,index:t,type:"inline"})))}renderInlineActionsContainer(){const{inlineActions:e,menuActions:t}=this.dividedActions,i=!!e.length,o=!!t.length;return i||o?request.n$1("div",{key:"inline-actions-container","data-inline-actions":i.toString(),"data-menu-actions":o.toString(),class:T.inlineActionsContainer},this.renderInlineActions(),this.renderActionsMenuButton(),this.renderMenuActions()):null}renderNavigation(){return this.featureNavigationVisible?request.n$1("section",{key:P("navigation"),class:this.classes(T.navigation)},this.renderNavigationButtons()):null}renderFooter(){const{featureNavigationVisible:e,dividedActions:t}=this,{inlineActions:i,menuActions:o}=t,n=!!i.length,s=!!o.length,r={[T.footerHasPagination]:e,[T.footerHasActions]:n,[T.footerHasActionsMenu]:s};return e||n?request.n$1("div",{key:P("feature-buttons"),class:this.classes(T.footer,r)},this.renderInlineActionsContainer(),this.renderNavigation()):null}renderFeatureMenuContainer(){const{messages:e}=this,{featureViewModels:t,isLoadingFeature:i}=this.viewModel,o=request.s$2(e.selectedFeatures,{total:t.length});return request.n$1("section",{key:P("menu"),class:T.featureMenu},request.n$1("strong",{class:T.featureMenuHeader},o),request.n$1("nav",{bind:this,class:T.featureMenuViewport,"data-node-ref":"_featureMenuViewportNode",afterCreate:request.g$2},this.renderFeatureMenu(),request.n$1("div",{class:T.featureMenuObserver,bind:this,afterCreate:this._featureMenuIntersectionObserverCreated}),i?request.n$1("div",{class:T.featureMenuLoader},this.renderLoadingIcon()):null))}renderPointer(){return this.dockEnabled?null:request.n$1("div",{key:P("pointer"),class:T.pointer,role:"presentation"},request.n$1("div",{class:this.classes(T.pointerDirection,T.shadow)}))}renderMainContainer(){const{dockEnabled:e,currentAlignment:t,currentDockPosition:i,titleId:o,contentId:n,collapsible:s,hasContent:r,contentCollapsed:a,visibleElements:l}=this,{title:u}=this.viewModel,c="bottom-left"===t||"bottom-center"===t||"bottom-right"===t||"top-left"===i||"top-center"===i||"top-right"===i,d="top-left"===t||"top-center"===t||"top-right"===t||"bottom-left"===i||"bottom-center"===i||"bottom-right"===i,p={[T.shadow]:e,[T.isCollapsible]:s,[T.isCollapsed]:a};return request.n$1("div",{class:this.classes(T.main,T.widget,p),tabIndex:l.closeButton?null:-1,role:"dialog","aria-labelledby":u?o:"","aria-describedby":r&&!a?n:"",bind:this,onkeyup:this._handleMainKeyup,afterCreate:this._mainContainerNodeUpdated,afterUpdate:this._mainContainerNodeUpdated},c?this.renderFooter():null,c?this.renderFeatureMenuContainer():null,this.renderHeader(),this.renderContentContainer(),d?this.renderFooter():null,d?this.renderFeatureMenuContainer():null)}renderContent(){var e;const t=null==(e=this.viewModel)?void 0:e.content;return t?"string"==typeof t?request.n$1("div",{key:t,innerHTML:t}):this.renderNodeContent(t):null}renderActionText(e){return request.n$1("span",{key:"text",class:T.actionText},e)}renderActionIcon(e){const t=this._getActionClass(e),i=this._getActionImage(e),o={[T.iconLoading]:e.active,[T.rotating]:e.active,[T.icon]:!!t,[T.actionImage]:!e.active&&!!i};return t&&(o[t]=!e.active),request.n$1("span",{key:"icon","aria-hidden":"true",class:this.classes(T.icon,o),styles:this._getIconStyles(i)})}renderAction(e){const{action:t,index:i,type:o}=e,n=this._getActionTitle(t),s={[T.action]:"toggle"!==t.type,[T.actionToggle]:"toggle"===t.type,[T.actionToggleOn]:"toggle"===t.type&&t.value,[T.buttonDisabled]:t.disabled},r=[this.renderActionIcon(t),this.renderActionText(n)],a="menu-item"===o?request.n$1("li",{key:t.uid,role:"menuitem",tabIndex:0,title:n,"aria-label":n,class:this.classes(T.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},r):request.n$1("div",{key:t.uid,role:"button",tabIndex:0,title:n,"aria-label":n,class:this.classes(T.button,s),onkeyup:this._handleActionMenuItemKeyup,bind:this,"data-action-index":i,onclick:this._triggerAction,onkeydown:this._triggerAction},r);return t.visible?a:null}renderFeatureMenuItem(e,t){const{messages:i,messagesCommon:o}=this,{selectedFeatureIndex:n,selectedFeatureViewModel:s}=this.viewModel,r=e===s,a={[T.featureMenuSelected]:r},l=r?request.n$1("span",{key:P(`feature-menu-selected-feature-${n}`),title:i.selectedFeature,"aria-label":i.selectedFeature,class:T.iconCheckMark}):null,u=request.n$1("span",{innerHTML:e.title||o.untitled});return request.n$1("li",{role:"menuitem",tabIndex:-1,key:P(`feature-menu-feature-${n}`),class:this.classes(a,T.featureMenuItem),bind:this,"data-feature-index":t,onkeyup:this._handleFeatureMenuItemKeyup,onclick:this._selectFeature,onkeydown:this._selectFeature},request.n$1("span",{class:T.featureMenuTitle},u,l))}renderFeatureMenu(){const{featureMenuId:e}=this,{featureViewModels:t}=this.viewModel;return t.length>1?request.n$1("ol",{class:T.featureMenuList,id:e,bind:this,afterCreate:this._featureMenuNodeUpdated,afterUpdate:this._featureMenuNodeUpdated,onkeyup:this._handleFeatureMenuKeyup,role:"menu"},t.filter((e=>!!e.graphic)).map(((e,t)=>this.renderFeatureMenuItem(e,t)))):null}_getActionTitle(e){const{messages:t,selectedFeature:i,messagesCommon:o}=this,{id:n}=e,s=null==i?void 0:i.attributes,r="zoom-to-feature"===n?request.s$2(e.title,{messages:t}):"remove-selected-feature"===n?request.s$2(e.title,{messages:o}):"zoom-to-clustered-features"===n||"browse-clustered-features"===n?request.s$2(e.title,{messages:t}):e.title;return r&&s?request.s$2(r,s):r}_getActionClass(e){const{selectedFeature:t}=this,i=null==t?void 0:t.attributes,{className:o,image:n}=e,s=n||o?o:T.iconDefaultAction;return s&&i?request.s$2(s,i):s}_getActionImage(e){const{selectedFeature:t}=this,i=null==t?void 0:t.attributes,{image:o}=e;return o&&i?request.s$2(o,i):o}_createFeatureUpdatedAnimation(){return request.f$2("enter",T.hasFeatureUpdated)}_getInlineActionCount(){const{maxInlineActions:e,featureNavigationVisible:t}=this;if("number"!=typeof e)return null;const i=Math.round(e);return Math.max(t?i-1:i,0)}_watchActions(){const{allActions:e}=this.viewModel;this.notifyChange("dividedActions");const t="actions";this._handles.remove(t),e&&e.forEach((e=>{this._handles.add(request.f(e,["active","className","disabled","id","title","image","visible"],(()=>this.scheduleRender())),t);}));}_divideActions(){const{allActions:e}=this.viewModel,i=this._getInlineActionCount(),o=null===i,n=0===i;return {inlineActions:o?e.slice(0):n?new request.S:e.slice(0,i),menuActions:o?new request.S:n?e.slice(0):e.slice(i)}}_featureMenuOpenChanged(e){e?this._focusFirstFeature=!0:this._focusFeatureMenuButton=!0;}_actionsMenuOpenChanged(e){e?this._focusFirstAction=!0:this._focusActionsMenuButton=!0;}_setTitleFromFeatureWidget(){const{selectedFeatureWidget:e,messagesCommon:t}=this;var i,o;e&&(this.viewModel.title="error"===(null==(i=e.viewModel)?void 0:i.state)?t.errorMessage:(null==(o=e.viewModel)?void 0:o.title)||"");}_setContentFromFeatureWidget(){const{selectedFeatureWidget:e}=this;e&&(this.viewModel.content=e);}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode);}_featureMenuIntersectionObserverCreated(e){this._unobserveFeatureMenuObserver(),this._featureMenuIntersectionObserver.observe(e),this._featureMenuIntersectionObserverNode=e;}_handleFeatureMenuKeyup(e){"Escape"===request.i$2(e)&&(e.stopPropagation(),this._focusFeatureMenuButton=!0,this.featureMenuOpen=!1,this.scheduleRender());}_handleActionMenuKeyup(e){"Escape"===request.i$2(e)&&(e.stopPropagation(),this._focusActionsMenuButton=!0,this.actionsMenuOpen=!1,this.scheduleRender());}_handleFeatureMenuItemKeyup(e){const t=request.i$2(e),{_featureMenuNode:o}=this,n=e.currentTarget["data-feature-index"];if(!o)return;const s=o.querySelectorAll("li"),r=s.length;if("ArrowUp"!==t)if("ArrowDown"!==t)if("Home"!==t)if("End"!==t);else {e.stopPropagation();s[s.length-1].focus();}else {e.stopPropagation();s[0].focus();}else {e.stopPropagation();s[(n+1+r)%r].focus();}else {e.stopPropagation();s[(n-1+r)%r].focus();}}_handleActionMenuItemKeyup(e){const t=request.i$2(e),{_actionsMenuNode:o}=this,n=e.currentTarget["data-action-index"];if(!o)return;const s=o.querySelectorAll("li"),r=s.length;if("ArrowUp"!==t)if("ArrowDown"!==t)if("Home"!==t)if("End"!==t);else {e.stopPropagation();s[s.length-1].focus();}else {e.stopPropagation();s[0].focus();}else {e.stopPropagation();s[(n+1+r)%r].focus();}else {e.stopPropagation();s[(n-1+r)%r].focus();}}_handleMainKeyup(e){const t=request.i$2(e);"ArrowLeft"===t&&(e.stopPropagation(),this.previous()),"ArrowRight"===t&&(e.stopPropagation(),this.next());}_spinnerEnabledChange(e){if(this._destroySpinner(),!e)return;const t=this.get("viewModel.view");this._createSpinner(t);}_hideSpinner(){const{_spinner:e}=this;e&&(e.location=null,e.hide());}_displaySpinner(){const{_spinner:e}=this;if(!e)return;const{location:t,waitingForResult:i}=this.viewModel;i?e.show({location:t}):e.hide();}_getIconStyles(e){return {"background-image":e?`url(${e})`:""}}_addSelectedFeatureIndexHandle(){const e=request.f(this,"viewModel.selectedFeatureIndex",((e,t)=>this._selectedFeatureIndexUpdated(e,t)));this._handles.add(e,O);}_selectedFeatureIndexUpdated(e,t){const{featureCount:i}=this;i&&e!==t&&-1!==e&&(this.actionsMenuOpen=!1,this.featureMenuOpen=!1);}_destroySelectedFeatureWidget(){const{_feature:e}=this;e&&(e.viewModel=null,e&&!e.destroyed&&e.destroy()),this._feature=null;}_isScreenLocationWithinView(e,t){return e.x>-1&&e.y>-1&&e.x<=t.width&&e.y<=t.height}_isOutsideView(e){const{popupHeight:t,popupWidth:i,screenLocation:o,side:n,view:s}=e;if(isNaN(i)||isNaN(t)||!s||!o)return !1;const r=s.padding;return "right"===n&&o.x+i/2>s.width-r.right||("left"===n&&o.x-i/2<r.left||("top"===n&&o.y-t<r.top||"bottom"===n&&o.y+t>s.height-r.bottom))}_calculateAutoAlignment(e){if("auto"!==e)return e;const{_pointerOffsetInPx:t,_containerNode:i,_mainContainerNode:o,viewModel:n}=this,{screenLocation:r,view:a}=n;if(request.t$1(r)||!a||!i)return "top-center";if(!this._isScreenLocationWithinView(r,a))return this._get("currentAlignment")||"top-center";function l(e){return parseInt(e.replace(/[^-\d\.]/g,""),10)}const u=o?window.getComputedStyle(o,null):null,c=u?l(u.getPropertyValue("max-height")):0,d=u?l(u.getPropertyValue("height")):0,{height:p,width:h}=i.getBoundingClientRect(),g=h+t,_=Math.max(p,c,d)+t,f=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"right",view:a}),v=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"left",view:a}),m=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"top",view:a}),b=this._isOutsideView({popupHeight:_,popupWidth:g,screenLocation:r,side:"bottom",view:a});return v?m?"bottom-right":"top-right":f?m?"bottom-left":"top-left":m?b?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(e){return "function"==typeof e?e.call(this):e}_getCurrentAlignment(){const{alignment:e,dockEnabled:t}=this;return t||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(e)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment());}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition());}_calculatePositionResult(e){const t=["left","right"];return request.d$3(this.container)&&t.reverse(),e.replace(/leading/gi,t[0]).replace(/trailing/gi,t[1])}_callDockPosition(e){return "function"==typeof e?e.call(this):e}_getDockPosition(){var e;return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(null==(e=this.dockOptions)?void 0:e.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_wouldDockTo(){return this.dockEnabled?null:this._getDockPosition()}_calculateAutoDockPosition(e){var t;if("auto"!==e)return e;const i=null==(t=this.viewModel)?void 0:t.view,o=request.d$3(this.container)?"top-left":"top-right";if(!i)return o;const n=i.padding||{left:0,right:0,top:0,bottom:0},s=i.width-n.left-n.right,{breakpoints:r}=i;return r&&s<=r.xsmall?"bottom-center":o}_positionContainer(e=this._containerNode){if(e&&(this._containerNode=e),!e)return;const{screenLocation:t}=this.viewModel,{width:i}=e.getBoundingClientRect(),o=this._calculatePositionStyle(t,i);o&&(e.style.top=o.top,e.style.left=o.left,e.style.bottom=o.bottom,e.style.right=o.right);}_calculateFullWidth(e){const{currentAlignment:t,_pointerOffsetInPx:i}=this;return "top-left"===t||"bottom-left"===t||"top-right"===t||"bottom-right"===t?e+i:e}_calculateAlignmentPosition(e,t,i,o){const{currentAlignment:n,_pointerOffsetInPx:s}=this,r=o/2,a=i.height-t,l=i.width-e,{padding:u}=this.view;return "bottom-center"===n?{top:t+s-u.top,left:e-r-u.left}:"top-left"===n?{bottom:a+s-u.bottom,right:l+s-u.right}:"bottom-left"===n?{top:t+s-u.top,right:l+s-u.right}:"top-right"===n?{bottom:a+s-u.bottom,left:e+s-u.left}:"bottom-right"===n?{top:t+s-u.top,left:e+s-u.left}:"top-center"===n?{bottom:a+s-u.bottom,left:e-r-u.left}:void 0}_calculatePositionStyle(e,t){const{dockEnabled:i,view:o}=this;if(!o)return;if(i)return {left:"",top:"",right:"",bottom:""};if(request.t$1(e)||!t)return;const n=this._calculateFullWidth(t),r=this._calculateAlignmentPosition(e.x,e.y,o,n);return r?{top:void 0!==r.top?`${r.top}px`:"auto",left:void 0!==r.left?`${r.left}px`:"auto",bottom:void 0!==r.bottom?`${r.bottom}px`:"auto",right:void 0!==r.right?`${r.right}px`:"auto"}:void 0}_viewChange(e,t){e&&t&&(this.close(),this.clear());}_viewReadyChange(e,t){if(e){const e=this.get("viewModel.view");this._wireUpView(e);}else t&&(this.close(),this.clear());}_wireUpView(e){if(this._destroySpinner(),!e)return;const{spinnerEnabled:t}=this;t&&this._createSpinner(e),this._setDockEnabledForViewSize(this.dockOptions);}_dockingThresholdCrossed(e,t,i){const[o,n]=e,[s,r]=t,{width:a,height:l}=i;return o<=a&&s>a||o>a&&s<=a||n<=l&&r>l||n>l&&r<=l}_updateDockEnabledForViewSize(e,t){if(!e||!t)return;const i=this.get("viewModel.view.padding")||{left:0,right:0,top:0,bottom:0},o=i.left+i.right,n=i.top+i.bottom,s=[],r=[];s[0]=e[0]-o,s[1]=e[1]-n,r[0]=t[0]-o,r[1]=t[1]-n;const{dockOptions:a}=this,l=a.breakpoint;this._dockingThresholdCrossed(s,r,l)&&this._setDockEnabledForViewSize(a),this._setCurrentDockPosition();}_focusDockButtonNode(e){this._focusDockButton&&(this._focusDockButton=!1,e.focus());}_closeButtonNodeUpdated(e){return this._focusClose?(this._focusClose=!1,void e.focus()):this._blurClose?(this._blurClose=!1,void e.blur()):void 0}_mainContainerNodeUpdated(e){return this._mainContainerNode=e,this._focusContainer?(this._focusContainer=!1,void e.focus()):this._blurContainer?(this._blurContainer=!1,void e.blur()):void 0}_featureMenuNodeUpdated(e){if(this._featureMenuNode=e,!e||!this._focusFirstFeature)return;this._focusFirstFeature=!1;const t=e.querySelectorAll("li");if(t.length){t[0].focus();}}_actionsMenuNodeUpdated(e){if(this._actionsMenuNode=e,!e||!this._focusFirstAction)return;this._focusFirstAction=!1;const t=e.querySelectorAll("li");if(t.length){t[0].focus();}}_focusFeatureMenuButtonNode(e){this._focusFeatureMenuButton&&(this._focusFeatureMenuButton=!1,e.focus());}_focusActionsMenuButtonNode(e){this._focusActionsMenuButton&&(this._focusActionsMenuButton=!1,e.focus());}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&(this._featureMenuViewportNode.scrollTop=0);}_toggleScreenLocationEnabled(){const{dockEnabled:e,viewModel:t}=this;if(!t)return;const i=t.active&&!e;t.screenLocationEnabled=i;}_shouldDockAtCurrentViewSize(e){var t,i;const o=e.breakpoint,n=null==(t=this.viewModel)||null==(i=t.view)?void 0:i.ui;if(!n)return !1;const{width:s,height:r}=n;if(isNaN(s)||isNaN(r))return !1;const a=o.hasOwnProperty("width")&&s<=o.width,l=o.hasOwnProperty("height")&&r<=o.height;return a||l}_setDockEnabledForViewSize(e){e.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(e));}_getPageText(e,t){return this.featureNavigationVisible?request.s$2(this.messages.pageText,{index:t+1,total:e}):null}_destroySpinner(){const{_spinner:e,view:t}=this;e&&(t&&t.ui&&t.ui.remove(this._spinner,B),e.destroy(),this._spinner=null);}_createSpinner(e){e&&(this._spinner=new m$1({view:e}),e.ui.add(this._spinner,{key:B,position:"manual"}));}_toggleCollapsed(){this.collapsed=!this.collapsed;}_close(){this.close(),this.view&&this.view.focus();}_toggleDockEnabled(){this.dockEnabled=!this.dockEnabled,this._focusDockButton=!0,this.scheduleRender();}_toggleFeatureMenu(){const e=!this.featureMenuOpen;this._featureMenuOpenChanged(e),this.actionsMenuOpen=!1,this.featureMenuOpen=e;}_toggleActionsMenu(){const e=!this.actionsMenuOpen;this._actionsMenuOpenChanged(e),this.featureMenuOpen=!1,this.actionsMenuOpen=e;}_triggerAction(e){const t=e.currentTarget["data-action-index"],i=this.viewModel.allActions.getItemAt(t);i&&"toggle"===i.type&&(i.value=!i.value),this.actionsMenuOpen=!1,this.viewModel.triggerAction(t);}_selectFeature(e){const t=e.currentTarget["data-feature-index"];isNaN(t)||(this.viewModel.selectedFeatureIndex=t),this.featureMenuOpen=!1,this._focusFeatureMenuButton=!0,this.scheduleRender();}_next(){this.next();}_previous(){this.previous();}};request.e([request.d({readOnly:!0})],R.prototype,"actionsMenuId",null),request.e([request.d({readOnly:!0})],R.prototype,"actionsMenuButtonId",null),request.e([request.d({readOnly:!0})],R.prototype,"featureMenuId",null),request.e([request.d({readOnly:!0})],R.prototype,"titleId",null),request.e([request.d({readOnly:!0})],R.prototype,"contentId",null),request.e([request.d({readOnly:!0})],R.prototype,"hasContent",null),request.e([request.d({readOnly:!0})],R.prototype,"featureNavigationVisible",null),request.e([request.d({readOnly:!0})],R.prototype,"collapsible",null),request.e([request.d({readOnly:!0})],R.prototype,"featureMenuVisible",null),request.e([request.d({readOnly:!0})],R.prototype,"contentCollapsed",null),request.e([request.d({readOnly:!0})],R.prototype,"dividedActions",null),request.e([request.o("viewModel.actions")],R.prototype,"actions",void 0),request.e([request.d()],R.prototype,"actionsMenuOpen",null),request.e([request.d()],R.prototype,"alignment",void 0),request.e([request.o("viewModel.autoCloseEnabled")],R.prototype,"autoCloseEnabled",void 0),request.e([request.o("viewModel.autoOpenEnabled")],R.prototype,"autoOpenEnabled",void 0),request.e([request.o("viewModel.defaultPopupTemplateEnabled")],R.prototype,"defaultPopupTemplateEnabled",void 0),request.e([request.o("viewModel.content")],R.prototype,"content",void 0),request.e([request.d()],R.prototype,"collapsed",void 0),request.e([request.d()],R.prototype,"collapseEnabled",void 0),request.e([request.d({readOnly:!0})],R.prototype,"currentAlignment",null),request.e([request.d({readOnly:!0})],R.prototype,"currentDockPosition",null),request.e([request.d()],R.prototype,"dockOptions",null),request.e([request.d()],R.prototype,"dockEnabled",void 0),request.e([request.o("viewModel.featureCount")],R.prototype,"featureCount",void 0),request.e([request.d()],R.prototype,"featureMenuOpen",void 0),request.e([request.o("viewModel.features")],R.prototype,"features",void 0),request.e([request.o("viewModel.goToOverride")],R.prototype,"goToOverride",void 0),request.e([request.d()],R.prototype,"headingLevel",void 0),request.e([request.o("viewModel.highlightEnabled")],R.prototype,"highlightEnabled",void 0),request.e([request.o("viewModel.location")],R.prototype,"location",void 0),request.e([request.d({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],R.prototype,"label",void 0),request.e([request.d()],R.prototype,"maxInlineActions",void 0),request.e([request.d(),request.e$1("esri/widgets/Popup/t9n/Popup")],R.prototype,"messages",void 0),request.e([request.d(),request.e$1("esri/t9n/common")],R.prototype,"messagesCommon",void 0),request.e([request.o("viewModel.promises")],R.prototype,"promises",void 0),request.e([request.o("viewModel.selectedFeature")],R.prototype,"selectedFeature",void 0),request.e([request.o("viewModel.selectedFeatureIndex")],R.prototype,"selectedFeatureIndex",void 0),request.e([request.d({readOnly:!0})],R.prototype,"selectedFeatureWidget",null),request.e([request.d()],R.prototype,"spinnerEnabled",void 0),request.e([request.o("viewModel.title")],R.prototype,"title",void 0),request.e([request.o("viewModel.updateLocationEnabled")],R.prototype,"updateLocationEnabled",void 0),request.e([request.o("viewModel.view")],R.prototype,"view",void 0),request.e([request.d({type:U$1}),vmEvent.t(["triggerAction","trigger-action"])],R.prototype,"viewModel",void 0),request.e([request.o("viewModel.visible")],R.prototype,"visible",void 0),request.e([request.d()],R.prototype,"visibleElements",void 0),request.e([request.c("visibleElements")],R.prototype,"castVisibleElements",null),request.e([accessibleHandler.t()],R.prototype,"_close",null),request.e([accessibleHandler.t()],R.prototype,"_toggleDockEnabled",null),request.e([accessibleHandler.t()],R.prototype,"_toggleFeatureMenu",null),request.e([accessibleHandler.t()],R.prototype,"_toggleActionsMenu",null),request.e([accessibleHandler.t()],R.prototype,"_triggerAction",null),request.e([accessibleHandler.t()],R.prototype,"_selectFeature",null),request.e([accessibleHandler.t()],R.prototype,"_next",null),request.e([accessibleHandler.t()],R.prototype,"_previous",null),R=request.e([request.i(L)],R);const U=R;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const u=[0,0];function l(e){const t=(e.ownerDocument||window.document).defaultView,s=e.getBoundingClientRect();return u[0]=s.left+t.pageXOffset,u[1]=s.top+t.pageYOffset,u}function p(e){e&&(request.t$7(e),e.parentNode&&e.parentNode.removeChild(e));}function c$1(e){const t=document.createElement("div");return e.appendChild(t),t}const m=16,f=750,y=512,v=2,_=i=>{let u=class extends i{constructor(...e){super(...e),this._freqInfo={freq:m,time:f},this._overlayRenderTaskHandle=null,this.height=0,this.position=null,this.resizing=!1,this.root=null,this.surface=null,this.suspended=!0,this.ui=null,this.userContent=null,this.width=0,this.widthBreakpoint=null,this.handles.add([this.watch("cursor",(e=>{const t=this.surface;t&&t.setAttribute("data-cursor",e);})),this.watch("interacting",(e=>{const t=this.surface;t&&t.setAttribute("data-interacting",e.toString());}))]);}initialize(){this.handles.add(this.watch("ui",((e,t)=>this._handleUIChange(e,t)))),this._wireUI(this.ui),this.handles.add([this.on("focus",(()=>this.notifyChange("focused"))),this.on("blur",(()=>this.notifyChange("focused")))]);}destroy(){this.destroyed||(this.ui&&(this.ui.destroy(),this.ui=null),this.popup&&!this.popup.destroyed&&this.popup.destroy(),this.container=null);}set container(e){const s=this._get("container");if(s===e)return;const i="dom-size";if(this.handles.remove(i),this._stopMeasuring(),s&&(s.classList.remove("esri-view"),this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null),this.overlay.destroy(),this._set("overlay",null),p(this.root),this._set("root",null),request.r$9(this.userContent,s),p(this.userContent),this._set("userContent",null)),e){e.classList.add("esri-view");const s=document.createElement("div");s.className="esri-view-user-storage",request.r$9(e,s),e.appendChild(s),this._set("userContent",s);const n=document.createElement("div");n.className="esri-view-root",e.insertBefore(n,e.firstChild),this._set("root",n);const h=document.createElement("div");h.className="esri-view-surface",h.setAttribute("role","application"),h.tabIndex=0,n.appendChild(h),this._set("surface",h);const d=new n$8;n.appendChild(d.surface),this._set("overlay",d),d.watch("needsRender",(e=>{e&&!this._overlayRenderTaskHandle?this._overlayRenderTaskHandle=request.A({render:()=>{this.overlay.render();}}):this._overlayRenderTaskHandle&&(this._overlayRenderTaskHandle.remove(),this._overlayRenderTaskHandle=null);})),this.forceDOMReadyCycle(),this.handles.add(request.i$1(this,"size",(e=>{const[t,s]=e,i="esri-view-surface--inset-outline";t>=document.body.clientWidth||s>=document.body.clientHeight?h.classList.add(i):h.classList.remove(i);})),i),this._set("container",e),this._startMeasuring();}else this._set("width",0),this._set("height",0),this._set("position",null),this._set("suspended",!0),this._set("surface",null),this._set("container",null);}get focused(){const e=document.activeElement===this.surface;return document.hasFocus()&&e}get popup(){return this._get("popup")||new U({view:this})}set popup(e){const t=this._get("popup");t&&t!==e&&t.destroy(),this._set("popup",e);}get size(){return [this.width,this.height]}blur(){this.surface&&this.surface.blur();}focus(){this.surface&&this.surface.focus();}pageToContainer(e,t,s){const i=this.position;return e-=i[0],t-=i[1],s?(s[0]=e,s[1]=t):s=[e,t],s}containerToPage(e,t,s){const i=this.position;return e+=i[0],t+=i[1],s?(s[0]=e,s[1]=t):s=[e,t],s}_handleUIChange(e,t){t&&(this.handles.remove("ui"),t.destroy()),e&&this._wireUI(e),this._set("ui",e);}_wireUI(e){this.handles.remove("ui"),e&&(e.view=this,this.handles.add([request.i$1(this,"root",(t=>{e.container=t?c$1(t):null;})),request.i$1(this,"popup",((t,s)=>{const i="popup",o="manual";s&&e.remove(s,i),t&&(t.view=e.view,e.add(t,{key:i,position:o}));}))],"ui"));}_stopMeasuring(){this.handles.remove("measuring"),this._get("resizing")&&this._set("resizing",!1);}_startMeasuring(){const e=this._freqInfo;e.freq=m,e.time=f,this.handles.add([(()=>{const t=()=>{e.freq=m,e.time=f;};return window.addEventListener("resize",t),{remove(){window.removeEventListener("resize",t);}}})(),request.A({prepare:e=>{const t=this._measure(),s=this._freqInfo;if(s.time+=e.deltaTime,t&&(s.freq=m,this._get("resizing")||this._set("resizing",!0)),s.time<s.freq)return;s.time=0;const i=this._position();s.freq=i||t?m:Math.min(f,s.freq*v),!t&&s.freq>=y&&this._get("resizing")&&this._set("resizing",!1);}})],"measuring"),this._measure(),this._position();}_measure(){const e=this.container,t=e?e.clientWidth:0,s=e?e.clientHeight:0;if(0===t||0===s)return this.suspended||this._set("suspended",!0),!1;const i=this.width,o=this.height;return t===i&&s===o?(this.suspended&&this._set("suspended",!1),!1):(this._set("width",t),this._set("height",s),this.suspended&&this._set("suspended",!1),this.emit("resize",{oldWidth:i,oldHeight:o,width:t,height:s}),!0)}_position(){const e=this.container,t=this.position,s=l(e);return (!t||s[0]!==t[0]||s[1]!==t[1])&&(this._set("position",[s[0],s[1]]),!0)}forceDOMReadyCycle(){}};return request.e([request.d({value:null,cast:e=>request.e$4(e)})],u.prototype,"container",null),request.e([request.d({readOnly:!0})],u.prototype,"focused",null),request.e([request.d({readOnly:!0})],u.prototype,"height",void 0),request.e([request.d({type:U})],u.prototype,"popup",null),request.e([request.d({type:n$8})],u.prototype,"overlay",void 0),request.e([request.d({readOnly:!0})],u.prototype,"position",void 0),request.e([request.d({readOnly:!0})],u.prototype,"resizing",void 0),request.e([request.d({readOnly:!0})],u.prototype,"root",void 0),request.e([request.d({value:null,readOnly:!0})],u.prototype,"size",null),request.e([request.d({readOnly:!0})],u.prototype,"surface",void 0),request.e([request.d({readOnly:!0})],u.prototype,"suspended",void 0),request.e([request.d()],u.prototype,"ui",void 0),request.e([request.d({readOnly:!0})],u.prototype,"userContent",void 0),request.e([request.d({readOnly:!0})],u.prototype,"width",void 0),request.e([request.d()],u.prototype,"widthBreakpoint",void 0),u=request.e([request.i("esri.views.DOMContainer")],u),u};function g(e){return e&&"focus"in e}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function t(t){return screenUtils.c(t.x,t.y)}function n(t,n){const c=(t instanceof HTMLElement?t:t.surface).getBoundingClientRect();return screenUtils.c(n.clientX-c.left,n.clientY-c.top)}function c(e,c){return c instanceof Event?n(e,c):t(c)}function i(e){if(e instanceof Event)return !0;if("object"==typeof e&&"type"in e){switch(e.type){case"click":case"double-click":case"pointer-down":case"pointer-drag":case"pointer-enter":case"pointer-leave":case"pointer-up":case"pointer-move":case"immediate-click":case"immediate-double-click":case"hold":case"drag":case"mouse-wheel":return !0;default:return !1}}return !1}

exports.A = A$1;
exports.A$1 = A;
exports.F = F$2;
exports._ = _;
exports.a = a$2;
exports.b = b$3;
exports.c = c;
exports.c$1 = c$4;
exports.d$1 = d$5;
exports.e = e$5;
exports.f = f$8;
exports.f$1 = f$7;
exports.g = g;
exports.g$1 = g$7;
exports.h = h$5;
exports.i = i$2;
exports.i$1 = i;
exports.l = l$7;
exports.m = m$1;
exports.n = n;
exports.p = p$c;
exports.t = t;
exports.u = u$2;
exports.y = y$8;
