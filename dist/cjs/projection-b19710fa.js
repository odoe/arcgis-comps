'use strict';

const request = require('./messageBundle-8be88d04.js');
const mathUtils = require('./mathUtils-af6066f0.js');
const unitUtils = require('./unitUtils-083cb8d0.js');
const mat4 = require('./mat4-f68486bc.js');
const common = require('./common-41a349f2.js');
const geometry = require('./geometry-ef17530a.js');
const aaBoundingRect = require('./aaBoundingRect-56648c00.js');
const geodesicConstants = require('./geodesicConstants-047d586a.js');

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let o,r=null;function n(){return !!r}function _(){return !!request.s$3("esri-wasm")}function P(){return o||(o=Promise.resolve().then(function () { return require('./pe-wasm-c99b2fa0.js'); }).then((e=>e.p)).then((({default:t})=>t({locateFile:t=>request.a$1(`esri/geometry/support/${t}`)}))).then((e=>{N$1(e);})),o)}var s$2;exports.E = void 0;exports.i = void 0;!function(e){function t(e,t,o){r.ensureCache.prepare();const n=A(o),_=o===n,P=r.ensureFloat64(n),s=r._pe_geog_to_proj(r.getPointer(e),t,P);return s&&d(o,t,P,_),s}function o(e,o,r,_){switch(_){case exports.E.PE_TRANSFORM_P_TO_G:return n(e,o,r);case exports.E.PE_TRANSFORM_G_TO_P:return t(e,o,r)}return 0}function n(e,t,o){return _(e,t,o,0)}function _(e,t,o,n){r.ensureCache.prepare();const _=A(o),P=o===_,s=r.ensureFloat64(_),E=r._pe_proj_to_geog_center(r.getPointer(e),t,s,n);return E&&d(o,t,s,P),E}e.geogToProj=t,e.projGeog=o,e.projToGeog=n,e.projToGeogCenter=_;}(s$2||(s$2={})),function(e){function t(){e.PE_BUFFER_MAX=r.PeDefs.prototype.PE_BUFFER_MAX,e.PE_NAME_MAX=r.PeDefs.prototype.PE_NAME_MAX,e.PE_MGRS_MAX=r.PeDefs.prototype.PE_MGRS_MAX,e.PE_USNG_MAX=r.PeDefs.prototype.PE_USNG_MAX,e.PE_DD_MAX=r.PeDefs.prototype.PE_DD_MAX,e.PE_DDM_MAX=r.PeDefs.prototype.PE_DDM_MAX,e.PE_DMS_MAX=r.PeDefs.prototype.PE_DMS_MAX,e.PE_UTM_MAX=r.PeDefs.prototype.PE_UTM_MAX,e.PE_PARM_MAX=r.PeDefs.prototype.PE_PARM_MAX,e.PE_TYPE_NONE=r.PeDefs.prototype.PE_TYPE_NONE,e.PE_TYPE_GEOGCS=r.PeDefs.prototype.PE_TYPE_GEOGCS,e.PE_TYPE_PROJCS=r.PeDefs.prototype.PE_TYPE_PROJCS,e.PE_TYPE_GEOGTRAN=r.PeDefs.prototype.PE_TYPE_GEOGTRAN,e.PE_TYPE_COORDSYS=r.PeDefs.prototype.PE_TYPE_COORDSYS,e.PE_TYPE_UNIT=r.PeDefs.prototype.PE_TYPE_UNIT,e.PE_TYPE_LINUNIT=r.PeDefs.prototype.PE_TYPE_LINUNIT,e.PE_STR_OPTS_NONE=r.PeDefs.prototype.PE_STR_OPTS_NONE,e.PE_STR_AUTH_NONE=r.PeDefs.prototype.PE_STR_AUTH_NONE,e.PE_STR_AUTH_TOP=r.PeDefs.prototype.PE_STR_AUTH_TOP,e.PE_STR_NAME_CANON=r.PeDefs.prototype.PE_STR_NAME_CANON,e.PE_PARM_X0=r.PeDefs.prototype.PE_PARM_X0,e.PE_PARM_ND=r.PeDefs.prototype.PE_PARM_ND,e.PE_TRANSFORM_1_TO_2=r.PeDefs.prototype.PE_TRANSFORM_1_TO_2,e.PE_TRANSFORM_2_TO_1=r.PeDefs.prototype.PE_TRANSFORM_2_TO_1,e.PE_TRANSFORM_P_TO_G=r.PeDefs.prototype.PE_TRANSFORM_P_TO_G,e.PE_TRANSFORM_G_TO_P=r.PeDefs.prototype.PE_TRANSFORM_G_TO_P,e.PE_HORIZON_RECT=r.PeDefs.prototype.PE_HORIZON_RECT,e.PE_HORIZON_POLY=r.PeDefs.prototype.PE_HORIZON_POLY,e.PE_HORIZON_LINE=r.PeDefs.prototype.PE_HORIZON_LINE,e.PE_HORIZON_DELTA=r.PeDefs.prototype.PE_HORIZON_DELTA;}e.init=t;}(exports.E||(exports.E={})),function(e){const t={},o={},n=e=>{if(e){const t=e.getType();switch(t){case exports.E.PE_TYPE_GEOGCS:e=r.castObject(e,r.PeGeogcs);break;case exports.E.PE_TYPE_PROJCS:e=r.castObject(e,r.PeProjcs);break;case exports.E.PE_TYPE_GEOGTRAN:e=r.castObject(e,r.PeGeogtran);break;default:t&exports.E.PE_TYPE_UNIT&&(e=r.castObject(e,r.PeUnit));}}return e};function _(){r.PeFactory.prototype.initialize(null);}function P(e){return s(exports.E.PE_TYPE_COORDSYS,e)}function s(e,o){let _=null,P=t[e];if(P||(P={},t[e]=P),P.hasOwnProperty(String(o)))_=P[o];else {const t=r.PeFactory.prototype.factoryByType(e,o);r.compare(t,r.NULL)||(_=t,P[o]=_);}return _=n(_),_}function i(e,t){let _=null,P=o[e];if(P||(P={},o[e]=P),P.hasOwnProperty(t))_=P[t];else {const o=r.PeFactory.prototype.fromString(e,t);r.compare(o,r.NULL)||(_=o,P[t]=_);}return _=n(_),_}function p(e){return s(exports.E.PE_TYPE_GEOGCS,e)}function u(e){return s(exports.E.PE_TYPE_GEOGTRAN,e)}function c(e){return r.PeFactory.prototype.getCode(e)}function a(e){return s(exports.E.PE_TYPE_PROJCS,e)}function g(e){return s(exports.E.PE_TYPE_UNIT,e)}e.initialize=_,e.coordsys=P,e.factoryByType=s,e.fromString=i,e.geogcs=p,e.geogtran=u,e.getCode=c,e.projcs=a,e.unit=g;}(exports.i||(exports.i={}));let p=null;var u,c,a;exports.g = void 0;exports.T = void 0;exports.f = void 0;exports.O$1 = void 0;var S,l;function N$1(e){function t(e,t,o){e[t]=o(e[t]);}r=e,exports.E.init(),u.init(),exports.T.init(),exports.O$1.init(),S.init(),p=class extends r.PeGCSExtent{destroy(){r.destroy(this);}};const o=[r.PeDatum,r.PeGeogcs,r.PeGeogtran,r.PeObject,r.PeParameter,r.PePrimem,r.PeProjcs,r.PeSpheroid,r.PeUnit];for(const r of o)t(r.prototype,"getName",(e=>function(){return e.call(this,new Array(exports.E.PE_NAME_MAX))}));for(const P of [r.PeGeogtran,r.PeProjcs])t(P.prototype,"getParameters",(e=>function(){const t=new Array(exports.E.PE_PARM_MAX);let o=e.call(this);for(let e=0;e<t.length;e++){const n=r.getValue(o,"*");t[e]=n?r.wrapPointer(n,r.PeParameter):null,o+=Int32Array.BYTES_PER_ELEMENT;}return t}));t(r.PeHorizon.prototype,"getCoord",(e=>function(){const t=this.getSize();if(!t)return null;const o=[];return d(o,t,e.call(this)),o})),t(r.PeGTlistExtendedEntry.prototype,"getEntries",(e=>{const t=r._pe_getPeGTlistExtendedGTsSize();return function(){let o=null;const n=e.call(this);if(!r.compare(n,r.NULL)){o=[n];const e=this.getSteps();if(e>1){const _=r.getPointer(n);for(let n=1;n<e;n++)o.push(r.wrapPointer(_+t*n,r.PeGTlistExtendedGTs));}}return o}}));const n=r._pe_getPeHorizonSize(),_=e=>function(){let t=this._cache;if(t||(t=new Map,this._cache=t),t.has(e))return t.get(e);let o=null;const _=e.call(this);if(!r.compare(_,r.NULL)){o=[_];const e=_.getNump();if(e>1){const t=r.getPointer(_);for(let _=1;_<e;_++)o.push(r.wrapPointer(t+n*_,r.PeHorizon));}}return t.set(e,o),o};t(r.PeProjcs.prototype,"horizonGcsGenerate",_),t(r.PeProjcs.prototype,"horizonPcsGenerate",_),r.PeObject.prototype.toString=function(e=exports.E.PE_STR_OPTS_NONE){r.ensureCache.prepare();const t=r.getPointer(this),o=r.ensureInt8(new Array(exports.E.PE_BUFFER_MAX));return r.UTF8ToString(r._pe_object_to_string_ext(t,e,o))};}function y(e){if(!e)return;const t=r.getClass(e);if(!t)return;const o=r.getCache(t);if(!o)return;const n=r.getPointer(e);n&&delete o[n];}function M(e,t){const o=[],n=new Array(t);for(let _=0;_<e;_++)o.push(r.ensureInt8(n));return o}function A(e){let t;return Array.isArray(e[0])?(t=[],e.forEach((e=>{t.push(e[0],e[1]);}))):t=e,t}function d(e,t,o,n=!1){if(n)for(let _=0;_<2*t;_++)e[_]=r.getValue(o+_*Float64Array.BYTES_PER_ELEMENT,"double");else {const n=0===e.length;for(let _=0;_<t;_++)n&&(e[_]=new Array(2)),e[_][0]=r.getValue(o,"double"),e[_][1]=r.getValue(o+Float64Array.BYTES_PER_ELEMENT,"double"),o+=2*Float64Array.BYTES_PER_ELEMENT;}}!function(e){let t;function o(){e.PE_GTLIST_OPTS_COMMON=r.PeGTlistExtended.prototype.PE_GTLIST_OPTS_COMMON,t=r._pe_getPeGTlistExtendedEntrySize();}function n(e,o,n,_,P,s){let E=null;const i=new r.PeInteger(s);try{const p=r.PeGTlistExtended.prototype.getGTlist(e,o,n,_,P,i);if((s=i.val)&&(E=[p],s>1)){const e=r.getPointer(p);for(let o=1;o<s;o++)E.push(r.wrapPointer(e+t*o,r.PeGTlistExtendedEntry));}}finally{r.destroy(i);}return E}e.init=o,e.getGTlist=n;}(u||(u={})),function(e){function t(e){if(e&&e.length){for(const t of e)y(t),t.getEntries().forEach((e=>{y(e);const t=e.getGeogtran();y(t),t.getParameters().forEach(y),[t.getGeogcs1(),t.getGeogcs2()].forEach((e=>{y(e);const t=e.getDatum();y(t),y(t.getSpheroid()),y(e.getPrimem()),y(e.getUnit());}));}));r.PeGTlistExtendedEntry.prototype.Delete(e[0]);}}e.destroy=t;}(c||(c={})),function(e){function t(e,t,o,n,_){r.ensureCache.prepare();const P=A(o),s=o===P,E=r.ensureFloat64(P);let i=0;n&&(i=r.ensureFloat64(n));const p=r._pe_geog_to_geog(r.getPointer(e),t,E,i,_);return p&&d(o,t,E,s),p}e.geogToGeog=t;}(a||(a={})),function(e){const t=(e,t,o,n,_,P)=>{let s,i;switch(r.ensureCache.prepare(),e){case"dd":s=r._pe_geog_to_dd,i=exports.E.PE_DD_MAX;break;case"ddm":s=r._pe_geog_to_ddm,i=exports.E.PE_DDM_MAX;break;case"dms":s=r._pe_geog_to_dms,i=exports.E.PE_DMS_MAX;}let p=0;t&&(p=r.getPointer(t));const u=A(n),c=r.ensureFloat64(u),a=M(o,i),g=s(p,o,c,_,r.ensureInt32(a));if(g)for(let E=0;E<o;E++)P[E]=r.UTF8ToString(a[E]);return g},o=(e,t,o,n,_)=>{let P;switch(r.ensureCache.prepare(),e){case"dd":P=r._pe_dd_to_geog;break;case"ddm":P=r._pe_ddm_to_geog;break;case"dms":P=r._pe_dms_to_geog;}let s=0;t&&(s=r.getPointer(t));const E=n.map((e=>r.ensureString(e))),i=r.ensureInt32(E),p=r.ensureFloat64(new Array(2*o)),u=P(s,o,i,p);return u&&d(_,o,p),u};function n(e,o,r,n,_){return t("dms",e,o,r,n,_)}function _(e,t,r,n){return o("dms",e,t,r,n)}function P(e,o,r,n,_){return t("ddm",e,o,r,n,_)}function s(e,t,r,n){return o("ddm",e,t,r,n)}function i(e,o,r,n,_){return t("dd",e,o,r,n,_)}function p(e,t,r,n){return o("dd",e,t,r,n)}e.geog_to_dms=n,e.dms_to_geog=_,e.geog_to_ddm=P,e.ddm_to_geog=s,e.geog_to_dd=i,e.dd_to_geog=p;}(exports.g||(exports.g={})),function(e){function t(){e.PE_MGRS_STYLE_NEW=r.PeNotationMgrs.prototype.PE_MGRS_STYLE_NEW,e.PE_MGRS_STYLE_OLD=r.PeNotationMgrs.prototype.PE_MGRS_STYLE_OLD,e.PE_MGRS_STYLE_AUTO=r.PeNotationMgrs.prototype.PE_MGRS_STYLE_AUTO,e.PE_MGRS_180_ZONE_1_PLUS=r.PeNotationMgrs.prototype.PE_MGRS_180_ZONE_1_PLUS,e.PE_MGRS_ADD_SPACES=r.PeNotationMgrs.prototype.PE_MGRS_ADD_SPACES;}function o(e,t,o,n,_,P,s){r.ensureCache.prepare();let i=0;e&&(i=r.getPointer(e));const p=A(o),u=r.ensureFloat64(p),c=M(t,exports.E.PE_MGRS_MAX),a=r.ensureInt32(c),g=r._pe_geog_to_mgrs_extended(i,t,u,n,_,P,a);if(g)for(let E=0;E<t;E++)s[E]=r.UTF8ToString(c[E]);return g}function n(e,t,o,n,_){r.ensureCache.prepare();let P=0;e&&(P=r.getPointer(e));const s=o.map((e=>r.ensureString(e))),E=r.ensureInt32(s),i=r.ensureFloat64(new Array(2*t)),p=r._pe_mgrs_to_geog_extended(P,t,E,n,i);return p&&d(_,t,i),p}e.init=t,e.geog_to_mgrs_extended=o,e.mgrs_to_geog_extended=n;}(exports.T||(exports.T={})),function(e){function t(e,t,o,n,_,P,s){r.ensureCache.prepare();let i=0;e&&(i=r.getPointer(e));const p=A(o),u=r.ensureFloat64(p),c=M(t,exports.E.PE_MGRS_MAX),a=r.ensureInt32(c),g=r._pe_geog_to_usng(i,t,u,n,_,P,a);if(g)for(let E=0;E<t;E++)s[E]=r.UTF8ToString(c[E]);return g}function o(e,t,o,n){r.ensureCache.prepare();let _=0;e&&(_=r.getPointer(e));const P=o.map((e=>r.ensureString(e))),s=r.ensureInt32(P),E=r.ensureFloat64(new Array(2*t)),i=r._pe_usng_to_geog(_,t,s,E);return i&&d(n,t,E),i}e.geog_to_usng=t,e.usng_to_geog=o;}(exports.f||(exports.f={})),function(e){function t(){e.PE_UTM_OPTS_NONE=r.PeNotationUtm.prototype.PE_UTM_OPTS_NONE,e.PE_UTM_OPTS_ADD_SPACES=r.PeNotationUtm.prototype.PE_UTM_OPTS_ADD_SPACES,e.PE_UTM_OPTS_NS=r.PeNotationUtm.prototype.PE_UTM_OPTS_NS;}function o(e,t,o,n,_){r.ensureCache.prepare();let P=0;e&&(P=r.getPointer(e));const s=A(o),i=r.ensureFloat64(s),p=M(t,exports.E.PE_UTM_MAX),u=r.ensureInt32(p),c=r._pe_geog_to_utm(P,t,i,n,u);if(c)for(let E=0;E<t;E++)_[E]=r.UTF8ToString(p[E]);return c}function n(e,t,o,n,_){r.ensureCache.prepare();let P=0;e&&(P=r.getPointer(e));const s=o.map((e=>r.ensureString(e))),E=r.ensureInt32(s),i=r.ensureFloat64(new Array(2*t)),p=r._pe_utm_to_geog(P,t,E,n,i);return p&&d(_,t,i),p}e.init=t,e.geog_to_utm=o,e.utm_to_geog=n;}(exports.O$1||(exports.O$1={})),function(e){const t=new Map;function o(){e.PE_PCSINFO_OPTION_NONE=r.PePCSInfo.prototype.PE_PCSINFO_OPTION_NONE,e.PE_PCSINFO_OPTION_DOMAIN=r.PePCSInfo.prototype.PE_PCSINFO_OPTION_DOMAIN,e.PE_POLE_OUTSIDE_BOUNDARY=r.PePCSInfo.prototype.PE_POLE_OUTSIDE_BOUNDARY,e.PE_POLE_POINT=r.PePCSInfo.prototype.PE_POLE_POINT;}function n(o,n=e.PE_PCSINFO_OPTION_DOMAIN){let _,P;return t.has(o)&&(P=t.get(o),P[n]&&(_=P[n])),_||(_=r.PePCSInfo.prototype.generate(o,n),P||(P=[],t.set(o,P)),P[n]=_),_}e.init=o,e.generate=n;}(S||(S={})),function(e){function t(){return r.PeVersion.prototype.version_string()}e.version_string=t;}(l||(l={}));const R=Object.freeze({__proto__:null,get _pe(){return r},isLoaded:n,isSupported:_,load:P,get PeCSTransformations(){return s$2},get PeDefs(){return exports.E},get PeFactory(){return exports.i},get PeGCSExtent(){return p},get PeGTlistExtended(){return u},get PeGTlistExtendedEntry(){return c},get PeGTTransformations(){return a},get PeNotationDms(){return exports.g},get PeNotationMgrs(){return exports.T},get PeNotationUsng(){return exports.f},get PeNotationUtm(){return exports.O$1},get PePCSInfo(){return S},get PeVersion(){return l},_init:N$1});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let s$1=0;class t{constructor(t=null){this.uid=s$1++,t?(this._wkt=void 0!==t.wkt?t.wkt:null,this._wkid=void 0!==t.wkid?t.wkid:-1,this._isInverse=void 0!==t.isInverse&&!0===t.isInverse):(this._wkt=null,this._wkid=-1,this._isInverse=!1);}static fromGE(s){const i=new t;return i._wkt=s.wkt,i._wkid=s.wkid,i._isInverse=s.isInverse,i}get wkt(){return this._wkt}set wkt(t){this._wkt=t,this.uid=s$1++;}get wkid(){return this._wkid}set wkid(t){this._wkid=t,this.uid=s$1++;}get isInverse(){return this._isInverse}set isInverse(t){this._isInverse=t,this.uid=s$1++;}getInverse(){const s=new t;return s._wkt=this.wkt,s._wkid=this._wkid,s._isInverse=!this.isInverse,s}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class s{constructor(s){if(this.steps=[],this._cached_projection={},this._chain="",this._gtlistentry=null,s&&s.steps)for(const i of s.steps)i instanceof t?this.steps.push(i):this.steps.push(new t({wkid:i.wkid,wkt:i.wkt,isInverse:i.isInverse}));}static cacheKey(t,s){return [void 0!==t.wkid&&null!==t.wkid?t.wkid.toString():"-1",void 0!==t.wkt&&null!==t.wkt?t.wkt.toString():"",void 0!==s.wkid&&null!==s.wkid?s.wkid.toString():"-1",void 0!==s.wkt&&null!==s.wkt?s.wkt.toString():""].join(",")}static fromGE(i){const e=new s;let n="";for(const s of i.steps){const i=t.fromGE(s);e.steps.push(i),n+=i.uid.toString()+",";}return e._cached_projection={},e._gtlistentry=null,e._chain=n,e}getInverse(){const t=new s;t.steps=[];for(let s=this.steps.length-1;s>=0;s--){const i=this.steps[s];t.steps.push(i.getInverse());}return t}getGTListEntry(){let t="";for(const s of this.steps)t+=s.uid.toString()+",";return t!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=t),this._gtlistentry}assignCachedGe(t,i,e){this._cached_projection[s.cacheKey(t,i)]=e;}getCachedGeTransformation(t,i){let e="";for(const s of this.steps)e+=s.uid.toString()+",";e!==this._chain&&(this._gtlistentry=null,this._cached_projection={},this._chain=e);const n=this._cached_projection[s.cacheKey(t,i)];return void 0===n?null:n}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let N=null,V=null,X=null,D={};function H(){return !!N&&n()}function J(n){return request.t$1(X)&&(X=Promise.all([P(),Promise.resolve().then(function () { return require('./geometryEngineBase-18aba9d5.js'); }).then((n=>n.g)),Promise.resolve().then(function () { return require('./hydrated-f3bef9fc.js'); })])),X.then((([,e,{hydratedAdapter:t}])=>{request.h(n),V=t,N=e.default,N._enableProjection(R);}))}function O(n,e,t=null){return Array.isArray(n)?0===n.length?[]:Q(V,n,n[0].spatialReference,e,t):Q(V,[n],n.spatialReference,e,t)[0]}function Q(n,e,t,r,l=null){if(request.t$1(t)||request.t$1(r))return e;if(tn(t,r,l))return e.map((n=>request.e$2(un(n,t,r))));if(request.t$1(l)){const n=s.cacheKey(t,r);void 0!==D[n]?l=D[n]:(l=Y(t,r,null),request.t$1(l)&&(l=new s),D[n]=l);}if(request.t$1(N))throw new nn;return N._project(n,e,t,r,l)}function Y(n,e,t=null){if(request.t$1(N))throw new nn;if(request.t$1(n)||request.t$1(e))return null;const r=N._getTransformation(V,n,e,t,null==t?void 0:t.spatialReference);return null!==r?s.fromGE(r):null}class nn extends request.s{constructor(){super("projection:not-loaded","projection engine not fully loaded yet, please call load()");}}function tn(n,e,t){return !t&&(!!request.E$2(n,e)||request.I(n)&&request.I(e)&&!!Re(n,e,Ee))}async function rn(n,e,t,r){if(!H())if(Array.isArray(n)){for(const{source:l,dest:u,geographicTransformation:o}of n)if(!tn(l,u,o))return J(r)}else if(!tn(n,e,t))return J(r)}function ln(n,e){switch(Re(n,e,Ee)){case Gn:return "copy3";case le:return "wgs84ToSphericalECEF";case Kn:return "wgs84ToWebMercator";case Vn:return "wgs84ToPlateCarree";case pe:return "wgs84ToWGS84ECEF";case Wn:return "webMercatorToWGS84";case Zn:return "webMercatorToSphericalECEF";case _n:return "webMercatorToWGS84ECEF";case Dn:return "webMercatorToPlateCarree";case he:return "wgs84ECEFToWGS84";case me:return "wgs84ECEFToSphericalECEF";case de:return "wgs84ECEFToWebMercator";case se:return "sphericalECEFToWGS84";case ie:return "sphericalECEFToWebMercator";case ae:return "sphericalMarsPCPFToMars2000";case oe:return "sphericalMoonPCPFToMoon2000";case ce:return "sphericalECEFToWGS84ECEF";case re:return "mars2000ToSphericalPCPF";case te:return "moon2000ToSphericalPCPF";default:return null}}function un(n,e,t){return n?"x"in n?an(n,e,new request.b$2,t,0):"xmin"in n?Mn(n,e,new request.M,t,0):"rings"in n?mn(n,e,new geometry.v,t,0):"paths"in n?pn(n,e,new geometry.m,t,0):"points"in n?cn(n,e,new geometry.m$1,t,0):null:null}function on(n,e,t=e.spatialReference,r=0){return !request.t$1(t)&&request.r(an(n,n.spatialReference,e,t,r))}function an(n,e,t,r,l){Se[0]=n.x,Se[1]=n.y;const u=n.z;return Se[2]=void 0!==u?u:l,xn(Se,e,0,Se,r,0,1)?(t.x=Se[0],t.y=Se[1],t.spatialReference=r,void 0===u?(t.z=void 0,t.hasZ=!1):(t.z=Se[2],t.hasZ=!0),void 0===n.m?(t.m=void 0,t.hasM=!1):(t.m=n.m,t.hasM=!0),t):null}function cn(n,e,t,r,l){const{points:u,hasZ:o,hasM:a}=n,s=[],i=u.length,c=[];for(const f of u)c.push(f[0],f[1],o?f[2]:l);if(!xn(c,e,0,c,r,0,i))return null;for(let f=0;f<i;++f){const n=3*f,e=c[n],t=c[n+1];o&&a?s.push([e,t,c[n+2],u[f][3]]):o?s.push([e,t,c[n+2]]):a?s.push([e,t,u[f][2]]):s.push([e,t]);}return t.points=s,t.spatialReference=r,t.hasZ=o,t.hasM=a,t}function pn(n,e,t,r,l){const{paths:u,hasZ:o,hasM:a}=n,s=[];return Cn(u,o,a,e,s,r,l)?(t.paths=s,t.spatialReference=r,t.hasZ=o,t.hasM=a,t):null}function hn(n,e,t=e.spatialReference,r=0){return request.r(t)&&request.r(mn(n,n.spatialReference,e,t,r))}function mn(n,e,t,r,l){const{rings:u,hasZ:o,hasM:a}=n,s=[];return Cn(u,o,a,e,s,r,l)?(t.rings=s,t.spatialReference=r,t.hasZ=o,t.hasM=a,t):null}function Mn(n,e,t,r,l){const{xmin:u,ymin:o,xmax:a,ymax:s,hasZ:i,hasM:c}=n;if(!yn(u,o,i?n.zmin:l,e,Se,r))return null;t.xmin=Se[0],t.ymin=Se[1],i&&(t.zmin=Se[2]);return yn(a,s,i?n.zmax:l,e,Se,r)?(t.xmax=Se[0],t.ymax=Se[1],i&&(t.zmax=Se[2]),c&&(t.mmin=n.mmin,t.mmax=n.mmax),t.spatialReference=r,t):null}function Rn(n,e,t){if(request.t$1(e)||request.t$1(t))return null;const r=new request.b$2({spatialReference:t});return xn(n,e,0,Se,t,0,1)?(r.x=Se[0],r.y=Se[1],r.z=Se[2],r):null}function jn(n,e,t){return xn(n,e,0,Se,t.spatialReference,0,1)?(t.x=Se[0],t.y=Se[1],t.z=Se[2],t):null}function wn(n,e,t,r=0){Se[0]=n.x,Se[1]=n.y;const l=n.z;return Se[2]=void 0!==l?l:r,xn(Se,n.spatialReference,0,e,t,0,1)}function yn(n,e,t,r,l,u){return Te[0]=n,Te[1]=e,Te[2]=t,xn(Te,r,0,l,u,0,1)}function gn(n,e,t,r){return !(request.t$1(e)||request.t$1(r)||n.length<2)&&(2===n.length&&(Te[0]=n[0],Te[1]=n[1],Te[2]=0,n=Te),xn(n,e,0,t,r,0,1))}function En(n,e){Se[0]=n.x,Se[1]=n.y;const t=n.z;return Se[2]=void 0!==t?t:0,In(Se,n.spatialReference,e)}function In(n,e,t){return Pn(n,e,t)}function Pn(n,e,t){if(request.t$1(e))return !1;const r=Un(e,ye),l=Me[r][6];return !request.t$1(l)&&(l(n,0,Te,0),t!==Te&&(t[0]=Te[0],t[1]=Te[1],t.length>2&&(t[2]=Te[2])),!0)}function xn(n,e,t,r,l,o,a=1){const s=Re(e,l,Ee);if(request.t$1(s))return !1;if(s===Gn){if(n===r&&t===o)return !0;const e=t+3*a;for(let l=t,u=o;l<e;l++,u++)r[u]=n[l];return !0}const i=t+3*a;for(let u=t,c=o;u<i;u+=3,c+=3)s(n,u,r,c);return !0}function Tn(n,e,t,r,l){mathUtils.r(Se,n),mathUtils.u(be,n,e),gn(Se,t,Se,l),gn(be,t,be,l),mathUtils.c(r,be,Se),mathUtils.j$1(r,r);}function Cn(n,e,t,r,l,u,o=0){const a=new Array;for(const i of n)for(const n of i)a.push(n[0],n[1],e?n[2]:o);if(!xn(a,r,0,a,u,0,a.length/3))return !1;let s=0;l.length=0;for(const i of n){const n=new Array;for(const r of i)e&&t?n.push([a[s++],a[s++],a[s++],r[3]]):e?n.push([a[s++],a[s++],a[s++]]):t?(n.push([a[s++],a[s++],r[2]]),s++):(n.push([a[s++],a[s++]]),s++);l.push(n);}return !0}function Fn(n,e,t,r){if(request.t$1(e)||request.t$1(r))return !1;const l=je(e,r,Ie);if(l.projector===Gn)return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],!0;if(request.t$1(l.projector))return !1;const{source:o,dest:s}=l;if(3===s.spatialReferenceId){const e=Me[o.spatialReferenceId][2];return !request.t$1(e)&&(e(n,0,Ce,0),Kn(Ce,0,t,0),t[3]=Sn(Ce[1],n[2],n[3],request.s$9.radius),!0)}if(2!==o.spatialReferenceId&&5!==o.spatialReferenceId||12!==s.spatialReferenceId)l.projector(n,0,t,0),t[3]=n[3]*o.metersPerUnit/s.metersPerUnit;else {const e=Me[o.spatialReferenceId][1],r=Me[1][12];let u=n[3];request.r(e)&&request.r(r)&&(u=Sn(n[1],n[2],n[3],request.s$9.radius)),l.projector(n,0,t,0),t[3]=u;}return !0}function Sn(n,e,t,r){const l=Math.abs(Pe*n)+Math.asin(t/(r+e));return l>=Math.PI/2?Number.MAX_VALUE:t/Math.cos(l)}function bn(n,e,t,r){return null!=n&&(request.E$2(e,r)?(aaBoundingRect.a(t,n),!0):(Te[0]=n[0],Te[1]=n[1],Te[2]=0,!!xn(Te,e,0,Te,r,0,1)&&(t[0]=Te[0],t[1]=Te[1],Te[0]=n[2],Te[1]=n[3],Te[2]=0,!!xn(Te,e,0,Te,r,0,1)&&(t[2]=Te[0],t[3]=Te[1],!0))))}function kn(n,e,t,r){if(request.t$1(e)||request.t$1(r))return !1;const l=Un(e,ye),o=Un(r,ge);if(l===o&&0!==l||request.E$2(e,r))return t[0]=1,t[1]=1,t[2]=1,!0;if(1===l){const e=mathUtils.s(n),r=e/Math.sqrt(n[0]*n[0]+n[1]*n[1]),l=e/request.s$9.radius;if(3===o)return t[0]=r*l,t[1]=r*l,t[2]=1,!0;if(2===o||5===o){const n=180/(request.s$9.radius*Math.PI);return t[0]=n*r*l,t[1]=n*l,t[2]=1,!0}}else if(12===l&&(2===o||5===o))return t[0]=Nn,t[1]=Nn,t[2]=1,!0;return !1}function vn(n,e,t,r){if(request.t$1(n)||request.t$1(r))return !1;const l=Un(n,ye),o=Un(r,ge);if(l===o&&!qn(o)&&(0!==l||request.E$2(n,r)))return mat4.r(t),mat4.c(t,t,e),!0;if(qn(o)){const n=Me[l][11],r=Me[11][o];return !request.t$1(n)&&!request.t$1(r)&&(n(e,0,Ce,0),r(Ce,0,Fe,0),zn(Pe*Ce[0],Pe*Ce[1],t),t[12]=Fe[0],t[13]=Fe[1],t[14]=Fe[2],!0)}if(!(3!==o&&12!==o||2!==l&&1!==l&&3!==l)){const n=Me[l][11],r=Me[11][o];return !request.t$1(n)&&!request.t$1(r)&&(n(e,0,Ce,0),r(Ce,0,Fe,0),1===l?An(Pe*Ce[0],Pe*Ce[1],t):mat4.r(t),t[12]=Fe[0],t[13]=Fe[1],t[14]=Fe[2],!0)}return !1}function qn(n){return 1===n||7===n||9===n}function zn(n,e,t){const r=Math.sin(n),l=Math.cos(n),u=Math.sin(e),o=Math.cos(e),a=t;return a[0]=-r,a[4]=-u*l,a[8]=o*l,a[12]=0,a[1]=l,a[5]=-u*r,a[9]=o*r,a[13]=0,a[2]=0,a[6]=o,a[10]=u,a[14]=0,a[3]=0,a[7]=0,a[11]=0,a[15]=1,a}function An(n,e,t){return zn(n,e,t),mat4.o(t,t),t}function Un(n,e){return e.spatialReference===n?e.spatialReferenceId:(e.spatialReference=n,"metersPerUnit"in e&&(e.metersPerUnit=unitUtils.H(n,1)),n.wkt===unitUtils.G$1.wkt?e.spatialReferenceId=1:request.A$4(n)?e.spatialReferenceId=2:request.T$3(n)?e.spatialReferenceId=3:request.k$3(n)?e.spatialReferenceId=12:n.wkt===unitUtils.R.wkt?e.spatialReferenceId=4:4490===n.wkid?e.spatialReferenceId=5:n.wkt===unitUtils.I.wkt?e.spatialReferenceId=7:n.wkt===unitUtils.E$1.wkt?e.spatialReferenceId=9:request.G$1(n)?e.spatialReferenceId=8:request.C$1(n)?e.spatialReferenceId=10:e.spatialReferenceId=0)}function Gn(n,e,t,r){n!==t&&(t[r++]=n[e++],t[r++]=n[e++],t[r]=n[e]);}function Wn(n,e,t,r){t[r++]=xe*(n[e++]/request.s$9.radius),t[r++]=xe*(Math.PI/2-2*Math.atan(Math.exp(-n[e++]/request.s$9.radius))),t[r]=n[e];}function Zn(n,e,t,r){Wn(n,e,t,r),le(t,r,t,r);}function _n(n,e,t,r){Wn(n,e,t,r),pe(t,r,t,r);}function Bn(n,t,r,l,u){const o=.4999999*Math.PI,a=mathUtils.e(Pe*n[t+1],-o,o),s=Math.sin(a);r[l++]=Pe*n[t]*u.radius,r[l++]=u.halfSemiMajorAxis*Math.log((1+s)/(1-s)),r[l]=n[t+2];}function Kn(n,e,t,r){Bn(n,e,t,r,request.s$9);}const Ln=request.s$9.radius*Math.PI/180,Nn=180/(request.s$9.radius*Math.PI);function Vn(n,e,t,r){t[r]=n[e]*Ln,t[r+1]=n[e+1]*Ln,t[r+2]=n[e+2];}function Xn(n,e,t,r){t[r]=n[e]*Nn,t[r+1]=n[e+1]*Nn,t[r+2]=n[e+2];}function Dn(n,e,t,r){Wn(n,e,t,r),Vn(t,r,t,r);}function Hn(n,e,t,r){he(n,e,t,r),Vn(t,r,t,r);}function Jn(n,e,t,r){se(n,e,t,r),Vn(t,r,t,r);}function On(n,e,t,r){Xn(n,e,t,r),le(t,r,t,r);}function Qn(n,e,t,r){Xn(n,e,t,r),Kn(t,r,t,r);}function Yn(n,e,t,r){Xn(n,e,t,r),pe(t,r,t,r);}function $n(n){if(request.t$1(n))return !1;const e=Un(n,ye);return !!Me[e][6]}function ne(n,e,t,r,l=0){const u=r+l,o=Math.cos(t);n[0]=Math.cos(e)*o*u,n[1]=Math.sin(e)*o*u,n[2]=Math.sin(t)*u;}function ee(n,e,t,r,l){const u=l+n[e+2],o=Pe*n[e+1],a=Pe*n[e],s=Math.cos(o);t[r++]=Math.cos(a)*s*u,t[r++]=Math.sin(a)*s*u,t[r]=Math.sin(o)*u;}function te(n,e,t,r){ee(n,e,t,r,request.e$8.radius);}function re(n,e,t,r){ee(n,e,t,r,request.t$8.radius);}function le(n,e,t,r){ee(n,e,t,r,request.s$9.radius);}function ue(n,e,t,r,u){const o=n[e],a=n[e+1],s=n[e+2],i=Math.sqrt(o*o+a*a+s*s),c=mathUtils.b(s/(0===i?1:i)),f=Math.atan2(a,o);t[r++]=xe*f,t[r++]=xe*c,t[r]=i-u;}function oe(n,e,t,r){ue(n,e,t,r,request.e$8.radius);}function ae(n,e,t,r){ue(n,e,t,r,request.t$8.radius);}function se(n,e,t,r){ue(n,e,t,r,request.s$9.radius);}function ie(n,e,t,r){se(n,e,t,r),Kn(t,r,t,r);}function ce(n,e,t,r){se(n,e,t,r),pe(t,r,t,r);}function fe(n,e,t,r,l){const u=Pe*n[e],o=Pe*n[e+1],a=n[e+2],s=Math.sin(o),i=Math.cos(o),c=l.radius/Math.sqrt(1-l.eccentricitySquared*s*s);t[r++]=(c+a)*i*Math.cos(u),t[r++]=(c+a)*i*Math.sin(u),t[r++]=(c*(1-l.eccentricitySquared)+a)*s;}function pe(n,e,t,r){fe(n,e,t,r,request.s$9);}function he(n,e,t,r){const l=geodesicConstants.s,u=n[e],o=n[e+1],a=n[e+2];let s,i,c,f,p,h,m,d,M,R,j,w,y,g,E,I,P,x,T,C,F;s=Math.abs(a),i=u*u+o*o,c=Math.sqrt(i),f=i+a*a,p=Math.sqrt(f),C=Math.atan2(o,u),h=a*a/f,m=i/f,g=l.a2/p,E=l.a3-l.a4/p,m>.3?(d=s/p*(1+m*(l.a1+g+h*E)/p),T=Math.asin(d),R=d*d,M=Math.sqrt(1-R)):(M=c/p*(1-h*(l.a5-g-m*E)/p),T=Math.acos(M),R=1-M*M,d=Math.sqrt(R)),j=1-request.s$9.eccentricitySquared*R,w=request.s$9.radius/Math.sqrt(j),y=l.a6*w,g=c-w*M,E=s-y*d,P=M*g+d*E,I=M*E-d*g,x=I/(y/j+P),T+=x,F=P+I*x/2,a<0&&(T=-T),t[r++]=xe*C,t[r++]=xe*T,t[r]=F;}function me(n,e,t,r){he(n,e,t,r),le(t,r,t,r);}function de(n,e,t,r){he(n,e,t,r),Kn(t,r,t,r);}const Me={2:{5:null,8:null,10:null,11:Gn,6:Gn,1:le,7:null,9:null,0:null,3:Kn,12:Vn,2:Gn,4:pe},5:{5:Gn,8:null,10:null,11:Gn,6:Gn,1:le,7:null,9:null,0:null,3:null,12:Vn,2:null,4:pe},8:{5:null,8:Gn,10:null,11:Gn,6:null,1:null,7:re,9:null,0:null,3:null,12:null,2:null,4:null},10:{5:null,8:null,10:Gn,11:Gn,6:null,1:null,7:null,9:te,0:null,3:null,12:null,2:null,4:null},3:{5:null,8:null,10:null,11:Wn,6:Wn,1:Zn,7:null,9:null,0:null,3:Gn,12:Dn,2:Wn,4:_n},4:{5:he,8:null,10:null,11:he,6:he,1:me,7:null,9:null,0:null,3:de,12:Hn,2:he,4:Gn},1:{5:se,8:null,10:null,11:se,6:se,1:Gn,7:null,9:null,0:null,3:ie,12:Jn,2:se,4:ce},7:{5:null,8:ae,10:null,11:ae,6:null,1:null,7:Gn,9:null,0:null,3:null,12:null,2:null,4:null},9:{5:null,8:null,10:oe,11:oe,6:null,1:null,7:null,9:Gn,0:null,3:null,12:null,2:null,4:null},0:{5:null,8:null,10:null,11:null,6:null,1:null,7:null,9:null,0:Gn,3:null,12:null,2:null,4:null},11:{5:Gn,8:Gn,10:Gn,11:Gn,6:Gn,1:le,7:re,9:te,0:null,3:Kn,12:Vn,2:Gn,4:pe},6:{5:null,8:null,10:null,11:Gn,6:Gn,1:le,7:null,9:null,0:null,3:null,12:Vn,2:Gn,4:pe},12:{5:Xn,8:null,10:null,11:Xn,6:Xn,1:On,7:null,9:null,0:null,3:Qn,12:Gn,2:Xn,4:Yn}};function Re(n,e,t=we()){return request.t$1(n)||request.t$1(e)?null:je(n,e,t).projector}function je(n,e,t){if(request.t$1(n)||request.t$1(e)||t.source.spatialReference===n&&t.dest.spatialReference===e)return t;const r=Un(n,t.source),l=Un(e,t.dest);return 0===r&&0===l?request.E$2(n,e)?t.projector=Gn:t.projector=null:t.projector=Me[r][l],t}function we(){return {source:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},dest:{spatialReference:null,spatialReferenceId:0,metersPerUnit:1},projector:Gn}}const ye={spatialReference:null,spatialReferenceId:0},ge={spatialReference:null,spatialReferenceId:0},Ee=we(),Ie=we(),Pe=mathUtils.M(1),xe=mathUtils.m(1),Te=common.n(),Ce=common.n(),Fe=common.n(),Se=common.n(),be=common.n();

exports.$n = $n;
exports.Bn = Bn;
exports.En = En;
exports.Fn = Fn;
exports.H = H;
exports.In = In;
exports.J = J;
exports.O = O;
exports.Q = Q;
exports.Rn = Rn;
exports.Tn = Tn;
exports.Y = Y;
exports.bn = bn;
exports.gn = gn;
exports.hn = hn;
exports.jn = jn;
exports.kn = kn;
exports.ln = ln;
exports.ne = ne;
exports.on = on;
exports.rn = rn;
exports.s = s;
exports.tn = tn;
exports.ue = ue;
exports.un = un;
exports.vn = vn;
exports.wn = wn;
exports.xn = xn;
exports.yn = yn;
exports.zn = zn;
