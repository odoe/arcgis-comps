'use strict';

const request = require('./messageBundle-8be88d04.js');
const reactiveUtils = require('./reactiveUtils-ef5dccea.js');
const Popover = require('./Popover-a5af0472.js');
const accessibleHandler = require('./accessibleHandler-652e5d90.js');
const Graphic = require('./Graphic-0aff6059.js');
const PopupTemplate = require('./PopupTemplate-a0b855f8.js');
const SimpleLineSymbol = require('./symbols-29b793e5.js');
const Portal = require('./Portal-8d16604d.js');
const layerViewUtils = require('./layerViewUtils-96bae70b.js');
const Identifiable = require('./Identifiable-a4f50f85.js');
const unitUtils = require('./unitUtils-083cb8d0.js');
const geometry = require('./geometry-ef17530a.js');
const scaleUtils = require('./scaleUtils-5c377ab3.js');
const utils = require('./utils-8a0a0870.js');
const Task = require('./Task-95a3fa39.js');
require('./units-77498be1.js');
require('./trimExtend-5a37c80f.js');
const project = require('./project-dab29fc8.js');
const GoTo = require('./GoTo-be01affb.js');
const vmEvent = require('./vmEvent-9b257013.js');

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const m$4=new Map([["ar",()=>Promise.resolve().then(function () { return require('./ar-dde5e6ad.js'); }).then(function (n) { return n.ar; })],["ar-dz",()=>Promise.resolve().then(function () { return require('./ar-dz-10b5455c.js'); }).then(function (n) { return n.arDz; })],["ar-kw",()=>Promise.resolve().then(function () { return require('./ar-kw-94903f77.js'); }).then(function (n) { return n.arKw; })],["ar-ly",()=>Promise.resolve().then(function () { return require('./ar-ly-1764c7e3.js'); }).then(function (n) { return n.arLy; })],["ar-ma",()=>Promise.resolve().then(function () { return require('./ar-ma-9dc1877d.js'); }).then(function (n) { return n.arMa; })],["ar-sa",()=>Promise.resolve().then(function () { return require('./ar-sa-c0b46f71.js'); }).then(function (n) { return n.arSa; })],["ar-tn",()=>Promise.resolve().then(function () { return require('./ar-tn-f889fae4.js'); }).then(function (n) { return n.arTn; })],["bg",()=>Promise.resolve().then(function () { return require('./bg-83499a76.js'); }).then(function (n) { return n.bg; })],["bs",()=>Promise.resolve().then(function () { return require('./bs-8a6f7659.js'); }).then(function (n) { return n.bs; })],["ca",()=>Promise.resolve().then(function () { return require('./ca-ce496028.js'); }).then(function (n) { return n.ca; })],["cs",()=>Promise.resolve().then(function () { return require('./cs-35cca6a0.js'); }).then(function (n) { return n.cs; })],["da",()=>Promise.resolve().then(function () { return require('./da-054af029.js'); }).then(function (n) { return n.da; })],["de",()=>Promise.resolve().then(function () { return require('./de-c09630ce.js'); }).then(function (n) { return n.de; })],["de-at",()=>Promise.resolve().then(function () { return require('./de-at-73a796bd.js'); }).then(function (n) { return n.deAt; })],["de-ch",()=>Promise.resolve().then(function () { return require('./de-ch-801a39a8.js'); }).then(function (n) { return n.deCh; })],["el",()=>Promise.resolve().then(function () { return require('./el-8ca2733a.js'); }).then(function (n) { return n.el; })],["en-au",()=>Promise.resolve().then(function () { return require('./en-au-a945679b.js'); }).then(function (n) { return n.enAu; })],["en-ca",()=>Promise.resolve().then(function () { return require('./en-ca-e9f5191e.js'); }).then(function (n) { return n.enCa; })],["en-gb",()=>Promise.resolve().then(function () { return require('./en-gb-042c3f07.js'); }).then(function (n) { return n.enGb; })],["en-ie",()=>Promise.resolve().then(function () { return require('./en-ie-abef3a23.js'); }).then(function (n) { return n.enIe; })],["en-il",()=>Promise.resolve().then(function () { return require('./en-il-cb4618dc.js'); }).then(function (n) { return n.enIl; })],["en-in",()=>Promise.resolve().then(function () { return require('./en-in-334b7851.js'); }).then(function (n) { return n.enIn; })],["en-nz",()=>Promise.resolve().then(function () { return require('./en-nz-c667be11.js'); }).then(function (n) { return n.enNz; })],["en-sg",()=>Promise.resolve().then(function () { return require('./en-sg-b1589d63.js'); }).then(function (n) { return n.enSg; })],["es",()=>Promise.resolve().then(function () { return require('./es-e4148abc.js'); }).then(function (n) { return n.es; })],["es-do",()=>Promise.resolve().then(function () { return require('./es-do-0409bd31.js'); }).then(function (n) { return n.esDo; })],["es-mx",()=>Promise.resolve().then(function () { return require('./es-mx-786b34b1.js'); }).then(function (n) { return n.esMx; })],["es-us",()=>Promise.resolve().then(function () { return require('./es-us-820923ad.js'); }).then(function (n) { return n.esUs; })],["et",()=>Promise.resolve().then(function () { return require('./et-d2f4fee8.js'); }).then(function (n) { return n.et; })],["fi",()=>Promise.resolve().then(function () { return require('./fi-8d05b99e.js'); }).then(function (n) { return n.fi; })],["fr",()=>Promise.resolve().then(function () { return require('./fr-6593bdc9.js'); }).then(function (n) { return n.fr; })],["fr-ca",()=>Promise.resolve().then(function () { return require('./fr-ca-2969a684.js'); }).then(function (n) { return n.frCa; })],["fr-ch",()=>Promise.resolve().then(function () { return require('./fr-ch-027811e6.js'); }).then(function (n) { return n.frCh; })],["he",()=>Promise.resolve().then(function () { return require('./he-3c0a29c6.js'); }).then(function (n) { return n.he; })],["hr",()=>Promise.resolve().then(function () { return require('./hr-51261990.js'); }).then(function (n) { return n.hr; })],["hu",()=>Promise.resolve().then(function () { return require('./hu-675b3f11.js'); }).then(function (n) { return n.hu; })],["id",()=>Promise.resolve().then(function () { return require('./id-5a055934.js'); }).then(function (n) { return n.id; })],["it",()=>Promise.resolve().then(function () { return require('./it-c6e715b0.js'); }).then(function (n) { return n.it; })],["it-ch",()=>Promise.resolve().then(function () { return require('./it-ch-901b0eb7.js'); }).then(function (n) { return n.itCh; })],["ja",()=>Promise.resolve().then(function () { return require('./ja-f53ca408.js'); }).then(function (n) { return n.ja; })],["ko",()=>Promise.resolve().then(function () { return require('./ko-d31b5be1.js'); }).then(function (n) { return n.ko; })],["lt",()=>Promise.resolve().then(function () { return require('./lt-71fb00ae.js'); }).then(function (n) { return n.lt; })],["lv",()=>Promise.resolve().then(function () { return require('./lv-e7550fa2.js'); }).then(function (n) { return n.lv; })],["nb",()=>Promise.resolve().then(function () { return require('./nb-9654fc9b.js'); }).then(function (n) { return n.nb; })],["nl",()=>Promise.resolve().then(function () { return require('./nl-1d7fe868.js'); }).then(function (n) { return n.nl; })],["nl-be",()=>Promise.resolve().then(function () { return require('./nl-be-cb548c21.js'); }).then(function (n) { return n.nlBe; })],["pl",()=>Promise.resolve().then(function () { return require('./pl-f2bb3f33.js'); }).then(function (n) { return n.pl; })],["pt",()=>Promise.resolve().then(function () { return require('./pt-40b8f905.js'); }).then(function (n) { return n.pt; })],["pt-br",()=>Promise.resolve().then(function () { return require('./pt-br-86ea0598.js'); }).then(function (n) { return n.ptBr; })],["ro",()=>Promise.resolve().then(function () { return require('./ro-6d4f55f9.js'); }).then(function (n) { return n.ro; })],["ru",()=>Promise.resolve().then(function () { return require('./ru-a39a21af.js'); }).then(function (n) { return n.ru; })],["sk",()=>Promise.resolve().then(function () { return require('./sk-d0541588.js'); }).then(function (n) { return n.sk; })],["sl",()=>Promise.resolve().then(function () { return require('./sl-8bcd784e.js'); }).then(function (n) { return n.sl; })],["sr",()=>Promise.resolve().then(function () { return require('./sr-5ac93324.js'); }).then(function (n) { return n.sr; })],["sr-cyrl",()=>Promise.resolve().then(function () { return require('./sr-cyrl-51bffadd.js'); }).then(function (n) { return n.srCyrl; })],["sv",()=>Promise.resolve().then(function () { return require('./sv-05d2c1d3.js'); }).then(function (n) { return n.sv; })],["th",()=>Promise.resolve().then(function () { return require('./th-be57428f.js'); }).then(function (n) { return n.th; })],["tr",()=>Promise.resolve().then(function () { return require('./tr-72b02f1b.js'); }).then(function (n) { return n.tr; })],["uk",()=>Promise.resolve().then(function () { return require('./uk-b9aa62ca.js'); }).then(function (n) { return n.uk; })],["vi",()=>Promise.resolve().then(function () { return require('./vi-5292a74c.js'); }).then(function (n) { return n.vi; })],["zh-cn",()=>Promise.resolve().then(function () { return require('./zh-cn-db3e6be0.js'); }).then(function (n) { return n.zhCn; })],["zh-hk",()=>Promise.resolve().then(function () { return require('./zh-hk-0989a652.js'); }).then(function (n) { return n.zhHk; })],["zh-mo",()=>Promise.resolve().then(function () { return require('./zh-mo-dc6e2d44.js'); }).then(function (n) { return n.zhMo; })],["zh-tw",()=>Promise.resolve().then(function () { return require('./zh-tw-f1f9f11e.js'); }).then(function (n) { return n.zhTw; })]]);async function e$4(e=request.i$6()){const t=(await Promise.resolve().then(function () { return require('./moment-c1e4aee2.js'); }).then(function (n) { return n.moment; })).default;e=e.toLowerCase();let l=m$4.has(e);if(!l){const o=e.split("-");o.length>1&&m$4.has(o[0])&&(e=o[0],l=!0);}return l?await m$4.get(e)():e="en",e!==t.locale()&&t.locale(e),t}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function o$2(t,e){const o=request.T$1(e),i=Date.now(),l=o.formatToParts(i),c=new Set;l.filter((({type:t})=>"literal"===t)).forEach((({value:t})=>c.add(t)));let f=0;const s={};for(;l.length>0;){const{type:r,value:e}=l.shift();for(let o=0;o<e.length;o++,f++){const e=t.charAt(f);if(c.has(e)){f++;break}if("literal"===r)break;s[r]||(s[r]=[]),s[r].push(e);}}const g={};try{g.day=n$7(s.day.join("")),g.month=n$7(s.month.join(""))-1,g.year=n$7((s.year||s.relatedYear).join(""));}catch(h){throw a$3(e)}if(isNaN(g.day)||isNaN(g.month)||isNaN(g.year))throw a$3(e);return g}function n$7(t){const r=[/٠/g,/١/g,/٢/g,/٣/g,/٤/g,/٥/g,/٦/g,/٧/g,/٨/g,/٩/g];for(let e=0;e<10;e++)t=t.replace(r[e],e.toString());return Number(t)}function a$3(r){return new request.s(`could not parse date input, expecting the following format: ${request.L$1(Date.now(),r)}`)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let t$3=class extends request.p{constructor(){super(...arguments),this.state="ready",this.value=new Date;}};request.e([request.d()],t$3.prototype,"state",void 0),request.e([request.d()],t$3.prototype,"value",void 0),t$3=request.e([request.i("esri.widgets.support.MomentElementViewModel")],t$3);const p$8=t$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let e$3=class extends p$8{constructor(r){super(r);}};e$3=request.e([request.i("esri.widgets.support.DatePickerViewModel")],e$3);const t$2=e$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const b$2={base:"esri-date-picker",datePicker:"esri-date-picker__calendar",monthPicker:"esri-date-picker__month-picker",dayPicker:"esri-date-picker__day-picker",week:"esri-date-picker__week-item",nearbyMonth:"esri-date-picker__day-item--nearby-month",activeDay:"esri-date-picker__day-item--active",today:"esri-date-picker__day-item--today",selectedDay:"esri-date-picker__day-item--selected",day:"esri-date-picker__day-item",dayHeader:"esri-date-picker__day-item--header",yearPicker:"esri-date-picker__year-picker",selectedYear:"esri-date-picker__year-picker-item--selected",year:"esri-date-picker__year-picker-item",monthDropdown:"esri-date-picker__month-dropdown",date:"esri-date-picker__date",datePickerToggle:"esri-date-picker__calendar-toggle",dateInput:"esri-date-picker__input",dateTextInput:"esri-date-picker__text-input",leadingIcon:"esri-date-picker__icon--leading",previousIcon:"esri-icon-left",nextIcon:"esri-icon-right",calendarIcon:"esri-icon-calendar",widget:"esri-widget",button:"esri-widget--button",input:"esri-input",select:"esri-select"},f$5={year:"numeric",month:"2-digit",day:"2-digit"},M$1=[" ","ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Enter","Home","PageDown","PageUp"],P$2="esri.widgets.support.DatePicker",O$1=request.s$1.getLogger(P$2);let I$2=class extends request.z{constructor(e,t){super(e,t),this._activeDate=null,this._calendarNode=null,this._calendarPopover=new Popover.f({owner:this,placement:"bottom-start",anchorElement:()=>this._rootNode,renderContentFunction:this._renderCalendar}),this._inputOrButtonNode=null,this._isOpen=!1,this._requestDayPickerFocusOnCreate=!1,this._rootNode=null,this.dateInputEnabled=!1,this.label=void 0,this.messages=null,this.value=null,this.commitOnMonthChange=!1,this.viewModel=new t$2,this._toggle=this._toggle.bind(this);}initialize(){this.own(reactiveUtils.i((()=>{var e;return {viewModel:this.viewModel,value:null==(e=this.viewModel)?void 0:e.value}}),(({viewModel:e,value:t})=>{this.destroyed||!e||request.t$1(this.onChange)||this.onChange(t);}),reactiveUtils.m));}async loadLocale(){this._moment=await e$4(),this._isOpen&&(this._activeDate=this._moment(this._activeDate.toDate()));}destroy(){this._calendarPopover.destroy();}render(){return request.n$1("div",{afterCreate:request.g$2,bind:this,class:this.classes(b$2.base,b$2.widget),"data-node-ref":"_rootNode"},this.dateInputEnabled?this.renderInputAndButtonMode():this.renderButtonOnlyMode())}renderButtonOnlyMode(){const e=request.L$1(this.viewModel.value,f$5),{_isOpen:t,messages:a}=this;return request.n$1("div",{afterCreate:request.g$2,"aria-controls":t?this._getCalendarId():null,"aria-expanded":t.toString(),"aria-haspopup":"true","aria-label":a.setDate,"aria-pressed":t.toString(),bind:this,class:this.classes(b$2.button,b$2.select,b$2.datePickerToggle),"data-node-ref":"_inputOrButtonNode",onclick:this._toggle,onkeydown:this._handleDateButtonKeyDown,role:"button",tabIndex:0},request.n$1("span",{class:b$2.date},e))}renderInputAndButtonMode(){const e=request.L$1(this.viewModel.value,f$5),{_isOpen:t,messages:a}=this;return request.n$1("div",{class:this.classes(b$2.dateInput)},request.n$1("input",{afterCreate:request.g$2,"data-node-ref":"_inputOrButtonNode","aria-controls":t?this._getCalendarId():null,"aria-haspopup":"true","aria-label":a.setDate,bind:this,class:this.classes(b$2.dateTextInput,b$2.input),key:"date-input",onblur:this._handleDateInputBlur,onclick:this._handleDateInputClick,onkeydown:this._handleDateInputKeyDown,type:"text",value:e}),request.n$1("span",{"aria-hidden":"true",class:this.classes(b$2.leadingIcon,b$2.calendarIcon)}))}_handleDateInputClick(){this._open(this.viewModel.value,!1);}_handleDateInputKeyDown(e){const{key:t}=e;this._isOpen?"Enter"===t?this._handleDateText(e):"Escape"===t&&this._close():"ArrowDown"===t&&(this._open(this.viewModel.value),e.preventDefault());}_handleDateButtonKeyDown(e){const{key:t,shiftKey:a}=e;this._isOpen&&"Tab"===t&&a?this._close():request.y(t)&&this._toggle();}_handleDateInputBlur(e){this._isOpen||this._handleDateText(e);}_handleDateText(e){const t=e.currentTarget;let a;try{a=o$2(t.value,f$5);}catch(s){return O$1.warn(s),void(t.value=request.L$1(this.viewModel.value,f$5))}const i=this._moment(a);i.isValid()?(this.viewModel.value=i.toDate(),this._activeDate=i):t.value=request.L$1(this.viewModel.value,f$5);}_handleDatePickerKeydown(e){"Escape"===request.i$2(e)&&(this._close(),e.preventDefault(),e.stopPropagation());}_renderCalendar(){const e=this._activeDate,t=this._moment(this.viewModel.value);return request.n$1("div",{afterCreate:request.g$2,bind:this,class:this.classes(b$2.datePicker,b$2.widget),"data-node-ref":"_calendarNode",id:this._getCalendarId(),key:"esri-date-picker__calendar",onkeydown:this._handleDatePickerKeydown},this._renderMonthPicker(e),this._renderDayPicker(e,t),this._renderYearPicker(e))}_getCalendarId(){return `date-picker__calendar--${this.id}`}_renderMonthPicker(e){const t=request.d$3(this.container),a=t?b$2.nextIcon:b$2.previousIcon,i=t?b$2.previousIcon:b$2.nextIcon,s=this._moment.months().map(((t,a)=>{const i=e.month()===a;return request.n$1("option",{selected:i},t)})),{messages:r}=this;return request.n$1("div",{class:b$2.monthPicker},request.n$1("div",{"aria-label":r.goToPreviousMonth,bind:this,class:b$2.button,onclick:this._setPreviousMonth,onkeydown:this._handlePreviousMonthKeyDown,role:"button",tabIndex:0,title:r.goToPreviousMonth},request.n$1("span",{"aria-hidden":"true",class:a})),request.n$1("select",{"aria-live":"assertive","aria-label":r.selectMonth,bind:this,class:this.classes(b$2.monthDropdown,b$2.select),id:`${this.id}__month-picker`,onchange:this._setMonth,onkeydown:this._setMonth,title:r.selectMonth},s),request.n$1("div",{"aria-label":r.goToNextMonth,bind:this,class:b$2.button,onclick:this._setNextMonth,onkeydown:this._setNextMonth,role:"button",tabIndex:0,title:r.goToNextMonth},request.n$1("span",{"aria-hidden":"true",class:i})))}_renderDayPicker(e,t){const a=e.clone().day(this._moment.localeData().firstDayOfWeek()),i=this._getWeekLabels(a),s=this._getDayId(e),r=this._renderMonth(e,t);return request.n$1("div",{afterCreate:this._handleDayPickerCreate,"aria-activedescendant":s,"aria-labelledby":`${this.id}__month-picker ${this.id}__selected-year`,bind:this,class:b$2.dayPicker,id:`${this.id}__day-picker`,onkeydown:this._handleDayPickerKeydown,role:"grid",tabIndex:0},request.n$1("div",{class:b$2.week,role:"row"},i.map((e=>request.n$1("div",{"aria-label":e.name,class:this.classes(b$2.day,b$2.dayHeader),role:"columnheader",title:e.name},e.abbr)))),r)}_getDayId(e){return `${this.id}__${request.L$1(e.valueOf(),f$5)}`}_handleDayPickerCreate(e){this._requestDayPickerFocusOnCreate&&(this._requestDayPickerFocusOnCreate=!1,e.focus());}_getWeekLabels(e){const t=[],a={weekday:"long"},i={weekday:"narrow"};for(let s=0;s<7;s++)t.push({name:request.L$1(e.valueOf(),a),abbr:request.L$1(e.valueOf(),i)}),e.add(1,"day");return t}_handleDayPickerKeydown(e){const{ctrlKey:a,shiftKey:i}=e,s=request.i$2(e),r=this._activeDate;if(-1!==M$1.indexOf(s)){if("ArrowLeft"===s)r.subtract(1,"day");else if("ArrowRight"===s)r.add(1,"day");else if("ArrowUp"===s)r.subtract(1,"week");else if("ArrowDown"===s)r.add(1,"week");else if("PageUp"===s){const e=i?"year":"month";r.subtract(1,e);}else if("PageDown"===s){const e=i?"year":"month";r.add(1,e);}else if("Home"===s){const e=a?"year":"month";r.startOf(e);}else if("End"===s){const e=a?"year":"month";r.endOf(e);}else request.y(s)&&(this.viewModel.value=r.toDate(),this._close());e.preventDefault(),e.stopPropagation();}}_renderMonth(e,t){const a=this._moment(),i=e.clone().startOf("month"),s=e.clone().endOf("month"),r=6,o=7,n=i.clone().subtract(i.weekday(),"day"),d=[];for(let l=0;l<r;l++){const r=[];for(let d=0;d<o;d++){const o=n.date(),d=n.isSame(e,"day"),l=n.isSame(t,"day"),c=this._getDayId(n),h={[b$2.nearbyMonth]:!n.isBetween(i,s,null,"[]"),[b$2.today]:n.isSame(a,"day"),[b$2.activeDay]:d,[b$2.selectedDay]:l};r.push(request.n$1("div",{"aria-label":o.toString(),"aria-selected":d.toString(),bind:this,class:this.classes(b$2.day,h),"data-iso-date":n.toISOString(),id:c,onclick:this._handleSelectedDate,onkeydown:this._handleSelectedDate,role:"gridcell"},o)),n.add(1,"day");}d.push(request.n$1("div",{class:b$2.week,role:"row"},r));}return d}_renderYearPicker(e){const t={year:"numeric"},a=e.clone(),i=request.L$1(a.valueOf(),t),s=request.L$1(a.add(1,"year").valueOf(),t),r=request.L$1(a.subtract(2,"year").valueOf(),t),{messages:o}=this;return request.n$1("div",{class:b$2.yearPicker},request.n$1("div",{"aria-label":o.goToPreviousYear,bind:this,class:b$2.year,onclick:this._setPreviousYear,onkeydown:this._setPreviousYear,tabIndex:0,title:o.goToPreviousYear},r),request.n$1("div",{class:this.classes(b$2.year,b$2.selectedYear),id:`${this.id}__selected-year`},i),request.n$1("div",{"aria-label":o.goToNextYear,bind:this,class:b$2.year,onclick:this._setNextYear,onkeydown:this._handleNextYearKeyDown,tabIndex:0,title:o.goToNextYear},s))}_toggle(){this._isOpen?this._close():this._open(this.viewModel.value);}_setMonth(e){const t=e.target.value;this._activeDate.month(t),this.commitOnMonthChange&&(this.viewModel.value=this._activeDate.toDate());}_close(e=!0){this._activeDate=null,this._isOpen=!1,this._calendarPopover.open=!1,this.pageClickHandler.pause(),e&&this._inputOrButtonNode.focus();}_open(e,t=!0){this._activeDate=this._moment(e),this._isOpen=!0,this._calendarPopover.open=!0,this._requestDayPickerFocusOnCreate=t,this.pageClickHandler||(this.pageClickHandler=request.n$5(document,"click",(({target:e})=>{var t,a;(null==(t=this._calendarNode)?void 0:t.contains(e))||(null==(a=this._rootNode)?void 0:a.contains(e))||this._close();})),this.own(this.pageClickHandler)),this.pageClickHandler.resume();}_setPreviousMonth(){this._activeDate.subtract(1,"month"),this.commitOnMonthChange&&(this.viewModel.value=this._activeDate.toDate());}_handlePreviousMonthKeyDown(e){if("Tab"===e.key&&e.shiftKey)return e.preventDefault(),void this._close();request.y(e.key)&&this._setPreviousMonth();}_setNextMonth(){this._activeDate.add(1,"month"),this.commitOnMonthChange&&(this.viewModel.value=this._activeDate.toDate());}_setPreviousYear(){this._activeDate.subtract(1,"year");}_setNextYear(){this._activeDate.add(1,"year");}_handleNextYearKeyDown(e){if("Tab"===e.key&&!e.shiftKey)return e.preventDefault(),void this._close();request.y(e.key)&&this._setNextYear();}_handleSelectedDate(e){const t=e.target;this.viewModel.value=this._moment(t.getAttribute("data-iso-date")).toDate(),this._close();}};request.e([request.d()],I$2.prototype,"dateInputEnabled",void 0),request.e([request.d({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],I$2.prototype,"label",void 0),request.e([request.d(),request.e$1("esri/widgets/support/t9n/DatePicker")],I$2.prototype,"messages",void 0),request.e([request.o("viewModel.value")],I$2.prototype,"value",void 0),request.e([request.d()],I$2.prototype,"commitOnMonthChange",void 0),request.e([request.d({type:t$2})],I$2.prototype,"viewModel",void 0),request.e([request.d()],I$2.prototype,"onChange",void 0),request.e([accessibleHandler.t()],I$2.prototype,"_setNextMonth",null),request.e([accessibleHandler.t()],I$2.prototype,"_setPreviousYear",null),request.e([accessibleHandler.t()],I$2.prototype,"_handleSelectedDate",null),I$2=request.e([request.i(P$2)],I$2);const x$2=I$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let e$2=class extends p$8{constructor(r){super(r);}};e$2=request.e([request.i("esri.widgets.support.TimePickerViewModel")],e$2);const t$1=e$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const l$4={base:"esri-time-picker esri-widget",timePicker:"esri-time-picker__date-picker",timePickerInput:"esri-time-picker__input",input:"esri-input",button:"esri-widget--button"},m$3={hour:"numeric",minute:"numeric"},p$7="LT",d$7=["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","Tab"];function _(t){return request.L$1(t.valueOf(),m$3).indexOf(" ")>-1}let v$2=class extends request.z{constructor(t,e){super(t,e),this._activeTime=null,this.label=void 0,this.messages=null,this.value=null,this.viewModel=new t$1;}async loadLocale(){this._moment=await e$4();}render(){const t=this._activeTime||this.viewModel.value;return request.n$1("div",{class:l$4.base},request.n$1("input",{afterUpdate:this._handleInputUpdate,"aria-label":this.messages.inputTitle,bind:this,class:this.classes(l$4.timePickerInput,l$4.input),onblur:this._handleInputBlur,onfocus:this._handleInputFocus,onkeydown:this._handleInputKeydown,oninput:this._handleInputKeydown,onclick:this._handleInputClick,onpaste:this._handleInputPaste,onwheel:this._handleInputWheel,value:request.L$1(t.valueOf(),m$3)}))}_handleInputBlur(){this._activeTime.isValid()&&(this.viewModel.value=this._activeTime.toDate()),this._activeTime=null,this._activePart=null;}_handleInputUpdate(t){this._selectPart(t,this._activePart);}_selectPart(t,e){const i=this._activeTime;if(!i)return;const s=request.L$1(i.valueOf(),m$3),r=0,a=s.indexOf(":");if("hours"===e)return void t.setSelectionRange(r,a);const o=a+1,n=o+2;if("minutes"===e)return void t.setSelectionRange(o,n);const u=n+1,h=s.length;"meridiem"!==e||t.setSelectionRange(u,h);}_handleInputFocus(t){this._activePart="hours",this._activeTime=this._moment(this.viewModel.value).startOf("minute"),this._selectPart(t.target,"hours");}_caretIndexToPartName(t){const e=this._activeTime.format(p$7),i=e.indexOf(":"),s=e.indexOf(" ");return t<=i?"hours":t>i&&t<=s?"minutes":"meridiem"}_handleInputKeydown(t){const{ctrlKey:i,metaKey:s,shiftKey:r}=t,a=request.i$2(t),o=this._activeTime,n=this._activePart,u=/\d/.test(a),h=/^a|p$/i.test(a),c=s||i;if(d$7.indexOf(a)>-1||u||"meridiem"===n&&h&&!c){if("ArrowLeft"===a)this._activePart=this._prevPart();else if("ArrowRight"===a)this._activePart=this._nextPart();else if("Tab"===a){const t=r?this._prevPart():this._nextPart();if(t===this._activePart)return;this._activePart=t;}else if("ArrowUp"===a)this._shift("up",o,n);else if("ArrowDown"===a)this._shift("down",o,n);else if(u)this._setTime(o,n,Number(a));else if(h){const t=a.toLowerCase(),e=o.hour();("a"===t&&e>=12||"p"===t&&e<12)&&this._shift("up",o,n);}t.preventDefault(),t.stopImmediatePropagation();}else c||(t.preventDefault(),t.stopImmediatePropagation());}_handleInputClick(t){const e=t.target;this._activePart=null,this.renderNow(),this._activePart=this._caretIndexToPartName(e.selectionStart);}_getOrderedParts(){return _(this._activeTime)?["hours","minutes","meridiem"]:["hours","minutes"]}_prevPart(){const t=this._getOrderedParts(),e=t.indexOf(this._activePart)-1;return t[Math.max(e,0)]}_nextPart(){const t=this._getOrderedParts(),e=t.indexOf(this._activePart)+1;return t[Math.min(e,t.length-1)]}_setTime(t,e,i){if("hours"===e){const e=_(t)?12:24,s=""+t.hour()%e,r=i,a=Number(`${s}${i}`);2===s.length||a>e?t.hour(r):a<=e&&t.hour(a);}else if("minutes"===e){const e=59,s=`${t.minute()}`,r=i,a=Number(`${s}${i}`);2===s.length||a>e?t.minute(r):a<e&&t.minute(a);}}_handleInputPaste(t){const e=t.clipboardData.getData("text/plain"),i=this._moment(e);i.isValid()&&(this._activeTime=i),t.preventDefault(),t.stopImmediatePropagation();}_handleInputWheel(t){const e=t.deltaY<0?"up":"down";this._shift(e,this._activeTime,this._activePart);}_shift(t,e,i){if(!t||!e||!i)return;const s="meridiem"===i?12:1,r="hours"===i?"hour":"minutes"===i?"minute":"hours";e["up"===t?"add":"subtract"](s,r);}};request.e([request.d({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],v$2.prototype,"label",void 0),request.e([request.d(),request.e$1("esri/widgets/support/t9n/TimePicker")],v$2.prototype,"messages",void 0),request.e([request.o("viewModel.value")],v$2.prototype,"value",void 0),request.e([request.d({type:t$1})],v$2.prototype,"viewModel",void 0),v$2=request.e([request.i("esri.widgets.support.TimePicker")],v$2);const f$4=v$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let p$6=class extends(Identifiable.r(request.a$2)){constructor(t){super(t),this.autoNavigate=null,this.filter=null,this.getResults=null,this.getSuggestions=null,this.maxResults=null,this.maxSuggestions=null,this.minSuggestCharacters=null,this.outFields=null,this.placeholder="",this.popupEnabled=null,this.popupTemplate=null,this.prefix="",this.resultGraphicEnabled=null,this.resultSymbol=null,this.suggestionsEnabled=null,this.suffix="",this.withinViewEnabled=!1,this.zoomScale=null;}};request.e([request.d()],p$6.prototype,"autoNavigate",void 0),request.e([request.d()],p$6.prototype,"filter",void 0),request.e([request.d()],p$6.prototype,"getResults",void 0),request.e([request.d()],p$6.prototype,"getSuggestions",void 0),request.e([request.d()],p$6.prototype,"maxResults",void 0),request.e([request.d()],p$6.prototype,"maxSuggestions",void 0),request.e([request.d()],p$6.prototype,"minSuggestCharacters",void 0),request.e([request.d()],p$6.prototype,"outFields",void 0),request.e([request.d()],p$6.prototype,"placeholder",void 0),request.e([request.d()],p$6.prototype,"popupEnabled",void 0),request.e([request.d()],p$6.prototype,"popupTemplate",void 0),request.e([request.d()],p$6.prototype,"prefix",void 0),request.e([request.d()],p$6.prototype,"resultGraphicEnabled",void 0),request.e([request.d()],p$6.prototype,"resultSymbol",void 0),request.e([request.d()],p$6.prototype,"suggestionsEnabled",void 0),request.e([request.d()],p$6.prototype,"suffix",void 0),request.e([request.d()],p$6.prototype,"withinViewEnabled",void 0),request.e([request.d()],p$6.prototype,"zoomScale",void 0),p$6=request.e([request.i("esri.widgets.Search.SearchSource")],p$6);const i$4=p$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const o$1=request.s$1.getLogger("esri.widgets.Search.support.geometryUtils");function s(r,t){var n,i;if(!t)return o$1.error("missing-parameter: view is missing."),Promise.reject(new request.s("searchgeometryutils:missing-parameter","view is missing."));if(!r)return o$1.error("missing-parameter: point is missing."),Promise.reject(new request.s("searchgeometryutils:missing-parameter","point is missing."));if(r.hasZ||"2d"===t.type)return Promise.resolve(r);const s=null==t||null==(n=t.map)?void 0:n.ground;return s&&s.layers.length?s.queryElevation(r,{cache:null==(i=t.basemapTerrain)?void 0:i.elevationQueryCache}).then((e=>e.geometry)):Promise.resolve(r)}function m$2(e){if(request.t$1(e))return null;switch(e.type){case"point":return e;case"extent":return e.center;case"polygon":return e.centroid;case"multipoint":return e.getPoint(0);case"polyline":return e.getPoint(0,0)}return null}function a$2(e,r,n){return request.t$1(e)?null:"extent"===e.type?e:"multipoint"===e.type||"polygon"===e.type||"polyline"===e.type?e.extent:"point"===e.type?l$3(e,r,n):void 0}function p$5(e,r,n){return request.t$1(e)||request.t$1(r)?null:l$3(e.center,r,n)}function l$3(e,r,t){const o=e.hasZ?e.z:void 0;if(r&&r.map){return (t?scaleUtils.c(r,t):r.extent).clone().centerAt(e).set({zmax:o,zmin:o})}return new request.M({xmin:e.x-.25,ymin:e.y-.25,xmax:e.x+.25,ymax:e.y+.25,spatialReference:e.spatialReference,zmin:o,zmax:o})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$5=/https?:\/\/services.*\.arcgis\.com/i,d$6=/(?:\{([^}]+)\})/g,f$3=request.s$1.getLogger("esri.widgets.Search.support.layerSearchUtils");function m$1(t,r){const{exactMatch:i=!1,location:l,maxResults:o,spatialReference:s,source:u,sourceIndex:a,suggestResult:c,view:d}=t,{layer:m,filter:g,zoomScale:F}=u,b=d&&d.scale,j=p$4(u,d),T=r&&r.signal;return h$3(m).then((()=>{const e=m.popupTemplate;return e?e.getRequiredFields(m.fieldsIndex):null})).then((t=>{var r,p;const{objectIdField:h,returnZ:R}=m,S=x$1(u);if(!$$2(m,S))throw f$3.error("invalid-field: displayField is invalid."),new request.s("getResults():invalid-field","displayField is invalid.");const D=t&&t.length?t:[S],E=u.outFields||D,M=y$3(E);-1!==E.indexOf(h)||M||E.push(h);if(!(M||w$3(m,E)))throw f$3.error("invalid-field: outField is invalid."),new request.s("getResults():invalid-field","outField is invalid.");const O=m.createQuery(),{orderByFields:C}=u;if(C&&(O.orderByFields=C),s){O.outSpatialReference=s;const e=1/unitUtils.H(s);e&&(O.maxAllowableOffset=e);}const N="mesh"===m.geometryType||"multipatch"===m.geometryType,U=(null==(r=m.capabilities)||null==(p=r.data)?void 0:p.supportsZ)&&!N;if(O.returnZ=U&&!1!==R,O.returnGeometry=!0,O.multipatchOption=N?"xyFootprint":null,E&&(O.outFields=E),l)O.geometry=l;else if(c.key)O.objectIds=[c.key];else {const t=u.searchFields||[S];if(!w$3(m,t))throw f$3.error("invalid-field: search field is invalid."),new request.s("getResults():invalid-field","search field is invalid.");v$1(m)&&(O.num=o),j&&(O.geometry=j);if(!c.text.trim())return [];const{prefix:r="",suffix:n=""}=u,l=L$1({searchTerm:I$1(`${r}${c.text}${n}`),layer:m,searchFields:t,filter:g,exactMatch:i,type:"search"});if(!l)return [];O.where=l;}return m.queryFeatures(O,{signal:T}).then((e=>k(e,d,u,a,S,b,F)))}))}function g$2(t,r){const{source:i,spatialReference:n,view:l,suggestTerm:o,maxSuggestions:s,sourceIndex:u,exactMatch:a}=t,{layer:c,filter:m}=i,g=r&&r.signal,F=p$4(i,l);return h$3(c).then((()=>{if(!v$1(c))return [];const t=x$1(i),r=i.searchFields||[t],l=[];i.suggestionTemplate?i.suggestionTemplate.replace(d$6,((e,t)=>(l.push(t),e))):l.push(t);const p=y$3(l);-1!==l.indexOf(c.objectIdField)||p||l.push(c.objectIdField);const h=$$2(c,t),b=p||w$3(c,l),j=w$3(c,r);if(!h)throw f$3.error("invalid-field: displayField is invalid."),new request.s("getSuggestions():invalid-field","displayField is invalid.");if(!b)throw f$3.error("invalid-field: outField is invalid."),new request.s("getSuggestions():invalid-field","outField is invalid.");if(!j)throw f$3.error("invalid-field: search field is invalid."),new request.s("getSuggestions():invalid-field","search field is invalid.");const T=c.createQuery(),{orderByFields:R}=i;R&&(T.orderByFields=R),T.outSpatialReference=n,T.returnGeometry=!1,T.num=s,T.outFields=l,F&&(T.geometry=F);if(!o.trim())return [];const{prefix:S="",suffix:D=""}=i,E=L$1({searchTerm:I$1(`${S}${o}${D}`),layer:c,searchFields:r,filter:m,exactMatch:a,type:"suggest"});return E?(T.where=E,c.queryFeatures(T,{signal:g}).then((e=>C(e,i,u,t)))):[]}))}function p$4(e,t){const{filter:r,withinViewEnabled:i}=e,n=t&&t.extent;return r&&r.geometry||(i&&n?n:void 0)}function y$3(e){return e&&-1!==e.indexOf("*")}async function h$3(e){e&&await e.load();}function v$1(e){var t,r,i;return null!=(t=null==e||null==(r=e.capabilities)||null==(i=r.query)?void 0:i.supportsPagination)&&t}function F(e){var t,r,i,n;return null!=(t=null==e||null==(r=e.fieldsIndex)||null==(i=r.fields)||null==(n=i.find((e=>"string"===e.type)))?void 0:n.name)?t:""}function x$1(e){return e.displayField||e.layer.displayField||F(e.layer)}function w$3(e,t){return !(!e||!t)&&t.every((t=>$$2(e,t)))}function $$2(e,t){return !!e.getField(t)}function b$1(e){for(let t=0;t<e.length;t++)if(e.charCodeAt(t)>255)return !0;return !1}function j$2(e,t,r){let i=null;const{codedValues:n}=e;return n&&n.some((e=>{const n=e.name,l=r?n:n.toLowerCase();return (r?t:t.toLowerCase())===l&&(i=e.code.toString(),!0)})),i}function I$1(e){return e.replace(/\'/g,"''")}function T(e,t){const r=t&&t.where;return r?`(${e}) AND (${r})`:e}function R({currentTerm:e,field:t,filter:r,exactMatch:i,url:n,type:l}){const o=t.type,s=t.name;if("string"===o||"date"===o||"global-id"===o){const t=c$5.test(n),o=t&&b$1(e)?"N":"";if(i&&"search"===l)return T(`${s} = ${o}'${e}'`,r);const u=t?s:`UPPER(${s})`,a=t?e:e.toUpperCase();return T(`${u} LIKE ${o}${i?`'${a}%'`:`'%${a}%'`}`,r)}if("oid"===o||"small-integer"===o||"integer"===o||"single"===o||"double"===o){const t=Number(e);return isNaN(t)?null:T(`${s} = ${t}`,r)}return T(`${s} = ${e}`,r)}function S$2(e,t){return e?` OR (${t})`:`(${t})`}function L$1({searchTerm:e,layer:t,searchFields:r,filter:i,exactMatch:n,type:l}){const{definitionExpression:o,url:s}=t;let u="";return e&&r&&r.forEach((r=>{const o=t.getField(r),a="function"==typeof t.getFieldDomain&&t.getFieldDomain(r),c=(a&&"coded-value"===a.type?j$2(a,e,n):null)||e||null;if(null!==c){const e=R({currentTerm:c,field:o,filter:i,exactMatch:n,url:s,type:l});e&&(u+=S$2(u,e));}})),o?`(${o}) AND (${u})`:u}function D(e,t){let r=null;const{codedValues:i}=e;return i&&i.length&&i.some((e=>e.code===t&&(r=e.name,!0))),r}function E(e,t){return e[Object.keys(e).find((e=>e.toLowerCase()===t.toLowerCase()))]}function M(e,t,r){const i=e.sourceLayer,{attributes:n}=e,l="function"==typeof i.getFieldDomain&&i.getFieldDomain(r);if(t)return request.s$2(t,n);if(r&&n){const e=i.getField(r),t=E(n,r);return null==t?"":l&&"coded-value"===l.type?D(l,t):"date"===(null==e?void 0:e.type)?request.L$1(new Date(t)):"number"==typeof t?t.toString():"string"!=typeof t?"":t.trim()}return ""}function O(e,t,r,i){const n=e.sourceLayer,{attributes:l}=e,{objectIdField:o}=n,s=l[o];return {text:M(e,t.suggestionTemplate,i),key:s,sourceIndex:r}}function C(e,t,r,i){return e.features.map((e=>O(e,t,r,i)))}function N(e,r,n,u,a,c,d){const f=e.clone(),m=e.sourceLayer,g=m&&m.objectIdField,p=g&&e.attributes[g],y=M(e,n.searchTemplate,a),h=a$2(f.geometry,r,c),v="number"==typeof d?p$5(request.l$1(h),r,d):h,F=e.clone();return request.r(v)&&(F.geometry=geometry.v.fromExtent(v)),{extent:v,target:F,feature:f,key:p,name:y,sourceIndex:u}}function k(e,t,r,i,n,l,o){return e.features.map((e=>N(e,t,r,i,n,l,o)))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var o;let n$6=o=class extends i$4{constructor(e){super(e),this.displayField=null,this.exactMatch=null,this.orderByFields=null,this.searchFields=null,this.searchTemplate=null,this.suggestionTemplate=null,this.getResults=(e,t)=>m$1({source:this,...e},t),this.getSuggestions=(e,t)=>g$2({source:this,...e},t);}set layer(e){this._set("layer",e),e&&e.load().catch((()=>{}));}get name(){return this._getLayerTitle()||""}set name(e){void 0!==e?this._override("name",e):this._clearOverride("name");}clone(){return new o({autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?request.l$1(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?request.l$1(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){var e,t;return null!=(e=null==(t=this.layer.fieldsIndex.fields.find((e=>"string"===e.type)))?void 0:t.name)?e:""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const{layer:e,searchFields:t}=this;if(!e.loaded)return "";return `: ${(t||[this._getDisplayField()]).map((t=>{const s=e.getField(t);return s&&s.alias||t})).join(", ")}`}_getLayerTitle(){const{layer:e}=this;if(!e)return;const{title:t}=e;return t?`${t}${this._getSearchFieldsString()}`:void 0}};request.e([request.d({json:{read:{source:"field.name"},write:{target:"field.name"}}})],n$6.prototype,"displayField",void 0),request.e([request.d({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],n$6.prototype,"exactMatch",void 0),request.e([request.d({value:null})],n$6.prototype,"layer",null),request.e([request.d()],n$6.prototype,"name",null),request.e([request.d({type:[String],json:{write:!0}})],n$6.prototype,"orderByFields",void 0),request.e([request.d()],n$6.prototype,"searchFields",void 0),request.e([request.d()],n$6.prototype,"searchTemplate",void 0),request.e([request.d()],n$6.prototype,"suggestionTemplate",void 0),n$6=o=request.e([request.i("esri.widgets.Search.LayerSearchSource")],n$6);const h$2=n$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function n$5(n){return n&&"number"==typeof n.x&&"number"==typeof n.y}function e$1(n){return n&&"number"==typeof n.xmin&&"number"==typeof n.ymin&&"number"==typeof n.xmax&&"number"==typeof n.ymax}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let i$3=class extends request.a$2{constructor(t){super(t),this.address=null,this.attributes=null,this.extent=null,this.location=null,this.score=null;}};request.e([request.d({type:String,json:{write:!0}})],i$3.prototype,"address",void 0),request.e([request.d({type:Object,json:{write:!0}})],i$3.prototype,"attributes",void 0),request.e([request.d({type:request.M,json:{write:!0}})],i$3.prototype,"extent",void 0),request.e([request.d({type:request.b$2,json:{write:!0}})],i$3.prototype,"location",void 0),request.e([request.d({type:Number,json:{write:!0}})],i$3.prototype,"score",void 0),i$3=request.e([request.i("esri.rest.support.AddressCandidate")],i$3);const c$4=i$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const t={type:String,json:{read:{source:"token"},write:{target:"token"}}};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let l$2=class extends request.a$2{constructor(t){super(t),this.address=null,this.apiKey=null,this.categories=null,this.countryCode=null,this.forStorage=null,this.location=null,this.locationType=null,this.magicKey=null,this.maxLocations=null,this.outFields=null,this.outSpatialReference=null,this.searchExtent=null;}};request.e([request.d({type:Object,json:{write:!0}})],l$2.prototype,"address",void 0),request.e([request.d(t)],l$2.prototype,"apiKey",void 0),request.e([request.d({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,o)=>{o.category=t?t.join(","):null;}}}})],l$2.prototype,"categories",void 0),request.e([request.d({type:String,json:{write:!0}})],l$2.prototype,"countryCode",void 0),request.e([request.d({type:Boolean,json:{write:!0}})],l$2.prototype,"forStorage",void 0),request.e([request.d({type:request.b$2,json:{write:{writer:(t,o)=>{o.location=t?t.clone().normalize():null;}}}})],l$2.prototype,"location",void 0),request.e([request.d({type:String,json:{write:!0}})],l$2.prototype,"locationType",void 0),request.e([request.d({type:String,json:{write:!0}})],l$2.prototype,"magicKey",void 0),request.e([request.d({type:Number,json:{write:!0}})],l$2.prototype,"maxLocations",void 0),request.e([request.d({type:[String],json:{write:{writer:(t,o)=>{o.outFields=t?t.join(","):null;}}}})],l$2.prototype,"outFields",void 0),request.e([request.d({type:request.k,json:{read:{source:"outSR"},write:{target:"outSR"}}})],l$2.prototype,"outSpatialReference",void 0),request.e([request.d({type:request.M,json:{write:{writer:(t,o)=>{const e=t?t.shiftCentralMeridian():null;o.searchExtent=e;}}}})],l$2.prototype,"searchExtent",void 0),l$2=request.e([request.i("esri.rest.support.AddressToLocationsParameters")],l$2),l$2.from=request.b(l$2);const c$3=l$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
async function d$5(o,n,a){n=c$3.from(n);const d=utils.e(o),{address:p,...m}=n.toJSON(),u={...p,...m,f:"json"},c=utils.n({...d.query,...u}),j=utils.r(c,a),l=`${d.path}/findAddressCandidates`;return request.E(l,j).then(f$2)}function f$2({data:r}){if(!r)return [];const{candidates:t,spatialReference:e}=r;return t?t.map((r=>{if(!r)return;const{extent:t,location:s}=r,i=!t||e$1(t);return n$5(s)&&i?(t&&(t.spatialReference=e),s.spatialReference=e,c$4.fromJSON(r)):void 0})):[]}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let p$3=class extends request.a$2{constructor(r){super(r),this.addresses=null,this.categories=null,this.countryCode=null,this.locationType=null,this.outSpatialReference=null;}};request.e([request.d({type:[Object],json:{read:{reader:r=>r&&r.records?r.records.map((r=>r.attributes)):null},write:{writer:(r,e)=>{const o=[];Array.isArray(r)&&r.forEach((r=>{o.push({attributes:r});})),e.addresses={records:o};}}}})],p$3.prototype,"addresses",void 0),request.e([request.d({type:[String],json:{read:{source:"category",reader:r=>r?r.split(","):null},write:{target:"category",writer:(r,e)=>{e.category=r?r.join(","):null;}}}})],p$3.prototype,"categories",void 0),request.e([request.d({type:String,json:{read:{source:"sourceCountry"},write:{target:"sourceCountry"}}})],p$3.prototype,"countryCode",void 0),request.e([request.d({type:String,json:{write:!0}})],p$3.prototype,"locationType",void 0),request.e([request.d({type:request.k,json:{read:{source:"outSR"},write:{target:"outSR"}}})],p$3.prototype,"outSpatialReference",void 0),p$3=request.e([request.i("esri.rest.support.AddressesToLocationsParameters")],p$3),p$3.from=request.b(p$3);const i$2=p$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
async function a$1(s,a,c){a=i$2.from(a);const p=utils.e(s),f={...a.toJSON(),f:"json"},m=utils.n({...p.query,...f}),u=utils.r(m,c),d=`${p.path}/geocodeAddresses`;return request.E(d,u).then(i$1)}function i$1(o){const{data:r}=o;if(!r)return [];const{locations:t,spatialReference:e}=r;return t?t.map((o=>{const{location:r}=o;return r&&(r.spatialReference=e),c$4.fromJSON(o)})):[]}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let a=class extends request.a$2{constructor(o){super(o),this.apiKey=null,this.location=null,this.locationType=null,this.outSpatialReference=null;}};request.e([request.d(t)],a.prototype,"apiKey",void 0),request.e([request.d({type:request.b$2,json:{write:{writer:(o,r)=>{const t=o?o.clone().normalize():null,e=void 0!==t;r.location=e?t:null;}}}})],a.prototype,"location",void 0),request.e([request.d({type:String,json:{write:!0}})],a.prototype,"locationType",void 0),request.e([request.d({type:request.k,json:{read:{source:"outSR"},write:{target:"outSR"}}})],a.prototype,"outSpatialReference",void 0),a=request.e([request.i("esri.rest.support.LocationToAddressParameters")],a),a.from=request.b(a);const n$4=a;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
async function n$3(e,n,i){n=n$4.from(n);const c=utils.e(e),m={...n.toJSON(),f:"json"},u=utils.n({...c.query,...m}),f=utils.r(u,i),p=`${c.path}/reverseGeocode`;return request.E(p,f).then(d$4)}function d$4({data:r}){if(!r)return;const{address:o,location:t}=r,s=o&&o.Match_addr||"";return c$4.fromJSON({address:s,attributes:o||{},location:t,score:100})}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let e=class extends request.a$2{constructor(o){super(o),this.isCollection=null,this.magicKey=null,this.text=null;}};request.e([request.d({type:Boolean,json:{write:!0}})],e.prototype,"isCollection",void 0),request.e([request.d({type:String,json:{write:!0}})],e.prototype,"magicKey",void 0),request.e([request.d({type:String,json:{write:!0}})],e.prototype,"text",void 0),e=request.e([request.i("esri.rest.support.SuggestionCandidate")],e);const p$2=e;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let c$2=class extends request.a$2{constructor(t){super(t),this.apiKey=null,this.categories=null,this.countryCode=null,this.location=null,this.maxSuggestions=null,this.outSpatialReference=null,this.searchExtent=null,this.text=null;}};request.e([request.d(t)],c$2.prototype,"apiKey",void 0),request.e([request.d({type:[String],json:{read:{source:"category",reader:t=>t?t.split(","):null},write:{target:"category",writer:(t,o)=>{o.category=t?t.join(","):null;}}}})],c$2.prototype,"categories",void 0),request.e([request.d({type:String,json:{write:!0}})],c$2.prototype,"countryCode",void 0),request.e([request.d({type:request.b$2,json:{write:{writer:(t,o)=>{o.location=t?t.clone().normalize():null;}}}})],c$2.prototype,"location",void 0),request.e([request.d({type:Number,json:{write:!0}})],c$2.prototype,"maxSuggestions",void 0),request.e([request.d({type:request.k,json:{read:{source:"outSR"},write:{target:"outSR"}}})],c$2.prototype,"outSpatialReference",void 0),request.e([request.d({type:request.M,json:{write:{writer:(t,o)=>{const e=t?t.shiftCentralMeridian():null;o.searchExtent=JSON.stringify(e);}}}})],c$2.prototype,"searchExtent",void 0),request.e([request.d({type:String,json:{write:!0}})],c$2.prototype,"text",void 0),c$2=request.e([request.i("esri.rest.support.SuggestLocationsParameters")],c$2),c$2.from=request.b(c$2);const l$1=c$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
async function u$3(n,u,m){const p=utils.e(n),a={...(u=l$1.from(u)).toJSON(),f:"json"},f=utils.n({...p.query,...a}),g=utils.r(f,m),c=`${p.path}/suggest`;return request.E(c,g).then(i)}function i(t){const{data:o}=t;if(!o)return [];const{suggestions:r}=o;return r?r.map((t=>new p$2(t))):[]}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let n$2=class extends Task.l{constructor(t){super(t),this.outSpatialReference=null,this.url=null;}addressToLocations(t,e){!t.outSpatialReference&&this.outSpatialReference&&(t.outSpatialReference=this.outSpatialReference);const o={...this.requestOptions,...e};return d$5(this.url,t,o)}suggestLocations(t,e){const o={...this.requestOptions,...e};return u$3(this.url,t,o)}addressesToLocations(t,e){!t.outSpatialReference&&this.outSpatialReference&&(t.outSpatialReference=this.outSpatialReference);const o={...this.requestOptions,...e};return a$1(this.url,t,o)}locationToAddress(t,e){!t.outSpatialReference&&this.outSpatialReference&&(t.outSpatialReference=this.outSpatialReference);const o={...this.requestOptions,...e};return n$3(this.url,t,o)}};request.e([request.d({type:request.k})],n$2.prototype,"outSpatialReference",void 0),request.e([request.d()],n$2.prototype,"url",void 0),n$2=request.e([request.i("esri.tasks.Locator")],n$2);const u$2=n$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const f$1="Single Line Input",d$3=3e5;function g$1(e,o){return e.location?j$1(e,o):$$1(e,o)}function p$1(e){const o=null==e?void 0:e.scale;return "number"==typeof o&&o<=d$3?e.get("extent.center"):null}function y$2(e,t){const{source:r,spatialReference:s,view:n,suggestTerm:c,maxSuggestions:a,sourceIndex:l}=e,m=new l$1,{apiKey:f,url:d}=r,g=I(r,n),y=t&&t.signal;if(!d)return Promise.resolve(null);f&&(m.apiKey=f),r.categories&&(m.categories=r.categories),s&&(m.outSpatialReference=s);const x=p$1(n);x&&(m.location=x);if(!c.trim())return Promise.resolve(null);const{prefix:v="",suffix:S=""}=r,w=`${v}${c}${S}`;return m.text=w,g&&(m.searchExtent=request.e$2(g)),m.maxSuggestions=a,r.countryCode&&(m.countryCode=r.countryCode),u$3(d,m,{signal:y}).then((e=>K$1(e,l)))}function x(e){return !!e&&/(?:geocode\-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi.test(e)}function v(e){return !!e&&/(?:\/servers\/[\da-z\.-]+\/rest\/services\/world\/geocodeserver).*/gi.test(e)}function S$1(e){return !!e&&/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/gi.test(e)}const w$2="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";function j$1(e,o){const{source:t,spatialReference:r,location:s,sourceIndex:i,view:c}=e,{apiKey:u,url:l,zoomScale:m,defaultZoomScale:f}=t,d=c&&c.scale,g=o&&o.signal,p=new n$4;return p.location=s,u&&(p.apiKey=u),r&&(p.outSpatialReference=r),n$3(l,p,{signal:g}).then((e=>P$1([e],{sourceIndex:i,scale:d,view:c,zoomScale:m,defaultZoomScale:f})))}function I(e,o){const{filter:t,withinViewEnabled:r}=e,s=o&&o.scale,n=o&&o.extent,i=t&&t.geometry;return a$2(i,o,s)||(r&&n?n:void 0)}function $$1(e,t){const{source:r,suggestResult:n,spatialReference:i,view:a,maxResults:u,sourceIndex:l}=e,m=r&&r.zoomScale,d=r&&r.defaultZoomScale;if(!n.text.trim())return Promise.resolve(null);const g=!n.key&&r.prefix?r.prefix:"",y=!n.key&&r.suffix?r.suffix:"",x=`${g}${n.text}${y}`,v=new c$3,{apiKey:S,url:w}=r,j=a&&a.scale,$=I(r,a),h=t&&t.signal;if(S&&(v.apiKey=S),!w)return Promise.resolve(null);r.categories&&(v.categories=r.categories),r.locationType&&(v.locationType=r.locationType),i&&(v.outSpatialReference=i);const K=p$1(a);K&&(v.location=K),v.maxLocations=u,$&&(v.searchExtent=request.e$2($)),r.countryCode&&(v.countryCode=r.countryCode);const{key:L}=n,R=`${L}`;return L&&(v.magicKey=R),v.address={},v.address[r.singleLineFieldName||f$1]=x,r.outFields&&(v.outFields=r.outFields),d$5(w,v,{signal:h}).then((e=>P$1(e,{key:R,scale:j,sourceIndex:l,view:a,zoomScale:m,defaultZoomScale:d})))}function h$1(e,o){return {text:e.text,key:e.magicKey,sourceIndex:o}}function K$1(e,o){return e.map((e=>h$1(e,o)))}function L(o,s){const{key:n,scale:i,sourceIndex:c,view:a,zoomScale:u,defaultZoomScale:f}=s,{attributes:d,extent:g,location:p,address:y}=o,x=new Graphic.h({geometry:p,attributes:d}),v=g||p,S=a$2(v,a,i),w="number"==typeof u?p$5(S,a,u):"number"==typeof f&&"point"===v.type?p$5(S,a,f):S,j=p?`${p.x},${p.y}`:"",I=y||j,$=x.clone();return request.r(w)&&($.geometry=geometry.v.fromExtent(w)),{extent:w,feature:x,target:$,key:n,name:I,sourceIndex:c}}function P$1(e,o){return e.filter(Boolean).map((e=>L(e,o)))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var n$1;const u$1="esri.widgets.Search.LocatorSearchSource",h=request.s$1.getLogger(u$1);let d$2=n$1=class extends i$4{constructor(e){super(e),this.apiKey=null,this.categories=null,this.countryCode=null,this.defaultZoomScale=null,this.locationType=null,this.name="",this.placeholder="",this.searchTemplate="",this.singleLineFieldName=null,this.suggestionsEnabled=null,this.url=null,this.zoomScale=null,this.getResults=(e,t)=>g$1({source:this,...e},t),this.getSuggestions=(e,t)=>y$2({source:this,...e},t);}set locator(e){request.r$3(h,"locator",{replacement:"url",version:"4.22"}),this._set("url",e.url),this._set("locator",e);}get locator(){return request.r$3(h,"locator",{replacement:"url",version:"4.22"}),this._get("locator")}clone(){return new n$1({apiKey:this.apiKey,autoNavigate:this.autoNavigate,filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?request.l$1(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?request.l$1(this.categories):null,countryCode:this.countryCode,locationType:this.locationType,locator:this.locator,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};request.e([request.d()],d$2.prototype,"apiKey",void 0),request.e([request.d()],d$2.prototype,"categories",void 0),request.e([request.d()],d$2.prototype,"countryCode",void 0),request.e([request.d({json:{write:!0}})],d$2.prototype,"defaultZoomScale",void 0),request.e([request.d({type:u$2,json:{read:!1,write:!1}})],d$2.prototype,"locator",null),request.e([request.d()],d$2.prototype,"locationType",void 0),request.e([request.d({json:{write:!0}})],d$2.prototype,"name",void 0),request.e([request.d({json:{write:!0}})],d$2.prototype,"placeholder",void 0),request.e([request.d()],d$2.prototype,"searchTemplate",void 0),request.e([request.d({json:{write:!0}})],d$2.prototype,"singleLineFieldName",void 0),request.e([request.d({json:{read:{source:"suggest"},write:{target:"suggest"}}})],d$2.prototype,"suggestionsEnabled",void 0),request.e([request.d({json:{write:!0}})],d$2.prototype,"url",void 0),request.e([request.d({json:{write:!0}})],d$2.prototype,"zoomScale",void 0),d$2=n$1=request.e([request.i(u$1)],d$2);const m=d$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const u=request.s$1.getLogger("esri.widgets.support.geolocationUtils"),c$1={maximumAge:0,timeout:15e3,enableHighAccuracy:!0};function p(){const e=request.s$3("esri-geolocation");return e||u.warn("geolocation-unsupported","Geolocation unsupported."),e}function l(){const e=window.isSecureContext;return e||u.warn("insecure-context","Geolocation requires a secure origin."),e}function g(){return p()&&l()}function f(e){const r=15e3;return e||(e=c$1),new Promise(((o,i)=>{setTimeout((()=>i(new request.s("geolocation:timeout","getting the current geolocation position timed out"))),r),navigator.geolocation.getCurrentPosition(o,i,e);}))}function j(e,t){const{position:r,view:o}=e;return P(y$1(d$1(r)),o,t)}function d$1(e){const t=e&&e.coords||{},r={accuracy:t.accuracy,altitude:t.altitude,altitudeAccuracy:t.altitudeAccuracy,heading:t.heading,latitude:t.latitude,longitude:t.longitude,speed:t.speed};return e?{coords:r,timestamp:e.timestamp}:e}function y$1(e){const t=e&&e.coords;return t?new request.b$2({longitude:t.longitude,latitude:t.latitude,z:t.altitude||null,spatialReference:{wkid:4326}}):null}function P(e,r,o){if(!r)return Promise.resolve(e);const i=r.spatialReference;return i.isWGS84?Promise.resolve(e):i.isWebMercator?Promise.resolve(request.R(e)):w$1(o).then((r=>{if(!r)throw new request.s("geometry-service:missing-url","Geometry service URL is missing");const s=new project.a({geometries:[e],outSpatialReference:i});return project.n(r,s,o).then((e=>e[0]))}))}function w$1(t){if(request.t.geometryServiceUrl)return Promise.resolve(request.t.geometryServiceUrl);const r=Portal.B.getDefault();return r.load(t).catch((()=>{})).then((()=>r.get("helperServices.geometry.url")))}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function Z(e,t){return e.hasOwnProperty(t)&&null!=e[t]&&""!==e[t]}const q=()=>request.u$2("esri/widgets/Search/t9n/Search"),z="esri.widgets.Search.SearchViewModel",K=request.s$1.getLogger(z),W="highlight",X=request.S.ofType({key:e=>e.layer?"layer":"locator",base:i$4,typeMap:{layer:h$2,locator:m}}),Y=request.k.WGS84,$="esri/images/search/search-symbol-32.svg",ee="esri/images/search/search-symbol-32.png",te=/<(?:.|\s)*?>/g,se=-1;let re=class extends(GoTo.e(request.n$2.EventedMixin(request.p))){constructor(e){super(e),this._handles=new request.u,this._gotoController=null,this._searching=null,this.autoNavigate=!0,this.autoSelect=!0,this.defaultPopupTemplate=null,this.defaultSources=new X,this.defaultSymbols={point:new SimpleLineSymbol.n({url:request.a$1(request.s$3("trident")?ee:$),size:24,width:24,height:24}),polyline:new SimpleLineSymbol.m({color:[130,130,130,1],width:2}),polygon:new SimpleLineSymbol.S({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})},this.includeDefaultSources=!0,this.maxInputLength=128,this.maxResults=6,this.maxSuggestions=6,this.messages=null,this.minSuggestCharacters=3,this.popupEnabled=!0,this.popupTemplate=null,this.portal=Portal.B.getDefault(),this.resultCount=null,this.resultGraphicEnabled=!0,this.resultGraphic=null,this.results=null,this.selectedSuggestion=null,this.searchAllEnabled=!0,this.selectedResult=null,this.sources=new X,this.suggestionDelay=350,this.suggestionCount=null,this.suggestions=null,this.suggestionsEnabled=!0,this.view=null;}initialize(){const e=async()=>{const e=await q();this.messages=e,this.defaultPopupTemplate=new PopupTemplate.M({title:e.searchResult,content:"{Match_addr}"});};e(),this._handles.add([request.$(this,["defaultSources","sources"],"change",(()=>this.notifyChange("allSources"))),request.i$1(this,["includeDefaultSources","view","portal"],(()=>this._update())),request.g(e)]);}destroy(){this._abortGoTo(),this.clearGraphics(),this._handles.destroy(),this._handles=null;}get activeSource(){return this.allSources.getItemAt(this.activeSourceIndex)||null}get activeSourceIndex(){return 1===this.allSources.length||!this.searchAllEnabled?0:se}set activeSourceIndex(e){void 0!==e?this._override("activeSourceIndex",e):this._clearOverride("activeSourceIndex");}get allPlaceholder(){var e;return null==(e=this.messages)?void 0:e.allPlaceholder}set allPlaceholder(e){e?this._override("allPlaceholder",e):this._clearOverride("allPlaceholder");}get allSources(){const{sources:e,defaultSources:t,includeDefaultSources:s}=this,r="function"==typeof s?s.call(null,{sources:e,defaultSources:t}):s?t.concat(e):e,o=this._get("allSources")||new X;return o.removeAll(),o.addMany(r.filter(Boolean)),o}get defaultSymbol(){return request.r$3(K,"defaultSymbol",{replacement:"defaultSymbols",version:"4.22"}),this._get("defaultSymbol")}set defaultSymbol(e){request.r$3(K,"defaultSymbol",{replacement:"defaultSymbols",version:"4.22"}),this._set("defaultSymbol",e);}get locationEnabled(){return this._get("locationEnabled")||g()}set locationEnabled(e){if(void 0===e)return void this._clearOverride("locationEnabled");const t=g();if(e&&!t){const e=new request.s("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});K.error(e);}this._override("locationEnabled",e&&t);}get placeholder(){const{allSources:e,activeSourceIndex:t,allPlaceholder:s}=this;if(t===se)return s;const r=e.getItemAt(t);return r?r.placeholder:""}set searchTerm(e){this._set("searchTerm",e||""),this.clearGraphics(),this.selectedSuggestion&&this.selectedSuggestion.text!==e&&this._set("selectedSuggestion",null),""===e&&this._clear();}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":0===this.allSources.length?"disabled":"ready"}get updating(){return null!=this._updatingPromise}clear(){this.searchTerm="";}clearGraphics(){this._removeHighlight(),this._closePopup(),this.view&&this.view.graphics.remove(this.resultGraphic),this._set("resultGraphic",null);}search(e,t){this.emit("search-start"),this.clearGraphics();const s=this._createSuggestionForSearch(e),r=this.when().then((()=>this._getResultsFromSources(s,t).then((e=>{var r;if(null!=(r=request.e$2(null==t?void 0:t.signal))&&r.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:s.text,numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(o,e,s);const l=this._getFirstResult(o.results),i=(s.location&&l?l.name:s.text).replace(te,"");return this._set("searchTerm",i),(s.key&&"number"==typeof s.sourceIndex||s.location)&&this._set("selectedSuggestion",s),this._set("results",o.results),this._set("resultCount",o.results.reduce(((e,t)=>e+t.results.length),0)),this.emit("search-complete",o),this._selectFirstResult(l).then((()=>o))})))).then((e=>(this._clearSearching(),e)),(e=>{throw this._clearSearching(),e}));return this._searching=r,this.notifyChange("state"),r}searchNearby(e){if(!this.locationEnabled){const e=new request.s("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});return K.error(e),Promise.reject(e)}const t=f().then((t=>j({position:t,view:this.view},e))).then((t=>this.search(t,e)));return this._searching=t,this.notifyChange("state"),t.catch((()=>{})).then((()=>this._clearSearching())),t}select(e){if(this.clearGraphics(),!e){const t=new request.s("select:missing-parameter","Cannot select without a searchResult.",{searchResult:e});return K.error(t),Promise.reject(t)}const{view:t}=this,s$1=Z(e,"sourceIndex")?e.sourceIndex:this._getSourceIndexOfResult(e),o=this.allSources.getItemAt(s$1);if(!o){const e=new request.s("select:missing-source","Cannot select without a source.",{source:o});return K.error(e),Promise.reject(e)}const l=o instanceof h$2?this._getLayerSourcePopupTemplate(o):o.popupTemplate,i=o.resultSymbol||this._getDefaultSymbol(e),a=Z(o,"resultGraphicEnabled")?o.resultGraphicEnabled:this.resultGraphicEnabled,u=Z(o,"autoNavigate")?o.autoNavigate:this.autoNavigate,c=Z(o,"popupEnabled")?o.popupEnabled:this.popupEnabled,h=c?l||this.popupTemplate||this.defaultPopupTemplate:null,{feature:p}=e;if(!p){const e=new request.s("select:missing-feature","Cannot select without a feature.",{feature:p});return K.error(e),Promise.reject(e)}const{attributes:d,geometry:y,layer:f,sourceLayer:S}=p,v=m$2(y),_={layerViewQuery:this._getLayerView(p),elevationQuery:t&&request.r(v)?s(v,t).catch((()=>v)):Promise.resolve(v)};return request.T(_).then((l=>{const n=l.layerViewQuery.value,m=l.elevationQuery.value;i instanceof SimpleLineSymbol.c&&(i.text=e.name);const v=t&&u?e.target||e.extent:null;return (request.r(v)?this._goToSearchResult(v):Promise.resolve()).then((()=>{var l;const u=n?p:new Graphic.h({geometry:y,symbol:i,attributes:d,layer:f,sourceLayer:S,popupTemplate:h}),g=c&&(null==(l=this.view)?void 0:l.popup),v=g&&u.getEffectivePopupTemplate(g.defaultPopupTemplateEnabled);return v&&t.popup.open({features:[u],location:m}),n&&layerViewUtils.e(n)&&!v&&this._highlightFeature({graphic:u,layerView:n}),!n&&a&&t&&t.graphics.push(u),this._set("selectedResult",e),this._set("resultGraphic",u),this.emit("select-result",{result:e,source:o,sourceIndex:s$1}),e}))}))}suggest(e,t,s){const r=e||this.searchTerm;return this.emit("suggest-start",{searchTerm:r}),this._suggestTimer(t,s).then((()=>this._suggestImmediate(r,s).then((e=>(this._set("suggestions",e.results),this._set("suggestionCount",e.results.reduce(((e,t)=>e+t.results.length),0)),this.emit("suggest-complete",e),e)))))}async when(){await request.g$1(this,"updating");}async _update(){const{portal:e,view:t}=this;if(this.includeDefaultSources){const s=this._updatingPromise=request.T([null==e?void 0:e.load(),null==t?void 0:t.when()]);if(this.destroyed)return;if(this.notifyChange("updating"),await s,s!==this._updatingPromise)return}this._updatingPromise=null,this.notifyChange("updating");const s=request.a(this,"messages");this.destroyed||(this._handles.add(s),await s,this._updateDefaultSources());}_clearSearching(){this._searching=null,this.notifyChange("state");}_convertHelperServices(){var e,t;const r=null==(e=this.portal)||null==(t=e.helperServices)?void 0:t.geocode;if(!r)return [];return r.map((e=>{if(!1===e.placefinding)return;const t=request.t.apiKey&&S$1(e.url)?{url:w$2}:null,r=m.fromJSON({...e,...t}),o=r.url;if(S$1(o)||v(o)||x(o)){const e=r.outFields||["Addr_type","Match_addr","StAddr","City"],t=r.placeholder||this.messages.placeholder,s="number"==typeof r.defaultZoomScale?r.defaultZoomScale:2500;r.set({singleLineFieldName:"SingleLine",outFields:e,placeholder:t,defaultZoomScale:s});}return r.singleLineFieldName?r:void 0})).filter(Boolean)}_getLayerSources(e,t){var s;const r=null==(s=this.view)?void 0:s.map;return e.map((e=>{const s=r.findLayerById(e.id);if(!s)return;const o=this._getLayerJSON(e),l=h$2.fromJSON(o);return l.placeholder=t,this._getLayer(s,o).then((e=>{l.layer=e;})),l})).filter(Boolean).toArray()}_getTableSources(e,t){var s;const r=null==(s=this.view)?void 0:s.map;return e.map((e=>{const s=r.findTableById(e.id);if(!s)return;const o=this._getLayerJSON(e),l=h$2.fromJSON(o);return l.placeholder=t,this._getLayer(s,o).then((e=>{l.layer=e;})),l})).filter(Boolean).toArray()}_convertApplicationProperties(){var e,t,s;const r=null==(e=this.view)?void 0:e.map,o=null==r||null==(t=r.applicationProperties)||null==(s=t.viewing)?void 0:s.search;if(!o)return [];const{enabled:l,hintText:i,layers:a,tables:n}=o;if(!l)return [];return [...this._getLayerSources(a,i),...this._getTableSources(n,i)]}_getSubLayer(e,t){return e.load().then((()=>{if(!e.allSublayers)return Promise.reject();const s=e.allSublayers.find((e=>e.id===t.subLayer));return s?s.createFeatureLayer():Promise.reject()}))}async _getBuildingSubLayer(e,t){await e.load();const s=e.allSublayers.find((e=>e.id===t.subLayer));return "building-component"!==(null==s?void 0:s.type)?Promise.reject():(await s.load(),null==s.associatedLayer?Promise.reject():(await s.associatedLayer.load(),s))}_getLayer(e,t){return "feature"===e.type||"scene"===e.type||"csv"===e.type||"geojson"===e.type||"ogc-feature"===e.type?Promise.resolve(e):"map-image"===e.type?this._getSubLayer(e,t).catch((()=>{const t=new request.s("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:e});return K.error(t),null})):"building-scene"===e.type?this._getBuildingSubLayer(e,t):Promise.resolve(null)}_getLayerJSON(e){return "function"==typeof e.toJSON?e.toJSON():e}_updateDefaultSources(){const{defaultSources:e,includeDefaultSources:t}=this;e.removeAll(),t&&e.addMany([...this._convertApplicationProperties(),...this._convertHelperServices()]),this.notifyChange("allSources");}_abortGoTo(){this._gotoController&&this._gotoController.abort(),this._gotoController=null;}_clear(){this._abortGoTo(),this._set("resultCount",null),this._set("results",null),this._set("suggestions",null),this._set("suggestionCount",null),this._set("selectedResult",null),this._set("selectedSuggestion",null),this.emit("search-clear");}_closePopup(){var e;const t=null==(e=this.view)?void 0:e.popup,{resultGraphic:s}=this;if(!t||!s)return;const{selectedFeature:r}=t;r&&r===s&&t.close();}_suggestTimer(e,t){const s=null!=e?e:this.suggestionDelay;return request.L$2(s,null,t&&t.signal)}_createLocationForSearch(e){return e instanceof Graphic.h?m$2(e.geometry):e instanceof request.b$2?e:Array.isArray(e)&&2===e.length?new request.b$2({longitude:e[0],latitude:e[1]}):null}_createSuggestionForSearch(e){if(e&&Z(e,"key")&&Z(e,"text")&&Z(e,"sourceIndex"))return e;const t=this._createLocationForSearch(e),s="string"==typeof e?e:this.searchTerm,{selectedSuggestion:r,selectedResult:o}=this,l=!e&&r&&o,i=l&&r.key===o.key&&r.sourceIndex===o.sourceIndex,a=l&&r.location;return i||a?r:{location:request.e$2(t),text:t?"":s,sourceIndex:null,key:null}}_getFirstResult(e){let t=null;return e&&e.some((e=>{const{results:s}=e,r=s[0],o=!!r;return o&&(t=r),o})),t}_selectFirstResult(e){return this.autoSelect&&e?this.select(e):Promise.resolve(null)}_suggestImmediate(e,t){return this.when().then((()=>this._getSuggestionsFromSources(e,t))).then((s=>{var r;if(null!=(r=request.e$2(null==t?void 0:t.signal))&&r.aborted)return null;const o={activeSourceIndex:this.activeSourceIndex,searchTerm:e,numResults:0,numErrors:0,errors:[],results:[]};return this._formatResponse(o,s),o}))}_formatSourceResponse(e,t,s){const r=t&&t.value||[],o=t&&t.error,l=this.allSources.getItemAt(s);if(o){const t={sourceIndex:s,source:l,error:o};e.errors.push(t),K.error(o),e.numErrors++;}else {const t={sourceIndex:s,source:l,results:r};e.results.push(t),e.numResults+=r.length;}}_formatResponse(e,t,s){if(t)if(e.activeSourceIndex===se){const r=s&&Z(s,"sourceIndex")&&-1!==s.sourceIndex?s.sourceIndex:void 0;t.forEach(((t,s)=>{const o=void 0!==r?r:s;this._formatSourceResponse(e,t,o);}));}else this._formatSourceResponse(e,t[0],e.activeSourceIndex);}_getResultsFromSources(e,t){const{allSources:s}=this,r=!e.location&&Z(e,"sourceIndex")?e.sourceIndex:this.activeSourceIndex,o=[];if(!s.length){const e=new request.s("search:no-sources-defined","At least one source is required.",{allSources:s});return K.error(e),Promise.reject(e)}return r===se?s.forEach(((s,r)=>{o.push(this._getResultsFromSource(e,r,t));})):o.push(this._getResultsFromSource(e,r,t)),request.T(o)}_getSuggestionsFromSources(e,t){const{allSources:s,activeSourceIndex:r}=this,o=[];if(!s.length){const e=new request.s("suggest:no-sources-defined","At least one source is required.",{allSources:s});return K.error(e),Promise.reject(e)}return r===se?s.forEach(((s,r)=>{o.push(this._getSuggestionsFromSource(e,r,t));})):o.push(this._getSuggestionsFromSource(e,r,t)),request.T(o)}_getResultsFromSource(e,t,s){var r;const o=this.allSources.getItemAt(t),{location:l=null}=e,i=(null==(r=this.view)?void 0:r.spatialReference)||Y,a=Z(o,"maxResults")?o.maxResults:this.maxResults,n=!!(o instanceof h$2&&Z(o,"exactMatch"))&&o.exactMatch,{view:u}=this;return o.getResults({view:u,sourceIndex:t,location:l,suggestResult:e,spatialReference:i,exactMatch:n,maxResults:a},s)}_getSuggestionsFromSource(e,t,s){const r=this.allSources.getItemAt(t),o=Z(r,"suggestionsEnabled")?r.suggestionsEnabled:this.suggestionsEnabled,l=e.length,i=Z(r,"minSuggestCharacters")?r.minSuggestCharacters:this.minSuggestCharacters;if(o&&e.trim()&&l>=i){var a;const o=(null==(a=this.view)?void 0:a.spatialReference)||Y,l=Z(r,"maxSuggestions")?r.maxSuggestions:this.maxSuggestions,{view:i}=this,n=!!(r instanceof h$2&&Z(r,"exactMatch"))&&r.exactMatch;return r.getSuggestions({view:i,sourceIndex:t,suggestTerm:e,spatialReference:o,maxSuggestions:l,exactMatch:n},s)}return Promise.resolve(null)}_getLayerSourcePopupTemplate(e){const{layer:t}=e;if(t)return Z(e,"popupTemplate")?e.popupTemplate:t.popupTemplate}_getSourceIndexOfResult(e){const t=this.results;let s=null;return t.some((t=>t.results.some((r=>r===e&&(s=t.sourceIndex,!0))))),s}async _goToSearchResult(e){const t=!!e;this._abortGoTo();const s=new AbortController;this._gotoController=s;const r={target:{target:e},options:{animate:t,signal:s.signal}};await this.callGoTo(r),this._gotoController=null;}_getDefaultSymbol(e){var t;const{defaultSymbols:s}=this,r=null==(t=e.feature)?void 0:t.geometry;if(!request.r(r))return null;const o=this._get("defaultSymbol");if(o&&("point"===r.type||"multipoint"===r.type))return o;switch(r.type){case"point":case"multipoint":return s.point;case"polyline":return s.polyline;case"extent":case"polygon":return s.polygon;default:return null}}_removeHighlight(){this._handles.remove(W);}async _getLayerView(e){const{view:t}=this;if(!e||!t||"building-component"===e.layer.type||"subtype-sublayer"===e.layer.type)return Promise.resolve(null);const{layer:s}=e;return await t.when(),t.whenLayerView(s)}_highlightFeature(e){const{graphic:t,layerView:s}=e,{attributes:r,layer:o}=t,{objectIdField:l}=o,i=r&&r[l],a=s.highlight(i||t);this._handles.add(a,W);}};re.ALL_INDEX=se,request.e([request.d({readOnly:!0,value:null})],re.prototype,"activeSource",null),request.e([request.d()],re.prototype,"activeSourceIndex",null),request.e([request.d()],re.prototype,"allPlaceholder",null),request.e([request.d({readOnly:!0,dependsOn:["defaultSources.length","sources.length","includeDefaultSources"]})],re.prototype,"allSources",null),request.e([request.d()],re.prototype,"autoNavigate",void 0),request.e([request.d()],re.prototype,"autoSelect",void 0),request.e([request.d()],re.prototype,"defaultPopupTemplate",void 0),request.e([request.d({readOnly:!0})],re.prototype,"defaultSources",void 0),request.e([request.d()],re.prototype,"defaultSymbol",null),request.e([request.d()],re.prototype,"defaultSymbols",void 0),request.e([request.d()],re.prototype,"includeDefaultSources",void 0),request.e([request.d()],re.prototype,"locationEnabled",null),request.e([request.d()],re.prototype,"maxInputLength",void 0),request.e([request.d()],re.prototype,"maxResults",void 0),request.e([request.d()],re.prototype,"maxSuggestions",void 0),request.e([request.d()],re.prototype,"messages",void 0),request.e([request.d()],re.prototype,"minSuggestCharacters",void 0),request.e([request.d({readOnly:!0})],re.prototype,"placeholder",null),request.e([request.d()],re.prototype,"popupEnabled",void 0),request.e([request.d({type:PopupTemplate.M})],re.prototype,"popupTemplate",void 0),request.e([request.d({type:Portal.B})],re.prototype,"portal",void 0),request.e([request.d()],re.prototype,"resultCount",void 0),request.e([request.d()],re.prototype,"resultGraphicEnabled",void 0),request.e([request.d({readOnly:!0})],re.prototype,"resultGraphic",void 0),request.e([request.d({readOnly:!0})],re.prototype,"results",void 0),request.e([request.d({readOnly:!0})],re.prototype,"selectedSuggestion",void 0),request.e([request.d()],re.prototype,"searchAllEnabled",void 0),request.e([request.d({readOnly:!0})],re.prototype,"selectedResult",void 0),request.e([request.d()],re.prototype,"searchTerm",null),request.e([request.d({type:X})],re.prototype,"sources",void 0),request.e([request.d({readOnly:!0,dependsOn:["allSources.length","updating"]})],re.prototype,"state",null),request.e([request.d()],re.prototype,"suggestionDelay",void 0),request.e([request.d()],re.prototype,"suggestionCount",void 0),request.e([request.d({readOnly:!0})],re.prototype,"suggestions",void 0),request.e([request.d()],re.prototype,"suggestionsEnabled",void 0),request.e([request.d({readOnly:!0})],re.prototype,"updating",null),request.e([request.d()],re.prototype,"view",void 0),request.e([request.d()],re.prototype,"clear",null),re=request.e([request.i(z)],re);const oe=re;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const n={base:"esri-search-result-renderer esri-widget",anchor:"esri-widget__anchor",showMoreResults:"esri-search-result-renderer__more-results--show-more-results",moreResults:"esri-search-result-renderer__more-results",moreResultsList:"esri-search-result-renderer__more-results-list",moreResultsHeader:"esri-search-result-renderer__more-results-header",moreResultsItem:"esri-search-result-renderer__more-results-item",moreResultsListHeader:"esri-search-result-renderer__more-results-list-header"};let c=class extends request.z{constructor(e,s){super(e,s),this.messages=null,this.showMoreResultsOpen=!1,this.viewModel=null;}render(){const e={[n.showMoreResults]:this.showMoreResultsOpen};return request.n$1("div",{class:n.base},request.n$1("div",{key:"esri-search-renderer__container",class:this.classes(n.moreResults,e)},this.renderSearchResultName(),this.renderMoreResults()))}renderMoreResults(){return request.n$1("div",{key:"esri-search-renderer__more-results"},this.renderMoreResultsButton(),this.renderMoreResultsLists())}renderSearchResultName(){var e;const s=null==(e=this.viewModel)?void 0:e.selectedResult,r=s&&s.name||"";return request.n$1("div",{key:"esri-search-renderer__result-name",class:n.moreResultsItem},r)}renderMoreResultsLists(){var e;const s=null==(e=this.viewModel)?void 0:e.results,{resultCount:r}=this.viewModel;if(r<2)return null;const t=s.map((e=>this.renderMoreResultsList(e)));return request.n$1("div",{key:"esri-search-renderer__more-results-container",class:n.moreResultsList},t)}renderMoreResultsButton(){const{messages:e}=this,{resultCount:s}=this.viewModel;return s<2?null:request.n$1("div",{key:"esri-search-renderer__more-results-button",class:n.moreResultsItem},request.n$1("a",{class:n.anchor,href:"#",bind:this,onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?e.hideMoreResults:e.showMoreResults))}renderMoreResultsHeader(e,s){return request.n$1("div",{key:`esri-search-result-renderer__header-${s}`,class:n.moreResultsListHeader},e)}renderMoreResultsList(e){var s,r;const{results:t}=e,o=t.length,l=!!o,i=null==(s=this.viewModel)?void 0:s.selectedResult,n=1===o&&t[0]===i,c=this._getSourceName(e.source,e.sourceIndex),d=(null==(r=this.viewModel)?void 0:r.results.length)>1&&!n?this.renderMoreResultsHeader(c,e.sourceIndex):null,a=l&&t.map(((e,s)=>this.renderMoreResultsListItem(e,s))),h=l&&!n?request.n$1("ul",{key:`esri-search-result-renderer__list-${e.sourceIndex}`},a):null;return l?request.n$1("div",{key:`esri-search-result-renderer__results-${e.sourceIndex}`},d,h):null}renderMoreResultsListItem(e,s){return e!==this.get("viewModel.selectedResult")?request.n$1("li",{key:`esri-search-result-renderer__list-item-${s}`},request.n$1("a",{class:n.anchor,href:"#",tabindex:"0",bind:this,"data-result":e,onclick:this._selectResultClick,onkeydown:this._selectResultClick},e.name)):null}_showMoreResultsClick(e){e.preventDefault(),this.showMoreResultsOpen=!this.showMoreResultsOpen;const s=this.get("viewModel.view.popup");s&&s.reposition();}_selectResultClick(e){e.preventDefault();const s=e.currentTarget["data-result"];this.viewModel&&this.viewModel.select(s);}_getSourceName(e,s){return s===oe.ALL_INDEX?this.messages.all:e.name}};request.e([request.d(),request.e$1("esri/widgets/Search/t9n/Search")],c.prototype,"messages",void 0),request.e([request.d()],c.prototype,"showMoreResultsOpen",void 0),request.e([request.d()],c.prototype,"viewModel",void 0),request.e([accessibleHandler.t()],c.prototype,"_showMoreResultsClick",null),request.e([accessibleHandler.t()],c.prototype,"_selectResultClick",null),c=request.e([request.i("esri.widgets.Search.SearchResultRenderer")],c);const d=c;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const w={base:"esri-search esri-widget",loader:"esri-widget__loader",loaderText:"esri-widget__loader-text",loaderAnimation:"esri-widget__loader-animation",esriInput:"esri-input",hasMultipleSources:"esri-search--multiple-sources",isLoading:"esri-search--loading",isSearching:"esri-search--searching",showSuggestions:"esri-search--show-suggestions",showSources:"esri-search--sources",showWarning:"esri-search--warning",container:"esri-search__container",input:"esri-search__input",inputContainer:"esri-search__input-container",form:"esri-search__form",submitButton:"esri-search__submit-button",sourcesButton:"esri-search__sources-button",clearButton:"esri-search__clear-button",sourceName:"esri-search__source-name",suggestionsMenu:"esri-search__suggestions-menu",suggestionList:"esri-search__suggestions-list",suggestionListCurrentLocation:"esri-search__suggestions-list--current-location",sourcesMenu:"esri-search__sources-menu",source:"esri-search__source",warningMenu:"esri-search__warning-menu",warningMenuBody:"esri-search__warning-body",warningMenuHeader:"esri-search__warning-header",warningMenuText:"esri-search__warning-text",noValueText:"esri-search__no-value-text",esriWidgetDisabled:"esri-widget--disabled",button:"esri-widget--button",fallbackText:"esri-icon-font-fallback-text",header:"esri-widget__heading",locate:"esri-icon-locate-circled",menu:"esri-menu",menuList:"esri-menu__list",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuHeader:"esri-menu__header",loadingIcon:"esri-icon-loading-indicator esri-rotating",searchIcon:"esri-icon-search",dropdownIcon:"esri-icon-down-arrow esri-search__sources-button--down",dropupIcon:"esri-icon-up-arrow esri-search__sources-button--up",clearIcon:"esri-icon-close",noticeIcon:"esri-icon-notice-triangle",widgetIcon:"esri-icon-search",disabled:"esri-disabled"},S=/<[a-z/][\s\S]*>/i;let b=class extends request.z{constructor(e,t){super(e,t),this._activeMenuItemIndex=-1,this._handles=new request.u,this._inputNode=null,this._menuItemCount=0,this._sourceMenuButtonNode=null,this._sourceListNode=null,this._suggestionListNode=null,this._searchResultRenderer=new d,this._locateFailed=null,this._container=null,this.activeMenu="none",this.activeSource=null,this.activeSourceIndex=null,this.allPlaceholder=null,this.allSources=null,this.autoNavigate=null,this.autoSelect=null,this.defaultSources=null,this.disabled=!1,this.goToOverride=null,this.iconClass=w.widgetIcon,this.includeDefaultSources=null,this.label=void 0,this.locationEnabled=null,this.maxResults=null,this.maxSuggestions=null,this.messages=null,this.messagesCommon=null,this.minSuggestCharacters=null,this.popupEnabled=null,this.popupTemplate=null,this.portal=null,this.resultGraphic=null,this.resultGraphicEnabled=null,this.results=null,this.searchAllEnabled=null,this.searchTerm=null,this.selectedResult=null,this.sources=null,this.suggestions=null,this.suggestionsEnabled=null,this.view=null,this.viewModel=new oe,this._clearActiveMenu=()=>{this.activeMenu="none";},this._removeActiveMenu=e=>{var t;const s=e.relatedTarget;s&&null!=(t=this._container)&&t.contains(s)||this._clearActiveMenu();},this.own(request.f(this,"searchTerm",(e=>{(e&&"warning"===this.activeMenu||!e&&!this.get("viewModel.selectedSuggestion.location"))&&this._clearActiveMenu();})),request.$(this,"viewModel.allSources","change",(()=>this._watchSourceChanges())),request.i$1(this,"activeMenu",(()=>this._resetActiveMenuItemIndex())),request.i$1(this,"viewModel.defaultPopupTemplate",(e=>{e&&(e.content=this._renderSearchResultsContent.bind(this));})));}destroy(){this._handles.destroy(),this._handles=null,this._cancelSuggest(),this._cancelSearch(),this._searchResultRenderer&&(this._searchResultRenderer.viewModel=null,this._searchResultRenderer.destroy(),this._searchResultRenderer=null);}get displayedSearchTerm(){return `${this.viewModel.searchTerm}`.trim()}get inputId(){return this._buildId("input")}get suggestionsMenuId(){return this._buildId("suggest-menu")}get sourceMenuId(){return this._buildId("source-menu")}get sourceMenuButtonId(){return this._buildId("source-menu-button")}clear(){}focus(){var e;null==(e=this._inputNode)||e.focus(),this.emit("search-focus");}blur(){var e;null==(e=this._inputNode)||e.blur(),this.emit("search-blur");}search(e){this._clearActiveMenu(),this._cancelSuggest(),this._cancelSearch();const t=new AbortController,{signal:s}=t;return this._searchController=t,this.viewModel.search(e,{signal:s}).catch((e=>{if(this._searchController===t)return this._clearActiveMenu(),this._searchController=null,e})).then((e=>{if(this._searchController===t)return this.activeMenu=e.numResults?"none":"warning",this._searchController=null,e}))}suggest(e){this._cancelSuggest();const t=new AbortController,{signal:s}=t;return this._suggestController=t,this.viewModel.suggest(e,null,{signal:s}).then((e=>{if(this._suggestController===t)return this._suggestController=null,e.numResults&&this._openSuggestionMenu(),this._scrollToTopSuggestion(),e})).catch((()=>{if(this._suggestController===t)return this._suggestController=null,null}))}render(){const{state:e}=this.viewModel,t={[w.disabled]:"disabled"===e,[w.esriWidgetDisabled]:this.disabled};return request.n$1("div",{class:this.classes(w.base,t)},"loading"===e?this.renderLoader():this.renderContainer())}renderSubmitButton(){const{messages:e}=this;return request.n$1("button",{"aria-label":e.searchButtonTitle,bind:this,class:this.classes(w.submitButton,w.button),key:"esri-search__submit-button",onclick:this._handleSearchButtonClick,title:e.searchButtonTitle},request.n$1("span",{"aria-hidden":"true",class:w.searchIcon}))}renderWarningMenu(){return request.n$1("div",{key:"esri-search__error-menu",class:this.classes(w.menu,w.warningMenu)},request.n$1("div",{class:w.warningMenuBody},this.renderWarning()))}renderSourceMenuButton(){const{messages:e,activeMenu:t,sourceMenuId:s,sourceMenuButtonId:i}=this,{activeSourceIndex:r,allSources:n}=this.viewModel;return n.length>1?request.n$1("button",{id:i,key:"esri-search__source-menu-button",bind:this,"aria-label":e.searchIn,title:e.searchIn,"aria-haspopup":"true","aria-expanded":("source"===t).toString(),"aria-controls":s,class:this.classes(w.sourcesButton,w.button),onclick:this._handleSourcesMenuToggleClick,onfocus:this._clearActiveMenu,afterCreate:request.g$2,"data-node-ref":"_sourceMenuButtonNode"},request.n$1("span",{"aria-hidden":"true",class:w.dropdownIcon}),request.n$1("span",{"aria-hidden":"true",class:w.dropupIcon}),request.n$1("span",{class:w.sourceName},this._getSourceName(r))):null}renderSourcesList(){const{allSources:e,searchAllEnabled:t}=this.viewModel,{_activeMenuItemIndex:s,activeMenu:i,sourceMenuId:r,sourceMenuButtonId:n}=this,o="source"===i&&s>-1?this._buildId("source-item",s):null;return e.length>1?request.n$1("ul",{"aria-activedescendant":o,"aria-labelledby":n,id:r,role:"menu",bind:this,afterCreate:request.g$2,onkeydown:this._handleSourceMenuKeydown,onkeyup:this._handleSourceMenuKeyup,"data-node-ref":"_sourceListNode",class:w.menuList,tabIndex:-1},t?this.renderSource(oe.ALL_INDEX):null,e.map(((e,t)=>this.renderSource(t))).toArray()):null}renderSourcesMenu(){const{allSources:e}=this.viewModel;return e.length>1?request.n$1("div",{key:"esri-search__source-menu",class:this.classes(w.menu,w.sourcesMenu)},this.renderSourcesList()):null}renderLoader(){const{messages:e,messagesCommon:t}=this;return request.n$1("div",{class:w.loader,key:"base-loader"},request.n$1("span",{"aria-hidden":"true",class:w.loaderAnimation}),request.n$1("span",{class:w.fallbackText},e.searchButtonTitle),request.n$1("span",{class:w.loaderText},t.loading))}renderContainer(){const{allSources:e,state:t}=this.viewModel,{activeMenu:s}=this,i={[w.hasMultipleSources]:e.length>1,[w.isLoading]:"loading"===t,[w.isSearching]:"searching"===t,[w.showWarning]:"warning"===s,[w.showSources]:"source"===s,[w.showSuggestions]:"suggestion"===s};return request.n$1("div",{tabIndex:-1,afterCreate:e=>{this._container=e,e.addEventListener("focusout",this._removeActiveMenu);},afterRemoved:e=>{e.removeEventListener("focusout",this._removeActiveMenu);},class:this.classes(i,w.container),key:"base-container"},this.renderSourceMenuButton(),this.renderSourcesMenu(),this.renderInputContainer(),this.renderSubmitButton(),this.renderWarningMenu())}renderClearButton(){return this.searchTerm?request.n$1("button",{bind:this,class:this.classes(w.clearButton,w.button),key:"esri-search__clear-button",onclick:this._handleClearButtonClick,onfocus:this._clearActiveMenu,title:this.messages.clearButtonTitle},request.n$1("span",{"aria-hidden":"true",class:w.clearIcon})):null}renderLocationGroup(){const{messages:e,locationEnabled:t,displayedSearchTerm:s}=this,i=t&&!s,r="suggestion"===this.activeMenu&&0===this._activeMenuItemIndex;return i?request.n$1("ul",{role:"group",key:"esri-search__suggestion-list-current-location",class:this.classes(w.menuList,w.suggestionList,w.suggestionListCurrentLocation)},request.n$1("li",{bind:this,"data-current-location-item":!0,onclick:this._handleUseCurrentLocationClick,id:this._buildId("suggestion-item",0),"aria-selected":("suggestion"===this.activeMenu&&0===this._activeMenuItemIndex).toString(),role:"option",class:this.classes(w.menuItem,r?w.menuItemFocus:null)},request.n$1("span",{"aria-hidden":"true",class:w.locate})," ",e.useCurrentLocation)):null}renderInput(){const{activeMenu:e,locationEnabled:t,displayedSearchTerm:s,messages:i,suggestionsMenuId:r,inputId:n,_activeMenuItemIndex:o}=this,{maxInputLength:a,placeholder:u,searchTerm:l,suggestionCount:c}=this.viewModel,d=!(!(t&&!s)&&!c),h="suggestion"===e&&o>-1?this._buildId("suggestion-item",o):null;return request.n$1("input",{"aria-activedescendant":h,"aria-autocomplete":"list","aria-expanded":(d&&"suggestion"===e).toString(),"aria-controls":d?r:null,"aria-haspopup":"listbox","aria-label":i.searchButtonTitle,bind:this,placeholder:u,maxlength:a,autocomplete:"off",type:"text",class:this.classes(w.esriInput,w.input),value:l,id:n,role:"combobox",onkeyup:this._handleInputKeyup,onclick:this._openSuggestionMenu,oninput:this._handleInputPaste,onpaste:this._handleInputPaste,afterCreate:request.g$2,"data-node-ref":"_inputNode",onfocus:this.focus,onblur:this.blur,title:l?"":u})}renderForm(){return request.n$1("form",{key:"esri-search__form",bind:this,class:w.form,onsubmit:this._formSubmit,role:"search"},this.renderInput())}renderSuggestList(e){const{sourceIndex:t}=e,s=e.results.length,i=e.results;return s?request.n$1("ul",{role:"group",key:`esri-search__suggestion-list-${t}`,class:this.classes(w.menuList,w.suggestionList)},i.map((e=>this.renderSuggestion(e,this._menuItemCount++)))):null}renderSuggestionsGroup(){const{suggestions:e}=this.viewModel;return e?e.map((e=>[this.renderSuggestionHeader(e),this.renderSuggestList(e)])):null}renderSuggestionsMenu(){const{displayedSearchTerm:e,locationEnabled:t,suggestionsMenuId:s,inputId:i}=this,{suggestionCount:r}=this.viewModel,n=t&&!e||r;return this._menuItemCount=0,n?request.n$1("div",{id:s,key:"esri-search__suggestions-menu",class:this.classes(w.menu,w.suggestionsMenu),role:"listbox","aria-labelledby":i,bind:this,afterCreate:request.g$2,"data-node-ref":"_suggestionListNode"},this.renderLocationGroup(),this.renderSuggestionsGroup()):null}renderInputContainer(){return request.n$1("div",{key:"esri-search__input-container",class:w.inputContainer},this.renderForm(),this.renderSuggestionsMenu(),this.renderClearButton())}renderSuggestionHeader(e){const{allSources:t,activeSourceIndex:s}=this.viewModel,{sourceIndex:i}=e,r=e.results.length,n=t.length>1&&s===oe.ALL_INDEX;return r&&n?request.n$1("div",{key:`esri-search__suggestion-header-${i}`,class:w.menuHeader},this._getSourceName(i)):null}renderSuggestion(e,t){const{_activeMenuItemIndex:s,messages:i}=this,{searchTerm:r}=this.viewModel;if(r){const{text:n}=e,o=n||i.untitledResult,a=S.test(o),u=[];if(a)u.push(request.n$1("div",{innerHTML:o}));else {const e=this._splitResult(o,r),t=r.toLowerCase();e.forEach(((e,s)=>{e&&e.length&&(e.toLowerCase()===t?u.push(request.n$1("strong",{key:s},e)):u.push(e));}));}const l="suggestion"===this.activeMenu&&s===t;return request.n$1("li",{bind:this,id:this._buildId("suggestion-item",t),"aria-selected":("suggestion"===this.activeMenu&&this._activeMenuItemIndex===t).toString(),onclick:this._handleSuggestionClick,key:`esri-search__suggestion_${t}`,"data-suggestion":e,role:"option",class:this.classes(w.menuItem,l?w.menuItemFocus:null)},u)}}renderSource(e){const{activeSourceIndex:t,searchAllEnabled:s}=this.viewModel,i={[w.menuItemActive]:e===t,[w.menuItemFocus]:"source"===this.activeMenu&&e===(s?this._activeMenuItemIndex-1:this._activeMenuItemIndex)},r=s?e+1:e;return request.n$1("li",{bind:this,key:`esri-search__source-${e}`,id:this._buildId("source-item",r),"aria-checked":(e===t).toString(),onclick:this._handleSourceClick,"data-source-index":e,role:"menuitemradio",class:this.classes(w.source,w.menuItem,i)},this._getSourceName(e))}renderNoResultsWarning(e){const{messages:t}=this,s=e?request.s$2(t.noResultsFoundForValue,{value:`"${e}"`}):t.noResultsFound;return request.n$1("div",{key:"esri-search__no_results"},request.n$1("div",{class:w.warningMenuHeader},t.noResults),request.n$1("div",{class:w.warningMenuText},s))}renderEmptySearchWarning(){const{messages:e}=this;return request.n$1("div",{key:"esri-search__empty-search"},request.n$1("span",{"aria-hidden":"true",class:w.noticeIcon}),request.n$1("span",{class:w.noValueText},e.emptyValue))}renderLocateWarning(){const{messages:e}=this;return request.n$1("div",{key:"esri-search__locate-error"},request.n$1("span",{"aria-hidden":"true",class:w.noticeIcon}),request.n$1("span",{class:w.noValueText},e.locateError))}renderWarning(){var e;const{displayedSearchTerm:t,_locateFailed:s}=this,{viewModel:i}=this;return s?this.renderLocateWarning():null!=(e=i.selectedSuggestion)&&e.location||t?this.renderNoResultsWarning(t):this.renderEmptySearchWarning()}_resetActiveMenuItemIndex(){this._activeMenuItemIndex=-1;}_buildId(e,t){return `${this.id}-${e}${void 0===t?"":`-${t}`}`}_watchSourceChanges(){const{_handles:e,viewModel:{allSources:t}}=this,s="sources";e.remove(s),t.forEach((t=>e.add(request.f(t,"name",(()=>this.scheduleRender())),s)));}_handleSourcesMenuToggleClick(){const e="source"===this.activeMenu;var t;(this.activeMenu=e?"none":"source",this.renderNow(),"source"===this.activeMenu)&&(null==(t=this._sourceListNode)||t.focus());}_handleClearButtonClick(){this.viewModel.clear(),this._focus();}_handleSearchButtonClick(){this.search();}_handleSuggestionClick(e){const t=e.currentTarget["data-suggestion"];t&&(this._focus(),this.search(t));}_handleUseCurrentLocationClick(){this._useCurrentLocation();}_useCurrentLocation(){this._focus("none"),this._cancelSuggest(),this._cancelSearch();const e=new AbortController,{signal:t}=e;this._searchController=e,this.viewModel.searchNearby({signal:t}).catch((()=>{this._locateFailed=!0,this.activeMenu="warning";})).then((()=>{this._searchController=null;}));}_handleSourceClick(e){this._setSourceFromMenuItem(e.currentTarget);}_setSourceFromMenuItem(e){var t;if(!e)return;const s=e["data-source-index"];this.viewModel.activeSourceIndex=s,this._clearActiveMenu(),null==(t=this._sourceMenuButtonNode)||t.focus();}_cancelSuggest(){this._suggestController&&(this._suggestController.abort(),this._suggestController=null);}_cancelSearch(){this._searchController&&(this._searchController.abort(),this._searchController=null),this._locateFailed=!1;}_handleInputKeyup(e){var s;const i=request.i$2(e);if(e.ctrlKey||e.metaKey||"Copy"===i||"ArrowLeft"===i||"ArrowRight"===i||"Shift"===i)return;if("Tab"===i||"Escape"===i||e.shiftKey&&"Tab"===i)return this._cancelSuggest(),void("Escape"===i&&this._clearActiveMenu());const r="Home"===i||"End"===i||"ArrowUp"===i||"ArrowDown"===i;if("Enter"===i&&this._activeMenuItemIndex<0)return void this._cancelSuggest();const n=null==(s=this._suggestionListNode)?void 0:s.getElementsByTagName("li");if(null!=n&&n.length){if("suggestion"!==this.activeMenu&&this._openSuggestionMenu(),r)return e.preventDefault(),this._cancelSuggest(),void this.handleItemNavigation(i,n,this._suggestionListNode);const t=n[this._activeMenuItemIndex];if("Enter"===i&&t){const e=t["data-suggestion"];return void(e?(this._focus(),this.search(e)):t["data-current-location-item"]&&this._useCurrentLocation())}}this.viewModel.searchTerm&&this.suggest();}handleItemNavigation(e,t,s){const i=this._activeMenuItemIndex;"Home"===e&&(this._activeMenuItemIndex=0),"End"===e&&(this._activeMenuItemIndex=t.length-1),"ArrowUp"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex<=0?t.length-1:this._activeMenuItemIndex-1),"ArrowDown"===e&&(this._activeMenuItemIndex=this._activeMenuItemIndex===t.length-1?0:this._activeMenuItemIndex+1),i!==this._activeMenuItemIndex&&request.w$1(t[this._activeMenuItemIndex],s);}_scrollToTopSuggestion(){this._suggestionListNode&&(this._suggestionListNode.scrollTop=0);}_openSuggestionMenu(){this.activeMenu="suggestion";}_handleInputPaste(e){const t=e.target;this.viewModel.searchTerm!==t.value&&(this.viewModel.searchTerm=t.value),this.viewModel.searchTerm&&this.suggest();}_handleSourceMenuKeydown(e){const s=request.i$2(e);if(request.y(s)){e.preventDefault();const t=this._sourceListNode.getElementsByTagName("li")[this._activeMenuItemIndex];this._setSourceFromMenuItem(t);}else "ArrowUp"!==s&&"ArrowDown"!==s&&"End"!==s&&"Home"!==s||e.preventDefault();}_handleSourceMenuKeyup(e){var s;const i=request.i$2(e),r="ArrowUp"===i||"ArrowDown"===i||"End"===i||"Home"===i;var n;if(r&&e.preventDefault(),"Escape"===i)return this._clearActiveMenu(),void(null==(n=this._sourceMenuButtonNode)||n.focus());const o=null==(s=this._sourceListNode)?void 0:s.getElementsByTagName("li");return o&&0!==o.length&&r?("source"!==this.activeMenu&&(this.activeMenu="source"),void this.handleItemNavigation(i,o,this._sourceListNode.parentElement)):void 0}_focus(e){this.focus(),e&&(this.activeMenu=e);}_formSubmit(e){e.preventDefault(),-1===this._activeMenuItemIndex&&this.search();}_getSourceName(e){const{messages:t}=this,s=this.viewModel,{allSources:i}=s,r=i.getItemAt(e);return e===oe.ALL_INDEX?t.all:r&&r.name||t.untitledSource}_splitResult(e,t){const s=request.o$4(t);return e.replace(new RegExp(`(^|)(${s})(|$)`,"ig"),"$1|$2|$3").split("|")}_renderSearchResultsContent(){return this._searchResultRenderer.showMoreResultsOpen=!1,this._searchResultRenderer.viewModel=this.viewModel,this._searchResultRenderer}};request.e([request.d()],b.prototype,"_activeMenuItemIndex",void 0),request.e([request.d()],b.prototype,"displayedSearchTerm",null),request.e([request.d({readOnly:!0})],b.prototype,"inputId",null),request.e([request.d({readOnly:!0})],b.prototype,"suggestionsMenuId",null),request.e([request.d({readOnly:!0})],b.prototype,"sourceMenuId",null),request.e([request.d({readOnly:!0})],b.prototype,"sourceMenuButtonId",null),request.e([request.d()],b.prototype,"activeMenu",void 0),request.e([request.o("viewModel.activeSource")],b.prototype,"activeSource",void 0),request.e([request.o("viewModel.activeSourceIndex")],b.prototype,"activeSourceIndex",void 0),request.e([request.o("viewModel.allPlaceholder")],b.prototype,"allPlaceholder",void 0),request.e([request.o("viewModel.allSources")],b.prototype,"allSources",void 0),request.e([request.o("viewModel.autoNavigate")],b.prototype,"autoNavigate",void 0),request.e([request.o("viewModel.autoSelect")],b.prototype,"autoSelect",void 0),request.e([request.o("viewModel.defaultSources")],b.prototype,"defaultSources",void 0),request.e([request.d()],b.prototype,"disabled",void 0),request.e([request.o("viewModel.goToOverride")],b.prototype,"goToOverride",void 0),request.e([request.d()],b.prototype,"iconClass",void 0),request.e([request.o("viewModel.includeDefaultSources")],b.prototype,"includeDefaultSources",void 0),request.e([request.d({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],b.prototype,"label",void 0),request.e([request.o("viewModel.locationEnabled")],b.prototype,"locationEnabled",void 0),request.e([request.o("viewModel.maxResults")],b.prototype,"maxResults",void 0),request.e([request.o("viewModel.maxSuggestions")],b.prototype,"maxSuggestions",void 0),request.e([request.d(),request.e$1("esri/widgets/Search/t9n/Search")],b.prototype,"messages",void 0),request.e([request.d(),request.e$1("esri/t9n/common")],b.prototype,"messagesCommon",void 0),request.e([request.o("viewModel.minSuggestCharacters")],b.prototype,"minSuggestCharacters",void 0),request.e([request.o("viewModel.popupEnabled")],b.prototype,"popupEnabled",void 0),request.e([request.o("viewModel.popupTemplate")],b.prototype,"popupTemplate",void 0),request.e([request.o("viewModel.portal")],b.prototype,"portal",void 0),request.e([request.o("viewModel.resultGraphic")],b.prototype,"resultGraphic",void 0),request.e([request.o("viewModel.resultGraphicEnabled")],b.prototype,"resultGraphicEnabled",void 0),request.e([request.o("viewModel.results")],b.prototype,"results",void 0),request.e([request.o("viewModel.searchAllEnabled")],b.prototype,"searchAllEnabled",void 0),request.e([request.o("viewModel.searchTerm")],b.prototype,"searchTerm",void 0),request.e([request.o("viewModel.selectedResult")],b.prototype,"selectedResult",void 0),request.e([request.o("viewModel.sources")],b.prototype,"sources",void 0),request.e([request.o("viewModel.suggestions")],b.prototype,"suggestions",void 0),request.e([request.o("viewModel.suggestionsEnabled")],b.prototype,"suggestionsEnabled",void 0),request.e([request.o("viewModel.view")],b.prototype,"view",void 0),request.e([vmEvent.t(["search-complete","search-clear","search-start","select-result","suggest-start","suggest-complete"]),request.d({type:oe})],b.prototype,"viewModel",void 0),request.e([request.o("viewModel.clear")],b.prototype,"clear",null),b=request.e([request.i("esri.widgets.Search")],b);const y=b;

exports.S = S$1;
exports.f = f$4;
exports.t = t;
exports.w = w$2;
exports.x = x$2;
exports.y = y;
