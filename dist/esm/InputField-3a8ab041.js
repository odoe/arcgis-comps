import { e, d, i, p, H as s } from './messageBundle-f75b4090.js';
import { u } from './Field-bfaa8af9.js';
import { B, H, K, f as a, i as ee, j as ie, O, L, k as e$1, Z, l as r, o as re } from './opacityUtils-5e864561.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const g={type:"number"},b={type:"number",intlOptions:{notation:"scientific"}},_={type:"date",intlOptions:{day:"2-digit",month:"2-digit",year:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}};let F=class extends p{constructor(e){super(e),this.arcade=null,this.config=null,this.feature=null,this.field=null,this.initialFeature=null,this.layer=null,this.description=null,this.editorType=null,this.error=null,this.format=null,this.group=null,this.hint=null,this.messages=null,this.name=null;}get compiledFunc(){var e;const{arcade:t}=this;return t&&t.arcadeUtils.createFunction(null==(e=this.config)?void 0:e.visibilityExpression)}get compiledRequiredFunc(){var e;const{arcade:t}=this;return t&&t.arcadeUtils.createFunction(null==(e=this.config)?void 0:e.requiredExpression)}get evaluatedRequirement(){const e=this.compiledRequiredFunc;if(!e)return null;const{arcade:t}=this;return t.arcadeUtils.executeFunction(e,t.arcadeUtils.createExecContext(this.feature))}get evaluatedVisibility(){const e=this.compiledFunc;if(!e)return null;const{arcade:t}=this;return t.arcadeUtils.executeFunction(e,t.arcadeUtils.createExecContext(this.feature))}get domain(){var e,t;const{typeIdField:i}=this.layer,r=i===this.name,n=null==(e=this.field)?void 0:e.domain;if(r&&!n)return new u({name:"__internal-type-based-coded-value-domain__",codedValues:this.layer.types.map((({id:e,name:t})=>({code:e,name:t})))});const{feature:l}=this,s=i&&this.layer.getFieldDomain(this.name,{feature:l})||n,a=null==(t=this.config)?void 0:t.domain;return this._isDomainCompatible(a)?a:s}get editable(){var e;return this.layer.capabilities.operations.supportsEditing&&this.field.editable&&!1!==(null==(e=this.config)?void 0:e.editable)}get errorMessage(){return this._toErrorMessage()}get includeTime(){var e;const t=null==(e=this.config)?void 0:e.includeTime;return void 0===t||t}get label(){var e;return (null==(e=this.config)?void 0:e.label)||this.field.alias||this.field.name}get maxLength(){var e,t;const i=-1;if("date"===this.type)return i;const r=null==(e=this.field)?void 0:e.length,o=null==(t=this.config)?void 0:t.maxLength;return !isNaN(o)&&o>=i&&(r===i||o<=r)?o:r}get minLength(){var e,t;const i=-1;if("date"===this.type)return i;const r=null==(e=this.field)?void 0:e.length,o=null==(t=this.config)?void 0:t.minLength;return !isNaN(o)&&o>=i&&(r===i||o<=r)?o:i}get required(){var e,t;if(!this.editable)return !1;if(!(null==(e=this.field)?void 0:e.nullable))return !0;if("boolean"==typeof this.evaluatedRequirement)return this.evaluatedRequirement;return !0===(null==(t=this.config)?void 0:t.required)}get type(){const{field:e}=this;return B(e)?"number":H(e)?"text":K(e)?"date":"unsupported"}get valid(){const e=this.editable?this._validate():null;return this._set("error",e),null===e}get value(){return this._get("value")}set value(e){this.notifyChange("evaluatedVisibility"),this._set("value",e);}get visible(){if(this._isEditorField())return !1;return "boolean"==typeof this.evaluatedVisibility?this.evaluatedVisibility:!!this.config||this._shownByDefault()}_isDomainCompatible(e){const{field:t}=this;if("coded-value"===(null==e?void 0:e.type)){const i=typeof e.codedValues[0].code;if("string"===i&&H(t)||"number"===i&&B(t))return !0}return !!("range"===(null==e?void 0:e.type)&&B(t)||K(t))}_validate(){const{domain:e,field:t,initialFeature:i,minLength:r,required:o,type:l,valid:s,value:a$1}=this,u=o&&null===a$1,d=void 0!==s;return !u&&i.getAttribute(t.name)===a$1&&d?null:"text"===l&&r>-1&&"string"==typeof a$1&&a$1.length<r?"length-validation-error::too-short":e?null!==a$1||o?a(e,a$1):null:u?ee.INVALID_TYPE:ie(t,a$1)}_shownByDefault(){var e;const t=null==(e=this.field)?void 0:e.type;return "oid"!==t&&"global-id"!==t&&!this._isGeometryField()}_isEditorField(){return O(this.layer).indexOf(this.name)>-1}_isGeometryField(){return L(this.layer).indexOf(this.name)>-1}_toErrorMessage(){const{domain:e,field:t,messages:i,minLength:r$1,value:o,required:n,type:a}=this,u=this.error;if(n&&null===o)return i.validationErrors.cannotBeNull;if(u===e$1.VALUE_OUT_OF_RANGE||u===Z.OUT_OF_RANGE){const r$1=r(e)||re(t);return s(i.validationErrors.outsideRange,r$1,{format:{max:"date"===a?_:r$1.isInteger?g:b,min:"date"===a?_:r$1.isInteger?g:b}})}return u===e$1.INVALID_CODED_VALUE?i.validationErrors.invalidCodedValue:u===ee.INVALID_TYPE?i.validationErrors.invalidType:"length-validation-error::too-short"===u?s(i.validationErrors.tooShort,{min:r$1}):null}};e([d()],F.prototype,"arcade",void 0),e([d()],F.prototype,"compiledFunc",null),e([d()],F.prototype,"compiledRequiredFunc",null),e([d()],F.prototype,"config",void 0),e([d()],F.prototype,"evaluatedRequirement",null),e([d()],F.prototype,"evaluatedVisibility",null),e([d()],F.prototype,"feature",void 0),e([d()],F.prototype,"field",void 0),e([d()],F.prototype,"initialFeature",void 0),e([d()],F.prototype,"layer",void 0),e([d({aliasOf:"config.description"})],F.prototype,"description",void 0),e([d()],F.prototype,"domain",null),e([d()],F.prototype,"editable",null),e([d({aliasOf:"config.editorType"})],F.prototype,"editorType",void 0),e([d({readOnly:!0})],F.prototype,"error",void 0),e([d({dependsOn:["error","messages","value"]})],F.prototype,"errorMessage",null),e([d({aliasOf:"config.format"})],F.prototype,"format",void 0),e([d()],F.prototype,"group",void 0),e([d({aliasOf:"config.hint"})],F.prototype,"hint",void 0),e([d()],F.prototype,"includeTime",null),e([d()],F.prototype,"label",null),e([d()],F.prototype,"maxLength",null),e([d()],F.prototype,"minLength",null),e([d()],F.prototype,"messages",void 0),e([d({aliasOf:"field.name"})],F.prototype,"name",void 0),e([d()],F.prototype,"required",null),e([d()],F.prototype,"type",null),e([d()],F.prototype,"valid",null),e([d({value:null})],F.prototype,"value",null),e([d()],F.prototype,"visible",null),F=e([i("esri.widgets.FeatureForm.InputField")],F);const E=F;

export { E };
