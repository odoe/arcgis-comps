import { r as registerInstance, c as createEvent, g as getElement } from './index-b157fcf2.js';
import { e, d as d$1, i, p, c as s$1, S as S$1, s as s$2, r as n, o, j as e$2, f as c$1, z, u as u$2, a as i$1, l as n$1, aC as y$1, $, g as f, M as i$2 } from './messageBundle-f75b4090.js';
import { c } from './Thumbnail-cf2b8bad.js';
import { u as u$1 } from './Viewpoint-f60966b5.js';
import { x, c as c$2, _ } from './Bookmark-4efef691.js';
import { e as e$1 } from './GoTo-148cc420.js';
import { s as s$3 } from './Heading-960a88b2.js';
import { t } from './vmEvent-6b909beb.js';
import { S as Sortable } from './sortable.esm-2f5354d3.js';
import './mathUtils-e16f9389.js';
import './common-d5b993de.js';
import './mathUtils-8e5ad7fe.js';
import './geometry-7e07b1ba.js';
import './jsonUtils-13b1f6fd.js';
import './HandleOwner-88326c19.js';
import './reactiveUtils-8f9c3a3d.js';
import './Popover-adf7faf4.js';
import './Identifiable-da047c47.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let s=class extends p{constructor(t){super(t);}get editedBookmark(){const{bookmark:t}=this;return t?this._get("editedBookmark")||t.clone():null}get state(){return this._get("state")}set state(t){this.validationState=void 0,this.loading=void 0,this._set("state",t);}};e([d$1()],s.prototype,"bookmark",void 0),e([d$1({readOnly:!0})],s.prototype,"editedBookmark",null),e([d$1()],s.prototype,"state",null),e([d$1()],s.prototype,"validationState",void 0),e([d$1()],s.prototype,"loading",void 0),s=e([i("esri.widgets.Bookmarks.UserState")],s);const a=s;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const u="esri.widgets.Bookmarks.BookmarksViewModel",m=s$1.getLogger(u),k=S$1.ofType(x),w$1={width:128,height:128,format:"png"},d={takeScreenshot:!0,captureViewpoint:!0,captureRotation:!0,captureScale:!0};let v=class extends(e$1(n.EventedAccessor)){constructor(t){super(t),this.activeBookmark=null;}destroy(){this.view=null,this._set("activeBookmark",null);}set bookmarks(t){void 0!==t?this._override("bookmarks",t):this._clearOverride("bookmarks");}get bookmarks(){return this.get("view.map.bookmarks")||new k}set defaultCreateOptions(t){this._set("defaultCreateOptions",{...d,...t});}get defaultCreateOptions(){return d}set defaultEditOptions(t){this._set("defaultEditOptions",{...d,...t});}get defaultEditOptions(){return d}get state(){const t=this.get("view");return t&&!t.ready?"loading":"ready"}get view(){return this._get("view")}set view(t){t&&"2d"!==t.type&&m.error(new s$2("view:invalid-view","SceneView is not supported",{view:t})),this._set("view",t);}async createBookmark(t){const{view:e,defaultCreateOptions:o}=this;if(!e){const t=new s$2("create-bookmark:invalid-view","Cannot create a bookmark without a view.");return m.error(t),Promise.reject(t)}const{takeScreenshot:i,screenshotSettings:a,captureViewpoint:s,captureRotation:n,captureScale:c}={...o,...t},l=i?await this._createThumbnail(a):void 0;return new x({...l&&{thumbnail:l},...s&&{viewpoint:this._createViewpoint({view:e,captureScale:c,captureRotation:n})}})}async editBookmark(t,e){const{view:o,defaultEditOptions:i}=this;if(!o){const t=new s$2("edit-bookmark:invalid-view","Cannot edit a bookmark without a view.");return m.error(t),Promise.reject(t)}const{takeScreenshot:a,screenshotSettings:s,captureViewpoint:n,captureRotation:c,captureScale:p}={...i,...e},l=a?await this._createThumbnail(s):void 0;return l&&(t.thumbnail=l),n&&(t.viewpoint=this._createViewpoint({view:o,captureScale:p,captureRotation:c})),this.emit("bookmark-edit",{bookmark:t}),t}goTo(t){const{view:e}=this;if(!e){const t=new s$2("go-to:invalid-view","Cannot go to a bookmark without a view");return m.error(t),Promise.reject(t)}const o=null==t?void 0:t.viewpoint;if(!o){const e=new s$2("go-to:invalid-bookmark","Cannot go to a bookmark that does not contain a 'viewpoint'.",{bookmark:t});return m.error(e),Promise.reject(e)}this._set("activeBookmark",t);const i={target:o},a=this.callGoTo(i);return this.emit("bookmark-select",{bookmark:t}),a.catch((()=>{})).then((()=>this._set("activeBookmark",null))),a}async _createThumbnail(t){const e=await this.view.takeScreenshot({...w$1,...t});return new c({url:e.dataUrl})}_createViewpoint({view:t,captureRotation:o,captureScale:r}){var i,a;const s=null==(i=t.viewpoint)?void 0:i.clone();return new u$1({targetGeometry:null==(a=t.extent)?void 0:a.clone(),rotation:o&&(null==s?void 0:s.rotation)||0,scale:r&&(null==s?void 0:s.scale)||0})}};e([d$1({readOnly:!0})],v.prototype,"activeBookmark",void 0),e([d$1({type:k})],v.prototype,"bookmarks",null),e([d$1()],v.prototype,"defaultCreateOptions",null),e([d$1()],v.prototype,"defaultEditOptions",null),e([d$1({readOnly:!0})],v.prototype,"state",null),e([d$1({value:null})],v.prototype,"view",null),v=e([i(u)],v);const h=v;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function I(t,o,e){t.splice(e,0,t.splice(o,1)[0]);}const y="bookmarks",E="data-bookmark-uid",S={base:"esri-bookmarks esri-widget--panel",loaderContainer:"esri-bookmarks__loader-container",loader:"esri-bookmarks__loader",fadeIn:"esri-bookmarks--fade-in",bookmarkList:"esri-bookmarks__list",bookmarkListSortable:"esri-bookmarks__list--sortable",bookmark:"esri-bookmarks__bookmark",bookmarkButton:"esri-bookmarks__bookmark-button",bookmarkImageContainer:"esri-bookmarks__bookmark-image-container",bookmarkEditButton:"esri-bookmarks__bookmark-edit-button",bookmarkDragHandle:"esri-bookmarks_bookmark-drag-handle",bookmarkDragHandleIcon:"esri-bookmarks_bookmark-drag-handle-icon",bookmarkIcon:"esri-bookmarks__bookmark-icon",bookmarkImage:"esri-bookmarks__image",bookmarkName:"esri-bookmarks__bookmark-name",bookmarkActive:"esri-bookmarks__bookmark--active",noBookmarksContainer:"esri-widget__content--empty",noBookmarksHeader:"esri-bookmarks__no-bookmarks-heading",noBookmarksIcon:"esri-widget__no-bookmark-icon",noBookmarksDescription:"esri-bookmarks__no-bookmarks-description",addingBookmark:"esri-bookmarks__adding-bookmark",addBookmark:"esri-bookmarks__add-bookmark",addBookmarkButton:"esri-bookmarks__add-bookmark-button",addBookmarkIcon:"esri-bookmarks__add-bookmark-icon",authoringCard:"esri-bookmarks__authoring-card",authoringContainer:"esri-bookmarks__authoring-container",authoringForm:"esri-bookmarks__authoring-form",authoringLabel:"esri-bookmarks__authoring-label",authoringActions:"esri-bookmarks__authoring-actions",authoringInputInvalid:"esri-bookmarks__authoring-input--invalid",authoringDeleteButton:"esri-bookmarks__authoring-delete-button",authoringCancelButton:"esri-bookmarks__authoring-cancel-button",esriWidget:"esri-widget",esriWidgetDisabled:"esri-widget--disabled",esriButton:"esri-button",esriButtonTertiary:"esri-button--tertiary",esriInput:"esri-input",iconHandle:"esri-icon-handle-vertical",iconPlus:"esri-icon-plus",iconEdit:"esri-icon-edit",iconHandleHorizontal:"esri-icon-handle-horizontal",iconRefresh:"esri-icon-refresh",iconLink:"esri-icon-link",iconRemove:"esri-icon-erase",widgetIcon:"esri-icon-bookmark",header:"esri-widget__heading",loading:"esri-icon-loading-indicator",rotating:"esri-rotating"},w={addBookmark:!0,thumbnail:!0},A=/^https:\/\/.*/i,U="esri.widgets.Bookmarks";let C=class extends z{constructor(t,o){super(t,o),this._handles=new u$2,this._addInputNode=null,this._editInputNode=null,this._urlEditInputNode=null,this._addBookmarkButtonNode=null,this._focusAddBookmarkButton=!1,this._focusEditInputBox=!1,this._focusAddInputBox=!1,this._focusUrlEditInputBox=!1,this._sortable=null,this._sortableNode=null,this._focusSortUid=null,this._selectedSortUid=null,this._sortableSavedItems=null,this._userState=null,this.defaultCreateOptions=null,this.defaultEditOptions=null,this.bookmarks=null,this.disabled=!1,this.editingEnabled=!1,this.headingLevel=2,this.goToOverride=null,this.iconClass=S.widgetIcon,this.label=void 0,this.messages=null,this.messagesCommon=null,this.messagesUnits=null,this.view=null,this.viewModel=new h,this.visibleElements={...w};}initialize(){this.own([i$1(this,"viewModel.bookmarks",(()=>this._bookmarksInitialized())),i$1(this,"editingEnabled",(()=>this._toggleSorting()))]);}destroy(){this._destroySortable(),this._handles.destroy(),this._handles=null,this._editMenu.destroy();}get _editMenuItems(){var t,o;const{messages:e,_userState:r}=this,i=null==r||null==(t=r.editedBookmark)||null==(o=t.thumbnail)?void 0:o.url;return [new c$2({label:null==e?void 0:e.menu.refreshThumbnail,iconClass:S.iconRefresh,clickFunction:()=>this._refreshThumbnail()}),new c$2({label:A.test(i)?null==e?void 0:e.menu.editImageUrl:null==e?void 0:e.menu.useImageUrl,iconClass:S.iconLink,clickFunction:()=>this._startUseImageUrl()}),i?new c$2({label:null==e?void 0:e.menu.removeThumbnail,iconClass:S.iconRemove,clickFunction:()=>this._removeThumbnail()}):null].filter(Boolean)}get _editMenu(){const{_editMenuItems:t,messages:o}=this,e=this._get("_editMenu");e&&e.destroy();const r=new _({iconClass:S.iconHandleHorizontal,label:null==o?void 0:o.menu.label});return r.items=t,r}castVisibleElements(t){return {...w,...t}}endAddBookmark(){this._userState=null;}goTo(t){return this.viewModel.goTo(t)}render(){const{state:t}=this.viewModel,o="loading"===t?this.renderLoading():this.renderBookmarks();return n$1("div",{class:this.classes(S.base,S.esriWidget,{[S.esriWidgetDisabled]:this.disabled})},o)}startAddBookmark(){this._userState=new a({state:"add"}),this._focusAddInputBox=!0,this.scheduleRender();}renderLoading(){return n$1("div",{class:S.loaderContainer,key:"loader"},n$1("div",{class:S.loader}))}renderNoBookmarksContainer(){const{messages:t}=this;return n$1("div",{class:S.noBookmarksContainer,key:"no-bookmarks"},n$1("span",{"aria-hidden":"true",class:this.classes(S.noBookmarksIcon,S.widgetIcon)}),n$1(s$3,{level:this.headingLevel,class:this.classes(S.header,S.noBookmarksHeader)},null==t?void 0:t.noBookmarksHeading),n$1("p",{class:S.noBookmarksDescription},null==t?void 0:t.noBookmarksDescription))}renderAddBookmarkLoading(){var t;return n$1("div",{key:"adding-bookmark",class:S.addingBookmark},n$1("span",{"aria-hidden":"true",class:this.classes(S.loading,S.rotating)}),null==(t=this.messages)?void 0:t.addingBookmark)}renderBookmarkItems(t){if(!t)return null;const{_userState:o,editingEnabled:e}=this;return t.map((t=>e&&t&&o&&("edit"===o.state||"edit-thumbnail"===o.state)&&o.bookmark===t?"edit-thumbnail"===o.state?this.renderEditingBookmarkUrl(o.editedBookmark):this.renderEditingBookmark(o.editedBookmark):this.renderBookmark(t))).toArray()}renderBookmarksContainer(t){var o;const{_userState:e,editingEnabled:r}=this,i="add"===(null==e?void 0:e.state),s=r&&!i?this.renderAddBookmarkButton():null,a=r?i&&e.loading?this.renderAddBookmarkLoading():"add"===(null==e?void 0:e.state)?this.renderAddingBookmark():null:null;return [n$1("ul",{key:"bookmark-list","aria-label":null==(o=this.messages)?void 0:o.widgetLabel,class:this.classes(S.bookmarkList,{[S.bookmarkListSortable]:this.editingEnabled}),afterCreate:this._sortNodeCreated,afterRemoved:this._destroySortable,"data-node-ref":"_sortableNode",bind:this},this.renderBookmarkItems(t)),s,a]}renderAddBookmarkButton(){var t;return this.visibleElements.addBookmark?n$1("div",{key:"add-bookmark-item",class:S.addBookmark},n$1("button",{class:this.classes(S.esriButton,S.esriButtonTertiary,S.addBookmarkButton),onclick:this.startAddBookmark,afterCreate:this._storeAddBookmarkButton,afterUpdate:this._storeAddBookmarkButton,"data-node-ref":"_addBookmarkButtonNode",bind:this,type:"button"},n$1("span",{"aria-hidden":"true",class:this.classes(S.addBookmarkIcon,S.iconPlus)}),null==(t=this.messages)?void 0:t.addBookmark)):null}renderBookmarks(){const{bookmarks:t}=this.viewModel,o=t&&t.filter(Boolean),e=o&&o.length,r=e||this.editingEnabled?this.renderBookmarksContainer(o):null;return [e?null:this.renderNoBookmarksContainer(),r]}renderEditContainer(t){const{messagesCommon:o}=this;return n$1("div",{key:"edit-container"},n$1("button",{title:null==o?void 0:o.edit,"aria-label":null==o?void 0:o.edit,"data-bookmark":t,onclick:this._showEditBookmarkForm,bind:this,class:S.bookmarkEditButton,type:"button"},n$1("span",{"aria-hidden":"true",class:S.iconEdit})))}renderDragHandle(t){const{messagesCommon:o}=this,e={[E]:t.uid};return n$1("div",{role:"button",tabIndex:0,key:"drag-handle",bind:this,class:S.bookmarkDragHandle,onkeydown:this._dragHandleKeydown,afterCreate:this._focusDragHandle,afterUpdate:this._focusDragHandle,onblur:this._dragHandleBlur,"aria-pressed":this._selectedSortUid===t.uid?"true":"false","aria-label":null==o?void 0:o.dragHandleLabel,title:null==o?void 0:o.dragHandleTitle,...e},n$1("span",{"aria-hidden":"true",class:this.classes(S.bookmarkDragHandleIcon,S.iconHandle)}))}renderBookmarkImageIcon(){return n$1("span",{"aria-hidden":"true",class:this.classes(S.bookmarkIcon,S.widgetIcon)})}renderBookmarkImage(t){const{visibleElements:o}=this,{thumbnail:e}=t,r=e&&e.url||"";return o.thumbnail&&r?n$1("img",{src:r,alt:"",class:S.bookmarkImage}):null}renderBookmarkButton(t){const{messagesCommon:o}=this,{name:e}=t,r=e||(null==o?void 0:o.untitled),i=n$1("div",{class:S.bookmarkImageContainer},this.renderBookmarkImage(t)||this.renderBookmarkImageIcon());return n$1("button",{key:"bookmark-button",class:S.bookmarkButton,bind:this,"data-bookmark":t,onclick:this._goToBookmark,type:"button"},i,n$1("span",{class:S.bookmarkName},r))}renderBookmark(t){const{activeBookmark:o}=this.viewModel,e={[S.bookmarkActive]:o===t},r=this.editingEnabled?this.renderEditContainer(t):null,i={[E]:t.uid},s=this.editingEnabled?this.renderDragHandle(t):null;return n$1("li",{key:t,class:this.classes(S.bookmark,e),...i},s,this.renderBookmarkButton(t),r)}renderEditingBookmarkName(t){const{messages:o,_userState:e}=this,r="name-required"===e.validationState;return n$1("label",{class:S.authoringLabel},null==o?void 0:o.title,r?n$1("strong",null,null==o?void 0:o.invalidTitle):null,n$1("input",{required:!0,bind:this,class:this.classes(S.esriInput,r?S.authoringInputInvalid:null),type:"text",value:t.name,afterCreate:this._storeEditInput,afterUpdate:this._focusEditInput,"data-bookmark":t,"data-node-ref":"_editInputNode",placeholder:null==o?void 0:o.titlePlaceholder}))}renderEditingBookmarkUrlActions(){const{messagesCommon:t}=this;return n$1("div",{class:S.authoringActions},n$1("input",{type:"button",value:null==t?void 0:t.back,class:this.classes(S.esriButton,S.esriButtonTertiary),onclick:this._closeUrlEditBookmarkForm,bind:this}),n$1("input",{class:S.esriButton,type:"submit",value:null==t?void 0:t.add}))}renderEditingBookmarkActions(){const{messagesCommon:t}=this,{bookmark:o}=this._userState;return n$1("div",{class:S.authoringActions},n$1("input",{type:"button",value:null==t?void 0:t.delete,class:this.classes(S.esriButton,S.esriButtonTertiary,S.authoringDeleteButton),"data-bookmark":o,onclick:this._deleteBookmark,bind:this}),n$1("input",{type:"button",value:null==t?void 0:t.cancel,class:this.classes(S.esriButton,S.esriButtonTertiary),onclick:this._closeEditBookmarkForm,bind:this}),n$1("input",{class:S.esriButton,type:"submit",value:null==t?void 0:t.save}))}renderEditingBookmarkUrlInput(t){var o;const{messages:e,_userState:r}=this,i=null==(o=t.thumbnail)?void 0:o.url,s=A.test(i)?i:null,a="absolute-url-required"===r.validationState;return n$1("label",{class:S.authoringLabel},a?n$1("strong",null,null==e?void 0:e.invalidImageUrl):null,n$1("input",{required:!0,bind:this,class:this.classes(S.esriInput,a?S.authoringInputInvalid:null),type:"text",value:s,afterCreate:this._storeUrlEditInput,afterUpdate:this._focusUrlEditInput,"data-bookmark":t,"data-node-ref":"_urlEditInputNode",title:null==e?void 0:e.imageUrlTooltip,placeholder:e&&`https://<${e.imageUrlPlaceholder}>`}))}renderEditingBookmarkUrl(t){const o={[E]:t.uid};return n$1("li",{key:"edit-bookmark-url-form",class:S.authoringCard,...o},n$1("form",{class:S.authoringForm,onsubmit:this._editBookmarkUrlSubmit,bind:this},this.renderEditingBookmarkUrlInput(t),this.renderEditingBookmarkUrlActions()))}renderEditingBookmark(t){const o={[E]:t.uid};return n$1("li",{key:"edit-bookmark-form",class:S.authoringCard,...o},n$1("form",{class:S.authoringForm,onsubmit:this._editBookmarkSubmit,bind:this},n$1("div",{class:S.authoringContainer},n$1("div",{class:S.bookmarkImageContainer},this.renderBookmarkImage(t),this._editMenu.render()),this.renderEditingBookmarkName(t)),this.renderEditingBookmarkActions()))}renderAddingBookmarkName(){const{_userState:t,messages:o}=this,e="name-required"===t.validationState;return n$1("label",{class:S.authoringLabel},null==o?void 0:o.title,e?n$1("strong",null,null==o?void 0:o.invalidTitle):null,n$1("input",{required:!0,bind:this,class:this.classes(S.esriInput,e?S.authoringInputInvalid:null),type:"text",afterCreate:this._storeAddInput,afterUpdate:this._focusAddInput,"data-node-ref":"_addInputNode",value:"",placeholder:null==o?void 0:o.titlePlaceholder}))}renderAddingBookmarkActions(){const{messagesCommon:t}=this;return n$1("div",{class:this.classes(S.authoringActions)},n$1("input",{type:"button",value:null==t?void 0:t.cancel,class:this.classes(S.esriButton,S.esriButtonTertiary,S.authoringCancelButton),onclick:this._endAddBookmark.bind(this),bind:this}),n$1("input",{class:S.esriButton,type:"submit",value:null==t?void 0:t.add}))}renderAddingBookmark(){return n$1("div",{key:"add-bookmark-form",class:S.authoringCard},n$1("form",{class:S.authoringForm,onsubmit:this._addBookmarkSubmit,bind:this},this.renderAddingBookmarkName(),this.renderAddingBookmarkActions()))}_dragHandleBlur(){this._selectedSortUid=null,this.scheduleRender();}_dragHandleKeydown(t){const{_sortableSavedItems:e}=this,r=["ArrowDown","ArrowUp","Escape","Tab"," ","Enter"],i=i$2(t);if(-1===r.indexOf(i))return;const{_sortable:s,_selectedSortUid:a}=this,n=s.toArray(),d=t.target.getAttribute(E),l=n.indexOf(d);if(y$1(i)){const t=a&&a===d;return this._selectedSortUid=t?null:d,this._sortableSavedItems=t?null:this._sortable.toArray(),void this.scheduleRender()}if("Tab"===i)return this._selectedSortUid=null,void this.scheduleRender();if("Escape"===i&&e)return t.stopPropagation(),this._selectedSortUid=null,this._updateSortItems(e,s,d),void this.scheduleRender();if(-1===l||!a)return;const u="ArrowUp"===i?l-1:l+1;u>=n.length||u<=-1||(I(n,l,u),this._updateSortItems(n,s,d));}_updateSortItems(t,o,e){o.sort(t),this._sortBookmarks(o),this._focusSortUid=e,this._selectedSortUid=e;}_focusDragHandle(t){const{_focusSortUid:o}=this;if(!t||!o)return;t.getAttribute(E)===o&&(t.focus(),this._focusSortUid=null);}_toggleSorting(){const{_sortable:t,_sortableNode:o,editingEnabled:e}=this;if(o)if(t)t.option("disabled",!e);else {const t=Sortable.create(o,{dataIdAttr:E,handle:`.${S.bookmarkDragHandle}`,group:y,disabled:!e,onSort:()=>this._sortBookmarks(t)});this._sortable=t;}}_sortNodeCreated(t){this._sortableNode=t,this._toggleSorting();}_sortBookmarks(t){const{bookmarks:o}=this.viewModel;if(!o)return;const e=t.toArray();o.sort(((t,o)=>{const r=e.indexOf(t.uid),i=e.indexOf(o.uid);return r>i?1:r<i?-1:0}));}_destroySortable(){const{_sortable:t}=this;t&&t.destroy(),this._sortable=null;}_endAddBookmark(){this._focusAddBookmarkButton=!0,this.endAddBookmark();}_bookmarksInitialized(){const t="bookmarks-init",{_handles:o}=this;o.remove(t),o.add($(this,"viewModel.bookmarks","change",(()=>this._bookmarksChanged())),t);}_bookmarksChanged(){const t="bookmarks-change",{bookmarks:o}=this.viewModel,{_handles:e}=this;e.remove(t);const r=o.map((t=>f(t,["active","name","thumbnail.url"],(()=>this.scheduleRender()))));e.add(r,t),this.scheduleRender();}_showEditBookmarkForm(t){const o=t.currentTarget["data-bookmark"];this._focusEditInputBox=!0,this._userState=new a({bookmark:o,state:"edit"}),this.viewModel.goTo(o),this.scheduleRender();}_closeUrlEditBookmarkForm(){this._focusEditInputBox=!0,this._userState.state="edit";}_closeEditBookmarkForm(){this._userState=null;}_addBookmarkSubmit(t){t.preventDefault();const{_addInputNode:o,_userState:e}=this,r=o&&o.value.trim();r?(e.loading=!0,this.viewModel.createBookmark().then((t=>{t.name=r,this.viewModel.bookmarks.add(t),this._endAddBookmark();}))):e.validationState="name-required";}async _editBookmarkAndClose(t,o){await this.viewModel.editBookmark(t,o),this._closeEditBookmarkForm();}_editBookmarkSubmit(t){t.preventDefault();const{_editInputNode:o,_userState:e}=this,r=o&&o.value.trim();r?(e.bookmark.name=r,e.bookmark.thumbnail=e.editedBookmark.thumbnail,this._editBookmarkAndClose(e.bookmark,{takeScreenshot:!1})):e.validationState="name-required";}_storeAddBookmarkButton(t){this._addBookmarkButtonNode=t,this._focusAddBookmark();}_storeEditInput(t){this._editInputNode=t,this._focusEditInput();}_storeAddInput(t){this._addInputNode=t,this._focusAddInput();}_storeUrlEditInput(t){this._urlEditInputNode=t,this._focusUrlEditInput();}_focusUrlEditInput(){this._urlEditInputNode&&this._focusUrlEditInputBox&&(this._focusUrlEditInputBox=!1,this._urlEditInputNode.focus());}_focusAddInput(){this._addInputNode&&this._focusAddInputBox&&(this._focusAddInputBox=!1,this._addInputNode.focus());}_focusAddBookmark(){this._addBookmarkButtonNode&&this._focusAddBookmarkButton&&(this._focusAddBookmarkButton=!1,this._addBookmarkButtonNode.focus());}_focusEditInput(){this._editInputNode&&this._focusEditInputBox&&(this._focusEditInputBox=!1,this._editInputNode.focus());}_deleteBookmark(t){const o=t.currentTarget["data-bookmark"];this.viewModel.bookmarks.remove(o);}_goToBookmark(t){const o=t.currentTarget["data-bookmark"];this.endAddBookmark(),this._closeEditBookmarkForm(),this.viewModel.goTo(o);}async _refreshThumbnail(){const{_userState:t,_editMenu:o,viewModel:e}=this;t.validationState=void 0,await e.editBookmark(this._userState.editedBookmark,{takeScreenshot:!0,captureViewpoint:!1,captureRotation:!1,captureScale:!1}),o.open=!1,this._focusEditInputBox=!0,this.scheduleRender();}_removeThumbnail(){const{_userState:t,_editMenu:o}=this;t.editedBookmark.thumbnail=null,t.validationState=void 0,o.open=!1,this._focusEditInputBox=!0,this.scheduleRender();}_startUseImageUrl(){this._userState.state="edit-thumbnail",this._editMenu.open=!1,this._focusUrlEditInputBox=!0,this.scheduleRender();}_editBookmarkUrlSubmit(t){t.preventDefault();const{_urlEditInputNode:o,_userState:e}=this,r=o.value;A.test(r)?(r&&(e.editedBookmark.thumbnail=new c({url:r})),this._closeUrlEditBookmarkForm()):e.validationState="absolute-url-required";}};e([d$1({type:a})],C.prototype,"_userState",void 0),e([d$1({readOnly:!0})],C.prototype,"_editMenuItems",null),e([d$1({readOnly:!0})],C.prototype,"_editMenu",null),e([o("viewModel.defaultCreateOptions")],C.prototype,"defaultCreateOptions",void 0),e([o("viewModel.defaultEditOptions")],C.prototype,"defaultEditOptions",void 0),e([o("viewModel.bookmarks")],C.prototype,"bookmarks",void 0),e([d$1()],C.prototype,"disabled",void 0),e([d$1()],C.prototype,"editingEnabled",void 0),e([d$1()],C.prototype,"headingLevel",void 0),e([o("viewModel.goToOverride")],C.prototype,"goToOverride",void 0),e([d$1()],C.prototype,"iconClass",void 0),e([d$1({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],C.prototype,"label",void 0),e([d$1(),e$2("esri/widgets/Bookmarks/t9n/Bookmarks")],C.prototype,"messages",void 0),e([d$1(),e$2("esri/t9n/common")],C.prototype,"messagesCommon",void 0),e([d$1(),e$2("esri/core/t9n/Units")],C.prototype,"messagesUnits",void 0),e([d$1()],C.prototype,"uiStrings",void 0),e([o("viewModel.view")],C.prototype,"view",void 0),e([d$1({type:h}),t(["select-bookmark","bookmark-edit","bookmark-select"])],C.prototype,"viewModel",void 0),e([d$1()],C.prototype,"visibleElements",void 0),e([c$1("visibleElements")],C.prototype,"castVisibleElements",null),e([d$1()],C.prototype,"endAddBookmark",null),e([d$1()],C.prototype,"startAddBookmark",null),C=e([i(U)],C);const N=C;

const arcgisBookmarksCss = "@import url('https://js.arcgis.com/next/esri/themes/light/main.css');";

let ArcGISBookmarks = class {
  constructor(hostRef) {
    registerInstance(this, hostRef);
    this.loaded = createEvent(this, "loaded", 7);
    this.position = 'bottom-left';
  }
  validateView(value) {
    if (value) {
      this.widget.view = value;
      if (this.el.parentElement.tagName.toLowerCase() !== 'arcgis-expand') {
        this.widget.view.ui.add(this.widget, this.position);
      }
    }
  }
  componentWillLoad() {
    const widget = new N({
      container: this.el,
    });
    this.widget = widget;
    if (this.view) {
      widget.view = this.view;
    }
    this.loaded.emit(true);
  }
  get el() { return getElement(this); }
  static get watchers() { return {
    "view": ["validateView"]
  }; }
};
ArcGISBookmarks.style = arcgisBookmarksCss;

export { ArcGISBookmarks as arcgis_bookmarks };
