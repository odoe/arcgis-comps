import { e as e$5, i as i$9, a1 as a$f, c as s$b, as as i$a, S as S$2, s as s$c, h as h$7, D as l$7, T as T$2, d as d$5, a3 as r$8, aT as S$3, ah as b$2, r as n$h, p as p$c, af as t$8, f as c$b, u as u$7, a as i$b, bl as t$9, bm as E$1, a7 as M, A as r$a, bn as A$1, aR as v$1, $ as $$1, aN as n$i, b as d$7, ap as j$1, bo as s$d, bp as o$8, V as e$6, g as f$6, ai as l$9, aP as s$e, bq as s$f, aJ as g$6, ar as M$1, n as n$j, k as a$h, P as g$7, br as E$2, o as o$9, _ as M$2, a0 as k, aF as L$2, aq as m$8, aU as O$1, bs as s$g, bt as I$2, aE as b$3, bu as p$e, bv as m$9, bw as S$4, aI as A$3, K as s$k, aM as o$c, bx as n$o, by as e$a, bz as k$1, bA as t$d, y as d$9, bB as o$e, W as v$4, a8 as R$1, aK as r$e, j as e$b, z as z$1, l as n$p, bd as g$8 } from './messageBundle-f75b4090.js';
import { x } from './Basemap-409fdf8e.js';
import { h as h$8 } from './Color-d1b9b54f.js';
import { n as n$e, m as m$6 } from './Portal-c5cfa317.js';
import { o as o$7 } from './compilerUtils-848c8917.js';
import { n as n$f } from './loadAll-9b2a160e.js';
import { r as r$7 } from './enumeration-d3301938.js';
import { r as r$9, c as n$g } from './opacityUtils-5e864561.js';
import { p as p$d } from './CollectionFlattener-2d3512bc.js';
import { u as u$6, f as f$4, y as y$3 } from './basemapUtils-d3dee4db.js';
import { c as c$a, p as p$b } from './TablesMixin-95a0923b.js';
import { y as y$4 } from './TimeExtent-a024c0d8.js';
import { d as d$6, l as l$8, a as a$g } from './HandleOwner-88326c19.js';
import { c as c$d, a as a$i } from './GraphicsCollection-58a35288.js';
import { v as v$2 } from './HeightModelInfo-1a6d7a08.js';
import { c as c$c } from './screenUtils-9bb7e30c.js';
import { f as f$5, D as D$1 } from './Scheduler-3464f717.js';
import { i as i$c, u as u$8, t as t$a, n as n$n, b as a$k } from './screenUtils-49015526.js';
import { m as m$7, e as e$7, d as d$8 } from './mathUtils-e16f9389.js';
import { g as g$5, l as l$a } from './heightModelInfoUtils-b573abf5.js';
import './geometry-7e07b1ba.js';
import { u as u$9 } from './Viewpoint-f60966b5.js';
import { s as s$h, o as o$a } from './common-d5b993de.js';
import { h as h$9, e as e$8, n as n$l, i as i$d, c as c$e, M as M$3, r as r$c } from './mat2d-13076132.js';
import { n as n$m } from './mat2df32-93736424.js';
import { e as e$9 } from './mat2df64-30d0a354.js';
import { s as s$j, r as r$d, M as M$4, h as h$a, i as i$e } from './mat3-6a23d9ad.js';
import { r as r$b, a as a$j, D as D$2, F, l as l$b, x as x$1, s as s$i, o as o$b, v as v$3, A as A$2, j as j$2, b as b$4 } from './vec2-5672471e.js';
import { t as t$c } from './vec2f32-29d55de5.js';
import { n as n$k, t as t$b } from './vec2f64-35868783.js';
import { H as H$2 } from './unitUtils-38774114.js';
import { o as o$d } from './capabilities-ffdc19e3.js';
import { a as a$l } from './asyncUtils-fe35d349.js';
import { t as t$e } from './accessibleHandler-feb312a0.js';
import { e as e$c } from './GoTo-148cc420.js';

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var t$7;let p$a=t$7=class extends a$f{constructor(o){super(o),this.type="none";}clone(){return new t$7({type:this.type})}};e$5([r$7({none:"none",stayAbove:"stay-above"})],p$a.prototype,"type",void 0),p$a=t$7=e$5([i$9("esri.ground.NavigationConstraint")],p$a);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var w$1;const C$2=s$b.getLogger("esri.Ground");let S$1=w$1=class extends(i$a(m$6)){constructor(r){super(r),this.opacity=1,this.surfaceColor=null,this.navigationConstraint=null,this.layers=new S$2;const e=r=>{r.parent&&r.parent!==this&&"remove"in r.parent&&r.parent.remove(r),r.parent=this,"elevation"!==r.type&&"base-elevation"!==r.type&&C$2.error(`Layer '${r.title}, id:${r.id}' of type '${r.type}' is not supported as a ground layer and will therefore be ignored. Only layers of type 'elevation' are supported.`);},t=r=>{r.parent=null;};this.layers.on("after-add",(r=>e(r.item))),this.layers.on("after-remove",(r=>t(r.item)));}initialize(){this.when().catch((r=>{C$2.error("#load()","Failed to load ground",r);})),this.resourceInfo&&this.read(this.resourceInfo.data,this.resourceInfo.context);}destroy(){const r=this.layers.removeAll();for(const e of r)e.destroy();this.layers.destroy();}normalizeCtorArgs(r){return r&&"resourceInfo"in r&&(this._set("resourceInfo",r.resourceInfo),delete(r={...r}).resourceInfo),r}set layers(r){this._set("layers",n$e(r,this._get("layers")));}writeLayers(r,e,o,t){const i=[];r?(t={...t,layerContainerType:"ground"},r.forEach((r=>{if("write"in r){const e={};o$7(r)().write(e,t)&&i.push(e);}else t&&t.messages&&t.messages.push(new s$c("layer:unsupported",`Layers (${r.title}, ${r.id}) of type '${r.declaredClass}' cannot be persisted in the ground`,{layer:r}));})),e.layers=i):e.layers=i;}load(r){return this.addResolvingPromise(this._loadFromSource(r)),Promise.resolve(this)}loadAll(){return n$f(this,(r=>{r(this.layers);}))}async queryElevation(r,e){await this.load({signal:null==e?void 0:e.signal});const{ElevationQuery:o}=await import('./ElevationQuery-52d9bb1f.js');h$7(e);const t=new o,s=this.layers.filter(L$1).toArray();return t.queryAll(s,r,e)}async createElevationSampler(r,e){await this.load({signal:null==e?void 0:e.signal});const{ElevationQuery:o}=await import('./ElevationQuery-52d9bb1f.js');h$7(e);const t=new o,s=this.layers.filter(L$1).toArray();return t.createSamplerAll(s,r,e)}clone(){const r={opacity:this.opacity,surfaceColor:l$7(this.surfaceColor),navigationConstraint:l$7(this.navigationConstraint),layers:this.layers.slice()};return this.loaded&&(r.loadStatus="loaded"),new w$1({resourceInfo:this.resourceInfo}).set(r)}read(r,e){this.resourceInfo||this._set("resourceInfo",{data:r,context:e}),super.read(r,e);}_loadFromSource(r){const e=this.resourceInfo;return e?this._loadLayersFromJSON(e.data,e.context,r):Promise.resolve(null)}_loadLayersFromJSON(r,e,o){const t=e&&e.origin||"web-scene",s=e&&e.portal||null,a=e&&e.url||null;return import('./layersCreator-1104c3e6.js').then((({populateOperationalLayers:e})=>{h$7(o);const i=[];if(r.layers&&Array.isArray(r.layers)){const o={context:{origin:t,url:a,portal:s,layerContainerType:"ground"},defaultLayerType:"ArcGISTiledElevationServiceLayer"};i.push(e(this.layers,r.layers,o));}return T$2(i)})).then((()=>{}))}};function I$1(r){return r&&"createElevationSampler"in r}function L$1(r){return "elevation"===r.type||I$1(r)}e$5([d$5({json:{read:!1}})],S$1.prototype,"layers",null),e$5([r$8("layers")],S$1.prototype,"writeLayers",null),e$5([d$5({readOnly:!0})],S$1.prototype,"resourceInfo",void 0),e$5([d$5({type:Number,nonNullable:!0,range:{min:0,max:1},json:{type:S$3,read:{reader:r$9,source:"transparency"},write:{writer:(r,e)=>{e.transparency=n$g(r);},target:"transparency"}}})],S$1.prototype,"opacity",void 0),e$5([d$5({type:h$8,json:{type:[S$3],write:(r,e)=>{e.surfaceColor=r.toJSON().slice(0,3);}}})],S$1.prototype,"surfaceColor",void 0),e$5([d$5({type:p$a,json:{write:!0}})],S$1.prototype,"navigationConstraint",void 0),S$1=w$1=e$5([i$9("esri.Ground")],S$1);const A=S$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function i$8(i){var n;return !!(i&&i.loaded&&"capabilities"in i&&null!=i&&null!=(n=i.capabilities)&&n.operations&&"supportsEditing"in i.capabilities.operations&&!0===i.capabilities.operations.supportsEditing)&&!("editingEnabled"in i&&!i.editingEnabled)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const i$7=s$b.getLogger("esri.support.groundUtils"),t$6={"world-elevation":{id:"worldElevation",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/Terrain3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"},"world-topobathymetry":{id:"worldTopoBathymetry",url:"//elevation3d.arcgis.com/arcgis/rest/services/WorldElevation3D/TopoBathy3D/ImageServer",layerType:"ArcGISTiledElevationServiceLayer"}};function a$e(r){let a=null;if("string"==typeof r)if(r in t$6){const o=t$6[r];a=new A({resourceInfo:{data:{layers:[o]}}});}else i$7.warn(`Unable to find ground definition for: ${r}. Try "world-elevation"`);else a=b$2(A,r);return a}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let f$3=class extends(c$a(p$b(n$h.EventedMixin(p$c)))){constructor(e){super(e),this.allLayers=new p$d({getCollections:()=>{var e,s,r;return [null==(e=this.basemap)?void 0:e.baseLayers,null==(s=this.ground)?void 0:s.layers,this.layers,null==(r=this.basemap)?void 0:r.referenceLayers]},getChildrenFunction:e=>"layers"in e?e.layers:null}),this.allTables=new p$d({getCollections:()=>[this.tables,this.layers],getChildrenFunction:e=>{const s=[];return "tables"in e&&s.push(e.tables),"layers"in e&&s.push(e.layers),s},itemFilterFunction:e=>{const s=e.parent;return s&&"tables"in s&&s.tables.includes(e)}}),this.basemap=null,this.editableLayers=new p$d({getCollections:()=>[this.allLayers],itemFilterFunction:i$8}),this.ground=new A,this._basemapCache=u$6();}destroy(){var e,s;this.allLayers.destroy(),this.allTables.destroy(),this.editableLayers.destroy(),null==(e=this.ground)||e.destroy(),null==(s=this.basemap)||s.destroy(),f$4(this._basemapCache),this._basemapCache=null;}castBasemap(e){return y$3(e,this._basemapCache)}castGround(e){const s=a$e(e);return t$8(s)?this._get("ground"):s}findLayerById(e){return this.allLayers.find((s=>s.id===e))}findTableById(e){return this.allTables.find((s=>s.id===e))}};e$5([d$5({readOnly:!0,dependsOn:[]})],f$3.prototype,"allLayers",void 0),e$5([d$5({readOnly:!0})],f$3.prototype,"allTables",void 0),e$5([d$5({type:x})],f$3.prototype,"basemap",void 0),e$5([c$b("basemap")],f$3.prototype,"castBasemap",null),e$5([d$5({readOnly:!0})],f$3.prototype,"editableLayers",void 0),e$5([d$5({type:A,nonNullable:!0})],f$3.prototype,"ground",void 0),e$5([c$b("ground")],f$3.prototype,"castGround",null),f$3=e$5([i$9("esri.Map")],f$3);const j=f$3;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const l$6={widthBreakpoint:{getValue(e){const i=e.viewSize[0],s=e.breakpoints,a=this.values;return i<=s.xsmall?a.xsmall:i<=s.small?a.small:i<=s.medium?a.medium:i<=s.large?a.large:a.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-width-xsmall esri-view-width-less-than-small esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",small:"esri-view-width-small esri-view-width-greater-than-xsmall esri-view-width-less-than-medium esri-view-width-less-than-large esri-view-width-less-than-xlarge",medium:"esri-view-width-medium esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-less-than-large esri-view-width-less-than-xlarge",large:"esri-view-width-large esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-less-than-xlarge",xlarge:"esri-view-width-xlarge esri-view-width-greater-than-xsmall esri-view-width-greater-than-small esri-view-width-greater-than-medium esri-view-width-greater-than-large"}},heightBreakpoint:{getValue(e){const i=e.viewSize[1],s=e.breakpoints,a=this.values;return i<=s.xsmall?a.xsmall:i<=s.small?a.small:i<=s.medium?a.medium:i<=s.large?a.large:a.xlarge},values:{xsmall:"xsmall",small:"small",medium:"medium",large:"large",xlarge:"xlarge"},valueToClassName:{xsmall:"esri-view-height-xsmall esri-view-height-less-than-small esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",small:"esri-view-height-small esri-view-height-greater-than-xsmall esri-view-height-less-than-medium esri-view-height-less-than-large esri-view-height-less-than-xlarge",medium:"esri-view-height-medium esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-less-than-large esri-view-height-less-than-xlarge",large:"esri-view-height-large esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-less-than-xlarge",xlarge:"esri-view-height-xlarge esri-view-height-greater-than-xsmall esri-view-height-greater-than-small esri-view-height-greater-than-medium esri-view-height-greater-than-large"}},orientation:{getValue(e){const i=e.viewSize,s=i[0],a=i[1],t=this.values;return a>=s?t.portrait:t.landscape},values:{portrait:"portrait",landscape:"landscape"},valueToClassName:{portrait:"esri-view-orientation-portrait",landscape:"esri-view-orientation-landscape"}}},h$6={xsmall:544,small:768,medium:992,large:1200};function n$d(e){const i=e;return i&&i.xsmall<i.small&&i.small<i.medium&&i.medium<i.large}function o$6(e,i){return i?l$6[e].valueToClassName[i].split(" "):[]}const m$5=m=>{let g=class extends m{constructor(...e){super(...e),this._breakpointsHandles=new u$7,this.orientation=null,this.widthBreakpoint=null,this.heightBreakpoint=null,this.breakpoints=h$6;}initialize(){this._breakpointsHandles.add(i$b(this,["breakpoints","size"],this._updateClassNames));}destroy(){this.destroyed||(this._removeActiveClassNames(),this._breakpointsHandles.destroy(),this._breakpointsHandles=null);}set breakpoints(e){if(e===this._get("breakpoints"))return;const i=n$d(e);if(!i){const e=JSON.stringify(h$6,null,2);console.warn("provided breakpoints are not valid, using defaults:"+e);}e=i?e:h$6,this._set("breakpoints",{...e});}_updateClassNames(){if(!this.container)return;const e=t$9.acquire(),s=t$9.acquire();let a,t=!1;for(a in l$6){const i=this[a],r=l$6[a].getValue({viewSize:this.size,breakpoints:this.breakpoints});i!==r&&(t=!0,this[a]=r,o$6(a,i).forEach((e=>s.push(e))),o$6(a,r).forEach((i=>e.push(i))));}t&&(this._applyClassNameChanges(e,s),t$9.release(e),t$9.release(s));}_applyClassNameChanges(e,i){const s=this.container;s&&(i.forEach((e=>s.classList.remove(e))),e.forEach((e=>s.classList.add(e))));}_removeActiveClassNames(){const e=this.container;if(!e)return;let i;for(i in l$6)o$6(i,this[i]).forEach((i=>e.classList.remove(i)));}};return e$5([d$5()],g.prototype,"breakpoints",null),e$5([d$5()],g.prototype,"orientation",void 0),e$5([d$5()],g.prototype,"widthBreakpoint",void 0),e$5([d$5()],g.prototype,"heightBreakpoint",void 0),g=e$5([i$9("esri.views.BreakpointsOwner")],g),g};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const a$d=a=>{let t=class extends a{async fetchPopupFeatures(e,s){await this.when();const{location:p,queryArea:a,layerViewsAndGraphics:t,clientOnlyGraphics:o}=await this._prepareFetchPopupFeatures(e,s),c=Promise.resolve(o),n=this._queryLayerPopupFeatures(a,t,s),l=n.map((e=>e.promise));return {location:p,clientOnlyGraphics:o,allGraphicsPromise:E$1([c,...l]).then(M),promisesPerLayerView:n}}_queryLayerPopupFeatures(e,r,i){return r.map((({layerView:r,graphics:p})=>{const a={clientGraphics:p,event:r$a(i)?i.event:null,signal:r$a(i)?i.signal:null,defaultPopupTemplateEnabled:!!r$a(i)&&!!i.defaultPopupTemplateEnabled},t=r.fetchPopupFeatures(e,a);return {layerView:r,promise:t}}))}_isValidPopupGraphic(e,r){return e&&!!e.getEffectivePopupTemplate(r$a(r)&&r.defaultPopupTemplateEnabled)}async _prepareFetchPopupFeatures(e,r){const{clientGraphics:s,queryArea:i,location:p}=await this._popupHitTestGraphics(e,r),a=this._getFetchPopupLayerViews(),{layerViewsAndGraphics:t,clientOnlyGraphics:o}=this._graphicsPerFetchPopupLayerView(s,a);return {clientOnlyGraphics:o,layerViewsAndGraphics:t,queryArea:i,location:p}}async _popupHitTestGraphics(e,r){const{results:s,mapPoint:i}=await this.popupHitTest(e),p=s.filter((e=>this._isValidPopupGraphic(e.graphic,r))),a=p.length?p[0].mapPoint:null;return {clientGraphics:p.map((e=>e.graphic)),queryArea:i,location:i||a}}_getFetchPopupLayerViews(){const e=[];return this.allLayerViews.forEach((r=>{this._isValidPopupLayerView(r)&&e.push(r);})),r$a(this.graphicsView)&&this._isValidPopupLayerView(this.graphicsView)&&e.push(this.graphicsView),e.reverse()}_isValidPopupLayerView(e){return r$a(e)&&(!("layer"in e)||!e.suspended)&&"fetchPopupFeatures"in e}_graphicsPerFetchPopupLayerView(e,r){const s=[],i=new Map,p=r.map((e=>{const r=[];return "layer"in e?i.set(e.layer,r):i.set(e.graphics,r),{layerView:e,graphics:r}}));for(const a of e){const e=i.get(a.layer)||i.get(a.sourceLayer)||null;e?e.push(a):s.push(a);}return {layerViewsAndGraphics:p,clientOnlyGraphics:s}}};return t=e$5([i$9("esri.views.PopupView")],t),t};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let a$c=class extends p$c{constructor(e){super(e),this.view=null,this.baseLayerViews=new S$2,this.referenceLayerViews=new S$2,this._loadingHandle=i$b(this,"view.map.basemap",(e=>{e&&e.load().catch((()=>{}));}));}destroy(){this._set("view",null),this._loadingHandle&&(this._loadingHandle.remove(),this._loadingHandle=null);}get suspended(){return !this.view||this.view.suspended}get updating(){return (!this.view||!this.view.suspended)&&!(!(this.view&&this.view.map&&this.view.map.basemap)||this.view.map.basemap.loaded)}};e$5([d$5({constructOnly:!0})],a$c.prototype,"view",void 0),e$5([d$5({readOnly:!0})],a$c.prototype,"baseLayerViews",void 0),e$5([d$5({readOnly:!0})],a$c.prototype,"referenceLayerViews",void 0),e$5([d$5({readOnly:!0})],a$c.prototype,"suspended",null),e$5([d$5({type:Boolean,readOnly:!0})],a$c.prototype,"updating",null),a$c=e$5([i$9("esri.views.BasemapView")],a$c);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const _$4=s$b.getLogger("esri.views.LayerViewManager");class g$4{constructor(e,r,t){this.layer=e,this.view=r,this.layerViewImporter=t,this._controller=new AbortController,this._deferred=A$1(),this._started=!1,this.done=!1,j$1(this._controller.signal,(()=>{const r=new s$c("cancelled:layerview-create","layerview creation cancelled",{layer:e});this._deferred.reject(r);}));}get promise(){return this._deferred.promise}destroy(){this._controller.abort();const{layerView:e}=this;if(!e)return;const{layer:r,view:i}=this;r.emit("layerview-destroy",{view:i,layerView:e}),i.emit("layerview-destroy",{layer:r,layerView:e}),this.done=!0,this.layer=null,this.layerView=null,this.view=null,this.layerViewImporter=null;}async start(){if(this._started)return;this._started=!0;const{_controller:{signal:e},layer:r,view:t}=this;this._map=t.map;try{var a,s;let l,y;if(await r.load({signal:e}),"prefetchResources"in r&&await r.prefetchResources({signal:e}),r.createLayerView)l=await r.createLayerView(t,{signal:e});else {if(!this.layerViewImporter.hasLayerViewModule(r))throw new s$c("layer:view-not-supported","No layerview implementation was found");const a=await this.layerViewImporter.importLayerView(r);h$7(e),l="default"in a?new a.default({layer:r,view:t}):new a({layer:r,view:t});}const h=()=>{y=s$d(y),l.destroyed||l.destroy(),l.layer=null,l.parent=null,l.view=null,this.done=!0;};y=j$1(e,h),h$7(e);try{await l.when();}catch(o){throw h(),o}if(!(null==(a=this._map)||null==(s=a.allLayers)?void 0:s.includes(r)))return h(),void this._deferred.reject(new s$c("view:no-layerview-for-layer","The layer has been removed from the map",{layer:r}));this.layerView=l,r.emit("layerview-create",{view:t,layerView:l}),t.emit("layerview-create",{layer:r,layerView:l}),this.done=!0,this._deferred.resolve(l);}catch(o){r.emit("layerview-create-error",{view:t,error:o}),t.emit("layerview-create-error",{layer:r,error:o}),this.done=!0,this._deferred.reject(new s$c("layerview:create-error","layerview creation failed",{layer:r,error:o}));}}}let V$1=class extends d$6{constructor(e){super(e),this._layerLayerViewInfoMap=new Map,this._watchUpdatingTracking=new l$8,this.supportsGround=!0,this._preloadLayerViewModules=()=>{var e;const r=null==(e=this.view.map)?void 0:e.allLayers;if(r)for(const i of r)this.layerViewImporter.hasLayerViewModule(i)&&this.layerViewImporter.importLayerView(i);},this._reschedule=()=>(t$8(this._workPromise)&&(this._workPromise=A$1()),this.handles.remove("reschedule"),this.handles.add(v$1(this._doWork),"reschedule"),this._workPromise.promise),this._doWork=()=>{var e,i,t;const a=this.view.map;if(this._map!==a&&(this.clear(),this._map=a),t$8(this._workPromise))return void this.notifyChange("updating");this.handles.remove("reschedule"),this.handles.remove("collection-change");const s=new p$d({getCollections:()=>this._rootCollectionNames.map((e=>this.get(e))),getChildrenFunction:e=>e&&"layers"in e?e.layers:null});if(!s)return this._workPromise.resolve(),void(this._workPromise=null);for(const r of s)this._createLayerView(r);this._refreshCollections();for(const[r,o]of this._layerLayerViewInfoMap)s.includes(r)||(this._layerLayerViewInfoMap.delete(o.layer),o.destroy());const l=s.filter((e=>"group"===e.type)).map((e=>e.layers)),n=[null==a||null==(e=a.ground)?void 0:e.layers,null==a||null==(i=a.basemap)?void 0:i.baseLayers,null==a||null==(t=a.basemap)?void 0:t.referenceLayers,null==a?void 0:a.layers,...l].filter((e=>!!e));this.handles.add(n.map((e=>this._watchUpdatingTracking.addOnCollectionChange(e,this._reschedule))),"collection-change"),this._workPromise.resolve(),this._workPromise=null;};}initialize(){this.handles.add([$$1(this,"view.map.allLayers","change",this._preloadLayerViewModules,this._preloadLayerViewModules),i$b(this.view,["map.basemap","map.ground","map.layers","ready"],this._reschedule,!0)]),this._preloadLayerViewModules(),this._reschedule();}destroy(){this.clear(),this._watchUpdatingTracking.destroy(),this._map=null;}get _layersToLayerViews(){const e=[["view.map.basemap.baseLayers","view.basemapView.baseLayerViews"],["view.map.layers","view.layerViews"],["view.map.basemap.referenceLayers","view.basemapView.referenceLayerViews"]];return this.supportsGround&&e.push(["view.map.ground.layers","view.groundView.layerViews"]),new Map(e)}get _rootCollectionNames(){return Array.from(this._layersToLayerViews.keys())}get updating(){return r$a(this._workPromise)||this._watchUpdatingTracking.updating||n$i(this._layerLayerViewInfoMap,(e=>!e.done))}get updatingRemaining(){let e=0;for(const r of this._layerLayerViewInfoMap.values())r.done||++e;return e}clear(){if(!this.destroyed){for(const e of this._layerLayerViewInfoMap.values())e.destroy();this._layerLayerViewInfoMap.clear(),this._refreshCollections();}}async whenLayerView(e){if(await this._reschedule(),!this._layerLayerViewInfoMap.has(e))throw new s$c("view:no-layerview-for-layer","No layerview has been found for the layer",{layer:e});return this._layerLayerViewInfoMap.get(e).promise}_refreshCollections(){for(const[e,r]of this._layersToLayerViews)this._populateLayerViewsOwners(this.get(e),this.get(r),this.view);this.notifyChange("updating"),this.notifyChange("updatingRemaining");}_populateLayerViewsOwners(e,r,i){if(!e||!r)return void(r&&r.removeAll());let t=0;for(const a of e){const e=this._layerLayerViewInfoMap.get(a);if(!e||!e.layerView)continue;const s=e.layerView;s.layer=a,s.parent=i,r.getItemAt(t)!==s&&r.splice(t,0,s),a.layers&&this._populateLayerViewsOwners(a.layers,s.layerViews,s),t+=1;}t<r.length&&r.splice(t,r.length);}_createLayerView(e){if(this._layerLayerViewInfoMap.has(e))return this.view.ready&&this._layerLayerViewInfoMap.get(e).start(),this.notifyChange("updating"),void this.notifyChange("updatingRemaining");e.load().catch((()=>{})),this.layerViewImporter.hasLayerViewModule(e)&&this.layerViewImporter.importLayerView(e);const r=new g$4(e,this.view,this.layerViewImporter);r.promise.then((()=>this._refreshCollections()),(r=>{var i,t;r&&(d$7(r)||"cancelled:layerview-create"===r.name)||_$4.error(`Failed to create layerview for layer title:'${null!=(i=e.title)?i:"no title"}', id:'${null!=(t=e.id)?t:"no id"}' of type '${e.type}'.`,{layer:e,error:r});this._refreshCollections();})),this._layerLayerViewInfoMap.set(e,r),this.view.ready&&r.start(),this.notifyChange("updating"),this.notifyChange("updatingRemaining");}};e$5([d$5()],V$1.prototype,"_workPromise",void 0),e$5([d$5({readOnly:!0})],V$1.prototype,"_watchUpdatingTracking",void 0),e$5([d$5({readOnly:!0})],V$1.prototype,"_layersToLayerViews",null),e$5([d$5({readOnly:!0})],V$1.prototype,"_rootCollectionNames",null),e$5([d$5()],V$1.prototype,"layerViewImporter",void 0),e$5([d$5()],V$1.prototype,"supportsGround",void 0),e$5([d$5({readOnly:!0})],V$1.prototype,"updating",null),e$5([d$5({readOnly:!0})],V$1.prototype,"updatingRemaining",null),e$5([d$5({constructOnly:!0})],V$1.prototype,"view",void 0),V$1=e$5([i$9("esri.views.LayerViewManager")],V$1);const L=V$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let i$6=class extends p$c{constructor(o){super(o),this.factor=1.5,this.offset=c$c(0,0),this.position=null,this.size=120,this.maskUrl=null,this.maskEnabled=!0,this.overlayUrl=null,this.overlayEnabled=!0,this.visible=!0;}get version(){return this.commitProperty("factor"),this.commitProperty("offset"),this.commitProperty("position"),this.commitProperty("visible"),this.commitProperty("size"),this.commitProperty("maskUrl"),this.commitProperty("maskEnabled"),this.commitProperty("overlayUrl"),this.commitProperty("overlayEnabled"),(this._get("version")||0)+1}};e$5([d$5({type:Number})],i$6.prototype,"factor",void 0),e$5([d$5({nonNullable:!0})],i$6.prototype,"offset",void 0),e$5([d$5()],i$6.prototype,"position",void 0),e$5([d$5({type:Number,range:{min:0}})],i$6.prototype,"size",void 0),e$5([d$5()],i$6.prototype,"maskUrl",void 0),e$5([d$5()],i$6.prototype,"maskEnabled",void 0),e$5([d$5()],i$6.prototype,"overlayUrl",void 0),e$5([d$5()],i$6.prototype,"overlayEnabled",void 0),e$5([d$5({readOnly:!0})],i$6.prototype,"version",null),e$5([d$5({type:Boolean})],i$6.prototype,"visible",void 0),i$6=e$5([i$9("esri.views.Magnifier")],i$6);const p$9=i$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class s$a{constructor(s,u){this._stage=s,this._textureRequests=new Map,this._frameTask=r$a(u)?u.registerTask(f$5.TEXTURE_UNLOAD):D$1;}destroy(){this._frameTask.remove(),this._textureRequests.forEach((e=>this._releaseTextureRequest(e))),this._textureRequests.clear();}fromData(e,t){const r=this.makeUid(e);let s=this._textureRequests.get(r);return s||(s={referenceCount:0,texture:t(),textureAsync:null,abortController:null},this._stage&&(this._stage.add(s.texture),this._stage.loadSynchronous(s.texture)),this._textureRequests.set(r,s)),s.referenceCount++,{uid:r,texture:s.texture,release:()=>this._release(r)}}_release(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);t?(t.referenceCount<1&&console.warn("TextureCollection: reference count is < 1 for "+e),t.referenceCount--,t.referenceCount<1&&this._frameTask.schedule((()=>this._releaseNow(e)))):console.warn(`TextureCollection: texture doesn't exist: '${e}'`);}get test(){return {textureRequests:this._textureRequests}}_releaseNow(e){if(!this._textureRequests)return;const t=this._textureRequests.get(e);!t||t.referenceCount>0||(this._releaseTextureRequest(t),this._textureRequests.delete(e));}_releaseTextureRequest(e){var t;e.texture?null==(t=this._stage)||t.remove(e.texture):e.abortController&&(e.abortController.abort(),e.abortController=null);}makeUid(t,r=null){return r$a(r)?`${t}.${r}px`:t}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const r$6=["click","double-click","immediate-click","immediate-double-click","hold","drag","key-down","key-up","pointer-down","pointer-move","pointer-up","pointer-drag","mouse-wheel","pointer-enter","pointer-leave","gamepad","focus","blur"],i$5={};function o$5(t){return !!i$5[t]}function s$9(t){for(const e of t)if(!o$5(e))return !1;return !0}r$6.forEach((t=>{i$5[t]=!0;}));class p$8{constructor(t){this.handlers=new Map,this.counter=0,this.handlerCounts=new Map,this.view=t,this.inputManager=null;}connect(t){t&&this.disconnect(),this.inputManager=t,this.handlers.forEach((({handler:t,priority:e},a)=>this.inputManager.installHandlers(a,[t],e)));}disconnect(){this.inputManager&&this.handlers.forEach(((t,e)=>this.inputManager.uninstallHandlers(e))),this.inputManager=null;}destroy(){this.disconnect(),this.handlers.clear(),this.view=null;}on(t,e,a,r){const i=Array.isArray(t)?t:t.split(",");if(!s$9(i))return i.some(o$5)&&console.error("Error: registering input events and other events on the view at the same time is not supported."),null;let p,l;Array.isArray(e)?l=e:(p=e,l=[]),"function"==typeof a?p=a:r=a,r=null!=r?r:u$8.DEFAULT;const u=this.createUniqueGroupName(),m=new c$9(this.view,i,l,p);this.handlers.set(u,{handler:m,priority:r});for(const n of i){const t=this.handlerCounts.get(n)||0;this.handlerCounts.set(n,t+1);}return this.inputManager&&this.inputManager.installHandlers(u,[m],r),{remove:()=>this.removeHandler(u,i)}}hasHandler(t){return !!this.handlerCounts.get(t)}removeHandler(t,e){if(this.handlers.has(t)){this.handlers.delete(t);for(const t of e){const e=this.handlerCounts.get(t);void 0===e?console.error("Trying to remove handler for event that has no handlers registered: ",t):1===e?this.handlerCounts.delete(t):this.handlerCounts.set(t,e-1);}}this.inputManager&&this.inputManager.uninstallHandlers(t);}createUniqueGroupName(){return this.counter+=1,`viewEvents_${this.counter}`}}class c$9 extends i$c{constructor(t,e,a,n){super(!0),this.view=t;for(const r of e)switch(r){case"click":this.registerIncoming("click",a,(t=>n(this.wrapClick(t))));break;case"double-click":this.registerIncoming("double-click",a,(t=>n(this.wrapDoubleClick(t))));break;case"immediate-click":this.registerIncoming("immediate-click",a,(t=>n(this.wrapImmediateClick(t))));break;case"immediate-double-click":this.registerIncoming("immediate-double-click",a,(t=>n(this.wrapImmediateDoubleClick(t))));break;case"hold":this.registerIncoming("hold",a,(t=>n(this.wrapHold(t))));break;case"drag":this.registerIncoming("drag",a,(t=>{const e=this.wrapDrag(t);e&&n(e);}));break;case"key-down":this.registerIncoming("key-down",a,(t=>n(this.wrapKeyDown(t))));break;case"key-up":this.registerIncoming("key-up",a,(t=>n(this.wrapKeyUp(t))));break;case"pointer-down":this.registerIncoming("pointer-down",a,(t=>n(this.wrapPointer(t,"pointer-down"))));break;case"pointer-move":this.registerIncoming("pointer-move",a,(t=>n(this.wrapPointer(t,"pointer-move"))));break;case"pointer-up":this.registerIncoming("pointer-up",a,(t=>n(this.wrapPointer(t,"pointer-up"))));break;case"pointer-drag":this.registerIncoming("pointer-drag",a,(t=>n(this.wrapPointerDrag(t))));break;case"mouse-wheel":this.registerIncoming("mouse-wheel",a,(t=>n(this.wrapMouseWheel(t))));break;case"pointer-enter":this.registerIncoming("pointer-enter",a,(t=>n(this.wrapPointer(t,"pointer-enter"))));break;case"pointer-leave":this.registerIncoming("pointer-leave",a,(t=>n(this.wrapPointer(t,"pointer-leave"))));break;case"gamepad":this.registerIncoming("gamepad",a,(t=>{n(this.wrapGamepad(t));}));break;case"focus":this.registerIncoming("focus",a,(t=>{n(this.wrapFocus(t));}));break;case"blur":this.registerIncoming("blur",a,(t=>{n(this.wrapBlur(t));}));}}wrapFocus(t){return {type:"focus",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapBlur(t){return {type:"blur",timestamp:t.timestamp,native:t.data.native,cancelable:t.cancelable,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapClick(t){const{pointerType:a,button:n,buttons:r,x:i,y:o,native:s,eventId:p}=t.data,{cancelable:c,timestamp:l}=t;return {type:"click",pointerType:a,button:n,buttons:r,x:i,y:o,native:s,timestamp:l,screenPoint:c$c(i,o),mapPoint:this.getMapPoint(i,o),eventId:p,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapDoubleClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,{cancelable:p,timestamp:c}=t;return {type:"double-click",pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:c,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:p,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,p=o.pointerId,{cancelable:c,timestamp:l}=t;return {type:"immediate-click",pointerId:p,pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:l,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapImmediateDoubleClick(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o,eventId:s}=t.data,p=o.pointerId,{cancelable:c,timestamp:l}=t;return {type:"immediate-double-click",pointerId:p,pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:l,mapPoint:this.getMapPoint(r,i),eventId:s,cancelable:c,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapHold(t){const{pointerType:e,button:a,buttons:n,x:r,y:i,native:o}=t.data,{cancelable:s,timestamp:p}=t;return {type:"hold",pointerType:e,button:a,buttons:n,x:r,y:i,native:o,timestamp:p,mapPoint:this.getMapPoint(r,i),cancelable:s,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}getMapPoint(t,a){return this.view.toMap(c$c(t,a),{exclude:[]})}wrapDrag(e){const a=e.data,{x:n,y:r}=a.center,{action:i,pointerType:o,button:s}=a;if("start"===i&&(this.latestDragStart=a),!this.latestDragStart)return;const p=a.pointer.native,c=a.buttons,{cancelable:l,timestamp:u}=e,m={x:this.latestDragStart.center.x,y:this.latestDragStart.center.y};return "end"===i&&(this.latestDragStart=void 0),{type:"drag",action:i,x:n,y:r,origin:m,pointerType:o,button:s,buttons:c,radius:a.radius,angle:m$7(a.angle),native:p,timestamp:u,cancelable:l,stopPropagation:()=>e.stopPropagation(),async:t=>e.async(t),preventDefault:()=>e.preventDefault()}}wrapKeyDown(t){const{key:e,repeat:a,native:n}=t.data,{cancelable:r,timestamp:i}=t;return {type:"key-down",key:e,repeat:a,native:n,timestamp:i,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapKeyUp(t){const{key:e,native:a}=t.data,{cancelable:n,timestamp:r}=t;return {type:"key-up",key:e,native:a,timestamp:r,cancelable:n,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointer(t,e){const{x:a,y:n,button:r,buttons:i,native:o,eventId:s}=t.data,p=o.pointerId,c=o.pointerType,{cancelable:l,timestamp:u}=t;return {type:e,x:a,y:n,pointerId:p,pointerType:c,button:r,buttons:i,native:o,timestamp:u,eventId:s,cancelable:l,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapPointerDrag(t){const{x:e,y:a,buttons:n,native:r,eventId:i}=t.data.currentEvent,{button:o}=t.data.startEvent,s=t.data.startEvent.native.pointerId,p=t.data.startEvent.native.pointerType,c=t.data.action,l={x:t.data.startEvent.x,y:t.data.startEvent.y},{cancelable:u,timestamp:m}=t;return {type:"pointer-drag",x:e,y:a,pointerId:s,pointerType:p,button:o,buttons:n,action:c,origin:l,native:r,timestamp:m,eventId:i,cancelable:u,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapMouseWheel(t){const{cancelable:e,data:a,timestamp:n}=t,{x:r,y:i,deltaY:o,native:s}=a;return {type:"mouse-wheel",x:r,y:i,deltaY:o,native:s,timestamp:n,cancelable:e,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}wrapGamepad(t){const{action:e,state:a,device:n}=t.data,{cancelable:r,timestamp:i}=t,{buttons:o,axes:s}=a;return {type:"gamepad",device:n,timestamp:i,action:e,buttons:o,axes:s,cancelable:r,stopPropagation:()=>t.stopPropagation(),async:e=>t.async(e),preventDefault:()=>t.preventDefault()}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function e$4(t){return [t.on("after-add",(t=>{const e=t.item;e.view&&e.view.ready&&!e.attached&&e.attach();})),t.on("after-remove",(t=>{const e=t.item;e.active&&(e.view.activeTool=null),e.attached&&e.detach();}))]}function a$b(t){return t.visible&&t.getEditableFlag(0)&&t.getEditableFlag(1)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class p$7{constructor(){this._pointerLocations=new Map,this._hoveredManipulators=new Map,this._grabbedManipulators=new Map,this._draggedManipulators=new Map,this._stopDrag=!1,this._currentlyActiveTool=null,this._revertToActiveTool=!1,this._cursor=null;}get cursor(){return this._cursor}handleInputEvent(t,a){const s=()=>t.stopPropagation();switch(t.type){case"pointer-move":c$8(t.pointerType)&&this._pointerLocations.set(t.pointerId,{x:t.x,y:t.y,pointerType:t.pointerType});break;case"drag":this._grabbedManipulators.size>0&&(this._stopDrag=!0),this._stopDrag&&(s(),"end"===t.action&&(this._stopDrag=!1));break;case"pointer-down":{if(!u$5(t))break;const e=t$a(t),n=this._intersect(e,t.pointerType,a.forEachTool);if(t$8(n))break;const p=this._findToolAndManipulatorByKey(n,a.forEachTool,h$5),c=o$8(p,(t=>t.manipulator)),d=o$8(p,(t=>t.tool));!(r$a(c)&&r$a(d)&&c.interactive)||c.grabbable&&c.grabbableForEvent(t)||!c.grabbing||c.dragging||this._ungrabManipulatorBeforeDragging(c,d,t),r$a(c)&&c.interactive&&c.grabbable&&c.grabbableForEvent(t)&&!c.grabbing&&(this._grabbedManipulators.set(t.pointerId,{key:n,start:e,pointerType:t.pointerType}),1===this._grabbedManipulators.size&&a.activeTool!==n.tool&&(this._currentlyActiveTool=a.activeTool,this._revertToActiveTool=!0,a.setActiveTool(n.tool)),c.grabbing=!0,c.events.emit("grab-changed",{action:"start",pointerType:t.pointerType,screenPoint:e}),s());break}case"pointer-up":this._handlePointerEnd(t,a);break;case"pointer-drag":{if(!u$5(t))break;const o=this._grabbedManipulators.get(t.pointerId),p=this._draggedManipulators.get(t.pointerId),c=o$8(o||p,(({key:t})=>t)),d=this._findManipulatorByKey(c,a.forEachTool);if(t$8(d))break;const h=t$a(t);h.x=e$7(h.x,0,a.view.width),h.y=e$7(h.y,0,a.view.height);const g=e$6(o||p).start;switch(t.action){case"start":case"update":"update"!==t.action&&1!==this._grabbedManipulators.size||(d.dragging=!0,p?d.events.emit("drag",{action:"update",start:g,screenPoint:h}):d.events.emit("drag",{action:"start",start:g,screenPoint:h,pointerType:t.pointerType}),this._draggedManipulators.set(t.pointerId,{key:e$6(c),start:g}));break;case"end":d.dragging=!1,p&&d.events.emit("drag",{action:"end",start:g,screenPoint:h}),this._draggedManipulators.delete(t.pointerId),this._handlePointerEnd(t,a);}s();break}case"immediate-click":{const e=t$a(t),r=this._intersect(e,t.pointerType,a.forEachTool),n=this._findToolAndManipulatorByKey(r,a.forEachTool,h$5);if(d$4(t)||a.forEachTool((t=>{if((!r$a(n)||n.tool!==t||t.automaticManipulatorSelection)&&t.manipulators){let e=!1;t.manipulators.forEach((({manipulator:t})=>{t.selected&&(t.selected=!1,e=!0);})),e&&t.manipulatorSelectionChanged&&t.manipulatorSelectionChanged();}})),t$8(n))break;const{manipulator:p,tool:c}=n;if(!p.interactive)break;p.selectable&&c.automaticManipulatorSelection&&(p.selected=!p.selected,c.manipulatorSelectionChanged&&c.manipulatorSelectionChanged());const u=t.native.shiftKey;p.events.emit("immediate-click",{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:u,stopPropagation:s});break}case"click":{const e=t$a(t),o=this._intersect(e,t.pointerType,a.forEachTool),r=this._findManipulatorByKey(o,a.forEachTool);if(t$8(r)||!r.interactive)break;const n=t.native.shiftKey;r.events.emit(t.type,{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:n}),s();break}case"double-click":{const e=t$a(t),o=this._intersect(e,t.pointerType,a.forEachTool),r=this._findManipulatorByKey(o,a.forEachTool);if(t$8(r)||!r.interactive)break;const n=t.native.shiftKey;r.events.emit("double-click",{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:n,stopPropagation:s});break}case"immediate-double-click":{const e=t$a(t),o=this._intersect(e,t.pointerType,a.forEachTool),r=this._findManipulatorByKey(o,a.forEachTool);if(t$8(r)||!r.interactive)break;const n=t.native.shiftKey;r.events.emit("immediate-double-click",{screenPoint:e,button:t.button,pointerType:t.pointerType,shiftKey:n,stopPropagation:s});break}}this._updateCursor(a.forEachTool);}_ungrabManipulatorBeforeDragging(t,e,i){t.grabbing=!1,t.events.emit("grab-changed",{action:"end",pointerType:i.pointerType,screenPoint:t$a(i)}),this._grabbedManipulators.forEach((({key:i},o)=>{i.tool===e&&e.manipulators.findById(i.manipulatorId)===t&&this._grabbedManipulators.delete(o);}));}_handlePointerEnd(t,e){const i=o$8(this._grabbedManipulators.get(t.pointerId),(({key:t})=>t)),n=this._findManipulatorByKey(i,e.forEachTool);r$a(n)&&!n.dragging&&(1===this._grabbedManipulators.size&&0===this._draggedManipulators.size&&this._revertToActiveTool&&(e.setActiveTool(this._currentlyActiveTool),this._revertToActiveTool=!1,this._currentlyActiveTool=null),n.grabbing&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",pointerType:t.pointerType,screenPoint:t$a(t)})),this._grabbedManipulators.delete(t.pointerId));}_cursorFromMap(e,i){let r=null;return n$i(e,(({key:t})=>{const e=this._findManipulatorByKey(t,i);return !!(r$a(e)&&e.interactive&&"cursor"in e&&e.cursor)&&(r=e.cursor,!0)})),r}_updateCursor(t){this._grabbedManipulators.size>0?this._cursor=this._cursorFromMap(this._grabbedManipulators,t)||"grabbing":this._hoveredManipulators.size>0?this._cursor=this._cursorFromMap(this._hoveredManipulators,t)||"pointer":this._cursor=null;}clearPointers(t,e,r=!0,n){const a=e=>e.tool===t&&(t$8(n)||e.manipulatorId===n);this._grabbedManipulators.forEach((({key:t,pointerType:i},r)=>{if(a(t)){this._grabbedManipulators.delete(r);const n=this._findManipulatorByKey(t,e);r$a(n)&&(n.grabbing=!1,n.events.emit("grab-changed",{action:"end",screenPoint:null,pointerType:i}));}})),this._draggedManipulators.forEach((({key:t},i)=>{if(a(t)){this._draggedManipulators.delete(i);const r=this._findManipulatorByKey(t,e);r$a(r)&&(r.dragging=!1,r.events.emit("drag",{action:"cancel"}));}})),r&&this._hoveredManipulators.forEach((({key:t},i)=>{if(a(t)){this._hoveredManipulators.delete(i);const r=this._findManipulatorByKey(t,e);r$a(r)&&(r.hovering=!1);}})),this._updateCursor(e);}_intersect(t,e,o){let r=null;return o((o=>{if(null==o.manipulators||!a$b(o))return !1;const n=o.manipulators.intersect(t,e);return !t$8(n)&&(r={manipulatorId:n.id,tool:o},!0)})),r}updateHoveredStateFromKnownPointers(t){this._pointerLocations.forEach(((e,i)=>{this._updateHoveredStateForPointerAtScreenPosition(c$c(e.x,e.y),i,e.pointerType,t);}));}handleHoverEvent(t,e){"pointer-up"!==t.type&&"immediate-click"!==t.type&&"pointer-move"!==t.type||!c$8(t.pointerType)||this._updateHoveredStateForPointerAtScreenPosition(t$a(t),t.pointerId,t.pointerType,e);}_updateHoveredStateForPointerAtScreenPosition(t,e,i,a){const s=this._intersect(t,i,a);let l=this._findManipulatorByKey(s,a);const p=o$8(this._hoveredManipulators.get(e),(({key:t})=>t)),c=this._findManipulatorByKey(p,a);r$a(l)&&!l.interactive&&(l=null),c!==l&&(r$a(c)&&(c.hovering=!1),r$a(l)?(l.hovering=!0,this._hoveredManipulators.set(e,{key:e$6(s)})):this._hoveredManipulators.delete(e),this._updateCursor(a));}_findManipulatorByKey(t,e){return this._findToolAndManipulatorByKey(t,e,h$5)?h$5.manipulator:null}_findToolAndManipulatorByKey(t,e,r){return t$8(t)?null:(r.tool=null,r.manipulator=null,e((e=>{if(e!==t.tool||null==e.manipulators||!a$b(e))return !1;const i=e.manipulators.findById(t.manipulatorId);return !!r$a(i)&&(r.manipulator=i,r.tool=e,!0)})),r.manipulator?r:null)}}function c$8(t){return "mouse"===t}function u$5(t){return "mouse"!==t.pointerType||0===t.button}function d$4(t){return !!t.native.shiftKey}const h$5={manipulator:null,tool:null};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const f$2=s$b.getLogger("esri.views.ToolViewManager"),T$1="manipulators",_$3="tools";let E=class extends d$6{constructor(t){super(t),this._manipulatorState=new p$7,this.tools=new S$2,this.cursor=null,this._forEachTool=t=>{for(const o of this.tools.items)if(t(o))return};}initialize(){this.handles.add([this.view.on(r$6,(t=>{this._handleInputEvent(t);}),u$8.TOOL),...e$4(this.tools),this.tools.on("before-add",(t=>{const o=t.item;if(null==o||this.tools.includes(o))return f$2.warn("Tool is either already in the list of tools or tool is `null`. Not adding tool."),void t.preventDefault()})),this.tools.on("before-remove",(({item:t})=>{this._manipulatorState.clearPointers(t,this._forEachTool);})),this.tools.on("change",(()=>{this._refreshToolWatchers();}))]);}destroy(){this._forEachTool((t=>t.destroy()));}set activeTool(t){if(r$a(t)&&!this.view.ready)return void f$2.error("Cannot set active tool while view is not ready.");if(t===this.activeTool)return void(r$a(t)&&f$2.warn("Tool is already active - ignoring activation request."));r$a(this.activeTool)&&this.activeTool.deactivate(),r$a(t)&&t.activate(),this._set("activeTool",t),this._removeIncompleteTools(t);const o=t$8(this.activeTool);for(const e of this.tools){e.setEditableFlag(1,o||e===this.activeTool);const t=a$b(e);!o&&t||this._manipulatorState.clearPointers(e,this._forEachTool,!t);}this._updateCursor();}get updating(){return this.updatingHandles.updating||this.tools.some((t=>t.updating))}attach(){this._forEachTool((t=>t.attach())),"3d"===this.view.type?(this._set("textures",new s$a(this.view._stage,this.view.resourceController.scheduler)),this.handles.add([this.view.state.watch("camera",(()=>{this._forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange();}));})),this.view.elevationProvider.on("elevation-change",(t=>{this._forEachManipulator((o=>{null!=o.onElevationChange&&o.onElevationChange(t);}));}))],T$1)):this.handles.add(this.view.watch("extent",(()=>{this._forEachManipulator((t=>{null!=t.onViewChange&&t.onViewChange();}));})));}detach(){r$a(this.activeTool)&&(this.activeTool=null),this._forEachTool((t=>{t.detach(),t.destroy();})),this.tools.removeAll(),this.handles.remove(T$1);}_forEachManipulator(t){this._forEachTool((o=>{o.manipulators&&o.manipulators.forEach((({manipulator:e})=>t(e,o)));}));}_handleInputEvent(t){let o=!1;const e={...t,stopPropagation:()=>{o=!0,t.stopPropagation();}};r$a(this.activeTool)?this.activeTool.handleInputEvent&&this.activeTool.handleInputEvent(e):this._forEachTool((t=>{!o&&t.attached&&t.visible&&t.handleInputEvent(e);})),!o&&"key-down"===t.type&&"Escape"===t.key&&this.activeTool&&(t.stopPropagation(),this.activeTool=null),this._manipulatorState.handleInputEvent(e,{forEachTool:this._forEachTool,activeTool:this.activeTool,setActiveTool:t=>{this.activeTool=t;},view:this.view}),!o&&r$a(this.activeTool)&&this.activeTool.handleInputEventAfter(e),this._manipulatorState.handleHoverEvent(e,this._forEachTool),this._updateCursor();}_refreshToolWatchers(){this.handles.remove(_$3),this._forEachTool((t=>{if(t instanceof p$c){const o=f$6(t,["cursor","visible","editable"],(()=>{a$b(t)||this._manipulatorState.clearPointers(t,this._forEachTool),this._updateCursor();}));this.handles.add(o,_$3);}t.manipulators&&this.handles.add(t.manipulators.on("change",(o=>{o.removed.forEach((({id:o})=>{this._manipulatorState.clearPointers(t,this._forEachTool,!0,o);})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor();})),_$3);})),this._manipulatorState.updateHoveredStateFromKnownPointers(this._forEachTool),this._updateCursor();}_updateCursor(){let t=this._manipulatorState.cursor;this._forEachTool((o=>!(!r$a(o.cursor)||!o.visible)&&(t=o.cursor,!0))),this._get("cursor")!==t&&this._set("cursor",t);}_removeIncompleteTools(t){this.tools.filter((o=>(t$8(t)||o!==t)&&!o.completed)).forEach((t=>{this.tools.remove(t),t.destroy();}));}};e$5([d$5({constructOnly:!0,nonNullable:!0})],E.prototype,"view",void 0),e$5([d$5({readOnly:!0,nonNullable:!0})],E.prototype,"textures",void 0),e$5([d$5({value:null})],E.prototype,"activeTool",null),e$5([d$5({readOnly:!0,type:S$2})],E.prototype,"tools",void 0),e$5([d$5({readOnly:!0})],E.prototype,"cursor",void 0),e$5([d$5({readOnly:!0})],E.prototype,"updating",null),E=e$5([i$9("esri.views.ToolViewManager")],E);const w=E;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let o$4=class extends p$c{constructor(e){super(),this.nativeIndex=null,this._detectedDeviceType="unknown","standard"===e.mapping?this._detectedDeviceType="standard":n$c.test(e.id)?this._detectedDeviceType="spacemouse":this._detectedDeviceType="unknown",this.nativeIndex=e.index;}get native(){return (navigator.getGamepads?navigator.getGamepads():[])[this.nativeIndex]}get deviceType(){return this._detectedDeviceType}get axisThreshold(){return a$a[this.deviceType]}};e$5([d$5({nonNullable:!0,readOnly:!0})],o$4.prototype,"nativeIndex",void 0),e$5([d$5({type:String,readOnly:!0})],o$4.prototype,"deviceType",null),e$5([d$5({type:Number,readOnly:!0})],o$4.prototype,"axisThreshold",null),o$4=e$5([i$9("esri.views.input.gamepad.GamepadInputDevice")],o$4);const n$c=new RegExp("^(3dconnexion|space(mouse|navigator|pilot|explorer))","i"),a$a={standard:.15,spacemouse:.025,unknown:0},i$4=o$4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let c$7=class extends p$c{constructor(...e){super(...e),this.devices=new S$2,this.enabledFocusMode="document";}};e$5([d$5({type:S$2.ofType(i$4),readOnly:!0})],c$7.prototype,"devices",void 0),e$5([d$5({type:["document","view","none"]})],c$7.prototype,"enabledFocusMode",void 0),c$7=e$5([i$9("esri.views.input.gamepad.GamepadSettings")],c$7);const i$3=c$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let p$6=class extends p$c{constructor(){super(...arguments),this.gamepad=new i$3;}};e$5([d$5({readOnly:!0})],p$6.prototype,"gamepad",void 0),p$6=e$5([i$9("esri.views.input.Input")],p$6);const a$9=p$6;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let s$8=class extends p$c{constructor(o){super(o),this.enabled=!0,this.device=null,this.mode="pan",this.tiltDirection="forward-down",this.velocityFactor=1;}};e$5([d$5({type:Boolean,nonNullable:!0})],s$8.prototype,"enabled",void 0),e$5([d$5({type:i$4})],s$8.prototype,"device",void 0),e$5([d$5({type:["pan","zoom"],nonNullable:!0})],s$8.prototype,"mode",void 0),e$5([d$5({type:["forward-down","forward-up"],nonNullable:!0})],s$8.prototype,"tiltDirection",void 0),e$5([d$5({type:Number,nonNullable:!0})],s$8.prototype,"velocityFactor",void 0),s$8=e$5([i$9("esri.views.navigation.gamepad.GamepadSettings")],s$8);const a$8=s$8;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let a$7=class extends p$c{constructor(o){super(o),this.browserTouchPanEnabled=!0,this.gamepad=new a$8,this.momentumEnabled=!0,this.mouseWheelZoomEnabled=!0;}};e$5([d$5({type:Boolean})],a$7.prototype,"browserTouchPanEnabled",void 0),e$5([d$5({type:a$8,nonNullable:!0})],a$7.prototype,"gamepad",void 0),e$5([d$5({type:Boolean})],a$7.prototype,"momentumEnabled",void 0),e$5([d$5({type:Boolean})],a$7.prototype,"mouseWheelZoomEnabled",void 0),a$7=e$5([i$9("esri.views.navigation.Navigation")],a$7);const p$5=a$7;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var _$2;const m$4=s$b.getLogger("esri.views.support.DefaultsFromMap"),S=10;let y$2=_$2=class extends p$c{constructor(){super(...arguments),this._handles=new u$7,this._waitTask=null,this._extentProjectController=null,this._spatialReferenceCandidates=null,this._extentCandidates=null,this.logDebugInformation=!1,this.isSpatialReferenceDone=!1,this.isTileInfoDone=!1,this.isHeightModelInfoSearching=!1,this.spatialReference=null,this.extent=null,this.heightModelInfo=null,this.vcsWkid=null,this.latestVcsWkid=null,this.mapCollectionPaths=_$2.DefaultMapCollectionPaths.slice(),this.tileInfo=null;}initialize(){this.watch("mapCollectionPaths",(()=>{this._running&&(this.reset(),this.start());}));}destroy(){this._set("view",null),this._handles=l$9(this._handles),this._cancelLoading();}get _running(){return !!(this._handles&&this._handles.size>0)}reset(){this._handles.removeAll(),this._set("isSpatialReferenceDone",!1),this._set("isTileInfoDone",!1),this._set("isHeightModelInfoSearching",!1),this._set("spatialReference",null),this._set("extent",null),this._set("heightModelInfo",null),this._set("vcsWkid",null),this._set("latestVcsWkid",null),this._set("tileInfo",null),this._spatialReferenceCandidates=null,this._extentCandidates=null;}start(){this._handles.removeAll();const e=this._updateLayerChange.bind(this);for(const t of this.mapCollectionPaths)this._handles.add($$1(this.view,`map.${t}`,"change",e,e,e,!0));this._handles.add(s$e(this,"isSpatialReferenceDone",(()=>this._updateTileInfo()),!0));}_ownerNameFromCollectionName(e){const t=e.lastIndexOf(".");return -1===t?"view":"view."+e.slice(0,t)}_ensureLoadedOwnersFromCollectionName(e){const t=this._ownerNameFromCollectionName(e).split(".");let i;for(let s=0;s<t.length&&(i=this.get(t.slice(0,s+1).join(".")),i);s++)if(i.load&&!i.isFulfilled())return {collectionName:e,owner:null,loading:i.load().catch((()=>{}))};return {collectionName:e,owner:i}}_cancelLoading(){this._waitTask=null,this._extentProjectController&&(this._extentProjectController.abort(),this._extentProjectController=null);}_updateWhen(e){let t=!0,i=!1;const s=e.catch((()=>{})).then((()=>{t?i=!0:s===this._waitTask&&this._update();}));return t=!1,i||(this._waitTask=s),i}_updateLayerChange(){this.isSpatialReferenceDone&&!this.spatialReference&&this._set("isSpatialReferenceDone",!1),this._update();}_update(){if(this._cancelLoading(),this.view){if(!this.isSpatialReferenceDone){this._debugLog("Starting search for spatial reference...");const e=this._processMapCollections((e=>this._processSpatialReferenceSource(e)));if(this._debugLog(`Search ended with status '${b$1(e)}'`),0!==e){let e=null,t=this._spatialReferenceCandidates;if(!t||t.length<1?(e=this.defaultSpatialReference,this._debugLog(`No spatial reference found, locking to default (${I(e)})`)):(this.defaultSpatialReference&&t.length>1&&t.findIndex((e=>e.equals(this.defaultSpatialReference)))>-1&&(t=[this.defaultSpatialReference]),e=t[0],this._debugLog(`Locking to ${I(e)}`)),this._set("spatialReference",e),e)if(this.extent)this._set("isSpatialReferenceDone",!0);else {const t=this.logDebugInformation;this.logDebugInformation=!1,this._processMapCollections((t=>this._findExtent(t,e))),this.logDebugInformation=t,this._projectExtentCandidate().catch((()=>{})).then((()=>this._set("isSpatialReferenceDone",!0)));}else this._set("isSpatialReferenceDone",!0);}}if(null==this.heightModelInfo&&this.view.isHeightModelInfoRequired){this._debugLog("Starting search for height model info...");const e=this._processMapCollections((e=>this._processHeightModelInfoSource(e)),(e=>g$5(e)));this._debugLog(`Search ended with status ${b$1(e)}`),this._set("isHeightModelInfoSearching",0===e);}this._updateTileInfo();}}_processMapCollections(e,t){this._preloadMapCollections(t);let i=2;return this._forAllMapCollectionSources((e=>{if(2!==i)return !1;const{collectionName:t}=e;return this._debugLog(`Processing collection ${t}...`),!(e.loading&&!this._updateWhen(e.loading))||(this._debugLog(`Collection ${e.collectionName} owner is loading -> wait`),i=0,!1)}),(s=>{if(2!==i)return !1;return null!=t&&!t(s)?(this._debugLog(`Source ${s.id} is skipped due to predicate`),!1):!s.load||s.isFulfilled()||this._updateWhen(s.load())?!((!s.load||s.isResolved())&&e(s))||(i=1,!1):(this._debugLog(`Source ${s.id} is loading -> wait`),i=0,!1)})),i}_preloadMapCollections(e){let t=S;const i=this.logDebugInformation;this.logDebugInformation=!1,this._forAllMapCollectionSources((()=>!0),(s=>{if(0===t)return !1;return !(null!=e&&!e(s))&&(s.load&&!s.isFulfilled()&&(this.logDebugInformation=i,this._debugLog(`Pre-loading source ${s.id}`),this.logDebugInformation=!1,s.load().catch((()=>{})),t--),!0)})),this.logDebugInformation=i;}_forAllMapCollectionSources(e,t){for(const i of this.mapCollectionPaths){const s=`map.${i}`,o=this._ensureLoadedOwnersFromCollectionName(s);if(!1===e(o))continue;const n=o.owner;if(!n||n.isRejected&&n.isRejected()){this._debugLog(`Collection ${s} owner is invalid or rejected -> skip`);continue}const a=this.view.get(s);a?this._forEachSource(a,t):this._debugLog(`Collection ${s} does not exist -> skip`);}}_forEachSource(e,t){for(const i of e.items)!1!==t(i)&&"layers"in i&&i.layers&&this._forEachSource(i.layers,t);}_processSpatialReferenceSource(e){let t=this._getSupportedSpatialReferences(e);return 0!==t.length&&(this._spatialReferenceCandidates?(t=s$f(t,this._spatialReferenceCandidates,((e,t)=>e.equals(t))),t.length>0?this._spatialReferenceCandidates=t:this._debugLog(`Layer ${e.id} is ignored because its supported spatial\n          references are not compatible with the previous candidates`)):this._spatialReferenceCandidates=t,1===this._spatialReferenceCandidates.length)}_findExtent(e,t){const i="fullExtents"in e&&e.fullExtents||(r$a(e.fullExtent)?[e.fullExtent]:[]),s=i.find((e=>e.spatialReference.equals(t)));if(s)return this._set("extent",s),!0;if(this._getSupportedSpatialReferences(e).length>0){const t=i.map((t=>({extent:t,layer:e}))),s=this._extentCandidates||[];this._extentCandidates=s.concat(t);}return !1}async _projectExtentCandidate(){if(!this._extentCandidates||!this._extentCandidates.length)return;const e=this.spatialReference,t=this._extentCandidates.find((t=>g$6(t.extent.spatialReference,e)));if(r$a(t))this._set("extent",e$6(M$1(t.extent,e)));else {const t=this._extentCandidates[0];this._extentProjectController=new AbortController;const i=await import('./geometryServiceUtils-ba2d6c3e.js');try{const s=await i.projectGeometry(t.extent,e,t.layer.portalItem,this._extentProjectController.signal);this._set("extent",s);}catch{}this._extentProjectController=null;}}_getSupportedSpatialReferences(e){const t="supportedSpatialReferences"in e&&e.supportedSpatialReferences||(e.spatialReference?[e.spatialReference]:[]);if(0===t.length)return this._debugLog(`Layer ${e.id} is ignored because it does not have any spatial references`),[];const i=t.filter((t=>this.view.isSpatialReferenceSupported(t,e,(e=>this._debugLog(e)))));return 0===i.length?this._debugLog(`Layer ${e.id} has spatial references but none of them are supported (or layer doesn't require locking)`):this._debugLog(`Layer ${e.id} has spatial references. Resulting candidate set: ${i.map(I).join(", ")}`),i}_processHeightModelInfoSource(e){const t=l$a(e);return !!t&&(this._set("heightModelInfo",t),this._set("isHeightModelInfoSearching",!1),e.spatialReference&&(this._set("vcsWkid",e.spatialReference.vcsWkid),this._set("latestVcsWkid",e.spatialReference.latestVcsWkid)),!0)}_updateTileInfo(){if(null!=this.tileInfo)return;if(!this.view.isTileInfoRequired())return void this._set("isTileInfoDone",!0);if(!this.isSpatialReferenceDone)return;const e=this.get("view.map");if(!e)return void this._debugLog("updateTileInfo: no map");const t=e.basemap,i=e.get("layers.0");let s=null;if(t&&"failed"!==t.loadStatus){if(!t.loaded)return this._updateWhen(t.load()),void this._debugLog("updateTileInfo: basemap still loading");const e=t&&t.get("baseLayers.0");if(e&&"failed"!==e.loadStatus){if(!e.loaded)return this._updateWhen(e.load()),void this._debugLog("updateTileInfo: first basemap layer still loading");s="tileInfo"in e&&e.tileInfo;}else {if(!i||"failed"===i.loadStatus)return this._debugLog("updateTileInfo: no tileInfo"),void this._set("isTileInfoDone",!0);if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo;}}else if(i&&"failed"!==i.loadStatus){if(!i.loaded)return this._updateWhen(i.load()),void this._debugLog("updateTileInfo: first operational layer still loading");s="tileInfo"in i&&i.tileInfo;}s&&!s.spatialReference.equals(this.spatialReference)&&(s=null),this._debugLog(`updateTileInfo: setting ${s}`),this._set("tileInfo",s),this._set("isTileInfoDone",!0);}_debugLog(e){this.logDebugInformation&&m$4.info(e);}};function I(e){return e?JSON.stringify(e.toJSON()):"undefined"}function b$1(e){switch(e){case 0:return "Waiting";case 1:return "Found";case 2:return "Exhausted"}}y$2.DefaultMapCollectionPaths=["basemap.baseLayers","layers","ground.layers","basemap.referenceLayers"],e$5([d$5()],y$2.prototype,"logDebugInformation",void 0),e$5([d$5({readOnly:!0})],y$2.prototype,"isSpatialReferenceDone",void 0),e$5([d$5({readOnly:!0})],y$2.prototype,"isTileInfoDone",void 0),e$5([d$5({readOnly:!0})],y$2.prototype,"isHeightModelInfoSearching",void 0),e$5([d$5({constructOnly:!0})],y$2.prototype,"view",void 0),e$5([d$5({readOnly:!0})],y$2.prototype,"spatialReference",void 0),e$5([d$5({readOnly:!0})],y$2.prototype,"extent",void 0),e$5([d$5({readOnly:!0})],y$2.prototype,"heightModelInfo",void 0),e$5([d$5({readOnly:!0})],y$2.prototype,"vcsWkid",void 0),e$5([d$5({readOnly:!0})],y$2.prototype,"latestVcsWkid",void 0),e$5([d$5()],y$2.prototype,"mapCollectionPaths",void 0),e$5([d$5()],y$2.prototype,"defaultSpatialReference",void 0),e$5([d$5({readOnly:!0})],y$2.prototype,"tileInfo",void 0),y$2=_$2=e$5([i$9("esri.views.support.DefaultsFromMap")],y$2);const R=y$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var z;const H$1=s$b.getLogger("esri.views.View");let W$1=z=class extends(a$g(n$h.EventedMixin(n$j(p$c)))){constructor(e){super(e),this._userSpatialReference=null,this._cursor=null,this.allLayerViews=new p$d({getCollections:()=>{var e,t,i;return [null==(e=this.basemapView)?void 0:e.baseLayerViews,null==(t=this.groundView)?void 0:t.layerViews,this.layerViews,null==(i=this.basemapView)?void 0:i.referenceLayerViews]},getChildrenFunction:e=>e.layerViews}),this.groundView=null,this.animation=null,this.basemapView=null,this.defaultsFromMap=new R({view:this}),this.fatalError=null,this.extent=null,this.graphics=new c$d,this.navigating=!1,this.layerViews=new S$2,this.magnifier=new p$9,this.padding={left:0,top:0,right:0,bottom:0},this.ready=!1,this.spatialReferenceWarningDelay=1e3,this.supportsGround=!0,this.timeExtent=null,this.type=null,this.scale=null,this.updating=!1,this.initialExtentRequired=!0,this.input=new a$9,this.navigation=new p$5,this.layerViewManager=null,this.isHeightModelInfoRequired=!1,this.width=null,this.height=null,this.resizing=!1,this.suspended=!1,this.viewEvents=new p$8(this),this.persistableViewModels=new S$2,this._isValid=!1,this._readyCycleForced=!1,this.handles.add(this.watch("preconditionsReady",(e=>{e?(this._currentSpatialReference=this.spatialReference,z.views.add(this)):(this._currentSpatialReference=null,z.views.remove(this)),this.notifyChange("spatialReference"),!e&&this.ready?(this.layerViewManager.clear(),this.toolViewManager.detach(),this._teardown()):e&&!this.ready&&(this._startup(),this.toolViewManager.attach());}),!0));}initialize(){let e;this.addResolvingPromise(this.validate().then((()=>(this._isValid=!0,a$h(this,"ready"))))),this.basemapView=new a$c({view:this}),this.layerViewManager=new L({view:this,layerViewImporter:{importLayerView:e=>this.importLayerView(e),hasLayerViewModule:e=>this.hasLayerViewModule(e)},supportsGround:this.supportsGround}),this.toolViewManager=new w({view:this}),this._resetInitialViewPropertiesFromContent(),i$b(this.defaultsFromMap,"isSpatialReferenceDone",(t=>{const i=!!(this.map&&this.map.allLayers.length>0);if(t&&!this.spatialReference&&i||!e){if(t&&!this.spatialReference&&i&&!e){const t=e=L$2(this.spatialReferenceWarningDelay);e.then((()=>{t===e&&H$1.warn("#spatialReference","no spatial reference could be derived from the currently added map layers");})).catch((()=>{}));}}else e=null;}),!0);}destroy(){if(this.destroyed)return;this.viewEvents.destroy(),this.allLayerViews.destroy(),this.navigation&&(this.navigation.destroy(),this._set("navigation",null)),this.graphics=l$9(this.graphics),this.handles.remove("defaultsFromMap"),this.defaultsFromMap.destroy(),this._set("defaultsFromMap",null),this.toolViewManager=l$9(this.toolViewManager),this.layerViewManager=l$9(this.layerViewManager),this.basemapView=l$9(this.basemapView),this.invalidate(),this._emitter.clear(),this.handles.removeAll();const e=this.map;this.map=null,null==e||e.destroy();}_startup(){this._set("ready",!0);}_teardown(){this._set("ready",!1);}whenReady(){return Promise.resolve(this)}toMap(){return H$1.error("#toMap()","Not implemented on this instance of View"),null}get heightModelInfo(){return this.getDefaultHeightModelInfo()}get interacting(){return this.navigating}get preconditionsReady(){return !!(!this.fatalError&&this._isValid&&!this._readyCycleForced&&this.map&&(!m$6.isLoadable(this.map)||this.map.loaded)&&0!==this.width&&0!==this.height&&this.spatialReference&&this.isSpatialReferenceSupported(this.spatialReference)&&(this._currentSpatialReference||!this.initialExtentRequired||this.initialExtent||this.defaultsFromMap&&this.defaultsFromMap.isSpatialReferenceDone)&&this.defaultsFromMap&&this.defaultsFromMap.isTileInfoDone)}set map(e){var t;e!==this._get("map")&&(null!=(t=e)&&t.destroyed&&(H$1.warn("#map","The provided map is already destroyed",{map:e}),e=null),m$6.isLoadable(e)&&e.load().catch((()=>{})),this.initialized&&(this.forceReadyCycle(),this._resetInitialViewPropertiesFromContent()),this._set("map",e));}get spatialReference(){let e=this._userSpatialReference||this._currentSpatialReference||this.getDefaultSpatialReference()||null;return e&&this.isHeightModelInfoRequired&&this.defaultsFromMap&&(e=e.clone(),e.vcsWkid=this.defaultsFromMap.vcsWkid,e.latestVcsWkid=this.defaultsFromMap.latestVcsWkid),e}set spatialReference(e){this._userSpatialReference=e,this._set("spatialReference",e);}get stationary(){return !this.animation&&!this.navigating&&!this.resizing}get initialExtent(){return this.defaultsFromMap&&this.defaultsFromMap.extent}get cursor(){const e=this.toolViewManager?this.toolViewManager.cursor:null;return r$a(e)?e:this._cursor||"default"}set cursor(e){this._cursor=e,this.notifyChange("cursor");}get size(){return [this.width,this.height]}whenLayerView(e){return this.layerViewManager.whenLayerView(e)}getDefaultSpatialReference(){return this.get("defaultsFromMap.spatialReference")}getDefaultHeightModelInfo(){return this.get("map.supportsHeightModelInfo")&&this.get("map.heightModelInfo")||this.get("defaultsFromMap.heightModelInfo")||null}importLayerView(e){throw new s$c("importLayerView() not implemented")}hasLayerViewModule(e){return !1}async validate(){}invalidate(){this._isValid=!1;}isSpatialReferenceSupported(e,t,i){return !0}isTileInfoRequired(){return !1}when(e,t){return this.isResolved()&&!this.ready&&H$1.warn("#when()",'Calling view.when() while the view is no longer ready but was already resolved once will resolve immediately. Use watchUtils.whenOnce(view, "ready").then(...) instead.'),super.when(e,t)}forceReadyCycle(){this.ready&&(this._readyCycleForced=!0,g$7(this,"preconditionsReady",(()=>this._readyCycleForced=!1)));}addAndActivateTool(e){this.toolViewManager.tools.add(e),this.activeTool=e;}tryFatalErrorRecovery(){this.fatalError=null;}_resetInitialViewPropertiesFromContent(){if(!this.defaultsFromMap)return;const e=()=>this.defaultsFromMap&&this.defaultsFromMap.start();this.defaultsFromMap.reset(),this._currentSpatialReference=null,this.notifyChange("spatialReference"),this.handles.remove("defaultsFromMap"),this.handles.add([f$6(this,"spatialReference",((t,i)=>{E$2(t,i)||e();})),f$6(this,"initialExtentRequired",e),v$1(e)],"defaultsFromMap");}};W$1.views=new S$2,e$5([o$9("toolViewManager.activeTool")],W$1.prototype,"activeTool",void 0),e$5([d$5({readOnly:!0})],W$1.prototype,"allLayerViews",void 0),e$5([d$5()],W$1.prototype,"groundView",void 0),e$5([d$5()],W$1.prototype,"animation",void 0),e$5([d$5()],W$1.prototype,"basemapView",void 0),e$5([d$5()],W$1.prototype,"defaultsFromMap",void 0),e$5([d$5()],W$1.prototype,"fatalError",void 0),e$5([d$5({type:M$2})],W$1.prototype,"extent",void 0),e$5([d$5(a$i(c$d,"graphics"))],W$1.prototype,"graphics",void 0),e$5([d$5({readOnly:!0,type:v$2,dependsOn:["map.heightModelInfo?","defaultsFromMap.heightModelInfo"]})],W$1.prototype,"heightModelInfo",null),e$5([d$5({readOnly:!0})],W$1.prototype,"interacting",null),e$5([d$5({readOnly:!0})],W$1.prototype,"navigating",void 0),e$5([d$5({readOnly:!0,dependsOn:["fatalError","_isValid","_readyCycleForced","map","map.loaded?","width","height","spatialReference","_currentSpatialReference","initialExtentRequired","initialExtent","defaultsFromMap.isSpatialReferenceDone","defaultsFromMap.isTileInfoDone"]})],W$1.prototype,"preconditionsReady",null),e$5([d$5({type:S$2,readOnly:!0})],W$1.prototype,"layerViews",void 0),e$5([d$5({type:p$9})],W$1.prototype,"magnifier",void 0),e$5([d$5({value:null,type:j})],W$1.prototype,"map",null),e$5([d$5()],W$1.prototype,"padding",void 0),e$5([d$5({readOnly:!0})],W$1.prototype,"ready",void 0),e$5([d$5({type:k})],W$1.prototype,"spatialReference",null),e$5([d$5()],W$1.prototype,"spatialReferenceWarningDelay",void 0),e$5([d$5()],W$1.prototype,"stationary",null),e$5([d$5({readOnly:!0})],W$1.prototype,"supportsGround",void 0),e$5([d$5({type:y$4})],W$1.prototype,"timeExtent",void 0),e$5([o$9("toolViewManager.tools")],W$1.prototype,"tools",void 0),e$5([d$5()],W$1.prototype,"toolViewManager",void 0),e$5([d$5({readOnly:!0})],W$1.prototype,"type",void 0),e$5([d$5({type:Number})],W$1.prototype,"scale",void 0),e$5([d$5({readOnly:!0})],W$1.prototype,"updating",void 0),e$5([d$5({readOnly:!0})],W$1.prototype,"initialExtentRequired",void 0),e$5([d$5({readOnly:!0,type:M$2})],W$1.prototype,"initialExtent",null),e$5([d$5()],W$1.prototype,"cursor",null),e$5([d$5({readOnly:!0})],W$1.prototype,"input",void 0),e$5([d$5({type:p$5,nonNullable:!0})],W$1.prototype,"navigation",void 0),e$5([d$5()],W$1.prototype,"layerViewManager",void 0),e$5([d$5()],W$1.prototype,"width",void 0),e$5([d$5()],W$1.prototype,"height",void 0),e$5([d$5({readOnly:!0})],W$1.prototype,"resizing",void 0),e$5([d$5({value:null,readOnly:!0})],W$1.prototype,"size",null),e$5([d$5({readOnly:!0})],W$1.prototype,"suspended",void 0),e$5([d$5({readOnly:!0})],W$1.prototype,"viewEvents",void 0),e$5([d$5({readOnly:!0})],W$1.prototype,"persistableViewModels",void 0),e$5([d$5()],W$1.prototype,"_isValid",void 0),e$5([d$5()],W$1.prototype,"_readyCycleForced",void 0),e$5([d$5()],W$1.prototype,"_currentSpatialReference",void 0),W$1=z=e$5([i$9("esri.views.View")],W$1);const P=W$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let p$4=class extends m$8{constructor(t){super(t),this.state="running",this.target=null;}initialize(){this.addResolvingPromise(new Promise(((t,s)=>this._dfd={resolve:t,reject:s})));}get done(){return "finished"===this.state||"stopped"===this.state}stop(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","stopped"),this._dfd.reject(new s$c("ViewAnimation stopped")));}finish(){"stopped"!==this.state&&"finished"!==this.state&&(this._set("state","finished"),this._dfd.resolve());}update(t,s){s||(s=O$1(t)?"waiting-for-target":"running"),this._set("target",t),this._set("state",s);}};e$5([d$5({readOnly:!0})],p$4.prototype,"done",null),e$5([d$5({readOnly:!0,type:String})],p$4.prototype,"state",void 0),e$5([d$5()],p$4.prototype,"target",void 0),p$4=e$5([i$9("esri.views.ViewAnimation")],p$4),function(t){t.State={RUNNING:"running",STOPPED:"stopped",FINISHED:"finished",WAITING_FOR_TARGET:"waiting-for-target"};}(p$4||(p$4={}));const n$b=p$4;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const W=39.37,C$1=180/Math.PI;function U$1(t,e,n){const r=o$a(e[0]/s$g.radius);return r$b(t,n?r:r-360*Math.floor((r+180)/360),o$a(.5*Math.PI-2*Math.atan(Math.exp(-e[1]/s$g.radius))))}function Q(t,e){let n=e[1];return n>89.99999?n=89.99999:n<-89.99999&&(n=-89.99999),n=Math.sin(s$h(n)),r$b(t,s$h(e[0])*s$g.radius,.5*s$g.radius*Math.log((1+n)/(1-n)))}function B(t,e,n,r){return r&&n&&!r.equals(n)&&g$6(r,n)&&r.isWebMercator?r.isWebMercator?Q(t,e):U$1(t,e):a$j(t,e)}function D(t){return t.wkid?t:t.spatialReference||k.WGS84}function T(t,e){return e.type?r$b(t,e.x,e.y):a$j(t,e)}function H(t){return H$2(t)}function J(t,e){return Math.max(t.width/e[0],t.height/e[1])*ct(t.spatialReference)}async function K(t,a,i,s){let c,u;if(!t)return null;if(Array.isArray(t)&&!t.length)return null;if(S$2.isCollection(t)&&(t=t.toArray()),Array.isArray(t)&&t.length&&"object"==typeof t[0]){const e=t.every((t=>"attributes"in t)),r=t.some((t=>!t.geometry));let o=t;if(e&&r&&a&&a.allLayerViews){const e=new Map;for(const n of t){const t=n.layer,r=e.get(t)||[],o=n.attributes[t.objectIdField];null!=o&&r.push(o),e.set(t,r);}const r=[];e.forEach(((t,e)=>{const n=a.allLayerViews.find((t=>t.layer.id===e.id));if("queryFeatures"in n){const o=e.createQuery();o.objectIds=t,o.returnGeometry=!0,r.push(n.queryFeatures(o));}}));const i=await Promise.all(r),s=[];for(const t of i)if(t&&t.features&&t.features.length)for(const e of t.features)r$a(e.geometry)&&s.push(e.geometry);o=s;}for(const t of o)s=await K(t,a,i,s);return s}if(Array.isArray(t)&&2===t.length&&"number"==typeof t[0]&&"number"==typeof t[1])c=new b$3(t);else if(t instanceof p$e)c=t;else if("geometry"in t)if(t.geometry)c=t.geometry;else if(t.layer){const e=t.layer,n=a.allLayerViews.find((t=>t.layer.id===e.id));if("queryFeatures"in n){const o=e.createQuery();o.objectIds=[t.attributes[e.objectIdField]],o.returnGeometry=!0;const a=await n.queryFeatures(o);c=m$9(a,"features",0,"geometry");}}if(t$8(c))return null;if(u="point"===c.type?new M$2({xmin:c.x,ymin:c.y,xmax:c.x,ymax:c.y,spatialReference:c.spatialReference}):c.extent,!u)return null;const f=M$1(u,i);return t$8(f)?null:s=s?s.union(f):f}function X(t){if(t&&(!Array.isArray(t)||"number"!=typeof t[0])&&("object"==typeof t||Array.isArray(t)&&"object"==typeof t[0])){if("layer"in t&&t.layer&&t.layer.minScale&&t.layer.maxScale){const e=t.layer;return {min:e.minScale,max:e.maxScale}}if(Array.isArray(t)&&t.length&&t.every((t=>"layer"in t))){let e=0,n=0;for(const r of t){const t=r.layer;t&&t.minScale&&t.maxScale&&(e=t.minScale<e?t.minScale:e,n=t.maxScale>n?t.maxScale:n);}return e&&n?{min:e,max:n}:null}}}async function Y(e,r){if(!e||!r)return new u$9({targetGeometry:new b$3,scale:0,rotation:0});let o=r.spatialReference;const{constraints:a,padding:i,viewpoint:s,size:c}=r,u=[i?c[0]-i.left-i.right:c[0],i?c[1]-i.top-i.bottom:c[1]];let f=null;e instanceof u$9?f=e:e.viewpoint?f=e.viewpoint:e.target&&"esri.Viewpoint"===e.target.declaredClass&&(f=e.target);let l=null;f&&f.targetGeometry?l=f.targetGeometry:e instanceof M$2?l=e:(e||e&&("center"in e||"extent"in e||"target"in e))&&(l=await K(e.center,r,o)||await K(e.extent,r,o)||await K(e.target,r,o)||await K(e,r,o)),!l&&s&&s.targetGeometry?l=s.targetGeometry:!l&&r.extent&&(l=r.extent);const m=D(l);if(o||(o=D(r.spatialReference||r.extent||l)),!g$6(l,o)&&m&&!m.equals(o))return null;const y=T(n$k(),l.center?l.center:l),p=new b$3(B(y,y,m,o),o);let g=null;if(f&&r$a(f.targetGeometry)&&"point"===f.targetGeometry.type)g=f.scale;else if(e.hasOwnProperty("scale")&&e.scale)g=e.scale;else if(e.hasOwnProperty("zoom")&&-1!==e.zoom&&a&&a.effectiveLODs)g=a.zoomToScale(e.zoom);else if(Array.isArray(l)||"point"===l.type||"extent"===l.type&&0===l.width&&0===l.height){const t=M$1(r.extent,o);g=r$a(t)?J(t,u):r.extent?J(r.extent,u):s.scale;}else g=g$6(l.extent,o)?J(M$1(l.extent,o),u):J(l.extent,u);const h=X(e);h&&(h.min&&h.min>g?g=h.min:h.max&&h.max<g&&(g=h.max));let x=0;f?x=f.rotation:e.hasOwnProperty("rotation")?x=e.rotation:s&&(x=s.rotation);let b=new u$9({targetGeometry:p,scale:g,rotation:x});return a&&(b=a.fit(b),a.constrainByGeometry(b),a.rotationEnabled||(b.rotation=x)),b}function Z(t,e){const n=t.targetGeometry,r=e.targetGeometry;return n.x=r.x,n.y=r.y,n.spatialReference=r.spatialReference,t.scale=e.scale,t.rotation=e.rotation,t}function $(t,e,n){return n?r$b(t,.5*(e[0]-n.right+n.left),.5*(e[1]-n.bottom+n.top)):l$b(t,e,.5)}const _$1=function(){const t=n$k();return function(e,n,r){const o=n.targetGeometry;T(t,o);const a=.5*at(n);return e.xmin=t[0]-a*r[0],e.ymin=t[1]-a*r[1],e.xmax=t[0]+a*r[0],e.ymax=t[1]+a*r[1],e.spatialReference=o.spatialReference,e}}();function tt(t,e,n,r,o){return wt(t,e,n.center),t.scale=J(n,r),o&&o.constraints&&o.constraints.constrain(t),t}function et(t,e,n,r){return mt(t,e,n,r),r$c(t,t)}const rt=function(){const t=n$k();return function(e,n,r){return F(e,ut(e,n),$(t,n,r))}}(),ot=function(){const t=e$9(),e=n$k();return function(n,r,o,a){const i=at(r),s=st(r);return r$b(e,i,i),M$3(t,e),c$e(t,t,s),i$d(t,t,rt(e,o,a)),i$d(t,t,[0,a.top-a.bottom]),r$b(n,t[4],t[5])}}();function at(t){return t.scale*it(t.targetGeometry)}function it(t){return r$a(t)&&I$2(t.spatialReference)?1/(H(t.spatialReference)*W*ft()):1}function st(t){return s$h(t.rotation)||0}function ct(t){return I$2(t)?H(t)*W*ft():1}function ut(t,e){return l$b(t,e,.5)}function ft(){return 96}const lt=function(){const t=n$k(),e=n$k(),n=n$k();return function(r,o,a,i,s,c){return x$1(t,o),l$b(e,a,.5*c),r$b(n,1/i*c,-1/i*c),n$l(r),i$d(r,r,e),s&&c$e(r,r,s),e$8(r,r,n),i$d(r,r,t),r}}(),mt=function(){const t=n$k();return function(e,n,r,o){const a=at(n),i=st(n);return T(t,n.targetGeometry),lt(e,t,r,a,i,o)}}(),yt=function(){const t=n$k();return function(e,n,r,o){const a=at(n);return T(t,n.targetGeometry),lt(e,t,r,a,0,o)}}();function pt(t){if(t.isWrappable){const e=S$4(t);return e.valid[1]-e.valid[0]}return 0}function gt(t,e){return Math.round(pt(t)/e)}function ht(t,e){return Y(t,e)}const xt=function(){const t=n$k(),e=n$k(),n=[0,0,0];return function(r,o,a){o$b(t,r,o),v$3(t,t),o$b(e,r,a),v$3(e,e),A$2(n,t,e);let i=Math.acos(j$2(t,e)/(b$4(t)*b$4(e)))*C$1;return n[2]<0&&(i=-i),isNaN(i)&&(i=0),i}}(),bt=function(){const t=n$k();return function(e,n,r,o){const a=e.targetGeometry;return Z(e,n),ot(t,n,r,o),a.x+=t[0],a.y+=t[1],e}}(),wt=function(){const t=n$k();return function(e,n,r){Z(e,n);const o=e.targetGeometry,a=D(r),i=D(o);return T(t,r),B(t,t,a,i),o.x=t[0],o.y=t[1],e}}();const Gt=function(){const t=n$k();return function(e,n,r,o,a){a||(a="center"),F(t,r,o),l$b(t,t,.5);const i=t[0],s=t[1];switch(a){case"center":r$b(t,0,0);break;case"left":r$b(t,-i,0);break;case"top":r$b(t,0,s);break;case"right":r$b(t,i,0);break;case"bottom":r$b(t,0,-s);break;case"top-left":r$b(t,-i,s);break;case"bottom-left":r$b(t,-i,-s);break;case"top-right":r$b(t,i,s);break;case"bottom-right":r$b(t,i,-s);}return Ft(e,n,t),e}}();function Mt(t,e,n){return Z(t,e),t.rotation+=n,t}function kt(t,e,n){return Z(t,e),t.rotation=n,t}const At=function(){const t=n$k();return function(e,n,r,o,a){return Z(e,n),isNaN(r)||0===r||(Pt(t,o,n,a),e.scale=n.scale*r,qt(t,t,e,a),Ft(e,e,r$b(t,t[0]-o[0],o[1]-t[1]))),e}}();function Rt(t,e,n){return Z(t,e),t.scale=n,t}const St=function(){const t=n$k();return function(e,n,r,o,a,i){return Z(e,n),isNaN(r)||0===r||(Pt(t,a,n,i),e.scale=n.scale*r,e.rotation+=o,qt(t,t,e,i),Ft(e,e,r$b(t,t[0]-a[0],a[1]-t[1]))),e}}(),vt=function(){const t=n$k(),e=n$k();return function(n,r,o,a,i,s,c){return rt(e,s,c),s$i(t,i,e),a?St(n,r,o,a,t,s):At(n,r,o,t,s)}}(),Pt=function(){const t=e$9();return function(e,n,r,o){return D$2(e,n,et(t,r,o,1))}}(),qt=function(){const t=e$9();return function(e,n,r,o){return D$2(e,n,mt(t,r,o,1))}}(),Ft=function(){const t=n$k(),e=e$9();return function(n,r,o){Z(n,r);const a=at(r),i=n.targetGeometry;return h$9(e,st(r)),e$8(e,e,t$b(a,a)),D$2(t,o,e),i.x+=t[0],i.y+=t[1],n}}();

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function n$a(){const n=new Float32Array(9);return n[0]=1,n[4]=1,n[8]=1,n}function r$5(n){const r=new Float32Array(9);return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r}function t$5(n,r,t,e,a,o,c,s,u){const l=new Float32Array(9);return l[0]=n,l[1]=r,l[2]=t,l[3]=e,l[4]=a,l[5]=o,l[6]=c,l[7]=s,l[8]=u,l}function e$3(n,r){return new Float32Array(n,r,9)}Object.freeze({__proto__:null,create:n$a,clone:r$5,fromValues:t$5,createView:e$3});

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function n$9(n){return n instanceof Float32Array&&n.length>=2}function r$4(n){return Array.isArray(n)&&n.length>=2}function t$4(t){return n$9(t)||r$4(t)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
var V;const G=[0,0];let O=V=class extends a$f{constructor(t){super(t),this._viewpoint2D={center:n$k(),rotation:0,scale:0,spatialReference:null},this.center=[0,0],this.extent=new M$2,this.id=0,this.inverseTransform=e$9(),this.resolution=0,this.rotation=0,this.scale=0,this.transform=e$9(),this.transformNoRotation=e$9(),this.displayMat3=n$a(),this.displayViewMat3=n$a(),this.viewMat3=n$a(),this.viewMat2d=n$m(),this.worldScreenWidth=0,this.size=[0,0];}set pixelRatio(t){this._set("pixelRatio",t),this._update();}set size(t){this._set("size",t),this._update();}set viewpoint(t){if(t){const s=this._viewpoint2D,i=t.targetGeometry;s.center[0]=i.x,s.center[1]=i.y,s.rotation=t.rotation,s.scale=t.scale,s.spatialReference=i.spatialReference;}this._update();}copy(t){const s=this.size,i=this.viewpoint;return i&&s?(this.viewpoint=Z(i,t.viewpoint),this._set("size",a$j(s,t.size))):(this.viewpoint=t.viewpoint.clone(),this._set("size",[t.size[0],t.size[1]])),this._set("pixelRatio",t.pixelRatio),this}clone(){return new V({size:this.size,viewpoint:this.viewpoint.clone(),pixelRatio:this.pixelRatio})}toMap(t,s,i){return t$4(s)?D$2(t,s,this.inverseTransform):(G[0]=s,G[1]=i,D$2(t,G,this.inverseTransform))}toScreen(t,s,i){return t$4(s)?D$2(t,s,this.transform):(G[0]=s,G[1]=i,D$2(t,G,this.transform))}toScreenNoRotation(t,s,i){return t$4(s)?D$2(t,s,this.transformNoRotation):(G[0]=s,G[1]=i,D$2(t,G,this.transformNoRotation))}getScreenTransform(t,s){const{center:i}=this._viewpoint2D,e=this._get("pixelRatio")||1,o=this._get("size");return lt(t,i,o,s,0,e),t}_update(){const{center:t,spatialReference:i,scale:e,rotation:o}=this._viewpoint2D,c=this._get("pixelRatio")||1,m=this._get("size"),d=new u$9({targetGeometry:new b$3(t[0],t[1],i),scale:e,rotation:o});if(this._set("viewpoint",d),!m||!i||!e)return;this.resolution=at(d),this.rotation=o,this.scale=e,this.spatialReference=i,a$j(this.center,t);const y=0!==m[0]?2/m[0]:0,_=0!==m[1]?-2/m[1]:0;s$j(this.displayMat3,y,0,0,0,_,0,-1,1,1);const x=r$d(this.viewMat3),z=t$c(m[0]/2,m[1]/2),g=t$c(-m[0]/2,-m[1]/2),b=s$h(o);M$4(x,x,z),h$a(x,x,b),M$4(x,x,g),i$e(this.displayViewMat3,this.displayMat3,x);const V=n$l(this.viewMat2d);return i$d(V,V,z),c$e(V,V,b),i$d(V,V,g),_$1(this.extent,d,m),mt(this.transform,d,m,c),r$c(this.inverseTransform,this.transform),yt(this.transformNoRotation,d,m,c),this.worldScreenWidth=gt(this.spatialReference,this.resolution),this._set("id",this.id+1),this}};e$5([d$5({readOnly:!0})],O.prototype,"id",void 0),e$5([d$5({value:1,json:{write:!0}})],O.prototype,"pixelRatio",null),e$5([d$5({json:{write:!0}})],O.prototype,"size",null),e$5([d$5({type:u$9,json:{write:!0}})],O.prototype,"viewpoint",null),O=V=e$5([i$9("esri.views.2d.ViewState")],O);const U=O;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function t$3(t,r){switch(r){case"primary":return "touch"===t.pointerType||0===t.button;case"secondary":return "touch"!==t.pointerType&&2===t.button;case"tertiary":return "touch"!==t.pointerType&&1===t.button}}function r$3(t,r){if("touch"===t.pointerType)return !1;switch(r){case"primary":return 0===t.button;case"secondary":return 2===t.button;case"tertiary":return 1===t.button}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class t$2{constructor(t){this.callbacks=t,this.currentCount=0,this.callbacks.condition||(this.callbacks.condition=()=>!0);}handle(t){const s=t.data,i=s.pointers.size;switch(s.action){case"start":this.currentCount=i,this.emitStart(t);break;case"added":this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"update":this.emitUpdate(t);break;case"removed":this.startEvent&&this.emitEnd(this.previousEvent),this.currentCount=i,this.emitStart(t);break;case"end":this.emitEnd(t),this.currentCount=0;}this.previousEvent=t;}emitStart(t){this.startEvent=t,this.callbacks.condition(this.currentCount,t)&&this.callbacks.start(this.currentCount,t,this.startEvent);}emitUpdate(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.update(this.currentCount,t,this.startEvent);}emitEnd(t){this.callbacks.condition(this.currentCount,t)&&this.callbacks.end(this.currentCount,t,this.startEvent),this.startEvent=null;}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function n$8(t){let n=t*t;return t<0&&(n*=-1),n}function a$6(t){return t.translation[0]=0,t.translation[1]=0,t.translation[2]=0,t.heading=0,t.tilt=0,t}function i$2(a,i,o){const s=o,e=a.state,r=a.device,l="forward-down"===i.tiltDirection?1:-1,c=1;return "standard"===r.deviceType?(s.translation[0]=n$8(e.axes[0]),s.translation[1]=n$8(e.axes[1]),s.translation[2]=n$8(e.buttons[7])-n$8(e.buttons[6]),s.heading=n$8(e.axes[2]),s.tilt=n$8(e.axes[3])):"spacemouse"===r.deviceType&&(s.translation[0]=1.2*n$8(e.axes[0]),s.translation[1]=1.2*n$8(e.axes[1]),s.translation[2]=2*-n$8(e.axes[2]),s.heading=1.2*n$8(e.axes[5]),s.tilt=1.2*n$8(e.axes[3])),s.tilt*=l,d$8(s.translation,s.translation,c),s}function o$3(t,n){const a=n;return a.translation[0]=t[1]-t[0],a.translation[1]=t[3]-t[2],a.translation[2]=t[4]-t[5],a.heading=t[7]-t[6],a.tilt=t[8]-t[9],a.zoom=t[10]-t[11],a}function s$7(t){return 0===t.translation[0]&&0===t.translation[1]&&0===t.translation[2]&&0===t.heading&&0===t.tilt&&0===t.zoom}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function t$1(t){const n=t.native;return n?{buttons:n.buttons.map((t=>t.pressed?t.value?t.value:1:0)),axes:n.axes.map((n=>s$6(n,t.axisThreshold)))}:{buttons:[],axes:[]}}function n$7(t,n){if(t.axes.length!==n.axes.length)return !1;if(t.buttons.length!==n.buttons.length)return !1;for(let e=0;e<t.axes.length;e++)if(t.axes[e]!==n.axes[e])return !1;for(let e=0;e<t.buttons.length;e++)if(t.buttons[e]!==n.buttons[e])return !1;return !0}function e$2(t){for(let n=0;n<t.axes.length;n++)if(0!==t.axes[n])return !1;for(let n=0;n<t.buttons.length;n++)if(0!==t.buttons[n])return !1;return !0}function s$6(t,n){const e=Math.abs(t);return e<n?0:Math.sign(t)*(e-n)/(1-n)}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class a$5{constructor(e,t){this.element=e,this.input=t,this._hasEventListeners=!1,this.onConnectGamepad=e=>{this.connectGamepad(e.gamepad);},this.onDisconnectGamepad=e=>{const t=e.gamepad,i=t.index,n=this.inputDevices[i];n&&(this.emitGamepadEvent(t,t$1(n),!1),this.inputDevices.splice(i,1),this.latestUpdate.splice(i,1),this.input.gamepad.devices.remove(n),this.ensurePollingState());},this.frameTask=null,this.latestUpdate=new Array,this.inputDevices=new Array,this.callback=null;const i="getGamepads"in window.navigator,n=window.isSecureContext;this.supported=i&&n,this.supported&&(this.forEachGamepad((e=>this.connectGamepad(e))),window.addEventListener("gamepadconnected",this.onConnectGamepad),window.addEventListener("gamepaddisconnected",this.onDisconnectGamepad),this.ensurePollingState());}destroy(){this.hasEventListeners=!1,this.supported&&(window.removeEventListener("gamepadconnected",this.onConnectGamepad),window.removeEventListener("gamepaddisconnected",this.onDisconnectGamepad));}set hasEventListeners(e){this._hasEventListeners!==e&&(this._hasEventListeners=e,this.ensurePollingState());}get eventsEnabled(){return this.supported&&this.inputDevices.length>0&&this._hasEventListeners}set onEvent(e){this.callback=e;}connectGamepad(e){const s=new i$4(e);"unknown"!==s.deviceType&&(this.inputDevices[e.index]=s,this.input.gamepad.devices.add(s)),this.ensurePollingState();}ensurePollingState(){this.eventsEnabled?this.startPolling():this.stopPolling();}startPolling(){null==this.frameTask&&(this.frameTask=A$3({update:()=>this.readGamepadState()}));}stopPolling(){null!=this.frameTask&&(this.frameTask.remove(),this.frameTask=null,this.latestUpdate=new Array);}readGamepadState(){const e=document.hasFocus(),t=this.element.contains(document.activeElement),a="document"===this.input.gamepad.enabledFocusMode&&!e||"view"===this.input.gamepad.enabledFocusMode&&!t;this.forEachGamepad((e=>{const t=this.inputDevices[e.index];if(!t)return;const d=this.latestUpdate[e.index],o=t$1(t),r=a||e$2(o);if(d){if(d.timestamp===e.timestamp)return;if(!d.active&&r)return;if(n$7(d.state,o))return}this.emitGamepadEvent(e,o,!r);}));}forEachGamepad(e){const t=window.navigator.getGamepads();for(let s=0;s<t.length;s++){const i=t[s];this.validate(i)&&e(i);}}emitGamepadEvent(e,t,s){const i=this.latestUpdate[e.index],n=i&&i.active;if(!n&&!s)return;const a=!n&&s?"start":n&&s?"update":"end";this.latestUpdate[e.index]={timestamp:e.timestamp,state:t,active:s},this.callback&&this.callback({device:this.inputDevices[e.index],state:t,action:a});}validate(e){if(!e)return !1;if(!e.connected)return !1;for(let t=0;t<e.axes.length;t++)if(isNaN(e.axes[t]))return !1;return !0}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const o$2=s$k("trident"),a$4=s$k("edge"),s$5=s$k("chrome"),r$2=s$k("ff"),h$4=s$k("safari"),l$5={touchNone:"esri-view-surface--touch-none",touchPan:"esri-view-surface--touch-pan"};class u$4{constructor(e,t){this.input=t,this._active={},this._activePointerCaptures=new Set,this._keyDownState=new Set,this._eventId=1,this._browserTouchPanningEnabled=!1,this._element=e,e.getAttribute("tabindex")||e.setAttribute("tabindex","0"),this._eventHandlers={"key-down":this._handleKey,"key-up":this._handleKey,"pointer-down":this._handlePointer,"pointer-move":this._handlePointerPreventDefault,"pointer-up":this._handlePointerPreventDefault,"pointer-enter":this._handlePointer,"pointer-leave":this._handlePointer,"pointer-cancel":this._handlePointer,"mouse-wheel":this._handleMouseWheel,"pointer-capture-lost":this._handlePointerCaptureLost},this._updateTouchAction(),this._element.addEventListener("keydown",this._preventAltKeyDefault),this._gamepadSource=new a$5(e,this.input),this._gamepadSource.onEvent=e=>this._callback("gamepad",e);}destroy(){this._callback=null,this.activeEvents=null,this._activePointerCaptures.forEach((e=>{this._releasePointerCaptureSafe(e);})),this._gamepadSource&&(this._gamepadSource.destroy(),this._gamepadSource=null),this._activePointerCaptures=null,this._removeTouchAction(),this._element.removeEventListener("keydown",this._preventAltKeyDefault);}get browserTouchPanningEnabled(){return this._browserTouchPanningEnabled}set browserTouchPanningEnabled(e){this._browserTouchPanningEnabled=e,this._updateTouchAction(),this._updateTouchEventHandling();}set onEventReceived(e){this._callback=e;}set activeEvents(e){for(const t in this._active)if(!e||!e.has(t)){const e=this._active[t];this._element.removeEventListener(c$6[t],e),delete this._active[t];}e&&e.forEach((e=>{if(!this._active[e]&&c$6[e]){const t=(this._eventHandlers[e]||this._handleDefault).bind(this,e);this._element.addEventListener(c$6[e],t),this._active[e]=t;}})),this._gamepadSource.hasEventListeners=e&&e.has("gamepad");}setPointerCapture(e,t){t?(this._element.setPointerCapture(e.pointerId),this._activePointerCaptures.add(e.pointerId)):(this._releasePointerCaptureSafe(e.pointerId),this._activePointerCaptures.delete(e.pointerId));}_updateTouchAction(){this._element.classList.remove(this._browserTouchPanningEnabled?l$5.touchNone:l$5.touchPan),this._element.classList.add(this._browserTouchPanningEnabled?l$5.touchPan:l$5.touchNone);}_updateTouchEventHandling(){this._browserTouchPanningEnabled?this._element.addEventListener("touchmove",this._preventMultiTouchPanning):this._element.removeEventListener("touchmove",this._preventMultiTouchPanning);}_removeTouchAction(){this._element.classList.remove(l$5.touchNone),this._element.classList.remove(l$5.touchPan),this._element.removeEventListener("touchmove",this._preventMultiTouchPanning);}_releasePointerCaptureSafe(e){try{if(this._element.hasPointerCapture&&!this._element.hasPointerCapture(e))return;this._element.releasePointerCapture(e);}catch(t){}}_updateNormalizedPointerLikeEvent(e,t){const n=n$n(this._element,e);return u$4.test.disableSubpixelCoordinates&&(n.x=Math.round(n.x),n.y=Math.round(n.y)),t.x=n.x,t.y=n.y,t}_handleKey(e,n){const i=a$k(n);i&&"key-up"===e&&this._keyDownState.delete(i);const o={native:n,key:i,repeat:i&&this._keyDownState.has(i)};i&&"key-down"===e&&this._keyDownState.add(o.key),this._callback(e,o);}_handlePointer(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});this._callback(e,n);}_handlePointerPreventDefault(e,t){const n=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,pointerType:t.pointerType,button:t.button,buttons:t.buttons,eventId:this._eventId++});t.preventDefault(),this._callback(e,n);}_handleMouseWheel(e,t){let n=t.deltaY;switch(t.deltaMode){case 0:(o$2||a$4)&&(n=n/document.documentElement.clientHeight*600);break;case 1:n*=30;break;case 2:n*=900;}o$2||a$4?n*=.7:s$5||h$4?n*=.6:r$2&&(n*=1.375);const i=100,l=Math.abs(n);if(l>i){const e=.02;n=n/l*200/(1+Math.exp(-e*(l-i)));}const u=this._updateNormalizedPointerLikeEvent(t,{native:t,x:0,y:0,deltaY:n});this._callback(e,u);}_handlePointerCaptureLost(e,t){this._activePointerCaptures.delete(t.pointerId),this._handleDefault(e,t);}_handleDefault(e,t){const n={native:t};t.preventDefault(),this._callback(e,n);}_preventAltKeyDefault(e){"Alt"===e.key&&e.preventDefault();}_preventMultiTouchPanning(e){e.touches.length>1&&e.preventDefault();}}u$4.test={disableSubpixelCoordinates:!1};const c$6={"key-down":"keydown","key-up":"keyup","pointer-down":"pointerdown","pointer-up":"pointerup","pointer-move":"pointermove","mouse-wheel":"wheel","pointer-capture-got":"gotpointercapture","pointer-capture-lost":"lostpointercapture","context-menu":"contextmenu","pointer-enter":"pointerenter","pointer-leave":"pointerleave","pointer-cancel":"pointercancel",focus:"focus",blur:"blur"};

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class e$1 extends i$c{constructor(){super(!0),this.registerIncoming("context-menu",(t=>{t.data.native.preventDefault();}));}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function e(t,e){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function n$6(t,e){const n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function r$1(e,n){if(n?(n.radius=0,n.center.x=0,n.center.y=0):n={radius:0,center:c$c()},0===e.length)return n;if(1===e.length)return n.center.x=e[0].x,n.center.y=e[0].y,n;if(2===e.length){const[t,r]=e,[c,s]=[r.x-t.x,r.y-t.y];return n.radius=Math.sqrt(c*c+s*s)/2,n.center.x=(t.x+r.x)/2,n.center.y=(t.y+r.y)/2,n}let r=0,c=0;for(let t=0;t<e.length;t++)r+=e[t].x,c+=e[t].y;r/=e.length,c/=e.length;const s=e.map((t=>t.x-r)),x=e.map((t=>t.y-c));let o=0,y=0,a=0,h=0,l=0,u=0,i=0;for(let t=0;t<s.length;t++){const e=s[t],n=x[t],r=e*e,c=n*n;o+=r,y+=c,a+=e*n,h+=r*e,l+=c*n,u+=e*c,i+=n*r;}const f=.5*(h+u),g=.5*(l+i),M=o*y-a*a,d=(f*y-g*a)/M,m=(o*g-a*f)/M,p=c$c(d+r,m+c);return {radius:Math.sqrt(d*d+m*m+(o+y)/e.length),center:p}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const l$4={maximumDoubleClickDelay:250,maximumDoubleClickDistance:10,maximumDoubleTouchDelay:350,maximumDoubleTouchDistance:35};class s$4 extends i$c{constructor(t=l$4.maximumDoubleClickDelay,i=l$4.maximumDoubleClickDistance,o=l$4.maximumDoubleTouchDelay,s=l$4.maximumDoubleTouchDistance,u=o$c){super(!1),this.maximumDoubleClickDelay=t,this.maximumDoubleClickDistance=i,this.maximumDoubleTouchDelay=o,this.maximumDoubleTouchDistance=s,this._clock=u,this._pointerState=new Map,this._click=this.registerOutgoing("click"),this._doubleClick=this.registerOutgoing("double-click"),this.registerIncoming("immediate-click",this._handleImmediateClick.bind(this)),this.registerIncoming("pointer-drag",this._handlePointerDrag.bind(this)),this.registerIncoming("drag",this._handleDrag.bind(this));}onUninstall(){this._pointerState.forEach((e=>{null!=e.doubleClickTimeout&&(e.doubleClickTimeout.remove(),e.doubleClickTimeout=null);}));}get hasPendingInputs(){return n$i(this._pointerState,(e=>null!=e.doubleClickTimeout))}_pointerId(e){const t=e.native;return "mouse"===t.pointerType?`${t.pointerId}:${t.button}`:`${t.pointerType}`}_handleImmediateClick(e$1){const t=e$1.data,i=this._pointerId(t),l=this._pointerState.get(i);if(l){const s="touch"===t.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;e(l.event.data,t)>s?(this._clearDoubleClickTimeout(i,!0),this._startClick(e$1)):(this._clearDoubleClickTimeout(i,!1),this._doubleClick.emit(l.event.data,void 0,l.event.modifiers));}else this._startClick(e$1);}_startClick(e){const t=this._pointerId(e.data),i="touch"===e.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;this._pointerState.set(t,{event:e,doubleClickTimeout:this._clock.setTimeout((()=>this._doubleClickTimeoutExceeded(t)),i)}),this.refreshHasPendingInputs();}_handlePointerDrag(e){const t=this._pointerId(e.data.currentEvent);this._clearDoubleClickTimeout(t,!0);}_handleDrag(e){const t=this._pointerId(e.data.pointer);this._clearDoubleClickTimeout(t,!0);}_clearDoubleClickTimeout(e,t){const i=this._pointerState.get(e);i&&(i.doubleClickTimeout.remove(),i.doubleClickTimeout=null,t&&this._doubleClickTimeoutExceeded(e),this._pointerState.delete(e),this.refreshHasPendingInputs());}_doubleClickTimeoutExceeded(e){const t=this._pointerState.get(e);this._click.emit(t.event.data,void 0,t.event.modifiers),t.doubleClickTimeout=null,this._pointerState.delete(e),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class s$3 extends i$c{constructor(t){super(!1),this.navigationTouch=t,this.startStateModifiers=new Set,this.activePointerMap=new Map,this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.drag=this.registerOutgoing("drag"),this.registerIncoming("pointer-drag",this.handlePointerDrag.bind(this)),this.registerIncoming("pointer-up",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-capture-lost",this.handlePointerUpAndPointerLost.bind(this)),this.registerIncoming("pointer-cancel",this.handlePointerUpAndPointerLost.bind(this));}createPayload(t,e,i,n){return {action:t,pointerType:this.pointerType,button:this.mouseButton,buttons:e.buttons,timestamp:n,pointers:o$1(this.activePointerMap),pointer:e,angle:i.angle,radius:i.radius,center:i.center}}addPointer(t){const e=t.native.pointerId,i=a$3(this.activePointerMap).angle,n={event:t,initialAngle:0,lastAngle:0};this.activePointerMap.set(e,n);const s=h$3(n,r(this.activePointerMap));n.initialAngle=s,n.lastAngle=s,this.updatePointerAngles(i);}updatePointer(t){if(t&&null==t.x&&null==t.y)return;const e=t.native.pointerId,i=this.activePointerMap.get(e);i?i.event=t:this.addPointer(t);}removePointer(t){const e=a$3(this.activePointerMap).angle;this.activePointerMap.delete(t),this.updatePointerAngles(e);}updatePointerAngles(t){const e=a$3(this.activePointerMap);this.activePointerMap.forEach((i=>{i.initialAngle=h$3(i,e)-t,i.lastAngle=h$3(i,e)-t;}));}emitEvent(t,e,i){const n=a$3(this.activePointerMap);this.drag.emit(this.createPayload(t,e,n,i),void 0,this.startStateModifiers);}handlePointerUpAndPointerLost(t){const i=t.data.native.pointerId,n=n$o(t.timestamp);this.activePointerMap.get(i)&&(1===this.activePointerMap.size?(this.updatePointer(t.data),!this.isCurrentDragSuppressed&&this.emitEvent("end",t.data,n),this.isDragging=!1,this.isCurrentDragSuppressed=!1,this.removePointer(i)):(this.removePointer(i),this.emitEvent("removed",t.data,n$o(t.timestamp))));}handlePointerDrag(t){const i=t.data,n=i.currentEvent,s=n$o(t.timestamp);switch(i.action){case"start":case"update":this.isDragging?this.activePointerMap.has(n.native.pointerId)?(this.updatePointer(n),!this.isCurrentDragSuppressed&&this.emitEvent("update",n,s)):(this.addPointer(n),this.emitEvent("added",n,s),this.isCurrentDragSuppressed=this.isSuppressed):(this.updatePointer(n),this.pointerType=t.data.startEvent.pointerType,this.mouseButton=t.data.startEvent.button,this.startStateModifiers=t.modifiers,this.isDragging=!0,this.isCurrentDragSuppressed=this.isSuppressed,!this.isCurrentDragSuppressed&&this.emitEvent("start",n,s));}}get isSuppressed(){return this.navigationTouch&&!this.navigationTouch.browserTouchPanEnabled&&"touch"===this.pointerType&&1===this.activePointerMap.size}}function r(e){const i=[];return e.forEach((e=>{i.push(c$c(e.event.x,e.event.y));})),r$1(i)}function a$3(t){const e=r(t);let i=0;return t.forEach((t=>{let n=h$3(t,e),s=n-t.lastAngle;for(;s>Math.PI;)s-=2*Math.PI;for(;s<-Math.PI;)s+=2*Math.PI;n=t.lastAngle+s,t.lastAngle=n;const r=n-t.initialAngle;i+=r;})),i/=t.size||1,{angle:i,radius:e.radius,center:e.center}}function o$1(t){const e=new Map;return t.forEach(((t,i)=>e.set(i,t.event))),e}function h$3(t,e){const i=t.event,n=i.x-e.center.x,s=i.y-e.center.y;return Math.atan2(s,n)}var p$3;!function(t){t[t.Left=0]="Left",t[t.Middle=1]="Middle",t[t.Right=2]="Right",t[t.Back=3]="Back",t[t.Forward=4]="Forward",t[t.Undefined=-1]="Undefined";}(p$3||(p$3={}));

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
class n$5 extends i$c{constructor(e=l$4.maximumDoubleClickDelay,o=l$4.maximumDoubleClickDistance,n=l$4.maximumDoubleTouchDelay,a=l$4.maximumDoubleTouchDistance,s=o$c){super(!1),this.maximumDoubleClickDelay=e,this.maximumDoubleClickDistance=o,this.maximumDoubleTouchDelay=n,this.maximumDoubleTouchDistance=a,this._clock=s,this._pointerState=new Map,this._immediateDoubleClick=this.registerOutgoing("immediate-double-click"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up");})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost");})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel");}));}onUninstall(){this._pointerState.forEach((t=>{t.immediateDoubleClick&&t.immediateDoubleClick.timeoutHandle.remove();})),super.onUninstall();}_handlePointerDown(t){const e=t.data,i=this._pointerId(e);if(!this._pointerState.has(i)){const t={downButton:e.native.button,immediateDoubleClick:null};this._pointerState.set(i,t),this.startCapturingPointer(e.native);}}_handlePointerLoss(t,e$1){const i=t.data,n=this._pointerId(i),a=this._pointerState.get(n);if(a&&"pointer-up"===e$1&&a.downButton===i.native.button){const e$1=a.immediateDoubleClick;if(e$1){e$1.timeoutHandle.remove();const n="touch"===t.data.native.pointerType?this.maximumDoubleTouchDistance:this.maximumDoubleClickDistance;e(e$1,t.data)>n?this._startImmediateDoubleClick(t,a):(this._immediateDoubleClick.emit(t.data,void 0,e$1.modifiers),this._removeState(i));}else this._startImmediateDoubleClick(t,a);}}_startImmediateDoubleClick(t,e){const i="touch"===t.data.native.pointerType?this.maximumDoubleTouchDelay:this.maximumDoubleClickDelay;e.immediateDoubleClick={x:t.data.x,y:t.data.y,modifiers:t.modifiers,timeoutHandle:this._clock.setTimeout((()=>this._removeState(t.data)),i)};}_pointerId(t){const e=t.native;return "mouse"===e.pointerType?`${e.pointerId}:${e.button}`:`${e.pointerType}`}_removeState(t){const e=this._pointerId(t);this._pointerState.delete(e),this.stopCapturingPointer(t.native),this.refreshHasPendingInputs();}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const n$4={maximumClickDelay:300,movementUntilMouseDrag:1.5,movementUntilPenDrag:6,movementUntilTouchDrag:6,holdDelay:500};class o extends i$c{constructor(e=n$4.maximumClickDelay,i=n$4.movementUntilMouseDrag,o=n$4.movementUntilPenDrag,r=n$4.movementUntilTouchDrag,s=n$4.holdDelay,a=o$c){super(!1),this.maximumClickDelay=e,this.movementUntilMouseDrag=i,this.movementUntilPenDrag=o,this.movementUntilTouchDrag=r,this.holdDelay=s,this._clock=a,this._pointerState=new Map,this._pointerDrag=this.registerOutgoing("pointer-drag"),this._immediateClick=this.registerOutgoing("immediate-click"),this._pointerHold=this.registerOutgoing("hold"),this.registerIncoming("pointer-down",this._handlePointerDown.bind(this)),this.registerIncoming("pointer-up",(t=>{this._handlePointerLoss(t,"pointer-up");})),this.registerIncoming("pointer-capture-lost",(t=>{this._handlePointerLoss(t,"pointer-capture-lost");})),this.registerIncoming("pointer-cancel",(t=>{this._handlePointerLoss(t,"pointer-cancel");})),this._moveHandle=this.registerIncoming("pointer-move",this._handlePointerMove.bind(this)),this._moveHandle.pause();}onUninstall(){this._pointerState.forEach((t=>{null!=t.holdTimeout&&(t.holdTimeout.remove(),t.holdTimeout=null);})),super.onUninstall();}_handlePointerDown(t){const e=t.data,i=e.native.pointerId;let n=null;0===this._pointerState.size&&(n=this._clock.setTimeout((()=>{const e=this._pointerState.get(i);if(e){if(!e.isDragging){const i=e.previousEvent;this._pointerHold.emit(i,void 0,t.modifiers),e.holdEmitted=!0;}e.holdTimeout=null;}}),this.holdDelay));const o={startEvent:e,previousEvent:e,startTimestamp:t.timestamp,isDragging:!1,downButton:e.native.button,holdTimeout:n,modifiers:new Set};this._pointerState.set(i,o),this.startCapturingPointer(e.native),this._moveHandle.resume(),this._pointerState.size>1&&this.startDragging(t);}_createPointerDragData(t,e,i){return {action:t,startEvent:e.startEvent,previousEvent:e.previousEvent,currentEvent:i}}_handlePointerMove(t){const e=t.data,n=e.native.pointerId,o=this._pointerState.get(n);if(o){if(o.isDragging)this._pointerDrag.emit(this._createPointerDragData("update",o,e),void 0,o.modifiers);else {n$6(e,o.startEvent)>this._getDragThreshold(e.native.pointerType)&&this.startDragging(t);}o.previousEvent=e;}}_getDragThreshold(t){switch(t){case"touch":return this.movementUntilTouchDrag;case"pen":return this.movementUntilPenDrag;default:return this.movementUntilMouseDrag}}startDragging(t){const e=t.data,i=e.native.pointerId;this._pointerState.forEach((n=>{null!=n.holdTimeout&&(n.holdTimeout.remove(),n.holdTimeout=null),n.isDragging||(n.modifiers=t.modifiers,n.isDragging=!0,i===n.startEvent.native.pointerId?this._pointerDrag.emit(this._createPointerDragData("start",n,e)):this._pointerDrag.emit(this._createPointerDragData("start",n,n.previousEvent),t.timestamp));}));}_handlePointerLoss(t,e){const i=t.data,n=i.native.pointerId,o=this._pointerState.get(n);if(o){if(null!=o.holdTimeout&&(o.holdTimeout.remove(),o.holdTimeout=null),o.isDragging)this._pointerDrag.emit(this._createPointerDragData("end",o,"pointer-up"===e?i:o.previousEvent),void 0,o.modifiers);else if("pointer-up"===e&&o.downButton===i.native.button){t.timestamp-o.startTimestamp<=this.maximumClickDelay&&!o.holdEmitted&&this._immediateClick.emit(i);}this._pointerState.delete(n),this.stopCapturingPointer(i.native),0===this._pointerState.size&&this._moveHandle.pause();}}}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const t={checkMajorWebPerformanceCaveat:!0};function s$2(s){s={...t,...s};const o=o$d();return o.available?s.checkMajorWebPerformanceCaveat&&o.majorPerformanceCaveat?new s$c("webgl:major-performance-caveat-detected","Your WebGL implementation doesn't seem to support hardware accelerated rendering. Check your browser settings or if your GPU is in a blocklist."):o.supportsHighPrecisionFragment?o.supportsVertexShaderSamplers?o.supportsElementIndexUint?o.supportsStandardDerivatives?o.supportsInstancedArrays?null:new s$c("webgl:instanced-arrays-required","WebGL support for instanced rendering is required but not supported."):new s$c("webgl:standard-derivatives-required","WebGL support for standard derivatives is required but not supported."):new s$c("webgl:element-index-uint-required","WebGL support for uint vertex indices is required but not supported."):new s$c("webgl:vertex-shader-samplers-required","WebGL support for vertex shader samplers is required but not supported."):new s$c("webgl:high-precision-fragment-required","WebGL support for high precision fragment shaders is required but not supported."):new s$c("webgl:required","WebGL is required but not supported.")}

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function i$1(t){return t&&"nodeType"in t}function d$3(t){return t&&"function"==typeof t.render}const c$5={component:"esri-component"};let p$2=class extends p$c{constructor(){super(...arguments),this.widget=null;}destroy(){this.widget&&this.widget.destroy(),this.node=null;}get id(){return this.get("widget.id")||this.get("node.id")}set node(t){const o=this._get("node");t!==o&&(t&&t.classList.add(c$5.component),o&&o.classList.remove(c$5.component),this._set("node",t));}castNode(t){return t?"string"==typeof t||i$1(t)?(this._set("widget",null),e$a(t)):(d$3(t)&&!t.domNode&&(t.domNode=document.createElement("div")),this._set("widget",t),t.domNode):(this._set("widget",null),null)}};e$5([d$5({dependsOn:[]})],p$2.prototype,"id",null),e$5([d$5()],p$2.prototype,"node",null),e$5([c$b("node")],p$2.prototype,"castNode",null),e$5([d$5({readOnly:!0})],p$2.prototype,"widget",void 0),p$2=e$5([i$9("esri.views.ui.Component")],p$2);const l$3=p$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const h$2={left:0,top:0,bottom:0,right:0},m$3={bottom:30,top:15,right:15,left:15},u$3="manual",f$1={ui:"esri-ui",corner:"esri-ui-corner",innerContainer:"esri-ui-inner-container",manualContainer:"esri-ui-manual-container",cornerContainer:"esri-ui-corner-container",topLeft:"esri-ui-top-left",topRight:"esri-ui-top-right",bottomLeft:"esri-ui-bottom-left",bottomRight:"esri-ui-bottom-right"};function _(t){return t&&!t._started&&"function"==typeof t.postMixInProperties&&"function"==typeof t.buildRendering&&"function"==typeof t.postCreate&&"function"==typeof t.startup}function g$3(t){const o=t,i="object"==typeof o&&null!==o&&Object.getPrototypeOf(o);return (null===i||i===Object.prototype)&&("component"in o||"index"in o||"position"in o)?t:null}function y$1(t,{top:o,bottom:i,left:e,right:n}){t.style.top=o,t.style.bottom=i,t.style.left=e,t.style.right=n;}let C=class extends n$h.EventedAccessor{constructor(t){super(t),this._cornerNameToContainerLookup={},this._positionNameToContainerLookup={},this._components=new Array,this._componentToKey=new Map,this._handles=new u$7,this.view=null,this._initContainers();}initialize(){this._handles.add([i$b(this,"view.padding, container",this._applyViewPadding.bind(this)),i$b(this,"padding",this._applyUIPadding.bind(this))]);}destroy(){this.container=null;for(const t of this._components)t.destroy();this._components.length=0,this._handles.destroy(),this._componentToKey.clear();}set container(t){const i=this._get("container");t!==i&&(t&&(t.classList.add(f$1.ui),t.classList.add(k$1()),this._attachContainers(t)),i&&(i.classList.remove(f$1.ui),y$1(i,{top:"",bottom:"",left:"",right:""}),t$d(i)),this._set("container",t));}get height(){const t=this.get("view.height")||0;if(0===t)return t;const o=this._getViewPadding(),i=o.top+o.bottom;return Math.max(t-i,0)}get padding(){return this._get("padding")}set padding(t){t?this._override("padding",t):this._clearOverride("padding");}castPadding(t){return "number"==typeof t?{bottom:t,top:t,right:t,left:t}:{...m$3,...t}}get width(){const t=this.get("view.width")||0;if(0===t)return t;const o=this._getViewPadding(),i=o.left+o.right;return Math.max(t-i,0)}add(t,o){let i,e;if(Array.isArray(t))return void t.forEach((t=>this.add(t,o)));const n=g$3(t);n&&({index:i,position:o,component:t,key:e}=n),o&&"object"==typeof o&&({index:i,key:e,position:o}=o),!t||o&&!this._isValidPosition(o)||this._add(t,o,i,e);}remove(t,o){if(!t)return;if(Array.isArray(t))return t.map((t=>this.remove(t,o)));const i=this._find(t);if(i){const e=this._componentToKey;if(e.has(t)&&e.get(t)!==o)return;const n=this._components.indexOf(i);return i.node.parentNode&&i.node.parentNode.removeChild(i.node),this._componentToKey.delete(t),this._components.splice(n,1)[0]}}empty(t){if(Array.isArray(t))return t.map((t=>this.empty(t))).reduce(((t,o)=>t.concat(o)));if((t=t||u$3)===u$3){return Array.prototype.slice.call(this._manualContainer.children).filter((t=>!t.classList.contains(f$1.corner))).map((t=>this.remove(t)))}return this._isValidPosition(t)?Array.prototype.slice.call(this._cornerNameToContainerLookup[t].children).map(this.remove,this):null}move(t,o){if(Array.isArray(t)&&t.forEach((t=>this.move(t,o))),!t)return;let i;const e=g$3(t)||g$3(o);if(e&&(i=e.index,o=e.position,t=e.component||t),o&&!this._isValidPosition(o))return;const n=this.remove(t);n&&this.add(n,{position:o,index:i});}find(t){if(!t)return null;const o=this._findById(t);return o&&(o.widget||o.node)}getPosition(t){for(const o in this._positionNameToContainerLookup){if(this._positionNameToContainerLookup[o].contains(t))return o}return null}_add(t,o,i,e){t instanceof l$3||(t=new l$3({node:t})),this._place({component:t,position:o,index:i}),this._components.push(t),e&&this._componentToKey.set(t,e);}_find(t){return t?t instanceof l$3?this._findByComponent(t):"string"==typeof t?this._findById(t):this._findByNode(t.domNode||t):null}_getViewPadding(){return this.get("view.padding")||h$2}_attachContainers(t){t.appendChild(this._innerContainer),t.appendChild(this._manualContainer);}_initContainers(){const t=document.createElement("div");t.classList.add(f$1.innerContainer),t.classList.add(f$1.cornerContainer);const o=document.createElement("div");o.classList.add(f$1.innerContainer),o.classList.add(f$1.manualContainer);const i=document.createElement("div");i.classList.add(f$1.topLeft),i.classList.add(f$1.corner),t.appendChild(i);const e=document.createElement("div");e.classList.add(f$1.topRight),e.classList.add(f$1.corner),t.appendChild(e);const n=document.createElement("div");n.classList.add(f$1.bottomLeft),n.classList.add(f$1.corner),t.appendChild(n);const r=document.createElement("div");r.classList.add(f$1.bottomRight),r.classList.add(f$1.corner),t.appendChild(r),this._innerContainer=t,this._manualContainer=o;const s=d$9();this._cornerNameToContainerLookup={"top-left":i,"top-right":e,"bottom-left":n,"bottom-right":r,"top-leading":s?e:i,"top-trailing":s?i:e,"bottom-leading":s?r:n,"bottom-trailing":s?n:r},this._positionNameToContainerLookup={manual:o,...this._cornerNameToContainerLookup};}_isValidPosition(t){return !!this._positionNameToContainerLookup[t]}_place(t){const o=t.component,e=t.position||u$3,n=t.index,r=this._positionNameToContainerLookup[e],s=n>-1;if(_(o.widget)&&o.widget.startup(),!s)return void r.appendChild(o.node);const a=Array.prototype.slice.call(r.children);if(0===n)return void(r.firstChild?o$e(o.node,r.firstChild):r.appendChild(o.node));n>=a.length?r.appendChild(o.node):o$e(o.node,a[n]);}_applyViewPadding(){const t=this.container;t&&y$1(t,this._toPxPosition(this._getViewPadding()));}_applyUIPadding(){const t=this._innerContainer;t&&y$1(t,this._toPxPosition(this.padding));}_toPxPosition(t){return {top:this._toPxUnit(t.top),left:this._toPxUnit(t.left),right:this._toPxUnit(t.right),bottom:this._toPxUnit(t.bottom)}}_toPxUnit(t){return 0===t?"0":t+"px"}_findByComponent(t){let o,i=null;return this._components.some((e=>(o=e===t,o&&(i=e),o))),i}_findById(t){let o,i=null;return this._components.some((e=>(o=e.id===t,o&&(i=e),o))),i}_findByNode(t){let o,i=null;return this._components.some((e=>(o=e.node===t,o&&(i=e),o))),i}};e$5([d$5()],C.prototype,"container",null),e$5([d$5()],C.prototype,"height",null),e$5([d$5({value:m$3})],C.prototype,"padding",null),e$5([c$b("padding")],C.prototype,"castPadding",null),e$5([d$5()],C.prototype,"view",void 0),e$5([d$5()],C.prototype,"width",null),C=e$5([i$9("esri.views.ui.UI")],C);const v=C;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
function p$1(t,e){return t&&"copyright"in t&&(!e||"function"==typeof t.originOf&&"user"===t.originOf("copyright"))}function d$2(t,e){return t.length!==e.length||t.some(((t,i)=>t.text!==e[i].text))}function m$2(t,e,i){if(!i||!e)return;t.find((t=>t.layerView===e&&t.text===i))||t.push({text:i,layerView:e});}function f(t){return "bing-maps"===t.type}const b=[];let y=class extends d$6{constructor(t){super(t),this.clear=()=>{this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.handles.remove("suspension"),this.notifyChange("state");},this._pendingAttributions=new Set,this._fetchedAttributionData=new Map,this.items=new S$2,this.view=null,this._allLayerViewsChange=t=>{this.handles.remove("suspension");const e=this.get("view.allLayerViews");e&&this.handles.add(e.map((t=>t.watch(["suspended","attributionVisible"],this._updateAttributionItems))),"suspension"),t&&t.removed&&t.removed.forEach((t=>{this._pendingAttributions.delete(t),this._fetchedAttributionData.delete(t);})),this._updateAttributionItems();},this._updateAttributionItems=()=>{const t=this.get("view.allLayerViews");b.length=0,t?(t.forEach((t=>{if(t.suspended||!t.get("layer.attributionVisible"))return;const e=t.layer;if(p$1(e,"user"))return void m$2(b,t,e.copyright);if(e.hasAttributionData){if(this._fetchedAttributionData.has(t)){const i=this._fetchedAttributionData.get(t);return void(i?m$2(b,t,this._getDynamicAttribution(i,this.view,e)):p$1(e)&&m$2(b,t,e.copyright))}return void this._fetchAttributionData(t)}const i=e.get("portalItem.accessInformation");m$2(b,t,i||e.copyright);})),d$2(this.items,b)&&(this.items.removeAll(),this.items.addMany(b)),b.length=0,this.notifyChange("state")):this.clear();},this.handles.add([$$1(this,"view.allLayerViews","change",this._allLayerViewsChange,this._allLayerViewsChange,this.clear),v$4(this,"view.stationary",(()=>this._updateAttributionItems()))]);}destroy(){this.view=null,this._fetchedAttributionData.clear(),this._pendingAttributions.clear(),this.items.removeAll();}get state(){return this.get("view.ready")?this._pendingAttributions.size>0?"loading":"ready":"disabled"}async _fetchAttributionData(t){if(this._pendingAttributions.has(t))return;this._pendingAttributions.add(t);const i=await a$l(t.layer.fetchAttributionData());if(this._pendingAttributions.has(t)){const e=i.ok?this._createContributionIndex(i.value,f(t.layer)):null;this._pendingAttributions.delete(t),this._fetchedAttributionData.set(t,e);}this._updateAttributionItems();}_createContributionIndex(t,e){const i=t.contributors,r={};if(!i)return r;for(let s=0;s<i.length;s++){const t=i[s],o=t.coverageAreas;if(!o)return;for(const i of o){const o=i.bbox,n=i.zoomMin-(e&&i.zoomMin?1:0),a=i.zoomMax-(e&&i.zoomMax?1:0),c={xmin:o[1],ymin:o[0],xmax:o[3],ymax:o[2],spatialReference:k.WGS84},u={extent:R$1(c),attribution:t.attribution||"",score:null!=i.score?i.score:100,id:s};for(let t=n;t<=a;t++)r[t]=r[t]||[],r[t].push(u);}}return r.maxKey=Math.max.apply(null,Object.keys(r)),r}_getDynamicAttribution(t,e,i){const{extent:r,scale:s}=e;let o=i.tileInfo.scaleToZoom(s);if(o=Math.min(t.maxKey,Math.round(o)),!r||null==o||o<=-1)return "";const n=t[o],a=M$1(r.center.clone().normalize(),e.spatialReference),h={};return n?n.filter((t=>{const e=!h[t.id]&&a&&r$e(t.extent,a);return e&&(h[t.id]=!0),e})).sort(((t,e)=>e.score-t.score||t.objectId-e.objectId)).map((t=>t.attribution)).join(", "):""}};e$5([d$5({readOnly:!0,type:S$2})],y.prototype,"items",void 0),e$5([d$5({readOnly:!0})],y.prototype,"state",null),e$5([d$5()],y.prototype,"view",void 0),y=e$5([i$9("esri.widgets.Attribution.AttributionViewModel")],y);const g$2=y;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$4={base:"esri-attribution esri-widget",poweredBy:"esri-attribution__powered-by",sources:"esri-attribution__sources",open:"esri-attribution--open",sourcesOpen:"esri-attribution__sources--open",link:"esri-attribution__link",widgetIcon:"esri-icon-description",interactive:"esri-interactive"};let l$2=class extends z$1{constructor(e,t){super(e,t),this._isOpen=!1,this._attributionTextOverflowed=!1,this._prevSourceNodeHeight=0,this.iconClass=c$4.widgetIcon,this.itemDelimiter=" | ",this.label=void 0,this.messages=null,this.view=null,this.viewModel=new g$2;}initialize(){this.own($$1(this,"viewModel.items","change",(()=>this.scheduleRender())));}get _isInteractive(){return this._isOpen||this._attributionTextOverflowed}get attributionText(){return this.viewModel.items.reduce(((e,t)=>(-1===e.indexOf(t.text)&&e.push(t.text),e)),[]).join(this.itemDelimiter)}render(){const e={[c$4.open]:this._isOpen};return n$p("div",{bind:this,class:this.classes(c$4.base,e),onclick:this._toggleState,onkeydown:this._toggleState},this.renderSourcesNode(),this.renderPoweredBy())}renderPoweredBy(){return n$p("div",{class:c$4.poweredBy},"Powered by"," ",n$p("a",{class:c$4.link,href:"http://www.esri.com/",target:"_blank",rel:"noreferrer"},"Esri"))}renderSourcesNode(){const e=this._isOpen,t=this._isInteractive,i=t?0:-1,{attributionText:r}=this,o=t?"button":void 0,s={[c$4.sourcesOpen]:e,[c$4.interactive]:t};return n$p("div",{afterCreate:this._afterSourcesNodeCreate,afterUpdate:this._afterSourcesNodeUpdate,bind:this,class:this.classes(c$4.sources,s),innerHTML:r,role:o,tabIndex:i})}_afterSourcesNodeCreate(e){this._prevSourceNodeHeight=e.clientWidth;}_afterSourcesNodeUpdate(e){let t=!1;const{clientHeight:i,clientWidth:r,scrollWidth:o}=e,s=o>=r,n=this._attributionTextOverflowed!==s;if(this._attributionTextOverflowed=s,n&&(t=!0),this._isOpen){const e=i<this._prevSourceNodeHeight;this._prevSourceNodeHeight=i,e&&(this._isOpen=!1,t=!0);}t&&this.scheduleRender();}_toggleState(){this._isInteractive&&(this._isOpen=!this._isOpen);}};e$5([d$5()],l$2.prototype,"_isOpen",void 0),e$5([d$5()],l$2.prototype,"_isInteractive",null),e$5([d$5()],l$2.prototype,"_attributionTextOverflowed",void 0),e$5([d$5()],l$2.prototype,"_prevSourceNodeHeight",void 0),e$5([d$5({readOnly:!0,dependsOn:["viewModel.items.length","itemDelimiter"]})],l$2.prototype,"attributionText",null),e$5([d$5()],l$2.prototype,"iconClass",void 0),e$5([d$5()],l$2.prototype,"itemDelimiter",void 0),e$5([d$5({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],l$2.prototype,"label",void 0),e$5([d$5(),e$b("esri/widgets/Attribution/t9n/Attribution")],l$2.prototype,"messages",void 0),e$5([o$9("viewModel.view")],l$2.prototype,"view",void 0),e$5([d$5({type:g$2})],l$2.prototype,"viewModel",void 0),e$5([t$e()],l$2.prototype,"_toggleState",null),l$2=e$5([i$9("esri.widgets.Attribution")],l$2);const u$2=l$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const n$3="esri.widgets.CompassViewModel";let h$1=class extends(e$c(p$c)){constructor(t){super(t),this._handles=new u$7,this.orientation={x:0,y:0,z:0},this.view=null,this._updateForCamera=this._updateForCamera.bind(this),this._updateForRotation=this._updateForRotation.bind(this),this._updateRotationWatcher=this._updateRotationWatcher.bind(this);}initialize(){this._handles.add(i$b(this,"view",this._updateRotationWatcher));}destroy(){this._handles.destroy(),this._handles=null,this.view=null;}get canShowNorth(){const t=this.get("view.spatialReference");return !(!t||!t.isWebMercator&&!t.isGeographic)}get state(){return this.get("view.ready")?this.canShowNorth?"compass":"rotation":"disabled"}reset(){if(!this.get("view.ready"))return;const t={};"2d"===this.view.type?t.rotation=0:t.heading=0,this.callGoTo({target:t});}_updateForRotation(t){null!=t&&(this.orientation={z:t});}_updateForCamera(t){if(!t)return;const e=-t.heading;this.orientation={x:0,y:0,z:e};}_updateRotationWatcher(t){this._handles.removeAll(),t&&("2d"===t.type?this._handles.add(i$b(this,"view.rotation",this._updateForRotation)):this._handles.add(i$b(this,"view.camera",this._updateForCamera)));}};e$5([d$5({readOnly:!0})],h$1.prototype,"canShowNorth",null),e$5([d$5()],h$1.prototype,"orientation",void 0),e$5([d$5({readOnly:!0})],h$1.prototype,"state",null),e$5([d$5()],h$1.prototype,"view",void 0),h$1=e$5([i$9(n$3)],h$1);const d$1=h$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const n$2={base:"esri-compass esri-widget--button esri-widget",text:"esri-icon-font-fallback-text",icon:"esri-compass__icon",rotationIcon:"esri-icon-dial",northIcon:"esri-icon-compass",widgetIcon:"esri-icon-locate-circled",interactive:"esri-interactive",disabled:"esri-disabled"};let l$1=class extends z$1{constructor(s,e){super(s,e),this.goToOverride=null,this.iconClass=n$2.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new d$1;}reset(){return this.viewModel.reset()}render(){const{orientation:s,state:e}=this.viewModel,o="disabled"===e,t="compass"===("rotation"===e?"rotation":"compass"),r=o?-1:0,i={[n$2.disabled]:o,[n$2.interactive]:!o},a={[n$2.northIcon]:t,[n$2.rotationIcon]:!t},{messages:c}=this;return n$p("div",{bind:this,class:this.classes(n$2.base,i),onclick:this._reset,onkeydown:this._reset,role:"button",tabIndex:r,"aria-label":c.reset,title:c.reset},n$p("span",{"aria-hidden":"true",class:this.classes(n$2.icon,a),styles:this._toRotationTransform(s)}),n$p("span",{class:n$2.text},c.reset))}_reset(){this.viewModel.reset();}_toRotationTransform(s){return {transform:`rotateZ(${s.z}deg)`}}};e$5([o$9("viewModel.goToOverride")],l$1.prototype,"goToOverride",void 0),e$5([d$5()],l$1.prototype,"iconClass",void 0),e$5([d$5({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],l$1.prototype,"label",void 0),e$5([d$5(),e$b("esri/widgets/Compass/t9n/Compass")],l$1.prototype,"messages",void 0),e$5([o$9("viewModel.view")],l$1.prototype,"view",void 0),e$5([d$5({type:d$1})],l$1.prototype,"viewModel",void 0),e$5([t$e()],l$1.prototype,"_reset",null),l$1=e$5([i$9("esri.widgets.Compass")],l$1);const d=l$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let a$2=class extends p$c{constructor(t){super(t),this._handles=new u$7,this.navigationMode="pan",this.view=null;}initialize(){this._handles.add(s$e(this,"view.inputManager",this._setNavigationMode.bind(this)));}destroy(){this._handles.destroy(),this._handles=null,this.view=null;}get state(){return this.get("view.ready")&&"3d"===this.view.type?"ready":"disabled"}toggle(){"disabled"!==this.state&&(this.navigationMode="pan"!==this.navigationMode?"pan":"rotate",this._setNavigationMode());}_setNavigationMode(){this.get("view.inputManager").primaryDragAction="pan"===this.navigationMode?"pan":"rotate";}};e$5([d$5({readOnly:!0})],a$2.prototype,"state",null),e$5([d$5()],a$2.prototype,"navigationMode",void 0),e$5([d$5()],a$2.prototype,"view",void 0),a$2=e$5([i$9("esri.widgets.NavigationToggleViewModel")],a$2);const n$1=a$2;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const g$1={base:"esri-navigation-toggle esri-widget",button:"esri-navigation-toggle__button esri-widget--button",activeButton:"esri-navigation-toggle__button--active",panButton:"esri-navigation-toggle__button--pan",rotateButton:"esri-navigation-toggle__button--rotate",isLayoutHorizontal:"esri-navigation-toggle--horizontal",rotationIcon:"esri-icon-rotate",panIcon:"esri-icon-pan",widgetIcon:"esri-icon-pan2",disabled:"esri-disabled"};let p=class extends z$1{constructor(t,o){super(t,o),this.iconClass=g$1.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new n$1;}set layout(t){"horizontal"!==t&&(t="vertical"),this._set("layout",t);}toggle(){return this.viewModel.toggle()}render(){const t="disabled"===this.get("viewModel.state"),o="pan"===this.get("viewModel.navigationMode"),e={[g$1.disabled]:t,[g$1.isLayoutHorizontal]:"horizontal"===this.layout},s={[g$1.activeButton]:o},i={[g$1.activeButton]:!o},a=t?-1:0,r=this.messages.toggle;return n$p("div",{bind:this,class:this.classes(g$1.base,e),onclick:this._toggle,onkeydown:this._toggle,tabIndex:a,"aria-label":r,title:r},n$p("div",{class:this.classes(g$1.button,g$1.panButton,s)},n$p("span",{class:g$1.panIcon})),n$p("div",{class:this.classes(g$1.button,g$1.rotateButton,i)},n$p("span",{class:g$1.rotationIcon})))}_toggle(){this.toggle();}};e$5([d$5()],p.prototype,"iconClass",void 0),e$5([d$5({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],p.prototype,"label",void 0),e$5([d$5({value:"vertical"})],p.prototype,"layout",null),e$5([d$5(),e$b("esri/widgets/NavigationToggle/t9n/NavigationToggle")],p.prototype,"messages",void 0),e$5([o$9("viewModel.view")],p.prototype,"view",void 0),e$5([d$5({type:n$1})],p.prototype,"viewModel",void 0),e$5([t$e()],p.prototype,"_toggle",null),p=e$5([i$9("esri.widgets.NavigationToggle")],p);const c$3=p;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const c$2={button:"esri-widget--button esri-widget",disabled:"esri-disabled",interactive:"esri-interactive",iconText:"esri-icon-font-fallback-text",icon:"esri-icon"};let n=class extends z$1{constructor(){super(...arguments),this.enabled=!0,this.iconClass="",this.title="";}render(){const t=this.enabled?0:-1,s={[c$2.disabled]:!this.enabled,[c$2.interactive]:this.enabled},o={[this.iconClass]:!!this.iconClass};return n$p("div",{bind:this,class:this.classes(c$2.button,s),onclick:this._triggerAction,onkeydown:this._triggerAction,role:"button",tabIndex:t,title:this.title},n$p("span",{"aria-hidden":"true",role:"presentation",class:this.classes(c$2.icon,o)}),n$p("span",{class:c$2.iconText},this.title))}_triggerAction(){this.action.call(this);}};e$5([d$5()],n.prototype,"action",void 0),e$5([d$5()],n.prototype,"enabled",void 0),e$5([d$5()],n.prototype,"iconClass",void 0),e$5([d$5()],n.prototype,"title",void 0),e$5([t$e()],n.prototype,"_triggerAction",null),n=e$5([i$9("esri.widgets.IconButton")],n);const a$1=n;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let s$1=class extends p$c{get canZoomIn(){if(!this.get("view.ready"))return !1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMaxScale");return 0===t||e>t}get canZoomOut(){if(!this.get("view.ready"))return !1;const e=this.get("view.animation.target.scale")||this.get("view.scale"),t=this.get("view.constraints.effectiveMinScale");return 0===t||e<t}};e$5([d$5({readOnly:!0})],s$1.prototype,"canZoomIn",null),e$5([d$5({readOnly:!0})],s$1.prototype,"canZoomOut",null),e$5([d$5()],s$1.prototype,"view",void 0),s$1=e$5([i$9("esri.widgets.Zoom.ZoomConditions2D")],s$1);const i=s$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let s=class extends p$c{get canZoomIn(){return !!this.get("view.ready")}get canZoomOut(){return !!this.get("view.ready")}};e$5([d$5({readOnly:!0})],s.prototype,"canZoomIn",null),e$5([d$5({readOnly:!0})],s.prototype,"canZoomOut",null),e$5([d$5()],s.prototype,"view",void 0),s=e$5([i$9("esri.widgets.Zoom.ZoomConditions3D")],s);const c$1=s;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
let m$1=class extends p$c{constructor(o){super(o),this.canZoomIn=!1,this.canZoomOut=!1;}destroy(){this.view=null;}get state(){return this.get("view.ready")?"ready":"disabled"}set view(o){o?"2d"===o.type?this._zoomConditions=new i({view:o}):"3d"===o.type&&(this._zoomConditions=new c$1({view:o})):this._zoomConditions=null,this._set("view",o);}zoomIn(){if(!this.canZoomIn)return;const o=this.view;"2d"===o.type?o.mapViewNavigation.zoomIn():g$8(o.goTo({zoomFactor:2}));}zoomOut(){if(!this.canZoomOut)return;const o=this.view;"2d"===o.type?o.mapViewNavigation.zoomOut():g$8(o.goTo({zoomFactor:.5}));}};e$5([d$5()],m$1.prototype,"_zoomConditions",void 0),e$5([d$5({aliasOf:"_zoomConditions.canZoomIn",readOnly:!0})],m$1.prototype,"canZoomIn",void 0),e$5([d$5({aliasOf:"_zoomConditions.canZoomOut",readOnly:!0})],m$1.prototype,"canZoomOut",void 0),e$5([d$5({readOnly:!0})],m$1.prototype,"state",null),e$5([d$5()],m$1.prototype,"view",null),m$1=e$5([i$9("esri.widgets.Zoom.ZoomViewModel")],m$1);const a=m$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const l={base:"esri-zoom esri-widget",horizontalLayout:"esri-zoom--horizontal",zoomInIcon:"esri-icon-plus",zoomOutIcon:"esri-icon-minus",widgetIcon:"esri-icon-zoom-in-magnifying-glass"};let u$1=class extends z$1{constructor(o,t){super(o,t),this.iconClass=l.widgetIcon,this.label=void 0,this.messages=null,this.view=null,this.viewModel=new a;}initialize(){this._zoomInButton=new a$1({action:this.zoomIn.bind(this),iconClass:l.zoomInIcon}),this._zoomOutButton=new a$1({action:this.zoomOut.bind(this),iconClass:l.zoomOutIcon});}destroy(){this._zoomInButton.destroy(),this._zoomOutButton.destroy(),this._zoomInButton=null,this._zoomOutButton=null;}set layout(o){"horizontal"!==o&&(o="vertical"),this._set("layout",o);}render(){const o=this.viewModel,t={[l.horizontalLayout]:"horizontal"===this.layout};return this._zoomInButton.enabled="ready"===o.state&&o.canZoomIn,this._zoomOutButton.enabled="ready"===o.state&&o.canZoomOut,this._zoomInButton.title=this.messages.zoomIn,this._zoomOutButton.title=this.messages.zoomOut,n$p("div",{class:this.classes(l.base,t)},this._zoomInButton.render(),this._zoomOutButton.render())}zoomIn(){return this.viewModel.zoomIn()}zoomOut(){return this.viewModel.zoomOut()}};e$5([d$5()],u$1.prototype,"iconClass",void 0),e$5([d$5({aliasOf:{source:"messages.widgetLabel",overridable:!0}})],u$1.prototype,"label",void 0),e$5([d$5({value:"vertical"})],u$1.prototype,"layout",null),e$5([d$5(),e$b("esri/widgets/Zoom/t9n/Zoom")],u$1.prototype,"messages",void 0),e$5([o$9("viewModel.view")],u$1.prototype,"view",void 0),e$5([d$5({type:a})],u$1.prototype,"viewModel",void 0),u$1=e$5([i$9("esri.widgets.Zoom")],u$1);const c=u$1;

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.22/esri/copyright.txt for details.
*/
const m="esri.views.ui.DefaultUI";function h(t){return t&&void 0!==t.view}s$b.getLogger(m);let g=class extends v{constructor(t){super(t),this._defaultPositionLookup={attribution:"manual",compass:"top-leading","navigation-toggle":"top-leading",zoom:"top-leading"},this.components=[];}initialize(){this._handles.add([i$b(this,"components",this._componentsWatcher.bind(this)),i$b(this,"view",this._updateViewAwareWidgets.bind(this))]);}_add(t,o,i,e){if("string"==typeof t&&this._defaultPositionLookup[t]){if(this._find(t))return;t=this._createComponent(t);}super._add(t,o,i,e);}_removeComponents(t){t.forEach((t=>{const o=this._find(t);o&&(this.remove(o),o.destroy());}));}_updateViewAwareWidgets(t){this.components.forEach((o=>{const i=this._find(o),e=i&&i.widget;h(e)&&(e.view=t);}));}_componentsWatcher(t,o){this._removeComponents(o),this._addComponents(t),this._adjustPadding(t);}_adjustPadding(t){if(-1===t.indexOf("attribution")&&!this._isOverridden("padding")){const{top:t}=this.padding;this.padding=t;}}_addComponents(t){this.initialized&&t.forEach((t=>this.add(this._createComponent(t),this._defaultPositionLookup[t])));}_createComponent(t){const o=this._createWidget(t);if(o)return new l$3({id:t,node:o})}_createWidget(t){return "attribution"===t?this._createAttribution():"compass"===t?this._createCompass():"navigation-toggle"===t?this._createNavigationToggle():"zoom"===t?this._createZoom():void 0}_createAttribution(){return new u$2({view:this.view})}_createCompass(){return new d({view:this.view})}_createNavigationToggle(){return new c$3({view:this.view})}_createZoom(){return new c({view:this.view})}};e$5([d$5()],g.prototype,"components",void 0),g=e$5([i$9(m)],g);const u=g;

export { $, A, s$a as B, n$a as C, r$5 as D, lt as E, Ft as F, Gt as G, rt as H, xt as I, J, vt as K, pt as L, Mt as M, t$5 as N, P, Rt as R, St as S, U, Z, a$d as a, bt as b, t$3 as c, t$2 as d, a$6 as e, e as f, n$5 as g, ht as h, i$2 as i, j, kt as k, l$4 as l, s$4 as m, n$b as n, o, s$3 as p, e$1 as q, u as r, s$7 as s, tt as t, u$4 as u, m$5 as v, wt as w, s$2 as x, r$3 as y, o$3 as z };
